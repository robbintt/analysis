---
ver: rpa2
title: Causality-enhanced Decision-Making for Autonomous Mobile Robots in Dynamic
  Environments
arxiv_id: '2504.11901'
source_url: https://arxiv.org/abs/2504.11901
tags:
- causal
- robot
- battery
- time
- task
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper introduces a novel end-to-end framework for autonomous\
  \ robot decision-making that integrates causal discovery with causal reasoning to\
  \ improve efficiency and safety in dynamic human-shared environments. The framework\
  \ uses a causal inference engine to estimate key factors\u2014battery consumption\
  \ and people density\u2014based on robot state, environmental context, and potential\
  \ interventions."
---

# Causality-enhanced Decision-Making for Autonomous Mobile Robots in Dynamic Environments

## Quick Facts
- arXiv ID: 2504.11901
- Source URL: https://arxiv.org/abs/2504.11901
- Reference count: 40
- Key outcome: Novel end-to-end framework integrating causal discovery and reasoning to improve autonomous robot decision-making in dynamic human-shared environments

## Executive Summary
This paper introduces a novel end-to-end framework for autonomous robot decision-making that integrates causal discovery with causal reasoning to improve efficiency and safety in dynamic human-shared environments. The framework uses a causal inference engine to estimate key factors—battery consumption and people density—based on robot state, environmental context, and potential interventions. These estimates guide path planning and enable task-abort decisions. To support this work, the authors also developed PeopleFlow, a Gazebo-based simulator that models context-sensitive human-robot spatial interactions in shared workspaces. Evaluation in a warehouse scenario showed that the full causal framework achieved an 89.0% success rate compared to 55.9% for the baseline, reduced human-robot collisions by over 60%, and improved battery efficiency by ensuring 92.3% of consumption was used for successful tasks.

## Method Summary
The framework combines causal discovery (J-PCMCI+ algorithm) with parameter learning (MLE) to build a causal inference engine that estimates battery consumption and people density. Data is collected from PeopleFlow simulator, subsampled, and discretized before causal discovery. The engine uses do-calculus queries to estimate intervention effects, which inform A* path planning with context-sensitive heuristics. Tasks are aborted if estimated battery cost exceeds safety thresholds. The approach is evaluated in a warehouse scenario with 50 workers across 11 time slots, comparing against baseline shortest-path planning.

## Key Results
- Success rate improved from 55.9% (baseline) to 89.0% with full causal framework
- Human-robot collisions reduced by over 60% compared to baseline
- 92.3% of battery consumption was used for successful tasks
- Statistical significance confirmed via Chi-Square, Negative Binomial, and Mann-Whitney U tests

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Causal inference provides robust battery consumption estimates by adjusting for unobserved confounders (obstacles).
- Mechanism: Uses do-calculus $P(L|do(V=v), C=c)$ rather than standard conditioning to adjust for confounding by obstacles that influence both velocity and battery drain.
- Core assumption: Causal structure (confounding role of O) learned during discovery holds true during inference.
- Evidence: Section 4.3 explains confounding relationship; Figure 5 shows DAG where $O \rightarrow V$ and $O \rightarrow L$.

### Mechanism 2
- Claim: Context-sensitive path planning reduces human-robot collisions by predicting congestion.
- Mechanism: Uses time-slot and waypoint context variables to predict people density, feeding this into A* heuristic to penalize paths through likely crowded areas.
- Core assumption: Human movement follows probabilistic, time-dependent routines.
- Evidence: Section 4.2.3 describes time-slot as primary contextual driver; Section 4.3 details causal query for density estimation.

### Mechanism 3
- Claim: Pre-task refusal prevents battery exhaustion failures.
- Mechanism: Evaluates cumulative battery cost before execution and aborts tasks that would push battery below safety threshold.
- Core assumption: Cost estimation is accurate enough to forecast battery-related task success/failure.
- Evidence: Section 4.3 describes refusal mechanism; Section 5.5 confirms benefit with low battery failure rates.

## Foundational Learning

- Concept: Do-Calculus vs. Conditioning
  - Why needed: Essential for understanding why battery query works; standard probability $P(L|V)$ cannot separate velocity effect from obstacle confounding.
  - Quick check: If robot moves slowly, do we assume high drain (complex maneuvering) or low drain (less power)? How does $do(V)$ resolve this?

- Concept: Context Variables in Causal Discovery (J-PCMCI+)
  - Why needed: Distinguishes system variables (affected by robot) from context variables (external factors like time); standard algorithms would incorrectly treat time as system variable.
  - Quick check: Can robot's movement influence "Time-slot"? Why must discovery enforce $S \rightarrow D$ but forbid $D \rightarrow S$?

- Concept: Discretization for Inference
  - Why needed: Causal inference engine operates on discrete states to learn CPTs; continuous data must be binned.
  - Quick check: If velocity discretized into "Slow, Medium, Fast", how might bin boundaries affect battery cost estimate precision?

## Architecture Onboarding

- Component map: PeopleFlow -> Data Extraction (Subsampling -> Discretization) -> Learning Pipeline (J-PCMCI+ -> MLE -> Causal Engine) -> Inference Pipeline (Queries -> A* Planning -> Execute/Abort)

- Critical path: Learning Pipeline is bottleneck for adaptability; currently run once. Inference Pipeline (approx. 0.3s) is real-time capable.

- Design tradeoffs:
  - Proactive vs. Reactive: Decides at $t=0$ without re-planning during task, reducing compute but assuming world state persists.
  - Generality vs. Specificity: J-PCMCI+ handles context well but adds complexity compared to LSTMs, though provides explainability.

- Failure signatures:
  - High "Wasted Distance": Suggests broken refusal mechanism or too-low battery threshold $B_{min}$
  - High Collision Count: Suggests too-low density weight $\lambda_D$ or misaligned time-slot context
  - Compute Timeout: Causal discovery scales with variables; too many sensor modalities will crash learning phase

- First 3 experiments:
  1. Generate synthetic data with known ground-truth causal links; run J-PCMCI+ to verify it recovers graph (specifically $O \rightarrow V \rightarrow L$ chain)
  2. Run robot with "Context" disabled (random waypoints); compare success rates to quantify value of time-slot feature
  3. Set initial battery to near-threshold levels; verify correct abortion of long tasks while accepting short ones, measuring "Effective Battery Usage"

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does framework perform on physical robot in real-world logistics environment compared to PeopleFlow simulation?
- Basis: Conclusion states primary future work is "real-world validation" involving deployment on real robot
- Why unresolved: All evaluation conducted within PeopleFlow simulator
- Evidence needed: Successful field trials demonstrating similar success rates and collision avoidance metrics on physical hardware

### Open Question 2
- Question: Can robot autonomously detect environmental changes and re-run causal discovery pipeline to maintain performance?
- Basis: Authors propose exploring "long-term autonomy" by enabling robot to "autonomously re-run learning pipeline on new data"
- Why unresolved: Current methodology performs causal discovery and parameter learning "only once"
- Evidence needed: Experiments where system maintains performance despite dynamic shifts by automatically triggering model updates

### Open Question 3
- Question: Is it possible to integrate causal feature learning to remove manual variable selection requirement?
- Basis: Conclusion identifies "promising direction" as integrating module for "causal feature learning" to "automatically identify and refine relevant features"
- Why unresolved: Framework assumes "predefined set of relevant variables based on domain knowledge"
- Evidence needed: Modified pipeline that autonomously selects features and achieves comparable inference accuracy without prior domain variable selection

## Limitations
- Causal structure must be relearned if environment changes significantly (different layout, worker routines, or robot capabilities)
- Discretization step introduces information loss; bin boundary choice affects battery cost estimate precision
- PeopleFlow simulator may not fully capture complexity and unpredictability of real-world human behavior

## Confidence

- **High Confidence**: Mechanism of using causal inference to estimate battery consumption by adjusting for confounding obstacles is well-supported by DAG structure and do-calculus formulation; experimental results show significant improvement (89.0% vs 55.9% success rate)
- **Medium Confidence**: Effectiveness of context-sensitive path planning relies on assumption that human movement follows probabilistic, time-dependent routines; real-world validation needed for robustness under erratic behavior
- **Medium Confidence**: Pre-task refusal mechanism is logically sound but effectiveness depends on cost estimation accuracy; paper provides evidence of benefit but sensitivity to model inaccuracies not fully explored

## Next Checks

1. **Real-World Deployment Test**: Deploy framework in real warehouse environment with human workers to validate simulator predictions and assess causal model robustness under real-world variability

2. **Stress Test on Battery Model**: Systematically vary battery model parameters (Ks, Kd, Ko, Kc) and observe impact on task success rates and battery efficiency to quantify framework sensitivity to battery dynamics

3. **Ablation Study on Context Variables**: Conduct experiments with different combinations of context variables (S, W, C, O) to isolate individual contributions to overall performance and identify most critical features for causal inference