---
ver: rpa2
title: Query-Efficient Agentic Graph Extraction Attacks on GraphRAG Systems
arxiv_id: '2601.14662'
source_url: https://arxiv.org/abs/2601.14662
tags:
- graph
- query
- extraction
- graphrag
- entities
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper studies a novel problem of graph-level extraction attacks
  on GraphRAG systems, where an adversary aims to reconstruct the underlying entity-relation
  knowledge graph under a strict query budget and black-box access. To address challenges
  of noise, redundancy, and long-horizon planning, the authors propose AGEA, an agentic
  framework that couples novelty-guided exploration-exploitation with a two-stage
  extraction pipeline (fast regex discovery plus LLM-based filtering).
---

# Query-Efficient Agentic Graph Extraction Attacks on GraphRAG Systems
## Quick Facts
- arXiv ID: 2601.14662
- Source URL: https://arxiv.org/abs/2601.14662
- Reference count: 40
- Attack method recovers up to 90% of GraphRAG knowledge graph entities and relationships under strict query budgets

## Executive Summary
This paper introduces AGEA (Agentic Graph Extraction Attacks), a novel framework for extracting underlying entity-relation knowledge graphs from GraphRAG systems under strict query budget constraints. The attack addresses the challenge of multi-turn structured extraction where adversaries aim to reconstruct the internal knowledge graph through black-box access. AGEA employs an agentic approach combining novelty-guided exploration with a two-stage extraction pipeline that first discovers potential entities through regex patterns, then filters results using LLM-based refinement.

The authors evaluate AGEA across three domains (medical, agricultural, literary) and two GraphRAG systems (Microsoft GraphRAG and LightRAG), demonstrating consistent superiority over baseline extraction methods. The framework achieves up to 90% recovery of entities and relationships while maintaining high precision under identical query budgets. The work highlights significant vulnerabilities in modern GraphRAG systems, showing they remain susceptible to structured, query-efficient extraction attacks even under strict constraints.

## Method Summary
AGEA operates as an agentic framework that couples novelty-guided exploration with a two-stage extraction pipeline. The first stage uses regex-based discovery to identify potential entities from system responses, while the second stage employs LLM-based filtering to refine results and eliminate noise. The framework is designed to work under strict query budget constraints, making it suitable for practical attack scenarios. The agentic component manages the exploration-exploitation tradeoff, using novelty guidance to prioritize unexplored regions of the knowledge graph while maintaining efficiency within the query budget.

## Key Results
- AGEA recovers up to 90% of entities and relationships in GraphRAG knowledge graphs
- The framework outperforms baseline extraction methods across all tested domains and systems
- High precision maintained even under strict query budget constraints
- Consistent performance across medical, agricultural, and literary datasets in both Microsoft GraphRAG and LightRAG systems

## Why This Works (Mechanism)
AGEA leverages the structured nature of GraphRAG responses and the predictability of entity-relation patterns to systematically extract knowledge graph components. The two-stage pipeline allows for efficient discovery followed by intelligent filtering, while the agentic exploration component ensures comprehensive coverage within query budget limits. The framework exploits the fact that GraphRAG systems must maintain some level of structured output to function effectively, creating predictable patterns that can be systematically discovered and extracted.

## Foundational Learning
- **GraphRAG knowledge graph construction**: Understanding how GraphRAG systems internally structure entity-relation data is crucial for identifying extraction patterns and predicting response formats.
- **Regex pattern discovery**: Fast initial identification of entities relies on recognizing common naming patterns and structural regularities in system responses.
- **LLM-based filtering**: Sophisticated noise reduction and precision improvement requires understanding how to prompt language models for accurate entity-relation validation.
- **Agentic exploration strategies**: Efficient graph coverage under query budget constraints demands novelty-guided exploration that balances discovery with exploitation.
- **Query budget optimization**: Maximizing extraction efficiency requires careful planning of query sequences to minimize redundancy while ensuring comprehensive coverage.
- **Multi-turn attack coordination**: Orchestrating sequential queries to progressively reveal graph structure demands long-horizon planning capabilities.

## Architecture Onboarding
**Component Map**: Query Planner -> Regex Discovery -> LLM Filter -> Graph Reconstructor
**Critical Path**: User query → Query Planner selects strategy → System response → Regex discovery identifies candidates → LLM filtering validates entities → Graph reconstructor updates knowledge model
**Design Tradeoffs**: The framework balances exploration breadth against extraction precision, with the regex stage prioritizing recall over precision and the LLM stage providing targeted refinement at computational cost.
**Failure Signatures**: Reduced extraction success when systems employ strict output formatting, when entity patterns are highly irregular, or when query budgets are severely constrained.
**First Experiments**: 1) Test baseline regex extraction without LLM filtering on a small synthetic graph, 2) Evaluate query efficiency by measuring entities discovered per query across different exploration strategies, 3) Assess precision-recall tradeoff by varying the strictness of LLM filtering parameters.

## Open Questions the Paper Calls Out
### Open Question 1
- Question: Can retrieval-time filtering, response sanitization, or traversal-aware monitoring effectively mitigate multi-turn graph extraction attacks?
- Basis in paper: Authors state: "developing defenses against multi-turn structured extraction (e.g., retrieval-time filtering, response sanitization, traversal-aware monitoring)" as future work.
- Why unresolved: The paper characterizes the attack surface but does not evaluate any defensive mechanisms against AGEA.
- What evidence would resolve it: Empirical evaluation of proposed defenses showing reduced leakage under identical query budgets, with analysis of utility-privacy tradeoffs.

### Open Question 2
- Question: How does attribute leakage (textual descriptions attached to entities/relations) compare to structural leakage in GraphRAG systems?
- Basis in paper: Authors explicitly list "measuring attribute leakage" as future work; current work focuses only on entity-relation structure recovery.
- Why unresolved: GraphRAG systems store rich textual attributes alongside graph topology, but AGEA's leakage metrics only count nodes and edges.
- What evidence would resolve it: Extension of leakage metrics to include attribute-level recovery rates, with comparison to structural leakage efficiency.

### Open Question 3
- Question: Do output-formatting restrictions or prompt policies reliably prevent structured extraction without degrading legitimate query utility?
- Basis in paper: Limitations section notes AGEA's regex parsing "may reduce extraction reliability" when systems "restrict output formatting or apply prompting policies."
- Why unresolved: No experiments test robustness of AGEA against systems that refuse structured output requests.
- What evidence would resolve it: Ablation studies where the victim system applies varying output restrictions, measuring both extraction success and task utility degradation.

### Open Question 4
- Question: How does extraction vulnerability generalize to other GraphRAG architectures (e.g., HippoRAG, G-Retriever, tree-based systems)?
- Basis in paper: Authors list "testing more GraphRAG variants and construction choices" as future work; experiments only cover M-GraphRAG and LightRAG.
- Why unresolved: Different construction strategies (tree-based, passage-graph, GNN-based) may expose different attack surfaces.
- What evidence would resolve it: Systematic evaluation across 3-5 additional GraphRAG systems with analysis of which architectural features correlate with vulnerability.

## Limitations
- Methodology relies heavily on prompt engineering and agent-based exploration, raising questions about generalizability across all GraphRAG implementations
- Evaluation focuses on three specific domains, limiting understanding of performance in more complex or heterogeneous knowledge domains
- Query budget constraints represent a specific threat model that may not capture all practical attack scenarios

## Confidence
- **High confidence**: Core claim that AGEA outperforms baseline extraction methods within tested GraphRAG systems and query budget constraints
- **Medium confidence**: Scalability of the approach to larger, more complex knowledge graphs given computational overhead
- **Low confidence**: Absolute robustness of extraction methodology against adaptive defenses or enhanced privacy mechanisms

## Next Checks
1. Test AGEA against GraphRAG systems with active defense mechanisms such as rate limiting, query pattern detection, or synthetic data injection to evaluate attack resilience.
2. Evaluate performance on significantly larger knowledge graphs (10x-100x the current size) to assess computational scalability and query efficiency degradation.
3. Conduct ablation studies isolating the contribution of each component (regex discovery, LLM filtering, novelty guidance) to quantify their individual impact on extraction success rates.