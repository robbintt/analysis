---
ver: rpa2
title: 'Spatiotemporal Forecasting in Climate Data Using EOFs and Machine Learning
  Models: A Case Study in Chile'
arxiv_id: '2502.17495'
source_url: https://arxiv.org/abs/2502.17495
tags:
- data
- time
- forecasting
- spatial
- clusters
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The study addresses the challenge of spatiotemporal forecasting
  in Chile's highly variable climate by integrating machine learning methods with
  statistical techniques. The methodology combines Empirical Orthogonal Functions
  (EOFs) for dimensionality reduction, wavelet analysis for high-resolution time-frequency
  information, and neural networks for forecasting.
---

# Spatiotemporal Forecasting in Climate Data Using EOFs and Machine Learning Models: A Case Study in Chile

## Quick Facts
- arXiv ID: 2502.17495
- Source URL: https://arxiv.org/abs/2502.17495
- Authors: Mauricio Herrera; Francisca Kleisinger; Andrés Wilsón
- Reference count: 6
- The study integrates machine learning methods with statistical techniques (EOFs, wavelet analysis, neural networks) to forecast Chile's highly variable climate, transitioning from high-dimensional spatiotemporal forecasting to low-dimensional univariate problems.

## Executive Summary
This study addresses the challenge of spatiotemporal forecasting in Chile's complex climate by integrating Empirical Orthogonal Functions (EOFs) for dimensionality reduction, wavelet analysis for time-frequency decomposition, and neural networks for forecasting. The methodology reduces computational complexity while maintaining forecast accuracy by transforming high-dimensional multivariate spatiotemporal data into low-dimensional univariate time series. Cluster analysis using Dynamic Time Warping identifies geographic areas with similar precipitation patterns and assesses spatial coherence. Results show the approach produces reasonably accurate forecasts, particularly in clusters with high spatial coherence, demonstrating utility for resource management and environmental planning in regions with complex climatic variability.

## Method Summary
The methodology combines Dynamic Time Warping clustering to group geographic regions with similar precipitation patterns, followed by EOF decomposition per cluster to reduce dimensionality. The SVD-based approach extracts temporal EOFs (φₖ(t)) and spatial coefficients (αₖ(s)), retaining 5-7 modes explaining >80% variance. A Wavelet-ANN hybrid model (MODWT with Haar filter, 10 levels, hidden layer=40) forecasts each EOF individually, which are then reconstructed into spatiotemporal fields using the static spatial coefficients. The approach transitions from a 6,355-dimensional multivariate problem to forecasting 5-7 univariate time series, significantly reducing computational complexity while maintaining forecast accuracy.

## Key Results
- The method effectively reduces computational complexity by transitioning from high-dimensional multivariate spatiotemporal forecasting to low-dimensional univariate forecasting via EOF decomposition
- Wavelet-ANN hybrid model outperforms standard DeepAR and NBEATS on EOF forecasting, particularly for the leading mode (φ₁)
- Forecast accuracy varies significantly across geographic clusters, with high-coherence regions (clusters 3-6) requiring fewer EOFs (3-5) compared to low-coherence regions (clusters 1, 2, 7) that need more modes
- The approach produces reasonably accurate medium-range forecasts (up to one year), demonstrating practical utility for resource management in regions with complex climatic variability

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Reducing high-dimensional spatiotemporal data to low-dimensional univariate time series (EOFs) allows standard forecasting models to operate efficiently without handling spatial dependencies directly.
- **Mechanism:** Singular Value Decomposition (SVD) factorizes the spatiotemporal matrix Z into temporal Empirical Orthogonal Functions (EOFs, φₖ(t)) and spatial coefficients (αₖ(s)). By truncating to K̅ modes (e.g., 5–7), the system forecasts only these few univariate temporal functions rather than 6,355 correlated spatial time series.
- **Core assumption:** The spatial coefficients αₖ(s) remain stable or change negligibly over the forecast horizon h, allowing the use of historical spatial weights to reconstruct future spatial fields.
- **Evidence anchors:** [abstract] "transitions from a high-dimensional multivariate spatiotemporal data forecasting problem... to a low-dimensional univariate time series forecasting problem." [section 2.b] "The centred and normalized data Z can be represented using a discrete temporal orthonormal basis..."
- **Break condition:** If the underlying spatial covariance structure shifts significantly during the forecast horizon (non-stationarity), the static αₖ(s) weights will reconstruct invalid spatial patterns.

### Mechanism 2
- **Claim:** Clustering the landscape by precipitation similarity (DTW) prior to decomposition isolates regions with high spatial coherence, improving the signal-to-noise ratio of the leading EOFs.
- **Mechanism:** Dynamic Time Warping (DTW) groups time series with similar shapes even if misaligned in time. By performing EOF decomposition within these clusters (rather than globally), the leading modes explain a higher percentage of local variance, reducing the number of modes (K̅) needed for accurate reconstruction.
- **Core assumption:** Climate regions defined by historical precipitation patterns (clusters) remain valid predictors of future spatial covariance.
- **Evidence anchors:** [section 2.e] "The objective of time series comparison methods is to produce a distance metric... DTW allows the two curves to match up evenly..." [section 3] "Clusters with better DOF and Var(SAI) indicators require fewer EOFs... clusters 3 to 6... require between 3 to 5 EOFs... while clusters 1, 2, and 7 require more."
- **Break condition:** If a region lacks spatial coherence (high Degrees of Freedom, low var(SAI)), the EOF decomposition will fail to find dominant modes, resulting in poor forecast skill regardless of the ML model used.

### Mechanism 3
- **Claim:** Wavelet decomposition stabilizes neural network training by separating high-frequency noise from low-frequency trends in the EOF time series.
- **Mechanism:** The Maximal Overlap Discrete Wavelet Transform (MODWT) breaks non-stationary climate signals into additive components (approximation + details). An Artificial Neural Network (ANN) forecasts these components individually, which is often easier than forecasting raw non-stationary signals directly.
- **Core assumption:** The temporal dependencies in the wavelet domain are more learnable by standard ANNs than the raw time-domain signals.
- **Evidence anchors:** [section 3] "Wavelet-ANN Hybrid Model... utilizing the Maximal Overlap Discrete Wavelet Transform (MODWT) algorithm... has proven to be effective." [table 4] Shows Wavelet-ANN outperforming standard DeepAR and NBEATS on EOF φ₁.
- **Break condition:** If the wavelet decomposition level is mismatched to the signal periodicity, the ANN may forecast detrended noise or miss critical high-frequency events.

## Foundational Learning

- **Concept:** Empirical Orthogonal Functions (EOFs) / Principal Component Analysis (PCA)
  - **Why needed here:** This is the core compression engine. Without understanding how covariance matrices project data onto orthogonal bases, one cannot interpret the "reconstruction" step or the variance explained metrics.
  - **Quick check question:** If you retain 5 EOFs explaining 80% variance, what happens to the remaining 20% during reconstruction?

- **Concept:** Dynamic Time Warping (DTW)
  - **Why needed here:** Defines the spatial clusters. Unlike Euclidean distance, DTW handles phase shifts (e.g., a rain storm arriving one day later in one location vs another), which is critical for grouping climate zones.
  - **Quick check question:** Why would Euclidean clustering fail to group two locations with identical annual rainfall cycles that are slightly out of phase?

- **Concept:** Spatial Coherence (DOF & var(SAI))
  - **Why needed here:** Serves as a "predictability filter." Understanding these metrics explains why the model works in Central Chile (high coherence) but fails in the arid North (low coherence).
  - **Quick check question:** Does a high "Degrees of Freedom" (DOF) score indicate high or low spatial coherence?

## Architecture Onboarding

- **Component map:** Input ERA5 Grid (6,355 points, 1980–2022) -> DTW Clustering -> 7 Geographic Regions -> SVD-based EOF Decomposition -> MODWT Wavelet Transform -> ANN Forecast -> Inverse Wavelet Transform -> Reconstruction via αₖ(s)·φₖ(t+h)

- **Critical path:** The stability of αₖ(s). The entire reconstruction logic depends on the assumption that the spatial map of weights (α) calculated from history remains valid for the forecasted future φₖ(t+h).

- **Design tradeoffs:**
  - **Global vs. Clustered EOFs:** Global EOFs reduce compute but fail to capture local microclimates (low coherence). Clustered EOFs improve local accuracy but require managing multiple models.
  - **Truncation (K̅):** Lower K means faster compute but loss of high-frequency spatial details. The paper targets >80% variance explained.

- **Failure signatures:**
  - **High MAE in Arid Zones:** Cluster 1 (North) and 7 (South) show poor spatial coherence (high DOF), leading to high reconstruction errors.
  - **EOF Drift:** If forecasted EOFs diverge in amplitude, reconstruction creates physically impossible precipitation values (negative rain).
  - **Stationarity Mismatch:** Using 40 years of training data might obscure recent climate shifts, violating the assumption that past αₖ patterns persist.

- **First 3 experiments:**
  1. **Baseline Variance Check:** Run PCA on a single cluster. Verify that 3–5 components indeed capture >80% variance. If not, the clustering is too coarse.
  2. **Spatial Stability Test:** Calculate αₖ(s) for the period 2018–2021 and compare to αₖ(s) including 2022. Verify the correlation is >0.99 to validate the core assumption.
  3. **Horizon Ablation:** Forecast at h=30, 90, 180, 365 days. Plot error growth. The paper implies "medium-range" works; find where the error explodes to define the operational limit.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** Can the spatial coefficients αₖ(s) be effectively estimated at unobserved locations using Deep Learning-based regression to reconstruct spatiotemporal fields off the defined grid?
- **Basis:** [explicit] The conclusion suggests combining the current approach with Amato et al. (2020) to use Feed-Forward Neural Networks (FFNN) for interpolating spatial coefficients at any point within the territory.
- **Why unresolved:** The current study limits reconstruction to the 6355 predefined grid points, relying on fixed coefficients derived from SVD without extrapolating to new spatial locations.
- **What evidence would resolve it:** Implementation of the FFNN interpolation framework to predict αₖ(s) at holdout validation points, comparing the reconstructed fields against observed data.

### Open Question 2
- **Question:** To what extent does the assumption of temporal stability in spatial coefficients αₖ(s) hold over forecast horizons longer than one year?
- **Basis:** [inferred] Section 2.d notes that if the relationship between spatial and temporal components changes significantly, the assumption of using constant coefficients becomes invalid, though the study only validates a one-year horizon.
- **Why unresolved:** The paper provides empirical evidence for stability over a single year (2022) but explicitly lists this assumption as a potential error source for extended forecasts.
- **What evidence would resolve it:** A sensitivity analysis measuring the drift of spatial coefficients over multiple years or decades, quantifying the resulting error propagation in long-term reconstructions.

### Open Question 3
- **Question:** How does the presence of significant nonlinearities in raw climate data impact the efficacy of the linear EOF decomposition step?
- **Basis:** [inferred] Section 2.d warns that EOF decomposition may be unsuitable if the original data contains nonlinearities, advising verification of alignment between real and reconstructed data.
- **Why unresolved:** While the method works for the selected variables, the paper does not quantitatively assess performance loss when linear EOFs fail to capture nonlinear dependencies inherent in complex climatic systems.
- **What evidence would resolve it:** Comparative benchmarking against nonlinear dimensionality reduction techniques (e.g., Autoencoders) on datasets with known nonlinear structures to measure information loss.

## Limitations

- The assumption that spatial weights (αₖ(s)) remain stable over the forecast horizon may not hold during significant climate regime shifts, potentially limiting long-term forecast reliability.
- Forecast accuracy varies significantly across geographic clusters, with low-coherence regions (clusters 1, 2, and 7) experiencing notably higher forecast errors that may limit practical applicability in certain areas.
- The specific implementation details of the Wavelet-ANN hybrid model remain underspecified, making exact replication difficult and potentially affecting reproducibility of results.

## Confidence

*High confidence:* The dimensionality reduction approach using EOFs effectively transitions from high-dimensional to low-dimensional forecasting problems, as demonstrated by the computational efficiency gains and the ability to use standard univariate forecasting models.

*Medium confidence:* The clustering approach using DTW successfully identifies regions with similar precipitation patterns, though the claim that this improves forecast accuracy requires more extensive validation across multiple years and climate scenarios.

*Low confidence:* The specific Wavelet-ANN architecture parameters and their impact on forecast performance are not fully detailed, making it difficult to assess whether the observed improvements are robust to architectural variations.

## Next Checks

1. **Spatial coefficient stability test:** Calculate and compare αₖ(s) values for multiple time windows (e.g., 2018-2020 vs 2021-2022) to verify the core assumption that spatial weights remain stable. Expect correlation >0.99 for the method to be valid.

2. **Multi-year validation:** Extend the forecast validation to cover 2019-2022 (using 2018-2021 as training) to assess whether the model's performance is consistent across multiple years with different precipitation patterns.

3. **Climate regime sensitivity:** Test the model's performance during known climate anomalies (e.g., El Niño years) to quantify how sensitive the forecasts are to shifts in underlying climate patterns that might violate the stationarity assumption.