---
ver: rpa2
title: 'WorldPack: Compressed Memory Improves Spatial Consistency in Video World Modeling'
arxiv_id: '2512.02473'
source_url: https://arxiv.org/abs/2512.02473
tags:
- memory
- frames
- arxiv
- video
- context
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces WorldPack, a video world model designed to
  improve long-term spatial consistency in generated video sequences. The main challenge
  addressed is the difficulty of maintaining temporal and spatial coherence over extended
  horizons due to the high computational cost of processing long-context inputs in
  video generation.
---

# WorldPack: Compressed Memory Improves Spatial Consistency in Video World Modeling

## Quick Facts
- **arXiv ID**: 2512.02473
- **Source URL**: https://arxiv.org/abs/2512.02473
- **Reference count**: 36
- **Primary result**: WorldPack outperforms baselines (Oasis, MineWorld, DIAMOND, NWM) on LoopNav benchmark with better spatial consistency and fidelity in long-term video generation using shorter context lengths

## Executive Summary
This paper introduces WorldPack, a video world model designed to improve long-term spatial consistency in generated video sequences. The main challenge addressed is the difficulty of maintaining temporal and spatial coherence over extended horizons due to the high computational cost of processing long-context inputs in video generation. WorldPack tackles this by introducing a compressed memory mechanism that consists of trajectory packing and memory retrieval. Trajectory packing allows the model to retain more recent information efficiently by compressing older frames, while memory retrieval selectively recalls past scenes with visual overlap to the current prediction target. These components work together to improve spatial reasoning and maintain consistency in long-term rollouts. The model was evaluated on the LoopNav benchmark in Minecraft, which tests spatial memory and reasoning over long horizons.

## Method Summary
WorldPack is a video world model that improves spatial consistency in long-term video generation through compressed memory mechanisms. It uses a Conditional Diffusion Transformer (CDiT) architecture with Rotary Position Embeddings (RoPE) for temporal positioning. The model incorporates two key innovations: trajectory packing, which hierarchically compresses older frames using larger patchify kernels to fit longer temporal horizons into a fixed context window, and heuristic memory retrieval, which selects past observations based on geometric proximity and viewing direction overlap. The system processes Minecraft video sequences from the LoopNav benchmark, predicting future frames conditioned on past observations and navigation actions. Training involves randomly sampling from 19 different context lengths and replacing the last 8 frames with retrieved memories.

## Key Results
- WorldPack achieves state-of-the-art performance on LoopNav benchmark across multiple metrics (SSIM, LPIPS, PSNR, DreamSim)
- The model outperforms strong baselines including Oasis, MineWorld, DIAMOND, and NWM
- WorldPack maintains better spatial consistency in long-term rollouts despite using shorter context lengths
- The compressed memory mechanism enables effective utilization of long-term history while reducing computational cost

## Why This Works (Mechanism)

### Mechanism 1: Hierarchical Trajectory Packing
WorldPack maintains long-term spatial consistency by fitting significantly longer temporal horizons into a fixed context window. Instead of treating all past frames equally, the model applies geometric compression to latent states. Recent frames are preserved at high resolution, while older frames are compressed using larger patchify kernels (e.g., 8×8 instead of 4×4). This reduces the token count for old frames, allowing the context to span 19 frames effectively rather than just 4. The model assumes that fine-grained pixel details are less critical for spatial consistency than the high-level structural cues present in older frames.

### Mechanism 2: Heuristic Memory Retrieval
The model improves scene reconstruction accuracy by explicitly retrieving past observations that overlap with the current field of view, rather than relying solely on autoregressive state propagation. A scoring function calculates the importance of past frames based on the agent's position and viewing direction. It prioritizes frames that are spatially close and aligned with the current view (forward projection) or those facing the opposite direction at a characteristic distance (loop closure). Top-scoring frames are injected into the context. The heuristic assumes that explicit camera field-of-view data is unavailable, so position and yaw/pitch are sufficient proxies for visual overlap.

### Mechanism 3: RoPE-Conditioned Cross-Attention
WorldPack utilizes retrieved memories from arbitrary temporal distances without confusing their temporal order. The model uses Rotary Position Embeddings (RoPE) adapted for temporal positioning, allowing the Conditional Diffusion Transformer (CDiT) to distinguish between a frame from t-100 and t-10 even if they are presented together in the compressed context. The CDiT architecture restricts self-attention to the target frame and uses cross-attention to attend to the packed history, ensuring linear scaling with context length.

## Foundational Learning

- **Concept: Conditional Diffusion Transformers (CDiT)**
  - Why needed here: Unlike standard DiT (quadratic complexity), CDiT separates target-frame self-attention from history cross-attention. This is the architectural prerequisite that makes processing the packed/retrieved context computationally feasible.
  - Quick check question: How does the computational complexity of CDiT differ from a standard full-sequence DiT when processing m history frames? (Answer: CDiT scales linearly with m via cross-attention; DiT scales quadratically.)

- **Concept: Latent Diffusion Models (LDM)**
  - Why needed here: WorldPack operates on compressed latents (z), not pixels. Understanding that "trajectory packing" compresses these latents further (via patchify kernels) is essential to distinguishing VAE compression from WorldPack's temporal packing.
  - Quick check question: Does WorldPack compress raw pixel frames or VAE latent codes? (Answer: Latent codes.)

- **Concept: Autoregressive World Modeling**
  - Why needed here: The model predicts z_{t+1} given z_{t-m:t}. The "World Model" aspect implies that the prediction is conditioned on actions a_t, distinguishing this from pure video generation.
  - Quick check question: In Eq. 3, what role does the action a_t play in the transition model F_θ?

## Architecture Onboarding

- **Component map:** Past frames + Actions -> VAE Encoder -> Memory Bank -> Retrieval Unit -> Packing Module -> CDiT Backbone -> Output
- **Critical path:** The Packing Module and Retrieval Unit are the novel contributions. If the retrieval score weights (w_c, w_a, σ) are misconfigured, the model retrieves irrelevant history. If the packing compression λ is too high, useful gradient information is lost in the latent projection.
- **Design tradeoffs:** The system trades the pixel-perfect fidelity of recent frames for the broad spatial awareness of compressed older frames. The authors chose a deterministic geometric scoring function over a learned retrieval network, reducing training complexity but potentially failing in non-geometric environments.
- **Failure signatures:** "Drifting" Spatial Layout if packing is enabled but retrieval is disabled; Ghosting Artifacts if compression rates are misaligned with input projection layers; Repetition Loops if the exclusion window is too small.
- **First 3 experiments:**
  1. Ablate Retrieval: Run the ABA task with packing enabled but retrieval disabled to measure the drop in SSIM/LPIPS on the return leg (BA) to quantify the value of explicit memory.
  2. Vary Compression λ: Test different compression rates for older frames to find the point where token count reduction outweighs loss of spatial information.
  3. Context Length Scaling: Compare WorldPack (packed context ~2.84 effective frames) against a baseline with raw context length = 19 to verify WorldPack achieves comparable or better accuracy with lower compute.

## Open Questions the Paper Calls Out
1. Can WorldPack effectively generalize to complex, photorealistic environments where precise state information (position and orientation) is unavailable or must be estimated?
2. Does improved spatial consistency via compressed memory directly enhance downstream utility for agents, specifically in policy learning and planning?
3. How robust is the geometric scoring function for memory retrieval when subjected to noise or drift in agent localization?

## Limitations
- The paper does not provide complete training hyperparameters (learning rate, batch size, diffusion schedule, optimizer settings), which could affect reproducibility
- The effectiveness of the heuristic memory retrieval is supported by strong performance on LoopNav, but its reliance on geometric proximity without visual features means it may not generalize to more complex environments
- The computational efficiency claims are plausible given the architecture, but without full implementation details, exact resource savings cannot be verified

## Confidence
- **High Confidence**: The core mechanism of trajectory packing and its ability to compress older frames while preserving spatial consistency is well-supported by quantitative results and architectural design
- **Medium Confidence**: The effectiveness of the heuristic memory retrieval is supported by strong performance on LoopNav, but its reliance on geometric proximity without visual features means it may not generalize to more complex environments
- **Medium Confidence**: The computational efficiency claims (linear scaling via CDiT) are plausible given the architecture, but without full implementation details, exact resource savings cannot be verified

## Next Checks
1. Ablation Study on Memory Retrieval: Run the ABA task with packing enabled but retrieval disabled to measure the exact contribution of the retrieval mechanism to spatial consistency on return trajectories
2. Compression Rate Sensitivity Analysis: Systematically vary the compression ratio λ and measure the trade-off between token reduction and reconstruction quality to identify the optimal compression level
3. Cross-Environment Generalization Test: Evaluate WorldPack on a benchmark with non-geometric visual variations (e.g., changing lighting or textures) to assess the limitations of the geometric retrieval heuristic