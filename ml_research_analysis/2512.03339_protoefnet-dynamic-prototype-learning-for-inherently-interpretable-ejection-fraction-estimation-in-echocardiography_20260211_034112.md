---
ver: rpa2
title: 'ProtoEFNet: Dynamic Prototype Learning for Inherently Interpretable Ejection
  Fraction Estimation in Echocardiography'
arxiv_id: '2512.03339'
source_url: https://arxiv.org/abs/2512.03339
tags:
- prototype
- prototypes
- protoefnet
- learning
- estimation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: ProtoEFNet introduces a video-based prototype learning approach
  for continuous ejection fraction (EF) estimation in echocardiography. The method
  learns dynamic spatiotemporal prototypes that capture clinically relevant cardiac
  motion patterns, enhanced by a novel Prototype Angular Separation (PAS) loss to
  enforce discriminative representations across the continuous EF spectrum.
---

# ProtoEFNet: Dynamic Prototype Learning for Inherently Interpretable Ejection Fraction Estimation in Echocardiography

## Quick Facts
- arXiv ID: 2512.03339
- Source URL: https://arxiv.org/abs/2512.03339
- Reference count: 26
- Primary result: Achieves accuracy on par with black-box models while providing interpretable prototypes for continuous EF estimation

## Executive Summary
ProtoEFNet introduces a video-based prototype learning approach for continuous ejection fraction (EF) estimation in echocardiography. The method learns dynamic spatiotemporal prototypes that capture clinically relevant cardiac motion patterns, enhanced by a novel Prototype Angular Separation (PAS) loss to enforce discriminative representations across the continuous EF spectrum. Experiments on the EchoNet-Dynamic dataset show that ProtoEFNet achieves accuracy on par with non-interpretable black-box models while providing clinically relevant explanations. The ablation study demonstrates that the PAS loss improves performance with a 2% increase in F1 score (from 77.67±2.68 to 79.64±2.10).

## Method Summary
ProtoEFNet uses a video-based prototype learning framework for continuous EF estimation. The model employs an R(2+1)D-18 backbone pretrained on Kinetics to extract spatiotemporal features from 64-frame echocardiography videos. These features are compared to 40 learnable prototype vectors representing the EF spectrum (10-90%). A weighted regression layer predicts EF based on prototype similarities, with a novel PAS loss enforcing angular separation between prototypes from different EF regions. The ROI module generates occurrence maps that highlight relevant cardiac structures, and an L1 regularization term anchors attention to the left ventricle anatomy.

## Key Results
- Achieves R²≈80, MAE≈4.07, F1≈78 on EchoNet-Dynamic test set
- PAS loss improves F1 score by 2% (77.67±2.68 to 79.64±2.10)
- Superior localization focusing on LV wall and mitral/aortic valves vs black-box methods
- Prototype visualizations show clinically meaningful cardiac motion patterns

## Why This Works (Mechanism)

### Mechanism 1: Prototype-Weighted Regression via Sparse Similarity Voting
ProtoEFNet produces interpretable, continuous EF predictions by computing a weighted average of prototype labels, where weights derive from similarity scores between input features and learned prototypes. The model encodes input video into spatiotemporal features F(x), computes cosine similarity sk between features and each prototype pk, then applies softmax with temperature τ=0.2 to produce contribution weights βk. Final prediction ŷ = Σ βk · lk, where lk are prototype EF labels uniformly distributed from 10% to 90%. Core assumption: The continuous EF space can be meaningfully spanned by a discrete set of prototypes whose learned labels and features capture the spectrum of cardiac motion patterns.

### Mechanism 2: Prototype Angular Separation (PAS) Loss Enforces Embedding Ordinality
PAS loss improves regression performance by enforcing angular separation between prototypes from different EF regions while preserving smooth transitions for nearby EF values. For each prototype pi, PAS computes average log angular similarity with prototypes pj where |li - lj| > Δl (threshold 5%). Angular similarity AS = 1 - (1/π)arccos(CS). The loss pushes distant-EF prototypes apart in embedding space. Core assumption: Prototypes representing clinically distinct EF ranges should occupy distinct regions of the latent space, and this separation improves both interpretability and generalization.

### Mechanism 3: Occurrence Map Regularization Anchors Attention to Left Ventricle Anatomy
Incorporating LV segmentation masks into L1 regularization focuses occurrence maps on clinically relevant cardiac structures, reducing spurious attention to background. ROI module Mpk generates occurrence maps highlighting spatiotemporal regions relevant to prototype pk. L1 penalty on activations outside LV mask reduces attention to irrelevant regions. Weighted average pooling uses occurrence maps to aggregate features. Core assumption: Clinically valid EF estimation depends on localizing LV wall motion and valve activity; diffuse attention indicates poor feature grounding.

## Foundational Learning

- Concept: Cosine similarity and angular distance in embedding spaces
  - Why needed here: ProtoEFNet relies entirely on cosine similarity between features and prototypes; PAS loss transforms this to angular similarity. Understanding the relationship (angular similarity = 1 - arccos(cosine)/π) is essential for debugging embedding collapse.
  - Quick check question: If two prototypes have cosine similarity 0.7, what is their angular similarity? (Answer: 1 - arccos(0.7)/π ≈ 0.78)

- Concept: Temperature-scaled softmax for sparse attention
  - Why needed here: τ=0.2 in Equation 1 forces sharp distribution over prototype contributions, enabling "only prototypes with EF values close to true label" to influence prediction.
  - Quick check question: What happens to βk distribution if τ → ∞? (Answer: Approaches uniform distribution, losing sparsity)

- Concept: Video feature extraction with R(2+1)D backbones
  - Why needed here: Feature extractor uses R(2+1)D-18 pretrained on Kinetics; this decomposes 3D convolutions into (2+1)D for better spatiotemporal modeling. Fine-tuning strategy differs by component (backbone: 1e-4, ROI module: 1e-3).
  - Quick check question: Why would pretrained action recognition features transfer to echocardiography? (Assumption: Both domains require motion pattern recognition; cardiac motion shares temporal structure with human actions.)

## Architecture Onboarding

- Component map:
  Input (64-frame video) -> R(2+1)D-18 backbone -> Feature module F(.) -> ROI module Mpk(.) -> Prototype layer (40 vectors) -> Weighted regression layer

- Critical path:
  1. Input → Backbone → Feature module → F(x) [H×W×T×D]
  2. F(x) + prototypes → ROI module → occurrence maps + pooled features per prototype
  3. Pooled features vs prototypes → cosine similarity scores → temperature-scaled softmax
  4. Similarity weights × prototype labels → weighted sum → EF prediction
  5. Final epoch: project prototypes to nearest training sample within Δl

- Design tradeoffs:
  - 40 prototypes: More prototypes increase expressiveness but risk overfitting; uniform label initialization ensures coverage including "low-density regions"
  - Δl = 5.0%: Controls prototype-label proximity for clustering; smaller values enforce tighter clusters but may leave regions undersampled
  - Oversampling EF<50%: Addresses label imbalance but introduces distribution shift vs real clinical data

- Failure signatures:
  - All βk converge to uniform (τ too high or prototypes collapsed)
  - Prototypes project to same training sample (PAS too weak, PSD loss needed)
  - Occurrence maps highlight background (LOccur weight too low or LV mask unreliable)
  - MAE plateaus higher than baseline (cluster loss too aggressive, breaking ordinality)

- First 3 experiments:
  1. Baseline reproduction: Train ProtoEFNet on EchoNet-Dynamic with default hyperparameters (40 prototypes, τ=0.2, Δl=5.0%), verify R²≈80, MAE≈4.07, F1≈78 on test set.
  2. PAS ablation: Remove LPAS from loss, train 5 repetitions, confirm MAE degrades from 4.20±0.06 to 4.23±0.11 and F1 drops from 79.64±2.10 to 77.67±2.68 per paper's ablation.
  3. Occurrence map visualization: On 10 test videos with EF<40% and 10 with EF>60%, visualize activation maps; qualitatively confirm LV wall and mitral valve focus vs Grad-CAM baseline from CoReEcho.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the prototype learning framework be optimized to robustly represent uncommon EF ranges (minority regions) without relying on oversampling?
- Basis in paper: [explicit] The conclusion states: "Future work will address prototype learning for uncommon EF ranges (minority region)." Additionally, the methods section notes that "addressing imbalance was beyond the scope of this study."
- Why unresolved: The current approach uses uniform prototype initialization and basic oversampling, which may fail to capture discriminative features in sparse regions of the continuous EF spectrum (e.g., extreme hypo/hyperkinetic cases).
- What evidence would resolve it: A comparative study evaluating the quality and distinctness of prototypes learned specifically for low-prevalence EF ranges using advanced imbalance handling techniques (e.g., cost-sensitive losses) versus the current oversampling method.

### Open Question 2
- Question: Can the clinical relevance of the learned spatiotemporal prototypes be validated quantitatively rather than solely through qualitative visual inspection?
- Basis in paper: [inferred] The paper claims the model "focuses on essential cardiac features" based on "Qualitative analysis" (Figures 2 and 3), lacking statistical correlation with ground-truth anatomical landmarks.
- Why unresolved: While the visualizations appear to align with cardiac structures, the lack of quantitative metrics (e.g., segmentation overlap) leaves the anatomical faithfulness of the "dynamic spatiotemporal prototypes" uncertain.
- What evidence would resolve it: Quantitative measurements, such as Intersection-over-Union (IoU) or centroid distance, comparing the model's activation maps against expert-annotated mitral valve and left ventricular wall landmarks across the test set.

### Open Question 3
- Question: How sensitive is the regression accuracy to the specific hyperparameter settings for prototype separation and contribution sparsity?
- Basis in paper: [inferred] The paper utilizes specific fixed hyperparameters, such as the softmax temperature (τ=0.2) and the separation threshold (Δl = 5.0%), to enforce distinctness and ordinality.
- Why unresolved: The paper demonstrates that adding the PAS loss improves performance, but it does not analyze the sensitivity of the F1 score or MAE to changes in the temperature or the angular separation margins, which are critical for the model's reasoning transparency.
- What evidence would resolve it: A sensitivity analysis reporting the change in regression error and prototype diversity (Sparsity/Diversity metrics) as τ and Δl are varied.

## Limitations
- Specific architecture of feature and ROI modules is referenced from prior work without full elaboration, affecting reproducibility
- Prototype learning approach may have limited generalizability to datasets with different cardiac imaging protocols or lower-quality echocardiograms
- Clinical validation of interpretability is primarily qualitative through visualization, lacking quantitative assessment of clinical decision-making impact

## Confidence
- High confidence: ProtoEFNet's quantitative performance metrics (R², MAE, F1 score) and the ablation study demonstrating PAS loss improvement (2% F1 increase)
- Medium confidence: Interpretability claims based on qualitative visualization comparisons with black-box methods
- Medium confidence: The assumption that 40 prototypes with uniform EF distribution adequately span the continuous EF space

## Next Checks
1. Reproduce the ablation study results by training ProtoEFNet with and without PAS loss across multiple random seeds to confirm the 2% F1 improvement
2. Conduct a quantitative comparison of prototype embeddings using PCA/t-SNE to verify that PAS loss creates distinct angular separation between EF regions
3. Test model performance on an independent echocardiography dataset (e.g., CAMUS) to assess generalizability beyond EchoNet-Dynamic