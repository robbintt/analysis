---
ver: rpa2
title: Inferring stochastic dynamics with growth from cross-sectional data
arxiv_id: '2505.13197'
source_url: https://arxiv.org/abs/2505.13197
tags:
- growth
- upfi
- dynamics
- drift
- system
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses the challenge of inferring stochastic dynamics
  with growth from cross-sectional single-cell data, where direct observation of temporal
  trajectories is impossible. The core method, unbalanced probability flow inference
  (UPFI), extends probability flow inference to account for cellular proliferation
  and death by leveraging a Lagrangian formulation of the Fokker-Planck equation with
  source terms.
---

# Inferring stochastic dynamics with growth from cross-sectional data

## Quick Facts
- arXiv ID: 2505.13197
- Source URL: https://arxiv.org/abs/2505.13197
- Reference count: 40
- The paper presents UPFI, a method that accurately disentangles drift, intrinsic noise, and growth from cross-sectional single-cell data, achieving significantly higher accuracy than existing methods in reconstructing stochastic dynamics.

## Executive Summary
This paper addresses the fundamental challenge of inferring stochastic dynamics with growth from cross-sectional single-cell data where direct temporal observations are impossible. The authors develop UPFI (Unbalanced Probability Flow Inference), which extends probability flow inference to account for cellular proliferation and death through a Lagrangian formulation of the Fokker-Planck equation with source terms. By leveraging score matching followed by neural-ODE based learning, UPFI accurately reconstructs drift fields, growth rates, and fate probabilities from population snapshots.

The method demonstrates superior performance compared to existing approaches across various simulated and real single-cell RNA-seq datasets. In high-dimensional bifurcating systems, UPFI achieves path energy distances below 0.3 compared to over 1.0 for competing methods, with Pearson correlations for fate probabilities exceeding 0.95. The approach successfully handles both additive and multiplicative noise models and produces biologically plausible growth rates when applied to lineage tracing data.

## Method Summary
UPFI addresses the challenge of inferring stochastic dynamics with growth from cross-sectional population snapshots by reformulating the Fokker-Planck equation in Lagrangian coordinates. The method operates in two stages: first, it estimates the score function (∇ log ρ) using denoising score matching, then jointly infers the drift field and growth rate by minimizing an unbalanced Sinkhorn divergence between predicted and observed population measures. A regularization term based on Wasserstein-Fisher-Rao energy ensures unique solutions by penalizing complex fields. The approach handles the inherent non-identifiability between drift and growth through an autonomous dynamics assumption and appropriate regularization.

## Key Results
- UPFI achieves path energy distances below 0.3 in high-dimensional bifurcating systems, compared to over 1.0 for competing methods
- Pearson correlations for fate probabilities exceed 0.95, demonstrating accurate branching structure recovery
- The method successfully disentangles drift, growth, and intrinsic noise in both additive and multiplicative noise models
- Applied to lineage tracing data, UPFI produces biologically plausible growth rates consistent with experimental observations

## Why This Works (Mechanism)

### Mechanism 1: Lagrangian Score-Based Decomposition
The core insight is rewriting the Fokker-Planck equation with a source term into its Lagrangian (probability flow) form, expressing density evolution along trajectories where the phase-space velocity depends on drift, diffusivity, and the score of the density. This score is learned separately via score matching and is independent of total mass, allowing it to be fixed before inferring drift and growth. The method assumes the system follows a branching diffusion process accurately modeled by the Fokker-Planck equation.

### Mechanism 2: Joint Inference with Unbalanced Sinkhorn Divergence
Neural networks parameterize drift and growth, and particles are pushed forward in time by the learned neural ODE with masses scaled by the growth function. The training objective minimizes unbalanced Sinkhorn divergence between predicted and observed snapshots, chosen specifically because it can compare measures with different total masses - critical for modeling growing populations.

### Mechanism 3: Regularization for Identifiability
Theoretical analysis reveals different combinations of drift and growth can produce identical population marginals, creating non-identifiability. The Wasserstein-Fisher-Rao energy term penalizes complex fields, imposing an inductive bias for simpler solutions. This ensures the optimization problem has a unique minimizer, resolving the fundamental ambiguity between drift and growth effects.

## Foundational Learning

- **Fokker-Planck Equation (FPE) with Source Term**: Governing physical model describing population density evolution under drift, diffusion, and growth. In the equation ∂ₜρₜ = -∇·(ρₜvₜ - ∇·(ρₜDₜ)) + gₜρₜ, the term gₜρₜ represents net growth rate from birth and death.
- **Score Matching and the Score Function**: Technique to learn ∇ log ρₜ(x) directly from data samples. Estimating the score function is often more practical than estimating full density in high-dimensional spaces because it avoids computing the normalization constant required for the density itself.
- **Unbalanced Optimal Transport**: Loss function that can compare measures with different total masses. The unbalanced Sinkhorn divergence is suitable because it relaxes the hard marginal constraint (mass conservation) with a soft penalty, allowing for mass imbalance in growing populations.

## Architecture Onboarding

- **Component map**: Score Network (s_φ) → Force Network (v_θ) → Growth Network (g_θ) → ODE Solver → Loss Module
- **Critical path**:
  1. Preprocess: Obtain cross-sectional snapshots
  2. Train Score Network: Learn s_φ using denoising score matching (offline)
  3. Train Dynamics: Initialize Force/Growth networks, integrate particles forward, form predicted measures, compute unbalanced Sinkhorn divergence loss
  4. Output: Trained Force and Growth networks
- **Design tradeoffs**: Autonomous vs. non-autonomous dynamics for identifiability; network size vs. regularization strength; additive vs. multiplicative noise models
- **Failure signatures**: Spurious drifts connecting bifurcating branches; training instability with diverging loss; inaccurate score estimation corrupting entire pipeline
- **First 3 experiments**:
  1. Reproduce Bistable System (d=10) to validate pipeline accuracy on known ground truth
  2. Regularization ablation by varying λ and α to understand impact on force error vs. growth correlation
  3. Apply to lineage tracing dataset, comparing inferred drift against RNA velocity and fate probabilities against lineage barcodes

## Open Questions the Paper Calls Out

- **Open Question 1**: Can theoretical non-identifiability between drift and growth be resolved in non-autonomous systems without relying on autonomous dynamics assumption? The paper acknowledges fundamental mathematical ambiguity for time-dependent forces remains open.
- **Open Question 2**: How does computational cost of unbalanced Sinkhorn divergence limit UPFI's scalability to full genome-wide single-cell datasets? The method handles "moderately high dimensions" but requires PCA reduction for real data, suggesting scalability to raw high-dimensional data is unproven.
- **Open Question 3**: Is it possible to correct time-dependent bias in inferred fitness field when only relative frequencies of cell populations are available? The method requires population size estimates to infer absolute growth rates; bias inherent in frequency-only data is acknowledged but not corrected.

## Limitations

- The reliance on autonomous drift/growth as an inductive bias may limit temporal flexibility in certain biological systems
- Method's accuracy is fundamentally limited by quality of initial score matching step, particularly in high-dimensional settings
- Two-stage training process and ODE solvers may limit scalability to very large datasets or extremely high-dimensional systems

## Confidence

- **High Confidence**: Theoretical framework for Lagrangian reformulation and unbalanced Sinkhorn divergence; empirical performance on synthetic bifurcating systems
- **Medium Confidence**: Effectiveness of regularization for resolving identifiability issues; biological plausibility of results on real lineage tracing data
- **Low Confidence**: Generalizability to extremely high-dimensional systems (>100 dimensions) and complex non-autonomous dynamics beyond tested scenarios

## Next Checks

1. Cross-validation on biological datasets: Apply UPFI to independent single-cell RNA-seq datasets with known developmental trajectories and compare inferred fate probabilities against experimental lineage tracing results
2. Robustness to sampling noise: Systematically vary number of cells per snapshot and measurement noise levels to quantify UPFI's sensitivity to data quality and quantity limitations
3. Scalability benchmark: Test UPFI on simulated high-dimensional systems (d > 50) with varying degrees of nonlinearity to identify computational bottlenecks and evaluate performance degradation