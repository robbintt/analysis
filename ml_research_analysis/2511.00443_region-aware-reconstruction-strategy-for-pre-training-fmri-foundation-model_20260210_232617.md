---
ver: rpa2
title: Region-Aware Reconstruction Strategy for Pre-training fMRI Foundation Model
arxiv_id: '2511.00443'
source_url: https://arxiv.org/abs/2511.00443
tags:
- masking
- regions
- fmri
- reconstruction
- brain
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces a region-aware reconstruction strategy for
  pre-training fMRI foundation models by integrating anatomical regions into the masking
  process using the AAL3 atlas. Unlike conventional random masking, this approach
  selectively masks semantically coherent brain regions during self-supervised pretraining,
  applied directly to full 4D fMRI volumes.
---

# Region-Aware Reconstruction Strategy for Pre-training fMRI Foundation Model

## Quick Facts
- arXiv ID: 2511.00443
- Source URL: https://arxiv.org/abs/2511.00443
- Reference count: 30
- 4.23% accuracy improvement over random masking for ADHD classification

## Executive Summary
This study introduces a region-aware reconstruction strategy for pre-training fMRI foundation models by integrating anatomical regions into the masking process using the AAL3 atlas. Unlike conventional random masking, this approach selectively masks semantically coherent brain regions during self-supervised pretraining, applied directly to full 4D fMRI volumes. Evaluated on the ADHD-200 dataset (973 subjects), the method achieved a 4.23% improvement in classification accuracy for distinguishing healthy controls from individuals with ADHD compared to random masking. Region-level attribution analysis revealed that brain volumes within the limbic region and cerebellum contribute most significantly to reconstruction fidelity and model representation. These results demonstrate that incorporating anatomical structure into the masking process enhances both interpretability and discriminative power in fMRI-based models.

## Method Summary
The method modifies the NeuroSTORM framework by replacing random spatial-temporal masking with anatomically-guided "tube" masking. Using the AAL3 atlas (170 ROIs), researchers create binary masks that select entire anatomical regions across all timepoints, then mask these regions during pretraining. The approach maintains the shifted-window Mamba encoder and reconstruction decoder architecture while changing only the masking strategy. ROI selection is based on prior literature linking specific brain regions to ADHD pathophysiology. The model is pretrained on full 4D fMRI volumes and then fine-tuned for downstream classification tasks.

## Key Results
- 4.23% accuracy improvement (68.05% vs 63.82%) when masking cerebellum region for ADHD classification
- Limbic region masking achieved highest AUCROC of 0.752 among single-ROI conditions
- Random masking yielded lowest MSE (0.0311) but poorest downstream classification performance
- Combined ROI masking showed no consistent improvement over best single-ROI results

## Why This Works (Mechanism)

### Mechanism 1
- Claim: ROI-guided masking produces superior downstream representations despite higher reconstruction error because it eliminates the "easy reconstruction" shortcut from background voxels.
- Mechanism: Random masking samples uniformly across space, inadvertently including non-brain voxels (background with near-zero signal). These are trivially reconstructable, inflating performance metrics while providing no learning signal. ROI-constrained masking forces the model to predict meaningful neural activity exclusively, which is harder but yields more discriminative representations.
- Core assumption: Higher reconstruction difficulty for brain-relevant signals correlates with better downstream task representations.
- Evidence anchors:
  - [abstract] "selectively mask semantically coherent brain regions during self-supervised pretraining"
  - [results] "random tube masking yielded the lowest MSE (0.0311)... can be attributed to the nature of the random masking strategy, which often includes non-brain regions... easier to reconstruct"
  - [corpus] NeuroSTORM paper (arxiv 2506.11167) confirms original framework uses fixed 10% masking without anatomical constraints
- Break condition: If downstream task requires representations of non-local/global brain patterns rather than region-specific features, the ROI masking constraint may limit transferability.

### Mechanism 2
- Claim: Masking disease-relevant anatomical regions during pretraining aligns learned representations with clinical discrimination boundaries.
- Mechanism: By selectively masking limbic regions and cerebellum—both implicated in ADHD pathophysiology—the model is forced to reconstruct signals from regions most relevant to the downstream classification task. This creates an inductive bias toward representations that capture disease-specific variance.
- Core assumption: Assumption: The reconstructive challenge posed by masking a region increases the model's sensitivity to that region's functional signatures during downstream tasks.
- Evidence anchors:
  - [abstract] "brain volumes within the limbic region and cerebellum contribute most significantly to reconstruction fidelity"
  - [results] Cerebellum masking: 68.05% ACC vs 63.82% baseline; Limbic: 68.08% ACC with highest AUCROC (0.752)
  - [introduction] References prior ADHD literature implicating limbic [17] and cerebellum [18] in attentional control
- Break condition: If the target clinical population has different neuropathological substrates (e.g., schizophrenia, autism), the optimal masking regions may differ substantially.

### Mechanism 3
- Claim: Tube-style temporal masking of anatomical ROIs preserves functional connectivity patterns while creating a tractable reconstruction objective.
- Mechanism: By masking the same spatial region across all timepoints ("tube" masking), the model must infer regional activity from surrounding brain areas' timecourses, implicitly learning inter-regional functional dependencies without destroying temporal coherence.
- Core assumption: Assumption: Functional connectivity between masked and unmasked regions provides sufficient signal for accurate reconstruction.
- Evidence anchors:
  - [methods] "temporal masking dimension is equivalent to the tube setting, since we mask the same anatomical regions throughout the entire sequence"
  - [methods] "This encourages the model to focus on reconstructing meaningful brain dynamics within targeted regions"
  - [corpus] Weak/missing: No corpus papers specifically validate tube masking vs. other temporal strategies for fMRI
- Break condition: If temporal dynamics within a region are largely independent of other regions (low functional connectivity), tube masking may create an unsolvable reconstruction task.

## Foundational Learning

- Concept: **Masked Autoencoder (MAE) Pretraining**
  - Why needed here: The entire framework builds on MAE principles—masking input patches and training the model to reconstruct them. Without this baseline understanding, the ROI modification lacks context.
  - Quick check question: Can you explain why masking ~75% of image patches in vision MAEs works better than 50%, and how this relates to the 10% masking ratio used here?

- Concept: **4D fMRI Data Structure (Spatial × Temporal)**
  - Why needed here: The method operates on full 4D volumes rather than pre-extracted time series. Understanding the tensor shape (X×Y×Z×T) is essential for implementing ROI masking correctly.
  - Quick check question: Given a 96×96×96×200 fMRI volume, how would you apply a binary mask for the cerebellum (24,414 voxels) across all 200 timepoints?

- Concept: **Anatomical Brain Atlases (AAL3)**
  - Why needed here: ROI definitions come from AAL3, which parcels the brain into 170 regions. The method's success depends on atlas quality and alignment to fMRI data.
  - Quick check question: What preprocessing steps are required to align a subject's native fMRI to the MNI152 space where AAL3 labels are defined?

## Architecture Onboarding

- Component map:
Input (4D fMRI volume) 
    → [AAL3 Atlas Alignment] → ROI Mask Generation
    → [NeuroSTORM Encoder: Shifted-Window Mamba backbone]
    → [NeuroSTORM Decoder: Reconstruction head]
    → [Pretraining Loss: MSE on masked voxels only]

Fine-tuning:
    → [Frozen Encoder] → [Trainable Output Head] → Classification

- Critical path:
  1. Atlas-to-subject alignment (MNI152 registration at 2mm isotropic)
  2. ROI selection and mask tensor creation (binary mask × temporal extent)
  3. Encoder forward pass through SWM backbone (7.7M parameters)
  4. Masked reconstruction loss computation
  5. Downstream: freeze encoder, train classifier head

- Design tradeoffs:
  - **Larger ROI masking (frontal: 29%)** vs. **smaller ROI (subcortical: 3.86%)**: Larger regions create harder reconstruction but may obscure fine-grained patterns; smaller regions are easier but may not challenge the model sufficiently.
  - **Single-region vs. combined-region masking**: Binary combinations (frontal+cerebellum) showed mixed results—no consistent improvement over best single-region.
  - **50% partial masking**: Tested but did not yield consistent gains, suggesting full-region masking provides stronger learning signal.

- Failure signatures:
  - **Unexpectedly low MSE with random masking**: Indicates model is exploiting background voxels—switch to ROI-constrained masking.
  - **High reconstruction error but low classification accuracy**: May indicate masked region is not task-relevant (e.g., occipital lobe: 64.89% ACC despite high MSE 0.0893).
  - **Large accuracy variance across ROIs**: Confirms masking strategy matters; if all ROIs perform similarly, preprocessing or implementation may be incorrect.

- First 3 experiments:
  1. **Baseline validation**: Replicate random tube masking results (target: ~63.8% ACC) to confirm NeuroSTORM setup is correct before implementing ROI changes.
  2. **Single-ROI sweep**: Mask each major region (frontal, parietal, temporal, occipital, cerebellum, limbic, subcortical) independently and plot both MSE and downstream ACC to verify the inverse relationship observed in the paper.
  3. **Region ablation on held-out site**: Train on N-1 sites from ADHD-200, test on held-out site to assess whether ROI benefits generalize across scanner protocols (critical for clinical deployment claims).

## Open Questions the Paper Calls Out
None

## Limitations
- Narrow clinical validation on single ADHD classification task limits generalizability to other neurological conditions
- AAL3 atlas alignment introduces potential anatomical inaccuracies due to individual brain morphology variations
- Tube masking strategy may not capture optimal cross-regional functional dependencies
- Lacks comparison against more recent state-of-the-art self-supervised learning approaches

## Confidence
- **High Confidence**: The inverse relationship between reconstruction difficulty and downstream classification performance is well-supported by direct experimental comparisons showing random masking's inflated MSE due to background voxel inclusion.
- **Medium Confidence**: The disease-relevant masking hypothesis is plausible given the limbic and cerebellum results, but the ADHD-specific nature of the findings limits confidence in broader clinical applicability.
- **Low Confidence**: The temporal masking mechanism lacks direct validation; the paper assumes tube masking preserves functional connectivity without empirical evidence comparing different temporal masking strategies.

## Next Checks
1. **Cross-Disorder Validation**: Apply ROI masking to a different clinical population (e.g., schizophrenia or autism datasets) to test whether limbic/cerebellum masking remains optimal or if different regions show superior performance.
2. **Temporal Masking Ablation**: Implement alternative temporal masking strategies (e.g., random temporal sampling, block masking) and compare reconstruction quality and downstream task performance to assess whether tube masking is truly optimal.
3. **Multi-Atlas Robustness**: Repeat experiments using alternative anatomical atlases (e.g., Harvard-Oxford, Destrieux) to determine whether the observed ROI benefits depend critically on AAL3's parcellation scheme or represent more general principles of anatomical masking.