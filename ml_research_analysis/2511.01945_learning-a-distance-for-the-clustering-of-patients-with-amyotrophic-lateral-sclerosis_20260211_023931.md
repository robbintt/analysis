---
ver: rpa2
title: Learning a Distance for the Clustering of Patients with Amyotrophic Lateral
  Sclerosis
arxiv_id: '2511.01945'
source_url: https://arxiv.org/abs/2511.01945
tags:
- clusters
- score
- clustering
- patients
- umap
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study proposes a method for clustering ALS patients using
  a weak-supervised learning approach combined with descriptive variables extracted
  from ALSFRS-R sequences. The method learns distance measures between patients, capturing
  disease progression patterns, and pairs them with clustering methods.
---

# Learning a Distance for the Clustering of Patients with Amyotrophic Lateral Sclerosis

## Quick Facts
- arXiv ID: 2511.01945
- Source URL: https://arxiv.org/abs/2511.01945
- Reference count: 17
- Primary result: Method outperforms state-of-the-art clustering methods for ALS patients, achieving statistically significant survival differences (p < 0.05) while maintaining high silhouette scores (≥0.5)

## Executive Summary
This study presents a weak-supervised learning approach for clustering ALS patients based on ALSFRS-R temporal sequences. The method learns distance measures between patients by extracting descriptive variables from disease progression patterns, then pairs these distances with clustering algorithms. Evaluated on 353 ALS patients, the approach demonstrates superior clinical relevance through survival analysis while achieving mathematically sound cluster separation. The learned distances enable interpretable clustering that captures meaningful disease progression phenotypes, supporting personalized patient care.

## Method Summary
The method extracts 7 descriptive variables from ALSFRS-R sequences (duration, slope, scores, etc.) after fitting sigmoid curves to approximate disease progression. These variables undergo Min-Max normalization and serve as input for distance calculations. The weak-supervised distance (WSD) uses Snorkel to aggregate noisy expert heuristics via labeling functions, which a linear SVM converts into weighted distance measures. The approach tests four distance types (Manhattan, Euclidean, Cosine, WSD) combined with three clustering methods (K-Means, K-Medoids, AHC) with and without UMAP dimensionality reduction, evaluating 109 workflows across k=2-6 clusters.

## Key Results
- WSD-based workflows achieved statistically significant survival differences (p < 0.05) between clusters
- Multiple workflows reached high silhouette scores (≥0.5) while maintaining clinical relevance
- UMAP integration was critical, with workflows lacking UMAP consistently producing silhouette scores below 0.5
- The approach successfully balanced cluster compactness with meaningful clinical separation

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Weak supervision converts clinical intuition into a learnable distance metric without ground truth labels.
- **Mechanism:** Clinical heuristics encoded as labeling functions vote on patient pair grouping based on descriptive variable distributions. Snorkel aggregates these noisy votes, and a linear SVM learns weights for each variable, creating a weighted distance that reflects domain relevance.
- **Core assumption:** Statistical distributions of descriptive variables align with clinically meaningful boundaries.
- **Evidence anchors:** Seven labeling functions based on quartiles; Snorkel probabilistic voting system; linear SVM learns variable weights.
- **Break condition:** If labeling functions are uncorrelated with actual patient similarity, learned weights amplify noise rather than signal.

### Mechanism 2
- **Claim:** UMAP dimensionality reduction acts as a topology filter that enhances cluster separation in heterogeneous clinical data.
- **Mechanism:** Raw distance matrices are projected into lower-dimensional space using UMAP, prioritizing local neighborhood preservation and effectively "cleaning" the signal for partition-based algorithms.
- **Core assumption:** Underlying clinical phenotypes form distinct manifolds that can be disentangled by non-linear dimensionality reduction.
- **Evidence anchors:** Most workflows use UMAP; those without UMAP show silhouette scores below 0.5; approach outperforms state-of-the-art methods.
- **Break condition:** If data exists on a continuous spectrum rather than distinct islands, UMAP may artificially tear the manifold to force cluster separation.

### Mechanism 3
- **Claim:** Sigmoid-based sequence approximation provides robust temporal alignment superior to standard Dynamic Time Warping for irregular visits.
- **Mechanism:** Fits parametric sigmoid curves to each patient's sparse ALSFRS-R sequence, extracting normalized features comparable across patients regardless of visit frequency or duration.
- **Core assumption:** Disease progression follows sigmoid-like decline amenable to parametric modeling, even with sparse data.
- **Evidence anchors:** Reuses state-of-the-art sigmoid fitting strategy; achieves mean error below 2 on ALSFRS-R score; deemed acceptable by authors.
- **Break condition:** If patient progression is non-monotonic or erratic, sigmoid fit misrepresents trajectory, injecting error into distance calculation.

## Foundational Learning

- **Concept: Weak Supervision (Data Programming)**
  - **Why needed here:** Lacks ground truth cluster labels; understanding how Snorkel uses generative modeling to unify noisy heuristics is essential to grasp how WSD distance is derived.
  - **Quick check question:** How does the system handle conflict when one labeling function votes "group" and another votes "separate"?

- **Concept: Survival Analysis (Log-Rank Test)**
  - **Why needed here:** Primary evaluation metric is statistical difference in survival curves between clusters; high silhouette scores are rejected if survival differences are insignificant.
  - **Quick check question:** Why is a high Log-Rank Statistic coupled with a low p-value desirable in this context?

- **Concept: Internal vs. External Validation Metrics**
  - **Why needed here:** Demonstrates divergence between internal metrics (Silhouette) and external clinical reality (Survival).
  - **Quick check question:** Why did workflow `COS_AHC_2` have high Silhouette score (0.93) but poor clinical utility?

## Architecture Onboarding

- **Component map:** Preprocessor → Feature Engine → Distance Learner → Clusterer
- **Critical path:** Definition of Labeling Functions (LFs). If LFs do not capture clinical intuition correctly, WSD will fail to learn meaningful weights.
- **Design tradeoffs:**
  - Interpretability vs. Performance: WSD is interpretable (weighted features), but simple Cosine distance on UMAP embeddings sometimes achieved higher silhouette scores
  - Sigmoid Smoothing vs. Raw Data: Fitting sigmoid smooths noise but risks over-regularizing unique progression patterns
- **Failure signatures:**
  - High Silhouette, Low LRS: Compact clusters lacking clinical meaning (e.g., `COS_AHC_2`)
  - Cluster Imbalance: One large cluster and tiny outliers (< 5% of data) indicate non-representative results
- **First 3 experiments:**
  1. Sigmoid Fit Validation: Measure RMSE of sigmoid approximation across cohort to ensure "error below 2" condition
  2. Ablation on LFs: Remove labeling functions one by one to observe stability of WSD weights
  3. Metric Divergence Check: Plot Silhouette Score vs. Log-Rank Statistic for all 109 workflows to identify correlation patterns

## Open Questions the Paper Calls Out

- Can the proposed weak-supervised distance method maintain robustness when applied to larger, multi-center datasets? (Current study restricted to single-center cohort of 353 patients)
- Does incorporating temporal dynamics via time-window analysis improve clinical relevance of patient clusters? (Current method aggregates sequences into static descriptive variables)
- Can the distance learning approach be generalized to other progressive diseases with heterogeneous progression patterns? (Current variables and sigmoid fitting tailored specifically to ALSFRS-R decline)
- Can biological data serve as reliable external evaluation metric for clustering quality? (Current evaluation relies on internal metrics and survival analysis lacking biological ground truth)

## Limitations
- Single-center validation limits generalizability to broader ALS populations
- Weak supervision relies on expert-defined labeling functions without validation against broader clinical consensus
- Sigmoid approximation may misrepresent atypical progression patterns in some patients
- No external biological validation of cluster assignments

## Confidence
- **High confidence**: Core clustering pipeline (sigmoid fitting, descriptive variable extraction, silhouette calculation) is methodologically sound and reproducible
- **Medium confidence**: Survival analysis conclusions supported by statistical tests, though single-center validation limits external validity claims
- **Low confidence**: Weak supervision mechanism's sensitivity to labeling function design choices not adequately explored, making WSD approach's robustness uncertain

## Next Checks
1. Cross-center validation: Apply learned distance measures to ALS datasets from other institutions to test generalizability and identify potential distribution shifts
2. Labeling function ablation study: Systematically remove individual labeling functions to quantify their contribution to final distance metric and assess sensitivity to heuristic design
3. Longitudinal stability analysis: Track how patient cluster assignments change over time to validate that learned distances capture stable disease progression patterns rather than temporary clinical states