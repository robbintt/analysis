---
ver: rpa2
title: Two-Stage Generative Model for Intracranial Aneurysm Meshes with Morphological
  Marker Conditioning
arxiv_id: '2505.10407'
source_url: https://arxiv.org/abs/2505.10407
tags:
- shape
- aneurysm
- generation
- shapes
- aneug
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The authors propose AneuG, a two-stage generative model for intracranial
  aneurysm (IA) meshes that simultaneously models the aneurysm complex and parent
  vessels. The method uses Graph Harmonic Deformation (GHD) for shape encoding and
  a Variational Autoencoder (VAE) architecture with Morphing Energy Alignment (MEA)
  constraints.
---

# Two-Stage Generative Model for Intracranial Aneurysm Meshes with Morphological Marker Conditioning

## Quick Facts
- arXiv ID: 2505.10407
- Source URL: https://arxiv.org/abs/2505.10407
- Reference count: 22
- The proposed AneuG model achieves FPD of 6.06 versus 13.52 for PCA and 45.18 for diffusion methods

## Executive Summary
The authors propose AneuG, a two-stage generative model for intracranial aneurysm meshes that simultaneously models aneurysm complexes and parent vessels. The method uses Graph Harmonic Deformation (GHD) for shape encoding and a Variational Autoencoder (VAE) architecture with Morphing Energy Alignment (MEA) constraints. The model achieves superior performance compared to PCA and diffusion-based methods while enabling controlled generation of IA morphologies with specific clinical morphological parameters.

## Method Summary
AneuG is a two-stage VAE architecture that generates intracranial aneurysm meshes with conditional morphological control. Stage I encodes aneurysm complex geometry using Graph Harmonic Deformation (GHD) tokens derived from cotangent graph Laplacian eigenvectors, modeling p(ϕ | λ) where λ are morphological markers. Stage II generates parent vessel centrelines conditioned on the aneurysm features, modeling p(vessels | ϕ). Morphing Energy Alignment (MEA) prevents posterior collapse by constraining generated shapes to match population-level morphing energy statistics. The two stages are merged to produce complete IA-parent vessel geometries with realistic morphology.

## Key Results
- AneuG achieves FPD of 6.06, outperforming PCA (13.52) and diffusion (45.18) baselines
- Successfully generates IA shapes with controlled aspect ratios, neck widths, and lobulation indices
- Conditioning accuracy improves from 8.72% to 2.93% for aspect ratio with MEA regularization

## Why This Works (Mechanism)

### Mechanism 1: Graph Harmonic Deformation (GHD) for Compact Shape Encoding
GHD tokens provide a low-dimensional, differentiable representation that captures local aneurysm features more effectively than point-wise or occupancy-based encodings. A canonical mesh is morphed toward target meshes via gradient descent, with deformation expressed as a weighted sum of graph Laplacian eigenvectors. The weights (ϕ tokens) become the shape representation.

### Mechanism 2: Two-Stage Factorization of Joint Distribution
Decomposing generation into (1) aneurysm complex → (2) parent vessels improves physiological realism by modeling vessels as conditionally dependent on aneurysm morphology. This factorization enforces anatomical consistency without requiring full joint modeling.

### Mechanism 3: Morphing Energy Alignment (MEA) Prevents Posterior Collapse
Constraining generated shapes to match population-level morphing energy statistics preserves structural detail that would otherwise degrade during conditional training. KL divergence between real and synthetic energy distributions (rigidity, Laplacian smoothness) is added to the loss.

## Foundational Learning

- **Cotangent Graph Laplacian and Spectral Decomposition**: GHD tokens are coefficients of graph Laplacian eigenvectors; understanding spectral modes is essential for interpreting what shape features each token controls.
  - Quick check: Given a mesh, can you explain why low-frequency eigenmodes capture global shape while high-frequency modes capture local detail?

- **Variational Autoencoder (VAE) with Conditional Priors**: Both stages use VAEs; conditional generation requires understanding how λ modulates the latent distribution p(z | λ).
  - Quick check: In a conditional VAE, what happens to the latent space if the conditioning signal is too strong relative to reconstruction loss?

- **Chamfer Distance for Mesh Comparison**: Used in GHD morphing loss and reconstruction evaluation; measures point-set similarity without requiring correspondence.
  - Quick check: Why might Chamfer Distance fail to distinguish between two meshes with identical point distributions but different face connectivity?

## Architecture Onboarding

- **Component map**:
```
Input Mesh → GHD Encoder → ϕ tokens → VAE Encoder → z (latent) → VAE Decoder → Conditional λ → MMC → L_cond ←→ Generated ϕ'
                                        ↓                                  ↓
                                  MEA Loss ← Energy Calculator       Stage I Output → Tangent Extraction → Stage II VAE → Centerline φ, v, l
                                                                                                         ↓
                                                                                   Cross-section Propagation
                                                                                                         ↓
                                                                                   Final Merged Mesh
```

- **Critical path**:
  1. Canonical mesh selection and eigenmode computation (offline, one-time)
  2. GHD token extraction for all training meshes
  3. Stage I VAE training with MEA regularization
  4. MMC fitting on unconditional generations to learn valid λ combinations
  5. Stage II VAE training with tangent alignment loss (LtReg)

- **Design tradeoffs**:
  - **Token truncation (n modes)**: Lower n → faster, but loses local detail. Paper does not specify optimal n.
  - **MEA weight**: Too high → over-regularized, less diverse; too low → posterior collapse. Table 2 suggests MEA critical for conditional settings.
  - **Dataset size vs. diffusion**: VAE chosen for 116-sample regime; diffusion underperforms (FPD 45.18 vs. 6.06).

- **Failure signatures**:
  - Generated aneurysms lack lobulation or daughter sacs → check if n is too low
  - Conditional generation ignores λ → verify MMC is active; check L_cond gradient flow
  - Vessel-aneurysm junction has discontinuity → LtReg loss may be too weak
  - Posterior collapse (all outputs similar) → increase MEA weight or reduce conditioning strength

- **First 3 experiments**:
  1. **Reproduction baseline**: Train unconditional Stage I VAE on AneuX subset; verify FPD approaches ~6.06 and visualize smoothness vs. diffusion.
  2. **Ablation on n (eigenmode count)**: Sweep n ∈ {16, 32, 64, 128}; plot reconstruction CDv/CDn vs. n to find knee point.
  3. **Conditional generation stress test**: Request physiologically extreme λ combinations (e.g., max AR + max NW); verify MMC rejects invalid combinations or produces plausible fallback shapes.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the proposed framework be extended to incorporate temporal conditioning to model aneurysm progression using longitudinal patient data?
- Basis in paper: The conclusion states that future research directions include "incorporating temporal conditioning with longitudinal data."
- Why unresolved: The current AneuG model is a static generative model that produces single-timepoint geometries and lacks a mechanism to represent temporal evolution or growth.
- What evidence would resolve it: A modified architecture capable of generating sequential meshes from time-series data, validated against patient histories showing aneurysm growth.

### Open Question 2
- Question: Can the latent shape knowledge from AneuG be effectively leveraged to synthesize corresponding volumetric medical images (e.g., MRI or CT)?
- Basis in paper: The conclusion identifies "leveraging shape knowledge to synthesize images" as a future research direction.
- Why unresolved: The current model generates explicit surface meshes (GHD tokens) but does not generate the volumetric intensity data required for medical imaging.
- What evidence would resolve it: A shape-conditional image synthesis model (e.g., GAN or Diffusion) that takes AneuG latent codes as input and produces realistic 3D medical images.

### Open Question 3
- Question: Does training hemodynamic surrogate models on AneuG-generated synthetic meshes improve prediction accuracy on real patient data compared to training on other synthetic sources?
- Basis in paper: The introduction motivates the work by the need for data to train "networks to predict blood flow forces," but the experiments only validate the geometric fidelity of the generated shapes, not the performance of downstream flow prediction tasks.
- Why unresolved: It is unclear if the generated shapes, despite having realistic morphological markers, capture the subtle topological nuances necessary to train a generalizable fluid dynamics network.
- What evidence would resolve it: A benchmark study comparing the test-set error of a flow prediction network trained on AneuG data versus one trained on PCA or diffusion-generated data.

### Open Question 4
- Question: Does the model generalize to aneurysms located at other intracranial sites, such as the anterior communicating artery, without architectural modification?
- Basis in paper: The experiments section notes the model was trained specifically on "IA located at the middle cerebral artery bifurcation" (116 cases), limiting the known applicability to this single location.
- Why unresolved: Aneurysms at different locations exhibit distinct parent vessel topologies and flow environments which the current specialized model may not capture.
- What evidence would resolve it: Evaluation of generation quality (FPD/KPD scores) on a test set comprising aneurysms from diverse intracranial locations.

## Limitations
- GHD representation may not generalize beyond MCA bifurcation domain with only 116 training samples from single anatomical location
- Performance claims against diffusion models warrant scrutiny given small dataset size and lack of diffusion model architecture details
- MEA mechanism is novel but untested in broader contexts beyond this specific setup

## Confidence

- **High Confidence**: Two-stage factorization approach and anatomical rationale; GHD formulation and mathematical basis; overall evaluation framework using standard point cloud metrics
- **Medium Confidence**: Specific effectiveness of MEA regularization for preventing posterior collapse; superiority of GHD over alternative shape encodings; claimed performance gap between VAE and diffusion approaches
- **Low Confidence**: Generalization of GHD representation to aneurysms at other vascular locations; whether 6.06 FPD represents meaningful clinical threshold; robustness of conditional generation to physiologically extreme morphological combinations

## Next Checks

1. **Cross-anatomical validation**: Train and evaluate the GHD-VAE pipeline on aneurysms from different vascular territories (e.g., anterior communicating artery, basilar tip) to test representation generalization. Compare FPD and morphological marker conditioning accuracy against the MCA baseline.

2. **Ablation study on MEA weight**: Systematically vary the MEA regularization coefficient λMEA across multiple orders of magnitude while monitoring posterior collapse (KL divergence to prior) and conditioning accuracy. Plot Pareto frontier to identify optimal trade-off.

3. **Canonical mesh sensitivity analysis**: Generate multiple canonical meshes with varying topologies (sphere, ellipsoid, population-averaged template) and compare the resulting GHD token quality and reconstruction fidelity. Quantify the sensitivity of Stage I VAE performance to canonical mesh selection.