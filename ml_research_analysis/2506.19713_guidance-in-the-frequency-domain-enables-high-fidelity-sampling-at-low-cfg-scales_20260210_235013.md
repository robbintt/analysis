---
ver: rpa2
title: Guidance in the Frequency Domain Enables High-Fidelity Sampling at Low CFG
  Scales
arxiv_id: '2506.19713'
source_url: https://arxiv.org/abs/2506.19713
tags:
- guidance
- diffusion
- quality
- image
- high
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: Classifier-free guidance (CFG) improves diffusion model quality
  but introduces trade-offs between detail and diversity, especially at low guidance
  scales. This work analyzes CFG in the frequency domain and reveals that low-frequency
  components control global structure and prompt alignment, while high-frequency components
  mainly enhance visual details.
---

# Guidance in the Frequency Domain Enables High-Fidelity Sampling at Low CFG Scales

## Quick Facts
- **arXiv ID:** 2506.19713
- **Source URL:** https://arxiv.org/abs/2506.19713
- **Reference count:** 40
- **Primary result:** Frequency-decoupled guidance (FDG) improves image quality at low CFG scales by separately guiding low and high frequencies

## Executive Summary
Classifier-free guidance (CFG) enhances conditional diffusion models but introduces trade-offs between detail and diversity, especially at low guidance scales. This work analyzes CFG in the frequency domain and reveals that low-frequency components control global structure and prompt alignment, while high-frequency components mainly enhance visual details. Standard CFG applies uniform guidance across all frequencies, causing oversaturation and quality loss at low scales. To address this, the authors propose frequency-decoupled guidance (FDG), which applies separate guidance strengths to low- and high-frequency components—low values for w_low to preserve diversity, and higher values for w_high to enhance details. FDG is plug-and-play, incurs no extra sampling cost, and improves FID and recall while maintaining diversity. Experiments across multiple models and datasets show FDG consistently outperforms standard CFG.

## Method Summary
The method decomposes classifier-free guidance into frequency components using a Laplacian pyramid. Instead of applying a single guidance scale to the entire prediction, FDG splits the prediction into low-frequency (global structure) and high-frequency (fine details) components. Separate guidance scales are applied: a conservative w_low for low frequencies to maintain diversity, and a stronger w_high for high frequencies to enhance details. The components are then reconstructed and used in the sampling process. This approach is inference-only, requires no training, and works as a drop-in replacement for standard CFG in any diffusion model.

## Key Results
- FDG consistently improves FID and recall compared to standard CFG across multiple models and datasets
- Maintains diversity while enhancing visual details, particularly at low guidance scales
- Visualizations show FDG reduces oversaturation artifacts common in high-CFG images
- Works across different model architectures (Stable Diffusion variants, DiT, EDM2) and tasks (text-to-image, ImageNet classification)

## Why This Works (Mechanism)
None

## Foundational Learning

**Laplacian Pyramid Decomposition**
- Why needed: Enables frequency-based separation of image components for targeted guidance
- Quick check: Verify pyramid reconstruction matches original input (MSE < 1e-6)

**Classifier-Free Guidance (CFG)**
- Why needed: Baseline method that FDG improves upon by frequency-aware scaling
- Quick check: Standard CFG output should match when w_low = w_high

**Frequency Domain Analysis in Diffusion**
- Why needed: Provides theoretical foundation for separating guidance effects across frequencies
- Quick check: Visualize FFT of low/high components to confirm frequency separation

## Architecture Onboarding

**Component Map**
Input Prediction → Laplacian Pyramid → [Low Freq: w_low * Guidance] + [High Freq: w_high * Guidance] → Reconstruction → Sampling Step

**Critical Path**
Model Prediction → FDG Decomposition → Separate Scaling → Reconstruction → Scheduler Step

**Design Tradeoffs**
- Single-level vs multi-level pyramid: Simpler implementation vs finer control
- w_low/w_high selection: Diversity preservation vs detail enhancement balance
- No training overhead vs potential sub-optimality of fixed frequency split

**Failure Signatures**
- Shape mismatches during pyramid reconstruction
- Visual artifacts at frequency boundaries
- Oversaturation when w_high is too large relative to w_low

**3 First Experiments**
1. Implement basic Laplacian pyramid and verify reconstruction accuracy
2. Apply FDG with fixed w_low=w_high to confirm it matches standard CFG
3. Test FDG on a simple text prompt with varying w_low/w_high pairs to observe frequency effects

## Open Questions the Paper Calls Out

**Extreme Out-of-Distribution Performance**
The paper identifies improving generation quality in extreme out-of-distribution domains as a promising direction for future research. While FDG is evaluated on standard datasets (ImageNet, MS COCO), its performance on novel or adversarial concepts relative to the model's training set remains untested.

**Temporal Modality Generalization**
The paper cites video and audio synthesis in related work but limits experiments to image synthesis. It's unknown whether FDG's frequency separation benefits would extend to video (temporal coherence vs motion details) or audio synthesis without disrupting temporal consistency.

**Multi-Level Frequency Decomposition**
While the ablation study shows multi-level decomposition is viable, the paper uses single-level pyramids for simplicity. Further sub-dividing the frequency spectrum (e.g., low, mid, high) could provide finer-grained control over the diversity-fidelity trade-off.

## Limitations
- Limited evaluation to standard datasets; performance in extreme OOD domains untested
- Single-level frequency decomposition may miss opportunities for finer control
- No exploration of temporal modality applications despite frequency decomposition relevance

## Confidence

**High Confidence Areas:**
- The core FDG algorithm concept and frequency-based reasoning
- Implementation as inference-only plug-in replacement
- Expected improvements in FID and recall metrics

**Medium Confidence Areas:**
- Exact Laplacian pyramid configuration (single-level meaning)
- Optimal w_low/w_high parameter ranges across different models
- Integration details with specific diffusion model implementations

**Low Confidence Areas:**
- Impact on extreme out-of-distribution generation tasks
- Performance in temporal modalities like video or audio
- Benefits of multi-level frequency decomposition

## Next Checks

1. **Pyramid Level Verification**: Run experiments with different pyramid levels (2-level, 3-level) on a small dataset and compare FID scores to determine which configuration best matches the paper's results

2. **Space Consistency Check**: Verify that FDG is applied in the correct space by testing both noise prediction space and x_0 prediction space, comparing outputs to ensure consistency with latent diffusion model conventions

3. **Scale Sensitivity Analysis**: Systematically vary w_low and w_high values around the suggested ranges (e.g., w_low: 1.5-3, w_high: 7-15) and plot FID against guidance scale pairs to identify the optimal configuration