---
ver: rpa2
title: 'MolMark: Safeguarding Molecular Structures through Learnable Atom-Level Watermarking'
arxiv_id: '2508.17702'
source_url: https://arxiv.org/abs/2508.17702
tags:
- molecules
- molecular
- molmark
- atom
- embedding
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: MolMark is the first deep learning-based watermarking framework
  designed to protect AI-generated molecular structures. It embeds watermarks at the
  atom level using SE(3)-invariant representations to ensure robustness against rotations,
  translations, and reflections.
---

# MolMark: Safeguarding Molecular Structures through Learnable Atom-Level Watermarking

## Quick Facts
- arXiv ID: 2508.17702
- Source URL: https://arxiv.org/abs/2508.17702
- Reference count: 40
- Key outcome: First deep learning-based watermarking framework for AI-generated molecular structures achieving >95% extraction accuracy while preserving >90% molecular stability

## Executive Summary
MolMark introduces the first deep learning framework for embedding watermarks directly into 3D molecular structures at the atom level. By leveraging SE(3)-invariant representations through distance matrices and multidimensional scaling, the method ensures watermark robustness against geometric transformations while maintaining molecular validity. The approach dynamically balances watermark extractability with structural fidelity through adaptive loss weighting, enabling secure, traceable protection of AI-generated molecular IP without compromising scientific utility.

## Method Summary
MolMark operates by modulating atom positions in 3D molecular structures through a learnable encoder that minimally perturbs coordinates guided by chemically meaningful features. The watermark is extracted via a decoder that uses SE(3)-invariant distance matrices processed through multidimensional scaling, ensuring robustness to rotations, translations, and reflections. Training employs a dynamic loss weighting strategy that initially prioritizes watermark extractability before shifting focus to structural preservation as extraction accuracy improves.

## Key Results
- Achieves >95% extraction accuracy under SE(3) transformations while maintaining >90% molecular stability
- Successfully embeds 16-bit watermarks into molecules from QM9 and GEOM-DRUG datasets
- Demonstrates robustness to rotations, translations, and reflections without compromising chemical validity

## Why This Works (Mechanism)

### Mechanism 1
MolMark preserves molecular properties while achieving high extraction accuracy by minimally adjusting atom positions guided by chemically meaningful features. The encoder loss ensures structural perturbations remain small while the decoder loss maintains watermark extractability. Core assumption: small perturbations respecting interatomic constraints preserve stability while encoding sufficient information for extraction.

### Mechanism 2
Robustness to geometric transformations is achieved through SE(3)-invariant features derived from Euclidean distance matrices. These distance matrices capture internal molecular geometry while discarding absolute orientation, enabling reliable watermark extraction regardless of molecule positioning. Core assumption: distance matrices provide complete, robust representations retaining enough information for watermark encoding and recovery.

### Mechanism 3
Dynamic training balances molecular fidelity and watermark extractability through adaptive loss weighting. The encoder weight increases over training while the decoder weight decreases based on real-time bit accuracy, shifting focus from establishing watermarking capability to minimizing structural impact. Core assumption: static weighting cannot adequately balance competing objectives of capacity, fidelity, and robustness.

## Foundational Learning

- **Concept: SE(3) Invariance**
  - Why needed here: Molecular properties don't change with rotation, translation, or reflection, so watermarks must remain detectable regardless of orientation
  - Quick check question: If you rotate a watermarked molecule by 45 degrees, will the decoder still extract the watermark? (Yes)

- **Concept: Molecular Stability & Validity**
  - Why needed here: Molecules must obey chemical rules (bond lengths, valences); watermarking cannot create chemically impossible structures
  - Quick check question: After watermarking, does the molecule still have valid bond lengths and valences? (Yes)

- **Concept: Trade-off in Watermarking (Fidelity vs. Robustness vs. Capacity)**
  - Why needed here: Larger watermarks or more robust ones typically require more changes, potentially harming scientific utility
  - Quick check question: Can you increase watermark length without negatively affecting molecular validity? (Generally no, trade-off exists)

## Architecture Onboarding

- **Component map:** Input Geometry + Watermark → Position Processing → Atom Embedder + Edge Embedder → Cross Processing → Encoder → Perturbed Geometry → Distance Matrix → MDS → Decoder → Extracted Watermark

- **Critical path:** Watermark flows through Encoder (modulating atom positions) to produce watermarked molecule, then through Decoder (using SE(3)-invariant distance features) to extract watermark. Critical design: Decoder's use of distance matrices ensures geometric robustness.

- **Design tradeoffs:** Perturbation vs. Robustness (smaller changes preserve fidelity but may weaken extraction); Complexity vs. Efficiency (embedding modules add complexity but improve stability); Dynamic vs. Static weighting (adaptive scheduling better balances objectives).

- **Failure signatures:** Low Molecular Stability (<90%) indicates excessive perturbation; Low Bit Accuracy (<95%) indicates decoder cannot recover watermark; Unstable Training suggests dynamic weighting schedule problems.

- **First 3 experiments:**
  1. Feasibility & Capacity Test: Embed 1, 4, 8, 16-bit watermarks, measure stability and accuracy trade-off
  2. Geometric Robustness Test: Apply SE(3) transformations to 16-bit watermarked molecules, measure extraction accuracy
  3. Component Ablation: Test variants without Atom Embedder, without Edge Embedder, without both, compare against full model

## Open Questions the Paper Calls Out
None specified in the provided content.

## Limitations
- Limited validation to QM9 and GEOM-DRUG datasets without testing on larger drug-like molecules
- No evaluation of robustness against adversarial attacks or sophisticated watermark removal attempts
- No analysis of watermarking effects on conditional generative models targeting specific properties

## Confidence
- **High Confidence**: Molecular stability (>90%) and atomic stability claims well-supported by experimental results
- **Medium Confidence**: Bit extraction accuracy (>95%) supported by in-distribution testing but lacks validation under diverse conditions
- **Low Confidence**: Claims about practical IP protection applications are largely theoretical without real-world deployment evidence

## Next Checks
1. **Adversarial Robustness Test**: Apply molecular transformation attacks including bond modifications and functional group replacements to assess real-world protection capability

2. **Large-Scale Drug Molecule Validation**: Evaluate on ChEMBL or similar drug-like molecule datasets (50-100 heavy atoms) to verify scalability and effectiveness on complex structures

3. **Extraction-Under-Noise Analysis**: Systematically vary noise levels in molecular geometry to establish practical operational limits and trade-offs between extraction accuracy and stability