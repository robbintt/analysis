---
ver: rpa2
title: Model-Based Diffusion Sampling for Predictive Control in Offline Decision Making
arxiv_id: '2512.08280'
source_url: https://arxiv.org/abs/2512.08280
tags:
- dynamics
- diffusion
- planner
- trajectories
- mpdiffuser
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: MPDiffuser is a compositional diffusion framework for offline decision-making
  that interleaves planner and dynamics updates during sampling, progressively refining
  trajectories for task alignment and dynamic feasibility. By combining a diffusion
  planner, a diffusion dynamics model, and a ranking module, it balances task fidelity
  with system consistency.
---

# Model-Based Diffusion Sampling for Predictive Control in Offline Decision Making

## Quick Facts
- arXiv ID: 2512.08280
- Source URL: https://arxiv.org/abs/2512.08280
- Authors: Haldun Balim; Na Li; Yilun Du
- Reference count: 40
- Primary result: State-of-the-art performance on D4RL and DSRL benchmarks with compositional diffusion framework

## Executive Summary
MPDiffuser introduces a novel compositional diffusion framework for offline decision-making that interleaves planner and dynamics updates during sampling. The method progressively refines trajectories for task alignment and dynamic feasibility by combining a diffusion planner, diffusion dynamics model, and ranking module. This approach balances task fidelity with system consistency and achieves state-of-the-art performance across multiple benchmark environments while demonstrating adaptability to novel dynamics and visual domains.

## Method Summary
MPDiffuser employs a KL-constrained optimization framework that alternates between diffusion planner and dynamics model updates during trajectory sampling. The planner proposes candidate trajectories while the dynamics model evaluates their physical feasibility. A ranking module then selects the most promising samples based on task alignment and dynamic consistency. This compositional approach allows the framework to learn from suboptimal data while maintaining safety constraints through the dynamics model's feedback loop.

## Key Results
- Achieves state-of-the-art performance on D4RL and DSRL benchmarks
- Successfully adapts to novel dynamics and leverages suboptimal data for dynamics learning
- Demonstrates scalability to visual domains and real-world quadruped deployment
- Outperforms single-model diffusion baselines consistently

## Why This Works (Mechanism)
The interleaving of planner and dynamics updates during sampling creates a feedback loop that progressively refines trajectories. By treating feasibility as an integral part of the sampling process rather than a post-hoc constraint, MPDiffuser can explore the solution space more effectively while maintaining physical consistency. The ranking module ensures that only trajectories meeting both task and feasibility criteria are selected, creating a natural curriculum for learning.

## Foundational Learning

1. **Diffusion models for trajectory generation**
   - Why needed: Enable continuous, flexible sampling of high-dimensional trajectory spaces
   - Quick check: Verify that reverse diffusion process can generate diverse, realistic trajectories

2. **Offline reinforcement learning**
   - Why needed: Allows learning from fixed datasets without environment interaction
   - Quick check: Confirm that learned policies generalize beyond training distribution

3. **Dynamics modeling for control**
   - Why needed: Ensures generated trajectories respect physical constraints and system capabilities
   - Quick check: Validate that predicted trajectories remain physically realizable

## Architecture Onboarding

**Component Map:** Diffusion Planner -> Ranking Module -> Diffusion Dynamics Model -> Back to Planner

**Critical Path:** The forward pass generates candidate trajectories through the planner, which are then evaluated by the dynamics model. The ranking module selects top candidates based on combined scores, and these refined samples are fed back to the planner for further refinement.

**Design Tradeoffs:** MPDiffuser prioritizes task alignment over pure feasibility initially, allowing exploration of suboptimal but physically realizable trajectories. This contrasts with approaches that enforce strict feasibility constraints from the start, which can limit exploration.

**Failure Signatures:** Poor performance typically manifests as either physically unrealistic trajectories (dynamics model failure) or task-irrelevant paths (planner misalignment). The ranking module serves as a diagnostic tool for identifying which component is underperforming.

**First Experiments:**
1. Ablation study removing the dynamics model to quantify its contribution to performance
2. Testing with varying levels of suboptimal data to assess robustness to data quality
3. Evaluating performance on out-of-distribution dynamics to measure generalization

## Open Questions the Paper Calls Out

None

## Limitations
- Performance generalization to diverse real-world robotics tasks beyond reported quadruped deployment remains uncertain
- Alternating optimization framework may face convergence challenges in high-dimensional state spaces
- Potential sensitivity to hyperparameter tuning and specific diffusion model choices

## Confidence

| Claim | Confidence |
|-------|------------|
| Performance improvements on standard benchmarks | High |
| Effectiveness of compositional framework | Medium |
| Theoretical guarantees in practical implementation | Medium |

## Next Checks

1. Conduct ablation studies to quantify individual contributions of planner, dynamics model, and ranking module across varying task complexities and data qualities.

2. Evaluate MPDiffuser's performance under distribution shift scenarios to assess robustness when faced with dynamics or reward function changes not present in training data.

3. Implement safety constraints directly within the diffusion sampling process to verify if the framework can maintain feasibility guarantees in constrained control problems.