---
ver: rpa2
title: 'MASTER: Multi-Agent Security Through Exploration of Roles and Topological
  Structures -- A Comprehensive Framework'
arxiv_id: '2505.18572'
source_url: https://arxiv.org/abs/2505.18572
tags:
- role
- agent
- system
- attack
- data
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: MASTER introduces the first comprehensive framework for Multi-Agent
  System (MAS) security research, addressing the heightened risks arising from role
  heterogeneity and complex topological structures in MAS. The framework combines
  automated MAS construction, information-flow-based interaction, and adaptive attack
  strategies that exploit role and topology information to generate targeted, domain-specific
  attacks.
---

# MASTER: Multi-Agent Security Through Exploration of Roles and Topological Structures -- A Comprehensive Framework

## Quick Facts
- arXiv ID: 2505.18572
- Source URL: https://arxiv.org/abs/2505.18572
- Reference count: 40
- Primary result: First comprehensive framework for MAS security addressing role heterogeneity and topology vulnerabilities

## Executive Summary
MASTER introduces the first comprehensive framework for Multi-Agent System (MAS) security research, addressing the heightened risks arising from role heterogeneity and complex topological structures in MAS. The framework combines automated MAS construction, information-flow-based interaction, and adaptive attack strategies that exploit role and topology information to generate targeted, domain-specific attacks. Experimental results across 25 scenarios and seven application domains show that role and topological information significantly enhance attack success rates (ASR), with some models achieving over 90% ASR, while also improving adversarial role consistency and harmful team collaboration. Corresponding defense strategies, including prompt leakage detection, hierarchical monitoring, and preemptive defenses, substantially reduce ASR below 20% and enhance MAS resilience. These findings demonstrate that MAS are highly vulnerable to role- and topology-aware attacks but can be effectively defended, providing valuable insights for developing safer, more robust MAS.

## Method Summary
The MASTER framework consists of three stages: MAS automatic construction with topology selection and role assignment, information-flow-based multi-round interaction with memory updates, and adaptive attack strategies combining probing, injection, and activation phases. The framework supports six topology types (Chain, Tree, Star, Circle, Hierarchy, Complete) and seven application domains, using role and topological information embedded in activation prompts to enhance attack effectiveness. Evaluation employs LLM-based metrics for attack success rate, adversarial role consistency, and harmful team cooperation across 25 scenarios with 5-agent MAS running 8 interaction rounds each.

## Key Results
- Role and topological information significantly enhance attack success rates (ASR), with some models achieving over 90% ASR
- Removing role information drops role consistency from ~95% to ~67-82% across rounds
- Removing topology information drops cooperation scores from ~85-97% to ~40-55%
- ASR increases from ~15-20% (Turn 1) to ~77-99% (Turn 8) for most models
- Defense strategies reduce ASR below 20% and enhance MAS resilience

## Why This Works (Mechanism)

### Mechanism 1: Role-Enhanced Adversarial Consistency
- Claim: Role information embedded in activation prompts increases adversarial role consistency, making attacks more effective by leveraging agents' specialized expertise and permissions.
- Mechanism: When attack prompts include role-specific context (`Trole`), compromised agents maintain their original professional personas while executing harmful tasks. This allows agents to "exploit their expertise and permissions" more effectively, producing more damaging outputs than generic attacks.
- Core assumption: LLMs trained on role-specific data will generate more coherent and executable harmful content when prompts align with their assigned role characteristics.
- Evidence anchors:
  - [abstract]: "role and topological information significantly enhance attack success rates (ASR)... while also improving adversarial role consistency"
  - [section 4.2/Table 2]: Ablation shows removing role information drops role consistency from ~95% to ~67-82% across rounds
  - [corpus]: Limited direct corpus support—G-Safeguard (2502.11127) addresses topology but not role heterogeneity
- Break condition: If agent roles are broadly defined without domain-specific expertise, role-enhanced attacks lose advantage.

### Mechanism 2: Topology-Guided Harmful Collaboration
- Claim: Topological information enables coordinated multi-agent attacks by specifying which neighboring agents to collaborate with, increasing harmful team cooperation scores.
- Mechanism: The activation prompt includes `Ttopo` derived from the adjacency matrix, instructing compromised agents on specific collaboration targets. This transforms isolated harmful outputs into coordinated attacks, where "agents may collaborate, based on their roles and topology, to execute harmful tasks more effectively."
- Core assumption: Agents will follow topological instructions in prompts to coordinate with specified neighbors, and multi-agent coordination amplifies harm beyond single-agent attacks.
- Evidence anchors:
  - [section 3.2.4]: "embedding role and topological data into templates... enhancing malicious inter-agent collaboration"
  - [section 4.2/Table 2]: Removing topology info drops cooperation scores from ~85-97% to ~40-55%
  - [corpus]: NetSafe (Yu et al., 2024) referenced as assessing topological safety but overlooking role heterogeneity
- Break condition: If topology is Chain (lowest connectivity), coordination benefits diminish significantly (Figure 5 shows Chain has lowest ASR).

### Mechanism 3: Progressive Vulnerability Propagation
- Claim: Attack success rates increase with interaction rounds and propagation levels, as compromised agents influence neighboring agents through repeated information exchange.
- Mechanism: The information-flow interaction (Equations 4-7) creates cascading vulnerability. Each round, agents receive inputs from neighbors (`O(t)_i`), process them with memory updates, and propagate outputs. Compromised agents' outputs contaminate downstream agents over successive rounds.
- Core assumption: Harmful content in agent outputs will influence receiving agents' responses without being filtered or rejected.
- Evidence anchors:
  - [section 4.4/Figure 3]: "strong positive correlation between propagation level and ASR, with faster ASR growth in early rounds"
  - [Table 1]: ASR increases from ~15-20% (Turn 1) to ~77-99% (Turn 8) for most models
  - [corpus]: "Flooding spread of manipulated knowledge" (Ju et al., 2024) cited for knowledge propagation manipulation
- Break condition: If defense monitoring detects and blocks harmful content mid-propagation, the cascade is interrupted.

## Foundational Learning

- Concept: **Directed Graph Representation of MAS**
  - Why needed here: MASTER models MAS as G=(V,E) with adjacency matrix A defining communication patterns. Understanding graph theory basics is essential for interpreting topology selection, propagation analysis, and attack strategies.
  - Quick check question: Given a 5-agent Chain topology, which agents can agent[2] receive inputs from?

- Concept: **Prompt Injection and Jailbreaking**
  - Why needed here: The attack strategy builds on LLM jailbreaking research (DeepInception, Evil Geniuses). The trait injection stage uses backdoor-style prompts that activate on triggers.
  - Quick check question: How does the "Hey buddy" trigger in the activation prompt relate to the injection stage setup?

- Concept: **Multi-Round Agent Interaction with Memory**
  - Why needed here: MASTER's interaction mechanism (Equations 5-7) combines task T, neighbor outputs O(t), previous response R(t-1), and memory M(t-1). Understanding how context accumulates across rounds explains vulnerability propagation.
  - Quick check question: If agent memory is reset each round, how would ASR trajectories change?

## Architecture Onboarding

- Component map:
  User Request → [MAS Automatic Constructor] → [MAS Instance: G=(V,E), {Si}] → [Interaction Engine] → [Attack Module] ↔ [Defense Module]

- Critical path:
  1. Construct MAS with topology and roles matching target scenario
  2. Probe phase: Run n rounds of self-introduction task to extract role/topology info
  3. Classify domain (7 types: info dissemination, production, data mgmt, education, research, healthcare, finance)
  4. Inject domain-specific traits using template from Table 5
  5. Activate with trigger ("Hey buddy") + role/topo-enhanced task prompt
  6. Evaluate: ASR, Role Consistency, Team Cooperation (LLM-based evaluators)

- Design tradeoffs:
  - **Chain vs Complete topology**: Chain lowest ASR but limits legitimate collaboration; Complete enables full coordination but maximizes attack surface
  - **Online vs Offline defense**: Hierarchical monitoring effective but costly; Preemptive defense efficient but requires accurate domain classification
  - **Propagation rounds**: More rounds increase ASR but also increase detection opportunity

- Failure signatures:
  - ASR stuck at ~15-20% across rounds → Defense active or model highly robust (Claude-3.7-Sonnet pattern)
  - Role consistency high but cooperation low → Role info working, topology info missing or incorrect
  - Leakage Defense ASR=0% early but rises to 10-14% by Turn 8 → Detector being bypassed by evolved attack content

- First 3 experiments:
  1. **Baseline topology comparison**: Deploy identical MAS (5 agents, same roles) across 6 topologies (Chain, Tree, Star, Circle, Hierarchy, Complete). Run full attack pipeline. Measure ASR by topology. Expect Chain lowest, Complete highest.
  2. **Ablation on attack components**: For a single model (GPT-4o), run 4 conditions: full attack, w/o Role, w/o Topo, baseline (DeepInception only). Compare all three metrics across 8 rounds. Confirm role drives consistency, topology drives cooperation.
  3. **Defense efficiency test**: Apply all three defenses to Qwen2.5-32B (highest vulnerability model). Measure ASR reduction and computational overhead. Leakage defense should block probing; Hierarchical should catch activation; Preemptive should prevent injection success.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do role- and topology-aware attacks perform in environment-interactive MAS that execute real-world actions via APIs, rather than purely text-based interactions?
- Basis in paper: [explicit] The authors explicitly state in the Limitations section that "Future work should explore the security performance of these environment-interactive MAS, considering diverse roles and topological configurations."
- Why unresolved: The current MASTER framework relies on text-based interaction and simulation, lacking the feedback loops and executable consequences inherent in systems that invoke APIs or functions.
- What evidence would resolve it: Experiments measuring Attack Success Rates (ASR) in MAS equipped with tool-use capabilities (e.g., code interpreters, web browsing) would resolve this.

### Open Question 2
- Question: Is the high vulnerability observed in "Data Management" domains intrinsic to the data sensitivity, or is it contingent upon the specific role configurations generated by the framework?
- Basis in paper: [inferred] Section 4.5 notes that "data management MAS exhibits the highest ASR" and "education MAS shows greater resilience," but the paper does not isolate whether these results are caused by the domain nature or the specific automated construction of roles.
- Why unresolved: The framework automates role assignment based on the domain, potentially confounding the impact of the domain itself with the impact of the specific roles chosen for that domain.
- What evidence would resolve it: Ablation studies using fixed role sets across different domains, or varying role complexities within the Data Management domain, would distinguish domain risk from configuration risk.

### Open Question 3
- Question: What is the performance trade-off between the proposed defense strategies (hierarchical monitoring, preemptive defense) and the operational efficiency of legitimate MAS tasks?
- Basis in paper: [inferred] Section 3.2.5 claims the defense offers a "trade-off between efficiency and security," and Section 4.3 confirms safety improvements, but no metrics are provided regarding latency or the success rate of benign tasks.
- Why unresolved: While the defenses reduce Attack Success Rate (ASR), they introduce additional LLM calls (monitors/classifiers) which may degrade system speed or interfere with legitimate complex reasoning.
- What evidence would resolve it: Benchmarks reporting latency per round and benign task completion rates (e.g., success in solving coding problems) with defenses enabled would resolve this.

## Limitations

- Experimental results rely on LLM-based evaluators without disclosing the specific model used, raising questions about evaluation consistency and potential bias
- The framework uses a fixed 8-round interaction protocol without exploring optimal round numbers for different topologies and agent types
- Attack success rates are based on controlled scenarios with known domain classifications, not evaluated for real-world applicability where domains and threat models are unknown

## Confidence

- **High Confidence**: The fundamental finding that role and topological information significantly enhance attack success rates is well-supported by the ablation experiments (ASR drops from 85-99% to 10-50% when role/topology info is removed)
- **Medium Confidence**: The effectiveness of proposed defense strategies is demonstrated within the experimental framework, but their real-world efficacy against adaptive attackers is uncertain
- **Low Confidence**: The generalizability of domain-specific attack templates across all 7 application domains is claimed but not rigorously tested beyond the 25 scenarios

## Next Checks

1. **Cross-Domain Transferability Test**: Apply attack templates from one domain (e.g., healthcare) to MAS instances in unrelated domains (e.g., financial services) to validate whether domain-specific trait injection truly enhances attack effectiveness versus generic approaches.

2. **Dynamic Defense Evasion Evaluation**: Implement an adaptive attacker that monitors defense detection patterns and modifies attack strategies in real-time to bypass leakage detection and hierarchical monitoring systems, measuring defense robustness against intelligent adversaries.

3. **Scalability and Resource Overhead Analysis**: Scale MAS instances from 5 agents to 50+ agents while measuring ASR, defense effectiveness, and computational costs (memory usage, latency) to establish practical deployment boundaries and resource requirements for the proposed framework.