---
ver: rpa2
title: 'Interpretable by Design: Query-Specific Neural Modules for Explainable Reinforcement
  Learning'
arxiv_id: '2511.08749'
source_url: https://arxiv.org/abs/2511.08749
tags:
- learning
- query
- arxiv
- queries
- reinforcement
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper challenges the traditional RL paradigm of optimizing
  only for control by proposing architectures designed explicitly for answering diverse
  queries about the environment. The key insight is that inference accuracy (e.g.,
  reachability prediction) can decouple from control performance - QDIN achieves near-perfect
  reachability IoU (99%) even when returns remain poor (31%), suggesting different
  representations are optimal for knowledge versus control.
---

# Interpretable by Design: Query-Specific Neural Modules for Explainable Reinforcement Learning

## Quick Facts
- arXiv ID: 2511.08749
- Source URL: https://arxiv.org/abs/2511.08749
- Authors: Mehrdad Zakershahrak
- Reference count: 40
- Key outcome: QDIN achieves near-perfect reachability IoU (99%) even with poor returns (31%), demonstrating inference-control decoupling in RL

## Executive Summary
This paper challenges the traditional RL paradigm of optimizing only for control by proposing architectures designed explicitly for answering diverse queries about the environment. The key insight is that inference accuracy (e.g., reachability prediction) can decouple from control performance - QDIN achieves near-perfect reachability IoU (99%) even when returns remain poor (31%), suggesting different representations are optimal for knowledge versus control. The proposed Query-Conditioned Deterministic Inference Networks (QDIN) feature specialized neural modules (convolutional for spatial queries, attention for comparisons, sequential for paths) conditioned on query types from the earliest layers. Experiments show QDIN outperforms monolithic and post-hoc methods on inference tasks while maintaining competitive control, and generalizes to composite queries never seen during training. The work establishes a research agenda for designing RL systems as queryable knowledge bases rather than just action selectors.

## Method Summary
The paper introduces Query-Conditioned Deterministic Inference Networks (QDIN) that integrate query information from the earliest layers and route it through specialized neural modules. The architecture conditions all layers on query type embeddings, with spatial queries processed through convolutional modules, comparison queries through attention modules, and sequential queries through recurrent modules. This design enables the network to maintain separate representations optimized for different types of environmental knowledge while still performing control tasks. The approach contrasts with traditional RL methods that optimize solely for returns, instead treating the agent as a queryable knowledge base about its environment.

## Key Results
- QDIN achieves 99% IoU for reachability queries while maintaining competitive control performance
- Specialized neural modules outperform monolithic architectures on query-specific inference tasks
- The approach generalizes to composite queries never seen during training
- QDIN demonstrates inference-control decoupling, achieving high inference accuracy even with suboptimal returns

## Why This Works (Mechanism)
The paper demonstrates that inference and control tasks require fundamentally different representations of the environment. By designing specialized neural modules conditioned on query types from the earliest layers, QDIN can maintain representations optimized for answering diverse queries while still performing control tasks. The architectural separation allows the network to focus on immediately actionable information for control while preserving comprehensive environmental knowledge for inference tasks.

## Foundational Learning
- Query-conditioned architectures: Needed to route different query types through specialized processing paths; quick check: verify query embeddings are properly integrated at each layer
- Module specialization: Required to optimize representations for specific query types; quick check: compare performance of specialized vs. shared modules
- Inference-control decoupling: Central to understanding why separate representations are optimal; quick check: measure correlation between inference accuracy and control returns
- Early query integration: Critical for conditioning the entire representation pipeline; quick check: verify query information flows through all layers
- Reachability and path prediction: Core inference tasks that require different spatial reasoning capabilities; quick check: evaluate IoU metrics for different query types
- Composite query generalization: Demonstrates the architecture's ability to combine learned query representations; quick check: test on novel query combinations

## Architecture Onboarding

**Component map**: Input state -> Query embedding layer -> Specialized modules (conv/attn/seq) -> Shared representation -> Task-specific heads (control/inference)

**Critical path**: Query encoding → Module routing → Representation fusion → Output heads

**Design tradeoffs**: Specialization vs. parameter efficiency, early integration vs. late fusion, inference accuracy vs. control performance

**Failure signatures**: 
- Poor query generalization indicates insufficient module specialization
- Control performance degradation suggests over-specialization
- Low inference accuracy reveals inadequate query conditioning

**First experiments**:
1. Compare specialized modules vs. monolithic architecture on individual query types
2. Test composite query performance on novel combinations
3. Measure inference-control correlation across different architectural variants

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the query-module architecture and the observed inference-control decoupling phenomenon scale to high-dimensional continuous spaces?
- Basis in paper: [explicit] Section 6.3 states that while the approach scales to 32x32 grids, "application to high-dimensional continuous spaces remains unexplored."
- Why unresolved: The current experiments are restricted to deterministic grid worlds. Continuous domains require different function approximation for the reachability and path heads, potentially altering the trade-off between inference accuracy and control returns.
- What evidence would resolve it: Demonstrating that QDIN maintains the decoupling (high inference IoU despite suboptimal returns) in continuous control benchmarks like MuJoCo or complex 3D navigation tasks.

### Open Question 2
- Question: What are the theoretical mechanisms causing the representation requirements for inference to differ fundamentally from those required for optimal control?
- Basis in paper: [explicit] Section 6.1 identifies the "Representation Learning Puzzle," asking "Why do representations optimal for world knowledge differ from those for control?"
- Why unresolved: The paper empirically observes the decoupling (99% reachability vs. 31% return) but offers only the hypothesis that control emphasizes "immediately actionable information" without proving the causal factors.
- What evidence would resolve it: Representation analysis (e.g., probing, mutual information) identifying specific features present in inference-optimized representations that are suppressed or lost during control-only optimization.

### Open Question 3
- Question: Does the inference-control decoupling persist in stochastic environments where agents must maintain belief states rather than deterministic facts?
- Basis in paper: [explicit] Section 6.2 notes the framework "extends naturally to stochastic settings" but acknowledges the current work focuses exclusively on deterministic transition functions.
- Why unresolved: Determinism guarantees unique answers for path and reachability queries. Stochasticity introduces variance and distributional predictions, which may couple the gradients for inference and control differently, potentially resolving the conflict observed in deterministic settings.
- What evidence would resolve it: Evaluation of QDIN in stochastic MDPs to measure if the negative correlation between perfect inference and suboptimal control persists when the agent must model uncertainty.

## Limitations
- Current experiments limited to synthetic 2D grid worlds, scalability to complex environments unproven
- Claims about interpretability benefits need more rigorous human evaluation
- The 99% IoU may reflect overfitting to specific query patterns rather than genuine generalization

## Confidence
- High confidence: Core experimental results showing QDIN's superior inference accuracy and reasonable control performance are well-supported
- Medium confidence: Interpretability claims require more rigorous validation; theoretical explanation of decoupling needs broader empirical support
- Low confidence: Generalization claims to composite queries need systematic testing across wider query combinations and environmental complexities

## Next Checks
1. Conduct ablation studies removing module specialization to quantify the exact contribution of architectural design versus query-conditioning alone
2. Test QDIN on multi-room 3D environments and Atari games to assess scalability and robustness to visual complexity
3. Perform user studies with domain experts to evaluate whether the learned representations actually improve human understanding and debugging capabilities compared to post-hoc explanation methods