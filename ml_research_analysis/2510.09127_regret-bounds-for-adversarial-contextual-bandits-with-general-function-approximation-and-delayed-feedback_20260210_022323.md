---
ver: rpa2
title: Regret Bounds for Adversarial Contextual Bandits with General Function Approximation
  and Delayed Feedback
arxiv_id: '2510.09127'
source_url: https://arxiv.org/abs/2510.09127
tags:
- regret
- algorithm
- bound
- function
- loss
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper addresses the problem of regret minimization in adversarial
  contextual multi-armed bandits (CMAB) with delayed feedback. The authors consider
  two main settings: policy class learning, where the learner has direct access to
  a finite policy class, and online function approximation, where the learner has
  access to a (possibly infinite) contextual loss function class via an online least-squares
  regression oracle.'
---

# Regret Bounds for Adversarial Contextual Bandits with General Function Approximation and Delayed Feedback

## Quick Facts
- arXiv ID: 2510.09127
- Source URL: https://arxiv.org/abs/2510.09127
- Authors: Orin Levy; Liad Erez; Alon Cohen; Yishay Mansour
- Reference count: 40
- Key outcome: Establishes optimal regret bounds for adversarial contextual bandits with delayed feedback, achieving O(sqrt(KT log |Π|) + sqrt(D log |Π|)) for policy classes and O(sqrt(KT R_T(O) + sqrt(d_max D β)) for function approximation.

## Executive Summary
This paper addresses regret minimization in adversarial contextual multi-armed bandits with delayed feedback. The authors consider two settings: policy class learning with direct access to a finite policy class, and online function approximation where losses are accessed via a regression oracle. For policy classes, they establish optimal expected regret bounds using a delay-adapted version of EXP4. For function approximation, they achieve sublinear regret bounds assuming FIFO feedback order and oracle stability. The paper introduces novel techniques including a delay-adapted loss estimator and a stability analysis of a Hedge-based Vovk's aggregating forecaster.

## Method Summary
The paper presents two main algorithms: EXP4-DALE for policy class learning and DA-FA for function approximation. EXP4-DALE uses biased loss estimators that account for future sampling probabilities to handle delays. DA-FA maintains a policy using predictions from a regression oracle, with regret depending on the oracle's stability parameter. The authors also present a Hedge-based implementation of Vovk's aggregating forecaster that provides the required stability guarantees for function approximation. Both algorithms operate under the FIFO feedback assumption and achieve sublinear regret bounds that scale with the sum of delays.

## Key Results
- For policy class learning: Optimal expected regret bound of O(sqrt(KT log |Π|) + sqrt(D log |Π|)), proven to be optimal via matching lower bound
- For function approximation: Expected regret bound of O(sqrt(KT R_T(O) + sqrt(d_max D β)) under FIFO order
- Novel stability analysis showing Hedge-based Vovk's forecaster has β bounded by log |F|, yielding bound O(sqrt(KT log |F|) + sqrt(d_max D log |F|))
- Lower bounds matching upper bounds up to sqrt(d_max) factor in function approximation setting

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Introducing under-estimation bias in loss estimators separates delay-dependent regret from action-count terms
- **Mechanism:** EXP4-DALE constructs loss estimators using future sampling probabilities p_{t+d_t} instead of current p_t, creating downward bias that keeps variance dependent on K and T while bias accumulates based on D
- **Core assumption:** Direct access to finite policy class Π
- **Evidence anchors:** Section 3.1 shows estimators induce under-estimation bias; abstract states optimal bound O(sqrt(KT log |Π|) + sqrt(D log |Π|)); related work focuses on variance bounds

### Mechanism 2
- **Claim:** Oracle stability prevents drift explosion in function approximation with delayed feedback
- **Mechanism:** DA-FA acts using stale function f_hat_tau_t; if oracle is β-stable, drift between current and stale functions is bounded by sqrt(d_max D β), maintaining sublinear regret
- **Core assumption:** Oracle is β-stable and feedback arrives in FIFO order
- **Evidence anchors:** Lemma 4.10 bounds delay drift using stability parameter β; Section 4 shows linear regret unavoidable without stability; variance-aware methods relate to controlling variance accumulation

### Mechanism 3
- **Claim:** Hedge-based Vovk's aggregating forecaster provides required stability guarantees
- **Mechanism:** For finite function class F, this forecaster maintains cumulative KL-divergence between iterates bounded by log |F|, which via Pinsker's inequality bounds L_∞ stability parameter β
- **Core assumption:** Finite function class F and realizability (f* ∈ F)
- **Evidence anchors:** Theorem 4.11 shows stability bound; abstract states β bounded by log |F|; specific stability analysis appears unique to this work

## Foundational Learning

- **Concept:** Contextual Multi-Armed Bandits (CMAB)
  - **Why needed here:** Base environment where learner sees context x_t before choosing action; adversarial contexts require different approach than standard UCB
  - **Quick check question:** Can you explain why standard UCB fails with adversarial contexts?

- **Concept:** Online Least-Squares Regression Oracle
  - **Why needed here:** Function approximation setting accesses loss function through oracle predicting losses from past data; guarantees rely on oracle having specific regret and stability properties
  - **Quick check question:** What's the difference between bandit algorithm regret and regression oracle regret?

- **Concept:** FIFO (First-In-First-Out) Feedback
  - **Why needed here:** Critical constraint for main theorem; if feedback for time t hasn't arrived, feedback for t+1 cannot have arrived; simplifies oracle update ordering
  - **Quick check question:** What network condition in distributed systems would violate FIFO assumption?

## Architecture Onboarding

- **Component map:** Environment -> Buffer -> Algorithm (DA-FA) -> Oracle
- **Critical path:**
  1. Receive context x_t
  2. Query Oracle for current loss prediction f_hat_tau_t (using last updated state)
  3. Solve optimization to get p_t
  4. Play action, observe delayed feedback
  5. Feed new observations to Oracle in strict order

- **Design tradeoffs:**
  - Policy Class (EXP4) vs Function Approx (DA-FA): EXP4 requires O(|Π|) iteration but no stability assumptions; DA-FA is efficient if oracle is efficient but requires stable oracle and FIFO ordering
  - Stability vs Speed: Highly reactive oracle (low regret) might be unstable (high β), leading to poor delay tolerance; must balance oracle adaptation speed with output smoothness

- **Failure signatures:**
  - Linear Regret: Occurs if oracle is not β-stable (see Section C.1 for proof)
  - Order Violation: Non-FIFO feedback causes oracle to update on permuted sequence, breaking regret analysis

- **First 3 experiments:**
  1. Sanity Check (Policy Class): Implement EXP4-DALE on synthetic dataset with fixed delay d to verify sqrt(D) scaling
  2. Stability Test: Compare standard Gradient Descent oracle vs Hedge-based Vovk's forecaster; plot L_∞ norm of function change ||f_t - f_{t+1}||_∞ over time
  3. FIFO Stress Test: Implement non-FIFO delay generator and observe if DA-FA regret bound degrades beyond theoretical guarantees

## Open Questions the Paper Calls Out
None

## Limitations
- Regret bounds assume FIFO feedback order, which may not hold in distributed systems with asynchronous updates
- Function approximation analysis critically depends on stability parameter β, requiring careful oracle design that may not scale to infinite function classes
- Paper provides theoretical bounds but lacks empirical validation on real-world datasets or specific adversarial context generation methods

## Confidence
- **High**: Regret bounds for policy class learning setting (EXP4-DALE) and FIFO assumption are mathematically rigorous and well-supported
- **Medium**: Function approximation regret bounds and Vovk's forecaster stability analysis are sound under stated assumptions, but practical implementation challenges remain
- **Medium**: Matching lower bounds for policy class setting are convincingly proven, but function approximation lower bound has sqrt(d_max) gap from upper bound

## Next Checks
1. **FIFO Constraint Validation**: Implement non-FIFO delay generator and measure degradation in DA-FA's regret to confirm theoretical sensitivity to feedback ordering
2. **Oracle Stability Measurement**: Compare L_∞ stability (||f_t - f_{t+1}||_∞) of Hedge-based Vovk's forecaster against standard gradient descent oracle across multiple runs
3. **Function Class Scaling Test**: Evaluate computational cost of Vovk's aggregator as |F| grows, and test whether stability guarantee holds for structured infinite classes (e.g., linear functions)