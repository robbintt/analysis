---
ver: rpa2
title: 'DOSE3 : Diffusion-based Out-of-distribution detection on SE(3) trajectories'
arxiv_id: '2502.16725'
source_url: https://arxiv.org/abs/2502.16725
tags:
- detection
- diffusion
- data
- dose3
- distribution
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: DOSE3 extends diffusion-based OOD detection to the SE(3) manifold
  for trajectory analysis, addressing the limitation of existing methods that only
  work on Euclidean or latent image spaces. The method introduces SE(3) Denoising
  Diffusion Probabilistic Models that incorporate manifold-specific operations and
  develop an OOD statistic derived from the diffusion estimator.
---

# DOSE3 : Diffusion-based Out-of-distribution detection on SE(3) trajectories

## Quick Facts
- **arXiv ID:** 2502.16725
- **Source URL:** https://arxiv.org/abs/2502.16725
- **Reference count:** 11
- **Key outcome:** Achieves near-perfect AUROC (up to 1.000) on SE(3) trajectory OOD detection across Oxford RobotCar, KITTI, and IROS20 datasets

## Executive Summary
DOSE3 extends diffusion-based OOD detection to the SE(3) manifold for trajectory analysis, addressing the limitation of existing methods that only work on Euclidean or latent image spaces. The method introduces SE(3) Denoising Diffusion Probabilistic Models that incorporate manifold-specific operations and develop an OOD statistic derived from the diffusion estimator. The framework achieves near-perfect AUROC scores (up to 1.000) across multiple real-world datasets including Oxford RobotCar, KITTI, and IROS20, significantly outperforming baseline methods like JEM and Glow-LR.

## Method Summary
DOSE3 implements SE(3) Denoising Diffusion Probabilistic Models by replacing standard Euclidean operations with Lie group operations for rotation components. The method uses exponential and logarithmic maps to handle noise injection on SO(3), ensuring geometric validity of rotations during the diffusion process. For OOD detection, it extracts a 24-dimensional feature vector from the noise estimator's magnitude and derivatives across timesteps, then fits a density estimator (GMM/KDE) to these statistics from an inlier set. This allows unified detection without retraining for different inlier distributions.

## Key Results
- Achieves near-perfect AUROC scores (up to 1.000) across Oxford RobotCar, KITTI, and IROS20 datasets
- Significantly outperforms baseline methods like JEM and Glow-LR on SE(3) trajectory OOD detection
- Demonstrates robustness to sequence length variations (64-512) and different numbers of diffusion steps (5-30)

## Why This Works (Mechanism)

### Mechanism 1
Extending diffusion to the SE(3) manifold preserves geometric validity of rigid body rotations during noise/denoise process. The authors replace Euclidean addition with Lie group operations (exponential and logarithmic maps) for SO(3) rotational components, ensuring the diffusion process operates entirely within valid rotations. This addresses the limitation that standard Gaussian noise injection produces invalid transforms when applied directly to rotation matrices.

### Mechanism 2
The statistics of the diffusion noise estimator act as a proxy for distributional divergence. Rather than using reconstruction error or data likelihood, the method extracts a 24-dimensional feature vector from the noise estimator at various timesteps. A density estimator is fit to these statistics from an inlier set; test samples with low probability under this density are flagged as OOD. This enables unified detection without retraining for new inlier distributions.

### Mechanism 3
Rotational dynamics provide superior discriminative features compared to translational dynamics alone. The authors observe that translational metrics often overlap significantly across different driving datasets, making them poor OOD indicators. In contrast, rotational metrics (specifically rotation around the Z-axis) show clear distributional shifts between datasets like KITTI and Oxford RobotCar.

## Foundational Learning

- **Lie Groups and Lie Algebra (SE(3)/SO(3))**: Required because you cannot apply standard deep learning operations directly to rotation matrices without breaking geometric constraints. Understanding logarithmic maps is essential for implementing forward diffusion.
  - *Quick check:* How do you inject Gaussian noise into a rotation matrix $R$ while ensuring the result is still a valid rotation?

- **Denoising Diffusion Probabilistic Models (DDPM)**: The paper builds on the $\epsilon$-prediction formulation. Understanding the relationship between noise schedule, forward process, and reverse process is crucial for following the diffusion equations.
  - *Quick check:* In standard DDPM, what does the neural network actually predict at timestep $t$?

- **Unified vs. Standard OOD Detection**: The paper differentiates itself by avoiding retraining for new "inlier" distributions. Understanding this context explains why they extract statistics from a pre-trained model rather than training a classifier on test data.
  - *Quick check:* Why is raw data likelihood often a poor metric for OOD detection in generative models?

## Architecture Onboarding

- **Component map:** SE(3) Trajectory → [Centering/Normalization] → [1D Conv UNet + Attention] → [Noise estimates] → [Metric Extraction] → [24D Vector] → [GMM Density Estimator] → Likelihood Score
- **Critical path:** Implementation of Algorithm 1 (Training) specifically lines 2-7. The separation of z_rot (IGSO3 sampling) and z_trans (Standard Gaussian) and the distinct application of log/exp maps for rot0 recovery is the most failure-prone area.
- **Design tradeoffs:** R3 vs. SE(3) - using rotation increases complexity but is empirically necessary; Metric Splitting - splitting rotation metrics by axis vs. combining them substantially improves performance in unified scenarios; Sequence Length - model is robust to length variations but 128 was primary design choice.
- **Failure signatures:** High AUROC on training data but low on unseen data indicates unified capability failed; translation metrics dominating OOD score suggests normalization issues.
- **First 3 experiments:** 1) Sanity Check: Train for 1 epoch and verify rot0 is always valid member of SO(3); 2) Rotation vs. Translation Ablation: Replicate R3-KITTI vs SE(3)-KITTI experiment; 3) Metric Visualization: Plot distribution of εθ for known inlier vs. known outlier.

## Open Questions the Paper Calls Out

### Open Question 1
How can the framework be improved to handle datasets with limited trajectory diversity, such as Oxford RobotCar, where performance degradation stems from restricted trajectory diversity? The current method requires training on diverse trajectory distributions; no data augmentation or curriculum strategies were explored to compensate for limited diversity.

### Open Question 2
Can the translation component of SE(3) diffusion be enhanced to provide discriminative OOD signal comparable to rotational components? Section 5.2 shows that translation distributions often overlap significantly across datasets, making them unsuitable as reliable OOD indicators.

### Open Question 3
How does DOSE3 generalize to other Lie group manifolds beyond SE(3) (e.g., SE(2), Sim(3), or other Riemannian manifolds)? The framework's components are tailored to SE(3)/SO(3) without demonstrating modularity.

### Open Question 4
What are the computational costs and latency of DOSE3 in real-time robotics applications, and how does performance scale with trajectory length and diffusion steps? The paper provides no timing analysis, FLOPs, or real-time feasibility discussion despite evaluating across varying sequence lengths and diffusion steps.

## Limitations

- Substantial computational resources required for training diffusion models, with reported training times of several days on GPU clusters
- "Unified" OOD detection capability depends heavily on training dataset diversity - fails when trained only on narrow datasets like Oxford RobotCar
- Assumes trajectory shape/orientation is reliable OOD indicator, which may not generalize to domains where rotational dynamics are less discriminative

## Confidence

- **High Confidence:** Geometric validity of SE(3) operations, experimental methodology using established trajectory datasets, core AUROC performance claims
- **Medium Confidence:** "Unified" detection capability claims, as they depend on specific training data diversity choices not fully specified
- **Low Confidence:** Generalizability of rotational dynamics as OOD indicators across all trajectory domains

## Next Checks

1. **Rotation/Translation Ablation Validation:** Replicate the R3 vs SE(3) comparison to confirm rotational dynamics provide the claimed discriminative advantage for OOD detection.
2. **Unified Training Diversity Test:** Train the model on a narrow dataset (e.g., only Oxford RobotCar) and test on diverse datasets (e.g., IROS20) to reproduce the failure mode described in Section 5.4.1.
3. **Metric Distribution Analysis:** Plot and compare the 24D metric vector distributions between inlier and OOD samples across all datasets to verify that the claimed distributional separation is consistently observable.