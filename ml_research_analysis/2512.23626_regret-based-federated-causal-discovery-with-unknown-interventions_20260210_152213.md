---
ver: rpa2
title: Regret-Based Federated Causal Discovery with Unknown Interventions
arxiv_id: '2512.23626'
source_url: https://arxiv.org/abs/2512.23626
tags:
- causal
- client
- graph
- cpdag
- interventions
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper addresses federated causal discovery under unknown
  client-level interventions, extending prior work that assumed identical causal models
  across clients. The authors propose I-PERI, a two-phase algorithm: first, it recovers
  the CPDAG of the union of client graphs using an intersection-based regret function;
  then, it refines edge orientations by exploiting structural differences induced
  by interventions.'
---

# Regret-Based Federated Causal Discovery with Unknown Interventions

## Quick Facts
- arXiv ID: 2512.23626
- Source URL: https://arxiv.org/abs/2512.23626
- Authors: Federico Baldo; Charles K. Assaad
- Reference count: 17
- Key outcome: I-PERI extends federated causal discovery to unknown client-level interventions, achieving tighter edge orientations via Φ-CPDAG using intersection-based regret and structural intervention refinement.

## Executive Summary
This paper addresses federated causal discovery when clients perform heterogeneous interventions of unknown type. The proposed I-PERI algorithm operates in two phases: first recovering the union CPDAG using intersection-based regret to handle missing edges, then refining orientations by exploiting v-structures created through structural interventions. Theoretical guarantees ensure convergence and differential privacy, while experiments demonstrate improved structural recovery compared to baseline methods.

## Method Summary
I-PERI is a two-phase federated algorithm that discovers causal structure across K clients with heterogeneous, unknown interventions. Phase 1 uses intersection-based regret to recover the union CPDAG of all client graphs, handling missing edges through the H ∩ C(G_Φk) scoring function. Phase 2 refines edge orientations by computing regret over H ∩ Skel(G_Φk), exploiting v-structures created when structural interventions "unshield" colliders. The method introduces the Φ-Markov Equivalence Class and provides differential privacy guarantees via Laplace noise injection.

## Key Results
- I-PERI successfully recovers tighter equivalence classes (Φ-CPDAG) compared to standard CPDAGs
- Theoretical regret bounds enable convergence even with missing edges in client graphs
- Differential privacy guarantees hold with bounded regret sensitivity under partial differentiability assumptions
- Empirical results show lower SHD and higher F1-scores than baseline federated causal discovery

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Intersection-based regret enables convergence despite missing edges in client graphs.
- Mechanism: The algorithm computes regret over H ∩ C(G_Φk) rather than directly over H. When a client's graph lacks edges due to structural interventions, the intersection "hides" those missing edges from the scoring function, allowing the global graph to still minimize regret as long as it contains all client edges.
- Core assumption: At least one client has purely observational data (Assumption 2.1: ∃k such that Φk = ∅).
- Evidence anchors:
  - [abstract] "first, it recovers the CPDAG of the union of client graphs using an intersection-based regret function"
  - [section 3.1] "the regret function can be minimal even in case of missing edges in the client graphs, but will penalize an edges missing in the global graph and present in the client graph"
  - [corpus] Weak direct precedent; federated causal discovery with unknown interventions is novel.
- Break condition: If no client has observational data, the union CPDAG cannot be anchored to the true structure.

### Mechanism 2
- Claim: Skeleton intersection exposes intervention-induced v-structures for edge orientation.
- Mechanism: Phase 2 computes regret over H ∩ Skel(G_Φk), which removes intervention-targeted edges from consideration, then penalizes undirected server edges that are directed in client graphs. Structural interventions that "unshield" colliders create new v-structures locally, providing orientation information unobservable in pooled observational data.
- Core assumption: Structural interventions create v-structures that would not appear in the observational MEC (faithfulness holds locally).
- Evidence anchors:
  - [abstract] "refines edge orientations by exploiting structural differences induced by interventions"
  - [section 3.2] "A structural intervention transforming a shielded collider into an unshielded one enables orienting the corresponding edges"
  - [corpus] Related work (Jaber et al., Squires et al.) addresses unknown interventions centrally; federated setting restricts direct distribution comparison.
- Break condition: If all interventions are purely parametric (no structural changes), Phase 2 yields no new orientations.

### Mechanism 3
- Claim: Bounded regret sensitivity enables differential privacy via Laplace noise injection.
- Mechanism: Regret function sensitivity is bounded by (2M+1)log(r/2) + O(log n/n) under partial differentiability and parameter bounds. Adding i.i.d. Laplace noise with scale λ = Q/ε to each local regret satisfies ε-differential privacy.
- Core assumption: Score function is partially differentiable w.r.t. parameters; parameters bounded; probability distribution uniformly lower-bounded by r.
- Evidence anchors:
  - [section 3.3] Lemma 3.1 and Proposition 3.1 establish sensitivity bound and DP guarantee
  - [abstract] "theoretical guarantees on... privacy-preserving properties"
  - [corpus] Standard DP mechanism; corpus does not contradict.
- Break condition: Violating parameter bounds or differentiability breaks the sensitivity bound.

## Foundational Learning

- Concept: **Markov Equivalence Classes and CPDAGs**
  - Why needed here: The entire algorithm operates over equivalence classes; understanding that multiple DAGs can encode the same conditional independencies is prerequisite.
  - Quick check question: Can you explain why A→B→C and A←B←C are in the same equivalence class but A→B←C is not?

- Concept: **Greedy Equivalence Search (GES)**
  - Why needed here: I-PERI extends PERI, which uses GES-style forward/backward phases over CPDAG space.
  - Quick check question: What is the role of a consistent, decomposable scoring criterion in GES convergence?

- Concept: **Structural vs. Parametric Interventions**
  - Why needed here: The algorithm exploits structural interventions (edge removals) to orient edges; parametric-only interventions reduce to standard federated causal discovery.
  - Quick check question: If an intervention changes the noise distribution of variable B without modifying its parents, which type is this?

## Architecture Onboarding

- Component map:
  - Client-side: Local causal discovery (PC or GES) → produces C(G_Φk); computes regret Rk(H) via intersection with server graph
  - Server-side: Aggregates regrets via min-max optimization; maintains global PDAG H; broadcasts H each round; runs two-phase GES (union aggregation → orientation refinement)
  - Privacy layer: Laplace noise injection on regrets before transmission

- Critical path:
  1. Initialize H to empty graph
  2. Broadcast H to all clients
  3. Each client computes Rk(H) = L(H ∩ C(G_Φk), Dk) − L(C(G_Φk), Dk)
  4. Clients add Laplace noise and send regrets to server
  5. Server performs greedy edge additions/deletions to minimize max_k Rk(H)
  6. Repeat until convergence (Phase 1 complete)
  7. Phase 2: Switch to skeleton intersection, restrict search to orientations of existing edges

- Design tradeoffs:
  - Intersection-based regret trades precision for robustness to missing edges
  - Skeleton refinement trades computational cost for tighter equivalence class
  - Laplace noise magnitude trades privacy (lower ε) against structural recovery accuracy

- Failure signatures:
  - Phase 1 fails to converge if all clients have structural interventions with overlapping targets (union incomplete)
  - Phase 2 produces no orientations if interventions only affect leaf nodes
  - High SHD persists if sample sizes are insufficient for local CPDAG recovery

- First 3 experiments:
  1. **Sanity check**: Run I-PERI on K=2 clients where client 1 has observational data, client 2 has one structural intervention on a non-leaf node. Verify Φ-CPDAG has fewer undirected edges than standard CPDAG.
  2. **Ablation on intervention coverage**: Vary the number of structurally intervened variables per client. Measure SHD gap between Phase 1 output (CPDAG) and Phase 2 output (Φ-CPDAG).
  3. **Privacy-utility curve**: Fix graph size d=10, vary ε ∈ {0.1, 0.5, 1.0, 5.0}, plot SHD and F1 to characterize noise tolerance.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the I-PERI framework be extended to handle latent confounders (causal insufficiency) or selection bias without losing its convergence guarantees?
- Basis in paper: [explicit] The Discussion section states that extending the framework to settings with latent variables or selection bias "remains an important direction for future research."
- Why unresolved: The current theoretical guarantees (Theorem 3.2 and 3.5) rely on standard causal discovery assumptions, specifically causal sufficiency.
- What evidence would resolve it: A modified version of I-PERI that successfully recovers an equivalence class (e.g., a PAG) from data with latent variables in a federated setting.

### Open Question 2
- Question: Is it possible to refine the method to extract edge orientation information from parametric interventions?
- Basis in paper: [explicit] The paper states that when clients have parametric interventions, "no additional edge orientations beyond those identifiable from observational data can be inferred at the server level."
- Why unresolved: The current intersection-based regret function treats parametric changes as equivalent to observational data, failing to leverage potential distributional shifts that might signal causal direction.
- What evidence would resolve it: An extension of the scoring function that can detect and utilize distributional differences from parametric interventions to orient edges in the $\Phi$-CPDAG.

### Open Question 3
- Question: How does I-PERI perform on real-world datasets compared to the synthetic linear data used in the evaluation?
- Basis in paper: [inferred] The experiments section (Section 4) relies entirely on synthetic data generated via linear SEMs, while the Introduction and Discussion motivate the work with real-world healthcare scenarios.
- Why unresolved: Real-world federated data often involves non-linear relationships, missing data, and smaller sample sizes, which the current linear Gaussian evaluation does not address.
- What evidence would resolve it: Empirical results applying I-PERI to benchmark federated datasets (e.g., multi-hospital medical records) demonstrating robust performance outside of linear synthetic environments.

## Limitations
- Performance critically depends on Assumption 2.1 (existence of purely observational data), which may not hold in real-world federated settings.
- Theoretical guarantees rely on bounded parameter sensitivity assumptions that may not hold for complex causal models.
- Lack of empirical validation on real-world datasets limits generalizability beyond synthetic linear Gaussian models.

## Confidence
- **High Confidence**: Intersection-based regret mechanism for Phase 1 convergence, DP sensitivity bounds (Lemma 3.1, Proposition 3.1)
- **Medium Confidence**: Theoretical guarantees for Phase 2 orientation refinement, overall algorithm convergence
- **Low Confidence**: Performance on non-linear/non-Gaussian models, practical deployment considerations

## Next Checks
1. **Robustness to Intervention Coverage**: Systematically vary the number of structurally intervened variables per client (0%, 25%, 50%, 75%, 100%) and measure the degradation in Phase 2 orientation accuracy.
2. **Assumption Violation Stress Test**: Run experiments where no client has purely observational data to quantify performance collapse and identify failure modes.
3. **Real-World Transfer**: Apply I-PERI to benchmark causal discovery datasets (e.g., ALARM network) with simulated federated intervention scenarios to assess practical utility beyond synthetic data.