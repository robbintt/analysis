---
ver: rpa2
title: Failure Modes of Time Series Interpretability Algorithms for Critical Care
  Applications and Potential Solutions
arxiv_id: '2506.19035'
source_url: https://arxiv.org/abs/2506.19035
tags:
- failure
- patient
- time
- methods
- circulatory
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper investigates interpretability algorithms for time series
  prediction in critical care, specifically dynamic circulatory failure prediction.
  It identifies two main failure modes in conventional methods: difficulty handling
  time-varying multi-output models and lack of temporal smoothness in attributions.'
---

# Failure Modes of Time Series Interpretability Algorithms for Critical Care Applications and Potential Solutions

## Quick Facts
- arXiv ID: 2506.19035
- Source URL: https://arxiv.org/abs/2506.19035
- Reference count: 22
- Key outcome: Learnable mask-based interpretability methods (DynaMask, ExtremalMask) outperform conventional approaches for dynamic circulatory failure prediction in ICU settings

## Executive Summary
This paper investigates interpretability algorithms for time series prediction in critical care, specifically dynamic circulatory failure prediction. It identifies two main failure modes in conventional methods: difficulty handling time-varying multi-output models and lack of temporal smoothness in attributions. Gradient, occlusion, and permutation-based methods produce attributions that violate clinical causality and lack temporal coherence, making it hard to trace the evolution of patient deterioration. The authors demonstrate that learnable mask-based methods like DynaMask and ExtremalMask address these issues by incorporating temporal continuity and label consistency constraints. Using a causal CrossFormer model on the HiRID-ICU dataset, they achieve 97.19% AUC-ROC and 68.05% AUC-PR, outperforming standard transformers. Mask-based approaches provide temporally coherent and causally consistent feature importance, offering more reliable insights for dynamic organ failure prediction tasks.

## Method Summary
The study applies 14 time-series interpretability algorithms to a causal CrossFormer model trained on the HiRID-ICU dataset for dynamic circulatory failure prediction. The CrossFormer-Encoder uses segment-based embedding and causal cross-dimensional attention with a triangular mask to prevent future information leakage. The model operates on 231 clinical features at 5-minute intervals over 7-day horizons. Mask-based interpretability methods (DynaMask and ExtremalMask) are developed to learn feature importance while enforcing temporal continuity and label consistency constraints. These are compared against gradient-based (Integrated Gradients, DeepLift), perturbation-based (Occlusion, Permutation), and other attribution methods. Performance is evaluated on both predictive accuracy (AUC-ROC, AUC-PR, F1, MCC) and interpretability quality (temporal smoothness, clinical coherence).

## Key Results
- Causal CrossFormer-Encoder achieves 97.19% AUC-ROC and 68.05% AUC-PR on circulatory failure prediction, outperforming standard transformers with 98% fewer parameters (28.6K vs 1.64M)
- Conventional gradient-based methods produce empty attribution maps for historical timesteps and exhibit high variance between adjacent time steps
- Mask-based methods (DynaMask, ExtremalMask) demonstrate significantly lower variance in attributions across time steps while maintaining predictive fidelity
- Learnable masks provide better temporal coherence and causal consistency compared to traditional attribution methods
- Gradient, occlusion, and permutation-based methods violate clinical causality by allowing future information to influence past attributions

## Why This Works (Mechanism)

### Mechanism 1: Learnable Mask-Based Attribution with Temporal Constraints
Learnable mask-based methods produce more clinically coherent interpretations by explicitly optimizing for temporal continuity and label consistency. DynaMask and ExtremalMask learn masks over input time series that optimize attribution scores for each feature-time pair while enforcing smoothness constraints across adjacent timesteps and preserving predictive fidelity. The core assumption is that physiologically meaningful feature importance evolves smoothly over time rather than exhibiting abrupt, unexplained fluctuations.

### Mechanism 2: Causal Attention for Temporal Prediction Integrity
Causal attention masking prevents future information leakage, ensuring that predictions and their interpretations depend only on historically available data. A triangular attention mask sets future timestep scores to negative infinity before softmax, blocking backwards information flow while permitting full context from current and prior timesteps. The core assumption is that clinical decisions at time T should not be informed by observations from T+n; retrospective interpretation requires the same constraint.

### Mechanism 3: Cross-Dimensional Attention for Multivariate Dependency Capture
CrossFormer's segment-based embedding and cross-dimensional attention capture inter-feature dependencies across temporal segments more effectively than standard transformer architectures. The architecture jointly models time and feature dimensions through cross-dimensional attention, enabling the model to learn that correlated features (e.g., lactate and blood pressure) contribute jointly to predictions. The core assumption is that multivariate physiological signals have interdependencies that evolve temporally and should not be modeled as independent channels.

## Foundational Learning

- Concept: Attribution Aggregation in Multi-Dimensional Output Spaces
  - Why needed here: Traditional methods produce T × T × F × C attribution tensors for dynamic prediction tasks, but no consensus exists on how to aggregate these into clinically interpretable summaries.
  - Quick check question: Given attribution maps for two consecutive 5-minute intervals during circulatory failure, what aggregation strategy would preserve information about sustained vs. transient feature contributions?

- Concept: Perturbation-Based vs. Gradient-Based Interpretability
  - Why needed here: Gradient methods "assign highest attribution to the current timestep while neglecting earlier timesteps," failing to capture temporal evolution that perturbation-based masks can recover.
  - Quick check question: Why might gradient-based methods fail to attribute importance to features that gradually contributed to physiological decline over 6 hours?

- Concept: Temporal Smoothness as Interpretability Prior
  - Why needed here: The paper shows methods like FIT produce "abrupt changes in feature importance" inconsistent with physiological reality; understanding when smoothness is appropriate vs. restrictive is critical.
  - Quick check question: Name two clinical scenarios where feature importance should change abruptly (intervention) vs. gradually (disease progression).

## Architecture Onboarding

- Component map: Input layer -> Causal CrossFormer-Encoder -> Attention masking -> Prediction head -> Interpretability layer (DynaMask/ExtremalMask)
- Critical path:
  1. Preprocess HiRID-ICU data: normalize 231 features, impute missing values at 5-min granularity
  2. Train causal CrossFormer with binary cross-entropy loss on dynamic prediction task
  3. Apply mask-based interpretability method with temporal continuity and label consistency constraints
  4. Validate: confirm attributions are non-empty for historical timesteps and show temporal coherence

- Design tradeoffs:
  - Parameter efficiency (28.6K vs. 1.64M): smaller model enables faster perturbation-based interpretability requiring multiple forward passes
  - Local vs. global perturbation: DynaMask uses fixed local operations (faster, limited long-range); ExtremalMask learns global perturbations (slower, captures long-range dependencies)
  - Temporal granularity: 5-min resolution captures fine dynamics but creates 465,696 feature-time pairs per patient

- Failure signatures:
  - Empty attribution maps for past timesteps → gradient-based method failing to capture historical contributions
  - High variance between adjacent timesteps (T=199 vs T=200) → lack of temporal smoothness constraints
  - Attributions emerging only after failure onset (e.g., RETAIN) → method not capturing early pathophysiological indicators
  - T × T × F × C output without aggregation guidance → cannot identify sustained patterns

- First 3 experiments:
  1. Baseline failure mode replication: Apply gradient, occlusion, and permutation methods to Patient A and B; verify attribution inconsistency across adjacent timesteps (T=199 vs T=200, T=1099 vs T=1100)
  2. Mask-based validation: Compare DynaMask vs. ExtremalMask attributions for temporal smoothness variance; confirm higher attribution scores before event onset
  3. Constraint ablation: Remove temporal continuity constraint from mask optimization; quantify increase in attribution variance across timesteps

## Open Questions the Paper Calls Out
None

## Limitations
- The interpretability claims rely on qualitative clinical coherence rather than quantitative validation against ground truth feature importance
- CrossFormer architecture details (layer count, attention heads, segment size) remain unspecified, preventing exact reproduction
- The choice of temporal continuity weight in mask optimization is not justified empirically
- No established ground truth for feature importance in dynamic circulatory failure prediction

## Confidence

- **High**: Causal attention masking prevents future information leakage (supported by standard attention mechanics)
- **High**: Conventional gradient/SHAP methods produce temporally inconsistent attributions (demonstrated empirically)
- **Medium**: Mask-based methods provide clinically meaningful interpretations (claimed but not independently validated)
- **Medium**: CrossFormer outperforms standard transformers (statistically significant but architecture details missing)
- **Low**: Smoothness constraints always align with physiological reality (breaks when interventions cause abrupt changes)

## Next Checks

1. Conduct clinician review of DynaMask/ExtremalMask attributions on 10 representative circulatory failure cases to assess clinical coherence vs. ground truth pathophysiology
2. Perform ablation studies on temporal continuity constraint weight to determine optimal balance between smoothness and sensitivity to interventions
3. Compare attribution consistency across multiple patients with similar failure trajectories to establish method reliability beyond individual case studies