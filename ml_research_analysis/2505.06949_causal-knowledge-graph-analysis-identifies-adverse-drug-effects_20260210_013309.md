---
ver: rpa2
title: Causal knowledge graph analysis identifies adverse drug effects
arxiv_id: '2505.06949'
source_url: https://arxiv.org/abs/2505.06949
tags:
- causal
- drug
- knowledge
- disease
- effects
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces Causal Knowledge Graphs (CKGs) as a framework
  combining knowledge graphs with causal inference to identify adverse drug effects.
  CKGs extend traditional knowledge graphs by incorporating causal semantics, enabling
  principled causal inference while preserving deductive reasoning capabilities.
---

# Causal knowledge graph analysis identifies adverse drug effects

## Quick Facts
- arXiv ID: 2505.06949
- Source URL: https://arxiv.org/abs/2505.06949
- Reference count: 40
- The paper introduces Causal Knowledge Graphs (CKGs) as a framework combining knowledge graphs with causal inference to identify adverse drug effects.

## Executive Summary
This paper introduces Causal Knowledge Graphs (CKGs) as a novel framework for identifying adverse drug reactions (ADRs) by combining knowledge graphs with formal causal inference. CKGs extend traditional knowledge graphs by incorporating causal semantics while preserving deductive reasoning capabilities, enabling principled causal inference for drug safety analysis. The authors construct a Drug-Disease CKG integrating disease progression, drug indications, side effects, and ICD-10 hierarchies, then apply mediation analysis to test whether drugs mediate effects between disease indications and downstream disease progression. The approach successfully reproduces known adverse drug reactions with precision up to 0.907 and identifies previously undocumented effects validated through side effect similarity analysis.

## Method Summary
The authors construct a Drug-Disease CKG integrating disease progression edges (7,586 edges), MEDI-C high-precision drug indications (20,955 edges), OnSIDES side effects (59,119 edges), and ICD-10 disease hierarchies. They generate hypotheses from disease progression edges and significant comorbidities (RR, Benjamini-Hochberg α=0.05), filter hypotheses to remove treatment overlap and common downstream effects, map drugs using exact match plus LLM-assisted mapping (Llama-3-70B, 0.70 precision for UKB), identify confounders via backdoor adjustment or disjunctive cause criterion using DAGitty, apply double-LASSO for covariate selection, and run causal mediation analysis with the R mediation package (1,000 quasi-Bayesian simulations). Results are validated against OnSIDES/OFFSIDES databases and through side effect similarity prediction (Tanimoto coefficient).

## Key Results
- The approach successfully reproduced known adverse drug reactions with precision up to 0.907 and recall 0.282
- Combining predicted drug effects with established databases significantly improved prediction of shared drug indications (ROCAUC 0.632 vs 0.604 baseline)
- The framework identified previously undocumented adverse drug effects that show clinical relevance through validation

## Why This Works (Mechanism)

### Mechanism 1
CKGs enable principled causal inference by extending knowledge graphs with formal causal semantics while preserving deductive reasoning. The framework partitions relations into R_causal (causal subset) and non-causal relations. Causal edges (disease progression, inverse indication) define where probabilistic causal inference applies. The probability space (Ω, 2^Ω, P) is constrained by KG semantics through the mapping function f, which respects hierarchical "is a" relations—ensuring that if x ∈ f(u) and u "is a" v, then x ∈ f(v). Core assumption: The subset R_causal correctly identifies genuinely causal relations; misclassifying associational relations as causal would propagate invalid inferences.

### Mechanism 2
Automated confounder identification via graph structure enables scalable adjustment across thousands of hypotheses. For each drug-mediated hypothesis (D1 → Drug → D2), the DD-CKG is queried for adjustment sets using two criteria: (1) backdoor adjustment (blocks confounding paths) and (2) disjunctive cause (selects causes of treatment, outcome, or both). LASSO regression then shrinks covariate sets, selecting variables with non-zero coefficients from union of two models (one for indication, one for outcome). Core assumption: The DD-CKG captures all relevant pre-treatment confounders; unmeasured confounding (e.g., disease severity) remains problematic.

### Mechanism 3
Mediation analysis quantifies drug contributions to disease progression pathways. Natural Indirect Effect (NIE) = E[Y_{0,M1} - Y_{0,M0}] captures outcome change from shifting mediator (drug) from untreated to treated value, holding treatment fixed. Estimated via regression-based potential outcomes (mediation R package) with 1,000 quasi-Bayesian simulations. Sequential ignorability assumed: treatment independent of potential outcomes given observed covariates. Core assumption: Sequential ignorability holds conditional on observed pre-treatment covariates; no unmeasured mediator-outcome confounding.

## Foundational Learning

- **Structural Causal Models (SCMs) and DAGs**: Why needed here: CKGs formalize the qualitative DAG component within a KG structure; understanding d-separation, backdoor criterion, and potential outcomes is prerequisite to interpreting mediation results. Quick check question: Given DAG X → M → Y with unobserved U → M and U → Y, can we identify the causal effect of M on Y?

- **Knowledge Graph Semantics (subsumption, entailment)**: Why needed here: The "is a" hierarchy constrains probability distributions; deductive inference from ontology axioms generates candidate hypotheses beyond explicitly encoded edges. Quick check question: If E11.9 "is a" E11, and probability P(E11.9) = 0.05, what constraint does this impose on P(E11)?

- **Mediation Analysis (direct, indirect, total effects)**: Why needed here: ACME (Average Causal Mediation Effect) quantifies drug contribution; distinguishing positive/negative ACME and proportion mediated is essential for interpreting results. Quick check question: If ACME is significant but direct effect is near-zero, what does this imply about the drug's role in the causal pathway?

## Architecture Onboarding

- **Component map**: DD-CKG Construction -> Hypothesis Generator -> Cohort Mapper -> Confounder Selector -> Mediation Engine -> Validation
- **Critical path**: DD-CKG construction → hypothesis generation → cohort mapping (bottleneck: LLM accuracy 0.70-0.83) → confounder identification → mediation analysis → validation against OnSIDES/OFFSIDES
- **Design tradeoffs**: 
  - Precision vs. recall: "Causal set" (explicit progression edges) yields precision 0.907, recall 0.282; "Comorbidity set" yields precision 0.749, recall 0.282 with more novel findings
  - Confounder criteria: Backdoor stricter (fewer hypotheses testable) vs. disjunctive cause more permissive (more covariates, higher dimensional adjustment)
  - Self-reported medications (UKB) vs. pharmacy records (MIMIC): trade accuracy for sample size
- **Failure signatures**:
  - High false positive rate when outcome is natural disease progression (6% of false positives attributed to severity confounding)
  - "Suppression effects" where direct and indirect effects have opposite signs (e.g., Vincristine case: proportion mediated = -0.905)
  - Insufficient sample size: hypotheses excluded if no individuals with indication=1, drug=1, side_effect=1 co-occurring
- **First 3 experiments**:
  1. Reproduce precision/recall metrics on "causal set" using disjunctive cause + LASSO; verify Table 1 values (precision 0.907, recall 0.282).
  2. Run side-effect similarity prediction (Tanimoto coefficient) comparing OnSIDES-only vs. OnSIDES + predicted effects; confirm ROCAUC improvement (0.604 → 0.632).
  3. Manually inspect 10 novel ADR candidates from comorbidity set; check if outcome disease is known progression vs. plausible drug effect (consult literature as done for PPIs/ACE inhibitors).

## Open Questions the Paper Calls Out

- **Generalizability**: Can the Causal Knowledge Graph (CKG) framework be generalized to other biomedical domains beyond pharmacovigilance? The authors state the framework has "the potential to be extended to other applications of causal inference where structured domain knowledge and observational data are both available," but current validation is limited to Drug-Disease interactions using UK Biobank and MIMIC-IV data.

- **Unobserved confounding**: To what extent does unobserved disease severity contribute to false positive identifications of drug-mediated adverse effects? The authors note that outcome disease sometimes indicates increased severity rather than true drug effects, and severity is not directly observable, with current proxies (number of comorbidities and prescribed medications) potentially insufficient.

- **Mild side effect integration**: Does the integration of text-mined data for mild or transient side effects improve the predictive performance of the DD-CKG? The paper acknowledges that using ICD-coded diagnoses means transient or mild side effects are not observed, potentially missing a large class of adverse drug reactions.

## Limitations

- Causal inference validity depends on text-mined disease progression edges potentially containing spurious causal claims that propagate invalid mediation estimates
- Mediation analysis assumptions of sequential ignorability may be violated due to unmeasured mediator-outcome confounding in pharmacovigilance contexts
- Drug mapping reliability limited by 0.70 precision LLM approach and self-reported medication data introducing measurement error

## Confidence

- **High confidence**: The framework's ability to reproduce known ADRs (precision 0.907 on causal set) and the methodological soundness of the CKG construction and mediation analysis approach
- **Medium confidence**: The novel ADR predictions and their clinical relevance, as validated through side effect similarity analysis showing ROC AUC improvement from 0.604 to 0.632
- **Low confidence**: The generalizability to rare ADRs and long-term effects not captured in the disease progression DAG or available cohorts

## Next Checks

1. **Manual validation of novel predictions**: Select 10 novel ADR candidates from the comorbidity set and conduct comprehensive literature review to determine whether these represent true previously undocumented effects versus natural disease progression or measurement artifacts.

2. **Sensitivity analysis for confounder selection**: Re-run the analysis using only backdoor adjustment (stricter) versus only disjunctive cause (more permissive) to assess how confounder selection criteria impact precision and recall of ADR predictions.

3. **Temporal validation**: For a subset of high-confidence novel ADRs, examine the temporal ordering of drug exposure, indication, and outcome in the raw data to verify the assumed causal direction and rule out reverse causation or protopathic bias.