---
ver: rpa2
title: 'How I Warped Your Noise: a Temporally-Correlated Noise Prior for Diffusion
  Models'
arxiv_id: '2504.03072'
source_url: https://arxiv.org/abs/2504.03072
tags:
- noise
- diffusion
- video
- warping
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a novel approach to preserving temporal correlations
  in diffusion-based video generation by reinterpreting noise samples as continuously
  integrated noise fields, dubbed $\int$-noise. The key idea is to treat individual
  noise samples as integrals of an underlying infinite-resolution noise field, enabling
  variance-preserving transport through a newly derived noise transport equation.
---

# How I Warped Your Noise: a Temporally-Correlated Noise Prior for Diffusion Models

## Quick Facts
- **arXiv ID:** 2504.03072
- **Source URL:** https://arxiv.org/abs/2504.03072
- **Reference count:** 40
- **Primary result:** A variance-preserving noise transport equation that improves temporal coherency in diffusion-based video generation by 4x on warp error metrics

## Executive Summary
This paper introduces a novel approach to preserving temporal correlations in diffusion-based video generation by reinterpreting noise samples as continuously integrated noise fields, dubbed $\int$-noise. The key innovation is a noise transport equation derived from Itô calculus that allows noise samples to be warped by optical flow while maintaining their statistical properties. This enables diffusion models to generate temporally coherent video sequences by using a noise prior that is itself temporally correlated through warping, addressing common flickering and texture-sticking artifacts in video generation.

## Method Summary
The method consists of three components: (1) a continuous $\int$-noise representation that treats discrete noise samples as integrals of an infinite-resolution white noise field, enabling variance-preserving operations; (2) a distribution-preserving noise transport equation derived from Itô calculus that warps noise by deformation fields while maintaining Gaussian statistics; and (3) a discrete implementation using polygon rasterization and aggregation with an upsampling factor $k$ (typically $k=3$) to approximate the continuous warping. The approach is evaluated on video restoration, super-resolution, pose-to-person generation, and surrogate rendering tasks.

## Key Results
- Achieves 4x improvement in warp error (2.50 vs 10.00) compared to random noise for appearance transfer tasks
- Demonstrates superior temporal coherency in qualitative examples across multiple video generation tasks
- Maintains competitive FID and precision metrics while improving temporal stability
- Shows limitations in latent diffusion models where decoder influence diminishes noise correlation benefits

## Why This Works (Mechanism)

### Mechanism 1: Continuous $\int$-Noise Representation for Variance Preservation
Reinterpreting discrete noise as integrals of an infinite-resolution white noise field enables sub-sampling operations that maintain the Gaussian distribution, preventing variance collapse during warping. The $\int$-noise representation posits that a pixel value is the integral of an underlying white noise over the pixel area. Conditional sampling at finer resolution creates a "Brownian bridge" between neighboring values, adding stochasticity that compensates for variance lost in simple interpolation.

### Mechanism 2: Distribution-Preserving Noise Transport Equation
A transport equation derived from Itô calculus allows a noise field to be warped by a deformation field while preserving its defining statistical properties. The equation includes a term involving the square root of the deformation field's Jacobian determinant, correctly rescaling sampled noise variance to account for local stretching or compression. This ensures the output remains a standard normal variable, unlike standard transport equations.

### Mechanism 3: Flow-Guided Noise Correlation for Temporal Coherence
Warping noise with video optical flow creates a temporally-correlated noise prior, leading to more coherent denoising results across video frames. By warping an initial noise sample using accumulated optical flow, the noise sample for any frame will be highly correlated with the initial frame in regions connected by flow. When this correlated noise is used as the starting point for a diffusion process, generated high-frequency details in subsequent frames will also be correlated, reducing flickering and texture-sticking artifacts.

## Foundational Learning

**White Gaussian Noise** - A random set function where values over disjoint areas are independent with variance proportional to area. Essential for understanding why standard interpolation fails and how $\int$-noise works.

*Why needed:* This is the fundamental mathematical object the paper reinterprets. Understanding its definition is essential to grasp why standard interpolation fails and how $\int$-noise works.

*Quick check:* Why does a simple linear interpolation between two independent Gaussian samples result in a sample with lower variance?

**Itô Calculus / Integral** - A branch of stochastic calculus used to derive the noise transport equation. The theoretical justification relies on Itô integrals and their properties.

*Why needed:* The theoretical justification for the noise transport equation relies on Itô calculus. The derivation in Appendix C uses Itô integrals and their properties to prove the equation is distribution-preserving.

*Quick check:* What is the variance of the Itô integral $\int_A \varphi(x) dB(x)$, where $B(x)$ is Brownian motion?

**Diffeomorphism** - A smooth, invertible mapping between spaces. The core noise transport equation assumes a diffeomorphic deformation field.

*Why needed:* The core noise transport equation assumes a diffeomorphic deformation field. Recognizing this assumption is critical for understanding the method's limitations (e.g., disocclusions) and the need for heuristics in non-ideal cases.

*Quick check:* Why is the invertibility of the deformation field $T$ a necessary condition for the noise transport equation to be well-defined?

## Architecture Onboarding

**Component map:** Video frames + Optical Flow -> Flow Accumulator -> Deformation Field T -> Discrete Noise Warper (Alg. 2) -> Warped Noise -> Diffusion Pipeline

**Critical path:** The Discrete Noise Warper (Algorithm 2) is the core novel component. Its correctness depends on the accuracy of the Flow Accumulator and the effectiveness of the Disocclusion Handler. The entire pipeline's goal is to produce the noise sequence for the Diffusion Pipeline.

**Design tradeoffs:**
- **Upsampling factor (k) vs. Runtime/Accuracy:** Higher k leads to more accurate warping but higher computational cost (Table 4). k=3 is a recommended default.
- **Polygon subdivision (s) vs. Runtime/Accuracy:** Higher s improves the geometric approximation of warped pixels but adds cost.
- **Latent vs. Pixel-Space Diffusion:** The method is shown to be less effective in latent diffusion models (Appendix E) due to the decoder's influence and lower noise resolution.

**Failure signatures:**
- **Flickering or Texture-Sticking:** Likely due to incorrect flow, low k, or applying the method in a constrained pipeline (e.g., latent diffusion).
- **Blurred or "Liquid" Motion:** Might indicate the flow is not accurate or the noise is not being warped correctly.
- **Undefined Pixels:** Occurs with large deformations or low k. Mitigated by the disocclusion handler, but excessive undefined pixels will be filled with random noise, reducing coherence.

**First 3 experiments:**
1. **Reproduce 1-D Toy Example:** Implement the 1-D interpolation vs. $\int$-noise example (Fig 2b). Generate samples and plot histograms to visually confirm the variance-preservation property of $\int$-noise against standard interpolation.
2. **Noise Warping Visualization:** Take a fixed noise sample and a known, smooth deformation field (e.g., simple translation or rotation). Warp the noise using the pipeline and visualize the result. Compare against bilinear interpolation to observe the lack of blur and artifacts.
3. **Temporal Coherence Ablation:** Apply the full pipeline to a short video clip with known ground-truth flow (e.g., from a simulation). Compare the temporal coherence (warp error) of generated frames using (a) random noise, (b) fixed noise, and (c) $\int$-noise-warped noise.

## Open Questions the Paper Calls Out

**Open Question 1:** How can the $\int$-noise transport method be adapted for Latent Diffusion Models (LDMs) to improve temporal coherency, given the observed disconnect where high-frequency details are generated by the VAE decoder rather than the latent noise?

**Open Question 2:** Can the $\int$-noise prior be integrated into the *training* objective of video diffusion models to improve temporal stability, rather than just being applied as an inference-time technique?

**Open Question 3:** Is there a theoretical or learned approximation of the noise transport equation (Equation 4) that avoids the computational cost of high-resolution rasterization while strictly preserving the white noise variance property?

## Limitations

- **Computational cost:** The method requires high-resolution rasterization and is significantly slower than simpler noise sampling techniques
- **Latent diffusion model limitations:** Less effective in LDMs due to decoder influence on high-frequency details
- **Diffeomorphism assumption:** The core equation assumes smooth, invertible deformation fields and relies on heuristics for handling disocclusions

## Confidence

- **$\int$-noise variance preservation:** High confidence - well-supported by theoretical derivation and 1D toy example
- **Flow-guided noise correlation:** Medium confidence - empirically demonstrated but dependent on accurate optical flow
- **Practical applicability:** Medium confidence - demonstrated across multiple tasks but with important limitations in LDMs

## Next Checks

1. **Variance Preservation Test:** Implement the 1D interpolation vs. $\int$-noise example with varying $\alpha$ values. Measure and compare variance across interpolated points to confirm unit variance preservation.

2. **Warp Error Baseline Comparison:** Apply the method to a synthetic video sequence with known ground-truth flow. Compare warp error against random noise and fixed noise baselines, and verify the reported improvement factor (~4x).

3. **Disocclusion Robustness Test:** Generate a test case with significant disocclusions (e.g., object entering/exiting frame). Measure the undefined pixel ratio and visual quality of the two-stage heuristic approach versus pure random fill baseline.