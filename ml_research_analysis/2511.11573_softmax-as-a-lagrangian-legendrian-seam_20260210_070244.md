---
ver: rpa2
title: Softmax as a Lagrangian-Legendrian Seam
arxiv_id: '2511.11573'
source_url: https://arxiv.org/abs/2511.11573
tags:
- softmax
- seam
- geometry
- contact
- screen
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper establishes a geometric framework modeling softmax as
  a contact interface between two potential-generated Lagrangian descriptions. The
  logits-to-probabilities transformation is represented as a Legendrian seam on a
  contact screen (the probability simplex) within a folded symplectic collar.
---

# Softmax as a Lagrangian-Legendrian Seam

## Quick Facts
- arXiv ID: 2511.11573
- Source URL: https://arxiv.org/abs/2511.11573
- Authors: Christopher R. Lee-Jenkins
- Reference count: 9
- One-line primary result: Establishes a geometric framework modeling softmax as a contact interface between two potential-generated Lagrangian descriptions.

## Executive Summary
This paper constructs a geometric model of the softmax function as a Legendrian seam within a folded symplectic collar. The framework connects the logits-to-probabilities transformation to contact geometry, where the seam represents the exact equality case of Fenchel-Young duality. The model reveals bias-shift invariance as Reeb flow on the contact screen and provides KL divergence as a computable distance to the seam. Concrete examples for two- and three-class cases demonstrate the geometric structure, potentially bridging machine learning normalization steps with symplectic/contact geometry.

## Method Summary
The construction uses two convex potentials: negative entropy φ(y) = Σᵢ yᵢ log yᵢ and log-sum-exp φ*(z) = log Σᵢ eᵢᶻ. Their gradient graphs form Lagrangian submanifolds L⁺ and L⁻ in a folded symplectic collar M with ωq = dr∧α + r²dα, meeting at the fold r=0. The contact screen Z carries the 1-form α = Σᵢ zᵢ dyᵢ, and the seam Γ where y = softmax(z) is Legendrian (annihilated by α). The Fenchel-Young gap φ(y) + φ*(z) - ⟨z,y⟩ equals KL(y‖softmax(z)) and measures distance from any point to the seam.

## Key Results
- The softmax mapping emerges from two convex-dual potentials whose gradient graphs are Lagrangian submanifolds in a folded symplectic collar
- KL divergence measures Legendrian distance to the seam, vanishing exactly when y = softmax(z)
- Bias-shift invariance corresponds to motion along the Reeb vector field on the contact screen

## Why This Works (Mechanism)

### Mechanism 1: Dual Potential Graphs Generate Lagrangian Surfaces
- Claim: The softmax mapping emerges from two convex-dual potentials whose gradient graphs are Lagrangian submanifolds in the folded symplectic collar.
- Mechanism: The negative entropy potential φ(y) = Σᵢ yᵢ log yᵢ generates probabilities via z = ∇φ(y), while the log-sum-exp potential φ*(z) = log Σᵢ eᵢᶻ generates probabilities via y = ∇φ*(z) = softmax(z). These graphs L⁺ and L⁻ occupy opposite sides of the fold r=0 and conserve the symplectic form ωq away from the fold.
- Core assumption: The quadratic collar ωq = dr∧α + r²dα correctly models the geometry near the normalization step.
- Evidence anchors: [abstract] "two potential-generated, conservative descriptions (from negative entropy and log-sum-exp) meet along a Legendrian 'seam'"

### Mechanism 2: KL Divergence Measures Legendrian Distance to Seam
- Claim: The Fenchel-Young gap φ(y) + φ*(z) - ⟨z,y⟩ equals KL(y‖softmax(z)) and quantifies deviation from the Legendrian seam.
- Mechanism: On the seam Γ, the Fenchel-Young equality ⟨z,y⟩ = φ(y) + φ*(z) holds exactly when y = softmax(z). Off the seam, the gap equals the KL divergence, providing a computable "distance" (nonnegative, zero iff on seam).
- Core assumption: The KL divergence interpretation as geometric distance is valid within this contact structure.
- Evidence anchors: [abstract] "the Fenchel-Young equality/KL gap provides a computable distance to the seam"

### Mechanism 3: Bias-Shift Invariance as Reeb Flow
- Claim: The invariance softmax(z) = softmax(z + c·1) corresponds to motion along the Reeb vector field on the contact screen.
- Mechanism: The 1-form α = Σᵢ zᵢ dyᵢ is invariant under z → z + c·1 because α depends only on logit differences. The Reeb direction R satisfies α(R) = 1 and dα(R, ·) = 0; translating logits by constants moves along R without changing measurements from dα.
- Core assumption: Contact structure (α, dα) correctly captures the constraint geometry.
- Evidence anchors: [abstract] "Bias-shift invariance appears as Reeb flow on the screen"

## Foundational Learning

- Concept: **Legendrian submanifold**
  - Why needed here: The seam where logits and probabilities "agree" is Legendrian—it is annihilated by the contact 1-form α, meaning "work" vanishes along it.
  - Quick check question: Given α = z·dy, does a curve in the (y,z)-space lie in ker(α)?

- Concept: **Fenchel-Young duality**
  - Why needed here: The equality case of Fenchel-Young ⟨z,y⟩ = φ(y) + φ*(z) defines the seam; the inequality gives KL divergence as the gap.
  - Quick check question: For convex φ, when does ∇φ*(z) equal the maximizing y in the conjugate definition?

- Concept: **Contact structure and Reeb flow**
  - Why needed here: The screen Z carries a contact structure; Reeb flow encodes bias-shift invariance intrinsically, linking logit ambiguity to geometry.
  - Quick check question: If α(R) = 1 and dα(R, ·) = 0, does adding a constant to z move along R?

## Architecture Onboarding

- Component map:
  - Screen Z: Probability simplex × logit-equivalence-classes; where α = Σᵢ zᵢ dyᵢ measures "work"
  - Collar M: Z thickened by temperature-like coordinate r; carries ωq = dr∧α + r²dα
  - Lagrangian sides L⁺/L⁻: Graphs of softmax (r>0) and log-probability (r<0); meet at fold r=0
  - Seam Γ: Legendrian intersection where y = softmax(z); Fenchel-Young holds exactly

- Critical path:
  1. Start with logits z ∈ Rᵈ (mod constant shifts)
  2. Compute softmax(z) = ∇φ*(z) → probabilities on simplex
  3. KL gap quantifies distance to seam; zero gap means (y,z) lies on Γ
  4. Inverting requires gauge choice (e.g., zero-mean: Π(y) = log y - mean(log y)·1)

- Design tradeoffs:
  - Gauge choice: Zero-mean vs. other gauges affect numerical stability and Reeb-coordinate interpretation
  - Local vs. global: Paper is local near fold; extending to compact logit spaces (projective/spherical) is future work
  - Temperature r: Physical interpretation as temperature is suggested but not exploited

- Failure signatures:
  - Boundary approach: As probabilities → 0, log y → -∞; interior-only formulation breaks
  - Non-Lagrangian perturbations: Adding non-conservative noise disrupts symplectic structure
  - Gauge inconsistency: Mixing gauges corrupts the Reeb flow interpretation

- First 3 experiments:
  1. **KL-as-distance visualization**: For 2-class case, plot KL(y‖σ(Δ)) contours on (Δ, p)-plane; verify zero-level set is the sigmoid curve.
  2. **Reeb flow check**: Given logit pairs differing by c·1, confirm softmax outputs are identical and the 1-form α is unchanged; trace constant-z shifts on the screen.
  3. **Three-class seam mapping**: In the simplex Δ₂, compute softmax for a grid of centered logits (˜z₁, ˜z₂); verify grid lines converge appropriately at simplex boundaries.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the local folded symplectic construction be extended to a global, compact model for logit space (e.g., projective space or spheres) that preserves the Legendrian seam structure?
- Basis in paper: [explicit] The author states: "What we present is also local. To leverage the full power of symplectic methods (global invariants, compactness arguments, and long-time dynamics), one would like a compact ambient model for logit space—e.g., working modulo scale and mean so that logits descend to a projective space, or after normalization to a sphere."
- Why unresolved: The current construction works in a collar neighborhood of the fold but does not address behavior at infinity or provide a compact domain; global symplectic tools require compactness.
- What evidence would resolve it: An explicit compactification of logit space preserving the folded structure, with proofs that Lagrangian graphs extend globally and the seam remains well-defined.

### Open Question 2
- Question: What global invariants (symplectic or contact) can be computed from this construction that are meaningful for ML optimization or generalization?
- Basis in paper: [explicit] The abstract lists "global invariants" as a next step, and the conclusion states compactifications "promise global versions of the local statements proved here."
- Why unresolved: No specific invariants are proposed or computed; the paper focuses on the local geometric structure rather than extracting quantitative invariants.
- What evidence would resolve it: Identification of specific symplectic/contact invariants (e.g., symplectic capacities, contact homology classes) computed from the construction, with interpretation in ML terms.

### Open Question 3
- Question: How does the quadratic collar construction generalize to d > 3 classes, and does the Legendrian property of the seam persist with the same computational verification via KL divergence?
- Basis in paper: [inferred] The paper explicitly verifies the construction only for d = 2 and d = 3, stating "We work out the two- and three-class cases to make the picture concrete" without proving the general d-dimensional case.
- Why unresolved: The explicit coordinate computations for α and ωq are given only for d = 2, 3; general d requires verification that the contact structure and Legendrian seam behave identically.
- What evidence would resolve it: A general proof that Γ is Legendrian for arbitrary d, or identification of any dimension-dependent obstructions to the construction.

## Limitations
- The geometric framework is mathematically rigorous but its practical utility for ML remains speculative
- The construction is local near the fold; global properties of compact logit spaces are unexplored
- Boundary cases where probabilities approach zero create numerical and theoretical challenges

## Confidence
- High confidence: The mathematical construction of the folded symplectic collar, Lagrangian sides, and Legendrian seam is sound given the stated assumptions. The KL-Fenchel-Young identity is algebraically correct.
- Medium confidence: The interpretation of KL divergence as a geometric "distance" to the seam is meaningful within the contact structure, but whether this provides actionable ML insights remains to be demonstrated.
- Low confidence: The claim that bias-shift invariance "appears as" Reeb flow provides practical ML benefits; this is currently a mathematical correspondence without demonstrated utility.

## Next Checks
1. **KL-as-distance experiment**: For 2-class case, plot KL(y‖σ(Δ)) contours on (Δ, p)-plane; verify zero-level set matches sigmoid curve and contours are convex.
2. **Reeb flow verification**: Take logit pairs (z, z+c·1) and confirm softmax outputs are identical while the 1-form α = Σzᵢ dyᵢ is invariant under the shift.
3. **Three-class visualization**: In Δ₂, map centered logit grid to softmax outputs; verify convergence at boundaries and that KL gaps behave as predicted by the geometric model.