---
ver: rpa2
title: A New Formulation for Zeroth-Order Optimization of Adversarial EXEmples in
  Malware Detection
arxiv_id: '2405.14519'
source_url: https://arxiv.org/abs/2405.14519
tags:
- algorithm
- zexe
- malware
- optimization
- adversarial
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a novel formulation for adversarial example
  generation in Windows malware detection, casting the problem within a zeroth-order
  optimization framework. The key contribution is ZEXE, a gradient-free algorithm
  that incorporates functionality-preserving manipulations through an initialization
  and rewriting strategy.
---

# A New Formulation for Zeroth-Order Optimization of Adversarial EXEmples in Malware Detection

## Quick Facts
- arXiv ID: 2405.14519
- Source URL: https://arxiv.org/abs/2405.14519
- Reference count: 40
- Key outcome: ZEXE achieves higher evasion rates than GAMMA while injecting less content (211KB vs 881KB for MalConv)

## Executive Summary
This paper presents ZEXE, a novel gradient-free algorithm for generating adversarial examples in Windows malware detection. The algorithm casts adversarial example generation within a zeroth-order optimization framework, incorporating functionality-preserving manipulations through initialization and rewriting strategies. ZEXE provides theoretical guarantees and requires minimal hyperparameter tuning, addressing limitations of previous content-injection attacks. The method uses structured finite differences with adaptive stepsize selection and exploration strategies to optimize adversarial perturbations.

## Method Summary
ZEXE formulates adversarial example generation as a constrained optimization problem within a zeroth-order optimization framework. The algorithm employs structured finite differences with adaptive stepsize selection to estimate gradients without requiring explicit derivative information. It incorporates an initialization and rewriting strategy that preserves malware functionality while maximizing evasion capability. The approach is designed specifically for Windows Portable Executable files and tested against two malware detectors: MalConv and GBDT-EMBER.

## Key Results
- ZEXE achieved 60.9% evasion rate against MalConv compared to GAMMA's 58%
- ZEXE achieved 37% evasion rate against GBDT-EMBER compared to GAMMA's 20%
- ZEXE reduced injected content by more than half (211KB vs 881KB for MalConv)

## Why This Works (Mechanism)
The effectiveness of ZEXE stems from its gradient-free optimization approach that combines structured finite differences with adaptive stepsize selection. By treating adversarial example generation as a constrained optimization problem, the algorithm can systematically explore the solution space while preserving malware functionality through its initialization and rewriting strategy. The zeroth-order formulation allows the method to work with black-box detectors where gradient information is unavailable, while the theoretical convergence guarantees ensure reliable performance across different non-convex, non-smooth settings.

## Foundational Learning

1. **Zeroth-order optimization** - Needed for black-box adversarial attacks where gradients are unavailable; quick check: understand difference between first-order and zeroth-order methods
2. **Finite difference methods** - Required for gradient estimation in gradient-free optimization; quick check: understand structured vs random finite differences
3. **Malware PE file structure** - Essential for functionality-preserving manipulations; quick check: understand PE header, sections, and import tables
4. **Adversarial example generation** - Core concept for attacking ML-based malware detectors; quick check: understand evasion vs poisoning attacks
5. **Constrained optimization** - Necessary for balancing evasion and functionality; quick check: understand Lagrangian vs penalty methods

## Architecture Onboarding

Component Map: Input PE File -> Initialization & Rewriting -> ZEXE Optimization -> Adversarial Example

Critical Path: The algorithm begins with PE file initialization and rewriting to ensure functionality preservation, followed by the ZEXE optimization loop that iteratively estimates gradients using structured finite differences and updates the adversarial example until convergence or maximum iterations.

Design Tradeoffs: ZEXE prioritizes theoretical guarantees and minimal hyperparameter tuning over computational efficiency, trading off runtime for robustness and reliability. The choice of structured finite differences over random methods provides better convergence properties but may require more function evaluations.

Failure Signatures: Poor convergence may indicate inadequate initialization, while functionality preservation failures suggest issues with the rewriting strategy. High computational costs could signal inefficient parameter settings or problematic PE file structures.

First Experiments:
1. Test ZEXE on a simple linear classifier to validate basic functionality
2. Run convergence analysis on synthetic non-convex functions
3. Verify functionality preservation on modified PE files without adversarial objectives

## Open Questions the Paper Calls Out

The paper does not explicitly call out open questions, but several implicit research directions emerge from the work, including extending the approach to other malware architectures beyond Windows PE files, applying the method to more sophisticated detection systems, and exploring the theoretical limitations of zeroth-order optimization in adversarial settings.

## Limitations

- Evaluation focused on only two specific malware detectors (MalConv and GBDT-EMBER)
- Limited generalizability to malware architectures beyond Windows Portable Executable files
- Convergence analysis may not fully account for real-world computational constraints

## Confidence

- High confidence in the technical formulation and theoretical underpinnings of ZEXE
- Medium confidence in empirical evaluation results due to limited scope of tested detectors
- Medium confidence in claimed advantages over GAMMA pending broader comparative studies

## Next Checks

1. Test ZEXE against a wider range of modern malware detectors beyond MalConv and GBDT-EMBER
2. Evaluate performance on malware families not included in training data
3. Conduct comprehensive comparison with state-of-the-art adversarial attack methods developed after GAMMA