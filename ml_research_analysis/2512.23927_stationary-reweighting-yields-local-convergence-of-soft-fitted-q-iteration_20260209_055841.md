---
ver: rpa2
title: Stationary Reweighting Yields Local Convergence of Soft Fitted Q-Iteration
arxiv_id: '2512.23927'
source_url: https://arxiv.org/abs/2512.23927
tags:
- local
- bellman
- contraction
- lemma
- soft
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper studies the stability of entropy-regularized fitted
  Q-iteration (soft FQI) under function approximation and distribution shift. The
  authors identify a fundamental "norm mismatch": the soft Bellman operator is locally
  contractive in the stationary norm of the optimal policy, but standard soft FQI
  performs regression in the behavior distribution.'
---

# Stationary Reweighting Yields Local Convergence of Soft Fitted Q-Iteration

## Quick Facts
- **arXiv ID:** 2512.23927
- **Source URL:** https://arxiv.org/abs/2512.23927
- **Reference count:** 40
- **Primary result:** Stationary-reweighted soft FQI achieves local linear convergence under approximate realizability and weighted orthogonality conditions

## Executive Summary
This paper addresses the stability of entropy-regularized fitted Q-iteration (soft FQI) under function approximation and distribution shift. The authors identify a fundamental "norm mismatch": the soft Bellman operator is locally contractive in the stationary norm of the optimal policy, but standard soft FQI performs regression in the behavior distribution. To restore the correct geometry, they introduce stationary-reweighted soft FQI, which reweights each regression update using the stationary density ratio of the current policy. Under approximate realizability and a weighted orthogonality condition, they prove local linear convergence with geometrically damped weight-estimation errors.

## Method Summary
The method introduces stationary-reweighted soft FQI for offline reinforcement learning with entropy regularization. At each iteration k, the algorithm computes soft Bellman targets using current Q-value estimates, then solves a weighted regression problem where weights are estimated stationary density ratios dμ_π/dν_b of the current policy. This reweighting aligns the regression geometry with the Bellman operator's natural contraction norm. The method requires only approximate realizability (Q* ≈ Π_F Q*) plus weighted orthogonality, not the stronger Bellman completeness. A temperature homotopy approach is suggested for global convergence, gradually reducing the softmax temperature from initialization to target value.

## Key Results
- Local linear convergence of stationary-reweighted soft FQI under approximate realizability
- Weight errors enter through geometrically damped accumulation rather than exponential blowup
- Weighted orthogonality condition (C5) is substantially weaker than Bellman completeness
- Temperature annealing can potentially extend local results to global convergence

## Why This Works (Mechanism)

### Mechanism 1
The soft Bellman operator T is locally contractive around its fixed point Q* in the stationary L²(μ*) norm, not the behavior norm used by standard FQI. Linearization of T around Q* yields T(Q) ≈ Q* + γP^eval_π*(Q − Q*), where P^eval_π* is nonexpansive in L²(μ*). The local contraction modulus is ρ(r) = γ + β_loc r^α < 1 within the contraction region B(r₀, Q*). This relies on Fréchet differentiability of T and Hölder-type L∞–L² control of the nonlinear remainder.

### Mechanism 2
Stationary reweighting restores contraction by aligning regression geometry with the operator's natural norm. By replacing behavior-weighted regression with weighted regression using w_F ≈ dμ_π*/dν_b, the method satisfies Condition C5 (weighted Bellman projection orthogonality), ensuring projecting TQ onto F in L²(μ*) is equivalent to projecting in L²(w_F ν_b). This requirement is substantially weaker than Bellman completeness, making it more broadly applicable.

### Mechanism 3
Weight errors enter through geometrically damped accumulation, not exponential blowup. Inexact Picard iteration yields e_k ≤ ρ^k e_0 + Σ_{j<k} ρ^{k−1−j} ξ_j, where ξ_j contains weight errors raised to power 1/(1−α). This reveals a double-robust structure: the error vanishes if either density-ratio estimate is accurate or Bellman approximation error is small. The coupling Condition C11 ensures weight errors decay proportionally to the iterate error.

## Foundational Learning

- **Bellman completeness vs. realizability**
  - Why needed: The paper's guarantees require only approximate realizability (Q* ≈ Π_F Q*) plus weighted orthogonality (C5), NOT the stronger Bellman completeness (T(F) ⊆ F) required by classical FQI analyses
  - Quick check: Given a function class F, can you construct an example where F contains Q* but T(F) ⊈ F?

- **Entropy regularization and soft Bellman operators**
  - Why needed: The analysis relies on smoothness of the soft Bellman operator (replacing hard max with softmax), which enables Fréchet differentiability and local contraction arguments
  - Quick check: What happens to the second derivative bound β_loc as temperature τ → 0?

- **Density ratio estimation for off-policy correction**
  - Why needed: Practical implementation requires estimating dμ_π/dν_b from offline data, typically via DICE-family saddle-point objectives. The weights need not be exact—coarse estimates can stabilize FQI
  - Quick check: Why does sample splitting (Condition C8) matter for the statistical analysis?

## Architecture Onboarding

- **Component map:** Soft Bellman target generator -> Stationary weight estimator -> Weighted regression module -> Temperature controller (optional)
- **Critical path:** Initialize Q̂(0) (warm-start recommended); For k = 0,1,...,K−1: compute soft targets y_i from Q̂(k), estimate/update stationary weights ŵ(k)_F, solve weighted regression for Q̂(k+1); if using temperature homotopy, gradually reduce τ and repeat
- **Design tradeoffs:** Continuous vs. periodic weight updates (continuous tracks policy evolution; periodic reduces computation); weight estimator complexity (coarse linear models may suffice; over-parameterized estimators add variance); initialization strategy (high-temperature start ensures larger contraction radius r₀ ≍ τ^{1/α} but requires homotopy)
- **Failure signatures:** Divergence or oscillating Q-values (likely exited local basin; check initialization or reduce temperature); slow convergence despite correct weights (may have high misspecification ε_F; check realizability); instability during temperature annealing (homotopy step too large; reduce τ decrement size)
- **First 3 experiments:** 1) Tabular validation: Implement SW-FQI on a small Garnet MDP with known Q*. Plot ∥Q̂(k) − Q*_τ∥_{2,μ*}² vs. iteration for weighted vs. unweighted versions. 2) Basin sensitivity: Starting from random initializations at varying distances from Q*_F, characterize the maximum initialization error that still yields convergence. 3) Weight error robustness: Inject controlled noise into weight estimates (ε_wt(k) = η_k with varying η). Measure convergence rate degradation and compare to predicted ρ_eff,wt bound.

## Open Questions the Paper Calls Out

- **Global convergence extension:** Can the local convergence guarantees for stationary-reweighted soft FQI be extended to global convergence? The proof relies on contraction only within a specific neighborhood, leaving behavior outside this region theoretically uncharacterized. Evidence would require either a proof showing convergence from arbitrary initializations or a counterexample demonstrating divergence when initialized outside the local basin.

- **Initialization strategies:** How can reliable initialization strategies be designed to ensure the algorithm enters the local contraction region? The theorems require initialization within a specific radius r_max of the fixed point, but there is currently no general method to guarantee an arbitrary initialization satisfies this condition. Evidence would require an algorithm that provably constructs an initial estimate within the basin of attraction.

- **Hard-max and infinite-action limits:** Can the convergence guarantees be extended to the hard-max limit (τ ↓ 0) or the infinite-action limit? The local contraction radius shrinks and eventually collapses as temperature decreases or action space grows, breaking the fundamental geometric properties required for the current proof. Evidence would require either a modified analysis showing convergence persists as τ → 0 or a counterexample showing instability in these limits.

## Limitations

- Theoretical basin of attraction r_max depends on Hölder-type bounds that may be loose in practice; empirical characterization of basin boundaries is missing
- Weight estimation errors are assumed to couple with Bellman approximation error, but the κ exponent's sensitivity to function class misspecification is not quantified
- Temperature homotopy is proposed as a global convergence fix, but the schedule design and its effect on contraction rate are left open

## Confidence

- **High confidence:** Local contraction of the soft Bellman operator in L²(μ*) — supported by Lemma 1 and explicit linearization analysis
- **Medium confidence:** Stationary reweighting restores contraction — orthogonality condition C5 is plausible but lacks empirical validation on non-tabular domains
- **Low confidence:** Geometric damping of weight errors — the coupling Condition C11 and resulting double-robust structure are theoretically derived but not experimentally tested

## Next Checks

1. **Basin boundary mapping:** Implement SW-FQI on a Garnet MDP and systematically vary initialization distance from Q*_F. Measure the maximum initial error that still converges and compare against the theoretical r_max.

2. **Weight noise sensitivity:** Inject controlled noise into density-ratio estimates across a grid of ε_wt magnitudes. Measure convergence rate degradation and check if the observed slowdown matches the predicted ρ_eff,wt formula.

3. **Homotopy schedule ablation:** Implement temperature annealing with different τ decrements. Quantify how schedule aggressiveness affects both convergence speed and final error floor.