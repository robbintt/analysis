---
ver: rpa2
title: 'GRASP: Graph Reasoning Agents for Systems Pharmacology with Human-in-the-Loop'
arxiv_id: '2512.05502'
source_url: https://arxiv.org/abs/2512.05502
tags:
- biological
- grasp
- code
- graph
- while
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: GRASP is a multi-agent, graph-based framework for automated Quantitative
  Systems Pharmacology (QSP) model development. It encodes biological mechanisms as
  typed knowledge graphs and compiles them to executable MATLAB/SimBiology code while
  preserving units, mass balance, and physiological constraints.
---

# GRASP: Graph Reasoning Agents for Systems Pharmacology with Human-in-the-Loop

## Quick Facts
- **arXiv ID**: 2512.05502
- **Source URL**: https://arxiv.org/abs/2512.05502
- **Reference count**: 35
- **Primary result**: Graph-based multi-agent framework automating QSP model development with BFS parameter alignment (F1=0.95) and 89% physiological parameter extraction success

## Executive Summary
GRASP introduces a multi-agent, graph-based framework for automated Quantitative Systems Pharmacology (QSP) model development that preserves biological constraints while enabling natural language modifications. The system encodes biological mechanisms as typed knowledge graphs and compiles them to executable MATLAB/SimBiology code, achieving superior performance compared to SME-guided baselines with scores of 9-10/10 versus 5-7/10 across biological plausibility, mathematical correctness, structural fidelity, and code quality. The framework operates through two phases—Understanding (legacy code reconstruction) and Action (natural language-driven modification)—with iterative validation and BFS-based parameter alignment to maintain mass balance and physiological constraints.

## Method Summary
GRASP employs a four-agent architecture orchestrated by LangGraph state machine, using GPT-4o to parse legacy MATLAB/SimBiology code into typed knowledge graphs, reason about biological mechanisms, generate executable code, and validate constraint preservation. The system uses BFS parameter alignment (capped at three hops) to discover dependent parameters during modifications, achieving F1=0.95 for dependency discovery. Physiological parameter extraction succeeds in 89% of cases versus 34% for baselines. The framework operates in two phases: Understanding (parse legacy code, regenerate, validate equivalence) and Action (natural language modifications with iterative validation up to 10 iterations per phase).

## Key Results
- BFS parameter alignment achieves F1 = 0.95 for dependency discovery in QSP model modifications
- Physiological parameter extraction succeeds in 89% of cases versus 34% for baseline approaches
- GRASP scores 9-10/10 versus SME baseline 5-7/10 across biological plausibility, mathematical correctness, structural fidelity, and code quality

## Why This Works (Mechanism)
GRASP's effectiveness stems from its graph-based representation of biological mechanisms, which preserves structural relationships and constraints during code generation. The multi-agent architecture separates concerns: Knowledge Graph Agent handles parsing and schema validation, Reasoning Agent manages biological context, Code Generation Agent produces executable MATLAB/SimBiology, and Validation Agent ensures constraint preservation. BFS parameter alignment efficiently discovers dependent parameters within three hops, while iterative validation cycles provide feedback-driven correction. The system's ability to maintain units, mass balance, and physiological constraints while enabling natural language modifications bridges the gap between human expertise and automated code generation.

## Foundational Learning
- **Typed Knowledge Graphs**: Structured representation of biological entities (compartments, species, parameters) and their relationships (transport, binding, regulation) with stoichiometry and units. *Why needed*: Preserves biological context and constraints during automated code generation. *Quick check*: Verify graph contains all entities and edges from legacy code with correct typing.
- **BFS Parameter Alignment**: Breadth-first search traversal (capped at three hops) to discover dependent parameters when modifying QSP models. *Why needed*: Efficiently identifies all parameters affected by modifications while limiting computational complexity. *Quick check*: Confirm all true dependencies are discovered within three-hop traversal on test models.
- **Iterative Validation**: Up to 10 validation cycles with feedback loops between topology/syntax checks and code generation. *Why needed*: Ensures constraint preservation through local repair mechanisms until convergence. *Quick check*: Verify validation iterations converge within 10 cycles on modified models.
- **LangGraph State Machine**: Orchestration framework managing QSPState tracking across agents with role separation. *Why needed*: Coordinates multi-agent workflow while maintaining context and preventing state inconsistencies. *Quick check*: Trace state transitions through Understanding and Action phases on sample models.
- **Physiological Priors**: Curated knowledge base with unit templates and range constraints for human physiological parameters. *Why needed*: Ensures generated parameters fall within biologically plausible ranges. *Quick check*: Validate parameter ranges against established physiological literature.

## Architecture Onboarding

**Component Map**: Natural Language Input -> Action Agent -> BFS Alignment -> Code Generation -> Validation Agent -> Feedback Loop -> Executable Code

**Critical Path**: Understanding Phase (Parse Legacy Code -> Knowledge Graph Construction -> Code Regeneration -> Topology Validation) → Action Phase (Natural Language Modification -> BFS Parameter Discovery -> Code Generation -> Constraint Validation → Iterative Feedback)

**Design Tradeoffs**: Three-hop BFS traversal balances computational efficiency against completeness of parameter discovery; iterative validation (10 iterations) trades computational cost for constraint preservation accuracy; role-separated agents improve modularity but require complex state management.

**Failure Signatures**: Mass-balance violations indicate incomplete parameter alignment; validation loop non-convergence suggests systematic constraint violations or incompatible modification requests; unit mismatches reveal schema validation failures; structural fidelity degradation indicates Knowledge Graph parsing errors.

**First Experiments**: 1) Parse simple MATLAB compartmental model into knowledge graph and verify entity/edge completeness; 2) Perform BFS parameter alignment on a modified model and measure dependency discovery recall; 3) Execute iterative validation cycle on a modified model and verify constraint preservation.

## Open Questions the Paper Calls Out
- **Generalization to non-human models**: How does GRASP perform on preclinical models (mouse, rat, non-human primate) given human-centric physiological parameter curation?
- **Formal verification integration**: Can constraint preservation be formally verified rather than relying on iterative validation cycles?
- **BFS traversal depth sufficiency**: Is three-hop BFS traversal sufficient for highly interconnected biological networks with long dependency chains?
- **LLM backend robustness**: How does GRASP's performance vary across different LLM backends beyond GPT-4o?

## Limitations
- Agent prompt templates are only described at high level without concrete examples, requiring substantial reverse-engineering for reproduction
- BFS parameter alignment capped at three hops lacks empirical justification for complex multi-pathway signaling cascades
- Physiological parameter ranges are human-centric, limiting generalization to preclinical models without species-specific curation

## Confidence
- **High**: Architectural framework (four-agent LangGraph orchestration, two-phase workflow) and problem definition are clearly specified
- **Medium**: BFS alignment performance metrics (F1=0.95, 89% success) are reported but lack detailed validation methodology
- **Low**: Agent-specific implementations (prompt templates, parsing logic, validation rules) are underspecified, requiring significant reverse-engineering

## Next Checks
1. Request and test complete agent prompt templates with a simple MATLAB model to verify parsing and code generation fidelity
2. Implement and validate BFS parameter alignment algorithm on synthetic QSP model with known dependencies to confirm F1=0.95
3. Conduct independent LLM-as-judge evaluation using 10-point rubric on held-out QSP model to assess scoring consistency and reliability