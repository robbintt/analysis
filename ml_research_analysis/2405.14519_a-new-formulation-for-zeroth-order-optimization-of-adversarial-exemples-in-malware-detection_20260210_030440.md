---
ver: rpa2
title: A New Formulation for Zeroth-Order Optimization of Adversarial EXEmples in
  Malware Detection
arxiv_id: '2405.14519'
source_url: https://arxiv.org/abs/2405.14519
tags:
- algorithm
- zexe
- malware
- optimization
- adversarial
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a novel formulation for adversarial example
  generation in Windows malware detection, casting the problem within a zeroth-order
  optimization framework. The key contribution is ZEXE, a gradient-free algorithm
  that incorporates functionality-preserving manipulations through an initialization
  and rewriting strategy.
---

# A New Formulation for Zeroth-Order Optimization of Adversarial EXEmples in Malware Detection

## Quick Facts
- arXiv ID: 2405.14519
- Source URL: https://arxiv.org/abs/2405.14519
- Reference count: 40
- Primary result: ZEXE achieves higher evasion rates (60.9% vs 58% for MalConv, 37% vs 20% for GBDT-EMBER) while reducing injected content by more than half

## Executive Summary
This paper introduces ZEXE, a novel gradient-free algorithm for generating adversarial examples in Windows malware detection. The approach frames adversarial example generation as a zeroth-order optimization problem, enabling the creation of functionality-preserving manipulations through an initialization and rewriting strategy. Unlike previous content-injection attacks, ZEXE provides theoretical guarantees and requires minimal hyperparameter tuning while achieving superior evasion rates with significantly reduced injected content.

## Method Summary
ZEXE employs structured finite differences with adaptive stepsize selection and exploration strategies to optimize adversarial examples without gradient information. The algorithm incorporates functionality-preserving manipulations through a specialized initialization and rewriting strategy, ensuring that generated adversarial examples maintain their malicious functionality. By avoiding explicit gradient computation, ZEXE addresses the challenges of non-differentiable malware detection models while providing convergence guarantees in non-convex, non-smooth settings.

## Key Results
- ZEXE achieved 60.9% evasion rate against MalConv compared to GAMMA's 58%
- Against GBDT-EMBER, ZEXE reached 37% evasion versus GAMMA's 20%
- ZEXE reduced injected content to 211KB (versus 881KB for GAMMA on MalConv) and achieved one-third reduction on GBDT-EMBER

## Why This Works (Mechanism)
ZEXE works by leveraging zeroth-order optimization techniques to navigate the discrete, non-differentiable search space of malware modifications without requiring gradient information. The algorithm uses structured finite differences to estimate directional derivatives while maintaining functionality through initialization and rewriting strategies. The adaptive stepsize selection and exploration mechanisms enable efficient traversal of the solution space, achieving higher evasion rates while minimizing content injection.

## Foundational Learning
- Zeroth-order optimization: Optimization techniques that do not require gradient information; needed because malware detection models are typically non-differentiable; quick check: verify gradient-free methods can navigate discrete search spaces effectively
- Functionality preservation: Techniques ensuring malicious code maintains operational capabilities after modification; needed to create realistic adversarial examples; quick check: confirm injected content doesn't break malware functionality through testing
- Structured finite differences: Method for estimating gradients using function evaluations at perturbed points; needed to approximate directional derivatives without explicit gradients; quick check: validate finite difference accuracy against known gradients where possible
- Non-convex optimization: Optimization over objective functions with multiple local minima; needed because malware detection landscapes are complex and non-convex; quick check: test convergence to local minima across different initializations
- Adaptive stepsize selection: Dynamic adjustment of optimization step sizes; needed to balance exploration and exploitation in the search space; quick check: monitor convergence speed with different step size adaptation strategies

## Architecture Onboarding
Component map: Initialization -> Rewriting Strategy -> Zeroth-Order Optimization -> Adaptive Stepsize -> Evaluation
Critical path: The optimization loop proceeds from initialization through rewriting, applying structured finite differences with adaptive stepsize selection, evaluating against the target detector, and updating based on evasion success.
Design tradeoffs: ZEXE prioritizes functionality preservation over minimal content injection, sacrificing some attack efficiency for realistic adversarial examples. The gradient-free approach trades computational efficiency for applicability to non-differentiable models.
Failure signatures: Common failure modes include inability to maintain malware functionality after injection, getting trapped in local minima of the non-convex optimization landscape, and adaptive stepsize selection causing oscillation or slow convergence.
First experiments: 1) Test ZEXE on simple differentiable functions to validate optimization mechanics, 2) Evaluate functionality preservation rates on unmodified malware samples, 3) Benchmark convergence speed against gradient-based methods on convex problems

## Open Questions the Paper Calls Out
None identified in the provided content.

## Limitations
- Evaluation limited to Windows PE malware and two specific detection models, restricting generalizability
- Theoretical convergence analysis based on assumptions that may not fully capture real-world adversarial dynamics
- Does not address transferability of attacks across different models or impact on detection in operational environments

## Confidence
- High confidence in reported evasion rates for specific experimental setup
- Medium confidence in broader claims about ZEXE's superiority over content-injection methods
- Medium confidence in minimal hyperparameter tuning claim due to limited validation across diverse scenarios

## Next Checks
1. Evaluate ZEXE against a broader range of malware detection models, including those using different feature representations or architectures, to assess generalizability
2. Test the transferability of ZEXE-generated adversarial examples across models to determine their robustness in multi-model environments
3. Conduct experiments in dynamic, operational settings to measure the real-world effectiveness of ZEXE and its impact on detection systems under varying conditions