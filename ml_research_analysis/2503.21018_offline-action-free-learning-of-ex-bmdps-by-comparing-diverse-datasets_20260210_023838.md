---
ver: rpa2
title: Offline Action-Free Learning of Ex-BMDPs by Comparing Diverse Datasets
arxiv_id: '2503.21018'
source_url: https://arxiv.org/abs/2503.21018
tags:
- pred
- then
- latent
- learning
- state
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses action-free representation learning in Exogenous
  Block Markov Decision Processes (Ex-BMDPs), where observations contain both controllable
  latent states and temporally-correlated noise features. Prior work showed this is
  theoretically impossible without action labels, but this paper demonstrates that
  with offline video data from multiple agents with different policies, the problem
  becomes tractable.
---

# Offline Action-Free Learning of Ex-BMDPs by Comparing Diverse Datasets

## Quick Facts
- **arXiv ID**: 2503.21018
- **Source URL**: https://arxiv.org/abs/2503.21018
- **Reference count**: 40
- **Key outcome**: CRAFT algorithm learns action-free representations from diverse datasets by clustering sequential observation pairs, achieving 86.4-97.7% encoder accuracy in toy environments

## Executive Summary
This paper addresses the challenge of learning representations in Exogenous Block Markov Decision Processes (Ex-BMDPs) without action labels, which prior work proved theoretically impossible. The key insight is that diverse offline video data from multiple agents with different policies provides sufficient signal to overcome this impossibility. By leveraging differences in controllable feature dynamics across agents, the proposed CRAFT algorithm can learn representations that separate controllable latent states from temporally-correlated noise features.

The approach works by clustering sequential observation pairs based on which agent likely observed them, then recursively identifying and merging latent states. Theoretical analysis provides sample-complexity bounds that depend only on controllable latent state sizes, not on the potentially infinite exogenous noise space. Experiments on a toy environment demonstrate significant improvements over baseline approaches that try to predict agent identity from single or paired observations.

## Method Summary
The CRAFT algorithm addresses action-free representation learning in Ex-BMDPs by exploiting diversity across multiple agents' datasets. It operates in two main phases: first, clustering sequential observation pairs to identify regions where controllable features behave differently across agents; second, recursively merging these clusters to identify latent states. The method assumes access to offline video data from multiple agents with distinct policies, leveraging the fact that different policies create different controllable feature dynamics even when exogenous noise is present. The theoretical framework provides sample-complexity bounds that depend only on controllable state space size, making it theoretically efficient regardless of exogenous noise complexity.

## Key Results
- CRAFT achieves 86.4-97.7% encoder accuracy on toy environments with 500-5000 trajectories per agent
- Outperforms baseline approaches that predict agent identity from single observations or paired observations
- Sample complexity bounds depend only on controllable latent state sizes, not exogenous noise space size
- Theoretical analysis proves the method is tractable with diverse datasets despite prior impossibility results

## Why This Works (Mechanism)
The algorithm exploits the fundamental insight that different agents' policies create distinct controllable feature dynamics, even in the presence of temporally-correlated exogenous noise. By clustering sequential observation pairs based on which agent likely observed them, CRAFT identifies regions where controllable features behave differently. The recursive merging process then groups these regions into latent states, effectively separating controllable from exogenous features without requiring action labels.

## Foundational Learning
- **Exogenous Block MDPs**: MDPs with controllable latent states and temporally-correlated noise features; needed to understand the problem setting where observations mix controllable and uncontrollable components
- **Sample Complexity Bounds**: Theoretical guarantees on the number of samples needed for accurate representation learning; needed to ensure the method scales efficiently regardless of exogenous noise complexity
- **Clustering Sequential Pairs**: Technique for grouping observation transitions based on agent identity likelihood; needed to identify regions where controllable features behave differently across agents
- **Recursive State Merging**: Process of progressively grouping similar latent states; needed to build the final representation from initial cluster assignments

## Architecture Onboarding

**Component Map**: Data Collection -> CRAFT Algorithm -> Clustering Phase -> Recursive Merging Phase -> Latent State Representation

**Critical Path**: The algorithm requires diverse datasets from multiple agents, then performs clustering of sequential observation pairs followed by recursive state merging to produce the final representation

**Design Tradeoffs**: The method trades computational complexity in the clustering and merging phases for the ability to learn without action labels; the recursive approach could become intractable with many latent states

**Failure Signatures**: Poor clustering performance indicates insufficient diversity in agent policies; failure to merge states correctly suggests overlapping controllable feature dynamics across agents

**3 First Experiments**:
1. Test CRAFT on a simple Ex-BMDP with known ground truth to verify basic functionality
2. Evaluate clustering accuracy when adding agents with increasingly similar policies
3. Measure sample complexity scaling as the number of controllable latent states increases

## Open Questions the Paper Calls Out
None provided in the source material.

## Limitations
- Scalability to high-dimensional video data remains unproven
- Performance under partial coverage assumptions (where some controllable states are rarely visited) is unclear
- Dependence on multiple agents with distinct policies may limit applicability in scenarios with limited behavioral diversity

## Confidence

**High**: Theoretical impossibility results without action labels, sample complexity bounds, and clustering-based state identification framework

**Medium**: Empirical results on toy environments showing significant improvement over baselines

**Low**: Claims about practical applicability to real-world video datasets and scalability to complex environments

## Next Checks

1. Test CRAFT on high-dimensional image-based environments (e.g., Atari games or robotic control tasks) to assess scalability beyond toy problems
2. Evaluate performance under partial coverage conditions where some controllable states are rarely visited across agents
3. Compare CRAFT against state-of-the-art action-free representation learning methods on standard offline RL benchmarks