---
ver: rpa2
title: Cortex-Grounded Diffusion Models for Brain Image Generation
arxiv_id: '2601.19498'
source_url: https://arxiv.org/abs/2601.19498
tags:
- cortical
- image
- cor2vox
- brain
- shape
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses the challenge of generating anatomically plausible
  brain MRIs with fine-grained cortical control, a critical need for synthetic data
  in neuroimaging. Existing generative models rely on weak conditioning (labels, text)
  and fail to preserve cortical morphology, leading to implausible anatomies.
---

# Cortex-Grounded Diffusion Models for Brain Image Generation

## Quick Facts
- **arXiv ID:** 2601.19498
- **Source URL:** https://arxiv.org/abs/2601.19498
- **Reference count:** 40
- **Primary result:** Introduces Cor2Vox, a cortex-grounded generative model using Brownian bridge diffusion and signed distance fields for anatomically plausible 3D brain MRI synthesis with fine-grained cortical control

## Executive Summary
Cortex-Grounded Diffusion Models for Brain Image Generation introduces Cor2Vox, a novel generative framework that addresses the critical need for anatomically plausible synthetic brain MRIs with fine-grained cortical control. Unlike existing models that rely on weak conditioning (labels, text) and fail to preserve cortical morphology, Cor2Vox ties image generation directly to continuous structural priors of the cerebral cortex using signed distance fields (SDFs). The method employs a Brownian bridge diffusion process that maps from cortical geometry to image space, guided by auxiliary shape conditions including pial/white matter SDFs, edges, and cortical ribbon masks. Built on a large-scale statistical shape model derived from over 33,000 UK Biobank scans, Cor2Vox demonstrates superior geometric consistency (ASSD: ~0.28 mm for WM/pial surfaces) and whole-brain image fidelity (SSIM: ~0.91) compared to baseline methods. The framework enables anatomically consistent synthesis, sub-voxel cortical atrophy simulation, and cross-dataset harmonization without retraining.

## Method Summary
Cor2Vox introduces a cortex-grounded generative framework that leverages signed distance fields (SDFs) of cerebral cortex surfaces to guide 3D brain MRI synthesis. The method employs a Brownian bridge diffusion process that maps directly from cortex SDFs to output images, unlike conventional DDPMs that map from images to Gaussian noise. During the reverse diffusion process, the model receives auxiliary geometric representations (individual surface SDFs, edge maps, cortical ribbon masks) as conditioning inputs at every step. A large-scale statistical shape model of cortical morphology, derived from 33,000+ UK Biobank scans, enables anatomically plausible sampling through spherical interpolation in latent space. The 3D UNet-based denoising network operates on voxelized SDFs at 128³ resolution, producing high-quality brain MRIs with preserved cortical morphology. The framework supports controllable generation including sub-voxel cortical atrophy simulation and cross-dataset harmonization without retraining.

## Key Results
- Outperforms baseline methods (Pix2Pix, BBDM, Med-DDPM) in geometric consistency with ASSD of ~0.28 mm for WM/pial surfaces
- Achieves superior whole-brain image fidelity with SSIM of ~0.91 compared to baseline models
- Successfully validates anatomically plausible synthesis through cortical surface reconstruction and automatic segmentation
- Enables sub-voxel cortical atrophy simulation with mean error of ~0.14 mm
- Demonstrates cross-dataset harmonization capability without requiring retraining

## Why This Works (Mechanism)

### Mechanism 1: Brownian Bridge for Structure-to-Image Mapping
The Brownian Bridge diffusion process provides superior anatomical fidelity by establishing a fixed endpoint at the shape prior rather than Gaussian noise. The forward process analytically traverses from the MRI volume to the cortex SDF, while the reverse process generates the image starting directly from this known structural endpoint. This constrains the generative path to adhere to the geometry defined by the SDF, ensuring topologically faithful synthesis. The variance schedule peaks at the midpoint $t=T/2$ and reaches zero at the final timestep $t=T$, guaranteeing convergence exactly to the conditional shape $S_c$. If the SDF representation loses sub-voxel geometric details during rasterization, the bridge process will map to a smoothed or aliased shape, resulting in loss of fine sulcal details.

### Mechanism 2: Auxiliary Multi-Channel Shape Guidance
Geometric consistency is significantly improved by concatenating auxiliary geometric representations (individual surface SDFs, edge maps, masks) as conditioning inputs during reverse diffusion steps. While the primary bridge target is the fused cortex SDF ($S_c$), the denoising network receives explicit auxiliary tensors ($S_p, S_w, E, R$) at every step. This reinforces boundary definitions and regional masks, acting as a structural residual guide. The 3D UNet can effectively disentangle and utilize redundant geometric information from multiple channels to resolve ambiguities in intensity-to-boundary mapping. If auxiliary inputs are misaligned or resampled differently from the primary SDF, conflicting gradients could induce artifacts or double boundaries in the synthesized MRI.

### Mechanism 3: Spherical Interpolation for Manifold Integrity
Generating novel, anatomically plausible cortical shapes requires traversing the PCA latent space via spherical interpolation (slerp) rather than linear interpolation to avoid "mean drift" (over-smoothing). Linear interpolation in high-dimensional latent spaces tends to pass through the center of the distribution (the mean), resulting in implausibly smooth brains. Spherical interpolation traverses the manifold surface, preserving the high-frequency folding patterns (gyrification) of source subjects. The latent space of the PCA shape model approximates a hypersphere where realistic anatomies lie on the surface, not the interior. If the PCA variance threshold is set too low (fewer components), the latent space will lack dimensions necessary to represent fine sulcal patterns, causing slerp to generate blurry or averaged anatomies regardless of path.

## Foundational Learning

- **Concept: Signed Distance Fields (SDFs)**
  - **Why needed here:** SDFs bridge the mesh-based surface domain and voxel-based image domain, essential for preprocessing.
  - **Quick check question:** How does the value of $S_c$ change as you move from the white matter surface, through the cortical ribbon, to the pial surface? (Answer: Negative inside WM, zero in ribbon, positive outside/inside specific regions based on fusion logic).

- **Concept: Brownian Bridge Diffusion**
  - **Why needed here:** Unlike standard diffusion which goes Image → Noise, this goes Image → Shape with a variance schedule that is not monotonic.
  - **Quick check question:** In a Brownian Bridge, what is the value of the variance $\delta_t$ at the final timestep $t=T$? (Answer: Zero, ensuring the process converges exactly to the conditional shape $S_c$).

- **Concept: Population Shape Modeling (PCA)**
  - **Why needed here:** Generative capability for "unseen" anatomies relies entirely on the quality of the PCA model built from UK Biobank data.
  - **Quick check question:** Why is vertex correspondence required before fitting the PCA model? (Answer: To ensure that "Vertex N" on one brain corresponds anatomically to "Vertex N" on another, allowing meaningful variance calculation).

## Architecture Onboarding

- **Component map:** Input Meshes (Pial/WM) → V2C-Flow → SDF Fusion ($S_c$) + Auxiliary Maps ($S_p, S_w, E, R$) → PCA Latent Space → Spherical Interpolation → New Mesh → 3D Residual UNet (ADM architecture) with Attention blocks → Forward Process: MRI ($x_0$) → SDF ($x_T$) → Reverse Process: SDF ($x_T$) + Aux Conditions → MRI ($x_0$)

- **Critical path:**
  1. Data Prep: Ensuring mesh-to-SDF conversion handles the "ribbon" logic correctly
  2. Training: Minimizing $L_1$ loss between predicted noise/residual and ground truth in the bridge framework
  3. Inference: Sampling latent codes → Decoding meshes → Rasterizing SDFs → Running Reverse DDIM (10 steps)

- **Design tradeoffs:**
  - Cortex SDF ($S_c$) vs. Separate SDFs: Fusing them into one field reduces channel count but requires specific logic to handle the ribbon interior; the paper fuses them but still feeds separate $S_p, S_w$ as auxiliary inputs
  - DDIM Steps: Using only 10 steps (vs 1000 training steps) prioritizes speed (1 min inference) over potential convergence quality

- **Failure signatures:**
  - "Broken Sulci": If the UNet ignores edge maps ($E$), generated images will show topological errors (discontinuous grooves)
  - Smooth Atrophy: If atrophy simulation fails, the generated MRI will not reflect the sub-voxel thickness changes introduced in the input mesh
  - Ringing Artifacts: Potential aliasing if SDF rasterization resolution does not match the internal 128³ resolution

- **First 3 experiments:**
  1. Geometry Ablation: Run inference using only the cortex SDF ($S_c$) vs. ($S_c$ + Auxiliary Maps) on a held-out ADNI scan to reproduce the ASSD gap (Table 1)
  2. Interpolation Check: Generate a sequence of brains by varying $\phi \in (0,1)$ using linear vs. spherical interpolation; visualize cortical thickness maps to confirm slerp preserves variance better
  3. Atrophy Recovery: Introduce a known 0.5mm atrophy to a surface, generate the MRI, and run a thickness estimator (like V2C-Flow) to see if the estimated thickness matches the input

## Open Questions the Paper Calls Out
None

## Limitations
- Reliance on a fixed anatomical shape model (33k UK Biobank brains) may constrain generalization to populations with substantially different cortical morphologies
- Cross-dataset harmonization has only been validated on ADNI vs. UK Biobank, requiring wider population testing
- The specific contribution of each auxiliary channel (S_p, S_w, E, R) is not isolated in ablation studies

## Confidence
- **High** confidence in the Brownian Bridge mechanism given the clear analytical distinction from standard DDPM and the ablation evidence in Table 1
- **Medium-High** confidence in the spherical interpolation claim based on visual evidence in Figure S3, though quantitative metrics comparing linear vs. spherical paths would strengthen this
- **Medium** confidence in the auxiliary guidance contribution because while the ablation shows benefit, the specific contribution of each auxiliary channel is not isolated

## Next Checks
1. **Morphological generalization test:** Generate brains from cortical meshes of pediatric subjects or patients with lissencephaly; quantify anatomical plausibility via folding complexity metrics
2. **Latent space linearity probe:** Sample pairs of latent codes with varying angular separation; measure Mahalanobis distance to training data to confirm slerp avoids mean drift across the full plausible range
3. **Multi-resolution robustness:** Downsample the input SDF to 64³ and 32³; assess whether geometric consistency (ASSD) degrades and identify the resolution threshold for acceptable fidelity