---
ver: rpa2
title: Improving constraint-based discovery with robust propagation and reliable LLM
  priors
arxiv_id: '2509.23570'
source_url: https://arxiv.org/abs/2509.23570
tags:
- causal
- mosacd
- seeds
- arxiv
- orientation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: MosaCD is a causal discovery algorithm that combines CI test results
  with LLM-based orientation seeds to overcome limitations in traditional PC-style
  methods, which rely on v-structure seeding and are vulnerable to cascading errors
  from imperfect CI tests. The key innovation is using shuffled multiple-choice queries
  to filter LLM hallucinations by exploiting positional bias, retaining only consistently
  chosen orientations as high-confidence seeds.
---

# Improving constraint-based discovery with robust propagation and reliable LLM priors

## Quick Facts
- **arXiv ID:** 2509.23570
- **Source URL:** https://arxiv.org/abs/2509.23570
- **Reference count:** 40
- **One-line primary result:** MosaCD achieves state-of-the-art F1 scores by combining robust CI propagation with LLM-based orientation seeds

## Executive Summary
MosaCD addresses limitations in traditional PC-style causal discovery by integrating constraint-based inference with LLM-generated orientation priors. The method uses shuffled multiple-choice queries to filter LLM hallucinations through positional bias detection, retaining only consistently chosen orientations as high-confidence seeds. MosaCD prioritizes non-collider evidence during propagation, applying a confidence-down strategy that orients the most reliable edges first, reducing error accumulation. Across 10 benchmark datasets with up to 76 nodes, MosaCD achieved state-of-the-art F1 scores, outperforming both traditional methods and LLM-based baselines.

## Method Summary
The MosaCD algorithm combines constraint-based causal discovery with LLM-based orientation seeding. It first runs PC/CPC to obtain the skeleton and separating set record, then uses shuffled multiple-choice prompts to query an LLM for edge orientations, filtering for consistent positional answers. During propagation, it prioritizes non-collider evidence (nodes appearing in all separating sets of an edge) over colliders, sorting by p-value confidence. Remaining edges are resolved using a least-conflict orientation strategy. The method is theoretically sound under ideal assumptions and demonstrates superior accuracy by improving initial seeding reliability and robust propagation.

## Key Results
- MosaCD achieves state-of-the-art F1 scores across 10 benchmark datasets with up to 76 nodes
- The method outperforms traditional PC-style approaches and LLM-only baselines
- Secondary analyses confirm robustness to uninformative variables and effectiveness of the propagation rules

## Why This Works (Mechanism)
MosaCD works by addressing two key failure modes in causal discovery: imperfect CI tests that cascade errors through v-structure seeding, and unreliable LLM outputs due to hallucinations. The shuffled-MCQ approach exploits positional bias in LLM responses to filter out inconsistent answers, creating high-confidence seeds. The confidence-down propagation strategy prioritizes the most reliable evidence (non-colliders with high p-values) before applying weaker rules, preventing error accumulation. This combination of robust initial seeding and evidence-aware propagation creates a more reliable discovery process than either constraint-based or LLM-only methods.

## Foundational Learning
- **PC algorithm basics:** Understanding how PC generates skeletons through conditional independence testing is crucial for implementing the skeleton search module
- **Meek's rules:** Knowledge of R1 and R2 rules is needed for the unsupervised propagation phase
- **Positional bias exploitation:** The shuffled-MCQ technique relies on understanding how LLMs may exhibit systematic answer position preferences
- **Constraint propagation priority:** The confidence-down strategy requires understanding how to prioritize evidence based on reliability metrics

## Architecture Onboarding
**Component Map:** Skeleton Search -> LLM Seeding -> Propagation (CI-Supervised + Unsupervised) -> Resolution
**Critical Path:** The LLM seeding phase is the bottleneck due to API costs and latency
**Design Tradeoffs:** Balance between LLM query volume (5 per edge) and seeding reliability; confidence-based propagation vs. simpler fixed-order approaches
**Failure Signatures:** High API costs indicate dense skeletons; zero seeds suggest prompt formatting issues or insufficient positional bias; poor skeleton F1 indicates CI test problems
**First Experiments:**
1. Implement skeleton search and verify basic PC performance on a simple dataset
2. Test LLM querying with shuffled options on a single edge to validate positional bias detection
3. Implement non-collider prioritization and verify correct ordering on sample triples

## Open Questions the Paper Calls Out
None

## Limitations
- LLM-based seeding requires variable descriptions that may not always be available or accurate
- The shuffled-MCQ approach assumes positional bias exists in LLM outputs, which may vary across models
- The "least-conflict orientation" resolution method lacks detailed implementation specifications

## Confidence
- **High Confidence:** Core algorithmic framework (skeleton search + LLM seeding + propagation rules)
- **Medium Confidence:** Reported F1 scores are likely achievable with proper implementation
- **Medium Confidence:** Robustness claims supported by experiments but require further validation

## Next Checks
1. Implement the "least-conflict orientation" resolution with multiple conflict-counting strategies and compare results
2. Test the positional bias detection method with different LLM models and temperature settings
3. Evaluate performance on synthetic datasets with controlled variable description quality to assess sensitivity to metadata availability