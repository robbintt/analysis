---
ver: rpa2
title: Using causal abstractions to accelerate decision-making in complex bandit problems
arxiv_id: '2509.04296'
source_url: https://arxiv.org/abs/2509.04296
tags:
- causal
- abstraction
- at-ucb
- regret
- base
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper studies the problem of accelerating decision-making
  in complex bandit problems by exploiting shared information between multi-armed
  bandit problem instances defined at different levels of abstraction. The authors
  propose AT-UCB, an algorithm that leverages causal abstraction theory to first explore
  within a cheap-to-simulate and coarse-grained CMAB instance, before employing the
  traditional upper confidence bound (UCB) algorithm on a restricted set of potentially
  optimal actions in the CMAB of interest.
---

# Using causal abstractions to accelerate decision-making in complex bandit problems

## Quick Facts
- arXiv ID: 2509.04296
- Source URL: https://arxiv.org/abs/2509.04296
- Reference count: 40
- One-line primary result: AT-UCB achieves lower cumulative regret than standard UCB by filtering sub-optimal actions using a cheap causal abstraction

## Executive Summary
This paper addresses the challenge of decision-making in complex multi-armed bandit (MAB) problems by leveraging causal abstractions. The authors propose AT-UCB, an algorithm that first explores a cheaper, abstracted version of the problem to filter out clearly sub-optimal actions, then applies standard UCB only to the remaining candidate actions in the original problem. The method reduces cumulative regret when the abstraction error is sufficiently small relative to the filtering threshold. Theoretical analysis provides regret bounds, and experiments on epidemiological simulators validate the approach.

## Method Summary
AT-UCB operates in two phases. First, it uniformly explores a coarse-grained, cheap-to-simulate abstract CMAB to estimate mean rewards and construct a candidate set of potentially optimal actions using a threshold ε. Second, it maps these abstract actions back to the original action space and runs standard UCB on this restricted set for the remaining time steps. The approach relies on causal abstraction theory to bound the error between abstract and base models, ensuring the optimal base action is not incorrectly filtered out when ε is sufficiently large.

## Key Results
- AT-UCB outperforms standard UCB in cumulative regret when ε is set appropriately relative to the abstraction error
- Theoretical regret bound scales with the number of remaining actions after filtering, rather than the full action space
- Experimental validation on epidemiological simulators with varying resolution and computational cost demonstrates effectiveness
- For sufficiently small ε, AT-UCB achieves lower regret than UCB, confirming the filtering mechanism works

## Why This Works (Mechanism)

### Mechanism 1: Abstract-to-Base Filtering via Causal Abstraction
Pre-screening interventions in a cheap, coarse-grained model can eliminate a substantial portion of sub-optimal arms before costly base-model interaction, reducing cumulative regret. AT-UCB first performs uniform exploration in an abstracted causal multi-armed bandit to estimate mean rewards, then constructs a filtered set of abstract arms that excludes clearly sub-optimal ones using threshold ε. The algorithm maps these surviving abstract arms back to base arms and runs standard UCB only on this restricted action space. The approach assumes the abstraction has sufficiently low interventional consistency and reward discrepancy error such that the optimal base arm is not incorrectly filtered out. If ε is too small or abstraction error is large, the optimal arm may be excluded, leading to constant linear regret.

### Mechanism 2: Regret Reduction via Action Set Restriction
Reducing the effective action space in the base CMAB lowers the regret bound compared to standard UCB, as regret depends on the number of remaining sub-optimal arms and their optimality gaps. By using AT-UCB, if the abstract filtering correctly eliminates many sub-optimal base arms, the remaining action set is much smaller than the original set. The regret bound for standard UCB over k arms scales with the number of sub-optimal arms, so restricting to a smaller set directly reduces cumulative regret. The pre-computation cost must be sufficiently small to not outweigh the regret reduction.

### Mechanism 3: Theoretical Guarantees via Wasserstein-Based Error Bounds
The performance and correctness of AT-UCB depend on quantifying the approximation error of the causal abstraction using metrics like 2-Wasserstein distance. The paper defines Interventional Consistency error and Reward Discrepancy error, which bound the deviation between base and abstract optimal arm means. This error term directly determines the safe threshold ε for filtering and appears in the sufficient condition for the abstract horizon. If the true abstraction error is underestimated, the guarantees no longer hold and the optimal arm may be filtered.

## Foundational Learning

- **Causal Multi-Armed Bandits (CMAB)**: The core problem setting where actions are interventions on a structural causal model and rewards are observed from the intervened system. Why needed: This is the fundamental framework the paper operates within. Quick check: How does a CMAB differ from a standard MAB? (Answer: In a CMAB, arms are structured interventions on a causal model, not i.i.d. unknown distributions.)

- **Structural Causal Models (SCM) & Interventions**: SCMs define the base and abstract environments. An intervention changes the structural equations to simulate a policy or action. Why needed: SCMs provide the formal framework for defining causal abstractions and interventions. Quick check: What is the effect of an intervention do(X=x) in an SCM? (Answer: It replaces the structural equation for X with the constant x, removing incoming arrows to X and propagating the effect downstream.)

- **Upper Confidence Bound (UCB) Algorithm**: AT-UCB uses standard UCB as its second phase. Understanding how UCB balances exploration and exploitation via confidence bounds is essential. Why needed: UCB provides the exploitation mechanism after abstract filtering. Quick check: What is the core principle behind UCB? (Answer: Optimism in the face of uncertainty. It selects the arm with the highest upper confidence bound on its mean reward.)

## Architecture Onboarding

- **Component map**: Abstract CMAB B' (cheap, coarse-grained) -> Abstraction α (state map τ, intervention map ω) -> Base CMAB B (expensive, fine-grained) -> AT-UCB Controller (Phase 1: Abstract exploration, Phase 2: Thresholding, Phase 3: Base UCB)

- **Critical path**: The intervention map ω must correctly relate actions between the two bandits. The abstract horizon n' must be large enough to get reliable estimates for thresholding. The threshold ε must be set appropriately to safely filter without excluding the optimal base arm.

- **Design tradeoffs**:
  - Abstract Horizon (n') vs. Regret: Larger n' increases abstract cost but improves filtering accuracy
  - Threshold (ε) vs. Risk: Smaller ε makes filtering more aggressive but increases risk of excluding optimal arm
  - Abstraction Fidelity vs. Cost: Higher-fidelity abstractions allow tighter ε but may be more complex to design

- **Failure signatures**:
  - Constant Linear Regret: If optimal base arm is consistently filtered out
  - High Initial Cost, Low Benefit: If n' is high but abstraction is poor, leading to little reduction in action set

- **First 3 experiments**:
  1. Implement AT-UCB on a simple toy CMAB where you can control abstraction error and compare regret against standard UCB
  2. Run AT-UCB with varying ε on the provided epidemiological simulator and plot resulting cumulative regret
  3. For fixed ε, vary the abstract horizon n' and measure both total abstract cost and final regret

## Open Questions the Paper Calls Out

### Open Question 1
Can causal graph structure be explicitly exploited to inform the exploration strategy within AT-UCB? The authors state that AT-UCB does not exploit causal information provided by the SCMs to expedite exploration, suggesting this as a direction for future work. The current algorithm relies on uniform exploration rather than utilizing the structural equations or graph topology to focus sampling.

### Open Question 2
How can the algorithm be adapted to maintain theoretical guarantees when the abstraction error ε(α) is unknown? The regret guarantee relies on setting ε = ε(α), which may be unknown, and developing algorithms robust to this lack of knowledge is non-trivial. The current theoretical upper bound relies on a hard threshold derived from the abstraction error.

### Open Question 3
Can the duration of the abstract exploration phase (n') be set adaptively without prior knowledge of the abstract optimality gaps? The current method assumes a fixed horizon based on unknown parameters, potentially leading to over or under-exploration of the cheap model. Validating the assumption requires knowledge of abstract optimality gaps which may be unrealistic.

## Limitations
- Reliance on accurate abstraction error bounds ε(α), which are difficult to estimate when models are black boxes
- Theoretical regret bound depends on a conservative sufficient condition for the abstract exploration horizon
- Empirical validation limited to a single domain (epidemiological simulators), raising questions about generalizability

## Confidence
- **High confidence**: The theoretical regret bound (Proposition 2) is sound under stated assumptions. The core mechanism of action filtering via abstraction is well-founded.
- **Medium confidence**: Empirical results show AT-UCB outperforms UCB for sufficiently small ε, but single-domain evaluation and limited sample size reduce generalizability.
- **Low confidence**: The paper does not address computational trade-offs when abstract simulation costs are high, nor does it provide guidance on selecting ω and τ when SCM structure is unknown.

## Next Checks
1. **Sensitivity analysis**: Systematically vary ε and n' across multiple problem instances to map boundary conditions where AT-UCB fails
2. **Cost-benefit quantification**: Measure abstract simulation costs relative to base costs across different abstraction fidelity levels
3. **Cross-domain testing**: Apply AT-UCB to non-epidemiological CMABs (e.g., resource allocation in traffic routing or clinical trial design) to validate generalization