---
ver: rpa2
title: 'AutoMat: Enabling Automated Crystal Structure Reconstruction from Microscopy
  via Agentic Tool Use'
arxiv_id: '2505.12650'
source_url: https://arxiv.org/abs/2505.12650
tags:
- automat
- atomic
- structure
- microscopy
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper introduces AutoMat, an end-to-end automated pipeline
  for reconstructing crystal structures from scanning transmission electron microscopy
  (STEM) images and predicting their physical properties. The method integrates four
  key components: a pattern-adaptive denoising module (MOE-DIV AESR), physics-guided
  template retrieval, symmetry-aware atomic reconstruction (STEM2CIF), and machine
  learning-based property prediction via MatterSim.'
---

# AutoMat: Enabling Automated Crystal Structure Reconstruction from Microscopy via Agentic Tool Use

## Quick Facts
- arXiv ID: 2505.12650
- Source URL: https://arxiv.org/abs/2505.12650
- Reference count: 40
- AutoMat achieves 0.11 Å RMSD and 83.2% structure success rate in automated STEM-to-CIF reconstruction

## Executive Summary
AutoMat is an end-to-end automated pipeline for reconstructing crystal structures from scanning transmission electron microscopy (STEM) images and predicting their physical properties. The method integrates four key components: a pattern-adaptive denoising module (MOE-DIV AESR), physics-guided template retrieval, symmetry-aware atomic reconstruction (STEM2CIF), and machine learning-based property prediction via MatterSim. An LLM agent orchestrates these modules, enabling closed-loop reasoning from raw STEM images to simulation-ready crystal structures. To support evaluation, the authors curate the STEM2Mat benchmark, comprising 450 monolayer structures and corresponding STEM images with DFT-calculated formation energies. AutoMat achieves a projected lattice RMSD of 0.11 Å, formation energy MAE of 321.57 meV/atom, and structure success rate of 83.2%, significantly outperforming existing multimodal large language models and domain-specific tools by an order of magnitude. These results demonstrate AutoMat's effectiveness in bridging microscopy and atomistic simulation for materials science.

## Method Summary
AutoMat is a four-stage pipeline orchestrated by a DeepSeek-V3 LLM agent for converting raw STEM images into simulation-ready crystal structures. The pipeline consists of pattern-adaptive denoising using MOE-DIV AESR (a Mixture-of-Experts network with ResNet-18 gating), physics-guided template retrieval against a simulated library, symmetry-aware atomic reconstruction via STEM2CIF (unsupervised clustering with symmetry constraints), and property prediction through MatterSim relaxation and energy calculation. The system operates on iDPC-STEM images simulated via abTEM at 0.1 Å/pixel resolution with doses ranging from 1-6×10⁴ e⁻/Å². Evaluation is performed on the STEM2Mat benchmark containing 450 monolayer structures with ground truth CIF files and DFT-calculated formation energies.

## Key Results
- Achieves projected lattice RMSD of 0.11 Å on the STEM2Mat benchmark
- Predicts formation energies with MAE of 321.57 meV/atom
- Achieves 83.2% structure success rate, outperforming VLMs by an order of magnitude

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Orchestrating external tools via an LLM agent enables accurate structure reconstruction where end-to-end vision-language models (VLMs) fail.
- **Mechanism:** A text-only LLM (DeepSeekV3) functions as a controller, delegating domain-specific tasks (denoising, physics-based retrieval, simulation) to specialized tools rather than attempting to solve the inverse problem directly from pixels.
- **Core assumption:** The error rate of the individual specialized tools is lower than the hallucination rate of general-purpose VLMs when interpreting scientific images without domain constraints.
- **Evidence anchors:**
  - [abstract] "By orchestrating external tool calls, AutoMat enables a text-only LLM to outperform vision-language models in this domain."
  - [section 4.2] "AutoMat integrates a specialized suite of intelligent tools... [for] image denoising, template matching, structure reconstruction, and property prediction."
  - [corpus] Related work (e.g., ChemCrow) establishes the validity of tool-use for chemistry, but corpus evidence for microscopy-specific reconstruction agents is weak/absent.
- **Break condition:** Failure of the LLM to correctly chain dependencies (e.g., attempting property prediction on a noisy image) or tool output formatting errors breaking the context window.

### Mechanism 2
- **Claim:** Pattern-adaptive denoising recovers atomic column information necessary for successful template retrieval.
- **Mechanism:** A Mixture-of-Experts (MoE) network (MOE-DIV AESR) dynamically selects a denoising expert based on estimated noise level and structural patterns, performing joint inpainting and super-resolution.
- **Core assumption:** The noise distribution in STEM images can be categorized into distinct patterns that specific expert networks can learn to invert.
- **Evidence anchors:**
  - [section 4.2] "A gating network dynamically selects the optimal experts based on the features of the input image... yielding sharply resolved atomic columns."
  - [section 3.2] Mentions Poisson detector noise and lens aberrations as targets for the simulation/augmentation.
  - [corpus] Weak link; corpus focuses on crystal structure prediction (CSP), not low-level image denoising mechanisms.
- **Break condition:** Noise levels exceeding the training distribution (out-of-distribution) or "over-denoising" that removes real defect signals.

### Mechanism 3
- **Claim:** Physics-guided template retrieval drastically reduces the search space for reconstruction compared to generative approaches.
- **Mechanism:** Instead of generating coordinates atom-by-atom, the system matches the enhanced image against a library of simulated projections to find a structural prior, effectively solving a retrieval problem rather than a pure generation problem.
- **Core assumption:** The ground truth structure (or a very close polymorph) exists within the pre-compiled template library (C2DB, Materials Project, etc.).
- **Evidence anchors:**
  - [section 4.2] "Retrieves candidate structures... using pixel similarity and filtered by elemental contrast patterns to produce strong structural priors."
  - [section 5.2] Error analysis confirms 39.3% of failures are due to "Template retrieval failure," implying success relies heavily on this step.
  - [corpus] CSP methods like CrystalGRW use generative walks; AutoMat differs by using a retrieval + refinement strategy.
- **Break condition:** Novel structures not in the database, or ambiguous contrast in multi-element systems (e.g., similar atomic numbers) leading to mismatched templates.

## Foundational Learning

- **Concept: iDPC-STEM & Z-Contrast**
  - **Why needed here:** The input is iDPC-STEM data. Understanding that image contrast correlates with atomic number (Z) is essential to understand why "elemental contrast patterns" allow the system to distinguish Oxygen from heavy metals.
  - **Quick check question:** Does the image brightness directly map to atomic mass in iDPC-STEM, or is it phase-based? (Answer: Phase-based, but correlates with potential/Z).

- **Concept: CIF (Crystallographic Information File)**
  - **Why needed here:** This is the standardized output format. The pipeline is specifically designed to convert pixels into this specific text-based format containing lattice vectors and atomic coordinates.
  - **Quick check question:** Can a CIF represent disorder or partial occupancy? (Answer: With difficulty; this system targets "high-confidence" ordered monolayers).

- **Concept: MLIPs (Machine Learning Interatomic Potentials)**
  - **Why needed here:** The final step uses MatterSim (an MLIP) instead of DFT. You need to know this trades quantum accuracy for speed, introducing a small inherent error floor ("Upper Bound" in Table 1).
  - **Quick check question:** Why is MatterSim used instead of DFT for the final energy evaluation? (Answer: Speed/throughput for the closed-loop pipeline).

## Architecture Onboarding

- **Component map:** Input (Noisy STEM image) -> MOE-DIV AESR (Denoising) -> Image Template Matching (Retrieval) -> STEM2CIF (Reconstruction) -> MatterSim (Prediction) -> Output (CIF + Energy)

- **Critical path:** The **Retrieval -> STEM2CIF** interface. If the template is wrong (39.3% failure rate), the subsequent CIF generation is scientifically invalid, regardless of how well the coordinates are fitted.

- **Design tradeoffs:**
  - **Retrieval vs. Generation:** The system prioritizes physical validity via database retrieval over the flexibility of generative AI. This restricts discovery to known structural families.
  - **2D Projection Ambiguity:** The system assumes a 2D monolayer. It cannot natively handle 3D bulk structures due to projection overlap.

- **Failure signatures:**
  - **Template Mismatch:** Sudden spikes in formation energy (>1 eV/atom error).
  - **Z-Confusion:** Mistaking elements with close atomic numbers (e.g., C vs O) in the CIF output (noted in Section 5.2).
  - **Projection Ambiguity:** Atoms appearing "overlapped" in the 2D projection causing poor relaxation.

- **First 3 experiments:**
  1. **Sanity Check (Tier 1):** Run the pipeline on "High Dose" unary materials to verify the RMSD is near the reported 0.11 Å.
  2. **Noise Robustness (Tier 3):** Input low-dose ternary images to observe if the MoE denoiser successfully hands off to the retrieval agent or if it fails to de-noise entirely.
  3. **Retrieval Ablation:** Provide a "hint" (ground truth template) to the STEM2CIF module to isolate the error contribution of the retrieval component vs. the coordinate fitting component.

## Open Questions the Paper Calls Out

- **Open Question 1:** Can uncertainty-aware or multi-candidate template matching significantly improve retrieval robustness and reduce the 39.3% failure rate caused by incorrect template selection?
  - Basis in paper: [explicit] The error analysis explicitly identifies "improving retrieval robustness via uncertainty-aware or multi-candidate matching" as a key direction, noting that template retrieval failure accounts for 39.3% of all errors.
  - Why unresolved: Current template matching uses single-candidate selection based on pixel similarity and elemental contrast, with no mechanism to express uncertainty or maintain multiple hypotheses when candidates appear similar.
  - What evidence would resolve it: Experiments comparing single-candidate vs. multi-candidate retrieval strategies on Tier 3 samples, measuring reduction in template mismatch errors and cascading energy prediction failures.

- **Open Question 2:** How can 3D-aware modeling overcome the loss of z-axis information inherent in 2D STEM projections, which causes 40% of downstream failures even when templates are correct?
  - Basis in paper: [explicit] The authors explicitly state that "overcoming 2D projection limits through 3D-aware modeling" is a key improvement direction, noting that atoms appearing too close in 2D leads to poor relaxation.
  - Why unresolved: Current STEM2CIF module operates on projected (x,y) coordinates only, lacking depth information to distinguish overlapping atomic columns or resolve vertical stacking.
  - What evidence would resolve it: Integration of 3D reconstruction techniques (e.g., multi-view stereo, depth-from-defocus) and demonstration of improved reconstruction accuracy on structures with z-axis complexity.

- **Open Question 3:** How can elemental disambiguation be improved for species with similar atomic numbers (e.g., C vs. O) that exhibit indistinguishable STEM contrast?
  - Basis in paper: [inferred] Error analysis reports 20.7% of downstream failures stem from elements with similar atomic numbers having "indistinguishable contrast, causing misclassification and full breakdowns in lattice fitting."
  - Why unresolved: iDPC-STEM contrast scales roughly with atomic number, making fine Z discrimination difficult without additional information sources.
  - What evidence would resolve it: Integration of complementary signals (EELS, EDX spectroscopy) or prior chemical knowledge into the reconstruction pipeline, with evaluation on binary/ternary samples containing adjacent-period elements.

- **Open Question 4:** How well does AutoMat generalize from simulated STEM images to real experimental microscopy data with unmodeled artifacts and noise sources?
  - Basis in paper: [inferred] The STEM2Mat benchmark uses simulated iDPC-STEM images from abTEM with controlled noise; no validation on actual experimental images is reported despite the stated goal of bridging microscopy and simulation.
  - Why unresolved: Simulation may not capture all experimental realities such as sample drift, probe aberrations, contamination, detector nonlinearities, or sample preparation artifacts.
  - What evidence would resolve it: Benchmarking AutoMat on a held-out set of experimentally acquired STEM images with known ground-truth structures, comparing performance metrics to simulation-based results.

## Limitations
- The method is inherently limited to 2D monolayer structures due to projection ambiguity, preventing application to bulk 3D materials
- The pipeline relies on a pre-compiled template library, restricting discovery to known structural families and potentially missing novel polymorphs
- The reproducibility of the LLM agent orchestration is uncertain due to unspecified system prompts and tool-calling logic for DeepSeek-V3

## Confidence
- **High Confidence:** The pipeline architecture (denoising → retrieval → reconstruction → prediction) is clearly specified and the reported metrics (0.11 Å RMSD, 321.57 meV/atom MAE, 83.2% success rate) are directly measurable from the STEM2Mat benchmark
- **Medium Confidence:** The claim that tool-use via LLM outperforms end-to-end VLMs is supported by the ablation in Table 1, but the comparison relies on external models not fully described in the provided text
- **Low Confidence:** The robustness of the MOE-DIV AESR denoiser to out-of-distribution noise and the exact error contribution of the retrieval module are not fully quantified due to missing implementation details

## Next Checks
1. **Implementation Fidelity:** Obtain and run the AutoMat codebase with the STEM2Mat benchmark to verify the reported RMSD and MAE on the test set. If the agent code is unavailable, manually chain the four modules and compare results.
2. **Error Attribution Analysis:** Perform an ablation study by providing ground truth template hints to the STEM2CIF module to isolate the error contribution of retrieval vs. coordinate fitting.
3. **Out-of-Distribution Robustness:** Test the MOE-DIV AESR denoiser on STEM images with noise levels or structural patterns not present in the training data to assess failure modes and generalization limits.