---
ver: rpa2
title: 'Structured Personalization: Modeling Constraints as Matroids for Data-Minimal
  LLM Agents'
arxiv_id: '2512.11907'
source_url: https://arxiv.org/abs/2512.11907
tags:
- macro-facets
- utility
- user
- matroid
- laminar
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work addresses the challenge of personalizing LLM agents while
  minimizing data disclosure, focusing on scenarios where utility gains diminish with
  added data and structural constraints limit feasible selections. The core method
  introduces a principled compilation of user knowledge graphs with logical dependencies
  into abstract macro-facets, which are then subject to hierarchical quota constraints
  modeled as a laminar matroid.
---

# Structured Personalization: Modeling Constraints as Matroids for Data-Minimal LLM Agents

## Quick Facts
- arXiv ID: 2512.11907
- Source URL: https://arxiv.org/abs/2512.11907
- Reference count: 40
- One-line primary result: Greedy algorithm achieves 0.996 average approximation ratio (min 0.911) for submodular maximization under laminar matroid constraints in data-minimal LLM personalization

## Executive Summary
This work addresses the challenge of personalizing LLM agents while minimizing data disclosure by modeling selection constraints as laminar matroids. The approach compiles user knowledge graphs with logical dependencies into abstract macro-facets using SCC condensation, enabling greedy algorithms with provable approximation guarantees. Empirical simulation demonstrates near-optimal performance (mean 0.996, min 0.911 approximation ratio) across 5,000 random instances, significantly exceeding theoretical bounds.

## Method Summary
The method transforms user knowledge graphs with dependencies into macro-facets via SCC condensation, preserving logical entailment while maintaining submodularity. These macro-facets are subject to hierarchical quota constraints modeled as a laminar matroid, enabling greedy selection with 1/2-approximation guarantees. The compilation process expands selected macro-facets back to raw facets for utility evaluation, with constraints enforced pre-closure to preserve matroid structure.

## Key Results
- Greedy selection achieved 0.996 average approximation ratio across 5,000 random instances
- Minimum observed approximation ratio was 0.911, far exceeding the theoretical 1/2 guarantee
- Highly left-skewed distribution with 5th percentile at 0.975 demonstrates consistent near-optimal performance
- Simulation used weighted set cover as canonical submodular utility function

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Compiling logical dependencies via SCC condensation preserves submodularity while making selection units closure-consistent
- Mechanism: Implication graph G is condensed into macro-facets (SCCs). Selecting a macro-facet implicitly selects its entire closure, satisfying all dependencies atomically. Expansion operator maps macro-facet selections back to raw facets for utility evaluation
- Core assumption: Utility over raw facets U is monotone and submodular (diminishing returns hold)
- Evidence anchors: Abstract mentions compilation process; Section 3 defines macro-facets as SCCs and expansion as union of closures
- Break condition: If dependencies are not transitive or implication graph contains non-SCC cycles violating closure semantics, macro-facet decomposition may not fully capture logical entailment

### Mechanism 2
- Claim: Hierarchical quota constraints over macro-facets constitute valid laminar matroid enabling greedy approximation guarantees
- Mechanism: Laminar family F with per-set quotas defines independence: S ∈ I iff |S ∩ A| ≤ q_A for all A ∈ F. Augmentation property holds because tight sets in laminar families are nested or disjoint
- Core assumption: Quotas enforced pre-closure (on chosen macro-facets SM), not post-expansion
- Evidence anchors: Abstract states hierarchical constraints form valid laminar matroid; Theorem 1 provides matroid axiom verification with augmentation proof sketch
- Break condition: If quotas enforced post-closure (counting expanded elements), structure becomes non-matroidal and guarantees do not apply

### Mechanism 3
- Claim: Greedy selection on laminar matroid achieves near-optimal utility in practice, exceeding theoretical worst-case guarantees
- Mechanism: Iteratively add macro-facet with highest marginal utility while maintaining independence via oracle. 1/2-approximation is worst-case; empirical distribution shows mean 0.996 and minimum 0.911
- Core assumption: Utility function is submodular in deployed domain; simulation used weighted set cover as canonical submodular function
- Evidence anchors: Abstract reports greedy achieved 0.996 average approximation ratio; Figure 1 shows highly left-skewed distribution with 5th percentile at 0.975
- Break condition: If real utility landscapes deviate significantly from submodularity (e.g., synergistic effects causing supermodular gains), greedy performance may degrade toward theoretical bound

## Foundational Learning

- Concept: Submodularity and diminishing returns
  - Why needed here: Entire greedy guarantee depends on U being monotone submodular; without this, 1/2-approximation does not hold
  - Quick check question: Given sets A ⊂ B and element e, does U(A ∪ {e}) - U(A) ≥ U(B ∪ {e}) - U(B) hold for your utility estimate?

- Concept: Matroids and independence axioms
  - Why needed here: Understanding why laminar constraints form matroid is essential to trust greedy will work and debug when it might not
  - Quick check question: For your constraint set, can you verify augmentation property: given two feasible sets with |A| < |B|, is there always element from B \ A that can be added to A without violating any quota?

- Concept: Strongly Connected Components and graph closure
  - Why needed here: Macro-facet construction relies on SCC condensation; incorrect SCC detection leads to incomplete dependency absorption
  - Quick check question: For your implication graph, does Tarjan's algorithm produce expected SCC partition, and does condensation DAG correctly represent inter-macro-facet dependencies?

## Architecture Onboarding

- Component map: Chronicle Store -> Implication Graph Builder -> SCC Compiler -> Constraint Registry -> Utility Evaluator -> Greedy Selector
- Critical path: 1) Build/update implication graph from chronicle, 2) Run SCC condensation to produce macro-facets, 3) Register user-defined laminar constraints and quotas, 4) Run greedy with lazy evaluation for each selection request, 5) Expand selected macro-facets to raw facets for LLM context injection
- Design tradeoffs:
  - Pre-closure vs. post-closure quotas: Pre-closure preserves matroid guarantees but may under-count expanded elements; post-closure is more intuitive but forfeits theoretical bounds
  - Modular cost on macro-facets vs. expanded set: Paper argues for modular cost on macro-facets (conceptual risk model) to retain knapsack-style guarantees; alternative creates submodular constraint problem
  - Exact utility evaluation vs. proxy: LLM-as-judge is accurate but expensive; proxy models enable lazy greedy but may introduce estimation error
- Failure signatures:
  - Greedy selects too few items: Quotas may be too tight or utility estimates near-zero; check marginal gain distribution
  - Constraint violation in production: Independence oracle not consulted on every add; ensure oracle call is mandatory, not advisory
  - Unexpected dependency expansion: Implication graph missing edges; audit G for completeness before SCC step
  - Performance degrades on larger ground sets: Lazy greedy not implemented; marginal utility recomputation becomes O(|M|²)
- First 3 experiments:
  1. Validation of submodularity assumption: On sample of real user chronicles, measure marginal utility curves to verify diminishing returns empirically
  2. SCC compiler correctness: Inject synthetic dependencies with known SCC structure; verify macro-facet partition matches expected output
  3. Greedy vs. optimal baseline: On small ground sets (|M| ≤ 15), compute optimal via brute force and compare approximation ratio distribution against simulated results

## Open Questions the Paper Calls Out

1. How does the proposed matroid-constrained greedy algorithm perform when deployed on live LLM personalization tasks rather than synthetic simulations? [explicit] The authors state in Section 6: "Key directions include empirically validating our framework on real-world tasks." Why unresolved: Paper validates framework using 5,000 random instances with synthetic "weighted set cover" utility function rather than actual LLM-generated utility or real user data. What evidence would resolve it: Empirical benchmarks measuring approximation ratio and utility retention on specific LLM tasks (e.g., personalized summarization) using real user chronicles.

2. Can the framework be extended to model complex privacy risks using non-modular cost functions? [explicit] Section 6 identifies need for "extending it to handle more complex constraints, such as non-modular cost functions to model information leakage risk." Why unresolved: Current model assumes modular cost function (additive risk) to maintain "knapsack" constraint structure required for standard submodular maximization guarantees. What evidence would resolve it: Algorithmic modification providing provable approximation guarantees for maximizing utility subject to submodular (non-modular) cost constraint.

3. How can the system handle constraints if quotas are enforced on final expanded set (post-closure) rather than selected macro-facets? [explicit] Section 6 notes, "We also leave for future work the non-matroidal regime where quotas are enforced post-closure." Why unresolved: Current theoretical guarantees rely on "pre-closure" feasibility convention; applying quotas to final set of resolved facts breaks laminar matroid structure. What evidence would resolve it: New formulation or heuristic approach maintaining near-optimal performance when feasibility determined by size of fully expanded fact set.

## Limitations
- Theoretical guarantees rely on submodularity assumption that may not hold for real LLM utility functions with synergistic interactions
- All empirical validation occurs in simulation using synthetic utility functions rather than real LLM personalization tasks
- Dependency compilation correctness depends on accurate implication graph construction and complete transitive closure capture
- Performance guarantees only hold when quotas are enforced pre-closure, not matching intuitive post-expansion enforcement

## Confidence
- High Confidence: Theoretical framework linking laminar matroids to greedy approximation guarantees is well-established in combinatorial optimization literature; SCC condensation producing closure-consistent macro-facets is mathematically sound given correct dependency graphs
- Medium Confidence: Empirical simulation methodology is clearly specified and internally consistent; however, confidence in generalizability to real-world personalization scenarios is limited without actual deployment data
- Low Confidence: Practical effectiveness for real LLM personalization depends heavily on submodularity of actual utility functions and correctness of dependency compilation in complex real-world scenarios—neither validated in paper

## Next Checks
1. Real-World Submodularity Verification: On sample of real user chronicles from actual personalization scenarios, measure marginal utility curves empirically to verify diminishing returns hold for deployed utility function
2. Dependency Compilation Validation: Construct synthetic implication graphs with known SCC structures and complex dependency patterns; verify SCC compiler produces expected macro-facet partitions and all logical dependencies correctly captured in closures
3. Greedy vs. Optimal Baseline on Real Data: For small ground sets (M ≤ 15) using real user chronicle data and utility estimation, compute optimal solutions via brute-force enumeration and compare approximation ratios to greedy algorithm