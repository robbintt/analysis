---
ver: rpa2
title: 'ProDapt: Proprioceptive Adaptation using Long-term Memory Diffusion'
arxiv_id: '2503.00193'
source_url: https://arxiv.org/abs/2503.00193
tags:
- diffusion
- keypoints
- memory
- baselines
- base
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of robotic control using only
  proprioceptive sensing, which is critical for space, military, and underwater applications
  where exteroceptive sensors may fail or be occluded. The proposed method, ProDapt,
  incorporates long-term memory into diffusion-based controllers by identifying and
  maintaining "keypoints" - essential past observations of contacts between the robot
  and the environment.
---

# ProDapt: Proprioceptive Adaptation using Long-term Memory Diffusion

## Quick Facts
- arXiv ID: 2503.00193
- Source URL: https://arxiv.org/abs/2503.00193
- Reference count: 32
- Primary result: 80% success rate in elbow navigation vs 0% for baselines with up to 50-step observation horizons

## Executive Summary
This paper addresses the challenge of robotic control using only proprioceptive sensing, critical for space, military, and underwater applications where exteroceptive sensors may fail or be occluded. The proposed method, ProDapt, incorporates long-term memory into diffusion-based controllers by identifying and maintaining "keypoints" - essential past observations of contacts between the robot and the environment. Experiments using a UR10e robotic arm in both simulation and real-world setups demonstrate that ProDapt significantly outperforms standard diffusion approaches with varying observation horizons, achieving 80% success rate in navigating complex obstacles where baselines failed completely.

## Method Summary
ProDapt uses a keypoint manager to detect contact events via force-torque threshold crossing, filter for spatial (5cm) or directional (45°) novelty, and maintain a fixed-size buffer of 10 keypoints. These keypoints encode contact position and force direction, providing the diffusion model with compressed historical context. The diffusion policy conditions on both recent observations (H_o=3) and keypoints, generating action trajectories for receding horizon control (H_p=20, H_a=10). Training uses teleoperation demonstrations in simulation with 15cm cube obstacles randomly placed.

## Key Results
- 80% success rate on elbow navigation task vs 0% for baselines with observation horizons up to 50 time steps
- Maintains low computational overhead with inference times comparable to short-horizon baselines
- Demonstrates significant improvements in task completion rates and faster convergence times compared to standard diffusion approaches

## Why This Works (Mechanism)

### Mechanism 1: Keypoint-Based Sparse Memory Encoding
Selectively storing contact events as discrete memory units enables long-horizon reasoning without proportional computational cost increase. The keypoint manager detects collisions via force-torque threshold crossing, filters for spatial novelty (d_min = 5cm) or directional novelty (θ_min = 45°), and maintains a fixed-size buffer of 10 keypoints. Each keypoint encodes contact position + force direction, providing the diffusion model with compressed historical context.

### Mechanism 2: Diffusion Model Conditioning on Variable-Length Memory
Conditioning a denoising diffusion model on fixed-dimensional keypoint representations enables the policy to react to past contacts without implicit recurrence. Keypoints are zero-padded to 10 and appended to the observation horizon input. The U-Net diffusion architecture processes this combined tensor, learning to associate specific contact patterns with appropriate navigation behaviors during training.

### Mechanism 3: Memory-Horizon Decoupling
Explicit memory via keypoints decouples the effective "remembered" duration from observation horizon H_o, avoiding the O(H_o) computational scaling of baseline approaches. ProDapt maintains H_o = 3 for recent reactivity while keypoints provide unbounded temporal context (limited only by N_kp and keypoint manager logic).

## Foundational Learning

- **Diffusion Models for Control**: Understanding how denoising processes generate action sequences conditioned on observations. *Why needed*: Explains why diffusion models generate entire trajectories rather than single actions. *Quick check*: Can you explain why diffusion models generate entire action trajectories rather than single actions, and how receding horizon control uses these trajectories?

- **Proprioceptive Sensing**: Familiarity with force-torque sensing and joint state estimation as sole information source. *Why needed*: The paper assumes familiarity with proprioceptive sensing for robotic control. *Quick check*: What proprioceptive sensors would be minimally required for a mobile robot (vs. manipulator) to detect and localize contacts?

- **Receding Horizon Control**: Understanding the decomposition of prediction horizon H_p and action horizon H_a. *Why needed*: ProDapt uses prediction horizon H_p = 20 and action horizon H_a = 10. *Quick check*: If H_a = H_p, what behavior would you expect? What happens if H_a = 1?

## Architecture Onboarding

- **Component map**: Sensors (FT sensor, joint encoders) -> Keypoint Manager (contact detection → novelty filter → ring buffer) -> Diffusion Policy (CNN U-Net) -> Controller (position control executing actions) -> Loop
- **Critical path**: Sensing → Contact detection → Keypoint update (if novel) → Diffusion inference → Action execution → Loop
- **Design tradeoffs**: N_kp (higher = more history but potential noise), d_min/θ_min (tighter = denser keypoints + potential overfitting), H_o vs N_kp balance (paper fixes H_o = 3)
- **Failure signatures**: Oscillation at obstacles (keypoint manager failing), excessive inference time (N_kp too large), goal overshoot + idling (distribution shift), infinite looping in concave regions (keypoint memory insufficient)
- **First 3 experiments**: 1) Reproduce clear/wall tasks to validate baseline diffusion, 2) Single-obstacle keypoint ablation to verify keypoint creation/usage, 3) Elbow task with keypoint visualization to test memory capacity limits

## Open Questions the Paper Calls Out
- Can memory management (keypoint selection and retention) be learned end-to-end within the diffusion network rather than using a hand-crafted keypoint manager?
- How does ProDapt compare to architectures with implicit long-term memory such as RetNet, RWKV, or Mamba?
- Can the keypoint framework generalize to 3D manipulation tasks and incorporate proprioceptive properties beyond contact locations?
- What is the relationship between training data distribution, keypoint count, and robustness to out-of-distribution obstacle configurations?

## Limitations
- Does not provide U-Net architectural details (channel dimensions, number of layers, attention mechanisms), making exact reproduction difficult
- Effectiveness of contact-based keypoint memory for non-contact-dependent tasks remains unproven
- Fixed N_kp=10 was not systematically ablated to determine optimal memory capacity

## Confidence
- High confidence: Core mechanism of using keypoints for proprioceptive memory compression, supported by strong experimental results
- Medium confidence: Diffusion model conditioning approach, as architecture is described but not fully specified
- Low confidence: Generalization to tasks requiring continuous geometric mapping or temporal reasoning beyond contact events

## Next Checks
1. **Architecture fidelity test**: Reproduce clear/wall tasks with exact U-Net specifications to validate baseline diffusion implementation before adding keypoint conditioning
2. **Keypoint manager validation**: Log and visualize keypoint creation/usage in single-obstacle scenarios to confirm manager correctly identifies and retains critical contacts
3. **Memory capacity boundary**: Systematically vary N_kp and evaluate performance on elbow task to determine minimum memory required for consistent success