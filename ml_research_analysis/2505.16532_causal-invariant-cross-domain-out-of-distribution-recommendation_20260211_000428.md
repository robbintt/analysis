---
ver: rpa2
title: Causal-Invariant Cross-Domain Out-of-Distribution Recommendation
arxiv_id: '2505.16532'
source_url: https://arxiv.org/abs/2505.16532
tags:
- causal
- user
- recommendation
- domain
- preferences
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses cross-domain out-of-distribution (OOD) recommendation,
  where distribution shifts exist both between domains (CDDS) and within the target
  domain (SDDS), causing OOD environments that degrade recommendation performance.
  The proposed CICDOR framework tackles this by learning dual-level causal structures
  to infer domain-specific and domain-shared causal-invariant user preferences, and
  by proposing an LLM-guided confounder discovery module that extracts observed confounders
  from user reviews for effective deconfounding.
---

# Causal-Invariant Cross-Domain Out-of-Distribution Recommendation

## Quick Facts
- arXiv ID: 2505.16532
- Source URL: https://arxiv.org/abs/2505.16532
- Reference count: 40
- Primary result: CICDOR framework achieves 6.28% HR@10 and 9.42% NDCG@10 improvement over SOTA baselines in cross-domain OOD recommendation

## Executive Summary
This paper addresses the challenge of cross-domain out-of-distribution (OOD) recommendation, where distribution shifts exist both between domains (CDDS) and within the target domain (SDDS). The proposed CICDOR framework tackles this by learning dual-level causal structures to infer domain-specific and domain-shared causal-invariant user preferences, and by proposing an LLM-guided confounder discovery module that extracts observed confounders from user reviews for effective deconfounding. The framework is evaluated on two real-world datasets (Douban and Amazon) under two OOD settings: user degree shift and region shift.

## Method Summary
CICDOR employs a dual-level causal structure learning approach that simultaneously identifies domain-specific and domain-shared causal relationships among user preferences. The framework incorporates an LLM-guided confounder discovery module that extracts observed confounders from user reviews using a combination of GPT-4o-mini and a confusion inference (CI) test algorithm. The causal-invariant preference learning component then leverages these discovered confounders to learn representations that remain stable across distribution shifts. The overall architecture processes user-item interactions through both cross-domain and self-domain encoders, with causal structure learning and confounder discovery integrated into the training pipeline.

## Key Results
- CICDOR outperforms the best-performing SOTA baseline with an average improvement of 6.28% in HR@10 and 9.42% in NDCG@10
- Performance degradation observed when replacing gpt-4o-mini with smaller glm-4-9b model (7.54% drop in HR@10, 6.17% in NDCG@10)
- Robust performance across both Douban and Amazon datasets under user degree shift and region shift OOD settings

## Why This Works (Mechanism)
The framework's effectiveness stems from its ability to identify and leverage causal-invariant user preferences that remain stable across distribution shifts. By explicitly modeling both domain-specific and domain-shared causal structures, CICDOR can distinguish between spurious correlations and genuine preference signals. The LLM-guided confounder discovery extracts observed confounders from user reviews, enabling effective deconfounding and reducing the impact of confounding bias on preference inference.

## Foundational Learning
- Causal inference in recommendation systems: Essential for understanding how causal relationships between user preferences and items can be leveraged for robust recommendation
- Distribution shift detection and adaptation: Critical for identifying when and how user preferences change across domains and environments
- LLM-based feature extraction: Required for understanding how large language models can be used to extract meaningful confounders from textual user reviews
- Cross-domain recommendation fundamentals: Necessary background for understanding how information can be transferred between related recommendation domains

## Architecture Onboarding

Component map: User Reviews -> LLM-guided Confounder Discovery -> Causal Structure Learning -> Dual-level Preference Encoding -> Recommendation Output

Critical path: User-Item Interactions -> Dual-level Causal Structure Learning -> Confounder Discovery -> Causal-Invariant Preference Representation -> Final Recommendation

Design tradeoffs: The framework balances the computational cost of LLM-based confounder extraction against the potential gains from more accurate deconfounding. Using smaller models reduces cost but may decrease performance.

Failure signatures: Performance degradation when using smaller LLMs (as evidenced by the glm-4-9b vs gpt-4o-mini comparison), inability to capture unobserved confounders, and limited generalizability to unseen domain types.

First experiments:
1. Ablation study removing the LLM-guided confounder discovery module to quantify its contribution
2. Evaluation on additional OOD scenarios beyond user degree and region shifts (e.g., temporal drift)
3. Sensitivity analysis testing different LLM model sizes and architectures for confounder extraction

## Open Questions the Paper Calls Out
- How can the framework be extended to model unobserved confounders that influence preferences but are not explicitly extractable from user reviews?
- Does the proposed dual-level causal structure generalize to "unseen domains" or scenarios with multiple simultaneous distribution shifts?
- How robust is the LLM-guided confounder discovery against hallucinations or extraction errors when using smaller, non-frontier models?

## Limitations
- Evaluation limited to two real-world datasets (Douban and Amazon) under specific OOD settings
- No ablation studies provided to quantify individual contributions of framework components
- Reliance on high-capability LLMs may limit scalability in resource-constrained settings

## Confidence
- Causal structure learning effectiveness: Medium confidence
- LLM-guided confounder discovery utility: Medium confidence
- Cross-domain OOD robustness: High confidence

## Next Checks
1. Conduct comprehensive ablation studies to isolate the contributions of dual-level causal structures versus LLM-guided confounder discovery
2. Test CICDOR on additional OOD scenarios beyond user degree and region shifts (e.g., temporal drift, concept drift)
3. Perform sensitivity analysis on the LLM component to understand its impact across different domains and languages