---
ver: rpa2
title: 'SETA: Statistical Fault Attribution for Compound AI Systems'
arxiv_id: '2601.19337'
source_url: https://arxiv.org/abs/2601.19337
tags:
- system
- metamorphic
- each
- systems
- framework
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces SETA, a statistical fault attribution framework
  for compound AI systems that integrates metamorphic testing with execution trace
  analysis to localize faults in multi-component neural network pipelines. By defining
  oracle-free behavioral specifications via metamorphic relations and analyzing dynamic
  execution graphs, SETA attributes system-level failures to specific components through
  statistical correlation of component deviations with end-to-end failures.
---

# SETA: Statistical Fault Attribution for Compound AI Systems

## Quick Facts
- arXiv ID: 2601.19337
- Source URL: https://arxiv.org/abs/2601.19337
- Authors: Sayak Chowdhury; Meenakshi D'Souza
- Reference count: 40
- This paper introduces SETA, a statistical fault attribution framework for compound AI systems that integrates metamorphic testing with execution trace analysis to localize faults in multi-component neural network pipelines.

## Executive Summary
SETA addresses the challenge of fault attribution in complex compound AI systems by combining metamorphic testing with execution trace analysis. The framework provides oracle-free behavioral specifications through metamorphic relations and uses statistical correlation to attribute system-level failures to specific components. Applied to a real-world autonomous rail inspection system, SETA demonstrated effectiveness in pinpointing failure origins beyond conventional end-to-end metrics. The method is architecture and modality agnostic, though it provides correlational rather than causal attribution.

## Method Summary
SETA constructs execution trace trees capturing dynamic component activations during inference, then applies metamorphic relations as oracle-free specifications. For each perturbed input, the framework computes composite scores per module and aggregates deviations to calculate attribution scores. The approach requires instrumenting modules to log inputs/outputs and routing decisions, applying perturbations from a defined set, evaluating metamorphic relations, and computing failure contributions. Attribution scores (α_i) are normalized from conditional deviation frequencies, providing quantitative measures of component influence on system failures.

## Key Results
- SETA successfully identified vulnerable components in a real-world autonomous rail inspection system
- Attribution scores (α) reflected component influence on system failures with statistical correlation
- The framework demonstrated effectiveness beyond conventional end-to-end metrics for fault localization
- Method is architecture and modality agnostic, extensible to vision and text-based systems

## Why This Works (Mechanism)

### Mechanism 1
Metamorphic relations provide scalable, oracle-free behavioral specifications for black-box neural components. Define predicates M(x, x̃, f(x), f(x̃)) that must hold between source input x and transformed input x̃ = g(x). Composite scores S_i(x, x̃) = ∏M_{i,j}(x, x̃) aggregate multiple relations via logical conjunction—score is 1 only if all relations hold. Core assumption: Violations of metamorphic relations correlate with genuine faults rather than benign variability.

### Mechanism 2
Execution trace trees capture dynamic component activations and enable alignment between reference and perturbed runs. Model system as state-transition tuple S = (Q, I, Φ, F, R, S). During inference, construct tree T(x) = (V, E) where nodes encode (module, input, output, score) and edges follow routing functions R_q. Repeat for perturbed input x̃, then align nodes by structural/module identifiers. Core assumption: Routing decisions remain deterministic and reproducible across reference/perturbed executions.

### Mechanism 3
Statistical attribution quantifies component influence on system failures via conditional deviation frequencies. Define Z_i = 1 - S_i(x, x̃) as deviation indicator. Failure Contribution FC_i = E[Z_i · I(S=0)] measures expected deviation conditioned on system-level failure. Normalize: α_i = FC_i / ΣFC_j. Higher α_i indicates stronger correlation with failures. Core assumption: Conditional correlation approximates causal responsibility when MRs are sufficiently comprehensive.

## Foundational Learning

- Concept: **Metamorphic Testing**
  - Why needed here: Core pseudo-oracle mechanism; enables testing without ground-truth labels
  - Quick check question: Given an object detector, name two metamorphic relations that should hold under mild brightness changes

- Concept: **Computation Graphs / State Machines**
  - Why needed here: Formal model for representing multi-component AI pipelines as traceable execution structures
  - Quick check question: Sketch the trace tree for a 3-component pipeline (detector → classifier_A or classifier_B) with routing based on detected class

- Concept: **Conditional Expectation for Attribution**
  - Why needed here: Underlies FC_i score definition; distinguishes correlation from causation
  - Quick check question: If component A fails in 80% of system failures but is only activated in 50% of runs, what additional information do you need to compute FC_A

## Architecture Onboarding

- Component map: Input → Trace T(x) construction → Perturbation g(x) → Trace T(x̃) → Node alignment → S_i evaluation → FC accumulation → α normalization
- Critical path: Input x → Trace T(x) construction → Perturbation g(x) → Trace T(x̃) → Node alignment → S_i evaluation → FC accumulation → α normalization
- Design tradeoffs:
  - Stricter MRs reduce false positives but increase brittleness under realistic noise
  - More perturbation types improve coverage but increase compute cost linearly
  - Module-level instrumentation adds overhead; can be disabled for production deployments
- Failure signatures:
  - α_i spike for single module: localized vulnerability to specific perturbation class
  - Multiple moderate α values: cascading failure propagation through tightly coupled modules
  - Zero α for all modules: MRs may be too loose or perturbation set insufficient
- First 3 experiments:
  1. Apply SETA to ensemble classifier on corrupted CIFAR-10; verify predicted accuracies match actual within 2-3%
  2. Vary MR thresholds (e.g., IoU > 0.7 vs. > 0.9 for detection); observe α redistribution to identify threshold-sensitive modules
  3. Adapt to OCR pipeline using Levenshtein distance MR with threshold τ=2; confirm α attribution identifies least robust text recognition components

## Open Questions the Paper Calls Out

### Open Question 1
How can the SETA framework be evolved to provide causal fault attribution rather than statistical correlation? The conclusion states the current formulation provides correlational, not causal, attribution and suggests integrating causal inference or interventional analysis. High attribution scores indicate association with failure rather than definitive responsibility, potentially misleading engineers if the true root cause lies elsewhere. An extension incorporating causal discovery methods that successfully isolates the root cause in a controlled pipeline with known fault injection points would resolve this.

### Open Question 2
Can metamorphic relations be automatically inferred or synthesized to reduce reliance on hand-crafted specifications? The authors note that diagnostic precision depends on relations which are "presently hand-crafted and may be incomplete," and suggest program synthesis as a future direction. Manual relation design is labor-intensive and may lack the expressiveness to capture all anomalous behaviors, leading to false negatives. A demonstrated method for automatically generating metamorphic relations from execution logs that achieves coverage comparable to human-designed specifications would resolve this.

### Open Question 3
How does the assumption of independence between perturbation effects affect attribution accuracy in tightly coupled systems? The "Limitations" section notes that statistical aggregation assumes independence between perturbation effects, which may not hold in tightly coupled systems. If perturbations in one module non-linearly affect others, the current Failure Contribution (FC) scores may be mathematically skewed. A comparative study on tightly coupled architectures showing the divergence between SETA's attribution scores and ground-truth fault locations would resolve this.

## Limitations
- Framework provides correlational rather than causal attribution, which may mislead fault localization
- Effectiveness depends heavily on comprehensive metamorphic relations and perturbation coverage
- Requires detailed instrumentation of execution traces, adding overhead and potential complexity
- Trace alignment breaks down with non-deterministic routing or stochastic components

## Confidence
- **High confidence**: Statistical attribution mechanism (FC_i calculation) and trace tree formalism are well-specified and reproducible
- **Medium confidence**: Effectiveness in real-world systems is demonstrated, but depends heavily on proper MR definition and perturbation selection
- **Low confidence**: Claims about architecture and modality agnosticism are theoretical without systematic cross-domain validation

## Next Checks
1. Implement SETA on a simple ensemble classifier with 3-5 perturbation types to verify attribution scores match actual failure patterns
2. Conduct ablation study varying MR thresholds to determine sensitivity and optimal parameter ranges
3. Apply SETA to a non-vision system (e.g., NLP pipeline) using appropriate MRs to test modality agnosticism claims