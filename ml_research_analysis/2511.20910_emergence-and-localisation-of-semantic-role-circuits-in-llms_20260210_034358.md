---
ver: rpa2
title: Emergence and Localisation of Semantic Role Circuits in LLMs
arxiv_id: '2511.20910'
source_url: https://arxiv.org/abs/2511.20910
tags:
- roles
- role
- circuit
- circuits
- across
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces COMPASS, a causal-temporal methodology for
  discovering and tracking semantic-role circuits in large language models. By combining
  contrastive minimal pairs with edge-attribution patching, the method isolates role-specific
  computational subgraphs and follows their evolution across training checkpoints.
---

# Emergence and Localisation of Semantic Role Circuits in LLMs

## Quick Facts
- **arXiv ID**: 2511.20910
- **Source URL**: https://arxiv.org/abs/2511.20910
- **Reference count**: 40
- **Primary result**: Semantic roles are encoded by highly concentrated causal circuits (89–94% of attribution mass in ≤28 nodes) that emerge through gradual structural refinement.

## Executive Summary
This paper introduces COMPASS, a causal-temporal methodology for discovering and tracking semantic-role circuits in large language models. By combining contrastive minimal pairs with edge-attribution patching, the method isolates role-specific computational subgraphs and follows their evolution across training checkpoints. Results show that semantic roles are encoded by highly concentrated circuits, that these circuits emerge through gradual structural refinement rather than discrete transitions, and that larger models reuse similar components while rewiring connections. Cross-scale and cross-family analyses reveal moderate structural conservation alongside high spectral similarity, indicating partial transferability of semantic mechanisms.

## Method Summary
COMPASS combines role-cross minimal pairs with edge attribution patching using Integrated Gradients to discover semantic-role circuits in LLMs. The method constructs minimal pairs differing only in role-indicating scaffolds, applies EAP-IG to compute edge-level causal attributions, extracts concentrated subgraphs (top-200 edges), and tracks their structural and functional evolution across training checkpoints. Temporal monitoring includes faithfulness via ablation, stability via Jaccard overlap, and sparsity via Gini coefficient and Top-K mass. The methodology identifies emergence markers including consolidation time (structural stability) and indispensability time (functional engagement).

## Key Results
- Semantic-role circuits are highly concentrated, with 89–94% of attribution mass in ≤28 nodes
- Circuits emerge through gradual structural refinement rather than discrete transitions, with structure stabilizing before functional engagement
- Larger models reuse similar circuit components while progressively rewiring connections, showing partial transferability of semantic mechanisms

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Edge Attribution Patching with Integrated Gradients (EAP-IG) localises causally functional semantic circuits to compact subgraphs.
- **Mechanism**: EAP-IG computes edge-level attribution scores by integrating gradients along an interpolation path between clean and corrupted inputs. For each edge (u→v), the score S_IG approximates the first-order change in loss if u's contribution to v were replaced by its corrupted counterpart, reducing gradient saturation compared to single-point methods.
- **Core assumption**: The straight-line interpolation path captures meaningful causal structure; attribution mass concentration reflects computational importance rather than artifact.
- **Evidence anchors**:
  - [abstract]: "highly concentrated circuits (89–94% of attribution mass in ≤28 nodes)"
  - [Section 3.2, Phase 1]: "S_IG = Δ_u^T ḡ_v where Δ_u = z_u^(r) - z_u^(s), and ḡ_v averages gradients along an IG interpolation path"
  - [corpus]: Related work (Hanna et al., 2024) validates EAP-IG for circuit discovery; limited direct corpus comparison for semantic-role tasks.

### Mechanism 2
- **Claim**: Role-cross minimal pairs isolate predicate–argument binding by varying only the role-indicating scaffold while holding predicate and arguments constant.
- **Mechanism**: Pairs like "delivered the package to the" (GOAL) vs. "delivered the package with the" (INSTRUMENT) differ only in the prepositional scaffold, forcing the model to rely on abstract role representations rather than lexical memorisation. Token parity ensures position-aligned activations for clean patching.
- **Core assumption**: Models encode abstract semantic roles that generalise across surface realisations; scaffold variation is sufficient to switch role-specific predictions.
- **Evidence anchors**:
  - [Section 3.1]: "We construct role-cross minimal pairs that differ only in the scaffold"
  - [Appendix F.5]: Paraphrase controls show stable faithfulness (INSTRUMENT: +0.02, LOCATION: −0.05) and consistent sparsity under scaffold variation.
  - [corpus]: Semantic role labelling literature (PropBank, FrameNet) provides theoretical grounding; corpus evidence for this specific isolation method is limited to the paper's internal validation.

### Mechanism 3
- **Claim**: Semantic-role circuits emerge through gradual structural refinement, not discrete phase transitions, with structure stabilising before functional engagement.
- **Mechanism**: Temporal tracking across training checkpoints reveals that structural metrics (circuit size, edge density, Top-K mass) evolve smoothly, while faithfulness exhibits non-monotonic volatility. Consolidation time (t_cons) precedes or differs from functional indispensability (t_ind), indicating structure–function dissociation.
- **Core assumption**: Training checkpoints capture meaningful developmental stages; Jaccard stability thresholds (≥0.6) and change-point detection validly identify consolidation.
- **Evidence anchors**:
  - [Section 5.2]: "Piecewise linear regression on Top-K mass yields extremely wide change-point confidence intervals, ruling out discrete transitions"
  - [Table 2]: t_ind varies from 32–512 steps while t_cons = 128–5000 steps across roles
  - [corpus]: Prior work on grokking (Power et al., 2021; Nanda et al., 2023) documents sharp transitions for algorithmic tasks; this paper contrasts with gradual emergence for semantic roles.

## Foundational Learning

- **Concept: Semantic roles (thematic roles)**
  - **Why needed here**: The entire methodology targets whether LLMs encode predicate–argument structure (AGENT, THEME, GOAL, INSTRUMENT, etc.) through causal circuits. Understanding that roles abstract across surface forms is essential for interpreting the minimal-pair design.
  - **Quick check question**: Given "The chef prepared the meal for the guest," which tokens fill the AGENT, THEME, and BENEFICIARY roles?

- **Concept: Activation patching and causal intervention**
  - **Why needed here**: EAP-IG extends activation patching by attributing causal influence to edges. Without understanding that patching swaps activations to test counterfactual dependence, the attribution scores lack interpretability.
  - **Quick check question**: If ablating a circuit drops accuracy from 85% to 62%, what does this imply about the circuit's causal role?

- **Concept: Transformer computational graphs**
  - **Why needed here**: The method models transformers as directed acyclic graphs where nodes are module outputs (attention heads, MLPs) and edges are residual connections. Circuit discovery operates on this graph structure.
  - **Quick check question**: In a 12-layer transformer with 8 heads per layer, approximately how many distinct attention-head nodes exist in the computational graph?

## Architecture Onboarding

- **Component map**: Dataset generator -> EAP-IG attribution engine -> Circuit extractor -> Temporal monitor -> Emergence detector

- **Critical path**:
  1. Generate and filter role-cross pairs (retain only examples where model predicts correctly in both contexts).
  2. For each checkpoint, run EAP-IG to obtain edge attributions.
  3. Extract circuit C(r)_t and compute structural/functional metrics.
  4. Detect emergence markers and cross-validate with paraphrase controls.

- **Design tradeoffs**:
  - **IG steps (m=5)**: Chosen for computational tractability across 143K+ checkpoints; may miss non-linear path structure. Spot-check with m=10 on selected checkpoints to validate stability.
  - **Top-K threshold (K=20–30)**: Balances sparsity focus against coverage; K=20 for emergence analysis, K=30 for cross-model comparison to accommodate larger models.
  - **Token parity constraint**: Essential for position-aligned patching but reduces dataset coverage; requires careful scaffold pairing.

- **Failure signatures**:
  - Diffuse attribution (Gini < 0.3, >50 nodes for 90% mass): EAP-IG not isolating meaningful circuits.
  - High cross-role overlap (Jaccard > 0.7): Circuits may reflect shared syntactic processing rather than role-specific binding.
  - Faithfulness crashes without recovery: Circuit may be epiphenomenal or training dynamics unstable.
  - Paraphrase inconsistency (>0.1 faithfulness shift): Circuits overfit to lexical scaffolds.

- **First 3 experiments**:
  1. **Replicate on a single role**: Choose INSTRUMENT (clean mid-layer architecture per Table 13), generate 500 role-cross pairs, run EAP-IG at final checkpoint. Verify Top-20 mass > 0.85 and circuit size < 25 nodes.
  2. **Paraphrase control**: For the same role, construct 200 paraphrase pairs with alternative scaffolds ("with the" → "using the"). Confirm faithfulness shift < 0.1 and Top-20 overlap > 0.6 with original circuit.
  3. **Temporal slice**: Run attribution at 3 checkpoints (early: 1K, mid: 50K, late: 143K). Plot faithfulness and Top-K mass to verify smooth structural evolution vs. volatile functional engagement.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: Do semantic-role circuits discovered in English transfer to typologically diverse languages with different morphosyntactic realizations of thematic relations?
- **Basis in paper**: [explicit] The Limitations section states "whether similar circuits arise in typologically diverse languages or richer role inventories remains unknown."
- **Why unresolved**: The study only examined English, yet semantic roles surface differently across languages (e.g., case marking vs. prepositional phrases), making cross-linguistic transfer unclear.
- **What evidence would resolve it**: Applying COMPASS to multilingual models across languages with divergent case systems and argument realization patterns, measuring node overlap and spectral similarity.

### Open Question 2
- **Question**: What computational mechanisms trigger the transition from structural circuit presence to functional indispensability in semantic-role processing?
- **Basis in paper**: [inferred] The paper documents pronounced structure–function dissociation where "circuits can be structurally well-formed yet functionally but temporarily underutilised," but does not identify the triggering conditions.
- **Why unresolved**: The methodology tracks when circuits become indispensable (t_ind) but does not isolate what optimization dynamics or training signals cause functional engagement to lag behind structural consolidation.
- **What evidence would resolve it**: Interventional experiments during training that manipulate specific gradients or attention patterns at consolidation timepoints to identify causal triggers for functional engagement.

### Open Question 3
- **Question**: How do semantic-role circuits interact with syntactic processing and coreference resolution mechanisms in transformer architectures?
- **Basis in paper**: [explicit] The Future Work section explicitly calls for "study[ing] interactions between semantic-role circuits and syntax or coreference mechanisms."
- **Why unresolved**: COMPASS isolates predicate–argument binding but does not examine whether discovered circuits share infrastructure with syntactic or discourse-level processing.
- **What evidence would resolve it**: Joint circuit analysis across semantic role, syntactic parsing, and coreference tasks to identify shared vs. specialized components.

## Limitations

- **Token-parity constraint**: The method's reliance on minimal pairs with token parity limits the diversity of semantic roles that can be studied, potentially missing circuits for roles requiring multi-token arguments.
- **Attribution assumptions**: The approach assumes edge-level Integrated Gradients accurately capture causal influence, but this remains theoretically under-constrained for deep transformer architectures.
- **Cross-scale scaling**: Analyses depend on fixed-size lexicons that may not scale proportionally with model capacity, risking artefacts from coverage gaps.

## Confidence

- **High confidence**: The concentration of semantic-role circuits (89–94% mass in ≤28 nodes) is well-supported by the data and robust across models and roles. The circuit isolation method via role-cross minimal pairs is methodologically sound and validated through paraphrase controls.
- **Medium confidence**: The gradual emergence mechanism is plausible but could be influenced by checkpoint granularity. Cross-scale conservation findings are suggestive but limited to three model sizes in a single family. The dissociation between structural consolidation and functional indispensability requires further validation with different task complexities.
- **Low confidence**: Claims about abstract semantic role encoding rely heavily on the assumption that scaffold variation alone drives role-specific predictions, which may not generalise to more complex syntactic environments or open-domain text.

## Next Checks

1. **Scale the lexicon coverage**: Expand semantic-role lexicons by 50% and verify whether circuit concentration metrics (Top-K mass, Gini) remain stable or whether attribution becomes diffuse, indicating lexicon-coverage artefacts.

2. **Test with variable interpolation steps**: Run EAP-IG with m=10 steps on 5 randomly selected checkpoints and compare edge attributions to m=5 results; significant divergence would question the validity of the causal attribution path assumption.

3. **Cross-task circuit transfer**: Apply COMPASS to a structurally similar task (e.g., coreference resolution) and measure node overlap with semantic-role circuits; high overlap would suggest shared syntactic mechanisms rather than role-specific binding.