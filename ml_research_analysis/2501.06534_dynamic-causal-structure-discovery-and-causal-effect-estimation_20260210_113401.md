---
ver: rpa2
title: Dynamic Causal Structure Discovery and Causal Effect Estimation
arxiv_id: '2501.06534'
source_url: https://arxiv.org/abs/2501.06534
tags:
- causal
- dynamic
- graph
- could
- time
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a framework for dynamic causal structure
  discovery and causal effect estimation, addressing the limitation of static causal
  graphs in traditional methods. The authors propose a dynamic linear structural equation
  model (dynamic LSEM) and a dynamic structural vector autoregressive (dynamic SVAR)
  model to capture time-varying and time-lagged causal relationships.
---

# Dynamic Causal Structure Discovery and Causal Effect Estimation

## Quick Facts
- **arXiv ID:** 2501.06534
- **Source URL:** https://arxiv.org/abs/2501.06534
- **Authors:** Jianian Wang; Rui Song
- **Reference count:** 40
- **Primary result:** Introduces framework for dynamic causal structure discovery and causal effect estimation, outperforming existing methods on synthetic data and demonstrating real-world applicability to COVID-19 policy analysis

## Executive Summary
This paper addresses the limitation of static causal graphs in traditional causal discovery methods by introducing a framework for dynamic causal structure discovery. The authors propose using basis approximation within score-based causal discovery approaches to capture time-varying causal relationships, enabling both historical estimation and future prediction of causal graphs. The framework incorporates a dynamic linear structural equation model (dynamic LSEM) and a dynamic structural vector autoregressive (dynamic SVAR) model to capture time-varying and time-lagged causal relationships. Experiments demonstrate superior performance compared to existing methods across various simulation scenarios and show the method's ability to capture dynamic causal effects of policy interventions over time using real COVID-19 data.

## Method Summary
The framework combines basis approximation with score-based causal discovery to model time-varying causal relationships. It parameterizes causal coefficients using basis functions (e.g., B-splines) to avoid the curse of dimensionality that arises when estimating distinct causal weights for every time point. The method uses a continuous acyclicity constraint formulation (inspired by NOTEARS) to enable efficient gradient-based optimization via a Variational Autoencoder structure. The dynamic SVAR model captures both instantaneous and time-lagged causal effects by decomposing causality into contemporaneous effects (via matrix B_t) and time-lagged effects (via matrix W_t). The framework enables discovery of dynamic causal structures and estimation of dynamic treatment effects over time.

## Key Results
- Outperforms existing methods in terms of FDR, TPR, SHD, and MSE metrics across various simulation scenarios
- Successfully captures dynamic causal effects of COVID-19 policy interventions, showing temporal variation in policy effectiveness
- Demonstrates the ability to distinguish between instantaneous and historical causal effects through the dynamic SVAR formulation
- Shows robustness to different basis function specifications when appropriate parameters are selected

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** The framework mitigates the "curse of dimensionality" in time-varying models by parameterizing causal coefficients using basis approximation.
- **Mechanism:** Instead of estimating a distinct causal weight for every time point independently, the model represents each entry in the adjacency matrix as a linear combination of basis functions (e.g., B-splines), enforcing global smoothing and allowing the model to share statistical strength across time stamps.
- **Core assumption:** The underlying causal strength functions are smooth or continuous enough to be represented by a finite number of basis functions.
- **Evidence anchors:** [abstract] "...incorporate the basis approximation method into the score-based causal discovery..."; [section 3.4] "...we utilize the basis approximation method [21] to estimate the varying coefficient model, which conducts global smoothing on the coefficients."
- **Break condition:** If causal relationships change discontinuously or exhibit high-frequency oscillations not captured by the chosen basis order.

### Mechanism 2
- **Claim:** The method enables efficient causal structure learning by converting the acyclicity constraint into a differentiable equation.
- **Mechanism:** Traditional DAG learning is NP-hard due to combinatorial nature. This approach uses a continuous constraint function that allows black-box gradient-based solvers (Adam optimizer) via a VAE structure to find optimal graph weights.
- **Core assumption:** The true causal graph is a Directed Acyclic Graph (DAG).
- **Evidence anchors:** [section 3.5] "NOTEARS [45] convert the combinatorial optimization problem into a continuous programming problem by formulating the acyclic constraint as a smooth equality constraint."; [abstract] "...score-based causal discovery approach..."
- **Break condition:** If the system contains cyclic feedback loops or if optimization converges to a local minimum that is not the true graph.

### Mechanism 3
- **Claim:** The framework distinguishes between instantaneous and historical effects by unrolling temporal dependencies in a structural vector autoregressive model.
- **Mechanism:** The model decomposes causality into contemporaneous effects (via B_t) and time-lagged effects (via W_t), assuming future values don't cause past values while ensuring instantaneous relationships within a time step form a DAG.
- **Core assumption:** Causal effects operate within a finite lag window.
- **Evidence anchors:** [section 4.1] "...we propose the following dynamic structural vector autoregressive (dynamic SVAR) model... [eq 8] $X_t = X_t B_t + Z_t W_t + E_t$."; [abstract] "...capture both contemporaneous and time-lagged causal relationships..."
- **Break condition:** If the time lag order d is set lower than the true causal delay, the model will misattribute lagged effects.

## Foundational Learning

- **Concept: Basis Expansion (Splines)**
  - **Why needed here:** This is the mathematical "engine" that allows causal weights to change over time without overfitting the data.
  - **Quick check question:** If you have 100 time points, why is it better to model a coefficient as a sum of 3 basis curves rather than 100 independent scalars?

- **Concept: Variational Autoencoders (VAE) & ELBO**
  - **Why needed here:** The paper uses a VAE to handle non-linear relationships. Understanding the Evidence Lower Bound (ELBO) is required to debug the loss function during training.
  - **Quick check question:** In this architecture, is the "decoder" reconstructing the data X directly, or the latent noise E?

- **Concept: Structural Equation Models (SEM)**
  - **Why needed here:** The entire framework rests on the equation $X = XB + E$. You must understand how matrix B corresponds to a graph topology to interpret the output.
  - **Quick check question:** If $B_{ij} = 0$, what does that imply about the edge between node i and node j in the causal graph?

## Architecture Onboarding

- **Component map:** Time-series data X_t -> Basis Layer (generates D_t using B-splines) -> VAE Core (Encoder maps X to latent E; Decoder reconstructs X using D_t and parameters Γ) -> Constraint Module (calculates acyclicity penalty h_1(Γ) and treatment constraint h_2(Γ)) -> Outputs: Time-varying adjacency matrices B_t and W_t

- **Critical path:** 1. Data preparation -> 2. Basis function selection (cross-validation for knots) -> 3. VAE Training (minimize -ELBO subject to h(Γ)=0) -> 4. Extraction of dynamic causal effects

- **Design tradeoffs:**
  - **Number of Basis (K):** Increasing K captures complex time dynamics but increases risk of overfitting and computational load
  - **Lag Order (d):** Higher d captures longer historical dependence but requires more data and parameters

- **Failure signatures:**
  - **High SHD (Structural Hamming Distance):** Indicates discovered graph structure differs significantly from ground truth
  - **Oscillating Causal Strength:** Suggests number of basis functions is too high or learning rate is unstable
  - **Non-zero Loss:** If acyclicity constraint h(Γ) does not approach 0, resulting graph contains cycles and is invalid

- **First 3 experiments:**
  1. **Basis Tuning (Simulated):** Replicate Figure 5 to determine how many basis knots are needed to recover a Cosine-varying coefficient without overfitting
  2. **Static vs. Dynamic Baseline:** Compare proposed method against "NOTEARS" on dataset where causal strength shifts (Scenario S1F1) to verify static models fail to capture drift
  3. **COVID-19 Analysis (Real Data):** Run inference pipeline on provided German district dataset to verify estimated dynamic causal effect of policy intervention diminishes over time

## Open Questions the Paper Calls Out
None identified in the provided text.

## Limitations
- Assumes underlying causal graph is acyclic (DAG), which may not hold in systems with feedback loops or cyclic dependencies
- Performance heavily depends on appropriate selection of basis function parameters and lag order, requiring careful cross-validation
- Computational complexity scales with time series length and number of basis functions, potentially limiting applicability to very long time series

## Confidence
- **High Confidence:** The core mechanism of using basis approximation to mitigate dimensionality in time-varying models is well-established and mathematically sound
- **Medium Confidence:** The dynamic SVAR formulation for capturing instantaneous and lagged effects is theoretically valid, but real-world applicability depends on correct specification of lag order
- **Medium Confidence:** Experimental results show superior performance on synthetic data, but real-world COVID-19 analysis is limited to one dataset and may not generalize to other domains

## Next Checks
1. **Robustness to Basis Specification:** Systematically vary the number of basis functions and lag order on synthetic data with known ground truth to quantify sensitivity to hyperparameter choices
2. **Cyclic Graph Handling:** Test the framework on datasets with known feedback loops to evaluate how violations of the DAG assumption affect performance
3. **Cross-Domain Generalization:** Apply the method to multiple real-world time series datasets from different domains (economics, biology, climate) to assess generalizability beyond the COVID-19 case study