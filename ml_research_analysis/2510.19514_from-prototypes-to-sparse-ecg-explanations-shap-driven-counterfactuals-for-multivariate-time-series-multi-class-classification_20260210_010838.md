---
ver: rpa2
title: 'From Prototypes to Sparse ECG Explanations: SHAP-Driven Counterfactuals for
  Multivariate Time-Series Multi-class Classification'
arxiv_id: '2510.19514'
source_url: https://arxiv.org/abs/2510.19514
tags:
- sparse
- counterfactual
- class
- clinical
- https
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a prototype-driven framework for generating
  sparse counterfactual explanations tailored to 12-lead ECG classification models.
  The method combines SHAP-based rule extraction, Dynamic Time Warping (DTW), and
  medoid clustering to identify representative prototypes, which are then aligned
  to query R-peaks and optimized for sparsity.
---

# From Prototypes to Sparse ECG Explanations: SHAP-Driven Counterfactuals for Multivariate Time-Series Multi-class Classification

## Quick Facts
- arXiv ID: 2510.19514
- Source URL: https://arxiv.org/abs/2510.19514
- Reference count: 40
- Presents prototype-driven framework for sparse counterfactual explanations in 12-lead ECG classification

## Executive Summary
This paper introduces a novel framework for generating sparse counterfactual explanations specifically designed for 12-lead ECG classification models. The approach combines SHAP-based rule extraction, Dynamic Time Warping, and medoid clustering to identify representative prototypes that can be aligned to query R-peaks and optimized for sparsity. The method demonstrates significant improvements in temporal stability while maintaining high validity across multiple cardiac conditions, making it particularly suitable for clinical applications where explanation quality and physiological plausibility are paramount.

## Method Summary
The framework operates through a multi-stage process that begins with SHAP-based rule extraction to identify important signal features, followed by medoid clustering to create representative prototypes. Dynamic Time Warping is then used to align these prototypes to query R-peaks, ensuring temporal consistency across the 12-lead ECG signals. The final stage involves optimizing the counterfactuals for sparsity while maintaining class discrimination, resulting in explanations that modify only 78% of the original signal while achieving 81.3% validity across all classes.

## Key Results
- Achieves 81.3% validity across all cardiac classes with only 78% signal modification
- Demonstrates 43% improvement in temporal stability compared to baseline methods
- Shows class-specific validity ranging from 98.9% (myocardial infarction) to 13.2% (hypertrophy)

## Why This Works (Mechanism)
The framework's effectiveness stems from its physiologically-aware approach to counterfactual generation. By leveraging SHAP to extract clinically meaningful rules and using medoid clustering to identify representative patterns, the method ensures that generated explanations align with actual cardiac signal characteristics. The Dynamic Time Warping alignment to R-peaks preserves temporal relationships critical for ECG interpretation, while the sparsity optimization prevents over-modification that could compromise clinical validity.

## Foundational Learning
- **SHAP-based rule extraction**: Extracts interpretable feature importance from complex models; needed for identifying clinically relevant signal patterns; quick check: verify extracted rules align with known ECG diagnostic criteria
- **Dynamic Time Warping alignment**: Aligns temporal sequences despite variations; needed for matching prototype patterns to patient-specific R-peaks; quick check: measure alignment accuracy across different heart rates
- **Medoid clustering**: Identifies representative prototypes from diverse samples; needed for creating stable reference patterns; quick check: evaluate cluster compactness and separation metrics
- **Sparsity optimization**: Minimizes signal modifications while preserving class discrimination; needed for maintaining clinical plausibility; quick check: compare modified vs original signal similarity metrics
- **Multi-class validation**: Tests framework across different cardiac conditions; needed for assessing generalization; quick check: analyze class-specific performance patterns
- **Temporal stability measurement**: Quantifies explanation consistency over time; needed for clinical reliability assessment; quick check: measure stability across different time windows

## Architecture Onboarding
**Component Map:** Data Preprocessing -> SHAP Extraction -> Medoid Clustering -> DTW Alignment -> Sparsity Optimization -> Validation
**Critical Path:** The most time-sensitive sequence is DTW Alignment -> Sparsity Optimization -> Validation, as this determines real-time generation capability
**Design Tradeoffs:** Sparsity vs. validity (78% modification achieves 81.3% validity), computational complexity vs. temporal stability (43% improvement requires additional processing)
**Failure Signatures:** Poor SHAP extraction leads to physiologically implausible prototypes, misalignment in DTW causes temporal inconsistencies, over-optimization for sparsity reduces class discrimination
**First Experiments:** 1) Test SHAP extraction accuracy on known ECG patterns, 2) Validate DTW alignment across varying heart rates, 3) Measure sparsity vs validity tradeoff curves

## Open Questions the Paper Calls Out
The paper does not explicitly call out open questions in the provided content.

## Limitations
- Generalizability beyond 12-lead ECG domain remains untested
- Class-specific validity varies significantly (13.2% to 98.9%), raising reliability concerns
- Expert evaluation limited to three cardiology specialists, potentially insufficient for clinical validation

## Confidence
- Generalizability to other domains: **Medium** - framework shows promise but untested on non-cardiac data
- Clinical impact assessment: **Medium** - expert validation performed but limited in scope and scale
- Physiological validity claims: **High** - strong alignment with known ECG patterns and expert evaluation

## Next Checks
1. **Cross-domain validation**: Test the framework on non-cardiac multivariate time-series datasets (e.g., EEG, financial time-series) to assess generalizability of the prototype extraction and alignment methodology.
2. **Longitudinal clinical study**: Conduct a prospective study with a larger cohort of cardiology experts to evaluate whether counterfactual explanations improve diagnostic accuracy and clinical decision-making over extended periods.
3. **Real-time deployment testing**: Implement the framework in a clinical environment with actual patient monitoring systems to verify sub-second generation claims under realistic computational constraints and data quality variations.