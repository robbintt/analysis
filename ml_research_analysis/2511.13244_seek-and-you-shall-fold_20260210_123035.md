---
ver: rpa2
title: Seek and You Shall Fold
arxiv_id: '2511.13244'
source_url: https://arxiv.org/abs/2511.13244
tags:
- protein
- chemical
- restraints
- guidance
- experimental
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work tackles the challenge of incorporating non-differentiable
  experimental data into protein generative models, a long-standing bottleneck in
  structural biology. The core innovation is a general framework that couples a continuous
  diffusion-based generator (BioEmu) with any black-box scoring function via a tailored
  genetic algorithm, enabling guidance using mature but non-differentiable experimental
  predictors.
---

# Seek and You Shall Fold

## Quick Facts
- arXiv ID: 2511.13244
- Source URL: https://arxiv.org/abs/2511.13244
- Reference count: 39
- One-line primary result: A genetic algorithm successfully guides a diffusion-based protein generator using non-differentiable experimental data, improving structure generation in response to NOE and pairwise distance constraints, but chemical shift guidance improves scoring without structural convergence.

## Executive Summary
This work tackles the challenge of incorporating non-differentiable experimental data into protein generative models, a long-standing bottleneck in structural biology. The core innovation is a general framework that couples a continuous diffusion-based generator (BioEmu) with any black-box scoring function via a tailored genetic algorithm, enabling guidance using mature but non-differentiable experimental predictors. The method was demonstrated across three modalities: pairwise distance constraints, nuclear Overhauser effect restraints, and chemical shifts. Results show that the genetic algorithm successfully improves structure generation in response to experimental signals—NOE guidance recovered experimental folds, pairwise distances enabled conformational switching, and chemical shift guidance improved scoring agreement. However, the latter did not achieve structural convergence, highlighting current limitations in chemical shift prediction models. The framework provides a robust, general approach for conditioning protein generative models on diverse experimental data beyond the reach of differentiable methods.

## Method Summary
The method couples a continuous diffusion-based generator (BioEmu) with any black-box scoring function via a tailored genetic algorithm. It treats the structure generation $x = G(z)$ as a black-box decoding process, where the GA maintains a population of latents, decodes them to structures, scores them, and evolves the latents to maximize the experimental score $S(x)$. Key modifications to standard GA include disabling crossover, applying residue-wise perturbations in the generator's latent space, and using a linear annealing perturbation time scheduler to transition from coarse structural resets to fine-grained atomic tuning. The framework was demonstrated on three types of experimental data: pairwise distance constraints, nuclear Overhauser effect restraints, and chemical shifts.

## Key Results
- NOE guidance successfully recovered experimental protein folds that the baseline generator could not access.
- Pairwise distance constraints enabled conformational switching between helical and loop states using residue-wise latent perturbations.
- Chemical shift guidance improved scoring agreement (MAE) but failed to converge to the experimental fold, indicating limitations in current chemical shift predictors.

## Why This Works (Mechanism)

### Mechanism 1
A genetic algorithm (GA) can effectively guide a diffusion model using non-differentiable black-box scorers by searching over the generator's latent space rather than computing gradients. The method decouples the generative model from the scoring function, treating structure generation as a black-box decoding process. The GA maintains a population of latents, decodes them to structures, scores them, and evolves the latents to maximize the experimental score. Core assumption: The generator's latent space is structured such that iterative local perturbations can traverse the manifold of valid protein structures to find high-scoring regions without requiring gradient information.

### Mechanism 2
Restricting perturbations to single residue latents preserves the global fold while enabling local refinement, preventing the structural collapse often seen with global crossover operations. The algorithm maps a parent structure to an intermediate latent $z_t$, selects a single residue index $a$, and replaces the latent row $z_t[a]$ with a corresponding row from a stochastic resample $\hat{z}_t[a]$. This residue-wise swap acts as a localized "mutation," allowing the protein to explore conformational changes without breaking the overall backbone geometry. Core assumption: Structural changes in proteins can be effectively driven by local latent modifications, and global integrity is maintained by the generator's prior.

### Mechanism 3
Annealing the diffusion time for perturbations allows the search to transition from coarse structural resets to fine-grained atomic tuning. The perturbation time $t_k$ decreases linearly across generations. Early generations use high $t$ (noisier latents), allowing the GA to explore significantly different folds. Later generations use low $t$ (cleaner latents), restricting changes to small adjustments. This mimics simulated annealing, preventing the "plateauing" observed with fixed perturbation strengths. Core assumption: The optimization landscape requires distinct phases of exploration (high $t$) and exploitation (low $t$), and a linear schedule is sufficient to capture this dynamic.

## Foundational Learning

- **Diffusion ODE Solvers & Latent Inversion**
  - Why needed here: The method relies on mapping a structure back to a latent $z_t$ (inversion) to perturb it. You must understand that while BioEmu is trained as an SDE, this work uses a deterministic ODE solver (DPM-Solver) to make this mapping reproducible.
  - Quick check question: Why does the paper switch BioEmu from a stochastic SDE sampler to a deterministic ODE sampler for the GA loop?

- **Black-Box Optimization / Genetic Algorithms**
  - Why needed here: You need to understand standard GA components (tournament selection, elitism) to see how they were modified (no crossover, residue-wise mutation) for this specific domain.
  - Quick check question: Why is "crossover" (combining two parent latents) disabled in this protein-specific GA?

- **NMR Observables (NOE vs. Chemical Shifts)**
  - Why needed here: The results diverge significantly based on the data type. Understanding that NOEs are explicit distance restraints while chemical shifts are dense but "weaker" structural proxies is key to interpreting the results.
  - Quick check question: Why did chemical shift guidance improve the score (MAE) but fail to converge to the experimental fold, whereas NOE guidance succeeded?

## Architecture Onboarding

- **Component map:** BioEmu (Diffusion Model) + FlowPacker (Side-chains) -> Black-box Scorers (UCBShift, custom violation logic) <- Genetic Algorithm loop

- **Critical path:** The inference loop: 1. Start with population of $z_T \sim N(0, I)$. 2. Decode: Run ODE solver to get structures $x$. 3. Score: Run black-box scorer on $x$. 4. Select: Pick "elites" and parents. 5. Perturb: For each parent, run reverse-ODE to time $t_k$, stochastically resample one residue row, run forward-ODE to $t=0$. 6. Repeat.

- **Design tradeoffs:** Using an ODE solver (deterministic) ensures that a latent $z$ always yields the same structure $x$, making the search stable. The stochasticity is explicitly injected only during the perturbation step via the SDE resample. The framework accepts non-differentiable scorers but pays the cost of a search loop (1.0 - 3.5 hours on H100) rather than fast gradient descent.

- **Failure signatures:** You may see the loss curve dropping while the visual fold remains wrong, indicating the predictor is "hallucinating" agreement or lacks resolution. If the perturbation time $t$ is fixed, the search will stop improving—annealing $t$ is required to break plateaus.

- **First 3 experiments:**
  1. Verify Perturbation Logic: Reproduce the "4OLE" toy experiment. Initialize from Conformation B and check if residue-wise perturbation at high $t$ allows the GA to flip the loop to the helical Conformation A.
  2. Stability Check: Run the GA on a stable protein with "dummy" constraints. Check if the residue-wise perturbation maintains the fold or drifts, validating that the generator manifold is being respected.
  3. Scorer Baseline: Run the chemical shift guidance on a protein where you know the exact structure (synthetic shifts). Compare the convergence speed against a case with experimental shifts to isolate the error introduced by the UCBShift predictor vs. the GA limitations.

## Open Questions the Paper Calls Out

- Can a dynamically adaptive perturbation time scheduler prevent the convergence plateaus observed with linear scheduling? The authors hypothesize that plateaus occur because the genetic search requires variable cycles at different perturbation times and state, "As future work, we plan to design a more adaptive scheduling strategy." This remains unresolved because the current linear annealing schedule cannot adjust to the specific needs of the search trajectory at different diffusion times.

- Can physically grounded chemical shift predictors translate improved scoring agreement into structural convergence? The authors note that chemical shift guidance failed to converge structurally and explicitly list "physically informed and differentiable chemical shift models" as a requirement for future work. This is unresolved because current predictors like UCBShift lack the biophysical grounding to ensure that minimizing prediction error yields the correct fold.

- Do ensemble-level scoring objectives improve the physical accuracy of generated protein ensembles for NMR data? The discussion identifies "ensemble-level objectives" as future work, noting that current single-structure application of NOE restraints fails to capture population-weighted experimental data. This remains unresolved because NOE signals are inherently ensemble averages, but the current method evaluates restraints on individual structures independently.

## Limitations

- Chemical shift guidance improves scoring agreement but fails to achieve structural convergence, highlighting limitations in current chemical shift prediction models.
- The method requires 1.0-3.5 hours of GPU time per protein on H100 hardware, making it computationally expensive compared to differentiable methods.
- Exact implementation details for latent inversion (G⁻¹) and the stochastic resample from the reverse SDE at intermediate times are not specified, potentially limiting exact reproducibility.

## Confidence

- **High confidence**: The GA framework design, the decoupling of differentiable generation from non-differentiable scoring, and the rationale for residue-wise perturbations and linear annealing are well-supported by both the methodology and experimental results.
- **Medium confidence**: The specific parameter choices (population size, tournament size, perturbation schedule) are plausible and consistent with GA literature, but may require tuning for other proteins or experimental data types.
- **Low confidence**: The exact implementation details for latent inversion (G⁻¹) and the stochastic resample from the reverse SDE at intermediate times are not specified, potentially limiting exact reproducibility.

## Next Checks

1. Verify Perturbation Logic: Reproduce the "4OLE" toy experiment to confirm that residue-wise perturbations at high t allow the GA to flip between structural conformations, validating the core mechanism.
2. Stability Check: Run the GA on a stable protein with dummy constraints to ensure residue-wise perturbations preserve the global fold and do not cause structural drift, confirming that the generator manifold is being respected.
3. Scorer Baseline Comparison: Run chemical shift guidance on a protein with known synthetic shifts and compare convergence speed against experimental shifts to isolate errors introduced by the UCBShift predictor versus GA limitations.