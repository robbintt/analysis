---
ver: rpa2
title: KANFormer for Predicting Fill Probabilities via Survival Analysis in Limit
  Order Books
arxiv_id: '2512.05734'
source_url: https://arxiv.org/abs/2512.05734
tags:
- order
- survival
- limit
- time
- queue
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces KANFormer, a novel deep learning model for
  predicting the time-to-fill of limit orders in electronic financial exchanges. The
  model combines a Dilated Causal Convolutional network with a Transformer encoder
  enhanced by Kolmogorov-Arnold Networks (KANs), integrating both market-level LOB
  snapshots and agent-level behavioral features.
---

# KANFormer for Predicting Fill Probabilities via Survival Analysis in Limit Order Books

## Quick Facts
- arXiv ID: 2512.05734
- Source URL: https://arxiv.org/abs/2512.05734
- Reference count: 0
- This paper introduces KANFormer, a novel deep learning model for predicting the time-to-fill of limit orders in electronic financial exchanges.

## Executive Summary
This paper introduces KANFormer, a novel deep learning model for predicting the time-to-fill of limit orders in electronic financial exchanges. The model combines a Dilated Causal Convolutional network with a Transformer encoder enhanced by Kolmogorov-Arnold Networks (KANs), integrating both market-level LOB snapshots and agent-level behavioral features. Unlike prior approaches, KANFormer incorporates agent actions (order submissions, cancellations, modifications) and queue position to capture richer market dynamics. Evaluated on CAC 40 index futures data, KANFormer outperforms existing methods across multiple metrics: RCLL (0.53), IBS (0.027), IAUC (0.76), and C-index (0.72), demonstrating superior calibration and discrimination.

## Method Summary
KANFormer predicts the time-to-fill survival function for limit orders using survival analysis with right-censoring. The architecture features two specialized KAN-Transformer encoders: one processes agent action sequences with behavioral statistics, while the other processes LOB snapshots with Dilated Causal Convolution. These embeddings are concatenated with queue position and passed through an MLP to predict Weibull distribution parameters. The model is trained on CAC 40 futures data using RCLL loss with Adam optimization.

## Key Results
- KANFormer achieves RCLL of 0.53, outperforming ConvTrans (0.55) and other baselines
- Integrated Brier Score (IBS) of 0.027 indicates superior calibration
- Time-dependent IAUC of 0.76 demonstrates strong discrimination across 20 horizons
- Ablation studies confirm importance of KANs, DCC, and enriched features for performance

## Why This Works (Mechanism)

### Mechanism 1
- Claim: KAN layers improve nonlinear approximation in survival prediction compared to standard feedforward networks.
- Mechanism: Kolmogorov-Arnold Networks replace fixed activation functions with learnable spline-based functions on edges, enabling more expressive functional decomposition of the relationship between LOB dynamics and execution risk.
- Core assumption: The mapping from market signals to survival distributions contains complex nonlinear structure that splines can approximate more efficiently than ReLU-based FFNs.
- Evidence anchors:
  - [abstract] "Kolmogorov–Arnold Networks (KANs), which improve nonlinear approximation"
  - [section 5.3] Ablation shows KANFormer improves IAUC from 0.61 to 0.71 without DCC; from 0.63 to 0.76 with DCC
  - [corpus] Weak—no corpus papers directly validate KAN architectures in financial survival analysis

### Mechanism 2
- Claim: Integrating agent-level behavioral features with queue position captures execution-relevant information absent from LOB snapshots alone.
- Mechanism: Two specialized KAN-Transformer encoders separately process agent action sequences (type embeddings + behavioral statistics) and LOB snapshots, then concatenate with queue position before prediction. This preserves heterogeneous temporal dynamics while enabling cross-modal interaction.
- Core assumption: Agent behaviors (cancel ratios, trade aggression) encode persistent execution-relevant intentions not recoverable from price-volume snapshots.
- Evidence anchors:
  - [abstract] "integrates the actions of agents related to LOB dynamics and the position of the order in the queue"
  - [section 5.3] Removing queue drops IAUC from 0.76 to 0.57; removing agent features drops to 0.68
  - [corpus] LOBERT (2511.12563) similarly argues message-level LOB modeling captures dynamics invisible to snapshot representations

### Mechanism 3
- Claim: Dilated Causal Convolution provides locally-aware temporal context that improves Transformer attention for LOB sequences.
- Mechanism: DCC processes LOB snapshots before generating queries/keys/values for self-attention, capturing short-range patterns (order flow bursts, microstructure shifts) that pure attention may miss due to limited receptive field at early layers.
- Core assumption: Short-term local patterns in LOB evolution are discriminative for execution timing beyond what global attention captures.
- Evidence anchors:
  - [section 4.2] "DCCs process the LOB snapshots to generate queries, keys, and values"
  - [section 5.3] DCC improves discrimination for both Transformer (IAUC 0.61→0.63) and KANFormer (0.71→0.76)
  - [corpus] Weak—corpus papers do not evaluate DCC architectures for LOB prediction

## Foundational Learning

- Concept: **Survival analysis with right-censoring**
  - Why needed here: Limit orders are frequently canceled or expire unfilled; discarding them biases estimates. Survival analysis properly handles censored time-to-event data.
  - Quick check question: Can you explain why treating canceled orders as "not executed" at horizon H would bias fill probability estimates?

- Concept: **Proper scoring rules for distributional prediction**
  - Why needed here: RCLL is a proper scoring rule (unique minimizer is the true distribution), unlike C-index or Brier score. Critical for calibration evaluation.
  - Quick check question: Why might a model achieve high C-index but poorly calibrated survival probabilities?

- Concept: **Queue-reactive execution dynamics**
  - Why needed here: Price-time priority means queue position directly determines execution order; queue-reactive models (Huang et al. 2015) formalize this dependency.
  - Quick check question: If two orders have identical LOB context but different queue positions, which should have higher fill probability in the near term?

## Architecture Onboarding

- Component map:
  A_actions (L×d+5) → Action KAN-Transformer → Agent embedding
  X_LOB (L×4n+4) → DCC → LOB KAN-Transformer → LOB embedding
  Queue position → Concatenation → MLP → Weibull parameters (λ, k)

- Critical path: LOB snapshot → DCC → KAN-Transformer → embedding → concatenation → Predictor → S(t). Queue position enters only at predictor stage.

- Design tradeoffs:
  - Two encoders vs. single fused encoder: Specialized encoders better handle heterogeneous input modalities but increase parameters
  - Weibull vs. nonparametric output: Weibull guarantees monotonic S(t) with 2 parameters; nonparametric (e.g., DeepHit) offers flexibility but requires discretization
  - L=50 lookback: Captures local dynamics with manageable computation; longer windows didn't improve RCLL in prior work

- Failure signatures:
  - IAUC approaching 0.5: Model fails discrimination—check if queue position is being used
  - RCLL not decreasing: Possible improper censoring handling or learning rate too high
  - Non-monotonic survival curves: Weibull parameterization broken—check λ, k > 0 constraints
  - Calibration good (low IBS) but discrimination poor (low C-index): Model captures baseline hazard but not covariate effects

- First 3 experiments:
  1. **Baseline validation**: Train on X_LOB only (no agent features, no queue) using standard Transformer. Confirm IAUC ≈ 0.47-0.53 matches paper's ConvTrans baseline.
  2. **Ablation sweep**: Add features incrementally (queue → agent actions → both) with KANFormer+DCC. Verify IAUC progression approximately matches paper: 0.57 → 0.68 → 0.76.
  3. **Calibration check**: Plot predicted vs. observed survival at multiple horizons. Compute IBS across time points; target IBS < 0.028. If calibration poor, inspect Weibull parameter outputs for numerical stability.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the KANFormer framework maintain its predictive superiority when applied to asset classes with different microstructural characteristics, such as individual equities or cryptocurrencies?
- Basis in paper: [explicit] The authors state, "It would be valuable to apply our framework to individual equities across different sectors to investigate how execution likelihood patterns vary between asset classes."
- Why unresolved: The current study is restricted to CAC 40 index futures; execution dynamics may differ significantly in assets with varying liquidity or tick sizes.
- What evidence would resolve it: Benchmarking the model on diverse datasets (e.g., high-cap equities, crypto exchanges) to verify cross-asset robustness.

### Open Question 2
- Question: How does the performance of the continuous Weibull-based KANFormer compare to discrete-time survival models (e.g., PMF or hazard rate approaches) regarding calibration and discrimination?
- Basis in paper: [explicit] The authors note, "Exploring these discrete-time modeling strategies, along with their discretization schemes and associated trade-offs, represents a promising avenue for further development."
- Why unresolved: The current architecture relies on a specific parametric assumption (Weibull), leaving the potential benefits of discrete approximations untested.
- What evidence would resolve it: A comparative analysis replacing the Weibull predictor head with a discrete hazard layer and evaluating metrics like IBS and IAUC.

### Open Question 3
- Question: Can the model retain its discriminatory edge using only publicly observable data, given that the current best results rely on proprietary agent-level statistics?
- Basis in paper: [inferred] The paper states, "These agent-level statistics are not available to individual market participants. Therefore, a single agent cannot use the full model discussed in this work."
- Why unresolved: The superior IAUC (0.76) is achieved using features (agent cancel ratios, etc.) that are opaque to a regular trader, making the practical utility of the full model limited.
- What evidence would resolve it: Evaluating the performance gap between the "oracle" model and a realistic variant restricted to LOB snapshots and order-flow reconstruction.

## Limitations
- Dataset Specificity: Evaluation relies solely on CAC 40 futures data from 2016-2017, limiting generalizability to other assets, markets, or time periods.
- Feature Availability: Agent-level behavioral features require comprehensive trade and order flow data, unavailable for individual traders in practice.
- Implementation Complexity: KAN layers introduce significant hyperparameter tuning complexity not fully specified.

## Confidence
- High: The ablation study results demonstrating IAUC improvements from 0.57 to 0.76 with full feature set and KANs are internally consistent and align with architectural expectations.
- Medium: Outperformance of ConvTrans (RCLL 0.53 vs 0.55) is statistically significant across 30 repetitions, but the absolute performance gap may not translate to all market conditions.
- Low: Claims about KANs providing superior nonlinear approximation lack external validation—no corpus papers demonstrate KAN architectures in financial survival analysis contexts.

## Next Checks
1. **Feature Availability Stress Test**: Evaluate KANFormer performance when agent behavioral features are omitted at inference (realistic scenario). Compare IAUC and RCLL to ConvTrans baseline.
2. **Temporal Robustness Check**: Train and evaluate on disjoint market regimes (pre/post major volatility events, different asset classes). Assess whether IAUC/C-index degrade systematically.
3. **Calibration Consistency**: Generate survival probability calibration plots across multiple horizons. Compute IBS at individual time points to verify that low overall IBS isn't masking poor calibration at specific horizons.