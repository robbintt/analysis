---
ver: rpa2
title: Learning ECG Representations via Poly-Window Contrastive Learning
arxiv_id: '2508.15225'
source_url: https://arxiv.org/abs/2508.15225
tags:
- learning
- epochs
- contrastive
- windows
- size
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces poly-window contrastive learning for ECG representation
  learning, addressing the limitation of conventional two-view methods that fail to
  leverage the rich temporal structure of ECG recordings. The method extracts multiple
  temporal windows from each ECG signal and maximizes similarity across all window
  pairs using statistics such as arithmetic or geometric mean.
---

# Learning ECG Representations via Poly-Window Contrastive Learning

## Quick Facts
- arXiv ID: 2508.15225
- Source URL: https://arxiv.org/abs/2508.15225
- Reference count: 25
- Primary result: AUROC of 0.891 and F1 score of 0.680 in multi-label superclass classification on PTB-XL

## Executive Summary
This work introduces poly-window contrastive learning for ECG representation learning, addressing the limitation of conventional two-view methods that fail to leverage the rich temporal structure of ECG recordings. The method extracts multiple temporal windows from each ECG signal and maximizes similarity across all window pairs using statistics such as arithmetic or geometric mean. Inspired by slow feature analysis, this approach encourages learning of temporally invariant and physiologically meaningful features that persist across cardiac cycles. Evaluated on the PTB-XL dataset, poly-window contrastive learning achieved state-of-the-art performance with AUROC of 0.891 and F1 score of 0.680 in multi-label superclass classification, outperforming conventional two-view methods (AUROC 0.888, F1 0.679). Additionally, it required up to four times fewer pre-training epochs (32 vs. 128) and achieved a 14.8% reduction in total wall clock training time. The framework demonstrates robust performance across various hyperparameters and establishes a scalable paradigm for self-supervised representation learning in biomedical time-series data.

## Method Summary
The method extracts M temporal windows from each 10-second 12-lead ECG recording using random stratified temporal cropping with optimal crop size of 64 timesteps (≈1 cardiac cycle at 100Hz). These windows are passed through a 1D ResNet-18 encoder (512-dim) and projection head (128-dim) to produce embeddings. The poly-window InfoNCE loss aggregates similarities across all M(M-1)/2 window pairs using either arithmetic or geometric mean. During pre-training, no augmentations beyond cropping are applied. For evaluation, the encoder is frozen and a linear classifier is trained on the 512-dim features for 90 epochs using MultiLabelSoftMarginLoss.

## Key Results
- Achieved AUROC of 0.891 and F1 score of 0.680 in multi-label superclass classification on PTB-XL
- Required up to four times fewer pre-training epochs (32 vs. 128) compared to conventional two-view methods
- Achieved 14.8% reduction in total wall clock training time while improving performance

## Why This Works (Mechanism)

### Mechanism 1: Multi-window structure accelerates convergence
Multiple temporal windows per ECG sample provide richer positive pair structure per gradient update. For M windows per sample, each anchor has M-1 positives instead of 1. The loss aggregates these via arithmetic or geometric mean, which reduces gradient estimator variance and improves signal-to-noise ratio in updates. Temporally distant windows from the same ECG share physiologically meaningful features that should be represented identically.

### Mechanism 2: Optimal crop size captures single-beat physiology
Crop size matching one cardiac cycle (~64 timesteps at 100Hz) yields optimal representations because it captures complete physiological dynamics per view. Crops of 64 timesteps approximately span one heartbeat, providing sufficient morphological context without mixing multiple beats. Larger crops may conflate beat-level features; smaller crops lack context.

### Mechanism 3: SFA-inspired temporal invariance
Poly-window aggregation implements slow feature analysis principles by penalizing representations that vary across time within the same recording. By maximizing agreement across temporally diverse windows, the model learns features that change slowly (persistent physiology) while ignoring fast-changing signals (noise, artifacts). Pathological features persist across cardiac cycles while noise does not.

## Foundational Learning

- Concept: Contrastive learning (InfoNCE loss)
  - Why needed here: The entire method builds on InfoNCE; understanding positive/negative pairs and temperature-scaled similarity is prerequisite
  - Quick check question: Can you explain why the denominator in InfoNCE includes all non-anchor samples, and how temperature τ affects the loss?

- Concept: Slow feature analysis (SFA)
  - Why needed here: The paper frames poly-window learning as implementing SFA principles; understanding temporal invariance is key to interpreting results
  - Quick check question: What types of features would SFA prioritize vs. discard in a physiological time series?

- Concept: Linear evaluation protocol
  - Why needed here: All reported metrics come from freezing the pretrained encoder and training only a linear classifier; this is standard but must be understood to interpret what "good performance" means
  - Quick check question: Why does linear evaluation specifically measure representation quality rather than end-task performance?

## Architecture Onboarding

- Component map: 12-lead ECG (1000 timesteps) -> Random temporal crops (64 timesteps) -> 1D ResNet-18 (512-dim) -> Linear projection (128-dim) -> Poly-window InfoNCE loss -> 512-dim encoder features -> Linear classifier

- Critical path:
  1. Crop size selection (η² = 0.5491, largest effect)—start with 64
  2. Window count selection (η² = 0.1526)—start with 8
  3. Batch size tuning—start with 256–512 (diminishing returns above 512)

- Design tradeoffs:
  - More windows = faster convergence but higher per-epoch cost; net wall-clock savings only if early stopping is used
  - Overlap has negligible effect (η² = 0.0063); can be set to 0.5 for convenience
  - Geometric vs. arithmetic loss: arithmetic slightly better mean AUROC but negligible effect size (η² = 0.0075)

- Failure signatures:
  - Performance plateaus early with few windows (2–4) and doesn't improve with more epochs → increase window count
  - Crop sizes 32 or 256 underperform → check if your signal sampling rate differs from 100Hz; recalibrate crop size to ~1 cardiac cycle
  - Memory issues with 8 windows → reduce batch size; the paper reports 12.35GB peak at batch 1024, crop 64 on A100

- First 3 experiments:
  1. Reproduce baseline: 2 windows, crop 64, batch 256, 128 epochs—expect AUROC ~0.888
  2. Validate acceleration: 8 windows, crop 64, batch 256, 32 epochs—expect AUROC ~0.891 with ~14.8% less wall-clock time
  3. Ablate crop size: Test 32, 64, 128, 256 with 8 windows—expect peak at 64; if not, investigate cardiac cycle duration in your data

## Open Questions the Paper Calls Out

- Question: Does the poly-window framework transfer effectively to single-lead ECGs or non-ECG physiologic signals?
  - Basis in paper: The authors state in the conclusion that "effectiveness for single-lead ECG, other physiologic signals... remains unexplored."
  - Why unresolved: The current study was restricted to 12-lead ECGs, which possess spatial redundancy that may not exist in single-lead or non-cardiac time-series data.
  - What evidence would resolve it: Applying the method to wearable single-lead ECG datasets or other signals (e.g., EEG) and benchmarking performance against modality-specific baselines.

- Question: How do alternative optimization algorithms impact the convergence speed and final performance of poly-window contrastive learning?
  - Basis in paper: In the ablation study, the authors note that "The potential influence of alternative optimization algorithms remains an open question for future research."
  - Why unresolved: All experiments used AdamW, but contrastive learning often utilizes different optimizers (e.g., LARS) for large-batch training; it is unclear if the poly-window benefit is optimizer-dependent.
  - What evidence would resolve it: A comparative ablation study using optimizers like LARS or LAMB to measure convergence rate and final AUROC against the AdamW baseline.

- Question: Does the framework generalize to diverse real-world clinical data with different device types and population demographics?
  - Basis in paper: The authors list "generalizability to other ECG cohorts or to real-world data with broader population and device variability is untested" as a limitation.
  - Why unresolved: The model was trained and evaluated exclusively on the PTB-XL dataset, which may not represent the noise profiles or distribution shifts of other clinical settings.
  - What evidence would resolve it: Pre-training on PTB-XL and performing zero-shot or fine-tuned evaluation on external datasets like CODE-15 or Chapman to assess domain shift robustness.

## Limitations
- The temperature parameter τ in the InfoNCE loss is not explicitly reported, affecting reproducibility
- Exact 1D ResNet18 architecture details (kernel sizes, strides, channel dimensions) are omitted
- The "random stratified temporal cropping" implementation is not fully described
- The SFA-inspired mechanism claim is conceptually sound but not directly validated through empirical feature analysis

## Confidence
- High confidence: The poly-window acceleration claim (4x fewer epochs, 14.8% wall-clock reduction) is well-supported by systematic ablation
- Medium confidence: The SFA-inspired mechanism claim is conceptually sound but not directly validated
- Medium confidence: The optimal crop size of 64 timesteps assumes standard 100Hz sampling and ~1 cardiac cycle duration

## Next Checks
1. Replicate the convergence acceleration by pre-training with M=2 vs M=8 windows while holding all other hyperparameters constant, measuring both epoch count and wall-clock time
2. Test crop size sensitivity on ECG data sampled at different frequencies (e.g., 256Hz) to verify whether 64 timesteps remains optimal or requires rescaling
3. Conduct temporal correlation analysis on learned representations to empirically verify that poly-window learning produces features with slower temporal variation compared to conventional two-view methods