---
ver: rpa2
title: Revisiting Follow-the-Perturbed-Leader with Unbounded Perturbations in Bandit
  Problems
arxiv_id: '2508.18604'
source_url: https://arxiv.org/abs/2508.18604
tags:
- perturbations
- ftpl
- distribution
- function
- chet-type
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper explores the relationship between FTPL and FTRL policies
  in multi-armed bandit problems, focusing on achieving Best-of-Both-Worlds (BOBW)
  results with unbounded perturbations. While FTRL has achieved BOBW results through
  hybrid regularizers, analogous results for FTPL have been limited due to analytical
  challenges.
---

# Revisiting Follow-the-Perturbed-Leader with Unbounded Perturbations in Bandit Problems

## Quick Facts
- **arXiv ID**: 2508.18604
- **Source URL**: https://arxiv.org/abs/2508.18604
- **Reference count**: 40
- **Primary result**: Asymmetric unbounded Fréchet-type perturbations achieve Best-of-Both-Worlds (BOBW) results in multi-armed bandits

## Executive Summary
This paper establishes Best-of-Both-Worlds guarantees for Follow-the-Perturbed-Leader (FTPL) with unbounded perturbations in multi-armed bandit problems. While FTRL has achieved BOBW results through hybrid regularizers, analogous results for FTPL have been limited due to analytical challenges. The authors introduce asymmetric Fréchet-type perturbations with lighter left tails than right tails, proving they achieve O(√KT) adversarial regret and O(log T/Δi) stochastic regret. They also investigate the connection between 1/2-Tsallis entropy and symmetric Fréchet-type perturbations, showing these achieve BOBW only in two-armed bandits but fail for K≥3.

## Method Summary
The method implements FTPL with unbounded perturbations: at each round t, sample r_t from a distribution D^K, select arm I_t = argmin_i{L̂_{t,i} - r_{t,i}/η_t} where L̂_t is the cumulative estimated loss, and update using importance-weighted estimators. The key innovation is using asymmetric Fréchet-type perturbations (U_{α,β}) where the left tail index β is at least α+2 heavier than the right tail index α, ensuring boundedness in the stability analysis. The learning rate η_t = m/√t is optimized for both adversarial and stochastic settings.

## Key Results
- Asymmetric Fréchet-type perturbations with β ≥ α+2 achieve O(√KT) adversarial regret and O(log T/Δi) stochastic regret
- Laplace-Pareto perturbation (α=2, β=∞) achieves adversarial regret bounded by 49.25√KT + O(√K + K log T)
- Symmetric Fréchet-type perturbations achieve BOBW only for K=2; they violate key conditions for K≥3
- Numerical evidence suggests 1/2-Tsallis entropy corresponds to a symmetric Fréchet-type perturbation (conjectured but unproven)

## Why This Works (Mechanism)

### Mechanism 1: Asymmetric Tail Control for BOBW Stability
Asymmetric Fréchet-type perturbations with lighter left tails than right tails enable BOBW guarantees for all K≥2. When β ≥ α+2, the negative perturbation terms become bounded during stability analysis, allowing the ratio -ϕ′_i/ϕ_i to be controlled by O(σ_i^{-1/α}) ∧ O(1/(λ_i - λ_{σ_1})). This satisfies the uniform boundedness conditions required for both O(√KT) adversarial regret and logarithmic stochastic regret.

### Mechanism 2: Refined Stability-Penalty Decomposition with Bounded Ratios
Regret decomposes into stability E[⟨ℓ̂_t, w_t - w_{t+1}⟩] and penalty terms. For O(√KT) adversarial regret, uniform bound on -ϕ′_i/ϕ_i^{3/2} is sufficient; for logarithmic stochastic regret, -ϕ′_i/ϕ_i = O(1/λ_i) is required. The asymmetric tail structure ensures these ratios remain bounded across all arms and loss configurations.

### Mechanism 3: Geometric Constraint on Symmetric Perturbation Viability
Symmetric Fréchet-type perturbations achieve BOBW only in K=2 case due to geometric constraints. For K≥3, certain loss configurations (λ = (0, c, ..., c) with c ≥ 2√K) cause -ϕ′_i/ϕ_i to scale as Ω̃(1/(K√K)) and -ϕ′_i/ϕ_i^{3/2} to scale as Ω̃((c+2)/(K√K)), both violating O(1) bounds required for standard BOBW analysis.

## Foundational Learning

- **Fréchet-type distributions and tail indices**: The theoretical framework depends on polynomial tail decay. Tail index α characterizes Pr[X≥x] ≈ x^{-α} behavior—smaller α means heavier tails. β ≥ α+2 ensures left-tail contributions don't destabilize analysis.
  - Quick check: For Fréchet-type with α=2, Pr[X≥x] ~ x^{-2} as x→∞; how does this differ from α=∞ (Gumbel-type)?

- **Regret decomposition: stability vs penalty terms**: All BOBW proofs rely on controlling these terms simultaneously. Stability captures sensitivity to loss updates; penalty captures perturbation cost.
  - Quick check: If -ϕ′_i/ϕ_i is unbounded for some arm i, what happens to stability term? Can penalty term compensate?

- **FTRL-FTPL duality via potential functions**: FTPL with perturbations on R^K corresponds to FTRL with regularizer V via Legendre transformation of Φ(ν) = E[max_i(ν_i + r_i)].
  - Quick check: Why does Hofbauer & Sandholm (2002) show no FTPL counterpart exists for log-barrier regularizer when K≥4?

## Architecture Onboarding

- **Component map**: Perturbation generator -> Cumulative loss tracker -> Arm selector -> Loss estimator -> Learning rate scheduler
- **Critical path**: 1) Sample r_t ~ D^K, 2) Select I_t = argmin_i{L̂_{t,i} - r_{t,i}/η_t}, 3) Observe loss ℓ_{t,I_t}, 4) Estimate inverse probability d_{w^{-1}_{t,I_t}} via geometric resampling, 5) Update L̂_{t+1,I_t}
- **Design tradeoffs**: 
  * Laplace-Pareto (α=2, β=∞): Explicit bound 49.25√KT + O(√K + K log T)
  * Symmetric Pareto shape 2 (α=β=2): BOBW only for K=2, near-optimal O(√KT log K) for K≥3
  * General U_{α,β} with β≥α+2: Broader family achieving BOBW
- **Failure signatures**: 
  * K≥3 with symmetric tails at λ=(0,c,...,c), c≥2√K: -ϕ′_i/ϕ_i grows as Ω̃(1/(K√K))
  * β < α+2 (left tail too heavy): Negative perturbation contributions unbounded
  * Numerical instability when w_{t,i} is very small in geometric resampling
- **First 3 experiments**: 
  1. K=2 stochastic bandit validation with symmetric Pareto (shape 2)
  2. K=3 failure case reproduction at λ=(0,3.5,3.5)
  3. Adversarial scaling comparison: Laplace-Pareto vs symmetric Pareto vs Exp3 for K=10

## Open Questions the Paper Calls Out

1. **Can FTPL with symmetric Fréchet-type perturbations achieve BOBW guarantees for K≥3 using non-standard analysis techniques?**
   - The paper provides a counterexample where standard analysis fails (Proposition 5.5), but suggests alternative techniques might establish general BOBW guarantees.

2. **Does there exist an i.i.d. symmetric distribution that exactly reproduces FTRL with 1/2-Tsallis entropy?**
   - Conjecture 5.2 posits such a distribution based on numerical observations, but formal proof using Bochner's theorem is missing.

3. **Can computationally efficient FTPL policies be designed for complex settings using proposed hybrid perturbations?**
   - The paper identifies designing efficient FTPL counterparts to FTRL policies in complicated settings (combinatorial or linear bandits) as a promising future direction.

## Limitations
- Symmetric Fréchet-type perturbation conjecture remains unproven
- Geometric failure mode for K≥3 symmetric perturbations assumes worst-case adversarial loss sequences
- Explicit regret constants for asymmetric perturbations are not optimized
- Paper focuses exclusively on multi-armed bandits without exploring contextual or combinatorial extensions

## Confidence
- **High**: Asymmetric unbounded perturbations achieving BOBW results (rigorous theoretical analysis)
- **Medium**: Numerical evidence connecting 1/2-Tsallis entropy to symmetric Fréchet-type perturbations (preliminary but suggestive)
- **Medium**: Negative result showing symmetric perturbations fail for K≥3 (supported by proof but relies on worst-case configurations)

## Next Checks
1. Prove the symmetric Fréchet-type perturbation conjecture by establishing that inverse Fourier transform of √ĝ yields the correct symmetric Fréchet-type density
2. Test practical BOBW behavior by implementing asymmetric Laplace-Pareto FTPL on mixed stochastic-adversarial environments
3. Explore alternative symmetric analyses to determine if non-standard BOBW techniques could recover results for symmetric perturbations in K≥3