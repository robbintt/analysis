---
ver: rpa2
title: Conformal Prediction for Image Segmentation Using Morphological Prediction
  Sets
arxiv_id: '2503.05618'
source_url: https://arxiv.org/abs/2503.05618
tags:
- prediction
- sets
- conformal
- segmentation
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses uncertainty quantification in image segmentation
  using conformal prediction, specifically focusing on binary segmentation tasks where
  each pixel is classified as belonging to an object or background. The core contribution
  is a novel method that constructs prediction sets using morphological dilation operations
  on predicted segmentation masks, requiring minimal information - only the binary
  prediction masks are needed, without access to the underlying predictor or its feedback
  (like logits).
---

# Conformal Prediction for Image Segmentation Using Morphological Prediction Sets

## Quick Facts
- **arXiv ID**: 2503.05618
- **Source URL**: https://arxiv.org/abs/2503.05618
- **Reference count**: 40
- **Primary result**: Achieves valid conformal prediction sets for binary image segmentation using only binary prediction masks, with empirical coverage meeting or exceeding 1-α confidence levels across medical imaging datasets

## Executive Summary
This paper introduces a novel conformal prediction method for uncertainty quantification in binary image segmentation that requires minimal information - only binary prediction masks and ground truth. The method constructs prediction sets by applying morphological dilation to predicted segmentation masks, with dilation parameters determined through conformal calibration on held-out data. The approach is particularly valuable because it works without access to model internals like logits, making it applicable to any segmentation model including black-box deep learning approaches.

## Method Summary
The method works by constructing prediction sets through morphological dilation operations on binary segmentation masks. During calibration, for each image the algorithm finds the smallest dilation parameter λ such that the dilated prediction covers at least a threshold τ (typically 0.9) of the ground truth mask. These λ values are then used to compute a conformal quantile λ̂ via the standard (1-α)-quantile formula. At inference time, test predictions are dilated by λ̂ to create prediction sets that guarantee coverage of the ground truth with probability at least 1-α. The method uses standard morphological dilation with structuring elements (typically 3x3 square kernels) and requires only binary masks, making it applicable to any segmentation model.

## Key Results
- Achieves empirical coverage rates meeting or exceeding nominal 90% confidence levels across multiple medical imaging datasets (WBC, OASIS, Polyp datasets)
- Demonstrates competitive performance compared to methods requiring more information (like logits), with average stretch ratios around 1.1 for WBC dataset using UniverSeg
- Shows the method effectively identifies areas likely to contain missed ground-truth pixels, useful for model validation
- Validates that the approach avoids artifacts in conformal margins that can arise from noisy model scores

## Why This Works (Mechanism)
The method leverages conformal prediction theory to provide statistical guarantees about uncertainty quantification. By using morphological dilation, it creates prediction sets that systematically expand around predicted masks to ensure coverage of ground truth. The calibration process determines the appropriate expansion size needed to meet coverage requirements, while the dilation operation naturally creates nested prediction sets. The binary-only requirement is achieved by relying solely on the spatial relationship between predicted and ground truth masks, without needing continuous model scores.

## Foundational Learning
- **Conformal Prediction**: A framework for uncertainty quantification that provides statistical guarantees about prediction sets. Needed because it provides the theoretical foundation for valid coverage. Quick check: Verify that the quantile calculation follows standard CP procedures.
- **Morphological Dilation**: An image processing operation that expands shapes by adding pixels to boundaries. Needed because it provides a natural way to create prediction sets by expanding predicted masks. Quick check: Confirm that dilation operations correctly implement the structuring element.
- **Binary Segmentation**: Image segmentation task where each pixel is classified as belonging to an object or background. Needed because the method is specifically designed for this setting. Quick check: Ensure all masks are properly binarized before processing.

## Architecture Onboarding

**Component Map:** Calibration Data -> Nonconformity Scores (λ values) -> Quantile Calculation -> Test Prediction Dilation -> Prediction Sets

**Critical Path:** The most critical sequence is calibration loop → quantile calculation → dilation application. Any error in computing λ values or selecting the correct quantile will directly impact coverage validity.

**Design Tradeoffs:** The method trades computational efficiency for minimal information requirements. While requiring multiple dilation iterations during calibration, it avoids needing access to model internals, making it more broadly applicable but potentially slower than score-based methods.

**Failure Signatures:** Coverage below 1-α indicates incorrect quantile calculation or pathological λ values. Excessive stretch suggests poor predictor performance or τ set too high. Empty masks causing division by zero need special handling.

**3 First Experiments:**
1. Run calibration on a small subset with known predictor performance to verify λ distribution
2. Test quantile calculation with different α values to ensure proper coverage
3. Apply dilation with various structuring elements to observe impact on stretch

## Open Questions the Paper Calls Out
- **Multi-class extension**: The authors note extending to multi-class and instance segmentation as a promising next step, as the current binary formulation doesn't directly apply to scenarios with multiple classes or disjoint object instances.
- **Adaptive prediction sets**: The paper suggests exploring mathematical morphology tools to build adaptive sets that vary margin size based on input difficulty, addressing the current limitation of applying a global dilation parameter to all images.
- **Combining with score-based methods**: The authors propose investigating hybrid approaches that combine morphological dilation with score-based thresholding to leverage the complementary strengths of both methods.

## Limitations
- Binary segmentation only: The method is specifically designed for binary tasks and requires modification for multi-class scenarios
- Performance dependent on predictor quality: Extremely poor predictors (IoU near zero) can cause pathological dilation parameters
- Requires calibration data: Needs access to ground truth masks for calibration, which may not always be available

## Confidence

**High confidence:**
- Conformal validity guarantee is mathematically sound given the assumptions
- Empirical coverage results showing meeting or exceeding 1-α levels

**Medium confidence:**
- Generalization to other domains beyond tested medical imaging datasets
- Minimal information requirement claim, though calibration data is still needed

## Next Checks
1. Test the method on multi-class segmentation tasks by applying it independently to each class channel
2. Evaluate performance on datasets with extremely small or fragmented objects to assess edge case behavior
3. Test whether calibration parameters learned on one dataset transfer to another dataset with different characteristics