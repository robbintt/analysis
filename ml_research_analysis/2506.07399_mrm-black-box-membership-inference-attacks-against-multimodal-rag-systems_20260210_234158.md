---
ver: rpa2
title: 'MrM: Black-Box Membership Inference Attacks against Multimodal RAG Systems'
arxiv_id: '2506.07399'
source_url: https://arxiv.org/abs/2506.07399
tags:
- image
- membership
- multimodal
- inference
- retrieval
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: MrM introduces the first black-box membership inference attack
  framework targeting multimodal RAG systems, addressing the challenge of inferring
  membership status from purely textual responses while ensuring successful retrieval.
  The core idea is to use object-aware data perturbation to mask critical regions,
  combined with a counterfact-informed mask selection strategy to maximize discriminative
  signals, followed by statistical membership inference based on response patterns.
---

# MrM: Black-Box Membership Inference Attacks against Multimodal RAG Systems

## Quick Facts
- arXiv ID: 2506.07399
- Source URL: https://arxiv.org/abs/2506.07399
- Reference count: 40
- Primary result: Achieves AUC up to 0.99 and TPR@5%FPR up to 74.98% in black-box MIAs against multimodal RAG systems

## Executive Summary
MrM introduces the first black-box membership inference attack targeting multimodal retrieval-augmented generation systems. The core challenge is inferring membership status from purely textual responses while ensuring successful retrieval. MrM addresses this through object-aware data perturbation combined with counterfact-informed mask selection and statistical inference. Experiments across two visual datasets and eight commercial VLMs demonstrate consistently high performance, outperforming baseline methods and remaining robust under adaptive defenses.

## Method Summary
MrM operates in three stages: first, it uses an object detector (SAM2) to identify and mask semantically rich objects in target images; second, a proxy VLM (Qwen-VL-7B) evaluates mask difficulty to select the most informative perturbations; finally, it queries the black-box RAG system repeatedly until correct object identification, modeling the trial counts as geometric distributions to perform statistical hypothesis testing for membership inference. The attack assumes success probabilities differ between member and non-member images, with lower total trial counts indicating membership.

## Key Results
- Achieves AUC scores up to 0.99 across commercial VLMs
- TPR@5%FPR reaches 74.98% on multimodal RAG systems
- Maintains effectiveness under adaptive defenses
- Outperforms baseline methods in all tested scenarios

## Why This Works (Mechanism)

### Mechanism 1: Object-Aware Data Perturbation
The attack masks semantically rich objects detected by SAM while preserving enough global image structure for retrieval. This forces the VLM to rely on retrieved context rather than pre-trained knowledge to "fill in" missing object semantics, creating a discriminative signal between member and non-member images.

### Mechanism 2: Counterfact-Informed Mask Selection
A proxy VLM prioritizes "hard" masks by evaluating prediction uncertainty (entropy, confidence gap). This suppresses confounding effects of the target VLM's self-knowledge, ensuring correct predictions stem from retrieved references rather than internal parametric knowledge.

### Mechanism 3: Statistical Membership Inference
The attack models query trial counts as geometric distributions, summing them to approximate normality. Lower total trial counts indicate higher success probability for members, enabling robust hypothesis testing that aggregates weak signals across multiple queries.

## Foundational Learning

- **Multimodal RAG**: Architecture combining retriever (CLIP-based) and VLM to generate answers using both input and retrieved context. Needed to understand attack target and data flow. Quick check: Which component (retriever or VLM) is the primary target of membership inference?
- **Membership Inference Attacks**: Binary classification framework determining if data point was in training set or retrievable database. Needed to understand attack objective. Quick check: In RAG context, does "member" refer to pre-training data or external database?
- **Hypothesis Testing & Geometric Distribution**: Statistical framework modeling repeated trials until success as geometric distribution, then approximating sum as normal. Needed to interpret attack's decision logic. Quick check: Why model trials-to-success as geometric, and what does low total trial count suggest?

## Architecture Onboarding

- **Component map**: Target image -> SAM2 (object detection) -> Perturbation module (masking) -> Counterfact proxy (Qwen-VL-7B) -> Mask selection -> Attack query engine (RAG system) -> Statistical inference module
- **Critical path**: Counterfact-informed mask selection is the linchpin; poor mask choices make member and non-member responses indistinguishable, causing statistical test failure
- **Design tradeoffs**: Perturbation strength balances retrieval preservation vs. generation dependency; proxy model fidelity vs. attack cost; query budget vs. efficiency and detection risk
- **Failure signatures**: High false positives suggest mask selection not filtering "easy" objects; low true positives indicate retrieval failure from aggressive masking; high variance suggests unstable VLM generation
- **First 3 experiments**: 1) Validate object-awareness by comparing object-aware vs. random vs. no masking; 2) Ablate mask selection by comparing counterfact-informed vs. random selection; 3) Test set-level aggregation with varying K values (1,5,10,20)

## Open Questions the Paper Calls Out
- Domain-specific datasets: How does MrM perform on specialized domains like medical or satellite imagery with high inter-image similarity? (Section 4.5 states current evaluation limited to COCO/Flickr)
- Proxy model dependence: How does choice of counterfactual proxy model affect informativeness scoring and attack success? (Section 4.3 relies on Qwen-VL but impact of mismatch not quantified)
- Object availability: How robust is object-aware perturbation for images lacking distinct, discrete objects? (Section 4.2 assumes salient objects exist)

## Limitations
- Query trial cost and handling of non-convergent cases not specified
- Proxy model dependence assumes correlation between proxy and target uncertainty
- Adaptive defense robustness lacks detailed experimental validation

## Confidence
- **High Confidence**: Overall attack framework soundness and reported performance metrics
- **Medium Confidence**: Counterfact-informed mask selection improvement depends on unvalidated proxy-target correlation
- **Medium Confidence**: Adaptive defense robustness claims lack detailed validation

## Next Checks
1. **Ablation on Mask Selection**: Compare counterfact-informed vs. random vs. entropy-only mask selection to test proxy's discriminative value
2. **Adaptive Defense Simulation**: Implement simple adaptive defense (filtering occluded/irrelevant objects) and measure performance drop
3. **Proxy-Target Correlation Analysis**: Quantify correlation between proxy and target VLM confidence scores on validation set