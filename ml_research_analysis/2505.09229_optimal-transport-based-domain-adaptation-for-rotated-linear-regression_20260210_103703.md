---
ver: rpa2
title: Optimal Transport-Based Domain Adaptation for Rotated Linear Regression
arxiv_id: '2505.09229'
source_url: https://arxiv.org/abs/2505.09229
tags:
- domain
- rotation
- target
- optimal
- angle
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "The paper proposes a domain adaptation method for linear regression\
  \ under rotational shifts using optimal transport (OT). The method leverages the\
  \ theoretical result that OT with p-norm cost (p\u22652) recovers the underlying\
  \ rotation in R\xB2, enabling accurate estimation of the rotation angle between\
  \ source and target domains."
---

# Optimal Transport-Based Domain Adaptation for Rotated Linear Regression

## Quick Facts
- arXiv ID: 2505.09229
- Source URL: https://arxiv.org/abs/2505.09229
- Reference count: 0
- Primary result: OT with p-norm cost (p ≥ 2) recovers rotation in R², enabling domain adaptation for linear regression under rotational shifts

## Executive Summary
This paper proposes a domain adaptation method for linear regression under rotational shifts using optimal transport (OT). The method leverages the theoretical result that OT with p-norm cost (p≥2) recovers the underlying rotation in R², enabling accurate estimation of the rotation angle between source and target domains. The algorithm combines K-means clustering, OT, and SVD to estimate the rotation and adapt the regression model, particularly effective when target data is sparse. Simulations show that the method outperforms standard linear regression on the target domain alone, with median performance improving as the source-to-target data ratio increases. Results are especially strong under high noise levels and rotation angles near π/2. The approach demonstrates practical utility in scenarios where abundant source data can guide adaptation in data-scarce target domains.

## Method Summary
The method addresses domain adaptation for linear regression when source and target domains are related by an unknown rotation. Given abundant source data (ns) and sparse target data (nt), the algorithm first fits a regression model on the source domain. It then uses bootstrap sampling to create multiple subsets, applies K-means clustering to reduce source cardinality to match the target, and computes an optimal transport plan between centroids and target points. The OT solution with p-norm cost (p ≥ 2) provides correspondences that, via SVD, reveal the rotation angle. The source regression coefficients are transformed using this estimated rotation, and the final adapted model is obtained by aggregating results across bootstrap iterations using the median. This approach exploits the geometric property that OT with appropriate cost recovers the true rotation, enabling effective adaptation even with limited target data.

## Key Results
- OT with p-norm cost (p ≥ 2) uniquely recovers rotation transformations between point sets in R²
- K-means clustering of source data creates pseudo-correspondences that approximate rotation structure when cardinalities differ
- Bootstrap sampling with median aggregation provides robust rotation estimates despite significant outliers
- Method outperforms target-only linear regression, especially when source-to-target ratio is high and noise levels are elevated
- Best performance observed for rotation angles near π/2, with weaker results near 0 or π

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** The optimal transport map with p-norm cost (p ≥ 2) uniquely recovers the rotation transformation between source and target point sets in R².
- **Mechanism:** When source and target domains are related by rotation Rθ, the OT solution with p-norm cost identifies a bijective mapping where each source point transports to its exact rotated counterpart, not merely to a nearby point. This geometric property enables extraction of θ via SVD on the resulting point correspondences.
- **Core assumption:** Source and target are related *purely* by rotation (no translation, scaling, or non-rigid deformation); uniform empirical measures; equal cardinalities for the theoretical guarantee.
- **Evidence anchors:** [abstract]: "We show that in R², when using a p-norm cost with p ≥ 2, the optimal transport map recovers the underlying rotation." [section 2.1]: Proposition stating T((xs_i, ys_i)) = Rθ(xs_i, ys_i) for all i; uniqueness of the optimal transport map.

### Mechanism 2
- **Claim:** K-means clustering with K = nt creates pseudo-correspondences that approximate the rotation structure when source and target cardinalities differ (ns ≫ nt).
- **Mechanism:** K-means partitions the abundant source data into nt clusters; centroids inherit the geometric structure of the source distribution. OT then matches these nt centroids to the nt target points, approximating the rotation even though the centroid set is not strictly a rotated version of the target.
- **Core assumption:** Centroids preserve enough geometric information for OT to approximate the true rotation; the underlying linear structure is maintained after clustering.
- **Evidence anchors:** [section 2.1]: "Although Dt and Dk are not strictly related by a rotation, the optimal transport map T approximates the rotation." [algorithm 1]: Explicit K-means step with n_clusters = nt before OT.

### Mechanism 3
- **Claim:** Bootstrap sampling combined with median aggregation provides robust rotation estimates despite significant outliers in individual OT-based angle estimates.
- **Mechanism:** Multiple bootstrap samples produce different K-means centroid configurations, yielding varied rotation estimates. The median across estimates reduces the influence of outlier failures (e.g., from poor centroid placements or noise), providing a more reliable central tendency than the mean.
- **Core assumption:** Outliers are asymmetrically distributed; median is a more robust estimator than mean for this procedure.
- **Evidence anchors:** [section 2.2, algorithm 2]: Bootstrap sampling with proportion p, N repetitions; median aggregation of coefficients. [section 2.2]: "We employ the median instead of the mean, as the procedure has significant outliers."

## Foundational Learning

- **Concept: Optimal Transport (Monge-Kantorovich formulation)**
  - **Why needed here:** Core mechanism for aligning source and target distributions; understanding transport plans and cost functions is essential to grasp why p ≥ 2 recovers rotations.
  - **Quick check question:** Given two point sets in R² with equal cardinality, what does an optimal transport plan minimize, and what does each entry in the coupling matrix represent?

- **Concept: K-means clustering**
  - **Why needed here:** Used to reduce source cardinality to match target size while preserving geometric structure; understanding centroid behavior is critical for diagnosing failure cases.
  - **Quick check question:** What objective does K-means minimize, and how does changing K affect the granularity of the partition?

- **Concept: SVD for rotation estimation (Procrustes/Orthogonal Procrustes)**
  - **Why needed here:** After OT provides correspondences, SVD (per Arun et al., 1987) extracts the rotation angle; understanding this connection is necessary for implementation and debugging.
  - **Quick check question:** Given two matched point sets X and Y in R², what does SVD of YXᵀ reveal about the optimal rotation aligning X to Y?

## Architecture Onboarding

- **Component map:** Input (Ds, Dt) -> Bootstrap Sampler -> K-means Module -> OT Solver -> Correspondence Extractor -> SVD Rotation Estimator -> Regression Adapter -> Aggregator
- **Critical path:** 1. Fit initial regression on Ds → (as, bs) 2. For each bootstrap iteration: sample → K-means → OT → SVD → θ̂ → rotate coefficients 3. Aggregate: median of N coefficient pairs → final adapted model
- **Design tradeoffs:**
  - K selection: Setting K = nt matches target size; smaller K loses structural detail, larger K is not applicable
  - Bootstrap proportion p: Larger p preserves more structure but reduces centroid diversity; smaller p increases variance
  - Number of repetitions N: More iterations stabilize median but increase compute
  - p-norm choice: Theory requires p ≥ 2; practical differences among p = 2, 3, ... not explored
- **Failure signatures:**
  - High outlier rate in angle estimates: Visible in boxplots; may originate from poor centroid placements or noisy target points
  - Degraded performance at small ns/nt ratios: Method provides no benefit when source and target are similarly sized
  - Weak performance near θ ≈ 0 or π: Best results near θ ≈ π/2; linear regression on target alone may already suffice for small rotations
  - Unexpectedly poor results under low noise: Simulation shows stronger gains at higher σ; mechanism unclear
- **First 3 experiments:**
  1. Replicate cardinality sweep: Fix θ = π/4, nt = 10, σ = 1; vary ns from 10 to 10⁶; plot median MSE vs. ns/nt ratio to confirm asymptotic improvement and identify minimum effective ratio
  2. Map angle-noise performance landscape: Fix ns = 1000, nt = 50; vary θ ∈ [π/6, 5π/6] and σ ∈ [0.1, 5]; compute MSE improvement metric to identify regions of strongest and weakest performance
  3. Diagnostic outlier analysis: For a fixed (ns, nt, θ, σ) configuration, log individual θ̂ estimates across N = 1000 iterations; analyze which bootstrap samples or centroid configurations produce outliers to understand failure modes

## Open Questions the Paper Calls Out
- Can the algorithm be modified to reduce the frequency of significant outliers in the rotation estimation without compromising the median performance?
- Does the theoretical guarantee that the optimal transport map recovers the underlying rotation hold in higher dimensions (ℝⁿ)?
- How can the framework be expanded to estimate and correct for translation in addition to rotation?

## Limitations
- Theoretical guarantee of rotation recovery via OT is established only for equal-sized point sets in R²
- Performance gains are particularly strong under high noise levels, but the mechanism for why noise improves adaptation is unclear
- Method provides no benefit when source and target have similar sizes, limiting its applicability

## Confidence
- **High:** The core mechanism that OT with p-norm cost (p ≥ 2) recovers rotation in R² for equal-sized sets is theoretically established and clearly demonstrated
- **Medium:** The K-means-OT pipeline for unequal cardinalities is empirically validated but relies on an unproven approximation that centroids preserve rotational structure
- **Medium:** Bootstrap median aggregation effectively mitigates outlier effects, though the outlier rate and its sources are not fully characterized

## Next Checks
1. Replicate cardinality sweep: Fix θ = π/4, nt = 10, σ = 1; vary ns from 10 to 10⁶; plot median MSE vs. ns/nt ratio to confirm asymptotic improvement and identify minimum effective ratio
2. Map angle-noise performance landscape: Fix ns = 1000, nt = 50; vary θ ∈ [π/6, 5π/6] and σ ∈ [0.1, 5]; compute MSE improvement metric to identify regions of strongest and weakest performance
3. Diagnostic outlier analysis: For a fixed (ns, nt, θ, σ) configuration, log individual θ̂ estimates across N = 1000 iterations; analyze which bootstrap samples or centroid configurations produce outliers to understand failure modes