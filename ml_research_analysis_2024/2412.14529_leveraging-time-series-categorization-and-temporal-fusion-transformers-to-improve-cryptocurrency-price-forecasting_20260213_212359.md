---
ver: rpa2
title: Leveraging Time Series Categorization and Temporal Fusion Transformers to Improve
  Cryptocurrency Price Forecasting
arxiv_id: '2412.14529'
source_url: https://arxiv.org/abs/2412.14529
tags:
- time
- price
- subseries
- series
- each
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses cryptocurrency price prediction using time
  series categorization and Temporal Fusion Transformers (TFTs). The authors categorize
  financial time series into subseries with similar behavior and train separate TFT
  models for each category.
---

# Leveraging Time Series Categorization and Temporal Fusion Transformers to Improve Cryptocurrency Price Forecasting

## Quick Facts
- arXiv ID: 2412.14529
- Source URL: https://arxiv.org/abs/2412.14529
- Reference count: 31
- Primary result: Achieved 3.16% profit over two weeks in simulated trading, outperforming LSTM and simple TFT baselines

## Executive Summary
This paper addresses cryptocurrency price prediction using time series categorization and Temporal Fusion Transformers (TFTs). The authors categorize financial time series into subseries with similar behavior and train separate TFT models for each category. To address limited training data, they combine subseries from multiple cryptocurrencies. A Markov chain-based selector model predicts which category the next subseries belongs to, enabling selection of the appropriate TFT model. The method achieved 3.16% profit over two weeks in a simulated trading environment, outperforming baselines including LSTM and simple TFT models. The proposed approach improves profitability in cryptocurrency trading by leveraging temporal patterns and categorization without requiring extensive historical data or additional financial covariates.

## Method Summary
The method converts cryptocurrency price series to volatility rates, segments them into 7-minute subseries, and categorizes these based on directional patterns (2^7 possible states). Separate TFT models are trained for each category, and a Markov chain selector predicts the next category to route data to the appropriate model. To address limited training data, subseries from multiple cryptocurrencies are pooled under the same category label. The system uses OHLCV data from 13 currency pairs at 1-minute intervals over 18 months, and evaluates performance through simulated trading profitability.

## Key Results
- Achieved 3.16% profit over two weeks in simulated trading environment
- Outperformed baseline LSTM and simple TFT models
- Demonstrated that category selector accuracy directly impacts profitability (79% selector accuracy yielded 3.16% profit vs 100% selector accuracy potentially yielding 148% profit)

## Why This Works (Mechanism)

### Mechanism 1
Categorizing time series into behaviorally similar subseries allows separate TFT models to specialize and improve prediction accuracy. The method segments each cryptocurrency's price volatility time series into subseries of 7-minute intervals, categorizes them based on directional patterns, and trains dedicated TFT models per category. This specialization lets each model focus on a narrow behavioral pattern rather than a broad, mixed signal.

### Mechanism 2
Using a Markov chain-based selector model predicts the next category and routes data to the appropriate TFT model. After observing a subseries, the Markov chain estimates transition probabilities between categories and selects the TFT model most likely to predict the next moment accurately.

### Mechanism 3
Combining subseries from multiple cryptocurrencies increases training data per category, improving TFT model robustness. Subseries from different coins with similar volatility patterns are pooled under the same category label, expanding the sample size and variance exposure for each TFT model.

## Foundational Learning

- **Time series volatility normalization**
  - Why needed here: Raw price values vary widely across cryptocurrencies; normalizing to volatility rates ensures the model focuses on relative movements, not absolute price levels.
  - Quick check question: If Bitcoin moves from $26,750 to $26,850 and later from $71,500 to $71,600, will the volatility rate be the same?

- **Transformer-based sequence modeling**
  - Why needed here: TFTs use attention mechanisms to capture temporal dependencies across multiple horizons, which is critical for multi-step cryptocurrency price forecasting.
  - Quick check question: In a TFT, what does the "chunk-length" parameter control?

- **Categorization vs clustering in time series**
  - Why needed here: The paper explicitly avoids clustering because it can group subseries with different behaviors into the same cluster; instead, it uses rule-based categorization based on directional patterns.
  - Quick check question: Why does k-means clustering fail to preserve behavioral similarity in this context?

## Architecture Onboarding

- **Component map**: Data preprocessor → volatility rate converter → subseries splitter → multi-coin merger → category labeler → category-specific TFT models + Markov selector → prediction pipeline
- **Critical path**: 
  1. Preprocess raw OHLCV data to volatility rates
  2. Segment into 7-minute subseries
  3. Merge across cryptocurrencies
  4. Assign category labels (2^7 possible)
  5. Train one TFT per category
  6. Build Markov selector from observed transitions
  7. For prediction: detect category → select TFT → output next step
- **Design tradeoffs**:
  - More categories → more specialized models but less training data per model
  - Including covariates could improve accuracy but adds noise if correlation is low
  - Selector accuracy is crucial; a poor selector can negate benefits of categorization
- **Failure signatures**:
  - Low selector accuracy → wrong TFT model chosen → degraded predictions
  - Overfitting in TFT models → poor generalization to unseen subseries
  - Category imbalance → some TFT models trained on too little data
- **First 3 experiments**:
  1. Baseline: Single TFT on full volatility series without categorization
  2. Categorization only: Train separate TFTs per category, but use perfect selector (oracle) to measure upper bound
  3. Full pipeline: Categorization + Markov selector, evaluate selector accuracy and overall profitability

## Open Questions the Paper Calls Out

1. How does the accuracy of the selector model affect the overall profitability of the trading strategy?
2. How would the inclusion of financial covariates in the TFT models affect the accuracy and profitability of the trading strategy?
3. How does the generalizability of the proposed approach extend to other financial markets, such as Forex, commodities, or the stock market?

## Limitations

- Evaluation based on simulated trading rather than real-market testing, potentially missing slippage and liquidity constraints
- Short evaluation period (two weeks) may not generalize across different market regimes
- Fixed 7-minute subseries length and 2^7 categories may not capture complex temporal dependencies
- Markov chain selector assumes category transitions follow Markov property, which may not hold during regime shifts

## Confidence

**High Confidence Claims:**
- Technical approach of categorizing time series and using separate TFTs per category is methodologically sound
- Using volatility rates instead of absolute prices for normalization is valid and appropriate
- General architecture combining categorization with model selection is coherent and implementable

**Medium Confidence Claims:**
- Reported 3.16% profit improvement over baselines is likely accurate for the specific dataset and conditions tested
- Claim that combining data across cryptocurrencies improves training is plausible
- Assertion that this approach outperforms LSTM and simple TFT baselines is reasonable

**Low Confidence Claims:**
- Profitability claims in real trading conditions without accounting for transaction costs and slippage
- Long-term stability of the categorization approach across different market regimes
- Generalizability of results to other cryptocurrency pairs or traditional financial assets

## Next Checks

1. Implement an independent evaluation of the Markov chain selector's accuracy in predicting the next category, measuring both top-1 and top-2 selection accuracy across different market conditions.

2. Run the full pipeline across multiple distinct market periods (bull, bear, and sideways markets) to assess whether the categorization approach maintains performance when market dynamics shift significantly.

3. Incorporate realistic transaction costs (spreads, fees) and slippage models into the simulated trading environment to evaluate whether the reported profitability remains positive after accounting for real-world trading frictions.