---
ver: rpa2
title: 'COCOA: CBT-based Conversational Counseling Agent using Memory Specialized
  in Cognitive Distortions and Dynamic Prompt'
arxiv_id: '2402.17546'
source_url: https://arxiv.org/abs/2402.17546
tags:
- cognitive
- technique
- score
- memory
- conversation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper introduces CoCoA, a conversational counseling agent\
  \ based on Cognitive Behavioral Therapy (CBT) that identifies and addresses cognitive\
  \ distortions in client statements. The system employs a dual-memory architecture\u2014\
  Basic Memory for storing personal insights and Cognitive Distortion Memory for tracking\
  \ identified distortions\u2014and uses dynamic prompting to flexibly apply CBT techniques."
---

# COCOA: CBT-based Conversational Counseling Agent using Memory Specialized in Cognitive Distortions and Dynamic Prompt

## Quick Facts
- arXiv ID: 2402.17546
- Source URL: https://arxiv.org/abs/2402.17546
- Reference count: 33
- Outperforms baselines (GPT-3.5-turbo, Llama-2-7B-chat, Vicuna-7B) on CBT Validity and Accuracy metrics with statistically significant improvements

## Executive Summary
This paper introduces CoCoA, a conversational counseling agent based on Cognitive Behavioral Therapy (CBT) that identifies and addresses cognitive distortions in client statements. The system employs a dual-memory architecture—Basic Memory for storing personal insights and Cognitive Distortion Memory for tracking identified distortions—and uses dynamic prompting to flexibly apply CBT techniques. Evaluations using dialogues between CoCoA and AI-generated personas from Character.ai showed that CoCoA outperformed baselines on CBT Validity and Accuracy metrics, with statistically significant improvements across most evaluation criteria.

## Method Summary
CoCoA implements a dual-memory architecture with Basic Memory storing personal insights extracted from client utterances and Cognitive Distortion Memory tracking identified cognitive distortions. The system uses dynamic prompting that first determines the optimal CBT technique, then specifies the CBT stage, and finally generates responses based on these determinations. Evaluations compared CoCoA against GPT-3.5-turbo, Llama-2-7B-chat, and Vicuna-7B using dialogues with Character.ai personas. The system was assessed on five criteria: CBT Validity, CBT Appropriateness, CBT Accuracy, ES Appropriateness, and Stability using GPT-3.5-turbo scoring.

## Key Results
- CoCoA achieved higher CBT Validity scores compared to all baselines
- Statistically significant improvements in CBT Accuracy across most evaluation metrics
- Demonstrated better Stability in maintaining performance during extended conversations
- Showed superior CBT Appropriateness in selecting relevant counseling techniques

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Dynamic prompt composition improves CBT technique application accuracy.
- Mechanism: By first determining the CBT technique to apply, then specifying the CBT stage, and finally generating responses based on these determinations, the system ensures contextually relevant and accurate responses.
- Core assumption: The LLM can effectively retrieve and process information from memory to make these determinations.
- Evidence anchors: [abstract] "dynamic prompting to flexibly apply CBT techniques and facilitate the appropriate retrieval of information"; [section 2.3.2] "Dynamic prompt is composed of three main processes: (1) determining the optimal CBT technique, (2) specifying the CBT stage to apply, and (3) generating responses based on these determinations"
- Break condition: If the LLM fails to accurately retrieve relevant information from memory or if the retrieved information is not sufficient to make informed decisions about CBT technique and stage.

### Mechanism 2
- Claim: Dual-memory architecture enhances counseling effectiveness by organizing information efficiently.
- Mechanism: Basic Memory stores personal insights extracted from client utterances, while Cognitive Distortion Memory specifically tracks identified cognitive distortions. This separation allows for efficient retrieval and application of relevant information during counseling.
- Core assumption: Separating memory into personal insights and cognitive distortions improves the system's ability to identify and address core beliefs.
- Evidence anchors: [abstract] "construct a memory system to efficiently manage information necessary for counseling while extracting high-level insights about the client from their utterances"; [section 2.2] "Each time client utterances are received, the system draws insights from them and stores insights in the Basic Memory. If any cognitive distortions are identified during the conversation, they are saved in the Cognitive Distortion Memory."
- Break condition: If the system fails to accurately extract insights or identify cognitive distortions, or if the separation of memory types does not improve retrieval efficiency.

### Mechanism 3
- Claim: Character.ai personas provide a viable alternative for evaluating counseling agents in the absence of real client data.
- Mechanism: By using AI-generated personas that simulate well-known personalities, the system can conduct counseling sessions and evaluate its performance based on these interactions.
- Core assumption: AI-generated personas can adequately simulate the complexity and variability of human client responses.
- Evidence anchors: [abstract] "We conducted dialogues between CoCoA and characters from Character.ai, creating a dataset for evaluation."; [section 3.2] "We opted to use a character.ai chatbot service to play the role of the client."
- Break condition: If the AI personas fail to accurately simulate human client behavior or if the interactions do not provide meaningful data for evaluating the counseling agent's performance.

## Foundational Learning

- Concept: Cognitive Behavioral Therapy (CBT) techniques and cognitive distortions
  - Why needed here: Understanding CBT principles is crucial for designing and evaluating a CBT-based counseling agent.
  - Quick check question: Can you explain the difference between cognitive restructuring and behavioral activation in CBT?

- Concept: Memory management and retrieval systems
  - Why needed here: The system's effectiveness relies on its ability to efficiently store, retrieve, and utilize information from memory.
  - Quick check question: How does the dual-memory architecture improve the system's ability to identify and address cognitive distortions?

- Concept: Dynamic prompting and chain-of-thought reasoning
  - Why needed here: These techniques enable the system to generate contextually relevant and accurate responses by considering intermediate steps in the counseling process.
  - Quick check question: How does dynamic prompting differ from static prompting in this context?

## Architecture Onboarding

- Component map: Client utterance -> Memory Management (Basic Memory, Cognitive Distortion Memory) -> Prompt Composition (Static Prompt, Dynamic Prompt) -> LLM Model -> Response generation
- Critical path: Client utterance → Memory Management → Prompt Composition → LLM processing → Response generation
- Design tradeoffs:
  - Memory separation vs. unified memory structure
  - Dynamic prompting complexity vs. static prompting simplicity
  - Use of AI personas vs. real client data for evaluation
- Failure signatures:
  - Inaccurate memory retrieval leading to inappropriate CBT technique selection
  - Static prompts not providing sufficient context for response generation
  - AI personas not adequately simulating human client behavior
- First 3 experiments:
  1. Evaluate the accuracy of memory retrieval and CBT technique selection with a small dataset of client utterances.
  2. Compare the performance of dynamic prompting vs. static prompting in generating appropriate responses.
  3. Assess the validity of using AI personas for evaluation by comparing results with a small set of real client interactions.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How would CoCoA perform with real human clients versus AI-generated personas from Character.ai?
- Basis in paper: [explicit] The paper notes that due to limited availability of counseling datasets from human clients, they used Character.ai to simulate clients, suggesting this as a limitation.
- Why unresolved: The evaluation was conducted using AI-generated personas, which may not accurately represent human client behavior and responses in real counseling scenarios.
- What evidence would resolve it: Testing CoCoA with actual human clients in controlled counseling sessions and comparing performance metrics with those obtained from AI-generated personas.

### Open Question 2
- Question: What is the optimal weighting scheme for the recency, frequency, and severity factors in determining which cognitive distortion to prioritize for treatment?
- Basis in paper: [explicit] The paper uses equal weights (α=1) for all three factors but doesn't explore whether this is optimal.
- Why unresolved: The paper states that "all αs to 1" was chosen but doesn't provide justification or exploration of alternative weighting schemes.
- What evidence would resolve it: Empirical testing of different weighting combinations through ablation studies to determine which produces the best counseling outcomes.

### Open Question 3
- Question: How does CoCoA's performance scale with longer conversation histories and more complex cases requiring multiple CBT techniques?
- Basis in paper: [inferred] The Stability evaluation criterion mentions maintaining performance during "relatively long conversations," and the CBT technique determination process involves retrieving memories, suggesting potential scaling challenges.
- Why unresolved: The paper doesn't report results for conversations longer than what was tested, nor does it analyze performance degradation over extended interactions.
- What evidence would resolve it: Longitudinal studies with extended counseling sessions and cases requiring multiple CBT technique applications to measure performance consistency.

## Limitations
- Evaluation methodology relies on AI-generated personas rather than human clients, which may not capture real-world counseling complexity
- Specific implementation details of memory retrieval and prompt composition are not fully specified
- Statistical significance is reported but effect sizes and practical significance are not detailed

## Confidence

**High Confidence:** The dual-memory architecture and dynamic prompting approach are technically sound and logically structured for CBT application. The framework for identifying and addressing cognitive distortions follows established CBT principles.

**Medium Confidence:** The reported performance improvements over baseline models are likely valid, though the evaluation methodology using AI personas introduces uncertainty about real-world applicability. The statistical significance claims are credible but lack detailed effect size reporting.

**Low Confidence:** The system's effectiveness with actual human clients cannot be determined from current results. The long-term stability and adaptability of the memory system across diverse counseling scenarios remains unproven.

## Next Checks

1. **Real Client Validation:** Conduct a small-scale study with actual counseling clients to compare CoCoA's performance against human therapists and validate the AI persona evaluation methodology.

2. **Memory Retrieval Accuracy Test:** Implement controlled experiments testing the accuracy and relevance of memory retrieval across diverse counseling scenarios, measuring precision and recall of both Basic Memory and Cognitive Distortion Memory.

3. **Cross-Technique Transferability:** Evaluate the system's ability to seamlessly transition between different CBT techniques during extended counseling sessions, measuring the coherence and effectiveness of technique switching.