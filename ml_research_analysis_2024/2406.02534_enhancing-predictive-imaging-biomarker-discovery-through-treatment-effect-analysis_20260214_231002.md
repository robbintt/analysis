---
ver: rpa2
title: Enhancing predictive imaging biomarker discovery through treatment effect analysis
arxiv_id: '2406.02534'
source_url: https://arxiv.org/abs/2406.02534
tags:
- predictive
- attribution
- treatment
- biomarker
- biomarkers
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces a novel task of directly learning predictive
  imaging biomarkers from pre-treatment images to forecast individual treatment effectiveness.
  The proposed approach leverages deep learning models originally designed for estimating
  conditional average treatment effects (CATE) and adapts them for image inputs.
---

# Enhancing predictive imaging biomarker discovery through treatment effect analysis

## Quick Facts
- arXiv ID: 2406.02534
- Source URL: https://arxiv.org/abs/2406.02534
- Reference count: 40
- Primary result: Image-based CATE estimators can identify predictive imaging biomarkers with higher strength than baseline models across synthetic and real-world datasets.

## Executive Summary
This study introduces a novel approach for discovering predictive imaging biomarkers by adapting deep learning models originally designed for estimating conditional average treatment effects (CATE). The method learns to forecast individual treatment effectiveness directly from pre-treatment images by leveraging TARNet architecture with shared convolutional layers and two treatment-specific output heads. The approach is evaluated on synthetic and real-world image datasets, demonstrating its ability to distinguish predictive biomarkers from prognostic ones using statistical testing and feature attribution methods. Results show the estimated CATE is a reliable measure for predictive effect, enabling identification of correct predictive biomarkers across different image features and datasets.

## Method Summary
The approach adapts TARNet, a causal inference model, for image inputs by using shared convolutional layers as encoders to learn common features across treatment and control groups, alongside two treatment-specific output heads. The model is trained with mean squared error loss applied separately to each head based on group membership. CATE is estimated by subtracting the control group output from the treatment group output. An evaluation protocol assesses the model's ability to identify predictive biomarkers through statistical testing using interaction terms in linear regression and feature attribution methods including Expected Gradients and Guided Grad-CAM to distinguish predictive from prognostic effects.

## Key Results
- Image-based CATE estimators identify predictive imaging biomarkers with higher predictive strength compared to baseline models
- Estimated CATE is a reliable measure for predictive effect across different types of image features and datasets
- Model successfully distinguishes predictive from prognostic biomarkers with statistically significant interaction terms in linear regression
- Feature attribution methods reveal which image regions drive predictive biomarker identification

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** The two-headed TARNet architecture enables separate learning of prognostic and predictive effects by having shared convolutional layers for commonalities and separate heads for group-specific outcomes.
- **Mechanism:** The shared encoder learns common features across treatment and control groups (prognostic effects), while the two treatment-specific heads capture differential outcomes (predictive effects). The subtraction of outputs yields an estimate of the conditional average treatment effect (CATE).
- **Core assumption:** The additive treatment effect assumption holds: E[Y] = fprog(x) + fpred(x)T, meaning prognostic and predictive effects are separable and additive.
- **Evidence anchors:** "We explore the suitability of deep learning models originally designed for estimating the conditional average treatment effect (CATE) for this task" and "The network has shared convolutional layers as encoders to facilitate learning the similarities between the control and treatment groups arising from prognostic effects, alongside two treatment-specific output heads"
- **Break condition:** If prognostic and predictive effects are not additive or if strong confounding exists, the model cannot cleanly separate the two effects.

### Mechanism 2
- **Claim:** The statistical evaluation protocol using interaction terms in linear regression validates whether the estimated CATE represents a true predictive biomarker by testing for treatment-biomarker interaction.
- **Mechanism:** Linear regression with interaction terms (β0 + βT*T + βτ*τ̂ + βτ,T*τ̂*T) tests if the estimated CATE varies significantly with treatment assignment. A significant interaction term (βτ,T ≠ 0) indicates predictive biomarker status.
- **Core assumption:** The relationship between biomarkers and outcomes is approximately linear, allowing for interaction term detection through standard statistical tests.
- **Evidence anchors:** "We test the interaction between the biomarker candidate and treatment... perform a linear regression of the outcomes Y with the formula β0 + βT T + βτ̂ τ̂ + βτ̂,T τ̂ T ~ Y"
- **Break condition:** If the biomarker-outcome relationship is highly non-linear, the linear interaction test may miss predictive biomarkers or produce false positives.

### Mechanism 3
- **Claim:** Feature attribution methods (Expected Gradients and Guided Grad-CAM) enable interpretation of which image regions drive predictive biomarker identification by generating pixel-level sensitivity maps.
- **Mechanism:** These XAI methods backpropagate attribution scores from the CATE prediction to input pixels, highlighting regions that contribute positively or negatively to treatment effect estimation. Differences between control head and CATE attribution maps reveal predictive vs. prognostic features.
- **Core assumption:** The deep learning model's predictions are differentiable and meaningful attribution can be extracted through gradient-based methods.
- **Evidence anchors:** "We also investigate which input image features the trained model is sensitive to... employ the XAI methods expected gradients (EG) and guided gradient-weighted class activation mapping (GGCAM) to generate attribution maps" and "By applying XAI methods we provide visual explanations of the black-box model predictions by creating attribution maps based on input images"
- **Break condition:** If the model is highly non-linear or uses distributed representations, attribution maps may be noisy or misleading, making interpretation difficult.

## Foundational Learning

- **Concept: Causal inference and potential outcomes framework**
  - Why needed here: The entire approach relies on estimating individual treatment effects from observational or RCT data where counterfactuals are unobserved
  - Quick check question: What is the fundamental problem of causal inference that makes direct ITE estimation impossible?

- **Concept: Conditional Average Treatment Effect (CATE) estimation**
  - Why needed here: The method adapts CATE estimators for image inputs to discover predictive biomarkers, requiring understanding of how CATE differs from standard prediction
  - Quick check question: How does CATE estimation differ from standard supervised learning in terms of available ground truth?

- **Concept: Prognostic vs. predictive biomarkers**
  - Why needed here: The core contribution is distinguishing between biomarkers that affect outcomes regardless of treatment (prognostic) versus those that interact with treatment (predictive)
  - Quick check question: What is the key difference in how prognostic and predictive biomarkers relate to treatment assignment?

## Architecture Onboarding

- **Component map:** Shared convolutional encoder -> Treatment-specific heads (control and treatment) -> CATE estimation (control - treatment)
- **Critical path:** 1. Preprocess images and split into control/treatment groups 2. Forward pass through shared encoder and respective head 3. Compute separate losses and backpropagate 4. During inference, subtract outputs to get CATE 5. Apply statistical tests to validate predictive strength 6. Generate attribution maps for biomarker interpretation
- **Design tradeoffs:** Two-headed vs single-headed: Two heads enable separation of prognostic/predictive effects but increase parameters and risk overfitting; Attribution method choice: Expected Gradients for per-channel attribution (CMNIST) vs Grad-CAM for semantic localization (other datasets); Synthetic data generation: Enables controlled experiments but may not capture real-world complexity
- **Failure signatures:** High RMSE but low PEHE: Model predicts factual outcomes well but fails on counterfactuals; tpred/tprog close to 1: Model cannot distinguish predictive from prognostic effects; Noisy attribution maps: Model uses distributed representations or irrelevant features; Poor performance on medical vs natural images: Dataset-specific feature abstraction challenges
- **First 3 experiments:** 1. Train on CMNIST with known color-digit relationships and verify tpred/tprog >> 1 for predictive features 2. Compare two-headed vs single-headed baseline on CUB-200-2011 to demonstrate separation capability 3. Apply attribution methods to ISIC 2018 and verify model focuses on pigment network interspaces rather than globules for predictive biomarker detection

## Open Questions the Paper Calls Out

- **Question:** How does the choice of deep learning model architecture (e.g., ResNet variants, other architectures) impact the ability to identify predictive imaging biomarkers compared to the TARNet model used in this study?
- **Basis in paper:** [inferred] The paper uses a TARNet model adapted for image inputs but does not explore other architectures or compare their performance.
- **Why unresolved:** The study focuses on adapting TARNet and does not investigate how different architectures might perform in this task.
- **What evidence would resolve it:** Comparative experiments using different deep learning architectures (e.g., other CATE estimators, image-specific architectures) to identify predictive biomarkers on the same datasets.

- **Question:** Can the proposed approach effectively identify predictive imaging biomarkers in the presence of confounding variables or non-linear biomarker-outcome relationships?
- **Basis in paper:** [inferred] The paper assumes linear biomarker-outcome relationships and does not address confounding effects or non-linearities.
- **Why unresolved:** The experimental design uses simulated data with linear relationships and does not include confounding variables or non-linear scenarios.
- **What evidence would resolve it:** Experiments with simulated data incorporating confounding variables and non-linear biomarker-outcome relationships to test the model's robustness and performance.

- **Question:** How well does the proposed approach generalize to different imaging modalities and disease contexts beyond those studied in this paper?
- **Basis in paper:** [explicit] The paper demonstrates the approach on four diverse datasets but acknowledges the need for further exploration across different modalities and contexts.
- **Why unresolved:** The study's scope is limited to specific datasets and imaging modalities, and broader validation is needed.
- **What evidence would resolve it:** Application of the approach to a wider range of imaging modalities (e.g., MRI, ultrasound) and disease contexts, along with performance evaluation and comparison.

## Limitations
- Synthetic data generation may not capture real-world imaging complexity, limiting generalizability
- Attribution methods may produce unreliable explanations for highly non-linear models
- Two-headed architecture increases parameter count and overfitting risk

## Confidence
- **Medium** for biomarker identification capability: Validation relies heavily on synthetic data with known ground truth rather than independent clinical validation
- **Low** for generalizability across diverse imaging modalities: Limited real-world dataset testing
- **Medium** for statistical evaluation protocol: Linear interaction testing assumption may not hold for complex non-linear relationships

## Next Checks
1. Test model performance on an independent, clinically-validated imaging biomarker dataset where ground truth treatment effectiveness is established through prospective trials.

2. Compare attribution map consistency across multiple runs and different XAI methods to assess robustness of biomarker localization.

3. Evaluate model performance when prognostic and predictive effects are not strictly additive to test the core assumption underlying the two-headed architecture.