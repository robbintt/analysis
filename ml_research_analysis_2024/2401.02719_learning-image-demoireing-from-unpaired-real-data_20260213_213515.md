---
ver: rpa2
title: Learning Image Demoireing from Unpaired Real Data
arxiv_id: '2401.02719'
source_url: https://arxiv.org/abs/2401.02719
tags:
- moir
- images
- eing
- demoir
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper tackles the problem of image demoir\xE9ing without\
  \ relying on paired real data. The authors propose UnDeM, a method that synthesizes\
  \ pseudo moir\xE9 images from unpaired datasets, generating pairs with clean images\
  \ for training demoir\xE9ing models."
---

# Learning Image Demoireing from Unpaired Real Data

## Quick Facts
- arXiv ID: 2401.02719
- Source URL: https://arxiv.org/abs/2401.02719
- Authors: Yunshan Zhong; Yuyao Zhou; Yuxin Zhang; Fei Chao; Rongrong Ji
- Reference count: 29
- Primary result: UnDeM achieves 19.89 dB PSNR on FHDMi dataset, outperforming cyclic moiré learning (19.36 dB) and shooting simulation (9.32 dB)

## Executive Summary
This paper addresses the challenge of image demoiréing without paired real data by proposing UnDeM, a method that synthesizes pseudo moiré images from unpaired datasets. The approach involves dividing real moiré images into patches, grouping them based on moiré complexity, and using a novel moiré generation framework to create diverse moiré patterns. An adaptive denoising method is employed to eliminate low-quality pseudo moiré images. Experiments on FHDMi and UHDM datasets demonstrate that UnDeM outperforms existing methods, such as MBCNN and ESDNet-L, when trained on synthetic images.

## Method Summary
UnDeM synthesizes pseudo moiré images from unpaired datasets by first preprocessing images into patches and grouping them based on complexity (frequency × colorfulness). A moiré synthesis network with adversarial training generates realistic moiré patches while preserving clean image details. The network includes a moiré feature encoder, generator, discriminator, and content encoder. An adaptive denoising step removes low-quality pseudo moiré images based on edge difference thresholds. The resulting high-quality pairs are used to train demoiréing models, which show superior performance compared to methods trained on real data.

## Key Results
- MBCNN trained on UnDeM's synthetic images achieves 19.89 dB PSNR on FHDMi dataset
- Outperforms cyclic moiré learning (19.36 dB) and shooting simulation (9.32 dB)
- UnDeM effectively addresses the data scarcity issue in demoiréing by leveraging unpaired real data

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The moiré synthesis network learns to generate realistic pseudo-moiré images by leveraging adversarial training between a generator and a discriminator
- Core assumption: Adversarial training can effectively capture complex, varying moiré patterns
- Evidence anchors: [abstract] mentions pseudo moiré image synthesis; [section] describes adversarial training between generator and discriminator

### Mechanism 2
- Claim: Grouping moiré patches by complexity allows the synthesis network to better learn and model diverse moiré patterns
- Core assumption: Moiré patterns with similar complexity can be effectively modeled by a single synthesis network
- Evidence anchors: [section] discusses isolated moiré synthesis network for similar complexity; [section] cites frequency and color information as complexity indicators

### Mechanism 3
- Claim: Adaptive denoising removes low-quality pseudo-moiré images, preventing them from negatively impacting training
- Core assumption: Edge difference between low-quality pseudo-moiré and clean patches is significantly larger
- Evidence anchors: [section] explains structure difference scoring and adaptive thresholding based on percentile

## Foundational Learning

- Concept: Adversarial training in GANs
  - Why needed here: Generates realistic pseudo-moiré images that can fool the discriminator
  - Quick check question: What is the role of the discriminator in a GAN, and how does it help the generator improve?

- Concept: Image preprocessing and grouping
  - Why needed here: Allows synthesis network to better model diverse moiré patterns
  - Quick check question: How does grouping data by complexity improve the performance of machine learning models?

- Concept: Adaptive thresholding
  - Why needed here: Removes low-quality pseudo-moiré images based on edge difference thresholds
  - Quick check question: What is the purpose of adaptive thresholding, and how does it differ from fixed thresholding?

## Architecture Onboarding

- Component map: Image Preprocessing -> Moiré Synthesis Network (with adversarial training) -> Adaptive Denoise -> Demoiréing Model Training
- Critical path: Image Preprocessing → Moiré Synthesis Network (with adversarial training) → Adaptive Denoise → Demoiréing Model Training
- Design tradeoffs: Number of groups affects granularity of moiré pattern modeling vs computational cost; threshold setting balances removing low-quality images vs retaining good ones
- Failure signatures: Generator producing unrealistic moiré images leads to strong discriminator and mode collapse; inaccurate grouping prevents generalization; incorrect adaptive denoising threshold removes too many good images
- First 3 experiments:
  1. Train moiré synthesis network with single group (no preprocessing) vs grouped approach
  2. Test different thresholds in adaptive denoising on final demoiréing performance
  3. Compare moiré synthesis network performance with and without adversarial training

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the quality of synthetic moiré images be further improved to reduce the domain gap with real moiré images?
- Basis in paper: [inferred] Performance degrades compared to real data, suggesting room for improvement
- Why unresolved: Paper suggests potential improvements but doesn't provide concrete solutions
- What evidence would resolve it: Testing new image preprocessing techniques, more sophisticated synthesis networks, or novel loss functions

### Open Question 2
- Question: Can the proposed UnDeM method be generalized to other image restoration tasks beyond demoiréing?
- Basis in paper: [inferred] Methodology of synthesizing pseudo images from unpaired data could apply to other restoration tasks
- Why unresolved: Authors don't explore applicability to other image restoration problems
- What evidence would resolve it: Applying UnDeM framework to deblurring or denoising tasks and evaluating performance

### Open Question 3
- Question: What is the impact of different crop sizes on the performance of demoiréing models trained on synthetic images?
- Basis in paper: [explicit] Authors experiment with different crop sizes (192x192, 384x384, 768x768) with varying results
- Why unresolved: Authors report results but don't provide detailed analysis of optimal crop size selection
- What evidence would resolve it: Systematic study on relationship between crop size, model performance, and input image characteristics

## Limitations
- Performance evaluated only on two specific datasets (FHDMi and UHDM), limiting generalizability
- Complexity metric (frequency × colorfulness) may not capture all variations in real moiré patterns
- Adaptive denoising threshold relies on percentile-based approach that may not be optimal across datasets

## Confidence
- High confidence: Core claim that UnDeM outperforms existing methods on tested datasets
- Medium confidence: Effectiveness of adversarial training mechanism for generating realistic moiré patterns
- Medium confidence: Claim that grouping by complexity improves synthesis quality

## Next Checks
1. Test method on additional datasets with different types of moiré patterns to validate generalizability
2. Conduct ablation studies on the number of groups and their impact on performance
3. Evaluate sensitivity of method to different adaptive denoising threshold settings across multiple datasets