---
ver: rpa2
title: 'TractOracle: towards an anatomically-informed reward function for RL-based
  tractography'
arxiv_id: '2403.17845'
source_url: https://arxiv.org/abs/2403.17845
tags:
- tractography
- streamlines
- tractoracle
- tractoracle-net
- reward
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: TractOracle is an RL-based tractography method that uses a neural
  network to score streamlines for anatomical plausibility during both training and
  tracking. This dual-purpose network provides anatomical rewards to guide the RL
  agent and enables early stopping of implausible streamlines, reducing false positives.
---

# TractOracle: towards an anatomically-informed reward function for RL-based tractography

## Quick Facts
- arXiv ID: 2403.17845
- Source URL: https://arxiv.org/abs/2403.17845
- Authors: Antoine ThÃ©berge; Maxime Descoteaux; Pierre-Marc Jodoin
- Reference count: 8
- TractOracle achieves up to 20% improvement in true positive ratios, 3x reduction in false positives, and 2-7x increase in true positive streamlines compared to competitive methods

## Executive Summary
TractOracle is a novel RL-based tractography method that integrates anatomical plausibility scoring directly into the tracking process through a dual-purpose neural network. Unlike traditional approaches that rely solely on local diffusion information, TractOracle uses a transformer network to evaluate streamlines for anatomical plausibility both during training (as a reward signal) and during tracking (for early stopping). This anatomically-informed approach addresses the fundamental challenge of false positive tract generation in tractography, producing more accurate and anatomically realistic white matter reconstructions.

## Method Summary
TractOracle consists of two main components: TractOracle-Net, a transformer network that scores streamlines for anatomical plausibility, and TractOracle-RL, a reinforcement learning agent that uses these scores as part of its reward function. The system trains on segmented streamlines from classical tractography algorithms, learning to distinguish anatomically plausible from implausible pathways. During tracking, the RL agent receives rewards based on both local diffusion alignment and the anatomical plausibility score from TractOracle-Net, while also using these scores to implement early stopping for implausible streamlines.

## Key Results
- Achieves up to 20% improvement in true positive ratios compared to competitive methods
- Reduces false positives by up to 3x on one dataset
- Increases true positive streamlines by 2-7x on another dataset
- Demonstrates state-of-the-art performance in tractogram segmentation and generation with excellent visual quality and coverage

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The reward network provides anatomically-informed rewards during both training and tracking, enabling simultaneous evaluation and reconstruction of streamlines.
- Mechanism: The TractOracle-Net transformer network scores streamlines for anatomical plausibility in real-time, using these scores to reward the RL agent during training and to stop tracking implausible streamlines early.
- Core assumption: Anatomical plausibility of streamlines can be effectively learned and predicted from streamline shape data alone.
- Evidence anchors:
  - [abstract]: "TractOracle is an RL-based tractography method that uses a neural network to score streamlines for anatomical plausibility during both training and tracking."
  - [section]: "TractOracle-Net is a transformer network which takes streamlines as input and outputs scores related to their anatomical plausibility."
  - [corpus]: Found 25 related papers, but none specifically discuss anatomically-informed reward functions in RL tractography. This suggests TractOracle is novel in this approach.
- Break condition: If the TractOracle-Net cannot accurately distinguish between anatomically plausible and implausible streamlines, the reward signal would misguide the RL agent, leading to poor tractography results.

### Mechanism 2
- Claim: Early stopping of implausible streamlines based on TractOracle-Net scores reduces false positives in the final tractogram.
- Mechanism: During tracking, if TractOracle-Net scores a streamline below 0.5 after a minimum number of steps, the tracking process is terminated, preventing reconstruction of anatomically implausible streamlines.
- Core assumption: TractOracle-Net can reliably identify implausible streamlines before they complete, and early termination doesn't miss valid anatomical connections.
- Evidence anchors:
  - [abstract]: "This dual-purpose network provides anatomical rewards to guide the RL agent and enables early stopping of implausible streamlines, reducing false positives."
  - [section]: "Moreover, computing the plausibility score of a streamline while it is being tracked allows the system to stop the tracking when it diverges to an implausible path, preventing their reconstruction."
  - [corpus]: No direct corpus evidence found for early stopping in RL tractography, indicating this is a novel approach.
- Break condition: If TractOracle-Net produces false negatives (scoring plausible streamlines as implausible), valid anatomical connections would be prematurely terminated, reducing the quality of the final tractogram.

### Mechanism 3
- Claim: The anatomically-informed reward function significantly improves tracking accuracy compared to purely local reward functions.
- Mechanism: The reward function combines a local term based on alignment with dMRI signal and an anatomical term based on TractOracle-Net's plausibility score, guiding the RL agent to follow anatomically plausible paths.
- Core assumption: Incorporating anatomical knowledge through the reward function is more effective than relying solely on local diffusion information for guiding tractography.
- Evidence anchors:
  - [abstract]: "The reward functions so far used to train RL agents do not encapsulate anatomical knowledge which causes agents to generate spurious false positives tracts."
  - [section]: "Previous RL tractography methods are limited by their reward function which considers only local information from the dMRI signal surrounding st. We instead reformulate the reward function to include a factor based on the anatomical plausibility of the reconstructed streamline."
  - [corpus]: Limited corpus evidence found for comparing anatomically-informed vs. local-only reward functions in RL tractography, suggesting TractOracle is addressing an important gap.
- Break condition: If the anatomical component of the reward doesn't effectively guide the agent, or if it conflicts with the local diffusion information, the combined reward might perform worse than either component alone.

## Foundational Learning

- Concept: Reinforcement Learning fundamentals (Markov Decision Processes, value functions, Q-learning)
  - Why needed here: Understanding how the RL agent learns to track streamlines through interaction with the environment and reward signals.
  - Quick check question: How does the TractOracle-RL agent balance immediate local rewards (alignment with dMRI) against long-term anatomical plausibility rewards?

- Concept: Transformer networks and their application to sequence data
  - Why needed here: TractOracle-Net is a transformer that processes streamline sequences to output anatomical plausibility scores.
  - Quick check question: Why might a transformer architecture be particularly suitable for processing streamline data compared to other neural network types?

- Concept: Diffusion MRI and tractography basics
  - Why needed here: Understanding the underlying data (dMRI) and the goal (reconstructing white matter pathways) is crucial for interpreting results and potential applications.
  - Quick check question: What are the main challenges in tractography that make it an "ill-posed problem" as mentioned in the paper?

## Architecture Onboarding

- Component map:
  - TractOracle-Net -> TractOracle-RL -> Environment
  - TractOracle-Net processes input streamline to output anatomical plausibility score
  - RL agent receives combined local + anatomical reward
  - Agent updates policy based on total reward
  - During tracking, TractOracle-Net scores ongoing streamlines for early stopping

- Critical path:
  1. TractOracle-Net processes input streamline to output anatomical plausibility score
  2. RL agent receives combined local + anatomical reward
  3. Agent updates policy based on total reward
  4. During tracking, TractOracle-Net scores ongoing streamlines for early stopping

- Design tradeoffs:
  - Balancing TractOracle-Net complexity vs. real-time scoring needs
  - Choosing between more accurate but slower RL algorithms vs. faster but potentially less optimal ones
  - Deciding on the anatomical plausibility threshold for early stopping

- Failure signatures:
  - Low classification accuracy of TractOracle-Net on validation data
  - RL agent fails to improve over multiple training epochs
  - Tractometer metrics show no improvement or degradation compared to baseline methods

- First 3 experiments:
  1. Validate TractOracle-Net classification accuracy on the ISMRM2015 and BIL&GIN datasets
  2. Compare TractOracle-RL performance against baseline tractography methods on the ISMRM2015 dataset using Tractometer metrics
  3. Evaluate TractOracle-RL on in-vivo data (TractoInferno) and compare bundle reconstructions to reference data using Recobundles and extractor_flow

## Open Questions the Paper Calls Out

- How can global context be incorporated into the tracking agent to further improve the anatomical accuracy of tractograms?
  - Basis in paper: [explicit] The authors state: "Future work should aim at giving the tracking agent global context of the diffusion volume to finally tackle the ill-posedness of tractography."
  - Why unresolved: The paper does not explore methods for providing global context to the RL agent, and the current approach relies solely on local information and anatomical scoring.
  - What evidence would resolve it: Experimental results demonstrating improved tractogram accuracy and reduced false positives when incorporating global context into the RL agent's decision-making process.

## Limitations
- The method's reliance on shape-based anatomical plausibility scoring may limit effectiveness for complex or atypical white matter configurations
- Performance generalizability across different acquisition protocols and anatomical regions remains uncertain
- The current approach doesn't incorporate global context, which the authors acknowledge as important for addressing tractography's ill-posed nature

## Confidence
- High confidence in the core mechanism of combining local and anatomical rewards
- Medium confidence in the scalability of the approach to whole-brain tractography
- Medium confidence in the robustness of early stopping criteria across diverse datasets

## Next Checks
1. Evaluate TractOracle performance on multi-shell dMRI data to assess robustness across acquisition protocols
2. Test anatomical reward generalization by training on one dataset and evaluating on anatomically distinct regions
3. Compare TractOracle-Net's anatomical plausibility scoring against expert human ratings on a subset of streamlines