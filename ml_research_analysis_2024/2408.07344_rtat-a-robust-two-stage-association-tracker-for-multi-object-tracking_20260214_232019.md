---
ver: rpa2
title: 'RTAT: A Robust Two-stage Association Tracker for Multi-Object Tracking'
arxiv_id: '2408.07344'
source_url: https://arxiv.org/abs/2408.07344
tags:
- association
- tracklets
- tracklet
- tracking
- data
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces RTAT, a two-stage association tracker for
  multi-object tracking. The first stage uses simple data association to generate
  high-purity tracklets by setting a low threshold for the matching cost.
---

# RTAT: A Robust Two-stage Association Tracker for Multi-Object Tracking

## Quick Facts
- **arXiv ID**: 2408.07344
- **Source URL**: https://arxiv.org/abs/2408.07344
- **Reference count**: 39
- **Primary result**: Achieves state-of-the-art 67.2 HOTA, 84.7 IDF1, and 69.7 AssA on MOT17; 66.2 HOTA, 82.5 IDF1, and 68.2 AssA on MOT20

## Executive Summary
RTAT introduces a two-stage association tracker for multi-object tracking that achieves state-of-the-art performance on MOT17 and MOT20 benchmarks. The method first uses simple data association with a low cost threshold to generate high-purity tracklets, then employs a message-passing graph neural network to merge these tracklets into complete trajectories. This approach effectively reduces identity switches in the first stage while leveraging learned associations in the second stage. The system demonstrates that combining simple first-stage association with learned second-stage tracklet merging can significantly improve tracking performance while reducing the complexity of designing sophisticated association strategies.

## Method Summary
RTAT operates in two stages: first, it uses simple data association (like ByteTrack or BoT-SORT) with a low cost threshold to generate high-purity tracklets by setting the threshold to 0.2. This increases tracklet purity but may fragment tracks into shorter segments. In the second stage, a message-passing graph neural network recursively merges these short tracklets into longer trajectories. The GNN operates on a sparse graph where each tracklet is connected to its K=10 nearest neighbors based on appearance, motion, and spatial features. The network uses hierarchical edge classification to predict which edges represent the same identity, merging tracklets accordingly. Data augmentation at both video and tracklet levels improves the GNN's robustness and generalization.

## Key Results
- Achieves 67.2 HOTA, 84.7 IDF1, and 69.7 AssA on MOT17 benchmark
- Achieves 66.2 HOTA, 82.5 IDF1, and 68.2 AssA on MOT20 benchmark
- Demonstrates superior performance compared to state-of-the-art methods like MOTRv2, TransTrack, and MOTDT
- Shows consistent improvements across all major tracking metrics (HOTA, IDF1, AssA, MOTA)

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Using a low threshold for matching cost in the first stage increases tracklet purity.
- **Mechanism**: Setting a low threshold in the assignment process allows more detections to be matched to tracklets, even with less confident matches. This reduces identity switches by ensuring that each tracklet is more likely to contain detections from the same object, increasing the proportion of high-purity tracklets.
- **Core assumption**: A lower threshold does not introduce too many incorrect matches that would degrade purity.
- **Evidence anchors**:
  - [abstract]: "For the first-stage association, we use a simple data association strategy to generate tracklets with high purity by setting a low threshold for the matching cost in the assignment process."
  - [section 3.3]: "By setting a lower cost threshold thc, we can obtain tracklets with higher purity. Consequently, there are less identity switches in each tracklet, but the number of tracklet fragments will increase."

### Mechanism 2
- **Claim**: The message-passing GNN in the second stage effectively merges short tracklets into longer, complete trajectories.
- **Mechanism**: The GNN models tracklet association as a hierarchical edge classification problem. It recursively merges short tracklets by propagating information through a sparse graph, learning to classify edges as active (same identity) or inactive. The hierarchical approach allows merging at multiple levels, producing longer trajectories.
- **Core assumption**: The GNN can learn meaningful edge features from tracklet features and association cues (spatial, temporal, appearance, motion).
- **Evidence anchors**:
  - [abstract]: "We conduct the tracklet association in the second-stage based on the framework of message-passing GNN... which can recursively merge short tracklets into longer ones."
  - [section 3.4]: "Our method models the tracklet association as a series of edge classification problem in hierarchical graphs... We use the message passing mechanism to update the features for nodes and edges across the graph."

### Mechanism 3
- **Claim**: Data augmentation at both video and tracklet levels improves GNN robustness and generalization.
- **Mechanism**: Video-level augmentation generates more video clips from original sequences by varying start points and lengths. Tracklet-level augmentation generates more tracklet sets by using different association strategies with varying cost thresholds. This increases the diversity of training samples, helping the GNN learn more robust and generalizable features.
- **Core assumption**: The augmented data is representative of real-world variations and improves the GNN's ability to handle diverse scenarios.
- **Evidence anchors**:
  - [section 3.4]: "We introduce data augmentations from both video-level and tracklet-level to train the GNN networks with higher robustness and generality."
  - [section 4.2]: "Both the data augmentation strategies can improve the IDF1 score separately, and their combination can obtain higher improvement."

## Foundational Learning

- **Concept**: Multi-Object Tracking (MOT) by Detection and Association
  - **Why needed here**: Understanding the tracking-by-detection paradigm is fundamental to grasping how RTAT works. RTAT uses detections from a detector and then associates them across frames.
  - **Quick check question**: What are the two main steps in the tracking-by-detection paradigm?

- **Concept**: Graph Neural Networks (GNNs) and Message Passing
  - **Why needed here**: RTAT uses a message-passing GNN for tracklet association. Understanding how GNNs operate on graphs and propagate information is crucial.
  - **Quick check question**: How does message passing in a GNN help in learning features for nodes and edges?

- **Concept**: Data Association and Cost Matrices
  - **Why needed here**: The first stage of RTAT involves data association between detections and tracklets. Understanding how cost matrices are constructed and used in assignment algorithms (like Hungarian) is important.
  - **Quick check question**: What is the role of a cost matrix in data association, and how does a threshold affect the assignment?

## Architecture Onboarding

- **Component map**: Detection Module -> First-Stage Association (ByteTrack/BoT-SORT with low threshold) -> Tracklet Extraction -> Second-Stage Association (Message-passing GNN) -> Final Trajectories

- **Critical path**:
  1. Detect objects in video frames
  2. Generate initial tracklets using simple association with low threshold
  3. Build sparse graph for tracklet association
  4. Initialize node and edge features
  5. Perform hierarchical message-passing and edge classification
  6. Merge tracklets based on active edges
  7. Apply linear interpolation to fix missing detections

- **Design tradeoffs**:
  - Low threshold vs. number of tracklets: Lower threshold increases purity but also increases the number of tracklets, which increases computational cost in the second stage.
  - Graph sparsity vs. accuracy: Limiting the number of edges reduces computational complexity but may miss some true associations.
  - Number of hierarchical levels: More levels allow for more merging but increase training and inference time.

- **Failure signatures**:
  - High number of identity switches: Indicates first-stage association is not generating pure enough tracklets.
  - Low IDF1 score: Suggests second-stage GNN is not accurately classifying edges.
  - High computational cost: May be due to too many tracklets or insufficient graph sparsity.
  - Overfitting: Poor performance on validation set, possibly due to insufficient data augmentation.

- **First 3 experiments**:
  1. Vary the cost threshold in the first stage and measure tracklet purity and number of tracklets.
  2. Test different graph sparsification strategies (e.g., different numbers of edges per node) and measure association accuracy.
  3. Evaluate the impact of data augmentation strategies on GNN performance using cross-validation.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: How does the choice of cost threshold in the first-stage association affect the trade-off between tracklet purity and the number of tracklets generated?
- **Basis in paper**: [explicit] The paper discusses setting a low threshold for the matching cost to generate tracklets with high purity, but it also mentions that a very small threshold results in too many tracklets, increasing computational complexity.
- **Why unresolved**: The paper provides some experimental results showing the effect of different thresholds on tracking performance, but it doesn't provide a comprehensive analysis of the trade-off between tracklet purity and the number of tracklets for various threshold values.
- **What evidence would resolve it**: A detailed study varying the cost threshold across a wide range and analyzing the resulting number of tracklets, their purity, and the overall tracking performance would provide insights into the optimal threshold selection.

### Open Question 2
- **Question**: How does the performance of RTAT compare to other state-of-the-art methods when using different types of object detectors (e.g., different architectures or training strategies)?
- **Basis in paper**: [explicit] The paper mentions using YoloX for detection, but it doesn't explore the impact of using different detectors on the final tracking performance.
- **Why unresolved**: The paper focuses on the data association aspect of MOT and uses a fixed detector, so it doesn't investigate how the choice of detector affects the overall system performance.
- **What evidence would resolve it**: Conducting experiments with different object detectors (e.g., Faster R-CNN, RetinaNet, EfficientDet) and comparing the tracking performance of RTAT using each detector would provide insights into the detector's impact on the system.

### Open Question 3
- **Question**: Can the tracklet association process in RTAT be further improved by incorporating additional information, such as semantic scene understanding or temporal context beyond the current video clip?
- **Basis in paper**: [inferred] The paper mentions using appearance, motion, and spatial information for tracklet association, but it doesn't explore the potential benefits of incorporating additional contextual information.
- **Why unresolved**: The paper focuses on a specific approach to tracklet association using GNNs and message passing, but it doesn't investigate whether incorporating additional information could further enhance the performance.
- **What evidence would resolve it**: Experiments incorporating additional contextual information (e.g., scene semantics, longer temporal context) into the tracklet association process and comparing the performance with the current approach would provide insights into the potential benefits of such enhancements.

## Limitations
- **Limitation 1**: The effectiveness relies on the assumption that simple first-stage association with low thresholds can reliably generate high-purity tracklets, which may not hold in crowded scenes or when objects have similar appearance.
- **Limitation 2**: The graph sparsification strategy with K=10 nearest neighbors could miss true associations in complex scenarios with many overlapping objects.
- **Limitation 3**: Performance claims are based on specific datasets (MOT17/20) with private detections, limiting generalizability to other tracking benchmarks or real-world applications.

## Confidence
- **High confidence**: Overall two-stage framework effectiveness based on strong benchmark results
- **Medium confidence**: Specific GNN architecture details due to limited implementation information provided
- **Low confidence**: Generalization beyond the evaluated datasets and detection quality

## Next Checks
1. Test RTAT with different detection qualities (public vs private) to assess sensitivity to detection performance
2. Evaluate on additional MOT benchmarks (like DanceTrack or BDD100K) to verify generalization
3. Conduct ablation studies on graph sparsification parameters (K value) and their impact on association accuracy vs computational cost