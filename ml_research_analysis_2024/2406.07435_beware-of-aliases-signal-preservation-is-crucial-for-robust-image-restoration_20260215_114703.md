---
ver: rpa2
title: Beware of Aliases -- Signal Preservation is Crucial for Robust Image Restoration
arxiv_id: '2406.07435'
source_url: https://arxiv.org/abs/2406.07435
tags:
- image
- downsampling
- restormer
- images
- upsampling
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper tackles aliasing artifacts in image restoration models,
  particularly for image deblurring tasks. The authors identify that standard architectures
  risk aliasing, which compromises model robustness and reconstruction quality.
---

# Beware of Aliases -- Signal Preservation is Crucial for Robust Image Restoration

## Quick Facts
- **arXiv ID:** 2406.07435
- **Source URL:** https://arxiv.org/abs/2406.07435
- **Reference count:** 40
- **Primary result:** BOA-Restormer significantly reduces spectral artifacts in image deblurring while improving robustness against adversarial attacks.

## Executive Summary
This paper addresses aliasing artifacts in image restoration models, particularly for image deblurring tasks. The authors identify that standard transformer architectures risk aliasing during downsampling and upsampling operations, which compromises model robustness and reconstruction quality. They propose BOA-Restormer, a transformer-based image restoration model with two key innovations: "FrequencyPreservedPooling" for downsampling and "FreqAvgUp" for upsampling, both operating partly in the frequency domain to ensure alias-free paths while preserving high-frequency information.

## Method Summary
BOA-Restormer modifies the Restormer architecture by replacing standard downsampling (PixelUnshuffle) with FrequencyPreservedPooling and standard upsampling (PixelShuffle) with FreqAvgUp. These operations process feature maps in both spatial and frequency domains, using DFT-based filtering to separate low- and high-frequency components before downsampling or after upsampling. The model learns mixing parameters α and β to optimally combine frequency components during these operations. The architecture is trained on the GoPro deblurring dataset with standard Restormer hyperparameters.

## Key Results
- FrequencyPreservedPooling and FreqAvgUp operations significantly reduce spectral artifacts in restored images
- BOA-Restormer maintains high PSNR/SSIM scores on clean data while improving robustness against PGD and CosPGD adversarial attacks
- The symmetry between encoder and decoder operations is crucial for learning robust representations, as demonstrated by ablation studies

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** FrequencyPreservedPooling eliminates aliasing by filtering in the frequency domain before downsampling
- **Mechanism:** High-frequency components are preserved via subtraction of a low-pass filtered version, while low-frequency components are averaged
- **Core assumption:** Aliasing artifacts in standard downsampling arise from insufficient sampling of high-frequency content
- **Evidence anchors:** [abstract] "downsampling and upsampling operations partly in the frequency domain to ensure alias-free paths"
- **Break condition:** If padding size is too small, Gibbs phenomenon may introduce artifacts despite frequency filtering

### Mechanism 2
- **Claim:** FreqAvgUp restores high-frequency information lost during downsampling by learning a mixing parameter
- **Mechanism:** During upsampling, high-frequency features are separated via frequency-domain subtraction, then combined with low-frequency features using a learnable parameter β
- **Core assumption:** Encoder-decoder symmetry is essential for accurate feature communication via skip connections
- **Evidence anchors:** [abstract] "symmetry between encoder and decoder operations is crucial for learning robust representations"
- **Break condition:** If β converges to 0 or 1, the network may discard either low- or high-frequency information entirely

### Mechanism 3
- **Claim:** Focusing on low-frequency information during learning improves stability and reduces spectral artifacts
- **Mechanism:** Learnable parameters α and β are initialized to bias toward low-frequency content (α=0.3, β=0.3)
- **Core assumption:** Low-frequency components provide stable projections from input to target distribution
- **Evidence anchors:** [section 4.3] "a value of α and β less than 0.5 would mean the model is focusing more on low-frequency information"
- **Break condition:** If high-frequency information is completely suppressed, edge restoration will suffer

## Foundational Learning

- **Concept: Discrete Fourier Transform (DFT)**
  - Why needed here: DFT is used to separate low- and high-frequency components of feature maps
  - Quick check question: What is the computational complexity of a 2D DFT on an M×N feature map?

- **Concept: Aliasing in digital signal processing**
  - Why needed here: Understanding aliasing is critical to grasp why standard downsampling operations introduce artifacts
  - Quick check question: In what scenario does aliasing occur during downsampling?

- **Concept: Symmetry in encoder-decoder architectures**
  - Why needed here: Symmetry between downsampling and upsampling operations ensures consistent feature flow
  - Quick check question: Why is symmetry important for pixel-wise prediction tasks like image restoration?

## Architecture Onboarding

- **Component map:** Input → Encoder blocks → FrequencyPreservedPooling → Encoder output → Decoder input → FreqAvgUp → Decoder blocks → Output
- **Critical path:** Input → Encoder blocks → FrequencyPreservedPooling → Encoder output → Decoder input → FreqAvgUp → Decoder blocks → Output
- **Design tradeoffs:** Trade-off between high-frequency preservation and low-frequency stability; computational overhead of frequency-domain operations
- **Failure signatures:** Visible spectral artifacts (grid/checkerboard patterns) in restored images; low PSNR/SSIM scores; high sensitivity to adversarial attacks
- **First 3 experiments:**
  1. Replace standard PixelUnshuffle with FrequencyPreservedPooling in encoder; evaluate PSNR/SSIM on clean and adversarially attacked data
  2. Replace PixelShuffle with FreqAvgUp in decoder; compare artifact reduction against baseline
  3. Train with α and β initialized to 0.5; observe impact on stability and robustness

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do the proposed frequency-based downsampling and upsampling operations perform on other image restoration tasks beyond deblurring?
- Basis in paper: [inferred] The authors mention that spectral artifacts are equally important for tasks like semantic segmentation and image restoration
- Why unresolved: The paper only evaluates BOA-Restormer on the image deblurring task
- What evidence would resolve it: Empirical results showing BOA-Restormer performance on denoising or super-resolution tasks

### Open Question 2
- Question: How does BOA-Restormer perform when trained with adversarial training techniques?
- Basis in paper: [inferred] The authors discuss the trade-off between adversarial and non-adversarial performance but do not explore adversarial training
- Why unresolved: The paper only evaluates the baseline BOA-Restormer architecture without adversarial training
- What evidence would resolve it: Results comparing BOA-Restormer with and without adversarial training techniques

### Open Question 3
- Question: How do the learned parameters α and β vary across different image restoration tasks or datasets?
- Basis in paper: [explicit] The authors report learned values of α and β for their proposed architecture on the image deblurring task
- Why unresolved: The paper only reports learned parameters for a single task and dataset
- What evidence would resolve it: Empirical results showing learned α and β values for BOA-Restormer on different tasks or datasets

## Limitations

- The computational overhead of frequency-domain operations may limit scalability to larger models or higher-resolution inputs
- Reliance on specific dataset characteristics (GoPro deblurring) raises questions about generalization to other restoration tasks
- The claim that symmetry is "crucial" is primarily supported by ablation studies within a single architecture

## Confidence

- **High confidence**: The empirical improvements in PSNR/SSIM and adversarial robustness are well-documented and consistent
- **Medium confidence**: The theoretical justification for frequency-domain operations is sound but lacks extensive empirical validation beyond the proposed task
- **Low confidence**: The claim that symmetry is "crucial" for robust representations is primarily supported by ablation studies within a single architecture

## Next Checks

1. **Generalization Test**: Apply BOA-Restormer to a different restoration task (e.g., super-resolution or denoising) to assess whether frequency-domain operations provide consistent benefits
2. **Computational Overhead Analysis**: Quantify the additional FLOPs introduced by FrequencyPreservedPooling and FreqAvgUp operations and evaluate their impact on training/inference time
3. **Architectural Ablation**: Test whether symmetry is uniquely beneficial by comparing BOA-Restormer to a non-symmetric variant where low- and high-frequency paths are asymmetric