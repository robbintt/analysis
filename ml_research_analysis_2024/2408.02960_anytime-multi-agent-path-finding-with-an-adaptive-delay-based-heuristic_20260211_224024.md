---
ver: rpa2
title: Anytime Multi-Agent Path Finding with an Adaptive Delay-Based Heuristic
arxiv_id: '2408.02960'
source_url: https://arxiv.org/abs/2408.02960
tags:
- address
- heuristic
- mapf-lns
- agents
- agent
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents ADDRESS, a novel anytime multi-agent pathfinding
  (MAPF) approach that significantly improves upon the current state-of-the-art MAPF-LNS
  algorithm. The key innovation is a single adaptive destroy heuristic that uses restricted
  Thompson Sampling on the top-K most delayed agents to select seed agents for large
  neighborhood search, eliminating the need for time-consuming exploration of multiple
  stationary heuristics.
---

# Anytime Multi-Agent Path Finding with an Adaptive Delay-Based Heuristic

## Quick Facts
- arXiv ID: 2408.02960
- Source URL: https://arxiv.org/abs/2408.02960
- Reference count: 11
- Key outcome: ADDRESS achieves at least 50% cost improvements compared to MAPF-LNS and other state-of-the-art methods in large-scale scenarios with up to a thousand agents

## Executive Summary
This paper introduces ADDRESS, a novel anytime multi-agent pathfinding (MAPF) approach that significantly improves upon the current state-of-the-art MAPF-LNS algorithm. The key innovation is a single adaptive destroy heuristic that uses restricted Thompson Sampling on the top-K most delayed agents to select seed agents for large neighborhood search, eliminating the need for time-consuming exploration of multiple stationary heuristics. Experimental results demonstrate substantial performance improvements, particularly in large-scale scenarios with high agent density, while maintaining competitive performance in smaller scenarios.

## Method Summary
ADDRESS combines an anytime search framework with a novel adaptive destroy heuristic that leverages restricted Thompson Sampling to select seed agents for large neighborhood search. The approach identifies the K most delayed agents and uses Thompson Sampling to probabilistically select one as the seed, allowing the algorithm to dynamically adapt to problem characteristics without requiring multiple heuristic evaluations. This single adaptive heuristic replaces the traditional approach of testing multiple stationary heuristics, reducing computational overhead while maintaining or improving solution quality. The method operates within an anytime framework, continuously refining solutions as computational time allows.

## Key Results
- Achieves at least 50% cost improvements compared to MAPF-LNS in large-scale scenarios
- Outperforms state-of-the-art methods by substantial margins in warehouse and city map scenarios
- Maintains comparable performance to MAPF-LNS in smaller scenarios with fewer agents
- Demonstrates significant improvements in area under the curve (AUC) metrics

## Why This Works (Mechanism)
The approach works by adaptively identifying and exploiting problem-specific patterns through Thompson Sampling on delayed agents. Instead of exhaustively testing multiple heuristics, the single adaptive heuristic learns which agent selections lead to better solutions over time. The restricted Thompson Sampling focuses computational resources on the most promising candidates (top-K delayed agents), creating a feedback loop where successful seed selections reinforce their probability of future selection. This targeted approach is particularly effective in large-scale scenarios where the computational savings from avoiding multiple heuristic evaluations become substantial, and where delayed agents are more likely to indicate problematic areas requiring intervention.

## Foundational Learning

**Thompson Sampling** - A probabilistic algorithm for balancing exploration and exploitation in decision-making under uncertainty. Needed to intelligently select seed agents without exhaustive search. Quick check: Verify the algorithm properly updates posterior distributions based on observed solution improvements.

**Large Neighborhood Search (LNS)** - A metaheuristic that iteratively destroys and reconstructs portions of a solution to escape local optima. Needed as the underlying optimization framework. Quick check: Confirm the destroy/reconstruct balance maintains solution feasibility while enabling exploration.

**Anytime Algorithms** - Algorithms that can return a valid solution at any interruption point, improving solution quality over time. Needed to provide useful solutions under time constraints. Quick check: Verify solution quality improves monotonically with computational time.

**Agent Delay Metrics** - Quantitative measures of how much an agent's path deviates from optimal or contributes to conflicts. Needed to identify problematic agents for targeted intervention. Quick check: Ensure delay calculations account for both individual optimality and system-wide congestion effects.

## Architecture Onboarding

**Component Map:** Problem Instance -> Initial Solution -> Delay Calculation -> Thompson Sampling (Top-K Selection) -> LNS Destroy/Reconstruct -> Improved Solution -> (Repeat)

**Critical Path:** The core optimization loop where delay calculation feeds into Thompson Sampling, which guides the LNS destroy phase. Performance bottlenecks typically occur in delay calculation for large agent sets and in the LNS reconstruction phase.

**Design Tradeoffs:** Single adaptive heuristic vs. multiple stationary heuristics (computational efficiency vs. potential loss of specialized problem handling), restricted Thompson Sampling vs. full exploration (speed vs. completeness), anytime framework vs. optimal solution (practicality vs. theoretical guarantees).

**Failure Signatures:** Degraded performance when agent delays don't correlate with solution improvement potential, Thompson Sampling convergence to suboptimal seed selection patterns, LNS reconstruction failing to find feasible solutions within time limits.

**3 First Experiments:** 1) Compare solution quality progression over time against MAPF-LNS baseline, 2) Test sensitivity to different K values for delayed agent selection, 3) Evaluate performance on heterogeneous agent scenarios with varying speeds or sizes.

## Open Questions the Paper Calls Out
None

## Limitations
- Performance not uniformly superior across all scenario types; comparable rather than clearly superior in smaller scenarios
- Evaluation focuses primarily on standard MAPF benchmarks without exploring real-world applications or edge cases
- Limited exploration of extremely high congestion levels or unconventional movement constraints

## Confidence

High: Performance improvements in large-scale scenarios with high agent density (1000 agents)
Medium: Generalizability of results to different map types and sizes beyond benchmark scenarios
Low: Behavior with extremely high congestion levels or unconventional movement constraints

## Next Checks
1. Test the algorithm on real-world warehouse layouts and operational constraints to verify practical applicability beyond benchmark scenarios
2. Evaluate performance with heterogeneous agent capabilities (different speeds, sizes, or movement rules) to assess robustness
3. Conduct stress tests with agent densities exceeding those in the current benchmarks to identify potential performance degradation points or failure modes