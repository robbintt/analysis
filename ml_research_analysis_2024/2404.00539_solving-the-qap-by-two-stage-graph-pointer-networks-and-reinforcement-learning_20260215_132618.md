---
ver: rpa2
title: Solving the QAP by Two-Stage Graph Pointer Networks and Reinforcement Learning
arxiv_id: '2404.00539'
source_url: https://arxiv.org/abs/2404.00539
tags: []
core_contribution: This paper proposes a deep reinforcement learning model called
  the two-stage graph pointer network (GPN) for solving the Quadratic Assignment Problem
  (QAP). The two-stage GPN is an extension of the original GPN, which was designed
  for Euclidean Traveling Salesman Problem (TSP).
---

# Solving the QAP by Two-Stage Graph Pointer Networks and Reinforcement Learning

## Quick Facts
- arXiv ID: 2404.00539
- Source URL: https://arxiv.org/abs/2404.00539
- Reference count: 17
- Primary result: Two-stage GPN provides semi-optimal QAP solutions with improved execution time but inferior solution quality compared to conventional heuristics

## Executive Summary
This paper introduces a two-stage Graph Pointer Network (GPN) approach for solving the Quadratic Assignment Problem (QAP). The method extends the original GPN architecture, which was designed for Euclidean Traveling Salesman Problem, by incorporating a two-stage process: a block selection model and an in-block model. The block selection model identifies a focused block of elements, while the in-block model generates the solution using elements within that block. Experimental results demonstrate that the two-stage GPN outperforms conventional heuristic methods in terms of execution time, though the solution quality is inferior. The model is publicly available and can handle QAP instances of arbitrary size.

## Method Summary
The two-stage GPN is a deep reinforcement learning model designed to solve the Quadratic Assignment Problem (QAP). It extends the original GPN architecture, which was initially developed for Euclidean Traveling Salesman Problem (TSP). The model consists of two stages: a block selection model and an in-block model. The block selection model identifies a focused block of elements from the problem instance, and then the in-block model generates the solution using the elements within the selected block. This two-stage approach aims to improve efficiency and scalability for solving QAP instances.

## Key Results
- Two-stage GPN provides semi-optimal solutions for QAP benchmark instances from TSPlib and QAPLIB
- Outperforms conventional heuristic methods in terms of execution time
- Solution quality is inferior to conventional heuristic methods
- Model is publicly available and can solve QAP instances of arbitrary size

## Why This Works (Mechanism)
The two-stage GPN leverages the strengths of deep reinforcement learning to efficiently explore the solution space of the QAP. By decomposing the problem into two stages—block selection and in-block solution generation—the model can focus computational resources on promising regions of the search space. The pointer network architecture allows for flexible handling of variable-sized problem instances, while the reinforcement learning framework enables the model to learn effective policies for block selection and solution construction without requiring labeled data.

## Foundational Learning
- **Graph Neural Networks**: Used to encode problem structure and relationships between elements. Needed for capturing spatial and structural dependencies in QAP instances. Quick check: Verify that graph representations effectively capture problem constraints.
- **Pointer Networks**: Generate permutations of elements by pointing to positions in the input sequence. Essential for constructing valid solutions to combinatorial problems. Quick check: Ensure pointer outputs maintain feasibility constraints.
- **Reinforcement Learning**: Trains the model through rewards rather than supervised labels. Critical for learning effective policies without requiring optimal solutions. Quick check: Validate reward shaping leads to improved solution quality.
- **Block Decomposition Strategy**: Divides the problem into manageable subproblems. Helps scale to larger instances by reducing computational complexity. Quick check: Assess whether block size selection impacts solution quality.
- **Two-Stage Architecture**: Separates problem exploration from solution construction. Allows focused computation on promising regions. Quick check: Measure impact of each stage on overall performance.
- **Euclidean TSP Extension**: Adapting TSP solution methods to QAP framework. Provides a foundation for applying pointer networks to assignment problems. Quick check: Compare performance with original GPN on TSP instances.

## Architecture Onboarding

**Component Map**: Input Graph -> Graph Encoder -> Block Selection Model -> In-Block Model -> Solution Output

**Critical Path**: The critical execution path flows from the input graph through the graph encoder, to the block selection model, then to the in-block model, and finally produces the solution output. The block selection stage determines which elements are passed to the in-block model, making it a key bottleneck for performance.

**Design Tradeoffs**: The two-stage architecture trades solution quality for computational efficiency. By focusing on blocks rather than the entire problem, execution time is reduced, but this may miss globally optimal solutions that require considering the full problem context. The pointer network approach provides flexibility for variable-sized instances but may struggle with complex constraint structures.

**Failure Signatures**: The model may fail when block selection consistently chooses suboptimal regions of the search space, leading to poor final solutions. Performance degradation can occur on highly constrained instances where local block optimization doesn't capture global structure. Large instance sizes may also challenge the model's ability to maintain solution quality.

**3 First Experiments**:
1. Test the model on small QAP instances with known optimal solutions to establish baseline performance.
2. Compare execution time and solution quality against single-stage GPN variants.
3. Evaluate the impact of different block sizes on both solution quality and computational efficiency.

## Open Questions the Paper Calls Out
None

## Limitations
- Solution quality is inferior to conventional heuristic methods despite faster execution time
- Evaluation limited to benchmark instances from TSPlib and QAPLIB, not tested on real-world applications
- Performance trade-off may limit practical applicability in scenarios requiring high-quality solutions

## Confidence
- Two-stage GPN improves execution time over conventional heuristics: **Medium**
- Model can solve QAP instances of arbitrary size: **Medium**
- Solution quality trade-off is acceptable for practical use: **Low**

## Next Checks
1. Evaluate the two-stage GPN on real-world QAP instances from industry applications to assess practical relevance and performance trade-offs.
2. Conduct a comprehensive comparison with state-of-the-art heuristic methods on larger QAP instances to better understand scalability and solution quality.
3. Perform ablation studies to determine the individual contributions of the block selection and in-block models to overall performance.