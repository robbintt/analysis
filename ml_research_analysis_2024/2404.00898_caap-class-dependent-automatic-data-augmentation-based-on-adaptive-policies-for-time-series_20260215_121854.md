---
ver: rpa2
title: 'CAAP: Class-Dependent Automatic Data Augmentation Based On Adaptive Policies
  For Time Series'
arxiv_id: '2404.00898'
source_url: https://arxiv.org/abs/2404.00898
tags:
- augmentation
- data
- bias
- class-dependent
- policy
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a novel deep learning-based approach called
  Class-dependent Automatic Adaptive Policies (CAAP) framework to overcome the notable
  class-dependent bias problem while maintaining the overall improvement in time-series
  data augmentation. Specifically, we utilize the policy network to generate effective
  sample-wise policies with balanced difficulty through class and feature information
  extraction.
---

# CAAP: Class-Dependent Automatic Data Augmentation Based On Adaptive Policies For Time Series

## Quick Facts
- arXiv ID: 2404.00898
- Source URL: https://arxiv.org/abs/2404.00898
- Reference count: 40
- Primary result: Novel framework that reduces class-dependent bias while maintaining overall performance in time series augmentation

## Executive Summary
This paper addresses the critical problem of class-dependent bias in time series data augmentation, where standard augmentation strategies can degrade performance on specific classes while improving overall accuracy. The proposed Class-dependent Automatic Adaptive Policies (CAAP) framework introduces three key innovations: a policy network that generates sample-wise augmentation policies using class and feature information, a class-dependent regulation module that adjusts augmentation probabilities based on class recall, and an information region adaption module that preserves essential signal regions during augmentation. Through extensive experiments on real-world ECG datasets, CAAP demonstrates superior performance in reducing class-dependent bias while maintaining or improving overall classification accuracy.

## Method Summary
CAAP is a deep learning-based automatic data augmentation framework designed specifically for time series data. The framework consists of three interconnected modules: a policy network that generates sample-specific augmentation policies conditioned on both feature embeddings and label information, a class-dependent regulation module that adjusts the probability of applying no augmentation based on class recall metrics during the search phase, and an information region adaption module that uses saliency maps to identify and protect informative regions of the time series during augmentation. The framework is trained using a two-phase approach: first, during the search phase, class recall is measured and used to adjust augmentation probabilities; second, during the training phase, the updated policies and information region protection are applied to train the final classifier.

## Key Results
- CAAP achieves lower class-dependent bias compared to representative methods while maintaining superior overall performance on ECG datasets
- The framework successfully preserves essential information regions (e.g., PQRST waves in ECG) during augmentation, reducing model degradation
- CAAP demonstrates reliable performance across multiple classifier architectures including 1D-ResNet, FCN, and LSTM

## Why This Works (Mechanism)

### Mechanism 1
- Claim: CAAP reduces class-dependent bias by reweighting no-augmentation probability based on class recall
- Mechanism: The framework computes class-wise recall during the search phase and uses it to adjust the weight of the no-augmentation transformation, thereby protecting underrepresented classes from degradation
- Core assumption: Higher class recall correlates with lower sensitivity to augmentation bias, and vice versa
- Evidence anchors:
  - [abstract]: "Second, we design the augmentation probability regulation method to minimize class-dependent bias"
  - [section]: "The Class-dependent Regulation module adjusts the weight of no-augmentation...based on the performance of each class during the search phase..."
  - [corpus]: Weak or missing direct support; [corpus] anchor states "Average neighbor FMR=0.454, average citations=0.1", indicating limited external validation of this specific mechanism
- Break condition: If class recall does not correlate with augmentation sensitivity, the reweighting may fail to reduce bias and could even harm overall performance

### Mechanism 2
- Claim: CAAP preserves informative time series regions (e.g., ECG waveform segments) during augmentation, reducing model degradation
- Mechanism: A saliency map identifies important signal regions, and the augmentation process replaces these regions in augmented samples with their original versions to maintain critical information
- Core assumption: Certain waveform segments (like PQRST waves in ECG) carry most diagnostic information, and their distortion during augmentation leads to performance loss
- Evidence anchors:
  - [abstract]: "Third, we introduce the information region concepts into the ADA framework to preserve essential regions in the sample"
  - [section]: "The information region, such as PQRST wave properties in ECG signals, is a critical concept of transform-based data augmentation..."
  - [corpus]: Weak or missing; [corpus] anchor states "Average neighbor FMR=0.454", indicating sparse external corroboration
- Break condition: If the saliency map misidentifies important regions, or if the replacement process introduces artifacts, model performance could worsen

### Mechanism 3
- Claim: CAAP uses class and feature information in the policy network to generate sample-wise augmentation policies, leading to better overall and class-specific performance
- Mechanism: The policy network takes both feature embeddings and label information as input, enabling it to tailor augmentation to each sample's class and difficulty
- Core assumption: Augmenting samples with policy learned from both feature and label information reduces bias more effectively than class-blind augmentation
- Evidence anchors:
  - [abstract]: "Specifically, we utilize the policy network to generate effective sample-wise policies with balanced difficulty through class and feature information extraction"
  - [section]: "The feature embedding is obtained from the sample's representation after the final pooling layer. At the same time, the label information is transformed into one-hot encoding..."
  - [corpus]: Weak or missing; [corpus] anchor states "Average neighbor FMR=0.454", indicating little external support for this claim
- Break condition: If the feature embedding does not capture relevant information or if label leakage occurs, the policy may overfit or misguide augmentation

## Foundational Learning

- Concept: Class-dependent bias in data augmentation
  - Why needed here: Understanding that augmentation can harm specific classes even as it improves overall accuracy is central to CAAP's motivation and design
  - Quick check question: What is class-dependent bias, and how can it manifest in time series augmentation?
- Concept: Saliency maps and their use in identifying informative regions
  - Why needed here: CAAP uses saliency maps to preserve important time series segments; understanding this technique is key to grasping its augmentation strategy
  - Quick check question: How does a saliency map help in identifying and protecting informative regions during augmentation?
- Concept: Policy networks and sample-wise augmentation strategies
  - Why needed here: CAAP's policy network generates augmentation policies conditioned on sample features and labels; this is a departure from fixed or class-level policies
  - Quick check question: How does a policy network conditioned on sample features and labels differ from a fixed augmentation policy?

## Architecture Onboarding

- Component map: Classifier Network <- Policy Network (feature embeddings + label embeddings) -> Class-Dependent Regulation -> Information Region Adaption
- Critical path:
  1. During search phase: Feed samples to policy network → get augmentation policy → augment data → train classifier → measure class recall
  2. Adjust no-augmentation weight using class recall
  3. During training phase: Use updated policy + information region protection → augment data → train classifier
- Design tradeoffs:
  - Trade-off between accuracy and class-dependent bias: Increasing no-augmentation probability can reduce bias but may hurt overall accuracy
  - Complexity vs. performance: Adding saliency map computation and policy conditioning increases overhead but yields better class balance
  - Generalization vs. specialization: Information region adaption is especially valuable for time series but may be less relevant for other domains
- Failure signatures:
  - If class recall is not correlated with augmentation bias, Class-Dependent Regulation may worsen performance
  - If saliency map computation is unstable or noisy, Information Region Adaption may introduce artifacts
  - If feature embeddings are not discriminative, policy network may fail to generate effective policies
- First 3 experiments:
  1. Run CAAP on a small, well-understood ECG dataset with known class imbalance; measure both overall accuracy and class-wise recall to observe bias reduction
  2. Compare CAAP's performance with and without the Information Region Adaption module on a time series dataset to quantify the benefit of region protection
  3. Vary the no-augmentation weight adjustment factor (alpha) to observe its impact on the trade-off between accuracy and class-dependent bias

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal balance between improving overall model performance and reducing class-dependent bias in automatic data augmentation?
- Basis in paper: [explicit] The paper states "The relationship between model class-dependent bias and overall performance may involve trade-offs" and introduces metrics to measure class-dependent bias
- Why unresolved: The paper shows there is a trade-off but doesn't provide a definitive framework for finding the optimal balance point
- What evidence would resolve it: Empirical studies comparing various trade-off strategies across multiple datasets and tasks, with quantified relationships between bias reduction and performance loss

### Open Question 2
- Question: How can information region preservation techniques be generalized across different types of time series data beyond ECG signals?
- Basis in paper: [explicit] The paper introduces information region concepts specifically for ECG signals but notes "different datasets or classes may have different information regions"
- Why unresolved: The current method is tailored to ECG waveform properties and would need adaptation for other time series domains
- What evidence would resolve it: Successful application and validation of information region preservation techniques on diverse time series domains (financial, sensor data, speech, etc.)

### Open Question 3
- Question: What are the most effective ways to integrate sample-specific feature information into automatic data augmentation policies?
- Basis in paper: [explicit] The paper uses feature embeddings in its policy network but notes "their adaptive policy does not benefit the model or even degrade the model's overall performance"
- Why unresolved: The paper demonstrates effectiveness but doesn't explore the full space of feature integration methods or compare different approaches
- What evidence would resolve it: Systematic comparison of different feature extraction and integration methods for ADA across multiple tasks and datasets

## Limitations

- The framework's complexity and computational overhead may limit its applicability to resource-constrained environments
- Reliance on saliency maps for information region preservation may not generalize well to non-ECG time series data
- Lack of ablation studies makes it difficult to isolate the individual contributions of each module

## Confidence

- High Confidence: The core motivation (class-dependent bias in data augmentation) and the overall framework design are well-supported
- Medium Confidence: The effectiveness of the Class-Dependent Regulation module is supported by experimental results but lacks detailed analysis of its impact on individual classes
- Low Confidence: The Information Region Adaption module's contribution is not clearly separated from other components in the experiments, making it difficult to assess its standalone impact

## Next Checks

1. Conduct ablation studies to isolate and quantify the contributions of the Class-Dependent Regulation and Information Region Adaption modules
2. Evaluate CAAP on diverse time series datasets (e.g., sensor data, speech signals) to assess generalizability beyond ECG data
3. Analyze the impact of varying the no-augmentation weight adjustment factor (alpha) on the trade-off between accuracy and class-dependent bias