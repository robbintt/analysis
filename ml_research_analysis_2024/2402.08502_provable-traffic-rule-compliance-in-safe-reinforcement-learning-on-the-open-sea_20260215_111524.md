---
ver: rpa2
title: Provable Traffic Rule Compliance in Safe Reinforcement Learning on the Open
  Sea
arxiv_id: '2402.08502'
source_url: https://arxiv.org/abs/2402.08502
tags:
- vessel
- collision
- traffic
- rules
- maneuver
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces a provably safe reinforcement learning (RL)
  approach for autonomous vessels that ensures legal safety by complying with traffic
  rules formalized in temporal logic. The approach integrates an online safety verification
  based on a statechart that models the hierarchy of the rules, allowing the agent
  to only select actions that are verified as compliant with the formalized rules.
---

# Provable Traffic Rule Compliance in Safe Reinforcement Learning on the Open Sea

## Quick Facts
- arXiv ID: 2402.08502
- Source URL: https://arxiv.org/abs/2402.08502
- Reference count: 40
- Key outcome: RL agent achieves 100% rule compliance and zero collisions while maintaining high goal-reaching rates

## Executive Summary
This work presents a provably safe reinforcement learning approach for autonomous vessels that ensures compliance with maritime traffic rules formalized in temporal logic. The method integrates online safety verification using a statechart-based system that models the hierarchy of collision avoidance rules, specifically the Convention on the International Regulations for Preventing Collisions at Sea (COLREGS). By verifying actions against formalized rules before execution, the approach guarantees legal safety while maintaining operational effectiveness. The method includes both a primary rule-compliant controller and an emergency controller for critical situations.

## Method Summary
The approach combines reinforcement learning with formal verification by integrating a statechart-based online safety checker that models the hierarchy of maritime traffic rules. The system first formalizes COLREGS into temporal logic specifications, then constructs a statechart representing the rule hierarchy and vessel dynamics. During training and deployment, the RL agent proposes actions that are verified by the statechart for compliance before execution. A separate emergency controller handles situations where the primary controller cannot find a compliant action. The verification process efficiently checks whether candidate actions satisfy the temporal logic constraints representing traffic rules, ensuring that the agent only selects actions that maintain legal compliance while pursuing its objectives.

## Key Results
- Agent achieves 100% compliance with formalized COLREGS in all tested scenarios
- Zero collision rate maintained throughout training and deployment phases
- Significantly outperforms vanilla RL and traffic rule-informed RL baselines in both rule compliance and collision avoidance
- Maintains high goal-reaching rates despite the conservative safety constraints

## Why This Works (Mechanism)
The approach works by creating a formal bridge between high-level traffic rules and low-level control actions through temporal logic specifications and statechart-based verification. The statechart efficiently represents the hierarchical structure of maritime rules, allowing rapid verification of candidate actions against multiple rule layers simultaneously. By integrating this verification directly into the action selection process, the system prevents violations at the source rather than attempting to correct them after they occur. The emergency controller provides a safety fallback for situations where rule-compliant actions cannot achieve the desired objective, ensuring both safety and functionality are maintained even in edge cases.

## Foundational Learning
- Temporal logic for rule formalization: Converts high-level traffic rules into precise mathematical specifications that can be algorithmically verified - needed to bridge natural language rules with computational verification, quick check: verify that all COLREGS rules have corresponding temporal logic formulas
- Statechart-based verification: Uses hierarchical state machines to represent rule compliance conditions and efficiently verify action safety - needed for scalable online verification during RL training, quick check: verify that statechart can correctly classify compliant vs non-compliant actions in known scenarios
- COLREGS collision avoidance hierarchy: Implements the priority structure of maritime rules (e.g., give-way vs stand-on vessel responsibilities) - needed to ensure proper rule application order in complex scenarios, quick check: verify that the hierarchy is correctly enforced in multi-vessel interactions

## Architecture Onboarding
Component map: RL Agent -> Action Proposal -> Statechart Verifier -> Compliance Check -> (Pass) Execute Action / (Fail) Emergency Controller

Critical path: Action selection occurs through RL agent proposal, statechart verification of compliance, and conditional execution based on verification result, with emergency controller as fallback.

Design tradeoffs: The conservative safety approach may limit exploration during training but ensures provable safety guarantees; the statechart verification adds computational overhead but enables formal safety guarantees; emergency controller provides safety fallback but may reduce optimality in rare edge cases.

Failure signatures: Violations occur when the statechart verification fails to capture edge cases in temporal logic specifications; performance degradation may occur when emergency controller is triggered too frequently; scalability issues may arise with increased vessel complexity.

First experiments:
1. Test single-vessel navigation with static obstacles to verify basic rule compliance
2. Evaluate two-vessel crossing scenarios to test give-way/stand-on rule enforcement
3. Assess emergency controller activation in artificially constrained situations

## Open Questions the Paper Calls Out
The paper does not explicitly call out open questions beyond the immediate scope of the work.

## Limitations
- Formalization of COLREGS into temporal logic may not capture all real-world ambiguities and edge cases in maritime collision avoidance
- Statechart-based verification system's scalability to complex multi-vessel scenarios remains untested
- Emergency controller lacks detailed validation in highly dynamic situations

## Confidence
High: Experimental results showing improved rule compliance and collision avoidance compared to baseline RL methods appear robust within tested scenarios; formal verification methodology is technically sound.

Medium: Generalizability to diverse maritime environments and varying vessel types needs further validation; computational efficiency claims during online verification require more extensive testing with larger state spaces.

Low: Long-term stability of rule compliance during extended deployment is not well-established; performance in scenarios with incomplete or noisy sensor data is untested.

## Next Checks
1. Test the approach in multi-vessel scenarios with up to 10 interacting vessels to assess scalability and emergent behavior handling
2. Evaluate performance with realistic sensor noise and occlusions to verify robustness in imperfect information conditions
3. Conduct extended deployment simulations (100+ episodes) to assess stability of rule compliance and goal-reaching rates over time