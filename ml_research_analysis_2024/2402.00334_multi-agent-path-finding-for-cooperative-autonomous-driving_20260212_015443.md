---
ver: rpa2
title: Multi-agent Path Finding for Cooperative Autonomous Driving
arxiv_id: '2402.00334'
source_url: https://arxiv.org/abs/2402.00334
tags:
- crossing
- vehicle
- order
- vehicles
- time
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces Order-based Search with Kinematics Arrival
  Time Scheduling (OBS-KATS), an optimal and complete algorithm for coordinating connected
  and automated vehicles at signal-free intersections. The method combines MAPF-inspired
  prioritized planning and order-based search algorithms with a kinematics-aware arrival
  time scheduling technique (KATS) to find optimal vehicle crossing orders, which
  are then used to plan trajectories via trajectory optimization.
---

# Multi-agent Path Finding for Cooperative Autonomous Driving

## Quick Facts
- arXiv ID: 2402.00334
- Source URL: https://arxiv.org/abs/2402.00334
- Authors: Zhongxia Yan; Han Zheng; Cathy Wu
- Reference count: 32
- This paper introduces OBS-KATS, an optimal and complete algorithm for coordinating connected and automated vehicles at signal-free intersections.

## Executive Summary
This paper presents OBS-KATS (Order-based Search with Kinematics Arrival Time Scheduling), an optimal and complete algorithm for coordinating connected and automated vehicles at signal-free intersections. The method combines MAPF-inspired prioritized planning and order-based search algorithms with a kinematics-aware arrival time scheduling technique to find optimal vehicle crossing orders, which are then used to plan trajectories via trajectory optimization. The algorithm significantly outperforms existing methods including FIFO, Monte Carlo Tree Search (MCTS), and prioritized planning with KATS, achieving average vehicle delays of 4.7s compared to 6.0s for MCTS under standard conditions.

## Method Summary
OBS-KATS integrates Order-based Search (OBS) with Kinematics Arrival Time Scheduling (KATS) to solve multi-agent path finding for cooperative autonomous driving at intersections. The method first generates vehicle crossing orders using either prioritized planning or order-based search, then schedules arrival/departure times at reservation subzones using KATS, and finally computes feasible trajectories via trajectory optimization. The intersection is divided into 16 reservation subzones, with each subzone allowing only one vehicle at a time. KATS computes optimal constant-speed crossing times for each vehicle consistent with the crossing order, while trajectory optimization ensures the resulting paths are kinematically feasible.

## Key Results
- OBS-KATS achieves average vehicle delays of 4.7s compared to 6.0s for MCTS under standard conditions
- The algorithm is proven sound, complete, and optimal for finding vehicle crossing orders
- OBS with norders = ∞ finds the optimal constant-speed crossing order when one exists
- Traffic heuristics significantly reduce search space while maintaining solution quality

## Why This Works (Mechanism)

### Mechanism 1
OBS-KATS achieves optimal vehicle crossing orders by leveraging partial orderings rather than total orderings. The Order-based Search algorithm searches the space of all partial orderings consistent with total orderings of vehicles crossing each subzone, allowing it to find optimal precedence relations early in the search. The optimal crossing order can be reached by adding optimal precedence relations along some branch of the OBS tree.

### Mechanism 2
KATS acts as an efficient single-agent path planner for complex kinematics. It computes optimal constant-speed crossing times for each vehicle consistent with the crossing order by scheduling arrival/departure times at reservation subzones. Constant-speed crossing within subzones is assumed to be optimal or near-optimal for minimizing delay.

### Mechanism 3
Traffic heuristics significantly reduce search space while maintaining solution quality. Two heuristics are applied: 1) Vehicles are constrained to be sampled after their leader in the lane, reducing search space from O(|K|!) to O(4|K|), and 2) Vehicles with earliest minimum arrival times are prioritized. The optimal crossing order respects lane ordering and prioritizes vehicles closest to the intersection.

## Foundational Learning

- Concept: Multi-agent path finding (MAPF)
  - Why needed here: OBS-KATS adapts MAPF algorithms (prioritized planning, conflict-based search) for cooperative driving at intersections
  - Quick check question: What is the key difference between classical MAPF and continuous MAPF as applied in OBS-KATS?

- Concept: Kinematic bicycle model
  - Why needed here: The algorithm uses a kinematic bicycle model for trajectory execution, requiring understanding of vehicle dynamics
  - Quick check question: How does the kinematic bicycle model relate the front wheel steering angle δ to the vehicle's heading ψ?

- Concept: Reservation systems for collision avoidance
  - Why needed here: The intersection is divided into 16 reservation subzones that can only be occupied by one vehicle at a time
  - Quick check question: Why does the subzone design in OBS-KATS permit four turning vehicles to pass simultaneously while previous designs did not?

## Architecture Onboarding

- Component map:
  - High-level planner: OBS (Order-based Search) or PP (Prioritized Planning)
  - Low-level planner: KATS (Kinematic Arrival Time Scheduling)
  - Trajectory optimizer: CVXPY-based optimization
  - Execution layer: Kinematic bicycle model with PID steering controller
  - Environment: HighwayEnv simulation with 0.1s discretization

- Critical path:
  1. Vehicle arrival detection
  2. OBS/PP generates crossing order
  3. KATS schedules subzone arrival/departure times
  4. Trajectory optimization computes feasible trajectories
  5. Execute next step along vehicle trajectories
  6. Repeat every Hc timesteps

- Design tradeoffs:
  - KATS vs full trajectory optimization: KATS is fast but may be overly optimistic; trajectory optimization is accurate but computationally expensive
  - Search depth vs computation time: OBS explores partial orderings but has exponential worst-case complexity
  - Frequency of replanning: More frequent replanning (lower Hc) may improve responsiveness but increases computation

- Failure signatures:
  - Vehicle collisions: Indicates KATS/Trajectory optimization mismatch or insufficient safety margins
  - Deadlock: Suggests crossing order doesn't account for all conflict scenarios
  - Excessive delays: May indicate suboptimal ordering or overly conservative scheduling
  - Algorithm timeout: Suggests search space too large or insufficient computational resources

- First 3 experiments:
  1. Baseline comparison: Run FIFO, MCTS, PP, and OBS-KATS on default configuration (λ=1500, ℓlane=250m) and measure average delay
  2. Search efficiency: Vary norders parameter for PP and OBS, plot delay vs computation time to demonstrate OBS advantage
  3. Robustness test: Vary arrival rates (1000-2000 veh/hr) and lane lengths (50-500m) to identify configuration limits

## Open Questions the Paper Calls Out

### Open Question 1
How does the performance of OBS-KATS scale when applied to larger, more complex intersection configurations beyond the studied four-way intersection, such as multi-junction networks or intersections with more than four directions? The authors note that OBS-KATS is directly applicable to many similarly scaled traffic and multi-robot scenarios with directed lanes, suggesting potential for broader application, but do not explore this in the study.

### Open Question 2
What are the implications of using trajectory optimization in OBS-KATS when there is a mismatch between the kinematics used in MAPF and those used in trajectory optimization, especially in terms of feasibility and optimality of the planned trajectories? The authors acknowledge that KATS may be overly optimistic and inconsistent with trajectory optimization due to not preventing collisions outside the intersection, and discuss the potential mismatch between simplified kinematics and trajectory optimization.

### Open Question 3
How does OBS-KATS perform in mixed traffic settings where human-driven vehicles are present alongside connected and automated vehicles (CAVs), considering the stochasticity of human driving behavior? The authors mention the potential for future directions to extend the algorithm to mixed traffic settings, indicating that this is an area of interest but not explored in the current study.

## Limitations

- The optimality proof for OBS relies on the assumption that the optimal crossing order can be reached by adding optimal precedence relations along some branch of the OBS tree, but no empirical validation shows this covers all optimal scenarios
- KATS assumes constant-speed crossing within subzones is near-optimal, but complex maneuvers might require variable speeds not captured by the current formulation
- The effectiveness of traffic heuristics (lane ordering constraints and minimum arrival time prioritization) is stated but not rigorously validated against unconstrained search

## Confidence

- **High confidence**: The fundamental framework of combining MAPF-inspired search with kinematics-aware scheduling is sound and the basic mathematical formulations are correct
- **Medium confidence**: The claimed performance improvements over baselines (4.7s vs 6.0s delay) are based on the reported experiments, but the robustness across diverse scenarios needs validation
- **Low confidence**: The completeness and optimality claims for OBS-KATS are proven mathematically but may not hold in all practical scenarios due to the simplifying assumptions

## Next Checks

1. Implement an unconstrained version of the order-based search to empirically test whether the traffic heuristics prune any optimal solutions
2. Run comprehensive stress tests varying arrival rates (1000-2500 veh/hr) and intersection geometries to identify performance limits and failure modes
3. Compare against state-of-the-art MARL approaches like those in the related work to benchmark the classical optimization approach against learning-based methods