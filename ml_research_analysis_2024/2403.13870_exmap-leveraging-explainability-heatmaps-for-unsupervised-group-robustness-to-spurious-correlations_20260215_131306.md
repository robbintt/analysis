---
ver: rpa2
title: 'ExMap: Leveraging Explainability Heatmaps for Unsupervised Group Robustness
  to Spurious Correlations'
arxiv_id: '2403.13870'
source_url: https://arxiv.org/abs/2403.13870
tags:
- group
- exmap
- robustness
- clustering
- spurious
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: ExMap introduces an unsupervised method for group robustness by
  clustering explainability heatmaps to generate pseudo-labels, avoiding reliance
  on ground-truth group labels. It clusters LRP heatmaps extracted from a trained
  model, producing pseudo-labels used with existing group-robustness strategies (e.g.,
  DFR, JTT).
---

# ExMap: Leveraging Explainability Heatmaps for Unsupervised Group Robustness to Spurious Correlations

## Quick Facts
- arXiv ID: 2403.13870
- Source URL: https://arxiv.org/abs/2403.13870
- Authors: Rwiddhi Chakraborty; Adrian Sletten; Michael Kampffmeyer
- Reference count: 40
- One-line primary result: ExMap outperforms GEORGE and other unsupervised baselines on Waterbirds, CelebA, C-MNIST, and Urbancars, narrowing the gap to supervised methods.

## Executive Summary
ExMap introduces an unsupervised method for group robustness by clustering explainability heatmaps to generate pseudo-labels, avoiding reliance on ground-truth group labels. It clusters LRP heatmaps extracted from a trained model, producing pseudo-labels used with existing group-robustness strategies (e.g., DFR, JTT). ExMap outperforms GEORGE and other unsupervised baselines on Waterbirds, CelebA, C-MNIST, and Urbancars, narrowing the gap to supervised methods. On multiple shortcut datasets, ExMap avoids the Whac-A-Mole dilemma, maintaining robustness without ground-truth shortcut labels.

## Method Summary
ExMap is a two-stage unsupervised approach for group robustness that clusters explainability heatmaps to generate pseudo-labels for retraining. First, a base ERM model is trained and frozen, then LRP heatmaps are extracted from validation data. These heatmaps are clustered (using spectral clustering or k-means) to produce pseudo-group labels by combining class and spurious attribute clusters. The pseudo-labels replace true group labels in existing group-robustness strategies like DFR or JTT, enabling retraining without ground-truth group annotations.

## Key Results
- ExMap outperforms GEORGE and other unsupervised baselines on Waterbirds, CelebA, C-MNIST, and Urbancars datasets
- Maintains robustness on multiple shortcut datasets without ground-truth shortcut labels, avoiding Whac-A-Mole dilemma
- Ablation studies show clustering heatmaps captures relevant features better than raw features
- Method is robust to clustering choice and retraining strategy selection

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Clustering LRP heatmaps uncovers model's decision-making strategies that capture spurious correlations better than raw features.
- Mechanism: The model's pixel-level attributions isolate relevant features, clustering them reveals dominant strategies used across groups.
- Core assumption: Explainability heatmaps focus only on task-relevant pixels, discarding spurious features irrelevant for the final prediction.
- Evidence anchors:
  - [abstract] "clustering explainability heatmaps instead, is more beneficial in improving worst group robustness"
  - [section 4.1] "the heatmaps capture the different strategies undertaken by the model for the classification task"
  - [corpus] Weak evidence for direct superiority claim; similarity to GEORGE suggests heatmap-based clustering is competitive but not necessarily superior
- Break condition: If heatmaps do not adequately isolate relevant features (e.g., model uses complex non-pixel-based reasoning), clustering will fail to capture useful group structure.

### Mechanism 2
- Claim: Pseudo-labels generated from clustered heatmaps enable group-robust retraining without ground-truth group annotations.
- Mechanism: Clustered heatmaps are mapped to pseudo-group labels, which are then used by existing group-robustness strategies like DFR or JTT.
- Core assumption: The clustering module can infer meaningful group structure from heatmaps without access to true group labels.
- Evidence anchors:
  - [abstract] "clustering module to infer pseudo-labels based on a model’s explainability heatmaps, which are then used during training in lieu of actual labels"
  - [section 4.2] "the clustering module helps identify dominant model strategies used for the classification task"
  - [corpus] Weak evidence for pseudo-label quality; no direct comparison of pseudo-label accuracy vs ground truth
- Break condition: If clustering fails to separate groups (e.g., overlapping heatmap distributions), pseudo-labels will be meaningless and retraining will not improve robustness.

### Mechanism 3
- Claim: ExMap is strategy-agnostic and can be combined with any group-robustness method that uses group labels.
- Mechanism: The pseudo-labels generated by ExMap replace true group labels as input to existing methods like DFR, JTT, or Group-DRO.
- Core assumption: Existing group-robustness methods can accept pseudo-labels without modification to their training procedures.
- Evidence anchors:
  - [abstract] "ExMap can be seamlessly integrated with existing group robustness learning strategies"
  - [section 4.2] "can now be used as labels in lieu of ground truth labels to train any group robustness strategy in use"
  - [section 6.3] "ExMap is strategy-agnostic... we show the results after applying ExMap to the JTT method"
- Break condition: If the downstream method is sensitive to label quality or requires specific label properties, pseudo-labels may degrade performance.

## Foundational Learning

- Concept: Layer-wise Relevance Propagation (LRP)
  - Why needed here: LRP generates pixel-level relevance scores that form the heatmaps for clustering.
  - Quick check question: What does LRP compute at each neuron in terms of contribution to the output?
- Concept: Group Robustness Paradigm
  - Why needed here: Understanding worst-group accuracy and how spurious correlations create performance gaps.
  - Quick check question: Why is mean test accuracy insufficient for evaluating models with spurious correlations?
- Concept: Spectral Clustering with Eigengap Heuristic
  - Why needed here: The default clustering method for generating pseudo-labels from heatmaps.
  - Quick check question: How does the eigengap heuristic determine the number of clusters to use?

## Architecture Onboarding

- Component map:
  Base ERM model → LRP heatmap extraction → Clustering module → Pseudo-labels → Group-robustness retraining (DFR/JTT)
- Critical path:
  1. Train base ERM model on training data
  2. Extract LRP heatmaps from validation data
  3. Cluster heatmaps to generate pseudo-labels
  4. Retrain using pseudo-labels with DFR or JTT
- Design tradeoffs:
  - Heatmap resolution vs computational cost: Higher resolution captures more detail but increases clustering time
  - Clustering method choice: Spectral clustering vs k-means affects pseudo-label quality and computational efficiency
  - Strategy selection: DFR vs JTT affects final performance and implementation complexity
- Failure signatures:
  - Pseudo-labels do not improve worst-group accuracy despite clustering
  - Heatmap extraction produces noisy or uninformative attributions
  - Clustering produces too many/few clusters relative to true group structure
- First 3 experiments:
  1. Run LRP heatmap extraction on validation data and visualize a few examples to verify attributions make sense
  2. Apply k-means clustering to downsized heatmaps and check if pseudo-labels roughly align with known group structure (if available)
  3. Compare worst-group accuracy of DFR with true labels vs ExMap pseudo-labels on a small dataset like C-MNIST

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does ExMap perform on datasets with more than two spurious attributes per class label?
- Basis in paper: [explicit] The paper discusses ExMap's performance on Urbancars dataset with two spurious attributes (background and co-occurring object), and mentions the Whac-A-Mole dilemma where mitigating one shortcut may exacerbate reliance on another. However, it does not explore scenarios with more than two attributes.
- Why unresolved: The paper only tests on datasets with at most two spurious attributes, leaving the behavior with more complex spurious correlation structures unexplored.
- What evidence would resolve it: Experiments on synthetic datasets or real-world datasets with three or more spurious attributes per class, comparing ExMap's performance against baseline methods.

### Open Question 2
- Question: Can ExMap be extended to handle sequential or temporal data where spurious correlations may vary over time?
- Basis in paper: [inferred] ExMap operates on static images and uses clustering of explainability heatmaps from a fixed model. The paper does not address temporal dependencies or evolving spurious correlations.
- Why unresolved: The method is designed for image classification tasks without consideration for temporal dynamics or sequential data structures.
- What evidence would resolve it: Applying ExMap to video classification or time-series data, evaluating whether temporal clustering of heatmaps improves robustness to time-varying spurious correlations.

### Open Question 3
- Question: What is the computational overhead of ExMap compared to standard ERM training, and how does it scale with dataset size?
- Basis in paper: [inferred] The paper mentions heatmap extraction and clustering but does not provide quantitative analysis of computational cost or scalability.
- Why unresolved: No runtime analysis or scaling experiments are presented to understand practical deployment constraints.
- What evidence would resolve it: Benchmarking ExMap's training and inference time against ERM across varying dataset sizes and model architectures, including memory usage for large-scale applications.

## Limitations

- The effectiveness of clustering explainability heatmaps versus other feature representations lacks direct empirical validation, with only weak evidence supporting superiority over GEORGE.
- The unsupervised nature of ExMap means there is no ground truth for evaluating pseudo-label quality, creating inherent limitations in assessing whether clustering captures meaningful group structure.
- Computational overhead of extracting and clustering LRP heatmaps at high resolution is not thoroughly analyzed, and method's performance on more complex, real-world datasets remains untested.

## Confidence

- **High Confidence**: The core pipeline (ERM → LRP → clustering → retraining) is clearly specified and reproducible. The integration with existing group-robustness methods (DFR, JTT) is well-documented.
- **Medium Confidence**: The performance improvements over baselines are demonstrated on multiple datasets, but the superiority claim over GEORGE lacks direct comparative analysis of their respective mechanisms. The strategy-agnostic nature is supported but not extensively validated across diverse robustness methods.
- **Low Confidence**: The claim that clustering heatmaps is "more beneficial" than raw features is weakly supported, with no systematic comparison or theoretical justification provided. The method's generalization to complex, real-world scenarios is untested.

## Next Checks

1. Conduct a direct ablation study comparing ExMap's heatmap clustering against GEORGE's feature clustering on the same datasets to quantify relative performance differences.
2. Evaluate pseudo-label quality by testing ExMap on datasets where ground-truth group labels are available (e.g., using a subset of labeled data) to measure clustering accuracy.
3. Test ExMap on a more complex, real-world dataset (e.g., medical imaging or satellite data) with subtle spurious correlations to assess scalability and robustness beyond benchmark datasets.