---
ver: rpa2
title: Efficient Causal Graph Discovery Using Large Language Models
arxiv_id: '2402.01207'
source_url: https://arxiv.org/abs/2402.01207
tags:
- causal
- graph
- proposed
- variables
- discovery
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces a more efficient LLM-based approach for causal
  graph discovery that avoids the quadratic query complexity of pairwise methods by
  using breadth-first search (BFS) to traverse the graph. The method queries the LLM
  to identify all children of each node during BFS traversal, requiring only linear
  queries.
---

# Efficient Causal Graph Discovery Using Large Language Models

## Quick Facts
- arXiv ID: 2402.01207
- Source URL: https://arxiv.org/abs/2402.01207
- Reference count: 17
- Primary result: BFS-based LLM approach achieves linear query complexity for causal graph discovery

## Executive Summary
This paper introduces an efficient LLM-based method for causal graph discovery that addresses the quadratic query complexity of pairwise approaches. The method uses breadth-first search traversal to identify causal relationships, querying the LLM to find all children of each node during traversal. This approach requires only linear queries rather than the quadratic number needed for pairwise comparisons. The method also incorporates observational statistics when available to improve performance. Experiments demonstrate state-of-the-art results on three causal graphs of varying sizes, with the method being the only one achieving reasonable performance on a large 221-node graph.

## Method Summary
The proposed approach reformulates causal graph discovery as a graph traversal problem using breadth-first search. Instead of querying the LLM for each pairwise node relationship (which would require O(n²) queries for n nodes), the method queries the LLM to identify all children of each node during BFS traversal. This reduces the query complexity to O(n) for sparse graphs. When observational statistics are available, the method incorporates this information to refine the LLM's responses. The approach maintains the ability to handle both discrete and continuous variables and can work with either observational or interventional data.

## Key Results
- Achieves linear query complexity (O(n)) versus quadratic (O(n²)) for pairwise methods
- Outperforms traditional statistical methods and pairwise LLM approaches on three benchmark graphs
- Only method achieving reasonable performance on the large 221-node Neuropathic Pain graph
- State-of-the-art performance on Asia (8 nodes) and Child (20 nodes) graphs

## Why This Works (Mechanism)
The method works by leveraging the LLM's ability to reason about causal relationships between variables. By using BFS traversal, the approach systematically explores the causal graph level by level, asking the LLM to identify all direct children of each node. This structured exploration is more efficient than exhaustive pairwise queries because it exploits the graph structure to minimize redundant queries. The BFS approach also ensures that the causal relationships are discovered in a topologically consistent manner, reducing the likelihood of inconsistent outputs from the LLM.

## Foundational Learning

Causal Inference - Understanding cause-effect relationships between variables
Why needed: Core to the problem of discovering causal graphs from data
Quick check: Can identify whether X causes Y or Y causes X given observational data

Graph Traversal Algorithms - BFS and DFS for systematic graph exploration
Why needed: Enables efficient discovery of causal relationships
Quick check: Can traverse all nodes in a graph without missing connections

LLM Prompt Engineering - Crafting effective queries for causal reasoning
Why needed: Critical for obtaining accurate causal relationships from LLMs
Quick check: Can generate consistent causal direction responses across different prompts

Observational vs Interventional Data - Different types of causal evidence
Why needed: Method works with both data types, affecting approach
Quick check: Can distinguish between statistical associations and causal effects

Computational Complexity - Big-O notation and algorithmic efficiency
Why needed: Key contribution is reducing query complexity from quadratic to linear
Quick check: Can calculate and compare algorithmic complexity of different approaches

## Architecture Onboarding

Component map: LLM Query Engine -> BFS Traversal Controller -> Causal Graph Builder -> Performance Evaluator

Critical path: LLM Query -> BFS Node Processing -> Graph Update -> Next Node Selection

Design tradeoffs:
- Query efficiency vs accuracy: BFS reduces queries but may miss indirect relationships
- LLM dependency: Performance limited by LLM's causal reasoning capabilities
- Scalability: Linear scaling works for large graphs but LLM API costs increase

Failure signatures:
- Inconsistent LLM responses causing cyclic relationships in DAG
- Missing causal edges due to LLM uncertainty or insufficient context
- Incorrect edge directions from LLM misinterpretation

First experiments:
1. Run BFS traversal on a simple 3-node chain graph to verify basic functionality
2. Compare query count between BFS method and exhaustive pairwise approach on 5-node graph
3. Test method with synthetic observational statistics to evaluate integration capability

## Open Questions the Paper Calls Out
None specified in the provided content.

## Limitations
- Performance depends entirely on LLM's ability to reason about causal relationships
- Limited experimental evaluation on only three causal graphs of varying sizes
- No explicit characterization of LLM performance across different model variants or domains
- Does not address potential failure modes when LLMs provide incorrect or inconsistent responses

## Confidence

High Confidence:
- Linear query complexity improvement over pairwise methods is clearly demonstrated
- BFS traversal algorithm is well-defined and theoretically sound

Medium Confidence:
- State-of-the-art claims relative to traditional statistical methods need broader benchmarking
- Scalability demonstration is convincing but limited to single large example

Low Confidence:
- Assertion that this is the "only" method achieving reasonable performance on large graphs is difficult to verify

## Next Checks

1. Replicate experiments across a broader set of benchmark causal graphs (e.g., ALARM, BARLEY) to assess generalizability

2. Conduct ablation studies comparing BFS-based traversal with alternative graph exploration strategies (DFS or random sampling)

3. Implement error analysis on LLM query responses to quantify impact of incorrect outputs on final causal graph accuracy