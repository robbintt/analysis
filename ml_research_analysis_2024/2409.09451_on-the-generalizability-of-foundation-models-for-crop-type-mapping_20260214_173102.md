---
ver: rpa2
title: On the Generalizability of Foundation Models for Crop Type Mapping
arxiv_id: '2409.09451'
source_url: https://arxiv.org/abs/2409.09451
tags:
- crop
- data
- learning
- type
- pre-trained
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study investigates the generalizability of foundation models
  for crop type mapping across diverse geographic regions. The authors curate a harmonized
  global dataset comprising five regional crop type classification datasets from five
  continents, focusing on four major cereal grains.
---

# On the Generalizability of Foundation Models for Crop Type Mapping

## Quick Facts
- arXiv ID: 2409.09451
- Source URL: https://arxiv.org/abs/2409.09451
- Reference count: 40
- Primary result: SSL4EO-S12 model achieves up to 27% higher F1 scores than other models for crop type mapping across five continents

## Executive Summary
This study evaluates the generalizability of foundation models for crop type mapping across diverse geographic regions. The authors curate a harmonized global dataset from five continents focusing on four major cereal grains and assess three pre-trained models using ResNet-50 backbones with U-Net architecture. SSL4EO-S12, designed for Sentinel-2 imagery, consistently outperforms other models with significantly higher F1 scores. The research reveals that 100 labeled images suffice for high overall accuracy, while 900 images are needed to address class imbalance. The study highlights performance improvements from out-of-distribution data in data-scarce regions but notes degradation when combining distribution-shifted data with in-distribution data.

## Method Summary
The authors create a harmonized global dataset by combining five regional crop type classification datasets from five continents, focusing on wheat, barley, maize, and soybeans. They evaluate three pre-trained models (SSL4EO-S12, SatlasPretrain, and ImageNet) using a ResNet-50 backbone with U-Net architecture. The study examines model performance across geographic regions, class imbalance scenarios, and distribution shifts by testing various combinations of in-distribution and out-of-distribution data. Experiments include varying the number of labeled images per class (10-1000) to determine minimum requirements for effective mapping, with evaluation metrics including overall accuracy, class-specific F1 scores, and average accuracy across all classes.

## Key Results
- SSL4EO-S12 model outperforms other models by up to 27% higher F1 scores across all regions
- 100 labeled images achieve high overall accuracy, while 900 images are needed to mitigate class imbalance and improve average accuracy
- Out-of-distribution data improves performance in data-scarce regions, but combining distribution-shifted data with in-distribution data can degrade accuracy

## Why This Works (Mechanism)
Foundation models pre-trained on large-scale remote sensing data capture generalizable visual patterns that transfer effectively to crop type mapping tasks. The domain-specific design of SSL4EO-S12 for Sentinel-2 imagery enables superior feature extraction for agricultural applications compared to general-purpose models. Transfer learning allows models to leverage learned representations from extensive pretraining, reducing the need for large labeled datasets in target domains. The study demonstrates that model performance scales with dataset size and quality, particularly for addressing class imbalance in multi-class classification tasks.

## Foundational Learning
**Remote sensing crop classification**: Understanding how satellite imagery is used to identify agricultural land use and crop types - needed to contextualize model applications in precision agriculture
**Transfer learning**: The process of adapting pre-trained models to new tasks with limited labeled data - crucial for leveraging foundation models in crop mapping
**Domain adaptation**: Techniques for handling distribution shifts between source and target domains - important for addressing geographic variability in agricultural systems
**Class imbalance**: The phenomenon where some classes have significantly fewer samples than others - critical for understanding model performance across crop types
**Cross-continental agricultural patterns**: Recognition that crop types and growing conditions vary significantly across regions - essential for evaluating model generalizability
**Sentinel-2 satellite characteristics**: Understanding the spectral bands, resolution, and temporal characteristics of Sentinel-2 data - fundamental for interpreting model design choices

## Architecture Onboarding
**Component map**: Sentinel-2 imagery → Pre-trained foundation model (SSL4EO-S12/SatlasPretrain/ImageNet) → ResNet-50 backbone → U-Net architecture → Crop type classification output
**Critical path**: Data harmonization → Model pretraining → Transfer learning adaptation → Performance evaluation across regions
**Design tradeoffs**: Model complexity vs. computational efficiency, domain-specific vs. general-purpose pretraining, number of labeled samples vs. classification accuracy
**Failure signatures**: Performance degradation when combining in-distribution and out-of-distribution data, class imbalance leading to poor average accuracy, geographic specificity limiting model generalizability
**First experiments**:
1. Evaluate SSL4EO-S12 performance on Sentinel-2 imagery for wheat classification in North America
2. Test class imbalance effects by varying sample sizes from 10 to 1000 per class
3. Assess distribution shift impact by combining in-distribution and out-of-distribution data from different continents

## Open Questions the Paper Calls Out
None

## Limitations
- Evaluation limited to four cereal grain classes across five regions, uncertain performance for other crop types
- Study relies exclusively on Sentinel-2 imagery and ResNet-50 backbones, limiting conclusions about other sensor types
- Regional representation gaps, particularly absence of African and South American data, create uncertainty about performance in these regions
- Sample size thresholds (100 for overall accuracy, 900 for class balance) may vary significantly with different crops and classification objectives

## Confidence
- Model generalizability across diverse geographic regions: High
- 100 labeled images sufficient for high overall accuracy: Medium
- 900 labeled images needed for class balance: Medium
- Distribution shift effects on model performance: Medium
- SSL4EO-S12 superiority for Sentinel-2 crop mapping: High

## Next Checks
1. Test the same models on additional crop types and multi-class scenarios beyond the four cereal grains studied
2. Evaluate performance across different satellite sensors and resolutions to assess model generalizability beyond Sentinel-2
3. Conduct experiments specifically targeting underrepresented regions like Africa and South America to validate model performance across diverse agricultural systems