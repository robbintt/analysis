---
ver: rpa2
title: Conformal time series decomposition with component-wise exchangeability
arxiv_id: '2406.16766'
source_url: https://arxiv.org/abs/2406.16766
tags:
- time
- series
- decomposition
- exchangeability
- conformal
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper introduces a novel conformal prediction approach for
  time series forecasting that leverages time series decomposition to handle different
  exchangeability regimes across decomposed components. The method decomposes the
  time series into trend, seasonal, and remainder components, and applies component-specific
  conformal algorithms: cross-validation plus (CV+) for the globally exchangeable
  remainder, ensemble batch prediction intervals (EnbPI) for the non-exchangeable
  trend, and weighted conformal methods for the locally exchangeable seasonal component.'
---

# Conformal time series decomposition with component-wise exchangeability

## Quick Facts
- arXiv ID: 2406.16766
- Source URL: https://arxiv.org/abs/2406.16766
- Reference count: 23
- Key outcome: Novel conformal prediction approach leveraging time series decomposition to handle different exchangeability regimes across decomposed components

## Executive Summary
This paper introduces a conformal prediction framework for time series forecasting that decomposes time series into trend, seasonal, and remainder components, applying component-specific conformal algorithms to each. The approach uses CV+ for the globally exchangeable remainder, EnbPI for the non-exchangeable trend, and weighted conformal methods for the locally exchangeable seasonal component. Tested on synthetic and real-world datasets (San Diego energy consumption, Rossman store sales, Beijing air quality), the method shows promising results for well-structured time series but is limited by decomposition quality for complex datasets. The seasonal component weighting schemes demonstrate varying effectiveness depending on data characteristics, achieving target coverage levels with wider intervals than baselines.

## Method Summary
The method decomposes time series using STL into trend, seasonal, and remainder components, then applies different conformal prediction methods to each based on their exchangeability properties. The remainder component uses CV+ (assuming global exchangeability), the trend uses EnbPI (no exchangeability), and the seasonal component uses weighted conformal methods with distance-based weighting schemes. Prediction intervals are recomposed additively and evaluated using PICP and PIAW metrics. The approach is validated on synthetic and real-world datasets, showing coverage guarantees but with wider intervals than baseline methods.

## Key Results
- Decomposition-based approach achieves target coverage levels (90%) but with wider intervals than baseline methods
- Performance depends heavily on decomposition quality, with limitations on complex datasets like Rossman and Beijing air quality
- Seasonal component weighting schemes (BinaryPoint, BinaryLocal, ExpLocal) show varying effectiveness based on data characteristics
- Method demonstrates potential for well-structured time series but requires further refinement for complex, irregular patterns

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Decomposition into trend, seasonal, and remainder components enables matching CP methods to appropriate exchangeability regimes
- Mechanism: The decomposition separates temporally correlated signal (trend) from locally exchangeable patterns (seasonal) and uncorrelated noise (remainder), allowing component-specific CP methods to be applied
- Core assumption: Time series can be decomposed into additive components that each satisfy different exchangeability assumptions
- Evidence anchors:
  - [abstract] "This approach allows us to model different temporal components individually. By applying specific conformal algorithms to each component and then merging the obtained prediction intervals, we customize our methods to account for the different exchangeability regimes underlying each component."
  - [section 3] "Our key insight is the correspondence between obtained components and their potential to fulfill respective exchangeability assumptions, permitting the application of tailored CP algorithms to each component."
  - [corpus] Weak evidence - corpus contains related work on conformal prediction for time series but limited direct discussion of decomposition-based approaches

### Mechanism 2
- Claim: Weighted CP methods can handle locally exchangeable seasonal components through distance-based weighting schemes
- Mechanism: Seasonal patterns exhibit local exchangeability where samples within the same period phase are exchangeable, enabling weighted CP with weights based on temporal distance within periods
- Core assumption: Seasonal patterns have consistent periodicity allowing local exchangeability assumptions within period phases
- Evidence anchors:
  - [section 3.3] "Although extracted patterns are time-dependent, their repetitive nature implies that such dependency might be confined to shorter time intervals... leading us to hypothesize that samples across periods can be considered locally (approximately) exchangeable."
  - [section 3.3] "For BinaryPoint (Eq. 3), a highly selective calibration subset is chosen, and identical weights assume global exchangeability for all included samples. This equates a strong assumption of local exchangeability confined to a precisely defined calibration set."
  - [corpus] Moderate evidence - corpus includes work on weighted conformal prediction but limited direct discussion of seasonal component weighting

### Mechanism 3
- Claim: Cross-validation plus (CV+) provides valid prediction intervals for globally exchangeable remainder components
- Mechanism: The remainder component after decomposition contains uncorrelated noise, satisfying global exchangeability assumptions required by CV+
- Core assumption: Accurate decomposition leaves remainder component as approximately uncorrelated noise
- Evidence anchors:
  - [section 3.1] "Aligned with these common assumptions, we hypothesize R to satisfy a lenient i.i.d condition. If the signal is perfectly decomposed according to Eq. 1, the remainder term will ideally reflect uncorrelated functional randomness only"
  - [section 3.1] "This permits the use of CP methods requiring such a condition, including standard split CP and its cross-validation variants. Specifically, we consider the CV+ algorithm by Barber et al. (2021)"
  - [corpus] Weak evidence - corpus contains CV+ algorithm but limited discussion of its application to time series remainder components

## Foundational Learning

- Concept: Exchangeability assumptions in conformal prediction
  - Why needed here: Different exchangeability regimes require different CP methods; understanding when exchangeability holds is crucial for method selection
  - Quick check question: What is the difference between global, local, and no exchangeability assumptions, and which CP methods require each?

- Concept: Time series decomposition methods (STL)
  - Why needed here: The quality of decomposition directly impacts the effectiveness of component-specific CP methods
  - Quick check question: How does STL decomposition separate trend, seasonal, and remainder components, and what are its limitations?

- Concept: Prediction interval recomposition
  - Why needed here: Component-level PIs must be combined to form valid intervals for the original time series
  - Quick check question: How do additive vs multiplicative decomposition structures affect the recomposition formula for prediction intervals?

## Architecture Onboarding

- Component map: STL decomposition → CV+ for remainder → EnbPI for trend → Weighted conformal for seasonal → Additive recomposition → Evaluation
- Critical path: Data → STL decomposition → Apply CP methods per component → Recompose PIs → Evaluate coverage and width
- Design tradeoffs: Simpler decomposition (STL) vs more flexible methods (MSTL), fixed vs adaptive weighting schemes, additive vs multiplicative recomposition
- Failure signatures: Overcoverage/undercoverage in recomposed PIs, wide intervals indicating poor decomposition quality, coverage degradation on complex datasets
- First 3 experiments:
  1. Run on synthetic data with known decomposition structure to verify mechanism 1
  2. Test different seasonal weighting schemes on energy consumption data to verify mechanism 2
  3. Compare CV+ vs EnbPI on remainder component to verify mechanism 3

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the nominal coverage guarantee for the recomposed prediction interval be tightened beyond the current 1-3α bound?
- Basis in paper: [explicit] The paper discusses coverage guarantees in §A and notes that the current bound is loose and does not guarantee target coverage of 1-α.
- Why unresolved: The authors state that naive Bonferroni corrections or other methods haven't been evaluated due to already conservative coverage levels.
- What evidence would resolve it: Empirical studies comparing Bonferroni-corrected coverage levels against recomposed intervals, or theoretical work deriving tighter bounds for the multi-component setting.

### Open Question 2
- Question: Does decomposing time series and applying component-specific CP methods provide a clear advantage over applying time series-specific CP methods directly to the raw signal?
- Basis in paper: [inferred] The results in Table 2 show that decomposition baselines sometimes perform worse than direct CP application, particularly for complex datasets.
- Why unresolved: The paper suggests decomposition quality and exchangeability assumptions impact results, but doesn't conclusively determine when decomposition is beneficial.
- What evidence would resolve it: Controlled experiments varying decomposition quality while holding CP methods constant, or systematic comparison across datasets with different structural characteristics.

### Open Question 3
- Question: Are locally exchangeable CP methods for seasonal components genuinely superior to generic time series CP methods like EnbPI?
- Basis in paper: [explicit] The discussion in §5.3 questions whether local exchangeability assumptions offer distinct advantages over non-exchangeable methods.
- Why unresolved: The paper shows mixed results across datasets, with some benefit for consistent patterns but comparable performance for irregular seasonality.
- What evidence would resolve it: Large-scale benchmarking across diverse datasets with varying seasonal regularity, or theoretical analysis of when local exchangeability assumptions are more/less appropriate than temporal weighting.

## Limitations
- Decomposition quality dependence: Performance critically depends on STL decomposition quality, which may fail for complex, non-linear, or irregularly seasonal time series
- Exchangeability assumption justification: Limited theoretical justification for exchangeability assumptions across different component types, particularly local exchangeability for seasonal components
- Recomposition accuracy: Additive recomposition assumes independent components, which may not hold in practice, leading to interval widening

## Confidence

- **High Confidence**: The general framework of applying component-specific CP methods to decomposed time series components is theoretically sound and well-established in the literature
- **Medium Confidence**: The weighted conformal approaches for seasonal components show promise but require more extensive validation across diverse seasonal patterns
- **Low Confidence**: The theoretical foundations for exchangeability assumptions across different component types need stronger justification, particularly for the local exchangeability hypothesis

## Next Checks

1. **Decomposition Sensitivity Analysis**: Systematically test the method across time series with varying decomposition complexity (synthetic data with controlled signal-to-noise ratios) to quantify performance degradation as decomposition quality decreases

2. **Exchangeability Validation**: Design experiments specifically testing the local exchangeability assumption for seasonal components by measuring coverage uniformity across different temporal distances within seasonal periods

3. **Cross-Validation of Recomposition**: Compare additive vs multiplicative recomposition approaches across datasets with different signal structures to identify conditions where each formulation is appropriate and validate the independence assumptions