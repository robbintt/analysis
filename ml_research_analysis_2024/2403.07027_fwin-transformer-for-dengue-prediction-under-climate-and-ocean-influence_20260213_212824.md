---
ver: rpa2
title: FWin transformer for dengue prediction under climate and ocean influence
arxiv_id: '2403.07027'
source_url: https://arxiv.org/abs/2403.07027
tags:
- attention
- prediction
- input
- fwin
- window
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The study investigates dengue fever forecasting using deep learning
  models, particularly Fourier mixed window attention (FWin) transformers, to predict
  dengue cases in Singapore from 2000 to 2019. The dataset includes local climate
  variables and global climate indices.
---

# FWin transformer for dengue prediction under climate and ocean influence

## Quick Facts
- arXiv ID: 2403.07027
- Source URL: https://arxiv.org/abs/2403.07027
- Authors: Nhat Thanh Tran; Jack Xin; Guofa Zhou
- Reference count: 3
- The FWin transformer outperforms baseline models in dengue forecasting up to 60 weeks ahead.

## Executive Summary
This study investigates dengue fever forecasting using Fourier mixed window attention (FWin) transformers on Singapore data from 2000-2019. The model incorporates local climate variables and global climate indices to predict dengue cases with improved accuracy compared to baseline approaches. The FWin transformer achieves the lowest mean square error and maximum absolute error in long-range forecasts up to 60 weeks. Notably, incorporating future predictor information significantly enhances performance, particularly for longer forecasting horizons. The research demonstrates the effectiveness of FWin transformers in handling complex, non-stationary time series data for public health applications.

## Method Summary
The study employs a Fourier mixed window attention (FWin) transformer architecture for dengue case prediction. The model processes weekly dengue cases alongside climate variables including temperature, precipitation, and global climate indices (SOI, ONI, IOD, NINO indices). The FWin transformer combines local window attention with Fourier mixing to reduce computational complexity while maintaining global token interactions. The model is trained using Adam optimizer with learning rate decay and early stopping, evaluating performance on mean square error and maximum absolute error metrics across forecasting horizons from 1 to 60 weeks.

## Key Results
- FWin transformer achieves lowest MSE and MAE among all tested models for dengue forecasts up to 60 weeks
- Incorporating future predictor information significantly improves performance, especially for longer horizons (36-60 weeks)
- Optimal window size of 18 weeks provides best performance, interpreted as capturing time delay effects between climate factors and dengue cases

## Why This Works (Mechanism)

### Mechanism 1
- Claim: FWin improves long-range dengue forecasting by efficiently capturing non-stationary temporal dependencies
- Mechanism: FWin combines local window attention with Fourier mixing to reduce computational complexity while maintaining global token interactions
- Core assumption: Temporal dependencies in dengue data can be approximated by local interactions with periodic global mixing
- Evidence anchors:
  - [abstract]: "The FWin transformer outperforms baseline models, achieving the lowest mean square error (MSE) and maximum absolute error (MAE) in long-range dengue forecasts up to 60 weeks."
  - [section 3.3]: "FWin performs the best among all of the models; and in addition, the procedure is general across different models."
  - [corpus]: Weak evidence - corpus contains related climate and ocean modeling papers but no direct mention of FWin transformer for dengue prediction

### Mechanism 2
- Claim: Incorporating future predictor information significantly enhances model performance for longer forecasting horizons
- Mechanism: Providing the model with future values of predictor variables enables learning more accurate relationships between predictors and dengue cases
- Core assumption: Future predictor values are available or can be reliably forecasted
- Evidence anchors:
  - [abstract]: "Incorporating future predictor information significantly enhances model performance, especially for longer forecasting horizons."
  - [section 4]: "We observed that for longer time forecasting, i.e. metrics of 36, 48, 60, the error for MM task is lower than MS task."
  - [corpus]: No direct evidence - corpus focuses on climate modeling but doesn't mention dengue prediction with future predictors

### Mechanism 3
- Claim: Window size in FWin acts as a prior on the time delay effect of weather/climate on dengue cases
- Mechanism: Restricting token interactions to within a window focuses the model on local temporal dependencies corresponding to expected lag between climate events and dengue outbreaks
- Core assumption: Temporal lag between climate factors and dengue cases can be approximated by a fixed window size
- Evidence anchors:
  - [section 5]: "We can think of the window size of FWin as prior knowledge of the time delay effect of weather /climate on the dengue cases."
  - [section 5]: "From Tab. 4, we observe that the biggest window size of 18 gives the best performance in most cases."
  - [corpus]: No direct evidence - corpus doesn't discuss window size selection in the context of dengue prediction

## Foundational Learning

- Concept: Attention mechanisms in transformers
  - Why needed here: The paper uses attention-based models, particularly FWin, which relies on attention to capture temporal dependencies in the data
  - Quick check question: How does the attention mechanism in transformers differ from traditional recurrent neural networks in handling long-range dependencies?

- Concept: Time series forecasting with machine learning
  - Why needed here: The study involves predicting future dengue cases based on historical data, requiring knowledge of time series forecasting techniques
  - Quick check question: What are the key challenges in long-range time series forecasting, and how do they differ from short-term forecasting?

- Concept: Climate and ocean indices
  - Why needed here: The model incorporates climate variables like Southern Oscillation Index and Oceanic Niño Index as predictors for dengue cases
  - Quick check question: How do climate indices like ENSO affect global weather patterns, and why might they be relevant for predicting dengue outbreaks?

## Architecture Onboarding

- Component map: Input layer → Encoder Input (time and positional info) → Encoder (Window Attention → Distilling Operation → Fourier Mix) → Decoder Input (masked window attention → Fourier Mix → Cross Attention) → Fully Connected Layer → Output
- Critical path: Input data flows through encoder, where local attention is applied and tokens are mixed via Fourier transform, then through decoder for cross-attention and final prediction
- Design tradeoffs: Window size vs. computational efficiency vs. capturing long-range dependencies; including future predictor information vs. model complexity
- Failure signatures: High MSE/MAE indicating poor prediction accuracy; model not converging during training; overfitting to training data
- First 3 experiments:
  1. Test FWin with different window sizes (1, 6, 12, 18) on the MS task to find optimal window size
  2. Compare FWin performance on MS vs. MM tasks to quantify the benefit of including future predictor information
  3. Evaluate FWin against baseline models (Informer, Autoformer, etc.) on both tasks to confirm superior performance

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can incorporating prior knowledge of time delay effects of weather/climate on dengue cases improve the performance of FWin transformers?
- Basis in paper: [explicit] The paper mentions that the window size of FWin can be interpreted as prior knowledge of the time delay effect of weather/climate on dengue cases
- Why unresolved: The paper suggests that incorporating this prior knowledge could enhance the model's performance but does not explore this experimentally
- What evidence would resolve it: Conducting experiments with different window sizes based on prior knowledge of time delay effects and comparing the performance to the default window size

### Open Question 2
- Question: How would spatial-temporal transformer models perform in predicting dengue cases across multiple regions in countries bordering the Indian and Pacific oceans?
- Basis in paper: [explicit] The paper concludes by suggesting the development of spatial-temporal transformer models that take into account geographical information and predict disease cases over multiple regions
- Why unresolved: The paper does not explore the performance of spatial-temporal transformer models on multi-region dengue prediction
- What evidence would resolve it: Developing and testing spatial-temporal transformer models on dengue datasets that include geographical information from multiple regions and comparing their performance to single-region models

### Open Question 3
- Question: What is the impact of using different climate and ocean current indices on the prediction accuracy of dengue cases?
- Basis in paper: [explicit] The paper uses various climate and ocean current indices (e.g., SOI, ONI, IOD) as predictors for dengue cases
- Why unresolved: The paper does not explore the individual or combined impact of different climate and ocean current indices on prediction accuracy
- What evidence would resolve it: Conducting experiments with different combinations of climate and ocean current indices and analyzing their impact on prediction accuracy

## Limitations

- The model's reliance on future predictor information limits its practical applicability for real-time forecasting
- Performance evaluation is based on in-sample testing without external validation on independent datasets
- The study focuses exclusively on Singapore, limiting generalizability to other geographical regions

## Confidence

- FWin transformer superiority: High
- Future predictor benefit: Medium
- Window size as time delay prior: Low

## Next Checks

1. **External Validation**: Test the FWin model on dengue datasets from other countries (e.g., Brazil, Thailand) to assess geographical generalizability and identify any region-specific parameter requirements

2. **Real-time Forecasting**: Implement the model without access to future predictor values to evaluate performance degradation and determine the practical utility of the approach for operational forecasting systems

3. **Window Size Sensitivity Analysis**: Conduct a systematic study varying window sizes across different climate regions and dengue transmission patterns to establish whether the optimal window size is context-dependent or can be generalized