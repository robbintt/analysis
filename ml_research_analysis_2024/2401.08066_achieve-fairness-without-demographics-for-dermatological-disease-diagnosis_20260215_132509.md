---
ver: rpa2
title: Achieve Fairness without Demographics for Dermatological Disease Diagnosis
arxiv_id: '2401.08066'
source_url: https://arxiv.org/abs/2401.08066
tags:
- fairness
- sensitive
- features
- attribute
- disease
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a method to improve fairness in dermatological
  disease diagnosis without using sensitive attribute information. The core idea is
  to use attention modules and feature entanglement regularization to ensure the model
  focuses on disease-related features rather than skin-related features when classifying
  diseases.
---

# Achieve Fairness without Demographics for Dermatological Disease Diagnosis

## Quick Facts
- arXiv ID: 2401.08066
- Source URL: https://arxiv.org/abs/2401.08066
- Reference count: 40
- One-line primary result: Proposes AttEN framework using attention modules and feature entanglement regularization to improve fairness in dermatological disease diagnosis without sensitive attribute information

## Executive Summary
This paper addresses the critical issue of fairness in dermatological disease diagnosis by proposing a method that improves model fairness without requiring sensitive attribute information. The authors introduce the AttEN framework, which uses attention modules to separate disease-related and skin-related features, then applies feature entanglement regularization to ensure the model focuses on disease features rather than skin features. The method is evaluated on ISIC 2019 and Fitzpatrick-17k datasets, demonstrating significant improvements in fairness metrics while maintaining competitive accuracy.

## Method Summary
The proposed method introduces an AttEN module that can be embedded within existing CNN architectures. This module uses attention mechanisms (specifically CBAM) to extract and separate features related to disease and skin from dermatological images. A soft nearest neighbor loss (SNNL) regularization is then applied to increase feature entanglement for disease-related features within the same class while decreasing it for skin-related features across different classes. Additionally, disease masks from the Segment Anything Model (SAM) are incorporated as guided masks to enhance the quality of the attention maps. The framework is designed to work without access to sensitive attribute information during training, addressing privacy concerns while still improving fairness.

## Key Results
- Achieves best trade-off between accuracy and fairness compared to state-of-the-art methods
- Reduces Eopp0, Eopp1, and Eodd metrics by average of 6.9%, 50.0%, and 46.4% respectively on ISIC 2019 dataset
- Demonstrates robust generalization across different model backbones (ResNet18, VGG-11)
- Maintains competitive accuracy while significantly improving fairness metrics

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: The model avoids using skin-related features for classification, thereby reducing bias.
- **Mechanism**: AttEN module uses attention modules to extract features related to disease and skin separately, then applies SNNL regularization to increase feature entanglement for disease-related features within the same class while decreasing it for skin-related features across different classes.
- **Core assumption**: Skin features are correlated with sensitive attributes (e.g., skin tone), and their use in classification leads to biased predictions.
- **Evidence anchors**:
  - [abstract]: "We enhance the model features by capturing the features related to the sensitive and target attributes and regularizing the feature entanglement between corresponding classes."
  - [section]: "We propose a module called 'AttEN', which can be embedded in the model's inner layer. The main idea for this module is to divide the dermatological disease image features learned by the model into two parts: disease and skin."
  - [corpus]: Weak evidence; no directly comparable method in corpus.
- **Break condition**: If skin features are not correlated with sensitive attributes, or if disease features themselves correlate with sensitive attributes, this mechanism would fail.

### Mechanism 2
- **Claim**: Incorporating disease masks from SAM improves the quality of attention maps, leading to better accuracy and fairness.
- **Mechanism**: The guided mask from SAM is resized and added to the attention feature focusing on the disease part, providing additional information to refine the attention map and ensure the model focuses more accurately on the diseased area rather than the skin.
- **Core assumption**: The SAM-generated masks accurately highlight the diseased regions, and incorporating them into the attention mechanism improves feature quality.
- **Evidence anchors**:
  - [abstract]: "Additionally, we use disease masks from the Segment Anything Model (SAM) to enhance the quality of the learned feature."
  - [section]: "To improve the quality of the attention map generated from the attention module, we add additional information from the segmentation mask generated by SAM; we refer to it as the 'Guided Mask' in our framework."
  - [corpus]: Weak evidence; SAM is used in medical imaging but not specifically for fairness in dermatological disease diagnosis.
- **Break condition**: If the SAM masks are inaccurate or do not align well with the diseased regions, incorporating them could degrade model performance.

### Mechanism 3
- **Claim**: By preventing the model from distinguishing skin features within the same disease class, the model achieves fairness without access to sensitive attributes.
- **Mechanism**: The loss function maximizes SNNL for skin-related features within the same disease class, making the model unable to differentiate skin variations under the same disease condition. This forces the model to rely on disease-related features for classification.
- **Core assumption**: The inability to distinguish skin features within the same disease class does not harm classification accuracy, as disease features are sufficient for accurate diagnosis.
- **Evidence anchors**:
  - [abstract]: "This ensures that the model can only classify based on the features related to the target attribute without relying on features associated with sensitive attributes, thereby improving fairness and accuracy."
  - [section]: "As for features focusing on the skin part, we aim to ensure that the differences in skin among the same disease category do not affect the prediction results."
  - [corpus]: Weak evidence; no directly comparable method in corpus.
- **Break condition**: If disease features alone are insufficient for accurate classification, or if skin features carry important diagnostic information beyond sensitive attributes, this mechanism would fail.

## Foundational Learning

- **Concept**: Soft Nearest Neighbor Loss (SNNL)
  - **Why needed here**: SNNL measures the degree of entanglement between features for different classes, which is crucial for regularizing the model to focus on disease-related features and ignore skin-related features.
  - **Quick check question**: How does SNNL differ from traditional nearest neighbor loss, and why is it suitable for this fairness application?

- **Concept**: Attention Mechanisms (CBAM)
  - **Why needed here**: Attention mechanisms help the model focus on relevant parts of the image, such as the diseased area, which is essential for reducing reliance on skin-related features.
  - **Quick check question**: What are the two sub-modules of CBAM, and how do they contribute to generating attention maps?

- **Concept**: Segment Anything Model (SAM)
  - **Why needed here**: SAM generates accurate disease masks that are used to guide the attention mechanism, improving the model's focus on the diseased regions.
  - **Quick check question**: How does SAM achieve zero-shot segmentation, and what are the key components of its architecture?

## Architecture Onboarding

- **Component map**: Input image → Backbone CNN (ResNet18/VGG-11) → Internal features → AttEN module → Refined attention feature + Inverse attention feature → Regularization (SNNL) → Guided mask integration → Next layer
- **Critical path**: Backbone CNN → AttEN module → SNNL regularization → Guided mask integration
- **Design tradeoffs**:
  - Accuracy vs. Fairness: The method aims to improve fairness without significantly sacrificing accuracy.
  - Complexity: Adding the AttEN module increases model complexity but provides targeted fairness improvements.
  - Dependency: Reliance on SAM for mask generation; accuracy of masks affects performance.
- **Failure signatures**:
  - Decreased accuracy: If disease features alone are insufficient for classification.
  - No improvement in fairness metrics: If skin features are not correlated with sensitive attributes or if the regularization is ineffective.
  - Degradation in performance: If SAM masks are inaccurate or misaligned.
- **First 3 experiments**:
  1. **Baseline comparison**: Run the model without the AttEN module to establish baseline accuracy and fairness metrics.
  2. **Ablation study - SAM masks**: Run the model with and without incorporating SAM-generated masks to assess their impact on attention quality and performance.
  3. **Ablation study - SNNL regularization**: Compare the model with and without SNNL regularization to determine its effect on feature entanglement and fairness.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: Can the AttEN framework be effectively extended to multi-class sensitive attributes (e.g., multiple demographic categories) without significant performance degradation?
- **Basis in paper**: [inferred] The paper focuses on binary sensitive attributes and mentions that training a model for multiple sensitive attributes is impractical due to privacy concerns. The current framework may not scale well to multi-class scenarios.
- **Why unresolved**: The paper does not explore scenarios with more than two sensitive attribute classes, leaving uncertainty about the method's effectiveness in such cases.
- **What evidence would resolve it**: Experimental results applying AttEN to datasets with multi-class sensitive attributes (e.g., age groups, multiple races) while maintaining fairness and accuracy.

### Open Question 2
- **Question**: How does the AttEN framework perform on non-dermatological medical imaging tasks, such as radiology or pathology, where sensitive attributes may be less visually apparent?
- **Basis in paper**: [inferred] The method is specifically designed and tested for dermatological disease diagnosis, where skin-related features are directly relevant. Its generalizability to other medical imaging domains is unexplored.
- **Why unresolved**: The paper does not test the framework on other medical imaging tasks, so its broader applicability remains unknown.
- **What evidence would resolve it**: Validation of AttEN on datasets from other medical imaging domains (e.g., chest X-rays, histopathology slides) with fairness metrics.

### Open Question 3
- **Question**: What is the impact of using SAM-generated masks on fairness and accuracy when ground truth segmentation masks are available during training?
- **Basis in paper**: [explicit] The paper uses SAM-generated masks as guided masks due to the lack of ground truth segmentation masks in the datasets. It mentions that SAM masks may have varying confidence levels.
- **Why unresolved**: The paper does not compare the performance of AttEN with guided masks to a version using ground truth masks, leaving uncertainty about the optimal mask quality for fairness.
- **What evidence would resolve it**: A comparative study using AttEN with SAM-generated masks versus ground truth masks on datasets where both are available.

## Limitations
- The method's effectiveness depends on the assumption that skin features are correlated with sensitive attributes and that disease features alone are sufficient for accurate diagnosis.
- Reliance on SAM-generated masks introduces a dependency on mask quality, which could degrade performance if masks are inaccurate or misaligned.
- Generalizability to other medical imaging domains and multi-class sensitive attributes has not been thoroughly explored.

## Confidence
- **High Confidence**: The core methodology of using attention mechanisms and feature entanglement regularization is well-grounded in existing literature and shows clear improvements in fairness metrics.
- **Medium Confidence**: The effectiveness of incorporating SAM-generated masks for guiding attention is supported by experimental results but relies heavily on the quality of the masks.
- **Low Confidence**: The generalizability of the method to other dermatological datasets or different types of sensitive attributes (beyond skin tone and gender) has not been thoroughly explored.

## Next Checks
1. **Ablation Study**: Conduct a detailed ablation study to isolate the impact of each component (AttEN module, SAM masks, SNNL regularization) on both accuracy and fairness metrics.
2. **Generalization Test**: Apply the method to a different dermatological dataset with varying sensitive attributes (e.g., age, ethnicity) to assess its robustness and generalizability.
3. **Real-World Evaluation**: Test the model in a clinical setting with real patient data to evaluate its performance and fairness in practical scenarios, considering factors like image quality and dataset diversity.