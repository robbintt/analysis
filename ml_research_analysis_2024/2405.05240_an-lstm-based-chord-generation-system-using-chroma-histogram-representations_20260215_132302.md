---
ver: rpa2
title: An LSTM-Based Chord Generation System Using Chroma Histogram Representations
arxiv_id: '2405.05240'
source_url: https://arxiv.org/abs/2405.05240
tags:
- chord
- chords
- chroma
- generation
- dataset
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents an LSTM-based system for generating chord progressions
  to monophonic melodies using chroma histogram representations. The approach frames
  chord generation as a regression problem, learning harmonic relationships through
  sequential chroma features rather than discrete chord labels.
---

# An LSTM-Based Chord Generation System Using Chroma Histogram Representations

## Quick Facts
- arXiv ID: 2405.05240
- Source URL: https://arxiv.org/abs/2405.05240
- Reference count: 0
- One-line primary result: LSTM model using chroma histograms generates chords with ~80ms latency, preferred by listeners but lacking long-term coherence compared to composed progressions

## Executive Summary
This paper presents an LSTM-based system for generating chord progressions to monophonic melodies using chroma histogram representations. The approach frames chord generation as a regression problem, learning harmonic relationships through sequential chroma features rather than discrete chord labels. The model is trained on processed MIDI data with key alignment, melody selection, and chroma histogram extraction, and achieves approximately 80ms prediction latency suitable for limited real-time use. While qualitative evaluation shows the system generates mostly diatonic chords with some cadential patterns, it lacks long-term coherence compared to composed progressions. A user study with 5 musically-trained participants found strong preference (86.6%) for original composed chords over generated ones across three test melodies, with generated chords scoring 3.6/7 on appropriateness versus 5.93/7 for composed chords. The work demonstrates chroma histograms as a viable representation for chord generation, though results indicate the need for improved dataset construction and further study into real-time applicability.

## Method Summary
The method uses LSTM networks to generate chord progressions by predicting chroma histogram representations for each melody note. MIDI files are processed to extract key signatures (using SVM classification or metadata), select melody tracks, and compute normalized chroma histograms. Adjacent similar chords are removed to improve generation diversity. The model architecture consists of three LSTM layers with 50% dropout, processing sequences of length 8 to predict 12-dimensional chroma outputs. Training uses Adam optimizer with Mean Squared Logarithmic Error loss. Generated chroma histograms are converted to MIDI chords through thresholding and voicing algorithms, with transposition to match the melody key.

## Key Results
- User study: 86.6% preference for composed chords over generated chords across three melodies
- Generated chords scored 3.6/7 on appropriateness vs 5.93/7 for composed chords
- Model achieves approximately 80ms prediction latency suitable for limited real-time use
- Generated progressions mostly diatonic with some cadential patterns but lacking long-term coherence
- Chroma histogram representation reduces dataset dimensionality while maintaining harmonic expressiveness

## Why This Works (Mechanism)

### Mechanism 1
Chroma histograms enable the model to represent richer harmonic content than fixed 24-chord vocabularies while maintaining low dimensionality. Instead of classifying into discrete chord labels, the model predicts continuous chroma distributions that can encode any combination of pitch classes, allowing representation of extended chords, inversions, and microtonal variations. The continuous chroma space contains sufficient information to reconstruct musically meaningful chords through thresholding and voicing.

### Mechanism 2
Sequential chroma prediction with LSTM architecture captures chord progression patterns better than bidirectional approaches for real-time applications. The model processes melody chroma sequentially forward in time, predicting chord chroma histograms based on current and past context, enabling real-time chord generation as new melody notes arrive. Forward-only processing is sufficient to learn musically meaningful chord progressions, even without future context.

### Mechanism 3
Removing similar adjacent chords from training data improves generation diversity by preventing the model from learning to repeat similar harmonic material. By eliminating consecutive chroma histograms that are either identical or have high correlation (4+ non-zero values within threshold 0.1), the model is forced to learn transitions between more distinct harmonic states. The reduced dataset still contains sufficient information to learn common chord progression patterns while eliminating redundancy.

## Foundational Learning

- Chroma representation: Why needed here: Chroma histograms provide a compact representation of harmonic content that works well with sequential models for chord generation tasks
  - Quick check question: How many dimensions does a standard 12-bin chroma histogram have, and what musical information does each dimension represent?

- LSTM sequence modeling: Why needed here: LSTMs can capture long-term dependencies in chord progressions while maintaining the ability to process data sequentially for real-time applications
  - Quick check question: What is the key architectural difference between LSTM and standard RNN cells that allows better handling of long-term dependencies?

- MIDI file processing: Why needed here: Converting raw MIDI files into the specific format needed for chroma histogram extraction requires understanding of MIDI structure and music theory concepts
  - Quick check question: What is the difference between MIDI note numbers and chroma values, and how do you convert between them?

## Architecture Onboarding

- Component map: MIDI file input -> Key extraction -> Melody selection -> Chroma histogram calculation -> Similar chord removal -> LSTM model -> Thresholding -> Voicing -> MIDI output
- Critical path: MIDI file input → Preprocessing → Model prediction → Voicing → MIDI output
- Design tradeoffs: Chroma histograms vs discrete chords (expressiveness vs simplicity), sequence length vs real-time latency, threshold values vs voicing quality
- Failure signatures: Incoherent progressions (insufficient context), repetitive chords (similar chord removal too aggressive), poor real-time performance (sequence length too long)
- First 3 experiments:
  1. Test model with sequence lengths 4, 8, and 16 to find optimal balance between coherence and latency
  2. Vary the chroma threshold (0.14) to find optimal voicing quality vs harmonic richness
  3. Test model with and without similar chord removal to quantify impact on generation diversity

## Open Questions the Paper Calls Out

### Open Question 1
Does the model's performance on melody 1 contradict the assumption that musical cadences improve listener preference? The user study found Melody 1 (which had the highest rate of musical cadences) performed worst in engagement and overall preference metrics, contradicting expectations. The authors did not investigate why cadences in generated chords for Melody 1 were less preferred than for other melodies, nor did they explore whether the cadences themselves were musically appropriate or if other factors influenced listener preference.

### Open Question 2
How does chroma histogram representation compare to discrete chord label approaches for capturing harmonic complexity in real-time applications? The authors state chroma histograms promise "more harmonically rich generation than chord label-based approaches" but acknowledge the need for "further study into chroma histograms as an extracted feature." While the paper demonstrates chroma histograms as viable for real-time use (80ms latency), it doesn't directly compare performance against discrete label approaches or quantify the harmonic richness advantage claimed.

### Open Question 3
What dataset modifications would most improve long-term musical coherence in the generated chord progressions? The authors identify dataset structure issues (chords extracted per melody note rather than per bar) as a key limitation and suggest calculating chroma histograms per bar as a solution. The paper only speculates about dataset improvements without testing alternative extraction methods or specialized datasets (like Bach chorales or jazz standards) to verify if these changes would address the coherence problem.

## Limitations
- User study sample size of 5 participants is relatively small for drawing robust conclusions about subjective preferences
- Model's inability to capture long-term harmonic structure represents a fundamental limitation of the chroma histogram representation approach
- Preprocessing pipeline for extracting melody and chord tracks from MIDI files may introduce biases that affect generation quality

## Confidence
- Chroma histogram representation effectiveness: Medium confidence - supported by quantitative results but limited by subjective evaluation
- Real-time applicability: Medium confidence - latency measurements show feasibility but practical implementation details are not fully explored
- Dataset construction improvements: Low confidence - the similar chord removal approach shows benefits but may discard musically valid transitions

## Next Checks
1. **Dataset Generalization Test**: Evaluate the model on a held-out test set from a different dataset than training to verify generalization beyond the specific musical corpus used.

2. **Long-term Coherence Analysis**: Generate extended chord progressions (32+ chords) and analyze whether the model maintains harmonic coherence over longer time spans, comparing against baseline approaches.

3. **Ablation Study on Preprocessing**: Systematically test the impact of different preprocessing decisions (melody selection algorithm, key extraction method, similar chord removal threshold) on generation quality through controlled experiments.