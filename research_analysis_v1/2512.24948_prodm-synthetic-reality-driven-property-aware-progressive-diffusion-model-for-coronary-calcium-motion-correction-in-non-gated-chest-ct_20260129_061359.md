# ProDM: Synthetic Reality-driven Property-aware Progressive Diffusion Model for Coronary Calcium Motion Correction in Non-gated Chest CT

*Xinran Gong; Gorkem Durak; Halil Ertugrul Aktas; Vedat Cicek; Jinkui Hao; Ulas Bagci; Nilay S. Shah; Bo Zhou*

***

## Quick Facts

| **Metric** | **Details** |
| :--- | :--- |
| **Quality Score** | 9/10 |
| **Model Type** | Property-aware Progressive Correction Diffusion Model |
| **Key Metric** | Pearson Correlation: **0.96** |
| **Agreement Score** | Cohen’s Kappa: **0.89** |
| **Core Innovation** | Differentiable Calcium Consistency Loss ($L_{calc}$) |
| **References** | 40 Citations |

***

## Executive Summary

Coronary Artery Calcium (CAC) scoring is the standard method for cardiovascular risk assessment, yet its applicability is limited because it relies on specialized ECG-gated CT scans. These gated scans are far less common than routine, non-gated chest CTs (used for lung cancer screening or other diagnostics), which suffer from significant cardiac and respiratory motion artifacts. These artifacts blur or displace calcified lesions, making reliable automated or manual CAC scoring impossible on standard images. This paper addresses the critical need to repurpose the vast amount of existing non-gated chest CT data for accurate cardiovascular risk stratification without requiring new, specialized acquisitions.

The authors introduce **ProDM**, a property-aware progressive diffusion model designed to restore motion-free images from motion-corrupted inputs. The technical novelty rests on three pillars:

1.  **Synthetic Data Engine:** Simulates realistic cardiac motion artifacts by applying diverse motion trajectories to existing gated CTs, solving the bottleneck of scarce paired training data.
2.  **Property-Aware Learning:** Integrates a differentiable Calcium Consistency Loss ($L_{calc}$). This function uses a soft mask at the 130 Hounsfield Unit (HU) threshold—standard for calcium detection—to enforce physical priors, ensuring that the generation process preserves the exact volume and integrity of calcified lesions.
3.  **Progressive Correction Scheme:** Iteratively refines the images across diffusion steps to stabilize the generation process.

The architecture also employs a 2.5D sliding window inference strategy and ROI-based patching to manage class imbalance and intensity windowing. ProDM significantly outperforms existing baselines across key metrics for Coronary Artery Calcium (CAC) scoring. Quantitatively, the model achieved a **Pearson correlation coefficient of 0.96** between the predicted motion-free scans and the ground truth references. In terms of clinical risk stratification, ProDM demonstrated a **Cohen’s Kappa score of 0.89**, indicating substantial agreement with expert assessment.

This research bridges the gap between routine screening and specialized cardiology by enabling the use of non-gated chest CTs for trustworthy cardiovascular risk assessment. By unlocking the potential of opportunistic screening, the framework allows clinicians to derive cardiovascular insights from existing lung cancer screening data without additional cost or radiation exposure to the patient.

***

## Key Findings

*   **Superior Performance:** ProDM significantly outperforms existing baselines in terms of CAC scoring accuracy, spatial lesion fidelity, and cardiovascular risk stratification performance on real patient datasets.
*   **Validation of Clinical Usability:** A reader study confirmed that the model effectively suppresses motion artifacts in non-gated scans, making them more reliable for diagnosis.
*   **Structural Integrity:** The framework successfully restores motion-free calcified lesions while maintaining the integrity of the lesions throughout the generation process.

***

## Methodology

The paper proposes ProDM (Property-aware Progressive Correction Diffusion Model), a generative diffusion framework designed to map motion-corrupted, non-gated chest CTs to motion-free representations. The methodology operates through three specific technical components:

1.  **Synthetic Data Engine**
    *   A CAC motion simulation engine synthesizes realistic non-gated acquisitions.
    *   Applies diverse motion trajectories to existing cardiac-gated CTs.
    *   Enables supervised training without the need for hard-to-acquire paired non-gated/gated data.

2.  **Property-Aware Learning**
    *   A learning strategy that incorporates calcium-specific priors.
    *   Utilizes a differentiable calcium consistency loss.
    *   Ensures that the physical properties (integrity) of the calcified lesions are preserved during the restoration process.

3.  **Progressive Correction Scheme**
    *   A mechanism that iteratively reduces artifacts across the diffusion steps.
    *   Enhances the stability of the model.
    *   Ensures high fidelity of the calcium structures.

***

## Technical Details

**Architecture**
*   **Forward/Reverse Process:** Blends motion-free reference and motion-corrupted target data based on specific schedules.
*   **Inference Strategy:** Employs a 2.5D sliding window inference strategy.

**Loss Functions & Optimization**
*   **Calcium Consistency Loss ($L_{calc}$):** Ensures reconstructed images preserve the exact calcium volume using a differentiable soft mask.
*   **Thresholding:** Uses a 130 Hounsfield Units (HU) threshold for calcium detection.
*   **Optimization:** Minimizes the Mean Squared Error (MSE) between the log-transformed volume scores of the prediction and the reference.

**Data Preprocessing**
*   **Intensity Windowing:** Applied at [-200, 800 HU].
*   **Patch Extraction:** ROI-based patch extraction to handle class imbalance (identifies specific Regions of Interest containing calcium or adjacent tissue).

***

## Contributions

*   **Synthetic Reality-Driven Training:** The introduction of a data engine capable of simulating complex cardiac and respiratory motion artifacts, effectively solving the bottleneck of limited paired training data in medical imaging.
*   **Domain-Specific Priors in Diffusion Models:** The integration of a property-aware learning strategy (via differentiable calcium consistency loss) that enforces domain-specific physical constraints on generative diffusion models.
*   **Progressive Refinement Architecture:** The development of a progressive correction scheme that improves the stability and output quality of diffusion models when applied to high-stakes medical image correction tasks.
*   **Bridging the Gap in Screening:** Enabling the use of routine, non-gated chest CTs (which are far more common and accessible) for reliable cardiovascular risk assessment, a task previously restricted to ECG-gated CTs.