# BandiK: Efficient Multi-Task Decomposition Using a Multi-Bandit Framework

*AndrÃ¡s Millinghoffer; AndrÃ¡s Formanek; AndrÃ¡s Antos; PÃ©ter Antal*

---

> ### ðŸ“Š Quick Facts
>
> *   **Proposed Solution:** BandiK (Multi-Bandit Framework)
> *   **Core Innovation:** Semi-overlapping arm property
> *   **Complexity Reduction:** Exponential â†’ Linear O(M)
> *   **Dataset:** NURA-2021 (22 tasks, 31,006 compounds)
> *   **Architecture:** SparseChem Multiple Output MLP
> *   **Assessment Score:** 7/10 | **References:** 38

---

## Executive Summary

Multi-task learning (MTL) offers significant potential for improving model generalization by leveraging shared information across related tasks. However, it faces a critical barrier in **"negative transfer"**â€”a phenomenon where learning from unrelated or conflicting auxiliary tasks degrades overall performance. The primary obstacle is the combinatorial explosion inherent in selecting optimal task subsets; the search space grows exponentially with the number of tasks, making exhaustive identification computationally intractable.

This paper introduces **BandiK**, a framework that formulates auxiliary task selection as a Multi-Bandit Best Arm Identification problem. By reducing search complexity from exponential to linear O(M), BandiK resolves the combinatorial bottleneck. The technical innovation lies in a four-stage process, including Pairwise Transfer Estimation, Candidate Set Construction, Multi-Armed Bandit Optimization (using the adaptive GapE-V algorithm), and Multi-Bandit Integration. A key contribution is the **"semi-overlapping arm property,"** which utilizes a multiple output neural network to train a single shared model, allowing computations to be reused when evaluating different target tasks.

Evaluated on the NURA-2021 dataset (a large-scale cheminformatics benchmark), BandiK successfully validated its efficiency claims. The framework demonstrates significant computational savings compared to brute-force methods, confirming it can navigate complex search spaces to find configurations that avoid negative transfer. This provides an automated, scalable pathway for identifying deep synergies between tasks in high-dimensional domains.

---

## Key Findings

*   **The Transfer Problem:** The transitive and intransitive nature of knowledge transfer remains an open problem, with negative transfer posing a significant obstacle in multi-task learning.
*   **Search Space Reduction:** BandiK drastically reduces the search space for auxiliary tasks from exponential to linear relative to the total number of tasks.
*   **Optimization Strategy:** The proposed solution exploits a 'semi-overlapping arm property' to optimize the cost/reward structure.
*   **Evaluation Method:** The method evaluates performance by training and testing a multiple output neural network on random train-test splits.

---

## Methodology

BandiK employs a comprehensive three-stage multi-bandit framework:

1.  **Pairwise Transfer Estimation:**
    Identifies tasks likely to benefit from joint learning.
2.  **Candidate Set Construction:**
    Builds a linear number of candidate auxiliary task sets to solve the combinatorial explosion issue.
3.  **Multi-Armed Bandit Optimization:**
    Treats arms as representing the performance of candidate sets.
4.  **Multi-Bandit Integration:**
    Integrates individual task-specific MABs to share computations using semi-overlapping arms.

---

## Contributions

*   **Framework Introduction:** Introduction of the BandiK Framework, a comprehensive three-stage method for efficient multi-task auxiliary task subset selection.
*   **Complexity Solution:** A solution to the combinatorial explosion of auxiliary task sets by reducing candidate generation to linear complexity.
*   **Structural Innovation:** Development of a novel multi-bandit structure utilizing the 'semi-overlapping arm property' to improve computational efficiency.
*   **Negative Transfer Mitigation:** A targeted approach to selecting beneficial auxiliary task sets to mitigate negative transfer.

---

## Technical Details

### Formulation
BandiK is formulated as a **Multi-Bandit Best Arm Identification** problem. It involves estimating pairwise transfer effects and reducing the search space to linear O(M). The system simulates multi-bandits using the adaptive **GapE-V** algorithm.

### Semi-Overlapping Arms
The framework employs semi-overlapping arms where the neural network is trained once but evaluated for different target tasks. This allows for significant computational reuse during the optimization process.

### Neural Network Architecture
The system utilizes a **SparseChem Multiple Output MLP** with the following specifications:

| Parameter | Configuration |
| :--- | :--- |
| **Input Layer** | 32,000 inputs |
| **Hidden Layers** | 2 layers x 1,000 neurons |
| **Activation** | ReLU |
| **Hidden Dropout** | 0.7 |
| **Output Layer** | Sigmoid (Dropout 0.2) |
| **Optimizer** | ADAM |
| **Learning Rate** | $10^{-4}$ |
| **Weight Decay** | $10^{-6}$ |
| **Epochs** | 25 |

---

## Results & Evaluation

The study utilizes the **NURA-2021 dataset** to validate the framework:

*   **Dataset Composition:** 22 binary classification tasks comprising 31,006 compounds and 6,441 scaffolds.
*   **Splitting Strategy:** Scaffold-based train/test splitting was used to mitigate bias.
*   **Key Performance Metrics:**
    *   Successfully reduced the auxiliary task search space from exponential to linear O(M).
    *   Implemented a performance evaluation mechanism using single random train-test splits per arm pull.