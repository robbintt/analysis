---
title: 'MATA: A Trainable Hierarchical Automaton System for Multi-Agent Visual Reasoning'
arxiv_id: '2601.19204'
source_url: https://arxiv.org/abs/2601.19204
generated_at: '2026-02-03T12:53:51'
quality_score: 8
citation_count: 36
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# MATA: A Trainable Hierarchical Automaton System for Multi-Agent Visual Reasoning
*Zhixi Cai; Fucai Ke; Kevin Leo; Sukai Huang; Maria Garcia de la Banda; Peter J. Stuckey; Hamid Rezatofighi*

---

### ðŸ“Š Quick Facts

| Metric | Detail |
| :--- | :--- |
| **Quality Score** | 8/10 |
| **Dataset** | MATA-SFT-90K |
| **Architecture** | Hierarchical Mealy Machine |
| **Agent Types** | ONESHOT, STEPWISE, SPECIALIZED |
| **Training Method** | Supervised Fine-Tuning (SFT) |
| **References** | 36 Citations |

---

## Executive Summary

> **Problem Context:** Current visual reasoning systems face a critical trade-off between flexibility and interpretability. Monolithic deep learning models often function as black boxes, lacking the transparency required for complex multi-step reasoning, while static compositional methods rely on rigid, hand-crafted pipelines that are brittle and prone to cascading errors. The field requires an architecture that can dynamically adapt its reasoning processâ€”switching between different strategies or tools as a problem evolvesâ€”while maintaining the explainability and structure of symbolic systems.

> **The Solution:** The paper introduces **MATA** (Multi-Agent hierarchical Trainable Automaton), a novel framework that formalizes multi-agent reasoning as a Hierarchical Mealy Machine. The system employs a hybrid control mechanism: a top-level "hyper-agent" (a finetuned Large Language Model) governs high-level transitions and policy, while sub-level rule-based automata handle specific micro-control tasks. These sub-agents, categorized as **ONESHOT**, **STEPWISE**, or **SPECIALIZED**, interact via an append-only shared memory mechanism that logs intermediate results, enabling both collaboration and competition. Crucially, the hyper-agent is not hard-coded; it is trained using Supervised Fine-Tuning (SFT) on the authors' new **MATA-SFT-90K** dataset to learn optimal transition policies based on query requirements and agent capacities.

> **Impact:** While specific quantitative metrics were excluded from the provided text, the authors report that MATA achieves state-of-the-art (SOTA) performance on multiple visual reasoning benchmarks. It significantly outperforms both monolithic baselines and existing compositional methods in terms of accuracy. Qualitatively, the system demonstrates effective dynamic agent selection, successfully balancing competition (to reduce error propagation) and collaboration (to leverage shared history). This work represents a significant advancement in neuro-symbolic AI, bridging the gap between implicit neural reasoning and explicit static composition.

---

## Key Findings

*   **State-of-the-Art Performance:** MATA achieves superior results on multiple visual reasoning benchmarks when compared to both monolithic and compositional baselines.
*   **Dynamic Agent Selection:** The system successfully implements effective dynamic agent selection, intelligently deciding when agents should collaborate or compete based on the current context.
*   **Enhanced Interpretability:** By utilizing a shared memory read/write mechanism, MATA provides a transparent execution history, making the reasoning process auditable.
*   **Optimized Policy Learning:** The finetuned LLM (hyper-agent) employs optimized policy learning to select the optimal agent based on the specific query and the capacities of available agents.

---

## Methodology

The MATA system is structured around a hierarchical finite-state automaton design.

*   **Hierarchical Control:** The architecture features a top-level trainable 'hyper agent' (implemented as an LLM) that controls system transitions. At the sub-level, rule-based sub-automata handle micro-control tasks.
*   **Communication:** Agents interact through a shared memory mechanism where they can read and write data, ensuring a continuous flow of information.
*   **Training Strategy:** The system is trained using Supervised Fine-Tuning (SFT) on the proprietary **MATA-SFT-90K** dataset. This dataset was constructed by building transition-trajectory trees and transforming them into memory-to-next-state pairs to facilitate effective learning.

---

## Technical Details

The implementation of MATA relies on a rigorous formal structure and distinct agent classifications:

**System Formalization**
*   The system is defined as a **Hierarchical Mealy Machine** ($M_\theta$).
*   It consists of two primary state types:
    *   **Agent Execution States ($S_{agent}$):** States where specific agents perform tasks.
    *   **Lifecycle Coordination States ($S_{life}$):** States managing the overall flow and termination of the process.

**Control Mechanism**
*   **Hyper-Agent:** A trainable LLM situated at the top level.
*   **Input:** It controls transitions based on inputs from an **append-only shared memory**, which contains snapshots of intermediate results.

**Agent Classifications**
*   **ONESHOT:** Fast, single-pass agents.
*   **STEPWISE:** Slower agents that utilize step-wise Python execution.
*   **SPECIALIZED:** Fast agents designed for specific perception tasks.

**Operational Dynamics**
*   **Collaboration:** Agents share history to build upon previous work.
*   **Competition:** Agents with functional overlap work to reduce error propagation.

**Training Objective**
*   Utilizes Supervised Fine-Tuning (SFT) on a transition trajectory dataset.
*   The goal is to minimize SFT loss by targeting transitions that lead to successful outcomes.

---

## Contributions

The research makes four primary contributions to the field of visual reasoning and multi-agent systems:

1.  **Framework Introduction:** Introduced the **MATA** (Multi-Agent hierarchical Trainable Automaton) framework, effectively bridging the gap between implicit reasoning and static compositional methods.
2.  **Hybrid Control Mechanism:** Developed a control system that combines a trainable LLM for high-level decision-making with rule-based logic for low-level execution.
3.  **Dataset Release:** Released the **MATA-SFT-90K** dataset to facilitate further research in trainable automata.
4.  **Benchmark Advancement:** Demonstrated that structured hierarchical multi-agent approaches can outperform existing methods in both accuracy and explainability.

---

## Results

While the specific section detailing quantitative experiments was excluded from the provided text, the abstract and analysis highlight the following outcomes:

*   **Benchmark Performance:** The system reports **state-of-the-art (SOTA)** performance on multiple visual reasoning benchmarks, outperforming both monolithic and compositional baselines.
*   **Qualitative Success:** Demonstrated effective dynamic agent selection and optimized policy learning via the hyper-agent.
*   **Comparative Advantages:**
    *   Enables **closed-loop incremental reasoning** over non-agentic methods.
    *   Reduces **error propagation** in pipelines through competition mechanisms.
    *   Replaces rigid hand-written rules with **data-driven transitions**.

---

**Quality Score:** 8/10  
**References:** 36 citations