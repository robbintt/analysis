---
title: Quantization-based Bounds on the Wasserstein Metric
arxiv_id: '2506.00976'
source_url: https://arxiv.org/abs/2506.00976
generated_at: '2026-02-03T18:24:42'
quality_score: 9
citation_count: 40
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# Quantization-based Bounds on the Wasserstein Metric
*Jonathan Bobrutsky; Amit Moscovich*

---

> ### ðŸ“Š Quick Facts
> *   **Performance:** 10Ã— to 100Ã— speedup vs. entropy-regularized OT
> *   **Accuracy:** Approximation errors below 2%
> *   **Guarantees:** Strict mathematical upper and lower bounds
> *   **Benchmark:** Validated on DOTmark optimal transport images
> *   **Tech Stack:** JAX (GPU optimized)

---

## Executive Summary

Computing the Wasserstein metric, a fundamental tool for comparing probability distributions in machine learning and image processing, is notoriously computationally expensive. Standard Linear Programming (LP) solvers suffer from prohibitive complexity, scaling as $O(N^6 \log N)$ for 2D grids, making them infeasible for high-resolution data. While entropy-regularized Optimal Transport (OT) is commonly used to accelerate computation, it lacks mathematical rigor regarding error guarantees.

This paper addresses the critical challenge of reducing the computational burden of the Wasserstein metric while providing strict, mathematically guaranteed bounds for the solution. The authors introduce a novel quantization-based framework that approximates the Wasserstein metric for discrete measures on regular grids. The core innovation involves formulating and exactly solving the Kantorovich problem on a significantly coarsened grid rather than the full resolution.

Validated on the DOTmark optimal transport images benchmark, the proposed method demonstrates substantial performance improvements. It achieves a computational speedup ranging from 10Ã— to 100Ã— compared to entropy-regularized OT while maintaining approximation errors below 2% relative to the exact Wasserstein distance. This research bridges a critical gap for applications requiring precise error control, offering a GPU-optimized implementation that delivers both speed and theoretical strictness.

---

## Key Findings

*   **Significant Speedup:** Achieves a **10Ã— speedup for Upper Bounds** and **100Ã— speedup for Lower Bounds** compared to entropy-regularized Optimal Transport.
*   **High Precision:** Maintains approximation errors strictly **below 2%** on the DOTmark benchmark.
*   **Theoretical Rigor:** Yields mathematically strict upper and lower bounds on the Wasserstein metric for full-resolution inputs.
*   **Validated Efficacy:** Performance was successfully validated on the standard DOTmark optimal transport images benchmark.

---

## Methodology

The proposed method targets discrete measures on regular grids through a multi-stage process designed to balance computational efficiency with mathematical precision:

1.  **Coarse Grid Formulation:** The method formulates and exactly solves a Kantorovich problem on a coarse grid using a quantized measure.
2.  **Specialized Cost Matrix:** A specially designed cost matrix is utilized to account for full-resolution properties during the coarse computation.
3.  **Mapping & Correction:** The solution is mapped back to full resolution through upscaling and correction.
4.  **Dual Derivation of Bounds:**
    *   **Primal Space:** Calculations performed in the primal space to derive **upper bounds**.
    *   **Dual Space:** Calculations performed in the dual space to derive **lower bounds**.

---

## Technical Details

The algorithm introduces a quantization-based framework specifically engineered to approximate the Wasserstein metric while guaranteeing strict mathematical bounds.

### Core Algorithm Components

*   **Input Processing:**
    *   **Quantization:** Input measures are quantized onto a coarse grid.
    *   **Pooling:** Uses Sum-pooling for measures and AvgPool for coordinates.
*   **Optimization:**
    *   Constructs a specific cost matrix that accounts for full-resolution properties.
    *   Solves the transport problem on the coarse grid before upscaling the solution back to the original high-resolution grid.
*   **Bounding Mechanisms:**
    *   **Primal Space:** Used for deriving upper bounds via upscaling and correction.
    *   **Dual Space:** Used for deriving lower bounds via upscaling and correction.
*   **Refinement Procedures:**
    *   **IPF:** An iterative proportional-fitting (IPF) procedure is used to correct marginals.
    *   **TV Correction:** A Total Variation (TV) correction term ensures strict bounds without relying on IPF convergence.

### Implementation & Complexity

*   **Target Complexity:** Designed to address the high cost of standard LP solvers ($O(N^6 \log N)$ for 2D).
*   **Framework:** Implemented using the **JAX** package.
*   **Hardware:** Optimized specifically for **GPU execution**.

---

## Results

The method was rigorously tested against the exact Wasserstein distance and entropy-regularized OT on the DOTmark benchmark:

*   **Computational Efficiency:**
    *   **Upper Bounds:** Up to **10Ã—** faster than entropy-regularized OT.
    *   **Lower Bounds:** Up to **100Ã—** faster than entropy-regularized OT.
*   **Accuracy:** Approximation errors remained **below 2%** relative to the exact Wasserstein distance.
*   **Correctness:** Successfully yielded mathematically strict upper and lower bounds on the $p$-Wasserstein metric for full-resolution inputs.

---

## Contributions

*   **Novel Framework:** Introduced a new approximation framework providing strict upper and lower bounds for the Wasserstein metric, filling a gap in existing methods.
*   **Efficiency & Rigor:** Demonstrated that substantial computational efficiency (10x-100x) can be achieved without sacrificing theoretical rigor.
*   **Specialized Technique:** Contributed a specialized technique for regular grids involving quantization and strategic cost matrix manipulation.

---

**Quality Score:** 9/10  
**References:** 40 citations