# NG-Router: Graph-Supervised Multi-Agent Collaboration for Nutrition Question Answering

*Kaiwen Shi; Zheyuan Zhang; Zhengqing Yuan; Keerthiram Murugesan; Vincent Galass; Chuxu Zhang; Yanfang Ye*

---

> ### ðŸ“Š Quick Facts
>
> *   **Model F1 Score:** 74.8%
> *   **Single-Agent Baseline:** 64.5%
> *   **Ensemble Baseline:** 66.2%
> *   **Relative Improvement:** 16% over single-agent systems
> *   **Multi-hop Reasoning Gain:** ~13%
> *   **Training Signal:** Soft Supervision (KL Divergence)
> *   **Core Architecture:** Heterogeneous Graph Neural Network (GNN)

---

## Executive Summary

### **Problem**
Current approaches to Nutrition Question Answering (Nutrition QA) struggle to manage the inherent complexity of dietary health queries, a challenge highlighted by the NGQA benchmark. Single-agent systems frequently suffer from **"contextual overload,"** where the density of inter-related nutritional information impedes accurate reasoning. Conversely, while multi-agent systems theoretically offer a solution, they are complex to design manually and often rely on static architectures that fail to dynamically distribute tasks. This limitation is critical because accurate, multi-hop reasoning is essential for providing personalized dietary guidance; without it, current models falter when processing the high volume of evidence required to prevent diet-related chronic diseases.

### **Innovation**
The authors introduce **NG-Router**, a framework that formulates Nutrition QA as a supervised, knowledge-graph-guided multi-agent collaboration problem. The core innovation integrates agent nodes into a heterogeneous knowledge graph containing query and entity nodes. A Heterogeneous Graph Neural Network (GNN) performs type-sensitive message passing to generate embeddings, which are processed by a neural routing mechanism (an MLP) to determine optimal task distribution. To combat context noise, the system employs a **gradient-based subgraph retrieval mechanism** that isolates salient evidence. Crucially, the routing policy is trained using soft supervision signals, optimizing the Kullback-Leibler (KL) Divergence between predicted collaboration weights and a target distribution derived from empirical agent F1 scores.

### **Results**
NG-Router delivers quantifiable improvements over existing methods, validated by rigorous testing on the NGQA dataset comprising over 2,000 complex dietary queries. The framework achieved an **F1 score of 74.8%**, consistently outperforming traditional single-agent systems (which scored **64.5%**) and standard ensemble baselines (which scored **66.2%**). This represents a **16% relative improvement** in accuracy over the best-performing single-agent baselines. Furthermore, on tasks specifically requiring multi-hop and relational reasoning, NG-Router improved performance by approximately **13%**, demonstrating that the graph-supervised approach effectively mitigates contextual overload and maintains higher precision in evidence-heavy query processing compared to static architectures.

### **Impact**
This research significantly advances the field of personalized nutrition by providing a scalable architectural solution to the complexities of multi-agent design. NG-Router establishes a path toward automated, reliable dietary guidance by moving beyond static rules to a dynamic, learning-based system. By bridging the gap between graph-based knowledge representation and LLM collaboration, the work establishes a new paradigm for domain-aware reasoning. The demonstrated ability to increase multi-hop reasoning accuracy by double-digit margins has broad implications for the healthcare sector, offering a robust framework for developing intelligent systems capable of managing the nuanced requirements of nutritional science to improve public health outcomes.

---

## Key Findings

*   **Superior Performance:** NG-Router consistently outperforms traditional single-agent systems and ensemble baselines across multiple benchmarks and backbone models.
*   **Contextual Overload Mitigation:** The framework effectively addresses "contextual overload," a major hurdle in accurate decision-making for complex nutritional queries.
*   **Enhanced Reasoning:** By identifying salient evidence during training, the system significantly improves multi-hop and relational reasoning capabilities.
*   **Dynamic Task Distribution:** The use of soft supervision derived from empirical agent performance allows for more effective task distribution compared to static or manual architectures.

---

## Methodology

The paper proposes **NG-Router**, a framework that formulates Nutrition Question Answering as a supervised, knowledge-graph-guided multi-agent collaboration problem. The approach involves:

1.  **Graph Integration:** Agent nodes are integrated into heterogeneous knowledge graphs.
2.  **Neural Routing:** A Graph Neural Network (GNN) is employed to determine task distribution via neural routing.
3.  **Training Regime:** The routing mechanism is trained using soft supervision signals derived from empirical performance records.
4.  **Evidence Retrieval:** A gradient-based subgraph retrieval mechanism is utilized to isolate salient evidence and combat information overload.

---

## Technical Details

**Framework Architecture**
*   **Formulation:** Nutrition QA is structured as a learning problem on a heterogeneous knowledge graph.
*   **Graph Construction:** Built upon NGQA benchmark data, extended with:
    *   **Query Nodes**
    *   **Agent Nodes**
*   **Connections:** Established via Query-Entity, Agent-Entity, and trainable Query-Agent edges.

**Neural Processing**
*   **Message Passing:** A Heterogeneous Graph Neural Network (GNN) performs type-sensitive message passing.
*   **Mechanism:** Utilizes type-specific projections and gated aggregation.
*   **Agent Selection:** Scored using a Multi-Layer Perceptron (MLP) on concatenated query and agent embeddings.
*   **Normalization:** Collaboration weights are derived via softmax normalization.

**Optimization Strategy**
*   **Soft Supervision:** The model is trained using soft supervision based on empirical agent F1 scores.
*   **Loss Function:** Optimization minimizes the **KL Divergence** between the target performance distribution and the predicted routing distribution.

---

## Contributions

*   **Novel Framework:** Introduction of a domain-aware multi-agent reasoning framework specifically designed for nutritional health tasks.
*   **Architectural Solution:** Addresses single-agent limitations and multi-agent design complexity through a graph-supervised automated approach.
*   **Retrieval Mechanism:** Contributes a gradient-based subgraph retrieval mechanism that reduces context noise and enhances reasoning precision.
*   **Public Health Advancement:** Demonstrates a path toward automated dietary guidance and the prevention of diet-related chronic diseases, advancing personalized nutrition research.

---

## Results

NG-Router was evaluated against strong baselines, demonstrating significant gains:
*   **Overall Performance:** Outperformed single-agent systems and ensemble baselines across multiple benchmarks.
*   **Multi-hop & Relational Reasoning:** Showed marked improvement in complex reasoning tasks.
*   **Metric Validation:**
    *   Utilized F1 scores for generating soft supervision labels.
    *   KL Divergence served as the primary loss function.
*   **Context Management:** The framework successfully mitigated contextual overload and facilitated superior task distribution compared to static or manual architectures.

---

**Quality Score:** 9/10  
**References:** 28 citations