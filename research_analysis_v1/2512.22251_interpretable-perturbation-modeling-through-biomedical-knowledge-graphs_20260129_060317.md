# Interpretable Perturbation Modeling Through Biomedical Knowledge Graphs

*Pascal Passigan; Kevin Zhu; Angelina Ning*

---

### üìä Quick Facts

| Aspect | Details |
| :--- | :--- |
| **Quality Score** | 9/10 |
| **Architecture** | Graph Attention Network (GATv2) |
| **Task Type** | Regression (Delta Expression Profile) |
| **Benchmark Metric** | DEG Correlation (Top 50 Genes) |
| **Key Performance** | **0.708** (95% CI: 0.706‚Äì0.711) |
| **Key Data** | PrimeKG++, LINCS L1000 |
| **Significance** | $p < 0.001$ vs. Baselines |

---

## üìù Executive Summary

> This research addresses a critical limitation in current biomedical machine learning: the over-reliance on binary classification tasks, such as simple drug-disease link prediction. While existing models can predict *whether* a drug treats a disease, they fail to capture the granular biological mechanisms behind that interaction. Specifically, there is a lack of frameworks capable of predicting the detailed transcriptomic effects‚Äîspecifically differentially expressed genes (DEGs)‚Äîresulting from drug perturbations on specific cell lines. This gap hinders the ability to perform mechanistic drug modeling, as researchers cannot infer how a therapeutic intervention alters gene expression profiles to achieve a therapeutic effect.
>
> To bridge this gap, the authors propose a novel framework that shifts the prediction task from binary association to the regression of delta expression profiles. Technically, the approach constructs a heterogeneous graph by merging PrimeKG++ (an augmented biomedical knowledge graph) with LINCS L1000 transcriptomic data. A key technical advancement is the use of multimodal embeddings to initialize node features; specifically, MolFormerXL is used for drug representations, while BioBERT provides biological context for genes and diseases. The architecture employs Graph Attention Networks (GATv2) to perform message passing over these pretrained features, allowing the model to leverage the graph's relational topology to predict the magnitude and direction of expression changes across 978 landmark genes for specific drug-cell line pairs.
>
> The proposed GAT framework demonstrated superior predictive performance, particularly in generalizing to novel chemical scaffolds. Evaluated using Bemis-Murcko scaffold splitting and measured by DEG Pearson correlation (top 50 genes), the GAT model achieved a score of **0.708** (95% CI: 0.706‚Äì0.711). This significantly outperformed both the MLP Baseline (0.683 ¬± 0.002) and the concatenation-based MLP+Targets Baseline (0.681 ¬± 0.002) with a $p$-value < 0.001. Robust ablation studies confirmed that the model's success relies on the integration of graph topology and multimodal data; shuffling graph edges or randomizing node features caused marked performance degradation. Notably, while all models converged to similar performance (~0.69) under random splits, the GAT's specific advantage under scaffold splitting highlights the structural graph's utility in extrapolating to unseen molecular structures rather than merely memorizing data.
>
> This research represents a significant advancement in computational pharmacology by enabling high-fidelity, interpretable perturbation modeling. By successfully predicting transcriptional consequences rather than mere associations, the framework provides a pathway for understanding drug mechanisms of action at a systems biology level. The integration of foundation model embeddings with structured biomedical knowledge graphs establishes a new standard for multimodal data fusion, offering a robust tool for future drug repurposing efforts and *in silico* screening. Ultimately, this work moves the field closer to truly predictive biology, where the effects of novel compounds can be simulated prior to physical synthesis or clinical trials.

---

## üîë Key Findings

*   **Superior Predictive Performance:** The proposed Graph Attention Network (GAT) framework outperforms Multi-Layer Perceptron (MLP) baselines in predicting differentially expressed genes (DEGs) across both scaffold and random data splits.
*   **Efficacy of Graph Structure:** Ablation studies involving edge shuffling and node feature randomization confirmed that the structural edges provided by biomedical knowledge graphs (KGs) are crucial, significantly enhancing perturbation-level prediction performance.
*   **Accurate Transcriptomic Prediction:** The model is capable of successfully predicting the delta expression profiles‚Äîspecifically the changes in expression for over 978 landmark genes‚Äîresulting from specific drug-cell pair interactions.
*   **Benchmark Comparison:** The approach demonstrated greater effectiveness than concatenation-based methods in capturing the mechanistic effects of drugs.

---

## üí° Contributions

*   **Task Shift from Binary to Granular:** The work addresses a critical gap by applying knowledge graph frameworks to gene perturbation tasks (transcriptomic effects), moving beyond the more common and limited binary drug-disease association or link prediction tasks.
*   **Integration of Multimodal Data:** The study presents a novel integration of semantically rich biomedical KGs (PrimeKG++) with high-throughput transcriptomic data (LINCS L1000), enhanced by state-of-the-art foundation model embeddings.
*   **Advancement in Mechanistic Modeling:** The framework establishes a pathway for mechanistic drug modeling, enabling researchers to predict and interpret the granular transcriptional effects of therapeutic interventions rather than simple association probability.

---

## üî¨ Methodology

### Graph Construction
The researchers constructed a **heterogeneous merged biomedical graph** by integrating PrimeKG++ (an augmented version of PrimeKG containing semantically rich node embeddings) with LINCS L1000 data.

### Feature Initialization
Node features within the graph were initialized using **multimodal embeddings** derived from foundation models:
*   **Molecular Representations:** MolFormerXL
*   **Biological Context:** BioBERT

### Model Architecture
*   **Core Framework:** Graph Attention Network (GAT) employed to leverage graph structure and message-passing paradigms.
*   **Prediction Head:** Paired with a downstream prediction head for regression tasks.

### Target Task
The model was trained to **regress the delta expression profile** (magnitude and direction of change) for 978 landmark genes given a specific drug-cell line pair.

---

## ‚öôÔ∏è Technical Details

### Prediction Formula
The approach predicts delta expression profiles ($\Delta$) for drug-cell line interactions using the formula:
$$ \hat{y} = b_c + \Delta $$

### Graph Specification
*   **Type:** Unified Heterogeneous Directed Graph
*   **Data Sources:** PrimeKG++ and LINCS 2020
*   **Node Types:** Drugs, Genes/Proteins, Diseases, GO Terms, Pathways, and Cells.

### Embedding Configuration
Multimodal embeddings employ a [2, 768] tensor (flattened to 1,536).
*   **Drugs:** MolFormer-XL + BioBERT
*   **Genes:** ProtBERT + BioBERT
*   **Diseases/GO Terms:** BioBERT

### Architecture Variants
*   **Encoders:** Node-specific 3-layer MLP encoders (1536 to 256)
*   **Baselines:** MLP Baseline, MLP+Targets Baseline
*   **Main Model:** Graph Attention Network (GAT) using **GATv2** with 4 attention heads.

### Training Parameters
*   **Optimizer:** AdamW
*   **Learning Rate:** 0.001
*   **Loss Function:** MSE Loss
*   **Neighbor Sampling:** Batch size 512
*   **Epochs:** 20

---

## üìà Results

### Evaluation Setup
*   **Split Method:** Primarily Bemis-Murcko scaffold splitting to assess generalization.
*   **Metrics:** Global Pearson Correlation and DEG Correlation (top 50 genes).

### Performance (Scaffold Split)
The GAT Model achieved a **DEG correlation of 0.708** (95% CI: 0.706‚Äì0.711), significantly outperforming baselines:
*   **MLP Baseline:** 0.683 ¬± 0.002
*   **MLP+Targets Baseline:** 0.681 ¬± 0.002
*   **Statistical Significance:** $p < 0.001$

### Ablation Studies
*   **Topology Importance:** Edge shuffling and node feature randomization decreased performance, confirming the importance of graph topology and pretrained features.

### Generalization Analysis
*   **Random Splits:** All models converged to similar performance (~0.69 DEG correlation).
*   **Conclusion:** The graph structure provides specific advantages for generalizing to novel chemical scaffolds rather than memorizing data.

---

**REFERENCES:** 5 citations