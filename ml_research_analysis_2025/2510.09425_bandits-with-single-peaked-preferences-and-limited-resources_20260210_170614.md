---
ver: rpa2
title: Bandits with Single-Peaked Preferences and Limited Resources
arxiv_id: '2510.09425'
source_url: https://arxiv.org/abs/2510.09425
tags:
- regret
- algorithm
- order
- each
- matching
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper studies a stochastic combinatorial bandit problem with
  budget constraints where users are matched to arms over time. Without structural
  assumptions, the offline problem is NP-hard, but imposing single-peaked preferences
  enables efficient solutions.
---

# Bandits with Single-Peaked Preferences and Limited Resources

## Quick Facts
- **arXiv ID**: 2510.09425
- **Source URL**: https://arxiv.org/abs/2510.09425
- **Reference count**: 40
- **Primary result**: Single-peaked preferences enable efficient solutions for budgeted stochastic combinatorial bandits, with Õ(U√(TK)) regret for known structure and Õ(UKT^(2/3)) for unknown structure.

## Executive Summary
This paper studies stochastic combinatorial bandits with budget constraints where users are matched to arms over time. Without structural assumptions, the offline problem is NP-hard, but imposing single-peaked preferences enables efficient solutions. For the offline problem, an O(K²(U+B))-time dynamic programming algorithm is provided. For online learning with known SP structure, a UCB-based algorithm achieves Õ(U√(TK)) regret. When SP structure is unknown, an explore-then-commit algorithm achieves Õ(UKT^(2/3)) regret by extracting an approximate SP order via PQ trees. The work also shows that SP preferences don't reduce statistical hardness compared to general preferences.

## Method Summary
The paper addresses budgeted stochastic combinatorial bandits with U users, K arms, and budget B. The approach has three components: (1) SP-Matching: a dynamic programming algorithm for offline SP-structured budgeted matching running in O(K²(U+B)) time, (2) MvM: a UCB-based algorithm for known SP order/peaks that constructs a maximal matrix in the confidence set for optimistic planning, and (3) EMC: an explore-then-commit algorithm for unknown SP structure that uses PQ trees to extract contiguity constraints from noisy estimates and achieves Õ(UKT^(2/3)) regret. The algorithms handle semi-bandit feedback and provide both computational efficiency and sublinear regret guarantees.

## Key Results
- Single-peaked preferences transform an NP-hard budgeted matching problem into one solvable in O(K²(U+B)) time via dynamic programming
- For known SP structure, UCB-based MvM achieves Õ(U√(TK)) regret by constructing a maximal matrix in the confidence set
- For unknown SP structure, EMC achieves Õ(UKT^(2/3)) regret using PQ tree-based order extraction with contiguity constraints
- A bipartite variant with one-to-one matching is efficiently solvable via Hungarian or min-cost flow algorithms, achieving Õ(√(UKBT)) regret

## Why This Works (Mechanism)

### Mechanism 1: Single-Peaked Structure Enables Polynomial-Time Optimization
- Claim: Imposing single-peaked preferences transforms an NP-hard budgeted matching problem into one solvable in O(K²(U+B)) time.
- Mechanism: The single-peaked structure provides a monotonicity property—when arms are ordered correctly, each user's optimal assignment from any selected subset S lies in a contiguous "neighborhood" around their peak. This allows dynamic programming where the state tracks only the rightmost selected arm rather than all subsets.
- Core assumption: Preferences must actually be (approximately) single-peaked; the structure must exist in the data.
- Evidence anchors:
  - [abstract] "Without structural assumptions, computing the optimal matching is NP-hard... we focus on single-peaked preferences... We devise an efficient algorithm for the offline budgeted matching problem"
  - [Section 4] "Lemma 4 guides the design of a dynamic programming-based approach... maintains a table F(k, b) representing the maximum achievable reward when arm k is the rightmost selected arm"
  - [corpus] Weak direct evidence on single-peaked structure in bandits; mostly unrelated work on different preference structures.

### Mechanism 2: Maximal Matrix Construction for Optimistic Planning
- Claim: When the SP order and user peaks are known, a unique element-wise maximal matrix exists in the confidence set, enabling efficient UCB-style optimization.
- Mechanism: Given known structural constraints (order ≺ and peaks p(·)), the confidence set of plausible reward matrices contains a maximal element—constructed by taking running-minimum of UCB bounds from each arm toward the user's peak. This maximal matrix dominates all others, so optimizing against it suffices for optimism.
- Core assumption: The true order and peaks are known exactly; the maximal matrix remains in the confidence set.
- Evidence anchors:
  - [abstract] "If the single-peaked structure is known, we develop an efficient UCB-like algorithm that achieves a regret bound of Õ(U√TK)"
  - [Section 5.1] "Lemma 6. For any confidence set Ct(≺, p, Ht), there exists a unique element-wise maximal matrix Pt ∈ Ct"
  - [corpus] Standard UCB principles apply (see Optimal Arm Elimination Algorithms paper), but maximal matrix construction for SP constraints is novel here.

### Mechanism 3: PQ Tree-Based Order Extraction from Noisy Estimates
- Claim: From noisy empirical estimates of an SP matrix, contiguity constraints can be extracted and resolved via PQ trees to recover an approximately valid SP order.
- Mechanism: When reward estimates are close to a true SP matrix, significant preference gaps (>2ε) between arm subsets imply contiguity constraints in any valid SP order. PQ trees efficiently encode and test such constraints, returning a feasible order or failing. The returned order makes the estimate 2Kε-approximately single-peaked.
- Core assumption: Sufficient exploration samples exist; the true matrix is SP; ε parameter correctly bounds estimation error.
- Evidence anchors:
  - [abstract] "Our approach relies on a novel PQ tree-based order approximation method"
  - [Section 6.2] "Extract-Order algorithm... initializes a PQ tree... whenever there is a significant gap (exceeding 2ε) between consecutive preference values... adds a contiguity constraint"
  - [corpus] No directly comparable PQ tree applications in bandit literature found in neighbors.

## Foundational Learning

- Concept: **Combinatorial Multi-Armed Bandits with Semi-Bandit Feedback**
  - Why needed here: The problem structure requires selecting subsets of arms (users matched to items) under constraints, with per-pair reward observations.
  - Quick check question: Can you explain why standard K-armed bandit algorithms fail when action selection involves combinatorial constraints?

- Concept: **Dynamic Programming for Constrained Optimization**
  - Why needed here: SP-Matching relies on DP with state defined by (rightmost arm, budget) to achieve polynomial time.
  - Quick check question: Given states F(i, b) representing optimal value using arms ≤ i with budget b, how would you formulate the recurrence?

- Concept: **Single-Peaked Preferences in Social Choice**
  - Why needed here: Understanding why unimodal preferences along a common order simplifies problems (e.g., median voter theorem analogues).
  - Quick check question: If three users have peaks at positions 2, 5, and 8 along an ordered set of 10 arms, what structure does this impose on optimal subset selection?

## Architecture Onboarding

- Component map: Data collection layer -> Confidence set construction -> Structure extraction (EMC only) -> Optimization oracle -> Decision logic
- Critical path: The offline SP-Matching algorithm is the backbone—both online algorithms ultimately call it. Priority: (1) implement and validate SP-Matching correctness on small PSP instances, (2) build confidence interval infrastructure, (3) implement maximal matrix construction, (4) implement PQ tree extraction.
- Design tradeoffs:
  - Exploration horizon N in EMC: larger N → better order recovery but higher exploration cost. Paper sets N ~ T^(2/3)(ln T)^(1/3).
  - Tolerance ε in Extract-Order: smaller ε → stricter contiguity constraints, potential failure; larger ε → looser constraints, worse ASP approximation.
- Failure signatures:
  - SP-Matching returns suboptimal matching → check peak assignment logic and G matrix precomputation
  - Extract-Order always fails → ε parameter too small or data not approximately SP; try increasing ε
  - MvM regret linear → confidence intervals too narrow (check ln T / n scaling) or peak/order input incorrect
  - EMC commitment matching poor → exploration rounds insufficient; verify N matches theoretical setting
- First 3 experiments:
  1. Validate SP-Matching on synthetic PSP matrices with known optimal solutions (small K ≤ 10, U ≤ 20), checking DP correctness against brute-force enumeration.
  2. Test MvM on known-structure instances, plotting cumulative regret vs. theoretical Õ(U√TK) bound; verify sublinear growth and slope ≈ 0.5 on log-log scale.
  3. Test EMC on unknown-structure instances with varying T, measuring slope on log-log regret plot (should approach 2/3); ablate exploration horizon N to show tradeoff.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the √T regret rate be achieved with polynomial-time algorithms when the SP structure is unknown, or is the T^(2/3) rate tight for efficient algorithms?
- Basis in paper: [explicit] "For the unknown SP structure regume, EMC achieves Õ(UKT^(2/3)) regret, while the Ω(U√(TK)) lower bound is statistically tight... It remains open whether the √T rate can be achieved efficiently, or if our T^(2/3) rate is tight for polynomial-time algorithms."
- Why unresolved: Theorem 12 shows that evaluating the optimistic value for a fixed matching is NP-hard to approximate, suggesting T^(2/3) may be unavoidable, but this is not proven.
- What evidence would resolve it: A formal lower bound showing T^(2/3) is necessary for polynomial-time algorithms, or a novel efficient algorithm achieving Õ(√T) regret.

### Open Question 2
- Question: Can the regret gap for known SP order and peaks be closed?
- Basis in paper: [explicit] "For known order and peaks, MvM achieves Õ(U√(TK)) regret (Theorem 7), exceeding the lower bound by √(lnT)·max{√K, U}. Future work could resolve this gap."
- Why unresolved: The gap arises from analysis techniques; the algorithm may already be optimal or may require refinement.
- What evidence would resolve it: An improved analysis of MvM matching the lower bound, or a modified algorithm with tighter regret.

### Open Question 3
- Question: Can these results be extended to more complex preference structures beyond single-peaked?
- Basis in paper: [explicit] "Finally, extending our results to more complex preference structures [32, 35] presents an intriguing challenge."
- Why unresolved: The algorithmic machinery (PQ trees, maximal matrices) relies heavily on the unimodality property of single-peaked preferences.
- What evidence would resolve it: Algorithms achieving sublinear regret for structures like single-peaked on a circle or tree, with analogous computational tractability guarantees.

### Open Question 4
- Question: Can the bipartite budgeted matching variant be solved efficiently with non-unit arm costs?
- Basis in paper: [explicit] "For simplicity, we focus on the case of unit costs; the case of general costs remains an interesting problem for future work."
- Why unresolved: The min-cost flow reduction for unit costs doesn't directly generalize when arms have heterogeneous costs and capacity constraints.
- What evidence would resolve it: A polynomial-time algorithm for the offline problem with general costs, or a hardness result showing intractability.

## Limitations

- The SP structure assumption may not hold in real-world applications, causing regret bounds to degrade linearly with approximation error
- The PQ tree-based order extraction method may fail when estimation error exceeds the 2ε threshold, particularly in early rounds or with sparse reward observations
- Confidence interval construction assumes bounded rewards [0,1], which may not hold in all practical settings

## Confidence

- **High Confidence**: NP-hardness of general budgeted matching (established via reduction), O(K²(U+B)) time complexity of SP-Matching (follows directly from DP formulation), MvM regret bound Õ(U√(TK)) (standard UCB analysis applies)
- **Medium Confidence**: EMC regret bound Õ(UKT^(2/3)) (relies on PQ tree correctness and concentration bounds), PQ tree extraction method (novel application without extensive validation), ASP-to-SP projection via Lemma 9 (technical but plausible)
- **Low Confidence**: Claim that SP preferences don't reduce statistical hardness (requires careful comparison to general preference lower bounds)

## Next Checks

1. Implement and test the SP-Matching algorithm on PSP matrices with known optimal solutions (K ≤ 10, U ≤ 20) against brute-force enumeration to verify polynomial-time correctness
2. Validate the PQ tree extraction method on synthetic approximately SP matrices with varying noise levels to determine failure conditions and ε sensitivity
3. Test the maximal matrix construction by comparing MvM performance with and without correct SP structure knowledge to verify optimism guarantees