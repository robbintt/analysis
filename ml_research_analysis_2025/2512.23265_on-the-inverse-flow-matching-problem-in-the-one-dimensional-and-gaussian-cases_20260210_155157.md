---
ver: rpa2
title: On the Inverse Flow Matching Problem in the One-Dimensional and Gaussian Cases
arxiv_id: '2512.23265'
source_url: https://arxiv.org/abs/2512.23265
tags:
- problem
- gaussian
- inverse
- flow
- matching
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the inverse flow matching problem, which seeks
  to recover the transport plan between two distributions given the velocity field
  and intermediate distributions generated by flow matching. The problem is motivated
  by applications in generative AI, particularly the distillation of flow matching
  models.
---

# On the Inverse Flow Matching Problem in the One-Dimensional and Gaussian Cases

## Quick Facts
- arXiv ID: 2512.23265
- Source URL: https://arxiv.org/abs/2512.23265
- Reference count: 4
- Primary result: Proves uniqueness of transport plan recovery in 1D via characteristic functions and in Gaussian case via initial velocity field; general multi-D case remains open.

## Executive Summary
This paper addresses the inverse flow matching problem, which seeks to recover the transport plan between two distributions given the velocity field and intermediate distributions generated by flow matching. The problem is motivated by applications in generative AI, particularly the distillation of flow matching models. The authors establish uniqueness of the solution in two cases: one-dimensional setting and Gaussian case.

The key insight is that characteristic functions can recover the transport plan uniquely in 1D, while in the Gaussian case, matching the initial velocity field suffices due to the linear structure of conditional expectations. The general multidimensional case with non-Gaussian distributions remains open.

## Method Summary
The paper proves uniqueness of the inverse flow matching problem under specific conditions. For the 1D case, the method uses characteristic functions and their analyticity properties to show that if two transport plans produce identical intermediate distributions, they must be identical. This requires distributions to have finite exponential moments. For the Gaussian case, the method shows that if two Gaussian transport plans produce the same initial velocity field, they must be identical, leveraging the linear structure of conditional expectations in Gaussian distributions.

## Key Results
- In 1D, intermediate distributions uniquely recover the transport plan via characteristic function analytic continuation
- In Gaussian case, initial velocity field alone uniquely determines the transport plan
- General multidimensional non-Gaussian case remains open and unsolved

## Why This Works (Mechanism)

### Mechanism 1
- Claim: In 1D, intermediate distributions uniquely recover the transport plan via characteristic function analytic continuation.
- Mechanism: The sequence {p_t^π} for t ∈ [0,1] provides E[e^{iξ_t X_t}] = E[e^{iξ_t((1-t)X_0 + tX_1)}] for all t, ξ_t. Varying t and ξ_t recovers the joint characteristic function φ^π(ξ_0, ξ_1) on R+ × R+. The finite exponential moment assumption ensures φ^π is analytic near (0,0), permitting unique extension to R².
- Core assumption: Distributions p_0, p_1 have finite exponential moment (∃λ > 0: ∫ exp(λ‖x‖²) d[p_0 + p_1](x) < ∞).
- Evidence anchors:
  - [abstract] "This is proven using characteristic functions and their analyticity properties."
  - [section] Theorem 1 proof: "Since p_0, p_1 have an exponential moment, φ^π is analytic in a neighborhood of (0,0) and extends uniquely to R²."
  - [corpus] Weak direct evidence; related work on Gaussian/exponential families tangentially relevant.
- Break condition: If distributions lack exponential moments, analytic extension is not guaranteed and uniqueness may fail.

### Mechanism 2
- Claim: In the Gaussian case, only the initial velocity field v_0^π suffices to uniquely identify the transport plan.
- Mechanism: For Gaussian plans π = N([μ_0; μ_1], [[Σ_0, S]; [S^⊤, Σ_1]]), the initial velocity v_0^π(x_0) = μ_1 + S^⊤ Σ_0^{-1}(x_0 - μ_0) - x_0 is a linear function. Matching v_0^π = v_0^{π'} equates their linear coefficients, forcing S^⊤ = (S')^⊤, hence π = π'.
- Core assumption: Both the transport plans π, π' are Gaussian (jointly Gaussian couplings).
- Evidence anchors:
  - [abstract] "For Gaussian source and target distributions, if two Gaussian transport plans produce the same initial velocity field, they must be identical."
  - [section] Theorem 2: "Equating these linear functions in x_0, we notice that S^⊤ = (S')^⊤, which implies π = π'."
  - [corpus] Weak direct evidence; neighbor papers address Gaussian-related topics but not this specific mechanism.
- Break condition: If non-Gaussian couplings are allowed, uniqueness among Gaussian solutions does not preclude other solutions.

### Mechanism 3
- Claim: In multi-D non-Gaussian settings, intermediate distributions alone are insufficient because characteristic function recovery lies on a non-open set.
- Mechanism: In D > 1, the characteristic function φ^π is recovered only at points (ξ_0·1_D, ξ_1·1_D) ∈ R^D × R^D, a 2D plane embedded in 2D-dimensional space. This subset is not open, so analytic extension to the full space is not unique. The Gaussian counterexample shows S + S^⊤ may match while S ≠ S'.
- Core assumption: Assumption: Non-Gaussian multi-D distributions do not admit alternative recovery pathways beyond characteristic function extension.
- Evidence anchors:
  - [abstract] "The general multidimensional case remains open for future studies."
  - [section] "This subset, being embedded in a two-dimensional plane of the space R^D × R^D, is not open, which does not guarantee a unique extension."
  - [corpus] No direct corpus evidence; open problem status confirmed in paper.
- Break condition: If additional structure (e.g., velocity field information, regularity assumptions) is incorporated, uniqueness may be recoverable—this remains unproven.

## Foundational Learning

- Concept: **Transport Plan (Coupling)**
  - Why needed here: The core object being recovered—π ∈ Π(p_0, p_1) is a joint distribution with marginals p_0, p_1, encoding how mass moves between distributions.
  - Quick check question: Given two marginal distributions, can you explain why multiple transport plans may exist?

- Concept: **Characteristic Functions and Analyticity**
  - Why needed here: The 1D uniqueness proof hinges on recovering the joint characteristic function and using analytic continuation from exponential moment assumptions.
  - Quick check question: Why does finite exponential moment imply analyticity of the characteristic function near the origin?

- Concept: **Conditional Expectation Velocity Field**
  - Why needed here: The FM velocity field v_t^π(x_t) = E[X_1 - X_0 | X_t = x_t] is the standard practical solution; in the Gaussian case, v_0^π uniquely determines the plan.
  - Quick check question: For a Gaussian coupling, why is the conditional expectation E[X_1 | X_0 = x_0] a linear function of x_0?

## Architecture Onboarding

- Component map:
  - Forward FM Module -> Generates velocity field v^π and intermediate distributions {p_t^π} via X_t = (1-t)X_0 + tX_1
  - Inverse FM Module -> Takes {p_t^π} and/or v^π -> recovers transport plan π
  - Characteristic Function Estimator -> In 1D, estimates φ^π from marginals p_t^π for analytic continuation
  - Gaussian Parameter Extractor -> In Gaussian case, extracts cross-covariance S from v_0^π

- Critical path:
  1. Verify problem setting (1D vs. Gaussian vs. general multi-D)
  2. If 1D: collect {p_t^π} samples, estimate characteristic functions, perform analytic continuation
  3. If Gaussian: estimate v_0^π via regression, extract S from linear coefficients
  4. If general multi-D: uniqueness is not guaranteed—problem remains open

- Design tradeoffs:
  - **1D approach**: Requires full sequence {p_t^π} but makes no distributional assumptions beyond exponential moments
  - **Gaussian approach**: Requires only v_0^π but restricts to Gaussian couplings; non-Gaussian solutions may exist
  - **Velocity vs. distribution information**: In 1D, velocity field is theoretically redundant; in Gaussian case, velocity is essential and distributions alone insufficient

- Failure signatures:
  - Attempting multi-D recovery without Gaussian assumption: expect non-unique solutions (Gaussian counterexample with S + S^⊤ fixed but S ≠ S')
  - Missing exponential moments in 1D: analytic continuation fails, uniqueness not guaranteed
  - Non-Gaussian couplings in "Gaussian" inverse solver: may return incorrect plan

- First 3 experiments:
  1. **1D validation**: Synthesize 1D transport plans with exponential moments, compute {p_t^π}, verify characteristic function recovery matches ground truth π
  2. **Gaussian linear extraction**: Generate Gaussian p_0, p_1 and couplings with varying S, estimate v_0^π from samples, confirm S recovery from linear coefficients
  3. **Multi-D counterexample**: Construct D=2 Gaussian couplings with S ≠ S' but S + S^⊤ = S' + (S')^⊤, verify identical {p_t^π} but distinct v_0^π to demonstrate non-uniqueness without velocity

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Is the solution to the inverse flow matching problem unique in the general multidimensional case ($D > 1$) for non-Gaussian distributions?
- Basis in paper: [explicit] The abstract and conclusion state that "the general conditions for the uniqueness of the solution in the multivariate problem remain an open question."
- Why unresolved: The proof technique used for $D=1$ relies on the analyticity of characteristic functions, which fails to guarantee a unique extension in higher dimensions because the recovered information lies on a non-open subset.
- What evidence would resolve it: A mathematical proof establishing uniqueness for general multivariate distributions, or a counter-example demonstrating non-unique plans generating identical velocity fields.

### Open Question 2
- Question: Given Gaussian marginal distributions, do non-Gaussian transport plans exist that satisfy the inverse problem?
- Basis in paper: [explicit] The text notes regarding the Gaussian case that "It is still unknown whether other solutions outside this class [Gaussian] exist."
- Why unresolved: Theorem 2 proves uniqueness strictly within the class of Gaussian transport plans, leaving the possibility of non-Gaussian plans producing the same initial velocity field unexplored.
- What evidence would resolve it: A construction of a non-Gaussian plan that matches the initial velocity field $v_0$ derived from the optimal Gaussian plan, or a proof that the solution must be Gaussian.

### Open Question 3
- Question: Is the initial velocity field $v^\pi_0$ alone sufficient to uniquely determine the transport plan in non-Gaussian multivariate settings?
- Basis in paper: [inferred] The paper highlights that for the Gaussian case, only $v^\pi_0$ is needed (Theorem 2), whereas the 1D proof utilized the entire distribution sequence. The sufficiency of initial velocity data for general cases is not addressed.
- Why unresolved: The paper demonstrates that intermediate distributions $p_t$ are insufficient for Gaussian $D>1$, necessitating velocity data. It is unclear if the "initial" snapshot is adequate for complex distributions or if the full time-series is required.
- What evidence would resolve it: Analysis showing that distinct plans cannot share the same initial velocity field, or examples where identical $v_0$ fields diverge at $t > 0$.

## Limitations
- General multi-D non-Gaussian case remains open with no constructive solution provided
- No practical implementation algorithm for actually recovering π from given inputs
- Gaussian uniqueness proof only applies within the class of Gaussian transport plans

## Confidence
- High confidence: The 1D uniqueness proof via characteristic functions and the Gaussian case uniqueness via initial velocity field are mathematically rigorous and well-established.
- Medium confidence: The impossibility claim for general multi-D cases is supported by the characteristic function argument, but alternative recovery methods have not been fully explored.
- Low confidence: Practical implementation details for the inverse solver are not specified, making real-world application uncertain.

## Next Checks
1. **1D numerical validation**: Implement Monte Carlo simulation to verify that different transport plans in 1D cannot produce identical intermediate distributions, confirming theoretical uniqueness.
2. **Gaussian cross-covariance recovery**: Test the practical extraction of cross-covariance S from estimated initial velocity fields using regression on finite samples.
3. **Multi-D counterexample construction**: Build explicit Gaussian counterexamples showing S ≠ S' but S + S^⊤ = S' + (S')^⊤ to demonstrate why velocity field information is necessary for uniqueness in higher dimensions.