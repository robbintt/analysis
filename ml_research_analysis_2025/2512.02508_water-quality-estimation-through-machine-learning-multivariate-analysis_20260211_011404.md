---
ver: rpa2
title: Water Quality Estimation Through Machine Learning Multivariate Analysis
arxiv_id: '2512.02508'
source_url: https://arxiv.org/abs/2512.02508
tags:
- water
- quality
- values
- spectroscopy
- uv-vis
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This study presents a soft sensing approach for water quality
  assessment by integrating UV-Vis spectroscopy with machine learning. Using real-world
  data from the Tuscany water supply network, the authors employ a multi-target regression
  model based on a multilayer perceptron to simultaneously predict six key water quality
  indicators: TOC, calcium, sodium, magnesium, conductivity, and chlorides.'
---

# Water Quality Estimation Through Machine Learning Multivariate Analysis

## Quick Facts
- arXiv ID: 2512.02508
- Source URL: https://arxiv.org/abs/2512.02508
- Reference count: 30
- Authors predict six water quality indicators (TOC, calcium, sodium, magnesium, conductivity, chlorides) from UV-Vis spectra with R² > 0.88 using multi-target MLP regression.

## Executive Summary
This study presents a soft sensing approach for water quality assessment by integrating UV-Vis spectroscopy with machine learning. Using real-world data from the Tuscany water supply network, the authors employ a multi-target regression model based on a multilayer perceptron to simultaneously predict six key water quality indicators: TOC, calcium, sodium, magnesium, conductivity, and chlorides. After applying PCA for dimensionality reduction, the model achieves high predictive performance with R² values exceeding 0.88 for all indicators. Notably, TOC prediction reaches R² of 0.96 with RMSE of 7.39 and MAPE of 35%, while chlorides achieve R² of 0.99. The study also employs SHAP values to interpret model predictions, revealing that UV wavelengths (210–270 nm) are most influential for TOC prediction.

## Method Summary
The study employs a multi-target regression approach using a multilayer perceptron (MLP) to predict six water quality parameters from UV-Vis spectral data. The pipeline involves preprocessing raw spectral data (210-620 nm, 205 points) through PCA dimensionality reduction to 15 principal components, followed by MLP training with 1-2 hidden layers (350-1300 units) using ReLU activation and L2 regularization. The model is evaluated using double k-fold cross-validation (5 outer, 4 inner folds) with metrics including R², RMSE, and MAPE. SHAP analysis is applied post-hoc to interpret feature importance, mapping back from principal components to original UV wavelengths.

## Key Results
- Multi-target MLP achieves R² > 0.88 for all six water quality indicators
- TOC prediction reaches R² of 0.96 with RMSE of 7.39 and MAPE of 35%
- Chlorides prediction achieves highest performance with R² of 0.99
- UV wavelengths 210-270 nm identified as most influential for TOC prediction via SHAP analysis

## Why This Works (Mechanism)
The approach leverages the strong correlation between UV absorbance spectra and chemical composition in water. PCA effectively reduces the 205-dimensional spectral data to 15 principal components that capture the most relevant variance for predicting water quality indicators. The MLP learns non-linear relationships between these components and the target parameters. SHAP analysis provides interpretability by mapping feature importance back to specific UV wavelengths, revealing that shorter wavelengths (210-270 nm) are most critical for TOC prediction due to their sensitivity to organic compounds.

## Foundational Learning
- **PCA dimensionality reduction**: Needed to transform 205 spectral points into 15 principal components that capture most variance while reducing noise. Quick check: examine explained variance ratio of components.
- **Multi-target regression**: Needed to simultaneously predict all six water quality indicators from the same spectral input. Quick check: compare performance against single-target models.
- **SHAP interpretability**: Needed to attribute predictions to specific UV wavelengths despite PCA transformation. Quick check: verify SHAP-identified wavelengths align with known chemistry (e.g., UV sensitivity for organic compounds).
- **Double k-fold cross-validation**: Needed to ensure robust hyperparameter tuning and unbiased performance estimation. Quick check: monitor train vs validation performance gap.

## Architecture Onboarding

- **Component map:**
  Spectrophotometer (210-620nm, 205 points) -> PCA Transformer (205 -> 15 components) -> MLP (350-1300 units, ReLU) -> 6 Target Predictions -> Evaluation Metrics (R², RMSE, MAPE) -> SHAP Interpretability

- **Critical path:**
  The PCA transformation is critical - if it fails to capture variance relevant to the target ions, the MLP will receive insufficient signal regardless of architecture. SHAP analysis serves as a sanity check linking learned patterns back to known chemistry.

- **Design tradeoffs:**
  - Interpretability vs. Performance: PCA adds abstraction layer requiring careful mapping of SHAP values back to original wavelengths
  - Dataset Size vs. Complexity: Small dataset (113 samples) necessitates conservative MLP architecture and strong regularization
  - Generalizability: Training on Tuscany-specific data may limit performance on different water matrices

- **Failure signatures:**
  - High MAPE on TOC indicates unreliability for trace contamination detection
  - Divergent SHAP explanations (important visible wavelengths for TOC) would indicate spurious correlations
  - Large train/validation R² gap would indicate overfitting

- **First 3 experiments:**
  1. Baseline ablation: Quantify exact performance delta (ΔR², ΔRMSE) attributable to PCA
  2. Target sensitivity: Compare multi-target vs single-target performance for each parameter
  3. Domain shift: Train on City A data, test on City B to assess generalizability

## Open Questions the Paper Calls Out
- Can integrating Near-Infrared (NIR) spectroscopy with UV-Vis data improve prediction accuracy for water quality indicators beyond the current six parameters?
- Can transfer learning or domain adaptation techniques enable the trained MLP model to generalize to water bodies with different chemical profiles?
- What feature engineering or model architecture modifications can reduce the high MAPE (35%) for TOC prediction while maintaining strong R²?
- Does expanding the dataset across additional seasons and longer time periods significantly improve model robustness?

## Limitations
- Limited dataset size (113 samples from two Tuscan cities) restricts generalizability to different water sources
- High MAPE values for low-concentration parameters like TOC (35%) indicate potential unreliability for detecting trace contamination
- PCA transformation introduces interpretability layer requiring careful mapping of SHAP values back to original UV wavelengths

## Confidence
- **High Confidence**: Multi-target regression approach and SHAP interpretability methodology are sound and well-executed
- **Medium Confidence**: Performance metrics are accurate for Tuscan dataset but may not generalize to other water sources
- **Low Confidence**: Model's ability to detect low-concentration contaminants is questionable given high MAPE values

## Next Checks
1. Generalizability Test: Train and test model on geographically distinct water samples to assess performance degradation
2. Target-Specific Ablation: Evaluate single-target vs multi-target regression performance for each parameter
3. Low-Concentration Detection: Focus validation on low-concentration TOC samples to quantify practical reliability