---
ver: rpa2
title: A Beam's Eye View to Fluence Maps 3D Network for Ultra Fast VMAT Radiotherapy
  Planning
arxiv_id: '2502.03360'
source_url: https://arxiv.org/abs/2502.03360
tags:
- fluence
- network
- maps
- dataset
- dose
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of accelerating volumetric modulated
  arc therapy (VMAT) planning by predicting fluence maps from 3D dose maps using deep
  learning. The core method involves a novel 3D convolutional neural network architecture
  that jointly predicts all 180 fluence maps corresponding to a VMAT arc's control
  points.
---

# A Beam's Eye View to Fluence Maps 3D Network for Ultra Fast VMAT Radiotherapy Planning

## Quick Facts
- arXiv ID: 2502.03360
- Source URL: https://arxiv.org/abs/2502.03360
- Reference count: 0
- 3D ConvNeXt network predicts 180 fluence maps from 3D dose maps in under 20ms

## Executive Summary
This paper presents a novel deep learning approach to accelerate VMAT radiotherapy planning by directly predicting fluence maps from 3D dose distributions. The method employs a 3D convolutional neural network architecture that processes dose maps transformed into beam's eye view projections for each control point along the arc. By scaling up the training dataset from ~100 to over 2000 plans using automated data generation, the authors demonstrate significant improvements in prediction accuracy. The approach achieves sub-20ms inference times while maintaining high fidelity to clinically optimized fluence maps, validated through dose-volume histogram comparisons.

## Method Summary
The core innovation involves a 3D convolutional neural network that predicts all 180 fluence maps of a VMAT arc simultaneously. To enable 3D convolution operations, the 3D dose map is preprocessed by computing its projections to the beam's eye view (BEV) of each control point, effectively transforming gantry rotation into translation. The network architecture is based on ConvNeXt blocks, which are specifically chosen to capture both local MLC dynamics and global dependencies across control points. The study significantly scaled up the training dataset using Eclipse Scripting API, increasing from ~100 to over 2000 VMAT plans, and demonstrated that larger datasets improve performance by approximately 2.5 dB in PSNR per fourfold increase.

## Key Results
- Proposed 3D MedNeXt network achieved 28.71 dB PSNR and 0.9712 SSIM on full dataset
- Outperformed 2D and 3D U-Net baselines by 5.55-6.51 dB in PSNR
- Sub-20ms inference time enables ultra-fast VMAT planning
- DVHs from predicted fluence maps closely matched target DVHs, validating clinical applicability

## Why This Works (Mechanism)
The method works by leveraging the geometric relationship between 3D dose distributions and 2D fluence maps. By projecting the 3D dose map to BEV for each control point, the network can learn the mapping between dose and fluence while preserving the arc geometry through circular padding. The 3D convolution architecture captures both local MLC-specific features and global dependencies across the arc's control points. The scaling of the training dataset is critical, as larger datasets provide more diverse examples that help the network generalize better to unseen cases.

## Foundational Learning
- **BEV projection transformation**: Why needed? To convert gantry rotation to translation amenable to 3D convolution operations. Quick check: Verify projection preserves dose distribution information while enabling convolution.
- **Circular padding**: Why needed? To maintain geometric continuity along the arc's rotation. Quick check: Ensure no artifacts at arc boundaries.
- **ConvNeXt blocks**: Why needed? To capture both local MLC dynamics and global dependencies across control points. Quick check: Compare performance against standard CNN blocks.
- **Dataset scaling**: Why needed? To improve model generalization and performance. Quick check: Measure performance improvement per fourfold dataset increase.

## Architecture Onboarding

### Component Map
3D Dose Map -> BEV Projection -> 3D MedNeXt Network -> 180 Fluence Maps

### Critical Path
BEV projection preprocessing -> 3D ConvNeXt blocks -> Fluence map prediction

### Design Tradeoffs
The 3D architecture enables joint prediction of all fluence maps but requires significant memory and computational resources. The BEV projection approach preserves geometric information but may lose some 3D spatial relationships. Using ConvNeXt blocks provides better feature extraction than traditional CNNs but increases model complexity.

### Failure Signatures
Poor performance on complex anatomical sites, artifacts at arc boundaries, inability to capture fine MLC details, degradation in performance with smaller datasets.

### 3 First Experiments
1. Compare BEV projection against direct 3D convolution on rotated dose maps
2. Test performance scaling with dataset size from 100 to 4000 plans
3. Evaluate model performance on multi-arc VMAT plans

## Open Questions the Paper Calls Out
### Open Question 1
- Question: Can the proposed 3D network architecture maintain high performance when generalized to more complex anatomical sites such as lung or head and neck cancers?
- Basis in paper: The authors state in the Discussion that "future endeavors aim to extend the methodology to encompass other anatomical regions such as lung and head and neck."
- Why unresolved: The current study exclusively utilized a scaled dataset of prostate VMAT plans, leaving the efficacy of the model on sites with greater motion or complex organ geometries untested.
- What evidence would resolve it: Training and validating the model on a multi-site dataset including lung and head-and-neck cases, followed by reporting of PSNR, SSIM, and DVH metrics.

### Open Question 2
- Question: How can the method be adapted to accommodate multi-arc VMAT and hybrid IMRT/VMAT plans?
- Basis in paper: The Discussion notes that the authors "envisage extending the method to accommodate multiple arcs VMAT and Hybrid IMRT/VMAT plans."
- Why unresolved: The current network architecture is specifically designed for single-arc plans with 180 control points, using circular padding and specific dimensionality that may not directly transfer to multi-arc sequences.
- What evidence would resolve it: A modified network architecture capable of processing variable gantry rotations or discrete fields, demonstrating quantitative improvements or comparable accuracy in multi-arc scenarios.

### Open Question 3
- Question: Does the inclusion of anatomical data (CT, organ contours) improve prediction accuracy when trained on datasets significantly larger than the 2000 plans used here?
- Basis in paper: The authors experimented with adding CT and contour inputs but found no improvement, suggesting "a substantially larger dataset might be required to fully exploit the potential of the additional information."
- Why unresolved: It is unclear if the lack of improvement was due to the input features being redundant to the dose map or simply because the model capacity/data size was insufficient to learn the direct mapping from anatomy.
- What evidence would resolve it: A scaling law experiment showing that models with anatomical inputs outperform dose-only models on datasets exceeding the current size (e.g., >5,000 plans).

## Limitations
- Generalizability limited to prostate and head-and-neck sites used in current dataset
- BEV projection preprocessing may lose some 3D spatial information
- No evaluation of model robustness against anatomical deformations or plan re-optimization

## Confidence
- High: Sub-20ms inference time claims are well-documented
- Medium: PSNR and SSIM metrics show strong performance, but clinical validation is limited
- Medium-low: Automated data generation may introduce systematic biases in plan quality

## Next Checks
1. External validation on diverse anatomical sites including lung, breast, and abdomen cases to assess model generalizability
2. Clinical usability study comparing physician acceptance rates between predicted and manually optimized fluence maps
3. Robustness testing with synthetic anatomical deformations and plan re-optimization scenarios to evaluate model stability under clinical workflow conditions