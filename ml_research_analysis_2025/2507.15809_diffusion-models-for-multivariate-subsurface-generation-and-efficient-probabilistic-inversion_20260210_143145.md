---
ver: rpa2
title: Diffusion models for multivariate subsurface generation and efficient probabilistic
  inversion
arxiv_id: '2507.15809'
source_url: https://arxiv.org/abs/2507.15809
tags:
- data
- diffusion
- cdps
- modeling
- noise
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: Diffusion models are used for multivariate subsurface modeling
  and probabilistic inversion, showing superior performance compared to variational
  autoencoders and generative adversarial networks. The proposed Corrected Diffusion
  Posterior Sampling (CDPS) accounts for noise-contamination inherent in diffusion
  modeling by incorporating a likelihood approximation that includes both observational
  and denoising-step-dependent errors.
---

# Diffusion models for multivariate subsurface generation and efficient probabilistic inversion

## Quick Facts
- arXiv ID: 2507.15809
- Source URL: https://arxiv.org/abs/2507.15809
- Reference count: 40
- Diffusion models outperform VAEs and GANs for subsurface modeling with WRMSE < 1.1 and 94-98% facies accuracy

## Executive Summary
This paper introduces a diffusion model-based approach for multivariate subsurface generation and probabilistic inversion, addressing the challenge of modeling complex geological structures while accounting for observational uncertainties. The authors develop Corrected Diffusion Posterior Sampling (CDPS), which improves upon the original Diffusion Posterior Sampling by incorporating noise-contamination inherent in diffusion modeling through a likelihood approximation that includes both observational and denoising-step-dependent errors. The method demonstrates superior performance compared to traditional approaches like variational autoencoders and generative adversarial networks, achieving significantly better inversion accuracy and uncertainty quantification while reducing computational costs.

## Method Summary
The approach combines diffusion models for subsurface generation with a novel posterior sampling technique that accounts for the inherent noise in diffusion-based generation. The Corrected Diffusion Posterior Sampling (CDPS) method modifies the original DPS approach by incorporating a likelihood approximation that includes both observational errors and errors from the denoising process at each step. This correction addresses the noise-contamination problem in diffusion modeling while maintaining computational efficiency. The framework is designed to handle both hard conditioning data (well logs) and indirect conditioning data (seismic data), either individually or simultaneously, making it applicable to a wide range of subsurface characterization problems.

## Key Results
- CDPS achieves WRMSE < 1.1 for all tested noise levels in linear cases, significantly outperforming the original DPS method
- The method demonstrates 94-98% facies accuracy in multivariate cases, showing robust performance across different geological scenarios
- CDPS reduces computational costs compared to the original DPS approach while improving statistical robustness and posterior sampling quality

## Why This Works (Mechanism)
Diffusion models excel at capturing complex multivariate distributions in subsurface geology through their iterative denoising process, which can represent intricate spatial relationships and geological patterns. The key mechanism behind CDPS's success lies in its correction for noise-contamination inherent in diffusion modeling. By incorporating both observational errors and denoising-step-dependent errors into the likelihood approximation, the method creates a more accurate representation of the posterior distribution. This correction addresses the fundamental limitation of treating diffusion-generated samples as perfect representations of the true posterior, leading to improved uncertainty quantification and statistical robustness in the inversion results.

## Foundational Learning
- **Diffusion process fundamentals**: Understanding the forward noising and reverse denoising process is essential for implementing diffusion models in subsurface applications
- **Why needed**: The iterative nature of diffusion models allows them to capture complex geological patterns that simpler generative models cannot represent
- **Quick check**: Verify that the noise schedule and denoising network are properly implemented to ensure stable training and generation

- **Probabilistic inversion concepts**: Knowledge of Bayesian inference and posterior sampling is crucial for understanding how CDPS improves upon traditional methods
- **Why needed**: The method builds on probabilistic inversion principles to incorporate uncertainty quantification into subsurface modeling
- **Quick check**: Ensure the likelihood function correctly incorporates both observational and denoising errors for accurate posterior approximation

- **Multivariate geological modeling**: Understanding how to represent and generate multiple geological properties simultaneously is key to the method's applicability
- **Why needed**: Real subsurface characterization requires modeling multiple properties (porosity, facies, permeability) that are spatially correlated
- **Quick check**: Validate that cross-property correlations in generated models match those in training data

## Architecture Onboarding

**Component Map**: Training data -> Diffusion Model -> Noise Approximation -> CDPS Posterior Sampling -> Uncertainty Quantification

**Critical Path**: The most important sequence is the integration of noise approximation with posterior sampling, as this correction mechanism is what distinguishes CDPS from the original DPS and enables improved uncertainty quantification.

**Design Tradeoffs**: The method trades some additional computational complexity in the likelihood approximation for significantly improved statistical robustness and reduced overall computational costs compared to traditional MCMC methods. This represents a favorable tradeoff for practical subsurface characterization applications.

**Failure Signatures**: Poor performance may manifest as unrealistic geological patterns in generated models, underestimation of uncertainty bounds, or failure to match conditioning data constraints. These issues typically indicate problems with either the diffusion model training or the noise approximation implementation.

**First 3 Experiments**:
1. Test CDPS on a simple 1D synthetic case with known ground truth to verify basic functionality and compare against analytical solutions
2. Apply the method to a 2D synthetic case with multiple geological properties to evaluate multivariate generation capabilities
3. Compare CDPS performance against the original DPS method using identical test cases to quantify the improvement from noise correction

## Open Questions the Paper Calls Out
None

## Limitations
- The computational complexity of training diffusion models remains substantial compared to simpler inversion techniques, despite showing benefits over traditional methods
- The method's effectiveness depends heavily on the quality and representativeness of training data, with potential degradation when applied to geological scenarios outside the training distribution
- The noise approximation in CDPS relies on simplifying assumptions about error distributions that may not hold in all real-world conditions

## Confidence

- **High Confidence**: The superiority of diffusion models over VAEs and GANs in subsurface modeling is well-supported by quantitative metrics (WRMSE < 1.1, 94-98% facies accuracy)
- **Medium Confidence**: The CDPS method's improved statistical robustness and computational efficiency compared to DPS is demonstrated but could benefit from additional real-world case studies
- **Medium Confidence**: The applicability to both hard and indirect conditioning data is theoretically sound but validation across diverse geological settings would strengthen this claim

## Next Checks

1. Test the CDPS method on field datasets with complex, real geological heterogeneity to evaluate performance beyond synthetic cases

2. Conduct sensitivity analysis on the noise approximation parameters to determine robustness across different geological scenarios and measurement conditions

3. Compare computational requirements and wall-clock time against alternative probabilistic inversion methods in large-scale 3D reservoir models