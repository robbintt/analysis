---
ver: rpa2
title: 'ELSPR: Evaluator LLM Training Data Self-Purification on Non-Transitive Preferences
  via Tournament Graph Reconstruction'
arxiv_id: '2505.17691'
source_url: https://arxiv.org/abs/2505.17691
tags:
- preference
- data
- training
- cleaned
- non-transitivity
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses non-transitive preferences in LLM evaluation
  systems, where evaluators prefer A over B, B over C, but C over A, undermining ranking
  reliability. The authors propose ELSPR, a graph-theoretic framework that models
  pairwise preferences as tournament graphs and systematically identifies problematic
  training data.
---

# ELSPR: Evaluator LLM Training Data Self-Purification on Non-Transitive Preferences via Tournament Graph Reconstruction

## Quick Facts
- arXiv ID: 2505.17691
- Source URL: https://arxiv.org/abs/2505.17691
- Reference count: 34
- The paper addresses non-transitive preferences in LLM evaluation systems, achieving 13.8% reduction in non-transitivity and 0.088 decrease in structural entropy

## Executive Summary
This paper tackles the problem of non-transitive preferences in LLM evaluation systems, where evaluators prefer A over B, B over C, but C over A, undermining ranking reliability. The authors propose ELSPR, a graph-theoretic framework that models pairwise preferences as tournament graphs and systematically identifies problematic training data. By analyzing strongly connected components (SCCs) and introducing a novel normalized structural entropy metric, ELSPR quantifies preference clarity and filters out data inducing non-transitivity while preserving transitive preferences.

## Method Summary
ELSPR constructs tournament graphs from pairwise preference data, where each vertex represents a response and directed edges indicate preferences. The method uses Tarjan's algorithm to detect SCCs containing preference cycles (non-transitive preferences), then applies in-degree ranking within SCCs to reconstruct a consistent DAG structure. Data points conflicting with this DAG are filtered out. The approach is validated on the AlpacaEval benchmark using Qwen2.5-Max as the teacher model, with LoRA fine-tuning on the cleaned data.

## Key Results
- 13.8% reduction in non-transitivity metric ρ_non-trans
- 0.088 decrease in normalized structural entropy τ_avg
- Significantly enhanced discriminative power in real-world evaluation systems
- Human validation shows discarded data has 34.4% vs 52.6% inter-annotator agreement and 51.2% vs 80.6% model-human consistency compared to cleaned data

## Why This Works (Mechanism)

### Mechanism 1
- Claim: SCCs in tournament graphs directly identify preference cycles that violate transitivity
- Mechanism: Pairwise preferences are modeled as directed edges; Tarjan's algorithm finds SCCs where any two vertices are mutually reachable. SCCs with >2 vertices and non-bidirectional edges indicate contradictory preference chains
- Core assumption: Non-transitivity manifests as cycles in directed preference graphs, and SCC decomposition correctly isolates these cycles
- Evidence anchors: SCC analysis quantifies non-transitivity; formal definition of non-transitive SCCs; related work confirms non-transitivity as a recognized problem

### Mechanism 2
- Claim: Normalized two-dimensional structural entropy quantifies how close preference structures are to a clear linear ordering
- Mechanism: SCCs serve as community units; entropy captures inter-community complexity and intra-community complexity; normalization enables comparison across graphs of different sizes
- Core assumption: Preference clarity correlates with low structural entropy; chaotic tournament structures with multiple cycles produce higher entropy
- Evidence anchors: Novel normalized directed graph structural entropy metric; complete formula for H²(G) and τ(G); values closer to 0 indicate more ordered structures

### Mechanism 3
- Claim: Data inducing non-transitivity is inherently ambiguous and low-quality, identifiable via cycle-breaking reconstruction
- Mechanism: Within each SCC, vertices are ranked by in-degree; edges are reconstructed to form a DAG consistent with this ranking; original data points violating the reconstructed DAG are moved to "Discarded" set
- Core assumption: Non-transitive preferences signal ambiguous ground truth or evaluator confusion, not legitimate nuance
- Evidence anchors: Human validation confirms discarded data exhibit dramatically lower inter-annotator agreement (34.4% vs 52.6%) and model-human consistency (51.2% vs 80.6%)

## Foundational Learning

- Concept: Tournament Graphs
  - Why needed here: Core representation for pairwise preferences; each vertex is a response, each directed edge indicates a preference judgment
  - Quick check question: Given three responses A, B, C with preferences A≻B, B≻C, C≻A, draw the tournament graph and identify the cycle

- Concept: Strongly Connected Components (SCCs) and Tarjan's Algorithm
  - Why needed here: The paper uses SCCs as the primary mechanism for detecting non-transitivity. Tarjan's algorithm provides O(|V|+|E|) detection efficiency
  - Quick check question: In a directed graph with edges A→B, B→C, C→A, what is the SCC structure? What if edges are A→B, B→C, A→C instead?

- Concept: Structural Entropy for Directed Graphs
  - Why needed here: The paper introduces a novel two-dimensional structural entropy metric to quantify preference clarity beyond binary transitivity detection
  - Quick check question: Why does a graph with all "tie" judgments (bidirectional edges between all pairs) have perfect transitivity but potentially high entropy?

## Architecture Onboarding

- Component map: Preference Data Collector -> Tournament Graph Builder -> SCC Analyzer -> Structural Entropy Calculator -> Cycle Breaker & DAG Reconstructor -> Data Filter
- Critical path: Generate pairwise comparisons → Build tournament graphs per question → Decompose SCCs → Compute metrics → Reconstruct DAGs via in-degree ranking → Filter training data
- Design tradeoffs:
  - Recovery vs. precision: Reconstructing SCCs via in-degree ranking is a heuristic; may not preserve optimal edge sets
  - Tie handling: Bidirectional edges reduce non-transitivity detection but may mask genuine evaluator uncertainty
  - Filtering aggressiveness: "Cleaned" set retains ~80% of raw data; higher filtering may improve consistency but reduce coverage
- Failure signatures:
  - High τ_avg after filtering suggests residual non-transitivity or excessive ties
  - Low model-human agreement on "Cleaned" set indicates over-filtering or systematic bias
  - Non-zero ρ_non-trans in filtered output indicates algorithm error in cycle breaking
- First 3 experiments:
  1. Reproduce SCC detection on small synthetic dataset: Create 5 responses with known preference cycle (A≻B≻C≻D≻A); verify SCC analysis correctly identifies the 4-vertex SCC
  2. Validate entropy metric behavior: Compare τ(G) for linear chain A≻B≻C≻D, single 4-cycle, all ties; confirm τ(a) < τ(b) and interpret τ(c)
  3. Cross-validate filtering on held-out questions: Train evaluator on "Cleaned" set from Helpful Base; test non-transitivity reduction on Vicuna test set (unseen questions)

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can ELSPR's graph-based filtering approach generalize effectively to multi-turn dialogue evaluation scenarios?
- Basis in paper: [explicit] The authors state in Limitations: "our study primarily focused on pairwise comparison tasks in single-turn dialogues, exploring multi-turn dialogue tasks presents an intriguing avenue for future research."
- Why unresolved: Multi-turn dialogues introduce temporal dependencies and context accumulation that create more complex preference structures than single-turn comparisons
- What evidence would resolve it: Experiments applying ELSPR to multi-turn benchmarks, comparing non-transitivity reduction and evaluation quality against single-turn baselines

### Open Question 2
- Question: Is the in-degree-based cycle-breaking heuristic provably optimal for reconstructing transitive preference orderings?
- Basis in paper: [inferred] The methodology uses in-degree ranking to break cycles within SCCs, but provides no theoretical justification for why this heuristic preserves the "true" preference ordering
- Why unresolved: Multiple valid heuristics could transform SCCs into DAGs; without theoretical analysis, it's unclear whether in-degree maximizes alignment with human preferences
- What evidence would resolve it: Comparative analysis of alternative cycle-breaking strategies with human preference ground truth, or theoretical proof bounding in-degree's optimality

### Open Question 3
- Question: Can explicit response-similarity thresholding before ELSPR filtering further reduce computational costs while maintaining quality?
- Basis in paper: [inferred] The paper observes that non-transitive preference pairs exhibit higher Self-Bleu scores, suggesting they fall below the evaluator's "just noticeable difference" threshold
- Why unresolved: The correlation suggests similarity metrics could identify ambiguous pairs cheaply before constructing tournament graphs, but the trade-off remains untested
- What evidence would resolve it: Ablation experiments measuring non-transitivity reduction, retained data volume, and final model performance when applying Self-Bleu or embedding-similarity thresholds before ELSPR's graph-based filtering

## Limitations
- The assumption that non-transitive preferences always indicate low-quality data may not hold across all domains and evaluation contexts
- The structural entropy metric lacks independent validation from corpus literature
- The in-degree-based cycle-breaking heuristic may not always produce optimal edge reconstructions

## Confidence

- **High confidence**: The SCC-based detection mechanism for non-transitivity is mathematically sound and well-established in graph theory
- **Medium confidence**: The structural entropy metric is theoretically justified but lacks external validation
- **Medium confidence**: The filtering methodology shows promising results but the heuristic in-degree ranking for cycle breaking may not always be optimal

## Next Checks
1. **Domain Transfer Validation**: Apply ELSPR to pairwise preference data from a different domain (e.g., medical diagnosis recommendations) and verify that non-transitive preferences still correlate with low inter-annotator agreement

2. **Alternative Cycle-Breaking Algorithms**: Compare ELSPR's in-degree ranking approach against minimum feedback arc set algorithms on the same datasets to measure whether alternative cycle-breaking methods preserve more high-quality data

3. **Ablation on Tie Handling**: Run ELSPR with different tie-handling strategies (e.g., treating all ties as "equal" preferences) and measure impact on both ρ_non-trans and τ_avg to determine whether the current bidirectional edge approach is optimal