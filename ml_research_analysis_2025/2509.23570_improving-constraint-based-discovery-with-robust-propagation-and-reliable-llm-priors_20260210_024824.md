---
ver: rpa2
title: Improving constraint-based discovery with robust propagation and reliable LLM
  priors
arxiv_id: '2509.23570'
source_url: https://arxiv.org/abs/2509.23570
tags:
- causal
- mosacd
- seeds
- arxiv
- orientation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: MosaCD is a causal discovery algorithm that combines CI test results
  with LLM-based orientation seeds to overcome limitations in traditional PC-style
  methods, which rely on v-structure seeding and are vulnerable to cascading errors
  from imperfect CI tests. The key innovation is using shuffled multiple-choice queries
  to filter LLM hallucinations by exploiting positional bias, retaining only consistently
  chosen orientations as high-confidence seeds.
---

# Improving constraint-based discovery with robust propagation and reliable LLM priors

## Quick Facts
- arXiv ID: 2509.23570
- Source URL: https://arxiv.org/abs/2509.23570
- Authors: Ruiqi Lyu; Alistair Turcan; Martin Jinye Zhang; Bryan Wilder
- Reference count: 40
- MosaCD achieves state-of-the-art F1 scores on 10 benchmark datasets by combining CI test results with LLM-based orientation seeds using shuffled-prompt filtering.

## Executive Summary
MosaCD is a causal discovery algorithm that combines CI test results with LLM-based orientation seeds to overcome limitations in traditional PC-style methods, which rely on v-structure seeding and are vulnerable to cascading errors from imperfect CI tests. The key innovation is using shuffled multiple-choice queries to filter LLM hallucinations by exploiting positional bias, retaining only consistently chosen orientations as high-confidence seeds. MosaCD prioritizes non-collider evidence during propagation, applying a confidence-down strategy that orients the most reliable edges first, reducing error accumulation. Across 10 benchmark datasets with up to 76 nodes, MosaCD achieved state-of-the-art F1 scores, outperforming both traditional methods and LLM-based baselines.

## Method Summary
MosaCD builds on PC-style skeleton discovery to find undirected edges and separation sets, then uses LLM queries with shuffled multiple-choice options to generate orientation seeds. The shuffled prompts exploit LLM positional bias, filtering out inconsistent answers to retain only high-confidence seeds. During propagation, MosaCD inverts the traditional PC ordering by prioritizing non-collider identification over collider identification, sorting unshielded triples by CI test p-values and orienting the most confident evidence first. A least-conflict resolver handles remaining undirected edges, and Meek's rules are applied to propagate orientations without creating cycles.

## Key Results
- MosaCD achieved state-of-the-art F1 scores on 10 benchmark datasets, outperforming both traditional PC-style methods and LLM-based baselines.
- The LLM seeding module identified 69% more true directions and 81% fewer false directions than PC v-structure orientation alone.
- Shuffled-prompt filtering retained only robust orientations, effectively reducing LLM hallucination false positives while maintaining high recall.

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Shuffled-prompt filtering reduces LLM hallucination false positives in causal edge seeding.
- **Mechanism:** LLMs exhibit positional bias (preferring first multiple-choice options when uncertain). By randomizing answer order across 5 repeated queries and retaining only edges with consistent majority votes in both orderings, low-confidence hallucinations are filtered out. Only robust orientations become seeds.
- **Core assumption:** LLM positional bias correlates with uncertainty; consistent answers across shuffled orderings indicate genuine domain knowledge rather than positional artifacts.
- **Evidence anchors:**
  - [abstract] "To filter hallucinations, we introduce shuffled queries that exploit LLMs' positional bias, retaining only high-confidence seeds."
  - [section 4, Step 2] "Edges with consistent answers (being the majority vote in both orders) are retained as initial seeds."
  - [corpus] Weak direct support; related work (Step-by-Step Causality) mentions confidence estimation for LLM causal oracles but not positional bias specifically.
- **Break condition:** If LLMs become calibrated to positional bias or if domain knowledge is genuinely ambiguous for most variable pairs, the filtering threshold may reject too many true edges.

### Mechanism 2
- **Claim:** Prioritizing non-collider identification over collider identification reduces error propagation.
- **Mechanism:** Traditional PC-style methods orient v-structures (colliders) first, requiring Z ∉ S for all separating sets. This is statistically fragile: absence of Z from Σ(X,Y) may reflect limited test power rather than true collider status. Non-collider identification (Z ∈ S for some separating set) has stronger evidential support. MosaCD inverts the order, orienting non-colliders first, then colliders.
- **Core assumption:** CI test false positives (α) and false negatives (β) are small relative to graph size; graphs are locally sparse around unshielded triples.
- **Evidence anchors:**
  - [section 5.2] "We find that when CI tests are noisy—incurring both false positives and false negatives—prioritizing non-colliders yields higher accuracy."
  - [Theorem 5.5] "For both algorithms, the error rate among colliders will be higher than noncolliders" with R^CPC_ℓ > 1 and R^PC_ℓ > 1.
  - [corpus] No direct comparison in neighbors; "Differentiable Constraint-Based Causal Discovery" addresses error propagation but via differentiable relaxations, not propagation ordering.
- **Break condition:** If CI tests are severely miscalibrated (high α or β) or graphs are dense with redundant paths bypassing Z, the theoretical advantage may not hold.

### Mechanism 3
- **Claim:** Hybrid seeding (CI + LLM) with conflict rejection produces more reliable initial orientations than either source alone.
- **Mechanism:** LLM proposals are validated against the sepset record Σ: any proposed edge X→Y is discarded if it (i) contradicts Σ at any unshielded triple, or (ii) creates a directed/semi-directed cycle. This cross-validation leverages CI test strengths (statistical grounding) and LLM strengths (domain knowledge) while eliminating mutual inconsistencies.
- **Core assumption:** CI-derived skeleton and sepsets are sufficiently accurate to serve as validation constraints; LLM domain knowledge is non-trivial but noisy.
- **Evidence anchors:**
  - [section 4, Step 2] "We discard any proposed seed X→Y that (i) contradicts Σ at any unshielded triple, or (ii) would create a directed or semi-directed cycle in P."
  - [Figure 1] MosaCD seeding identified 69% more true directions and 81% fewer false directions than PC v-structure orientation.
  - [corpus] "CauScientist" and "FinCARE" both propose LLM-statistical integration but without explicit conflict-rejection constraints.
- **Break condition:** If skeleton is severely incorrect (missing edges or spurious adjacencies), constraint validation will reject valid LLM seeds or accept invalid ones.

## Foundational Learning

- **Concept: Conditional Independence (CI) Testing & Sepsets**
  - **Why needed here:** MosaCD builds on PC-style skeleton discovery, which removes edges via CI tests X⊥Y|S. The sepset record Σ(X,Y) stores minimal separating sets and their p-values. Understanding CI testing is essential to interpret how seeds are validated and propagation is prioritized.
  - **Quick check question:** Given variables X, Y, Z and sepset Σ(X,Y) = {{Z}, {W}}, does Z appear in all, some, or none of the separating sets? What does this imply about Z's collider status?

- **Concept: V-Structures (Colliders) vs. Non-Colliders**
  - **Why needed here:** MosaCD's core innovation is reordering orientation: non-colliders before colliders. You must understand that X→Z←Y is a collider (v-structure) where Z is in no separating set, while non-colliders (X←Z→Y, chains) have Z in some/all separating sets.
  - **Quick check question:** For unshielded triple X−Z−Y, if Σ(X,Y) = {{A,Z}, {B,Z}}, is Z a collider? How would MosaCD vs. PC interpret this?

- **Concept: Meek's Orientation Rules**
  - **Why needed here:** After seeding, MosaCD applies Meek's rules (R1-R4) to propagate orientations without creating new v-structures. Step 3.1 instantiates Meek's R2: if X⇝Y and X−Y, orient X→Y.
  - **Quick check question:** Given X→Z−Y with X and Y non-adjacent, what does Meek's R1 imply about Z−Y orientation?

## Architecture Onboarding

- **Component map:**
  1. **Skeleton Search Module:** Standard PC/PC-stable/CPC → outputs G^skel and Σ
  2. **LLM Seeding Module:** Query LLM with shuffled prompts → filter via consistency + Σ-validation → output E_seed
  3. **CI-Supervised Propagation:** Iteratively apply (a) acyclic propagation (Meek R2), (b) non-collider orientation (sorted by max p-value), (c) collider orientation
  4. **Least-Conflict Resolver:** For remaining undirected edges, count Σ-contradictions per direction, choose minimum
  5. **Optional Vote Aggregator:** Use aggregated LLM votes to derive topological order for final orientation

- **Critical path:** Skeleton → LLM Seeding (Step 2) → CI-Supervised Propagation (Step 3.2-3.3, iterated) → Least-Conflict (Step 4). Errors in skeleton or seeding cascade; propagation ordering determines error amplification.

- **Design tradeoffs:**
  - **Seed precision vs. recall:** Stricter LLM consistency thresholds reduce false seeds but may miss true edges (Figure 2 shows performance degrades gracefully with uninformative variable descriptions).
  - **Propagation ordering:** Non-collider-first reduces false positives but may leave more edges undirected if collider evidence is statistically weaker.
  - **LLM backbone choice:** Performance is consistent across GPT-4o-mini, Claude-3.5-Haiku, GPT-5, Claude-Sonnet-4; open-source GPT-oss-120b shows weaker results (Figure 4).

- **Failure signatures:**
  - **High false seed count:** LLM positional bias filtering insufficient → hallucinations propagate → check shuffled-prompt consistency threshold.
  - **Low true seed count with informative descriptions:** Over-aggressive Σ-validation rejecting valid LLM seeds → inspect skeleton accuracy.
  - **Many undirected edges after propagation:** Weak CI test power (low max p-values) → non-collider evidence insufficient → consider larger conditioning sets or alternative CI tests.

- **First 3 experiments:**
  1. **Reproduce seeding ablation:** Run MosaCD on "Insurance" dataset (27 nodes) with and without LLM seeding (Step 2). Measure true/false seed counts and final F1. Compare to Figure 1 baseline.
  2. **Vary false seed proportion:** Inject known false seeds into E_seed and measure F1 degradation for MosaCD vs. Meek propagation (Figure 3B pattern). Confirm MosaCD's robustness to seed noise.
  3. **Test positional bias filtering:** Query LLM on edge orientations with fixed vs. shuffled orderings for "Asia" dataset (8 nodes). Measure consistency rate and correlation with ground truth. Verify Figure 6 positional bias pattern.

## Open Questions the Paper Calls Out
None

## Limitations
- The positional bias filtering mechanism assumes consistent LLM hallucinations across shuffled orderings correlate with genuine domain knowledge; if LLMs become calibrated to this bias or if domain knowledge is genuinely ambiguous, the filtering threshold may reject too many true edges.
- The theoretical advantage of non-collider-first propagation relies on CI tests being only moderately noisy (small α and β); severe miscalibration or dense graph structures with redundant paths may negate the benefit.
- Performance depends critically on skeleton accuracy; if the PC search fails to remove false edges due to sample size limitations, MosaCD cannot correct these errors downstream.

## Confidence
- **High confidence:** The hybrid seeding mechanism (CI + LLM with conflict rejection) is well-supported by ablation studies showing 69% more true directions and 81% fewer false directions compared to PC v-structure orientation. The shuffled-prompt filtering logic is explicitly implemented and validated.
- **Medium confidence:** The non-collider-first propagation ordering is theoretically justified (Theorem 5.5 shows higher error rates for colliders under noisy CI tests), but real-world performance depends on CI test calibration and graph density. The confidence-down strategy is sound but its practical advantage varies with dataset characteristics.
- **Low confidence:** The generalizability across diverse domains remains uncertain; while consistent across multiple LLM backbones on benchmark datasets, performance on highly technical or novel domains with limited training data is untested.

## Next Checks
1. **Seed robustness test:** Inject controlled proportions of false seeds into E_seed and measure F1 degradation for MosaCD vs. Meek propagation. Confirm MosaCD's graceful degradation pattern under seed noise.
2. **Positional bias validation:** Query LLM on edge orientations with fixed vs. shuffled orderings for multiple datasets. Measure consistency rates and correlation with ground truth to verify the filtering mechanism's effectiveness.
3. **Skeleton sensitivity analysis:** Compare input skeleton F1 to final MosaCD F1 across all datasets. If both metrics are consistently low for certain graphs, identify whether the bottleneck is skeleton search or orientation propagation.