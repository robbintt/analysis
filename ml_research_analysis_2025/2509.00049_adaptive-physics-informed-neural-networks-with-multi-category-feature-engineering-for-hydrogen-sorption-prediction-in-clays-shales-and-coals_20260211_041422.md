---
ver: rpa2
title: Adaptive Physics-Informed Neural Networks with Multi-Category Feature Engineering
  for Hydrogen Sorption Prediction in Clays, Shales, and Coals
arxiv_id: '2509.00049'
source_url: https://arxiv.org/abs/2509.00049
tags:
- uni00000048
- uni00000003
- uni0000004c
- uni00000044
- uni00000057
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces a physics-informed neural network (PINN)
  framework for predicting hydrogen sorption in clays, shales, and coals. The framework
  integrates classical isotherm models with thermodynamic constraints and deep learning
  to ensure physical consistency.
---

# Adaptive Physics-Informed Neural Networks with Multi-Category Feature Engineering for Hydrogen Sorption Prediction in Clays, Shales, and Coals

## Quick Facts
- arXiv ID: 2509.00049
- Source URL: https://arxiv.org/abs/2509.00049
- Reference count: 40
- Primary result: Adaptive PINN framework predicts hydrogen sorption with R² = 0.979, RMSE = 0.045 mol/kg while maintaining physical consistency through thermodynamic constraints

## Executive Summary
This study introduces a physics-informed neural network (PINN) framework for predicting hydrogen sorption in clays, shales, and coals. The framework integrates classical isotherm models with thermodynamic constraints and deep learning to ensure physical consistency. A dataset of 155 samples was used, with multi-category feature engineering across seven categories capturing complex sorption dynamics. The PINN employs deep residual networks with multi-head attention, optimized via adaptive loss functions and Monte Carlo dropout for uncertainty quantification. The model achieved high accuracy (R² = 0.979, RMSE = 0.045 mol/kg) with 67% faster convergence despite 15-fold increased complexity. The framework demonstrated robust lithology-specific performance across clay minerals (R² = 0.981), shales (R² = 0.971), and coals (R² = 0.978), maintaining 85-91% reliability scores. Interpretability analysis revealed that hydrogen adsorption capacity dominates predictions, with 86.7% of feature pairs exhibiting strong interactions. This adaptive PINN framework accelerates site screening and enables risk-informed decision-making through robust uncertainty quantification.

## Method Summary
The method employs a PINN with ResNet architecture and multi-head attention, trained on 155 samples (50 clays, 60 shales, 45 coals) with 2,211 measurements. Feature engineering expands 14 raw inputs into 78 physics-informed descriptors across seven categories (thermodynamic, pore structure, surface chemistry, etc.), reduced to 25 via ensemble selection. The model uses three output heads for uptake prediction, physics parameters, and uncertainty estimation. Training employs adaptive loss weighting balancing data fidelity (Huber loss) with physics constraints (monotonicity, saturation limits, Van't Hoff compliance). Monte Carlo dropout provides uncertainty quantification. The framework achieves 67% faster convergence with 1.24M parameters while maintaining physical consistency through explicit thermodynamic enforcement.

## Key Results
- Achieved R² = 0.979 and RMSE = 0.045 mol/kg on hydrogen sorption prediction
- Demonstrated 67% faster convergence despite 15-fold increase in model complexity
- Maintained 85-91% reliability scores across lithology-specific testing
- Showed hydrogen adsorption capacity dominates predictions (global importance score 0.583)
- Identified 86.7% of feature pairs exhibiting strong interactions requiring non-linear modeling

## Why This Works (Mechanism)

### Mechanism 1: Physics-Guided Feature Expansion
Mapping raw geological inputs (P, T, composition) onto a higher-dimensional space of 79 physics-informed descriptors (e.g., reduced pressure, confinement parameters) appears to linearize complex non-linear sorption dynamics, allowing the neural network to learn more efficiently than from raw data alone. By explicitly calculating derived features based on thermodynamic laws (Arrhenius dependencies) and pore geometry (SSA/d_pore), the model bypasses the need to discover these fundamental relationships from sparse data, effectively priming the network with domain theory. The selected classical isotherm models (Langmuir, Freundlich, Sips) validly approximate the underlying physical reality of hydrogen sorption in these lithologies.

### Mechanism 2: Adaptive Loss Constraint Optimization
Integrating thermodynamic constraints (monotonicity, saturation limits) directly into the loss function likely forces the model to converge on physically consistent solutions, preventing the "hallucination" of invalid isotherms common in purely data-driven models. The loss function balances a data-fidelity term (Huber loss) against a physics-violation penalty. As training progresses, adaptive weighting shifts focus, ensuring the final predictions respect laws like "increasing pressure yields increasing uptake" (monotonicity). The noise in the experimental dataset does not obscure the underlying thermodynamic trends required for the physics loss to guide the gradient descent effectively.

### Mechanism 3: Residual Attention for High-Order Interactions
The deep residual architecture with multi-head attention is likely essential for capturing the high degree of synergy (86.7% strong interactions) between disparate variables like mineralogy and pressure. Standard dense layers might average out subtle interactions. Multi-head attention allows the model to dynamically weigh the relationship between, for instance, micropore volume and pressure differently for coals versus clays, handling the "cross-category" interactions identified in the analysis. The dataset size (155 samples) is sufficient to train the attention mechanisms without simply memorizing the specific sample interactions.

## Foundational Learning

- **Concept: Adsorption Isotherms (Langmuir vs. Freundlich)**
  - Why needed here: The model uses these classical models as "priors" and constraints. Understanding that Langmuir implies a saturation limit while Freundlich is empirical and infinite is critical for interpreting the model's "Physics Parameter Head" outputs.
  - Quick check question: Does the Freundlich model predict a finite maximum adsorption capacity as pressure approaches infinity?

- **Concept: Thermodynamic Consistency (Van't Hoff)**
  - Why needed here: The model enforces Van't Hoff compliance (Eq. 10). You must understand that physisorption is typically exothermic; therefore, adsorption capacity generally decreases as temperature increases. A model predicting the opposite would be physically invalid.
  - Quick check question: If the PINN predicts higher H2 uptake at 100°C than at 25°C for the same pressure and material, is this likely a physics violation or a valid geological anomaly?

- **Concept: Uncertainty Quantification (Monte Carlo Dropout)**
  - Why needed here: The paper claims 85-91% reliability. This relies on MC Dropout. You need to distinguish between "aleatoric" uncertainty (noise in the data) and "epistemic" uncertainty (model ignorance) to use the reliability scores effectively.
  - Quick check question: How does running the model multiple times with dropout enabled during inference help estimate how "confident" the model is?

## Architecture Onboarding

- **Component map:** Raw data -> Feature Engineering (78 physics-informed features) -> Core Network (ResNet + Multi-Head Attention) -> Output Heads (Uptake, Physics Parameters, Uncertainty) -> Loss Calculator (Data Loss + Physics Loss)
- **Critical path:** The **Feature Engineering Module** is the most brittle component. If the calculation of the "confinement parameter" (ξ) or "reduced pressure" is incorrect for a specific lithology, the physics constraints will be applied to garbage data, and the model will fail to converge or produce physically valid results.
- **Design tradeoffs:** The high-performance model has 1.24M parameters but only 155 samples. The paper argues that physics constraints act as a regularizer, but there is a high risk of overfitting if the physics loss weight is too low. The paper claims 67% faster convergence with the complex model, but this requires precise numerical stability handling (NaN detection, gradient clipping) which adds engineering overhead.
- **Failure signatures:** NaN Loss: Likely caused by unstable exponentials in the thermodynamic features or loss calculation (mitigated by input clamping). Non-monotonic Isotherms: The model predicts decreasing uptake with increasing pressure; indicates the "Monotonicity Constraint" weight in the loss function is too low.
- **First 3 experiments:** Baseline Validation: Run the "Stable Baseline" configuration (4 layers, 82k params) on a single lithology (e.g., Clays) to verify the data pipeline and loss convergence before scaling up. Physics Ablation: Train the model with the "Physics Loss" component set to zero. Compare the resulting isotherms against the full model to visualize exactly what "physics consistency" adds (e.g., does the pure ML model predict negative uptake?). Lithology Generalization: Train on Clays and Shales, then test on Coals. Check if the model fails completely or if the physics-informed features allow it to make "physically reasonable" (even if inaccurate) predictions for the unseen lithology.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the adaptive PINN framework accurately predict competitive adsorption dynamics in multicomponent gas mixtures (e.g., H2–CH4–CO2)?
- Basis in paper: [explicit] The conclusion states the framework is "readily extensible" to multicomponent gas mixtures to model real-world reservoir compositions.
- Why unresolved: The current study focuses exclusively on pure hydrogen sorption prediction and does not validate against mixed-gas experimental data.
- What evidence would resolve it: Successful training and validation of the model using datasets containing ternary gas sorption isotherms.

### Open Question 2
- Question: How does the model perform when predicting capacity retention and mechanical stability over long-term sorption-desorption cycles?
- Basis in paper: [explicit] The authors identify the investigation of long-term sorption-desorption cycles over operational timescales as a future application.
- Why unresolved: The current dataset relies on static isotherm measurements rather than dynamic, cyclic experimental data required to assess hysteresis and capacity degradation.
- What evidence would resolve it: Incorporation of time-series sorption data demonstrating the model's ability to capture hysteresis and degradation effects.

### Open Question 3
- Question: Can the framework be improved to better capture the high heterogeneity of coal samples?
- Basis in paper: [explicit] The results identify coal samples as the "most challenging modeling scenario," suggesting the need for more sophisticated theoretical frameworks than the currently employed classical models.
- Why unresolved: The complex microporous organic structure of coals resulted in lower model fits (R² = 0.681 for classical models) compared to clays and shales.
- What evidence would resolve it: Development of coal-specific feature engineering or hybrid architectures that improve predictive accuracy for organic-rich, heterogeneous materials.

### Open Question 4
- Question: Does linking the macro-scale PINN with pore-scale molecular dynamics (MD) simulations improve physical consistency?
- Basis in paper: [explicit] The authors propose linking the macro-scale predictive capability to pore-scale modeling tools like MD and GCMC to provide a multiscale understanding.
- Why unresolved: The current framework integrates classical thermodynamics and ML but does not explicitly bridge the gap to molecular-scale interactions.
- What evidence would resolve it: A coupled simulation framework where PINN predictions are validated or constrained by outputs from molecular dynamics simulations.

## Limitations
- Dataset size remains a critical constraint with only 155 samples despite high model complexity (1.24M parameters), creating inherent overfitting risk despite physics constraints
- Multi-head attention implementation details are unspecified, making exact replication challenging
- Unknown generalizability beyond the three studied lithologies (clays, shales, coals) to other geological formations

## Confidence
- **High confidence:** Physical mechanism claims (physics-guided feature expansion, adaptive loss optimization) supported by explicit mathematical formulations and experimental validation
- **Medium confidence:** Feature engineering methodology due to partial specification of the 78-feature derivation process
- **Medium confidence:** Attention mechanism performance given underspecified implementation details

## Next Checks
1. Test physics constraint removal impact by training with λ = 0 and comparing isotherm validity and accuracy degradation
2. Validate lithology transfer by training on clays+shales and testing exclusively on coals with physics constraints enabled
3. Assess attention necessity by replacing with standard dense layers and measuring performance and interaction detection capability loss