---
ver: rpa2
title: Causal knowledge graph analysis identifies adverse drug effects
arxiv_id: '2505.06949'
source_url: https://arxiv.org/abs/2505.06949
tags:
- causal
- drug
- knowledge
- disease
- effects
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces Causal Knowledge Graphs (CKGs) as a framework
  combining knowledge graphs with causal inference to identify adverse drug effects.
  CKGs extend traditional knowledge graphs by incorporating causal semantics, enabling
  principled causal inference while preserving deductive reasoning capabilities.
---

# Causal knowledge graph analysis identifies adverse drug effects

## Quick Facts
- arXiv ID: 2505.06949
- Source URL: https://arxiv.org/abs/2505.06949
- Reference count: 40
- Primary result: Combines knowledge graphs with causal inference to identify adverse drug effects, achieving precision up to 0.907

## Executive Summary
This paper introduces Causal Knowledge Graphs (CKGs) as a framework that extends traditional knowledge graphs with formal causal semantics, enabling principled causal inference while preserving deductive reasoning capabilities. The authors construct a Drug-Disease CKG integrating disease progression, drug indications, side effects, and ICD-10 hierarchies, then apply mediation analysis to UK Biobank and MIMIC-IV cohorts to test whether drugs mediate effects between indications and downstream disease progression. The approach successfully reproduces known adverse drug reactions with high precision and identifies previously undocumented effects, demonstrating clinical relevance through improved drug indication prediction.

## Method Summary
The authors develop a CKG framework by extending standard knowledge graphs with causal semantics, identifying causal relations and mapping graph nodes to population subsets with probability distributions constrained by logical hierarchies. They construct a Drug-Disease CKG integrating disease progression DAGs, drug indications (MEDI-C), side effects (OnSIDES/OFFSIDES), and ICD-10 hierarchies. For hypothesis generation, they query the CKG to find drug-mediated paths between disease pairs, then automatically identify adjustment sets using Backdoor and Disjunctive Cause criteria from causal theory, pruning via LASSO regression. Mediation analysis estimates the Natural Indirect Effect (ACME) to determine whether drugs contribute to side effect occurrence, validated against established side effect databases.

## Key Results
- Successfully reproduced known adverse drug reactions with precision up to 0.907
- Identified previously undocumented adverse drug effects
- Improved drug indication prediction through side effect similarity analysis (ROC AUC 0.632 vs 0.604)
- Demonstrated clinical relevance by validating novel findings against established databases

## Why This Works (Mechanism)

### Mechanism 1: Semantic Unification of Deduction and Probability
The CKG framework formally extends knowledge graphs by incorporating causal semantics while preserving deductive reasoning. It maps graph nodes to population subsets and enforces logical constraints (like "is a" hierarchies) on probability distributions, allowing both deductive reasoning and causal inference within the same framework.

### Mechanism 2: Automated Confounder Identification via Graph Topology
The system automates confounder selection using CKG connectivity rather than manual specification. It applies Backdoor Adjustment and Disjunctive Cause criteria to identify relevant covariates, then uses LASSO regression to prune high-dimensional adjustment sets, handling scalability challenges in large-scale hypothesis testing.

### Mechanism 3: Mediation Analysis for Effect Isolation
The approach models ADRs as mediation effects, comparing outcome distributions when drugs are set by treatment versus baseline conditions. This isolates the drug's contribution from natural disease progression by estimating the Average Causal Mediation Effect (ACME).

## Foundational Learning

**Concept: Structural Causal Models (SCMs) vs. Knowledge Graphs (KGs)**
*Why needed:* This paper bridges two distinct fields - KGs store associative facts without probability while SCMs model functional relationships for intervention queries.
*Quick check:* Can you explain why a standard KG cannot answer "What happens to Disease Y if I intervene to remove Drug X?" without CKG's probabilistic semantics?

**Concept: Mediation Analysis (ACME)**
*Why needed:* The core signal detection relies on distinguishing direct effects (Disease A → Disease B) from indirect effects (Disease A → Drug → Disease B).
*Quick check:* If ACME is statistically insignificant but total effect is significant, what does this imply about the drug's role in disease progression?

**Concept: Backdoor Criterion & Disjunctive Cause**
*Why needed:* The system automates "what to control for" in causal inference. Understanding these criteria is essential for debugging confounder selection.
*Quick check:* Why does "Disjunctive Cause" potentially include more variables than "Backdoor," and how does LASSO help manage this?

## Architecture Onboarding

**Component map:** Input Layer (MEDI-C, OnSIDES, Disease DAG, UK Biobank/MIMIC-IV) → Integration Layer (DD-CKG, LLM Mapper) → Computation Layer (Hypothesis Generator, Confounder Selector, Mediation Engine) → Output (Validated ADRs & Novel Candidates)

**Critical path:** Data Mapping (RxNorm/ICD → Cohort IDs) → CKG Construction (hierarchy constraints) → Hypothesis Filtering (removing graph-explainable pairs) → Adjustment Set Calculation → Mediation Testing

**Design tradeoffs:**
- Precision vs. Discovery: "Causal Set" yields high precision (0.907) but low recall; "Comorbidity Set" yields lower precision (0.749) but higher discovery
- Automation vs. Accuracy: LLM mapping achieved 0.76 F1-score; manual curation is more accurate but doesn't scale
- Complexity vs. Interpretability: LASSO pruning reduces adjustment set size but risks excluding weak confounders

**Failure signatures:**
- Severity Confounding: System may output false positives when outcomes are disease severity markers rather than drug effects
- Sample Size Exclusion: Small N hypotheses are discarded, potentially missing rare but critical signals
- Temporal Leakage: Violating indication → prescription → outcome timing invalidates causal directionality

**First 3 experiments:**
1. Validate the LLM mapping pipeline on 50 sample drugs and compare precision/recall against ground truth
2. Reproduce the "Vincristine → Tumor Lysis Syndrome" hypothesis to verify expected ACME and adjustment set generation
3. Run mediation analysis with no adjustment, full Disjunctive Cause, and LASSO-pruned adjustment sets to compare sensitivity to confounder selection

## Open Questions the Paper Calls Out

**Open Question 1:** Can integrating explicit clinical severity scores or lab-based metrics eliminate false positives caused by disease severity confounding?
*Basis:* 6% of manually evaluated false positives likely represented disease progression rather than drug mediation.
*Resolution:* Re-running mediation analysis with quantitative severity indices and demonstrating reduced false positives.

**Open Question 2:** Does incorporating text-mined phenotypes from clinical notes for mild or transient effects improve CKG model sensitivity?
*Basis:* ICD-coded diagnoses miss transient or mild side effects; text mining approaches are suggested.
*Resolution:* Constructing a CKG with NLP-derived entities and demonstrating increased recall for mild ADRs without precision loss.

**Open Question 3:** Can CKGs be extended to support more expressive knowledge representation languages while maintaining probabilistic tractability?
*Basis:* The approach may be extended beyond current subsumption hierarchies to more expressive frameworks.
*Resolution:* Formal generalization of CKG definition accommodating Description Logic axioms and demonstrating improved confounding control.

## Limitations

- LLM-based drug mapping achieved only 0.76 F1-score, introducing potential noise into the causal inference pipeline
- Reliance on specific databases (UK Biobank, MIMIC-IV, MEDI-C, OnSIDES) may limit generalizability to other populations or drug classes
- Clinical significance of many newly identified relationships remains to be validated through independent studies

## Confidence

- **High Confidence:** Precision-recall tradeoff for known ADR reproduction (precision 0.907) is robust and systematically validated
- **Medium Confidence:** Novel effect identification methodology is sound but clinical significance requires independent validation
- **Low Confidence:** Scalability claims depend on computational resources not detailed, and LASSO pruning may exclude relevant variables

## Next Checks

1. Test the CKG framework on an independent EHR dataset (e.g., IBM MarketScan) to assess generalizability across healthcare systems and populations

2. Conduct sensitivity analysis by varying temporal windows for indication-drug-side effect sequences to determine effects on causal inference validity

3. Systematically evaluate performance on rare adverse events by simulating low-prevalence scenarios and measuring detection rates versus traditional pharmacovigilance methods