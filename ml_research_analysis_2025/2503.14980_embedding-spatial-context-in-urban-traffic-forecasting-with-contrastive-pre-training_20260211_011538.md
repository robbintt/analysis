---
ver: rpa2
title: Embedding spatial context in urban traffic forecasting with contrastive pre-training
arxiv_id: '2503.14980'
source_url: https://arxiv.org/abs/2503.14980
tags:
- traffic
- graph
- nodes
- data
- road
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses urban traffic forecasting by integrating spatial
  context through a novel pre-training approach. The authors propose a geometric encoder
  trained using contrastive learning on road topology and sensor data to capture neighborhood
  patterns.
---

# Embedding spatial context in urban traffic forecasting with contrastive pre-training

## Quick Facts
- arXiv ID: 2503.14980
- Source URL: https://arxiv.org/abs/2503.14980
- Reference count: 15
- Primary result: Geometric encoder trained via contrastive learning on road topology and sensor data improves 12-step-ahead traffic forecasting across METR-LA, PEMS-BAY, and PEMS-D7(m) datasets

## Executive Summary
This paper addresses urban traffic forecasting by integrating spatial context through a novel pre-training approach. The authors propose a geometric encoder trained using contrastive learning on road topology and sensor data to capture neighborhood patterns. The key innovation is constructing "traffic quotient graphs" that combine real road connectivity with traffic sensor locations, allowing models to learn from spatial features like road geometry, speed limits, and points of interest from OpenStreetMap. When integrated with Graph WaveNet using spatially gated addition, this approach improves traffic forecasting performance across multiple datasets with 12-step-ahead predictions.

## Method Summary
The proposed method combines geometric pre-training with contrastive learning to capture spatial context in urban traffic networks. The approach constructs traffic quotient graphs by integrating real road connectivity with sensor locations, then trains a geometric encoder using contrastive learning to learn spatial representations from OpenStreetMap features including road geometry, speed limits, and points of interest. This pre-trained encoder is then integrated with Graph WaveNet through spatially gated addition, where the spatial features modulate the graph convolution output. The method requires zero additional traffic data collection beyond existing sensor networks, relying instead on freely available map data to enhance forecasting performance.

## Key Results
- Achieved mean absolute errors of 12.77 (METR-LA), 6.05 (PEMS-BAY), and 8.84 (PEMS-D7(m)) for 12-step-ahead predictions
- Demonstrated improved generalization compared to baseline Graph WaveNet models
- Validated effectiveness across three distinct US traffic datasets

## Why This Works (Mechanism)
The method works by leveraging spatial context that traditional traffic forecasting models often ignore. By pre-training on road topology and sensor data, the geometric encoder learns meaningful spatial representations that capture neighborhood patterns and road network characteristics. The contrastive learning framework forces the model to distinguish between similar and dissimilar spatial configurations, creating more robust feature representations. When these spatial features are combined with traffic data through the spatially gated addition mechanism, the model can better understand how road network structure influences traffic flow patterns.

## Foundational Learning

**Graph Neural Networks** - why needed: Traffic networks are naturally represented as graphs with sensors as nodes and road connections as edges; quick check: verify graph construction preserves actual road network topology

**Contrastive Learning** - why needed: Enables learning spatial representations without labeled traffic data by leveraging the structure of road networks; quick check: ensure positive/negative pairs in contrastive loss reflect meaningful spatial relationships

**OpenStreetMap Data Integration** - why needed: Provides rich spatial features (speed limits, points of interest, road geometry) that correlate with traffic patterns; quick check: validate map data accuracy for target geographic area

**Spatial Gating Mechanisms** - why needed: Allows spatial features to modulate traffic predictions without overwhelming the temporal patterns; quick check: verify gating parameters don't collapse to zero or explode during training

**Traffic Quotient Graphs** - why needed: Combines real road connectivity with sensor locations to create a more accurate representation of traffic flow; quick check: ensure all sensors are properly connected to relevant road segments

## Architecture Onboarding

**Component Map:** OpenStreetMap Data -> Traffic Quotient Graph Construction -> Geometric Encoder (Contrastive Pre-training) -> Spatial Feature Extraction -> Graph WaveNet Backbone -> Spatially Gated Addition -> Traffic Forecasting Output

**Critical Path:** The most critical path is the integration between the pre-trained geometric encoder and the Graph WaveNet backbone through the spatially gated addition mechanism. This integration must balance the spatial context with the temporal traffic patterns effectively.

**Design Tradeoffs:** The method trades increased model complexity and pre-training requirements for improved spatial awareness. While it requires zero additional traffic data collection, it depends heavily on the quality and availability of map data, which may vary significantly across regions.

**Failure Signatures:** Potential failure modes include: poor performance when map data is incomplete or inaccurate, degraded accuracy when spatial features don't correlate with traffic patterns in certain regions, and computational overhead from the additional pre-training step.

**First Experiments:** 1) Test contrastive pre-training convergence with different temperature parameters in the contrastive loss; 2) Evaluate the impact of varying the spatial feature dimensionality on forecasting accuracy; 3) Compare performance using different OpenStreetMap data providers or varying levels of map detail.

## Open Questions the Paper Calls Out
None identified in the source material.

## Limitations
- Reliance on OpenStreetMap data quality, which varies significantly across regions
- Performance improvements show varying degrees across different metrics and datasets
- Generalization to regions with different traffic patterns and road network structures requires further testing

## Confidence

**High confidence:** The technical implementation of the geometric encoder and its integration with Graph WaveNet is well-documented and reproducible.

**Medium confidence:** The performance improvements are validated on multiple datasets, but the generalizability to regions with different traffic patterns and road network structures requires further testing.

**Medium confidence:** The claim about zero additional data collection is technically true but may underestimate practical requirements for map data quality.

## Next Checks

1. Test the method on traffic datasets from cities with significantly different road network structures (e.g., European cities with roundabouts, Asian megacities with complex intersections) to assess cross-regional generalization.

2. Evaluate the impact of OpenStreetMap data quality by comparing performance using different map data sources or varying levels of map detail for the same geographic area.

3. Conduct ablation studies to quantify the individual contributions of different spatial features (speed limits, points of interest, road geometry) to the forecasting accuracy, helping identify which features are most critical across different contexts.