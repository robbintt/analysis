---
ver: rpa2
title: Unified Brain Surface and Volume Registration
arxiv_id: '2512.19928'
source_url: https://arxiv.org/abs/2512.19928
tags:
- cortical
- registration
- dice
- image
- surface
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: NeurAlign is a deep learning method for joint registration of cortical
  surfaces and subcortical volumes in brain MRI. It combines a volumetric registration
  network with a spherical registration network, using a consistency loss to ensure
  coherent alignment between the two domains.
---

# Unified Brain Surface and Volume Registration

## Quick Facts
- arXiv ID: 2512.19928
- Source URL: https://arxiv.org/abs/2512.19928
- Reference count: 28
- Primary result: NeurAlign achieves up to 7.5 Dice points higher cortical alignment accuracy than state-of-the-art baselines

## Executive Summary
NeurAlign introduces a deep learning framework for joint registration of cortical surfaces and subcortical volumes in brain MRI. Unlike traditional methods that treat volume and surface registration separately, NeurAlign trains a single model that jointly optimizes both using a consistency loss to ensure coherent alignment between the two domains. The method requires only T1-weighted MRI at inference and no surface meshes, making it more practical than classical approaches. Evaluated on three datasets, NeurAlign achieves significant improvements in cortical alignment accuracy while maintaining subcortical performance and producing deformation fields with negligible folding.

## Method Summary
NeurAlign combines a 3D U-Net for volumetric registration with a 2D U-Net for spherical registration, using a consistency loss to couple the two domains. Both networks predict stationary velocity fields (SVF) that are integrated to produce diffeomorphic displacement fields. The method samples the volumetric deformation at mesh vertex locations and compares it to the spherical displacement back-projected to Euclidean space, ensuring coherent alignment. Training requires FreeSurfer preprocessing to obtain cortical meshes, inflated spheres, and segmentations, but inference needs only T1-weighted MRI. The loss function combines similarity, consistency, regularization, and structure terms with weights λ=1.0, γ=0.05, and κ=10.0.

## Key Results
- Up to 7.5 Dice points higher cortical alignment accuracy than state-of-the-art baselines
- Maintains subcortical performance while improving cortical registration
- Produces deformation fields with negligible folding (0.08-0.17% vs 1.73-2.16% for classical approaches)
- Runs orders of magnitude faster than the standard classical approach

## Why This Works (Mechanism)

### Mechanism 1
Joint volumetric-spherical training with consistency coupling produces cortical alignment that pure volumetric methods cannot achieve. The cortical consistency loss samples the 3D deformation field at mesh vertex locations via trilinear interpolation and penalizes disagreement with the spherical displacement back-projected to Euclidean space. Gradients from this surface-derived loss propagate to neighboring voxels, distributing the alignment signal throughout the volumetric field while smoothness regularization propagates constraints inward from the cortex.

### Mechanism 2
Geometric descriptors (sulcal depth, curvature) on the spherical domain capture functional cortical organization invisible to intensity-based volumetric registration. The spherical network optimizes alignment of pre-computed geometric features via local normalized cross-correlation, with sin(θ) weighting correcting for polar area distortion from stereographic projection.

### Mechanism 3
Diffeomorphic parameterization via stationary velocity field (SVF) integration guarantees smooth, invertible deformations with negligible folding. Both networks predict SVF which are integrated via scaling-and-squaring to produce diffeomorphic fields. This bounds Jacobian determinants away from zero by construction, with explicit regularization further penalizing irregularity.

## Foundational Learning

- **Diffeomorphic Registration via SVF:** Understanding how velocity field integration produces topology-preserving warps is essential for debugging field regularity issues. Quick check: Can you explain why integrating an SVF guarantees det(Jacobian) > 0?
- **Spherical Parameterization & Distortion Correction:** The stereographic projection introduces non-uniform sampling; without sin(θ) weighting, polar regions receive disproportionate loss weight. Quick check: Why does stereographic projection over-sample near the poles?
- **Multi-Task Gradient Mixing:** Balancing similarity, consistency, regularization, and structure losses requires understanding how competing gradients interact during optimization. Quick check: If γ (consistency weight) is set too high, what failure mode would you expect?

## Architecture Onboarding

- **Component map:** 3D U-Net (volumetric) → SVF → integrated φ; 2D U-Net (spherical) → SVF → integrated ψ; Consistency module: samples φ at mesh vertices, compares to π⁻¹(ψ(π(v))); Loss aggregator: Eq. (5) with γ=0.05, λ=1.0, κ=10.0
- **Critical path:** Preprocessing (FreeSurfer surface extraction + inflation) → paired sampling → forward pass through both networks → consistency computation → backprop
- **Design tradeoffs:** Higher κ improves Dice but increases folding; requiring surfaces at training but not inference trades preprocessing burden for deployment simplicity
- **Failure signatures:** Cortical Dice stuck near baseline → check spherical features computation; high % folds → reduce κ or increase λ; subcortical Dice degrades → reduce γ
- **First 3 experiments:** 1) Baseline replication: Train VoxelMorph on OASIS subset; verify cortical Dice ~0.58 matches Table 2. 2) Ablation sweep: Add components sequentially to isolate spherical consistency contribution. 3) Hyperparameter sensitivity: Grid search κ ∈ {1, 5, 10, 50} on validation; plot Dice vs. % folds to identify Pareto frontier.

## Open Questions the Paper Calls Out

### Open Question 1
Can NeurAlign maintain high accuracy when applied to pediatric populations or lower-quality clinical MRI scans? The authors state it "remains unclear how well the model can generalize to lower-quality clinical scans or to pediatric populations." This is unresolved because the model was trained and evaluated exclusively on adult T1-weighted datasets. Evaluation on pediatric datasets (e.g., dHCP) and clinical scans would resolve this.

### Open Question 2
How can the framework be extended to incorporate multimodal information (e.g., T2w, FLAIR, DWI) to improve alignment? The authors note "An interesting future direction is extending NeurAlign to multimodal acquisitions" to aid subcortical tissue segmentation. This is unresolved because the current implementation relies on T1w for reliable surface reconstruction. A training paradigm using aligned multimodal inputs would resolve this.

### Open Question 3
Can the method be modified to accommodate topology-altering pathologies, such as lesions or surgical resections? The authors note "NeurAlign cannot accurately accommodate topology-altering pathologies" as a limitation of the diffeomorphic framework. This is unresolved because diffeomorphic registrations preserve topology by definition. Integration of pathology masking techniques or non-diffeomorphic components, validated on patient data with lesions, would resolve this.

## Limitations
- Architectural details (U-Net depth, channel dimensions, SVF integration scheme) are underspecified, creating nontrivial implementation gaps
- Performance improvements rely heavily on FreeSurfer preprocessing, which introduces variability
- Generalization to non-T1 modalities and populations with abnormal cortical folding patterns is untested
- Cannot accommodate topology-altering pathologies like lesions or surgical resections

## Confidence
- **High confidence**: Diffeomorphic registration via SVF integration produces topologically valid deformations
- **Medium confidence**: Joint training with consistency loss improves cortical alignment
- **Low confidence**: Spherical geometric features are reliable proxies for functional homology across diverse populations

## Next Checks
1. **Architecture sensitivity**: Reproduce results across 3 different U-Net configurations to isolate whether gains stem from joint training or specific network architecture
2. **Cross-population robustness**: Evaluate on pediatric and pathological datasets to assess generalization beyond healthy elderly subjects
3. **Ablation on FreeSurfer dependency**: Compare against surface-free baselines to quantify contribution of spherical consistency vs. preprocessing pipeline