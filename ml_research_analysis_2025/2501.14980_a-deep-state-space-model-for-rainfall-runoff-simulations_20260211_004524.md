---
ver: rpa2
title: A Deep State Space Model for Rainfall-Runoff Simulations
arxiv_id: '2501.14980'
source_url: https://arxiv.org/abs/2501.14980
tags:
- s4d-ft
- lstm
- watersheds
- skill
- performance
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces State Space Models (SSMs), specifically the
  Frequency Tuned Diagonal State Space Sequence (S4D-FT), for rainfall-runoff simulations.
  Evaluated on 531 watersheds in the contiguous United States, S4D-FT outperforms
  the established LSTM model and a physically-based Sacramento Soil Moisture Accounting
  model.
---

# A Deep State Space Model for Rainfall-Runoff Simulations

## Quick Facts
- arXiv ID: 2501.14980
- Source URL: https://arxiv.org/abs/2501.14980
- Authors: Yihan Wang; Lujun Zhang; Annan Yu; N. Benjamin Erichson; Tiantian Yang
- Reference count: 40
- Primary result: S4D-FT outperforms LSTM in 531 U.S. watersheds with better NSE (0.74 vs 0.72) and KGE (0.75 vs 0.74) metrics

## Executive Summary
This paper introduces State Space Models (SSMs), specifically the Frequency Tuned Diagonal State Space Sequence (S4D-FT), for rainfall-runoff simulations. Evaluated on 531 watersheds in the contiguous United States, S4D-FT outperforms the established LSTM model and a physically-based Sacramento Soil Moisture Accounting model. S4D-FT shows better median NSE (0.74 vs. 0.72) and KGE (0.75 vs. 0.74) compared to LSTM. The improved performance is particularly notable in watersheds with frequent and prolonged high/low-flow events and smaller flow magnitudes, such as snowmelt-driven regimes. However, S4D-FT underperforms in regions with large daily mean and peak streamflow values. The study highlights S4D-FT's potential as a superior alternative to LSTM for rainfall-runoff simulations.

## Method Summary
The study employs S4D-FT, a variant of State Space Models with frequency tuning capabilities, to simulate rainfall-runoff processes. The model is trained on a large dataset comprising 531 watersheds across the contiguous United States, using historical precipitation and streamflow data. Performance is evaluated against both a traditional LSTM model and a physically-based Sacramento Soil Moisture Accounting model using Nash-Sutcliffe Efficiency (NSE) and Kling-Gupta Efficiency (KGE) metrics. The analysis examines regional variations in performance across different hydrological regimes, including snowmelt-driven and pluvio-nival watersheds.

## Key Results
- S4D-FT achieves median NSE of 0.74 and KGE of 0.75, outperforming LSTM's NSE of 0.72 and KGE of 0.74
- S4D-FT excels in watersheds with frequent and prolonged high/low-flow events and smaller flow magnitudes
- S4D-FT underperforms in regions with large daily mean and peak streamflow values, particularly in pluvio-nival regimes

## Why This Works (Mechanism)
The mechanism behind S4D-FT's performance advantages stems from its state space modeling architecture, which can capture long-range dependencies and frequency characteristics in hydrological time series. The diagonal structure of S4D-FT provides computational efficiency while maintaining the ability to model complex temporal patterns. The frequency tuning component allows the model to adapt to different hydrological regimes by emphasizing relevant frequency components in the data. However, the exact physical processes being captured by the model remain unclear due to its black-box nature, limiting interpretability of its predictions.

## Foundational Learning
- State Space Models (SSMs): Mathematical frameworks for modeling dynamic systems that generalize both recurrent and convolutional architectures
  - Why needed: Provide theoretical advantages in handling long-range dependencies and sequence modeling
  - Quick check: Understand the difference between SSMs and traditional RNNs/LSTMs
- Frequency Tuning: Technique to adapt model behavior to different frequency components in time series data
  - Why needed: Hydrological processes operate at multiple temporal scales (hourly to seasonal)
  - Quick check: Know how frequency adaptation improves model performance across regimes
- Nash-Sutcliffe Efficiency (NSE): Metric for evaluating hydrological model performance that measures the ratio of residual variance to observed data variance
  - Why needed: Standard metric for comparing rainfall-runoff models
  - Quick check: Understand NSE interpretation (values > 0.5 indicate acceptable performance)
- Kling-Gupta Efficiency (KGE): Multi-component metric that decomposes error into correlation, bias, and variability components
  - Why needed: Provides more comprehensive evaluation than NSE alone
  - Quick check: Know how KGE captures different aspects of model performance

## Architecture Onboarding

Component Map: Input -> Preprocessing -> S4D-FT Block -> Output Layer -> Prediction

Critical Path: The model processes time series data through the S4D-FT block, where the core state space computations occur. The frequency tuning component adapts the model's response to different hydrological regimes, followed by output transformation to generate streamflow predictions.

Design Tradeoffs: S4D-FT trades interpretability for improved performance, as the state space formulation provides computational advantages but creates a black-box model. The diagonal structure offers efficiency gains but may limit expressiveness compared to full state space models. The frequency tuning capability adds complexity but enables better adaptation to diverse watershed characteristics.

Failure Signatures: The model shows consistent underperformance in simulating high-flow volumes in watersheds with large daily mean and peak streamflow values. This suggests limitations in capturing extreme flow events, particularly in pluvio-nival regimes where both rainfall and snowmelt contribute to peak flows. The model also struggles with large magnitude flows regardless of regime type.

First Experiments:
1. Compare S4D-FT performance across different watershed sizes to identify scale-dependent limitations
2. Test the model's ability to capture extreme events by focusing on peak flow prediction accuracy
3. Evaluate the impact of different preprocessing techniques on model performance to understand data dependencies

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What specific hydrologic processes or latent mechanisms drive S4D-FT's consistent underperformance in simulating high-flow volumes in pluvio-nival regimes?
- Basis in paper: [explicit] The authors state their explanation of regional variability remains "superficial" and explicitly ask, "What specific hydrologic processes are these models effectively simulating, and where do they fall short?"
- Why unresolved: The "black-box" nature of deep learning models prevents the identification of the exact physical processes causing the underestimation of high-flow peaks (low FHV) in regions with large streamflow magnitudes.
- What evidence would resolve it: Interpretability analyses (e.g., probing hidden states) linking model weights to physical variables, or ablation studies identifying architectural bottlenecks in high-flow scenarios.

### Open Question 2
- Question: Can S4D-FT be effectively integrated with generative frameworks to provide reliable uncertainty estimates for extreme flow forecasting?
- Basis in paper: [explicit] The Conclusion states, "Future research should explore the integration of generative models for probabilistic time series forecasting... to provide uncertainty estimates."
- Why unresolved: The current study focuses on deterministic simulations; the paper does not test S4D-FT's compatibility with generative approaches or its ability to capture predictive uncertainty.
- What evidence would resolve it: Development of a probabilistic S4D-FT variant (e.g., using diffusion or flow-matching) benchmarked on reliability diagrams and CRPS scores.

### Open Question 3
- Question: Can physics-aware constraints be incorporated into S4D-FT to improve high-flow bias without degrading its computational efficiency or overall accuracy?
- Basis in paper: [inferred] The Discussion highlights physics-aware DL (e.g., MC-LSTM) as a way to balance accuracy and interpretability, suggesting this as a solution to the "black-box" limitations identified.
- Why unresolved: While physics-aware models exist for LSTMs, it is unknown if imposing constraints (like mass conservation) on State Space Models preserves their theoretical speed and stability advantages.
- What evidence would resolve it: A modified S4D-FT architecture with physical constraints, evaluated on both standard metrics (NSE/KGE) and physical consistency.

## Limitations
- The study focuses exclusively on a single SSM architecture without comparing against other emerging SSM variants or hybrid approaches
- Performance improvements over LSTM, while statistically significant, represent relatively modest gains (0.02-0.03 point differences in NSE and KGE)
- The comparison with the physically-based Sacramento Soil Moisture Accounting model lacks detailed analysis of specific conditions where each approach excels

## Confidence

Medium: The core claim that S4D-FT outperforms LSTM in most watershed conditions is supported by comprehensive dataset of 531 watersheds and established evaluation metrics (NSE and KGE).

## Next Checks
1. Conduct ablation studies to isolate the contribution of the frequency tuning component in S4D-FT's performance improvements
2. Test S4D-FT on additional hydrological tasks beyond rainfall-runoff simulation, such as water quality forecasting or drought prediction
3. Perform cross-validation across different climate regions and watershed sizes to better understand the model's limitations and optimal application domains