---
ver: rpa2
title: 'ProDM: Synthetic Reality-driven Property-aware Progressive Diffusion Model
  for Coronary Calcium Motion Correction in Non-gated Chest CT'
arxiv_id: '2512.24948'
source_url: https://arxiv.org/abs/2512.24948
tags:
- motion
- calcium
- loss
- correction
- prodm
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: ProDM introduces a synthetic reality-driven, property-aware progressive
  diffusion model for coronary calcium motion correction in non-gated chest CT. It
  simulates realistic motion-corrupted datasets from gated CTs, enabling supervised
  learning without paired data.
---

# ProDM: Synthetic Reality-driven Property-aware Progressive Diffusion Model for Coronary Calcium Motion Correction in Non-gated Chest CT

## Quick Facts
- arXiv ID: 2512.24948
- Source URL: https://arxiv.org/abs/2512.24948
- Reference count: 40
- ProDM achieved Agatston Score MAE of 9.391, severity grade accuracy of 95.334%, and Pearson correlation of 0.993 on synthetic test data

## Executive Summary
ProDM introduces a synthetic reality-driven, property-aware progressive diffusion model for coronary calcium motion correction in non-gated chest CT. It simulates realistic motion-corrupted datasets from gated CTs, enabling supervised learning without paired data. The model uses a differentiable calcium consistency loss to preserve lesion properties and a progressive diffusion framework for stable artifact reduction. Evaluated on synthetic and real non-gated CTs, ProDM achieved an Agatston Score MAE of 9.391, severity grade accuracy of 95.334%, and Pearson correlation of 0.993. A reader study confirmed superior motion suppression, clinical usability, and vessel fidelity compared to baseline methods.

## Method Summary
ProDM addresses motion artifacts in non-gated chest CT by training on synthetic data generated from gated CTs. A motion simulation engine creates paired (motion-free, motion-corrupted) datasets by forward-projecting gated CTs with trajectory-perturbed calcium positions, then reconstructing via inverse Radon transform. The model employs a 2.5D UNet architecture trained on 3-slice patches with a bridge diffusion formulation that interpolates between motion-corrupted and motion-free endpoints. A differentiable calcium consistency loss preserves lesion integrity by using a volume score surrogate for the non-differentiable Agatston score. The model is trained on 435 ECG-gated CT scans from the Stanford COCA dataset, with synthetic data covering 21 motion profiles.

## Key Results
- Agatston Score MAE of 9.391 on synthetic test data
- Severity grade accuracy of 95.334% (normal/minimal/mild: 97.8%, moderate: 95.1%, severe: 92.3%)
- Pearson correlation of 0.993 between predicted and reference scores
- Reader study on real non-gated CTs showed superior motion suppression, clinical usability, and vessel fidelity compared to baseline methods

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Supervised motion correction can be learned from synthetic motion-corrupted data when the simulation covers realistic motion trajectories.
- Mechanism: The CAC motion simulation engine generates paired (motion-free, motion-corrupted) samples by forward-projecting gated CTs with trajectory-perturbed calcium positions, then reconstructing via inverse Radon transform. This creates a diverse training distribution (21 motion profiles, 5 projection counts) that spans real motion patterns.
- Core assumption: Simulated motion artifacts sufficiently approximate the distribution of real non-gated CT artifacts.
- Evidence anchors:
  - [abstract] "simulates realistic motion-corrupted datasets from gated CTs, enabling supervised learning without paired data"
  - [section 2.1] "We simulated 21 motion profiles to represent a range of plausible coronary calcium motion trajectories... covering random jitters, translational, oscillatory, and piecewise movements"
  - [corpus] Limited direct evidence; neighbor paper on diffusion for brain MRI motion correction (arXiv:2502.01418) suggests diffusion-based motion correction is being explored, but not for CAC specifically.
- Break condition: If real non-gated CT motion patterns fall outside simulated trajectory space (e.g., complex combined cardiac-respiratory motion), performance may degrade.

### Mechanism 2
- Claim: A differentiable calcium consistency loss preserves lesion intensity and spatial distribution better than pixel-wise reconstruction loss alone.
- Mechanism: The soft volume score computes a sigmoid-based soft mask over voxels exceeding 130 HU, summing intensities as a differentiable surrogate for the non-differentiable Agatston score. The log-space MSE loss penalizes deviations between predicted and reference calcium burden.
- Core assumption: Volume score is a sufficient proxy for Agatston score optimization; the soft threshold (τ=60) adequately approximates the hard 130 HU clinical threshold.
- Evidence anchors:
  - [abstract] "differentiable calcium consistency loss to preserve lesion integrity"
  - [section 2.2.3] "To address this, we employ the Volume score as a differentiable surrogate that approximates the Agatston score by summing the intensities of all voxels exceeding the clinical threshold of 130 HU"
  - [corpus] No direct corpus evidence for calcium-specific consistency losses in diffusion models.
- Break condition: If calcium intensity distributions differ substantially between synthetic training and real inference data (e.g., scanner-specific HU calibration), the learned intensity preservation may not transfer.

### Mechanism 3
- Claim: A bridge diffusion formulation that interpolates between motion-corrupted and motion-free endpoints produces more stable artifact reduction than standard noise-to-image diffusion.
- Mechanism: The forward process defines x_t as a convex combination (1-α_t)x_0 + α_t y plus noise, where x_0 is motion-free and y is motion-corrupted. The reverse process conditions on y throughout, learning to progressively denoise toward x_0 rather than pure noise.
- Core assumption: Motion correction is better modeled as structured interpolation than as unconditional generation from noise.
- Evidence anchors:
  - [abstract] "progressive diffusion framework for stable artifact reduction"
  - [section 2.2] "This formulation is suitable for our motion correction task because it constrains the diffusion process to begin and end with meaningful images rather than arbitrary noise"
  - [corpus] BBDM (Brownian Bridge Diffusion Models) is mentioned in baselines; neighbor corpus lacks specific bridge diffusion evidence for medical imaging.
- Break condition: If the diffusion schedule (T=1000 steps) is aggressively subsampled for inference efficiency, intermediate states may drift from valid CT distributions.

## Foundational Learning

- Concept: **Radon Transform and CT Reconstruction Physics**
  - Why needed here: The motion simulation engine relies on forward/inverse Radon transforms to synthesize realistic sinogram-level motion artifacts. Without understanding projection geometry, the simulation pipeline is opaque.
  - Quick check question: If a calcium lesion is displaced by 5mm during a 360-projection acquisition, how does this manifest in the reconstructed image vs. the sinogram?

- Concept: **Diffusion Model Training Objective (ELBO)**
  - Why needed here: ProDM trains by optimizing a simplified ELBO to predict noise ε_θ at each timestep. Understanding this objective is necessary to debug training divergence or mode collapse.
  - Quick check question: In Eq. 6, why is the target noise defined as α_t(y-x_0) + √δ_t ε rather than just ε?

- Concept: **Agatston Score Calculation**
  - Why needed here: The clinical metric (Agatston score MAE, severity grade accuracy) drives evaluation and the calcium consistency loss design. The non-differentiable nature of peak-intensity-dependent scoring motivates the volume score surrogate.
  - Quick check question: Why does the Agatston score depend on maximum voxel intensity within a lesion, making it non-differentiable?

## Architecture Onboarding

- Component map: Data preprocessing (HU clipping [-200, 800], normalization) -> patch extraction around ROIs -> forward diffusion sampling -> UNet forward pass -> loss computation -> Adam update
- Critical path: Data preprocessing (HU clipping [-200, 800], normalization) → patch extraction around ROIs → forward diffusion sampling → UNet forward pass → loss computation → Adam update
- Design tradeoffs:
  - 2.5D training (k=3 axial slices) vs. full 3D: Ablation shows k=3 outperforms k=5,7,9; suggests calcium motion is confined to narrow axial range, and larger context introduces noise.
  - T=1000 diffusion steps vs. accelerated sampling: High quality but slow inference; 100-step sampling interval used for efficiency.
  - Synthetic training vs. domain adaptation: Strong synthetic performance (MAE 9.391) but real-data reader study scores average ~3/5, indicating remaining domain gap.
- Failure signatures:
  - Oversmoothing with intensity loss: UNet baseline shows this (grade accuracy drops for moderate/severe categories)
  - Spatial distortion of lesions: DDPM produces sharp results but distorts calcium distribution (Fig. 3, samples #2, #3)
  - Under-representation of lesions: cGAN produces lower intensity and incorrect spatial distribution
- First 3 experiments:
  1. Reproduce motion simulation on a single gated CT scan: Verify that simulated artifacts visually match Fig. 1 patterns and that Agatston score deviation correlates with motion severity.
  2. Ablate calcium consistency loss (λ=0 vs. λ=20): Confirm that per-class F1 improves for minimal/mild ranges (1-10, 11-100) as reported in Table 2.
  3. Evaluate on real non-gated patches with reader study: Establish baseline inter-rater agreement and compare ProDM vs. UNet on motion suppression, clinical usability, and vessel fidelity.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can a carefully designed fully 3D variant overcome the performance limitations observed when increasing axial context thickness in the current 2.5D approach?
- Basis in paper: [explicit] The authors state, "Whether a carefully designed 3D variant could overcome these limitations remains an open question."
- Why unresolved: The current 2.5D ablation studies show that increasing the number of context slices degrades performance due to distracting structures, while full 3D training is computationally intensive.
- What evidence would resolve it: Development of a full 3D architecture that maintains or improves Agatston score accuracy and Dice loss compared to the 2.5D baseline without incurring prohibitive computational costs.

### Open Question 2
- Question: Can diffusion acceleration techniques be effectively integrated into ProDM to reduce the reliance on 1000 timesteps without sacrificing motion correction stability?
- Basis in paper: [explicit] The paper identifies integrating acceleration techniques (such as those by Zhou et al., 2024) as "a promising direction for improving training efficiency."
- Why unresolved: The current model requires T=1000 steps to ensure high-quality, stable motion correction, which results in extensive training and inference times.
- What evidence would resolve it: Experiments demonstrating that accelerated sampling schedules (e.g., fewer steps) maintain a Pearson correlation >0.99 and similar Agatston MAE compared to the baseline.

### Open Question 3
- Question: To what extent can domain-adaptation strategies or more realistic simulation pipelines bridge the sim-to-real gap to consistently achieve optimal clinical ratings?
- Basis in paper: [inferred] The discussion notes that achieving consistent ratings of 4 or 5 (optimal quality) may require "more extensive and realistic simulation pipelines, domain-adaptation strategies."
- Why unresolved: While ProDM outperformed baselines, the reader study on real data averaged a score of ~3 (good but with minor limitations), indicating room for improvement in real-world generalizability.
- What evidence would resolve it: A reader study where ProDM, enhanced by domain adaptation, achieves statistically significant improvements in "clinical usability" and "vessel fidelity" ratings on real non-gated scans.

## Limitations
- The sim-to-real transfer capability remains uncertain given that synthetic training performance (MAE 9.391, grade accuracy 95.334%) significantly exceeds real non-gated CT reader study scores (average ~3/5).
- The calcium consistency loss relies on a soft volume score approximation that may not perfectly preserve the clinically critical Agatston score.
- The 2.5D training approach with k=3 axial slices may miss calcium motion patterns that extend beyond this limited axial range.

## Confidence
- High Confidence: The synthetic motion simulation framework (Mechanism 1) is technically sound and well-documented with clear equations and implementation details.
- Medium Confidence: The calcium consistency loss design (Mechanism 2) is theoretically justified but lacks direct validation against clinical Agatston scoring in real data.
- Medium Confidence: The bridge diffusion formulation (Mechanism 3) is appropriate for the task but the superiority over standard noise-to-image diffusion is not rigorously proven through ablation.

## Next Checks
1. **Domain Adaptation Verification**: Test ProDM on a small real non-gated CT dataset with expert Agatston scoring to quantify the actual sim-to-real performance gap and identify specific failure modes.
2. **Calcium Loss Ablation Study**: Systematically vary the calcium consistency loss weight λ (e.g., 0, 5, 20, 50) and measure the impact on both volume preservation and clinical scoring metrics on real data.
3. **3D Context Expansion**: Evaluate ProDM with k=5 and k=7 axial slices on synthetic test data to determine if the current 2.5D approach misses clinically relevant calcium motion patterns.