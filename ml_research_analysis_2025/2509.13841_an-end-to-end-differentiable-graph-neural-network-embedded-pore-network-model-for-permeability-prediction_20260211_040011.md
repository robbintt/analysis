---
ver: rpa2
title: An End-to-End Differentiable, Graph Neural Network-Embedded Pore Network Model
  for Permeability Prediction
arxiv_id: '2509.13841'
source_url: https://arxiv.org/abs/2509.13841
tags:
- pore
- network
- permeability
- hydraulic
- neural
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a hybrid model that integrates graph neural
  networks (GNNs) with pore network models (PNMs) for predicting permeability in porous
  media. The key innovation is replacing simplified analytical formulas for pore-scale
  hydraulic conductance with data-driven GNN predictions, trained indirectly from
  bulk permeability measurements using an end-to-end differentiable framework.
---

# An End-to-End Differentiable, Graph Neural Network-Embedded Pore Network Model for Permeability Prediction

## Quick Facts
- **arXiv ID:** 2509.13841
- **Source URL:** https://arxiv.org/abs/2509.13841
- **Reference count:** 5
- **Primary result:** Hybrid GNN-PNM model achieves RMSE < 0.05 on 128³ voxel images with superior generalization across synthetic and real sandstone datasets

## Executive Summary
This paper introduces a hybrid model that integrates graph neural networks (GNNs) with pore network models (PNMs) for predicting permeability in porous media. The key innovation is replacing simplified analytical formulas for pore-scale hydraulic conductance with data-driven GNN predictions, trained indirectly from bulk permeability measurements using an end-to-end differentiable framework. This approach overcomes the accuracy limitations of traditional PNMs while maintaining physical interpretability and efficiency.

The GNN learns conductance values from pore and throat geometry, which are then passed to the PNM solver for permeability computation. Results show the model significantly outperforms both pure data-driven GNNs and traditional PNMs across synthetic and real sandstone datasets, achieving lower prediction errors and better generalization across different scales. Gradient-based sensitivity analysis confirms physically consistent feature influences, enhancing interpretability.

## Method Summary
The proposed method integrates graph neural networks (GNNs) with pore network models (PNMs) to predict permeability in porous media. Traditional PNMs use simplified analytical formulas to estimate pore-scale hydraulic conductance, which introduces significant accuracy limitations. The hybrid approach replaces these analytical formulas with data-driven GNN predictions that learn conductance values from pore and throat geometry. The GNN is trained end-to-end using bulk permeability measurements, allowing indirect learning of pore-scale properties. The learned conductance values are then used by the PNM solver to compute permeability, combining the interpretability of physics-based models with the flexibility of machine learning.

## Key Results
- Hybrid GNN-PNM model achieves RMSE < 0.05 on 128³ voxel images
- Significantly outperforms both pure data-driven GNNs and traditional PNMs across synthetic and real sandstone datasets
- Better generalization across different scales compared to baseline methods
- Gradient-based sensitivity analysis confirms physically consistent feature influences

## Why This Works (Mechanism)
The hybrid approach works because it combines the physical interpretability and efficiency of pore network models with the flexibility and accuracy of data-driven GNNs. By replacing simplified analytical formulas with learned conductance values, the model captures complex pore-scale physics that analytical models miss. The end-to-end differentiable training allows the GNN to learn optimal conductance predictions from bulk permeability measurements, eliminating the need for computationally expensive pore-level simulations while maintaining accuracy.

## Foundational Learning

**Graph Neural Networks:** Why needed - to learn complex relationships between pore geometry and hydraulic conductance; Quick check - verify node/edge feature propagation and aggregation works correctly

**Pore Network Models:** Why needed - provides physical interpretability and efficient permeability computation framework; Quick check - ensure network connectivity and flow equations are correctly implemented

**End-to-End Differentiability:** Why needed - enables indirect learning from bulk measurements without explicit pore-scale labels; Quick check - verify gradient flow through entire pipeline

**Hydraulic Conductance:** Why needed - fundamental property linking pore geometry to flow resistance; Quick check - validate learned conductances produce reasonable pressure drops

**Permeability Computation:** Why needed - ultimate target metric for porous media characterization; Quick check - verify computed permeabilities match known benchmarks

## Architecture Onboarding

**Component Map:** Input Voxel Images -> Geometry Extraction -> GNN Conductance Prediction -> PNM Solver -> Permeability Output

**Critical Path:** Voxel image → throat/pore geometry extraction → GNN conductance prediction → PNM pressure/flow solution → permeability calculation

**Design Tradeoffs:** Analytical vs. learned conductance formulas (accuracy vs. interpretability), end-to-end vs. modular training (flexibility vs. stability), GNN complexity vs. computational efficiency

**Failure Signatures:** Unphysical conductance values leading to negative pressures, poor generalization to new material types, gradient vanishing in end-to-end training, overfitting to training geometry distributions

**First Experiments:**
1. Validate GNN conductance predictions against direct pore-scale simulations on simple geometries
2. Test PNM solver accuracy with ground-truth conductance values
3. Verify end-to-end training converges and improves over modular training

## Open Questions the Paper Calls Out

None

## Limitations

- Relies on relatively small sample sizes (16 synthetic, 12 real sandstone samples) limiting robustness assessment
- Performance evaluation focuses primarily on permeability prediction accuracy without extensive validation of flow field predictions
- Method's scalability to highly heterogeneous or anisotropic media remains underexplored
- End-to-end differentiability claim lacks thorough benchmarking against alternative training strategies

## Confidence

**High:** GNN-PNM hybrid approach is technically sound and addresses known limitations of both pure ML and pure physics-based methods

**Medium:** Claims about accuracy improvement and generalization are supported but limited by sample size and material diversity

**Low:** Claims about interpretability and scalability to complex media require further validation

## Next Checks

1. Test on larger, more diverse datasets including carbonates and shales to assess generalization
2. Validate flow field predictions against pore-scale simulations under varying boundary conditions
3. Benchmark end-to-end differentiability against modular training approaches across varying material heterogeneities