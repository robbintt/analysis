---
ver: rpa2
title: An Odd Estimator for Shapley Values
arxiv_id: '2602.01399'
source_url: https://arxiv.org/abs/2602.01399
tags:
- shapley
- runtime
- median
- value
- values
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: OddSHAP is a novel estimator for Shapley values that leverages
  the insight that Shapley values depend exclusively on the odd component of the value
  function. By decomposing the function into odd and even parts and using paired sampling
  to isolate the odd component, OddSHAP performs polynomial regression solely on the
  odd subspace using a Fourier basis.
---

# An Odd Estimator for Shapley Values

## Quick Facts
- arXiv ID: 2602.01399
- Source URL: https://arxiv.org/abs/2602.01399
- Reference count: 40
- Primary result: OddSHAP achieves state-of-the-art estimation accuracy for Shapley values by leveraging odd-only function decomposition and paired sampling.

## Executive Summary
OddSHAP is a novel estimator for Shapley values that exploits the insight that Shapley values depend exclusively on the odd component of the value function, not the even component. By decomposing the function into odd and even parts and using paired sampling to isolate the odd component, OddSHAP performs polynomial regression solely on the odd subspace using a Fourier basis. This approach allows it to capture higher-order interactions while avoiding the computational complexity of full polynomial regression. The method identifies high-impact interactions via a proxy model and achieves state-of-the-art estimation accuracy across various benchmarks, outperforming existing methods like RegressionMSR and PolySHAP.

## Method Summary
OddSHAP estimates Shapley values through a five-step process: (1) paired sampling of coalitions S and S^c with uniform weights by size, (2) fitting a LightGBM proxy model to approximate the value function, (3) extracting top odd Fourier interactions using ProxySPEX, (4) constrained weighted least squares regression in Fourier basis on selected terms with boundary constraints, and (5) computing Shapley values from the regression coefficients. The method uses η=10 as default parameter for interaction selection and falls back to TreeSHAP when budget is insufficient (m < d·η).

## Key Results
- Achieves state-of-the-art estimation accuracy across multiple benchmarks including DistilBERT, Estate, ViT16, Cancer, CG60, IL60, NHANES, and Crime datasets
- Outperforms existing methods like RegressionMSR and PolySHAP by focusing regression on odd-only Fourier components
- Reduces computational complexity from O(d^k) to O(d^k/2) while maintaining estimation consistency
- Identifies high-impact interactions through proxy model analysis and sparse selection of odd Fourier terms

## Why This Works (Mechanism)

### Mechanism 1
Shapley values depend exclusively on the odd component of the value function, not the even component. Every value function f decomposes uniquely into odd and even parts: f = f_odd + f_even. The Shapley value operator is linear, and the even component's Shapley value is identically zero (proved via complement symmetry of coalition weights). Thus φᵢ(f) = φᵢ(f_odd) for all i. This holds when the value function can be evaluated on complementary coalitions.

### Mechanism 2
Paired sampling orthogonalizes the weighted least squares objective, decoupling odd and even subspace estimation. When samples include both S and S^c with equal weights, the squared error over each pair separates: (f(S)-g(S))² + (f(S^c)-g(S^c))² = 2(f_odd(S)-g_odd(S))² + 2(f_even(S)-g_even(S))². The regression objective becomes sum of independent odd and even terms. This orthogonalization occurs when the function class is closed under even-odd decomposition (satisfied by Fourier basis).

### Mechanism 3
Restricting polynomial regression to odd-order Fourier basis terms preserves consistency while reducing basis size from O(d^k) to O(d^k/2). Fourier basis functions χ_T(S) = (-1)^|S∩T| are purely odd when |T| is odd, purely even when |T| is even. By fitting only odd-order terms (plus empty set for boundary constraints), the regression captures all Shapley-relevant signal. A gradient-boosted tree proxy identifies high-magnitude odd coefficients for sparse selection, exploiting empirical sparsity in Fourier representation.

## Foundational Learning

- Concept: **Shapley Value Definition**
  - Why needed here: OddSHAP's core insight (odd-only dependence) requires understanding how Shapley values aggregate marginal contributions across coalition sizes.
  - Quick check question: Can you explain why φᵢ(f) = Σ_S p_{|S|}[f(S∪{i}) - f(S)] where p_ℓ = 1/(d·C(d-1,ℓ))?

- Concept: **Weighted Least Squares with KernelSHAP Weighting**
  - Why needed here: OddSHAP inherits the constrained weighted regression framework; understanding w_ℓ = 1/(ℓ(d-ℓ)·C(d,ℓ)) explains why paired sampling preserves the projection property.
  - Quick check question: Why must boundary constraints f(∅) and f([d]) be enforced exactly for efficiency?

- Concept: **Fourier Basis on the Hypercube**
  - Why needed here: OddSHAP reformulates regression in Fourier basis to isolate odd/even subspaces; unanimity basis does not have this property.
  - Quick check question: Verify that χ_T(S) = (-1)^|S∩T| is odd when |T| is odd by checking χ_T(S^c) = -χ_T(S).

## Architecture Onboarding

- Component map: Paired Sampler -> GBT Proxy -> Interaction Extractor -> Constrained Fourier Regression -> Shapley Computation
- Critical path: Paired sampling → GBT fit → Fourier extraction → constrained regression → Shapley extraction. The proxy quality directly determines which interactions are included; poor proxy = missing important terms.
- Design tradeoffs:
  - η (regression variable factor): Lower η = more interactions = higher expressivity but overfitting risk; paper uses η=10
  - Fallback threshold: When m < d·η, skip regression and return TreeSHAP on proxy (regularization saves you)
  - Maximum tree depth L: Controls extraction cost O(N_trees · 2^L · L); paper uses L=10
- Failure signatures:
  - MSE increases with more interactions (Figure 4 right side): overfitting due to insufficient budget for selected terms
  - Performance degrades at low budget m < d·η: falling back to proxy, subject to misspecification bias
  - Runtime dominated by regression at high m: complexity O((d + m/η)² · m) becomes bottleneck
- First 3 experiments:
  1. Budget calibration: Run OddSHAP with η ∈ {2, 5, 10, 50} on a held-out validation set; plot MSE vs. m to find where interaction addition transitions from helpful to harmful
  2. Ablation on paired sampling: Compare OddSHAP with paired vs. unpaired sampling on synthetic functions with known odd/even structure; quantify variance reduction
  3. Proxy quality impact: Replace LightGBM with different proxy classes (linear, shallow trees); measure correlation between proxy-detected interactions and ground-truth odd interactions

## Open Questions the Paper Calls Out
None

## Limitations
- Odd/even decomposition requires evaluating f on both S and S^c, which may not be feasible for functions with constrained or expensive access patterns
- Empirical superiority depends on having sufficient budget (m ≥ d·η) to extract meaningful interactions
- RegressionMSR performs better on NHANES and Crime datasets, and PolySHAP excels when m < d

## Confidence
- High confidence: The odd/even decomposition mechanism and paired sampling orthogonality are rigorously proved with explicit theorems
- Medium confidence: The sparse Fourier assumption for interaction selection is empirically supported but not theoretically guaranteed for all value functions
- Medium confidence: The proxy extraction procedure, while referencing ProxySPEX, lacks explicit implementation details

## Next Checks
1. Test OddSHAP on value functions where even-order interactions are intentionally correlated with odd-order effects to quantify information loss from discarding even components
2. Evaluate performance sensitivity to η parameter by systematically varying it across benchmarks and identifying the optimal tradeoff point between expressivity and overfitting
3. Implement and compare against the full Fourier basis (including even terms) to measure the practical impact of odd-only restriction on estimation accuracy