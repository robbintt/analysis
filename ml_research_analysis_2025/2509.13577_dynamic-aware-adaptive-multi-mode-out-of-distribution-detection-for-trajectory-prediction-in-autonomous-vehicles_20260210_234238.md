---
ver: rpa2
title: 'Dynamic Aware: Adaptive Multi-Mode Out-of-Distribution Detection for Trajectory
  Prediction in Autonomous Vehicles'
arxiv_id: '2509.13577'
source_url: https://arxiv.org/abs/2509.13577
tags:
- detection
- prediction
- mode
- trajectory
- error
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of out-of-distribution (OOD) detection
  for trajectory prediction in autonomous vehicles, focusing on detecting deceptive
  OOD scenarios where prediction errors gradually escalate into hazardous situations.
  The authors observe that prediction errors exhibit mode-dependent distributions
  (high/low error modes) that evolve over time with dataset-specific dynamics.
---

# Dynamic Aware: Adaptive Multi-Mode Out-of-Distribution Detection for Trajectory Prediction in Autonomous Vehicles

## Quick Facts
- **arXiv ID:** 2509.13577
- **Source URL:** https://arxiv.org/abs/2509.13577
- **Reference count:** 40
- **Key outcome:** Up to 7.2% AUROC improvement and 150%+ AUPR gains over prior methods for OOD detection in trajectory prediction

## Executive Summary
This paper addresses out-of-distribution (OOD) detection for trajectory prediction in autonomous vehicles, focusing on "deceptive OOD" scenarios where prediction errors gradually escalate into hazardous situations. The authors observe that prediction errors on in-distribution samples exhibit mode-dependent distributions (high/low error modes) that evolve over time with dataset-specific dynamics. Building on quickest change detection (QCD) formulation, they propose Mode-Aware CUSUM, an adaptive multi-threshold change-point detection algorithm that explicitly models error mode dynamics. Comprehensive experiments on established benchmarks demonstrate that Mode-Aware CUSUM consistently outperforms prior uncertainty quantification and vision-based OOD approaches while providing faster detection with fewer false alarms.

## Method Summary
The paper formulates OOD detection as a quickest change detection problem where error distributions shift from pre-change (in-distribution) to post-change (OOD) states. Mode-Aware CUSUM uses a Gaussian mixture model (GMM) to characterize mode-dependent error distributions, then applies CUSUM with adaptive, mode-specific thresholds that update via exponential smoothing. The method computes log-likelihood ratios using mode-specific pre-change distributions and incorporates uncertainty penalties to prevent spurious detections. Thresholds adapt to changing error modes through a step-down policy that balances detection speed against false alarm rates.

## Key Results
- Achieves up to 7.2% AUROC improvement over Global CUSUM baseline
- Demonstrates 150%+ AUPR gains on highly imbalanced datasets
- Reduces detection delay by 34.4-37.9% across various dynamics
- Outperforms uncertainty quantification and vision-based OOD methods on GRIP++ and FQA models

## Why This Works (Mechanism)

### Mechanism 1: Mode-Dependent Error Distribution Characterization
Prediction errors on in-distribution samples follow bi-modal Gaussian mixture distributions with distinct low-risk and high-risk components that evolve temporally. The algorithm decomposes the overall error distribution into mode-specific components, enabling mode-specific likelihood calculations.

### Mechanism 2: Adaptive Multi-Threshold CUSUM with Step-Down Policy
Mode-specific thresholds with adaptive step-down updates reduce false alarms while accelerating detection compared to global thresholding. Each mode maintains independent thresholds that update based on estimated variance and false alarm/miss rate constraints.

### Mechanism 3: Sequential Log-Likelihood Ratio with Uncertainty Penalty
Incorporating mode-dependent drift terms into CUSUM updates improves robustness to error variance fluctuations. The uncertainty penalty prevents spurious detections by making it harder for the CUSUM statistic to accumulate evidence when variance is high.

## Foundational Learning

- **Quickest Change Detection (QCD) and CUSUM optimality**
  - Why needed: The paper builds on Lorden's minimax criterion (WADD vs MTFA trade-off). Without this foundation, threshold design rationale is opaque.
  - Quick check question: Can you explain why CUSUM is first-order asymptotically optimal for minimizing worst-case average detection delay subject to false alarm constraints?

- **Gaussian Mixture Models and responsibility assignment**
  - Why needed: Mode estimation uses MAP over GMM components. Understanding posterior responsibility P(Mₜ=m|εₜ) is essential for implementing and debugging the mode estimator.
  - Quick check question: Given π₀=0.6, π₁=0.4 and component densities f₀, f₁, how do you compute the MAP mode estimate for observed error εₜ?

- **Sequential Probability Ratio Test (SPRT) threshold derivation**
  - Why needed: The logarithmic threshold form ln((1-β)/α) comes from Neyman-Pearson hypothesis testing. Understanding this clarifies how α_m and β_m control detector behavior.
  - Quick check question: Why does increasing β_m (tolerance for missed detections) lower the threshold, making detection more aggressive?

## Architecture Onboarding

- **Component map:**
  Training Phase: [Historical Errors] → [GMM Fitting] → {(π₀,π₁), (f₀,f₁), (σ₀,σ₁)}
  Deployment Loop: [Trajectory Predictor Output] → [Error Computer] → εₜ → [Mode Estimator (MAP)] → M̂ₜ → [Log-Likelihood Ratio] → ℓₜ → [Threshold Adapter] → θₜ^(M̂ₜ) → [CUSUM Updater] → Wₜ^(M̂ₜ) → [Detector]

- **Critical path:** The mode estimator accuracy dominates downstream performance. If M̂ₜ is wrong, the wrong pre-change distribution f_m is used for likelihood calculation, corrupting both the CUSUM update and threshold selection.

- **Design tradeoffs:**
  - **r₀ vs r₁:** Paper recommends r₀ > r₁ to make low-error mode thresholds more conservative (absorb frequent mode switches). Trade-off: too conservative → delayed detection in low-error regimes.
  - **λ (smoothing factor):** Higher λ → faster threshold adaptation but noisier; lower λ → stable but slower response to mode transitions. Paper does not specify optimal range.
  - **Sliding window S:** Longer S → better variance estimates but lagged adaptation. Must be tuned to expected mode switching frequency.

- **Failure signatures:**
  - High false alarm rate with stable trajectories → r₀ too small, λ too high, or S too short (underestimating variance)
  - Delayed detection on genuine OOD → thresholds too conservative (r_m too large), or g misspecified
  - Erratic mode switching in estimates → π₀, π₁ poorly calibrated, or mode overlap too high
  - No detections ever → k_m too large (over-penalizing), or thresholds θ₀, θ₁ initialized too high

- **First 3 experiments:**
  1. Replicate Figure 2 on your target dataset: Collect prediction errors on training split, fit 2-component GMM, verify bimodality exists.
  2. Baseline comparison with fixed thresholds: Run Global CUSUM vs Mode-Aware CUSUM with paper's suggested settings. Measure AUROC, AUPR, and false alarm rate.
  3. Sensitivity ablation: Vary r₀/r₁ ratio and λ to map the delay-vs-false-alarm trade-off surface.

## Open Questions the Paper Calls Out

- **Can Mode-Aware CUSUM be extended to settings where the post-change distribution g is unknown or only partially specified?**
  - Basis: "We acknowledge that, in many real-world settings, full information on g may not be available, and we plan to explore this more general setting in future work."
  - Why unresolved: Current method requires full specification of both pre-change and post-change distributions. Real-world OOD scenarios involve unpredictable distribution shifts where the post-change distribution cannot be known a priori.

- **How can error modes be learned online during deployment rather than pre-specified from training data?**
  - Basis: "Future work will explore online learning of error modes and extend the framework to a wider range of anomalous driving behaviors."
  - Why unresolved: Current mode parameters derive from offline training data, but real-world conditions evolve. Static mode definitions may become outdated as driving patterns change over extended deployment periods.

- **Does the mode-dependent error behavior generalize beyond the two-mode assumption to encompass richer sets of modes across diverse models?**
  - Basis: "We conjecture that this mode-dependent behavior... may generalize to a broader spectrum of ML models and trajectory prediction datasets."
  - Why unresolved: Only two modes (high/low error) were validated on GRIP++ and FQA across three datasets. Whether additional modes naturally emerge or whether this holds for Transformer-based or ST-GNN architectures remains untested.

## Limitations
- Post-change distribution g is unspecified, relying on domain expertise and incident logs that are not publicly available
- Critical hyperparameters (r₀, r₁, λ, b₀, b₁, sliding window S, SPRT parameters) are not reported
- No ablation study validates the necessity of the 2-component GMM assumption
- The paper focuses on gradual, mode-dependent drift but does not address abrupt distribution shifts

## Confidence
- **High confidence:** AUROC/AUPR improvements over Global CUSUM (7.2% AUROC gain is well-defined and verifiable)
- **Medium confidence:** The theoretical optimality claims for the multi-threshold CUSUM extension, as no corpus replication of this specific variant exists
- **Medium confidence:** Mode-dependent drift and threshold adaptation reduce false alarms, but this depends heavily on unreported hyperparameters and the validity of the GMM assumption

## Next Checks
1. **GMM assumption validation:** Fit a 2-component GMM on your dataset's training errors. If the low/high-risk components have significant overlap (e.g., Bhattacharyya distance < 1.0), mode-dependent gains are unlikely.
2. **Hyperparameter sensitivity sweep:** Run Mode-Aware CUSUM with varying r₀/r₁ ratios ([2.0, 1.0], [1.5, 1.0], [3.0, 1.0]) and λ values (0.1, 0.3, 0.5) to identify the false-alarm-vs-delay trade-off surface.
3. **Post-change distribution sanity check:** Implement a simple parametric g (e.g., shifted Gaussian) and verify that detection delays scale predictably with the shift magnitude; if not, the likelihood ratio may be misspecified.