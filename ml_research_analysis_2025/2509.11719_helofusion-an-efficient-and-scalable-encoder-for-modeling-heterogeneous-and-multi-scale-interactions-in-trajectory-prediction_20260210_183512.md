---
ver: rpa2
title: 'HeLoFusion: An Efficient and Scalable Encoder for Modeling Heterogeneous and
  Multi-Scale Interactions in Trajectory Prediction'
arxiv_id: '2509.11719'
source_url: https://arxiv.org/abs/2509.11719
tags:
- agent
- motion
- helofusion
- interactions
- prediction
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces HeLoFusion, a novel encoder for trajectory
  prediction in autonomous driving that addresses the challenges of modeling multi-scale
  interactions and heterogeneous agent behaviors. The key innovation is constructing
  local, multi-scale graphs centered on each agent to capture both pairwise and group-wise
  interactions while employing category-specific feature networks and an aggregation-decomposition
  message-passing scheme to handle agent heterogeneity efficiently.
---

# HeLoFusion: An Efficient and Scalable Encoder for Modeling Heterogeneous and Multi-Scale Interactions in Trajectory Prediction

## Quick Facts
- arXiv ID: 2509.11719
- Source URL: https://arxiv.org/abs/2509.11719
- Authors: Bingqing Wei; Lianmin Chen; Zhongyu Xia; Yongtao Wang
- Reference count: 7
- Primary result: Achieves state-of-the-art trajectory prediction on Waymo Open Motion Dataset with Soft mAP of 47.32% and minADE of 0.5690

## Executive Summary
HeLoFusion introduces a novel encoder architecture for multi-agent trajectory prediction that addresses the challenges of modeling heterogeneous and multi-scale interactions in autonomous driving scenarios. The key innovation lies in constructing local, multi-scale graphs centered on each agent to capture both pairwise and group-wise interactions while employing category-specific feature networks and an aggregation-decomposition message-passing scheme to handle agent heterogeneity efficiently. This locality-grounded approach enables principled representation of social context without the computational burden of global methods.

The method is evaluated on the Waymo Open Motion Dataset and demonstrates significant improvements over existing approaches, achieving state-of-the-art performance with Soft mAP of 47.32%, mAP of 46.24%, and lowest displacement errors (minADE of 0.5690, minFDE of 1.16). The results validate that modeling localized, heterogeneous interactions is highly effective for improving motion forecasting accuracy in autonomous driving systems while maintaining computational scalability.

## Method Summary
HeLoFusion is built on the BeTopNet framework, replacing its encoder while keeping the decoder unchanged. The architecture consists of three main components: a PointNet-style motion encoder that processes historical trajectories and map polylines into compact feature vectors with type embeddings, a multi-scale interaction module that constructs local k-NN graphs (K=10 neighbors) and hypergraphs (hyperedge sizes 5 and 7) with aggregation-decomposition message passing, and a context fusion module that applies category-specific MLPs followed by local attention over agents and map elements. The model is trained end-to-end for 30 epochs on 8× RTX 3090 GPUs using AdamW optimizer with specific learning rate scheduling and gradient clipping.

## Key Results
- Achieves state-of-the-art Soft mAP of 47.32% and mAP of 46.24% on Waymo Open Motion Dataset
- Lowest displacement errors with minADE of 0.5690 and minFDE of 1.16
- Demonstrates superior scalability with linear memory growth compared to exponential growth in global methods
- Shows consistent performance across diverse agent categories (vehicles, pedestrians, cyclists)

## Why This Works (Mechanism)

### Mechanism 1: Spatial Locality via Multi-Scale Local Graphs
- Claim: Local graphs centered on each agent capture critical interactions more effectively than global approaches while reducing computational burden
- Core assumption: An agent's behavior is primarily influenced by its immediate surroundings
- Evidence anchors: [abstract] "constructs local, multi-scale graphs centered on each agent to capture both pairwise and group-wise interactions"
- Break condition: In sparse traffic scenarios where agents are widely dispersed

### Mechanism 2: Aggregation-Decomposition Message Passing for Heterogeneity
- Claim: Handling agent type heterogeneity without combinatorial parameter explosion improves interaction modeling across diverse agent categories
- Core assumption: Interaction dynamics are modulated by agent type but share enough structure to benefit from a shared decomposition network
- Evidence anchors: [abstract] "aggregation-decomposition message-passing scheme and type-specific feature networks"
- Break condition: When agent types have fundamentally incompatible dynamics

### Mechanism 3: Category-Specific Feature Projection Before Context Fusion
- Claim: Routing agent embeddings through type-specific MLPs before attention ensures specialized motion pattern representations
- Core assumption: Different agent categories have distinct motion constraints and patterns that benefit from separate projection pathways
- Evidence anchors: [Section 3.2] "agent features are processed through a bank of category-specific MLPs"
- Break condition: With insufficient training examples for a rare agent category

## Foundational Learning

- **Graph Neural Networks and Message Passing**
  - Why needed here: HeLoFusion's core interaction modeling relies on message passing over local graphs
  - Quick check question: Can you explain how a node's representation is updated based on its neighbors' features in a standard GNN layer?

- **Hypergraphs for Group Interactions**
  - Why needed here: Unlike pairwise edges, hyperedges connect multiple nodes simultaneously, enabling group-level interaction modeling
  - Quick check question: How does a hyperedge differ from a standard graph edge, and what type of relationship would each better represent?

- **k-Nearest Neighbors in Spatial Context**
  - Why needed here: Local graph construction uses k-NN to define neighborhoods
  - Quick check question: What tradeoffs exist between small K (e.g., 5) and large K (e.g., 20) when modeling traffic interactions?

## Architecture Onboarding

- **Component map**: Historical trajectory → Motion Encoder → Interaction Module (hypergraphs of sizes 5, 7) → Category MLP → Local Attention → Decoder
- **Critical path**: Historical trajectory → Motion Encoder → Interaction Module (hypergraphs of sizes 5, 7) → Category MLP → Local Attention → Decoder
- **Design tradeoffs**: K=10 neighbors balances coverage vs. noise; two hypergraphs capture different group scales; three category-specific MLPs cover WOMD types
- **Failure signatures**: Predictions ignoring obvious collision courses → check if local graph construction is missing relevant neighbors
- **First 3 experiments**:
  1. Replace HeLoFusion encoder with global attention encoder while keeping decoder identical
  2. Run with only pairwise graphs (no hypergraphs), then add hypergraphs one at a time
  3. Train with homogeneous MLPs (single shared projection) vs. category-specific MLPs

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How effectively does HeLoFusion generalize to driving datasets with distinct cultural traffic patterns or environmental conditions?
- Basis in paper: [explicit] The authors explicitly state in the Limitations section that the model has only been validated on the Waymo Open Motion Dataset
- Why unresolved: The model's type-specific networks and interaction graphs may be overfitting to the agent behaviors and road structures specific to the Waymo data distribution
- What evidence would resolve it: Benchmark results on geographically diverse datasets (e.g., Argoverse, nuScenes, or inDrive)

### Open Question 2
- Question: Can the proposed method maintain reliability when encountering rare, out-of-distribution (OOD) traffic events?
- Basis in paper: [explicit] The Limitations section notes that, similar to other data-driven methods, "its performance on rare, out-of-distribution events is not guaranteed"
- Why unresolved: The aggregation-decomposition message passing relies on learned interaction patterns which may fail when facing novel agent behaviors
- What evidence would resolve it: Evaluation results on specific OOD test subsets or adversarial scenarios

### Open Question 3
- Question: To what extent does the performance of HeLoFusion depend on the specific selection of hyperparameters for local graph construction?
- Basis in paper: [inferred] The implementation details fix the nearest neighbor count (K=10) and hyperedge sizes (S ∈ {5, 7}) without providing an ablation study
- Why unresolved: It is unclear if these scales are optimal for all traffic densities or if they represent a brittle design choice
- What evidence would resolve it: An ablation study varying K and hyperedge sizes to analyze sensitivity of minADE and mAP metrics

## Limitations
- Evaluation limited to Waymo Open Motion Dataset, performance on other driving environments unknown
- Hypergraph scales (5 and 7) chosen without systematic hyperparameter search, potentially suboptimal
- Computational complexity analysis limited to GPU memory usage, lacking real-time inference latency profiling

## Confidence
- **High Confidence**: Local graph construction (K=10 neighbors) and category-specific feature projections have strong empirical support through ablation studies
- **Medium Confidence**: Aggregation-decomposition message passing effectiveness relies on theoretical assumptions about shared decomposition capabilities
- **Low Confidence**: Optimal hypergraph scales (sizes 5 and 7) and neighborhood attention radius (16) presented without systematic hyperparameter search

## Next Checks
1. **Scalability Analysis**: Test HeLoFusion on synthetic dataset with increasing agent density to validate claimed linear scaling behavior and identify performance degradation thresholds

2. **Heterogeneity Stress Test**: Create controlled experiment with agent pairs having fundamentally different dynamics (e.g., emergency vehicles vs. pedestrians) to assess aggregation-decomposition scheme effectiveness

3. **Cross-Domain Generalization**: Evaluate HeLoFusion on non-WOMD dataset (e.g., nuScenes or Argoverse) to verify encoder architecture generalizes beyond Waymo's urban driving data patterns