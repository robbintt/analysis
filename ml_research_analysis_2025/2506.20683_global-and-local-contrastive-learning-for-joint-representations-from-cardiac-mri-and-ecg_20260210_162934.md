---
ver: rpa2
title: Global and Local Contrastive Learning for Joint Representations from Cardiac
  MRI and ECG
arxiv_id: '2506.20683'
source_url: https://arxiv.org/abs/2506.20683
tags:
- contrastive
- local
- learning
- loss
- alignment
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces PTACL (Patient and Temporal Alignment Contrastive
  Learning), a multimodal contrastive learning framework that enhances ECG representations
  by integrating spatio-temporal information from CMR. The method uses both global
  patient-level contrastive loss and local temporal-level contrastive loss to align
  ECG and CMR embeddings.
---

# Global and Local Contrastive Learning for Joint Representations from Cardiac MRI and ECG

## Quick Facts
- arXiv ID: 2506.20683
- Source URL: https://arxiv.org/abs/2506.20683
- Reference count: 37
- Primary result: Joint ECG-CMR representations improve retrieval and regression tasks over single-modality baselines

## Executive Summary
This paper introduces PTACL (Patient and Temporal Alignment Contrastive Learning), a multimodal contrastive learning framework that enhances ECG representations by integrating spatio-temporal information from CMR. The method uses both global patient-level contrastive loss and local temporal-level contrastive loss to align ECG and CMR embeddings. The global loss aligns patient-level representations, while the local loss enforces fine-grained temporal alignment by contrasting ECG-derived segments with corresponding CMR frames. The approach enriches ECG representations with diagnostic information beyond electrical activity and transfers more insights between modalities than global alignment alone, all without introducing new learnable weights.

## Method Summary
PTACL employs a two-phase training strategy. First, each modality undergoes single-modality pre-training using Masked Autoencoders to learn modality-specific features. The ECG encoder uses 1D convolutions and a 6-layer transformer, while the CMR encoder uses 3D convolutions and a 4-layer transformer. Second, the encoders are jointly trained with multimodal contrastive loss combining global patient-level alignment (InfoNCE loss pulling same-patient embeddings together) and local temporal alignment (segment-level contrastive loss with soft Gaussian alignment matrix). The framework requires paired ECG-CMR data from the same patients and was evaluated on UK Biobank data using two downstream tasks: patient retrieval by cardiac phenotype and regression of CMR-derived cardiac function parameters.

## Key Results
- PTACL outperforms global-only baseline in patient retrieval (precision@k, mean/median rank)
- Improved R² scores for predicting CMR-derived cardiac function parameters (ventricular volumes, ejection fraction)
- Single modality pre-training (SMP) contributes significantly to overall performance
- Local temporal alignment provides additional benefits beyond global patient alignment

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Global patient-level contrastive alignment enables cross-modal semantic correspondence between ECG and CMR embeddings.
- **Mechanism:** The InfoNCE loss pulls same-patient ECG-CMR embeddings together while pushing apart different-patient embeddings, creating a shared embedding space where proximity indicates semantic similarity rather than modality-specific features.
- **Core assumption:** Same-patient ECG-CMR pairs share diagnostic information that can be captured in a joint embedding space.
- **Evidence anchors:** [abstract] "The global loss aligns patient-level representations by pulling ECG and CMR embeddings from the same patient closer together, while pushing apart embeddings from different patients." [section 3.2] Equation 1 defines the symmetric InfoNCE loss with cosine similarity and temperature scaling. [corpus] Neighbor paper "ECGFlowCMR" also uses contrastive pretraining between ECG and CMR, supporting the general validity of this cross-modal alignment approach.
- **Break condition:** If ECG and CMR share insufficient diagnostic overlap (e.g., pathologies affecting only one modality), global alignment may learn spurious correlations.

### Mechanism 2
- **Claim:** Local temporal contrastive alignment captures fine-grained cardiac phase correspondences that global alignment alone misses.
- **Mechanism:** ECG segments between R-peaks are aligned with corresponding CMR frames at the same cardiac phase using a soft Gaussian alignment matrix P_k,t. This enforces token-level correspondences (e.g., systole in ECG ↔ systole in CMR) rather than just patient-level similarity.
- **Core assumption:** Physiological temporal correspondence exists between ECG electrical signals and CMR mechanical motion, grounded in ECG-gated CMR acquisition.
- **Evidence anchors:** [abstract] "Local loss enforces fine-grained temporal alignment within each patient by contrasting encoded ECG segments with corresponding encoded CMR frames." [section 3.2] "CMR acquisition is guided by ECG gating... The detected R peaks are later used to align and reconstruct a single representative heartbeat cycle. This physiological alignment motivates our local contrastive loss formulation." [Figure 2] Visualizes improved temporal alignment with local loss vs. global-only baseline. [corpus] Weak direct corpus evidence for temporal alignment specifically; related papers focus on global cross-modal learning.
- **Break condition:** If R-peak detection is noisy or CMR gating is unreliable, temporal alignment may mismatch phases, degrading representation quality.

### Mechanism 3
- **Claim:** Single modality pre-training (SMP) with MAE provides modality-specific feature foundations that improve multimodal convergence.
- **Mechanism:** MAE pre-trains each encoder to reconstruct masked tokens, forcing the model to learn modality-specific spatio-temporal structures (ECG: lead relationships; CMR: cardiac motion patterns) before cross-modal alignment begins.
- **Core assumption:** Modality-specific features learned through reconstruction transfer to multimodal tasks.
- **Evidence anchors:** [section 3.1] "This step enables the encoders to capture modality-specific features before multimodal contrastive learning." [Table 2] "PTACL (w/o SMP)" shows degraded R² scores compared to full PTACL, demonstrating SMP's contribution. [corpus] "ECGFlowCMR" and other neighbor papers similarly use pre-training before multimodal learning, suggesting this is a broadly effective strategy.
- **Break condition:** If pre-training and downstream tasks have minimal feature overlap, SMP may not transfer or could induce negative transfer.

## Foundational Learning

- **Concept: InfoNCE / Contrastive Loss**
  - **Why needed here:** Core objective function for both global and local alignment. Understanding how positive/negative pairs are constructed and how temperature affects embedding distributions is essential.
  - **Quick check question:** Can you explain why increasing batch size typically improves contrastive learning performance?

- **Concept: Masked Autoencoder (MAE) Pre-training**
  - **Why needed here:** Used for single modality pre-training of both ECG and CMR encoders. Understanding masking strategies, encoder-decoder asymmetry, and reconstruction objectives is critical.
  - **Quick check question:** Why does MAE use a high mask ratio (75-90%) and a lightweight decoder?

- **Concept: ECG-Cardiac Phase Relationship**
  - **Why needed here:** The local loss relies on understanding that R-peaks define cardiac cycles and that CMR frames are temporally aligned to these phases via ECG gating.
  - **Quick check question:** What physiological event does the R-peak correspond to, and why does this matter for CMR frame alignment?

## Architecture Onboarding

- **Component map:** ECG Encoder: 1D conv (kernel p_t) → tokens → 6-layer transformer (19M params) → global pooling OR segment-level tokens → Projection head → Embeddings. CMR Encoder: 3D conv (kernel [t, p, p]) → spatio-temporal tokens → 4-layer transformer (13M params) → global pooling OR frame-level tokens → Projection head → Embeddings. Loss computation: Global InfoNCE (patient-level) + Local InfoNCE (temporal segment-level with alignment matrix P_k,t).

- **Critical path:** 1. Single modality MAE pre-training (separate for ECG and CMR). 2. Freeze first 2 transformer layers, train remaining with multimodal contrastive loss. 3. ECG encoder only used for downstream tasks (patient retrieval, phenotype regression).

- **Design tradeoffs:** σ = 0 (hard alignment) vs. σ > 0 (soft Gaussian): Hard alignment enforces strict matching but may be brittle to noise; soft alignment tolerates temporal jitter. Paper uses σ = 0.1 for regression, σ = 0.0 for retrieval. T = 13 segments: Balances temporal granularity vs. computational cost. Single middle short-axis slice vs. multi-slice CMR: Reduces data requirements but may miss spatial context.

- **Failure signatures:** Global-only baseline outperforms PTACL → Local loss may be misaligned (check R-peak detection, σ setting). Poor regression on specific phenotypes → ECG may lack information for that parameter (e.g., RV volumes vs. LV). Training instability → Check temperature settings (global: 0.1, local: 1.0) and β weighting.

- **First 3 experiments:** 1. Ablation: SMP contribution: Compare PTACL (w/ SMP) vs. PTACL (w/o SMP) on regression R² to validate pre-training necessity. 2. Hyperparameter sweep on σ: Test σ ∈ {0.0, 0.05, 0.1, 0.2} to find optimal soft vs. hard alignment for your dataset. 3. Baseline comparison: Replicate Global-only vs. Global+Local on a held-out validation set to confirm Table 1 retrieval improvements before full deployment.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can PTACL be effectively extended to tri-modal learning frameworks or other modalities like ultrasound?
- Basis in paper: [explicit] The Conclusion explicitly lists extending PTACL to "additional modalities, such as ultrasound" and exploring "tri-modal learning" as future work.
- Why unresolved: The current framework is specialized for the spatio-temporal alignment between ECG and CMR; it is unclear if the local alignment mechanism generalizes to modalities with different temporal resolutions or signal characteristics.
- What evidence would resolve it: Implementation of PTACL using ECG, CMR, and ultrasound data, demonstrating improved performance over bi-modal baselines.

### Open Question 2
- Question: Can the requirement for strictly paired ECG-CMR training data be relaxed?
- Basis in paper: [explicit] The authors state that PTACL "depends on paired ECG-CMR data, which may limit its applicability," and suggest developing strategies to mitigate this reliance.
- Why unresolved: Current contrastive losses (global and local) require positive pairs from the same patient, which restricts training to specialized datasets like the UK Biobank.
- What evidence would resolve it: A modification of the framework that successfully trains on unpaired or asynchronously collected data while maintaining retrieval and regression performance.

### Open Question 3
- Question: Does incorporating full volumetric CMR data significantly improve ECG representations compared to the single-slice approach?
- Basis in paper: [inferred] The authors note their approach uses "only a single middle short-axis slice," suggesting a trade-off where they demonstrate minimal data sufficiency rather than exploring the upper bounds of information transfer.
- Why unresolved: While a single slice offers computational efficiency, it omits 3D spatial context (e.g., apical/basal slices) that might encode diagnostic information available to the ECG.
- What evidence would resolve it: An ablation study comparing model performance when trained on the full short-axis stack versus the single middle slice.

### Open Question 4
- Question: Is PTACL robust to severe cardiac arrhythmias where R-peak detection and temporal gating fail?
- Basis in paper: [inferred] The method relies on segmenting heartbeats between "consecutive R-peaks" and interpolating to a fixed length; this pipeline may be unstable for irregular heart rhythms, though the paper does not discuss arrhythmia-specific evaluation.
- Why unresolved: The UK Biobank population may skew towards healthier phenotypes, potentially masking failure cases in patients with highly irregular electrical activity.
- What evidence would resolve it: Evaluation of retrieval and regression tasks specifically on a subset of patients with atrial fibrillation or premature ventricular contractions.

## Limitations

- Training hyperparameters (batch size, learning rate, optimizer, epochs) are not specified for either training phase
- Requires UK Biobank access and significant preprocessing effort with unspecified R-peak detection algorithm
- Model architecture and training strategy are tailored to specific UK Biobank dataset characteristics
- Clinical utility of enhanced representations is not demonstrated, only technical metrics

## Confidence

- **High Confidence:** The contrastive learning framework design (global patient-level + local temporal alignment) is theoretically sound and the core mechanism of cross-modal alignment is well-established in related work. The ablation showing SMP contribution (Table 2) provides strong evidence for pre-training benefits.
- **Medium Confidence:** The specific hyperparameter choices (σ values, T=13 segments, β=1.0 loss weighting) are justified through ablation but may be dataset-specific. The performance improvements over baselines are demonstrated but depend on the particular UK Biobank data characteristics.
- **Low Confidence:** Claims about clinical relevance and potential applications beyond the evaluated regression and retrieval tasks. The paper does not address model robustness to different acquisition protocols or populations.

## Next Checks

1. **Ablation of Training Phases:** Systematically evaluate the contribution of each training phase (SMP only, multimodal only, full pipeline) on a held-out validation set to confirm that both pre-training and contrastive learning are necessary for optimal performance.

2. **Cross-Modality Transfer:** Test the model's ability to predict CMR phenotypes from ECG embeddings on a different dataset or acquisition protocol to assess generalizability beyond UK Biobank. Compare performance degradation to baseline models.

3. **Robustness to Temporal Misalignment:** Introduce controlled noise in the R-peak detection or CMR temporal ordering to quantify the model's sensitivity to temporal alignment errors. Evaluate whether the soft alignment (σ > 0) provides meaningful robustness compared to hard alignment (σ = 0).