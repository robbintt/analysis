---
ver: rpa2
title: A Data-Driven Approach to Enhancing Gravity Models for Trip Demand Prediction
arxiv_id: '2506.01964'
source_url: https://arxiv.org/abs/2506.01964
tags:
- gravity
- data
- trip
- learning
- machine
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study addresses the limitations of traditional gravity models
  for trip demand prediction by integrating machine learning techniques with diverse
  datasets including geographical, economic, social, and travel patterns from Tennessee
  and New York counties. The proposed data-driven approach captures complex, non-linear
  relationships between variables that the traditional gravity model cannot adequately
  represent.
---

# A Data-Driven Approach to Enhancing Gravity Models for Trip Demand Prediction

## Quick Facts
- arXiv ID: 2506.01964
- Source URL: https://arxiv.org/abs/2506.01964
- Authors: Kamal Acharya; Mehul Lad; Liang Sun; Houbing Song
- Reference count: 19
- Primary result: Enhanced gravity models with ML achieved up to 63.59% MAE reduction, 51.48% R² improvement, and 44.32% CPC increase

## Executive Summary
This study addresses the limitations of traditional gravity models for trip demand prediction by integrating machine learning techniques with diverse datasets including geographical, economic, social, and travel patterns from Tennessee and New York counties. The proposed data-driven approach captures complex, non-linear relationships between variables that the traditional gravity model cannot adequately represent. Using neural networks, random forests, and gradient boosting, the enhanced models achieved substantial improvements over traditional methods, with up to 63.59% reduction in Mean Absolute Error, 51.48% improvement in R-squared, and 44.32% increase in Common Part of Commuters. Neural networks demonstrated the most significant improvements, particularly in high-density urban areas, while random forests showed consistent performance across different contexts. The results demonstrate that integrating diverse datasets with advanced algorithms provides more reliable tools for transportation planning and decision-making.

## Method Summary
The study enhanced traditional gravity models by integrating machine learning techniques with diverse datasets from Tennessee and New York counties. The approach used SafeGraph mobility data (March 15 – April 15, 2021), OSRM for distances/travel times, and USDA Economic Research Service for economic/population/education data, creating 27 features across 8 categories. Three models were implemented: Random Forest with RandomizedSearchCV (20 iterations, 5-fold CV), Neural Network with 5 fully connected layers using ReLU activation, conditional batch norm, dropout, and Optuna tuning, and Gradient Boosting with RandomizedSearchCV (10 combos, 2-fold CV). Models were evaluated using R-squared, Mean Absolute Error, and Common Part of Commuters on test data.

## Key Results
- Up to 63.59% reduction in Mean Absolute Error compared to traditional gravity model
- 51.48% improvement in R-squared for trip demand prediction accuracy
- 44.32% increase in Common Part of Commuters metric
- Neural networks showed the most significant improvements, particularly in high-density urban areas

## Why This Works (Mechanism)
The data-driven approach captures complex, non-linear relationships between trip demand and multiple factors including geographical, economic, social, and travel patterns. Traditional gravity models rely on simplified assumptions about distance decay and socioeconomic factors, while machine learning models can learn intricate patterns from diverse data sources. The integration of SafeGraph mobility data with economic and demographic features allows models to account for real-world behavioral patterns and regional variations that traditional models cannot capture.

## Foundational Learning
- **SafeGraph mobility data**: Movement patterns between counties needed to understand actual travel behavior and validate model predictions
- **OSRM routing**: Provides realistic travel distances and times beyond straight-line distances, capturing actual transportation network constraints
- **USDA county-level features**: Economic, population, and education data serve as socioeconomic predictors that influence travel demand patterns
- **Machine learning hyperparameter tuning**: RandomizedSearchCV and Optuna optimization ensure models find optimal parameter configurations for each dataset
- **Evaluation metrics (R², MAE, CPC)**: Different metrics capture various aspects of model performance - R² measures explained variance, MAE measures prediction accuracy, CPC measures spatial accuracy of origin-destination pairs
- **Conditional batch normalization**: Stabilizes neural network training by normalizing inputs based on current conditions, improving convergence and performance

## Architecture Onboarding
**Component Map**: Data Preprocessing -> Model Training -> Hyperparameter Tuning -> Evaluation
**Critical Path**: Clean and merge SafeGraph, OSRM, and USDA data → Split into train/test sets → Train RF/NN/GB models → Tune hyperparameters → Evaluate with R², MAE, CPC
**Design Tradeoffs**: Neural networks offer highest accuracy but require extensive hyperparameter tuning and computational resources; Random Forests provide good generalization with simpler implementation; Gradient Boosting balances accuracy and interpretability
**Failure Signatures**: Poor performance on long trips in sparse regions indicates data sparsity issues; overfitting to high-density areas suggests need for regularization or more diverse training data
**First Experiments**: 1) Train baseline gravity model with only population and distance features; 2) Add OSRM travel time to baseline and measure improvement; 3) Train neural network with all 27 features and compare to traditional models

## Open Questions the Paper Calls Out
None

## Limitations
- Neural network architecture details remain underspecified, potentially affecting reproducibility of the 63.59% MAE reduction
- Geographic generalizability is uncertain since both states share similar urban-rural structures
- Single-month data window (March-April 2021) may not capture seasonal or pandemic-related anomalies

## Confidence
- High confidence in relative improvements (RF/NN/GB vs. traditional gravity model): The substantial R² and MAE gains are consistently reported across multiple metrics
- Medium confidence in absolute performance values: Implementation details for NN and hyperparameter tuning are incomplete
- Low confidence in geographic transferability: Limited to two similar states without cross-regional validation

## Next Checks
1. Test model trained on NY against TN test set (and vice versa) to assess geographic generalization beyond the observed states
2. Implement the exact NN architecture with specified hyperparameters and validate whether 63.59% MAE reduction is reproducible
3. Conduct temporal validation using pre-pandemic data to confirm robustness across different time periods