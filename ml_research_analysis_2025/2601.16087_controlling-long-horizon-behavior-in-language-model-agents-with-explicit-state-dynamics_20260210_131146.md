---
ver: rpa2
title: Controlling Long-Horizon Behavior in Language Model Agents with Explicit State
  Dynamics
arxiv_id: '2601.16087'
source_url: https://arxiv.org/abs/2601.16087
tags:
- affective
- state
- dynamics
- inertia
- recovery
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper investigates abrupt tone and persona shifts in LLM agents
  during extended interaction by introducing an external affective state governed
  by first- and second-order dynamics. The proposed method maintains a continuous
  Valence-Arousal-Dominance state updated via momentum-based rules and injects this
  state into generation through prompt conditioning without modifying model parameters.
---

# Controlling Long-Horizon Behavior in Language Model Agents with Explicit State Dynamics

## Quick Facts
- arXiv ID: 2601.16087
- Source URL: https://arxiv.org/abs/2601.16087
- Reference count: 31
- One-line primary result: Explicit state dynamics (first- and second-order) enable controlled recovery and hysteresis in LLM dialogue agents, reducing abrupt tone shifts.

## Executive Summary
This paper addresses abrupt persona and tone shifts in LLM agents during extended interactions by introducing an external affective state governed by first- and second-order dynamics. The proposed method maintains a continuous Valence-Arousal-Dominance (VAD) state updated via momentum-based rules and injects this state into generation through prompt conditioning without modifying model parameters. Using a fixed 25-turn dialogue protocol, the study compares stateless, first-order, and second-order dynamics. Results show that stateful persistence enables delayed responses and reliable recovery, while second-order dynamics introduce affective inertia and hysteresis that increase with momentum, revealing a trade-off between stability and responsiveness.

## Method Summary
The method uses Qwen2.5-7B-Instruct-bnb-4bit with VADER lexicon-based sentiment analysis to extract instantaneous VAD signals. Four conditions are tested: stateless, first-order (α=1), and second-order with μ=0.8 and μ=0.95. The VAD state is injected via structured natural-language prompts at each turn. First-order dynamics implement exponential smoothing (a_{t+1} = a_t + α(â_t - a_t)), while second-order dynamics introduce velocity tracking (u_{t+1} = μu_t + (1-μ)(â_t - a_t), a_{t+1} = a_t + u_{t+1}). Five trials per condition use unique seeds across a 25-turn adversarial/reconciliation protocol.

## Key Results
- Stateless agents show near-zero valence variance and no recovery structure; stateful conditions exhibit delayed descent and reliable recovery.
- Hysteresis increases monotonically with momentum coefficient μ, from 0 (stateless) to 4.36 (first-order) to 21.19 (high-inertia μ=0.95).
- High-inertia (μ=0.95) conditions suppress recovery within the dialogue horizon, demonstrating the stability-responsiveness trade-off.

## Why This Works (Mechanism)

### Mechanism 1: State Persistence Enables Delayed Response and Recovery
- Claim: Maintaining an explicit affective state across turns allows agents to exhibit temporally coherent trajectories and recover from perturbations.
- Mechanism: A first-order update rule (exponential smoothing) integrates instantaneous noisy affective signals over time, introducing state persistence without inertia.
- Core assumption: Affective signals contain sufficient signal despite noise; temporal coherence is a property of state integration, not extraction quality.
- Evidence anchors: [abstract] "Stateless agents fail to exhibit coherent trajectories or recovery, while state persistence enables delayed responses and reliable recovery." [Section 3.1] "In contrast, all stateful conditions exhibit a delayed descent in valence following the onset of adversarial interaction."
- Break condition: If the affect estimator produces systematically biased signals, state persistence may amplify errors rather than smooth them.

### Mechanism 2: Momentum-Based Dynamics Induce Hysteresis and Path Dependence
- Claim: Second-order dynamics with a momentum coefficient introduce affective inertia, producing path-dependent trajectories quantifiable as hysteresis.
- Mechanism: A velocity term tracks rate of change, and higher μ values increase resistance to directional change, creating lag between external forcing and state response.
- Core assumption: The discretized damped system analogy holds; momentum coefficients translate meaningfully to affective "inertia" in dialogue contexts.
- Evidence anchors: [abstract] "Second-order dynamics introduce affective inertia and hysteresis that increase with momentum... hysteresis values increasing monotonically from 0 to 4.36 (first-order) to 21.19 (high-inertia)." [Section 3.3] "Hysteresis increases monotonically with the momentum coefficient μ, demonstrating that affective inertia systematically increases path dependence."
- Break condition: When μ → 1, the system cannot recover within finite horizons—recovery was absent in all high-inertia trials.

### Mechanism 3: Prompt-Based State Injection Creates Closed-Loop Control
- Claim: Injecting the external affective state into generation via structured natural-language prompts modulates agent behavior without modifying model parameters.
- Mechanism: At each turn, current VAD values are encoded into a control prompt that conditions response generation, closing the loop: Dialogue → Estimator → State Update → Prompt → Generation → Response.
- Core assumption: Prompt conditioning reliably influences tone and discourse style; the base LLM is sufficiently responsive to natural-language affective cues.
- Evidence anchors: [abstract] "The resulting affective state is injected back into generation through prompt conditioning without modifying model parameters." [Section 2.4] "Qualitative differences in tone, assertiveness, and conciliatory language were observed across valence levels."
- Break condition: If prompt injection fails to measurably shift generation, the closed-loop control collapses.

## Foundational Learning

- **Exponential Smoothing / First-Order Systems**
  - Why needed here: The first-order condition implements exponential smoothing; understanding how α controls adaptation rate is essential for interpreting recovery behavior.
  - Quick check question: If α = 1, how does the state relate to the instantaneous estimate? (Answer: a_{t+1} = â_t—immediate adaptation, but state is still maintained across turns.)

- **Discretized Damped Second-Order Systems (Momentum)**
  - Why needed here: The second-order dynamics derive from classical mechanics analogies; μ functions as a damping/momentum term.
  - Quick check question: What happens to velocity when μ → 1 and the external signal (â_t - a_t) is small? (Answer: Velocity persists with little decay—strong inertia.)

- **Hysteresis as Path Dependence**
  - Why needed here: The paper quantifies hysteresis as the area between descent and recovery curves; this is the primary metric for path dependence.
  - Quick check question: In a memoryless (stateless) system, what would the hysteresis value be? (Answer: Zero—no path dependence.)

## Architecture Onboarding

- **Component map**:
User Input → [Dialogue Context] → [Affect Estimator (VADER)] → â_t (instantaneous)
                                        ↓
                              [State Update Engine] ← Previous a_t, u_t
                                        ↓
                              Current a_t (VAD vector)
                                        ↓
                              [Prompt Encoder] → Structured control prompt
                                        ↓
                              [Base LLM] → Generated response
                                        ↓
                              [Response] → Logged + fed back to context

- **Critical path**: The state update equations (first-order: Section 2.3.2; second-order: Section 2.3.3). Any bug here invalidates all downstream behavior.

- **Design tradeoffs**:
  - **Stability vs. Responsiveness**: Higher μ increases hysteresis and stability but delays/eliminates recovery. The paper shows μ = 0.8 balances both; μ = 0.95 fails to recover.
  - **State dimensionality**: Only valence is analyzed quantitatively; full VAD is tracked but not validated.
  - **Estimator choice**: Lexicon-based (VADER) is noisy but fixed; learned estimators could improve signal quality but introduce additional failure modes.

- **Failure signatures**:
  - Stateless baseline: Near-zero valence variance, no recovery structure (Figure 1).
  - High inertia (μ = 0.95): Extended negative trough, no recovery within dialogue horizon (Section 3.4).
  - Prompt injection failure: No measurable tone shift across VAD settings (conduct calibration per Section 2.4).

- **First 3 experiments**:
  1. **Reproduce stateless vs. first-order comparison**: Run 5 trials each with the 25-turn protocol; verify stateless shows no hysteresis and first-order recovers by turn 14.
  2. **Sweep μ values**: Test μ ∈ {0, 0.5, 0.8, 0.9, 0.95} to replicate the monotonic hysteresis increase and identify the recovery boundary.
  3. **Validation of prompt injection**: Generate responses with fixed prompts under static VAD settings (e.g., valence = -0.8 vs. +0.8); manually verify tone differences as described in Section 2.4 calibration.

## Open Questions the Paper Calls Out

- **Open Question 1**: Can adaptive or state-dependent inertia coefficients improve the trade-off between stability and responsiveness compared to fixed momentum parameters?
  - Basis in paper: [explicit] The Discussion explicitly identifies "adaptive or state-dependent inertia" as a direction for future work.
  - Why unresolved: The current study uses fixed μ values (0.8, 0.95), revealing that while high inertia increases hysteresis, it also suppresses recovery within finite horizons.
  - What evidence would resolve it: Experiments implementing a dynamic μ that adjusts based on signal intensity or conversation phase, showing recovery in long horizons without losing stability.

- **Open Question 2**: How do explicit affective dynamics behave in multi-agent systems where the emotional trajectories of agents are coupled?
  - Basis in paper: [explicit] The paper lists "multi-agent settings" as a specific avenue for extending this framework.
  - Why unresolved: The current methodology isolates a single agent against a fixed dialogue script; it does not test for feedback loops where one agent's state evolution influences another's.
  - What evidence would resolve it: Simulations involving multiple agents with coupled VAD dynamics to observe whether they synchronize, diverge, or exhibit emergent collective behavior.

- **Open Question 3**: Do the observed benefits of external affective dynamics generalize across diverse interaction domains beyond the specific adversarial-reconciliatory protocol?
  - Basis in paper: [explicit] The authors acknowledge that experiments were conducted under a "single, fixed dialogue protocol" and that this limits claims about generalization.
  - Why unresolved: It remains unclear if the reduction in abrupt tone shifts holds for casual conversation, task-oriented dialogue, or different cultural contexts.
  - What evidence would resolve it: Testing the identical dynamical overlay on distinct dialogue datasets (e.g., open-domain chat vs. customer service) to verify robustness.

## Limitations
- The exact 25-turn dialogue protocol is in supplementary material not provided, making exact reproduction uncertain.
- The prompt template for VAD injection is unspecified beyond "structured natural-language prompts."
- VADER-to-VAD mapping formulas are not precisely specified, though the qualitative method is described.

## Confidence
- **High confidence** in the core mechanism: Stateful dynamics with momentum-based updates demonstrably produce hysteresis and controlled recovery, supported by monotonic metric trends and qualitative observations.
- **Medium confidence** in prompt injection effectiveness: Behavioral shifts are observed but prompt sensitivity is context-dependent per related work.
- **Medium confidence** in affect estimation reliability: VADER provides fixed signal quality but introduces noise that state persistence smooths.

## Next Checks
1. Verify prompt injection actually modulates generation tone by generating static responses under fixed VAD values and checking for measurable tone differences.
2. Confirm the recovery boundary by sweeping μ values and identifying the threshold where recovery fails within the 25-turn horizon.
3. Replicate the stateless vs. first-order comparison to ensure stateful persistence produces the reported delayed response and recovery patterns.