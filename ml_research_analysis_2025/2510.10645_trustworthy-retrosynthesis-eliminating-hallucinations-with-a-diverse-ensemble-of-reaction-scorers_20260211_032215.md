---
ver: rpa2
title: 'Trustworthy Retrosynthesis: Eliminating Hallucinations with a Diverse Ensemble
  of Reaction Scorers'
arxiv_id: '2510.10645'
source_url: https://arxiv.org/abs/2510.10645
tags:
- reaction
- reactions
- retrosynthesis
- figure
- scorers
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'RetroTrim combines a reaction generator with a MetaScorer ensemble
  to eliminate hallucinations in retrosynthesis. It uses three complementary scorers:
  Reaction Prior (mimics chemist reasoning), Reaction Graph Plausibility (classifies
  valid vs.'
---

# Trustworthy Retrosynthesis: Eliminating Hallucinations with a Diverse Ensemble of Reaction Scorers

## Quick Facts
- arXiv ID: 2510.10645
- Source URL: https://arxiv.org/abs/2510.10645
- Reference count: 40
- Primary result: Eliminated all hallucinated (Nonsense) reactions while finding flawless synthetic routes for the largest number of targets among compared methods

## Executive Summary
RetroTrim is a retrosynthesis system that combines a reaction generator with a MetaScorer ensemble to eliminate hallucinated reactions. It uses three complementary scorers—Reaction Prior, Reaction Graph Plausibility, and Reference Reaction Scorer—to filter out chemically implausible reactions during tree search. Evaluated on 32 challenging drug-like targets by expert chemists, RetroTrim uniquely achieved zero hallucinations while maintaining the highest number of reliable pathways.

## Method Summary
RetroTrim uses a BART-based reaction generator trained on root-aligned SMILES, combined with three distinct scorers: a BART-based Reaction Prior that mimics chemist reasoning, a Graph Attention Network classifier for reaction graph plausibility, and a retrieval-based scorer that checks for chemical precedent in reaction databases. These are aggregated by a MetaScorer that prunes reactions below calibrated plausibility thresholds during Retro* search. The system is trained on the proprietary Pistachio dataset (~4M reactions) and calibrated to find paths for at least 90% of targets while maintaining 0.8 precision.

## Key Results
- Zero hallucinated (Nonsense) reactions across 32 drug-like targets
- Highest number of flawless synthetic routes among compared methods
- Only method to eliminate all major error categories while maintaining coverage

## Why This Works (Mechanism)

### Mechanism 1: Diverse Ensemble Filtering
An ensemble of reaction scorers with distinct error patterns can systematically eliminate hallucinated reactions that any single scorer misses. The system combines three complementary scorers—Reaction Prior (RP), Reaction Graph Plausibility (RGP), and Reference Reaction Scorer (RRS)—each targeting different hallucination types. RGP detects Selectivity/Reactivity errors, RRS catches gross structural mismatches, and RP provides balanced coverage. A MetaScorer aggregates these signals via threshold-based binary classification, pruning reactions that fail all checks during tree search.

### Mechanism 2: Mid-Search Pruning with Threshold Constraints
Pruning reactions below a calibrated plausibility threshold during Retro* search halts expansion of hallucinated branches before they corrupt pathways. The MetaScorer filters reactions using thresholds tuned for 90% target coverage and 0.8 precision on labeled data. Reactions scoring below threshold are removed from the search tree, preventing further exploration.

### Mechanism 3: Retrieval-Grounded Plausibility via Reference Reactions
A retrieval-based scorer that checks for chemical precedent in reaction databases catches gross hallucinations that ML models alone miss. The Reference Reaction Scorer (RRS) uses two-tiered clustering based on bond change patterns and substructures to count similar reference reactions. A logarithmic transformation of reference counts provides a plausibility signal grounded in experimental literature.

## Foundational Learning

- **Concept: Ensemble Diversity in Error Modes**
  - Why needed: The paper's core thesis depends on scorers having distinct failure profiles; understanding why they differ is critical for replication or extension.
  - Quick check: If two scorers have >70% overlap in false positives on a validation set, should they both be included?

- **Concept: Precision-Recall Trade-offs in High-Stakes Filtering**
  - Why needed: The system explicitly trades coverage (90%) for reliability (0.8 precision); practitioners must understand when to tighten or relax thresholds.
  - Quick check: For a new target class, would you prioritize higher precision or higher coverage during threshold tuning, and why?

- **Concept: Chemical Reaction Representation (Graphs vs. SMILES)**
  - Why needed: RP uses BART with SMILES, RGP uses GAT with graph featurization; the choice influences what hallucination types each scorer can detect.
  - Quick check: Which representation is better suited for detecting regioselectivity errors, and why?

## Architecture Onboarding

- **Component map:** Generator (RootAligned BART) -> Scorers (RP, RGP, RRS) -> MetaScorer (aggregation) -> Retro* search (pruning) -> Expert evaluation
- **Critical path:** Train generator and scorers on Pistachio → Calibrate MetaScorer thresholds → For each target: run Retro* search, prune reactions with s_META=0, return top-1 path → Evaluate with expert chemists
- **Design tradeoffs:** Coverage vs. reliability (stricter thresholds reduce hallucinations but may fail to find paths), scorer complexity vs. latency (RRS requires database lookup), generalization domain (trained on drug-like compounds)
- **Failure signatures:** Path contains "Nonsense" reactions (thresholds too lenient or mis-calibrated), no path found for >10% of targets (thresholds too strict), high false positive overlap among scorers (ensemble not diverse)
- **First 3 experiments:** Threshold sensitivity analysis (vary MetaScorer thresholds and measure impact), scorer ablation (remove each scorer individually), domain shift test (evaluate on non-drug-like targets)

## Open Questions the Paper Calls Out
1. How does strict plausibility filtering impact the structural diversity of valid synthetic pathways?
2. Does the RetroTrim ensemble generalize effectively to chemical domains outside of medicinal chemistry?
3. What is the granular correlation between automated surrogate metrics and specific expert-labeled failure modes?

## Limitations
- Relies on proprietary training data (Pistachio), limiting reproducibility with public datasets
- Threshold calibration parameters (90% coverage, 0.8 precision) are critical but not fully specified
- Expert evaluation protocol is rigorous but subjective without inter-rater agreement metrics

## Confidence
- **High Confidence:** Zero hallucinations achieved on benchmark (direct experimental result)
- **Medium Confidence:** Ensemble diversity drives hallucination elimination (mechanistically sound but under-supported by empirical overlap analysis)
- **Medium Confidence:** 90% coverage constraint is operationally important but sensitivity to domain shift untested
- **Low Confidence:** 4,500 labeled reactions fully representative for threshold tuning

## Next Checks
1. Compute and visualize pairwise false positive overlap rates for RP, RGP, and RRS on held-out validation set
2. Systematically vary MetaScorer thresholds and plot coverage vs. hallucination rate
3. Evaluate RetroTrim on USPTO dataset to assess performance with different training/testing sources