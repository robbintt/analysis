---
ver: rpa2
title: Embedding -based Crop Type Classification in the Groundnut Basin of Senegal
arxiv_id: '2601.16900'
source_url: https://arxiv.org/abs/2601.16900
tags:
- crop
- tessera
- land
- classification
- alphaearth
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study evaluates embedding-based methods for crop type classification
  in the groundnut basin of Senegal, a smallholder agricultural region. The authors
  compare geospatial foundation model embeddings from TESSERA and AlphaEarth against
  traditional methods like spectral-temporal metrics and raw satellite data using
  Sentinel-1 and Sentinel-2 imagery.
---

# Embedding -based Crop Type Classification in the Groundnut Basin of Senegal

## Quick Facts
- arXiv ID: 2601.16900
- Source URL: https://arxiv.org/abs/2601.16900
- Reference count: 29
- Primary result: TESSERA embeddings achieve 0.846 accuracy and 0.643 F1 score for crop type classification in Senegal's groundnut basin

## Executive Summary
This study evaluates embedding-based methods for crop type classification in the groundnut basin of Senegal, a smallholder agricultural region. The authors compare geospatial foundation model embeddings from TESSERA and AlphaEarth against traditional methods like spectral-temporal metrics and raw satellite data using Sentinel-1 and Sentinel-2 imagery. TESSERA-based approach consistently outperforms other methods across performance, plausibility, transferability, and accessibility criteria, requiring no feature engineering and demonstrating stable results across years.

## Method Summary
The study evaluates four input types for crop type classification: raw Sentinel-1/2 data with vegetation indices (1106 features), spectral-temporal metrics (228 features), TESSERA embeddings (128 dimensions), and AlphaEarth embeddings (64 dimensions). Classifiers are trained using labeled polygons from the JECAM dataset and evaluated on held-out polygons and temporal transfer across 2018-2021. The best two classifiers per input type are ensembled, with probability outputs averaged to reduce variance. Results are validated through wall-to-wall map generation and year-over-year cropland change analysis.

## Key Results
- TESSERA achieves 0.965 accuracy and 0.906 F1 score for land cover classification
- For crop type classification, TESSERA reaches 0.846 accuracy and 0.643 F1 score
- In temporal transfer learning, TESSERA shows 28% higher accuracy compared to next best method
- TESSERA demonstrates 2-3% annual cropland change (plausible) vs 15.4% aggregate change for raw data

## Why This Works (Mechanism)

### Mechanism 1
Pre-trained geospatial embeddings transfer spectral-temporal patterns to data-scarce smallholder regions without task-specific feature engineering. TESSERA learns representations from global Sentinel-1 and Sentinel-2 imagery using sparse temporal augmentation, encoding phenological dynamics that remain useful for downstream classification even when labeled data is limited. This works because global pre-training data contains transferable structure that aligns with crop type semantics in understudied regions.

### Mechanism 2
Embedding space geometry that naturally clusters by semantic class enables simpler classifiers to achieve higher accuracy with lower variance. When embeddings form well-separated neighborhoods aligned with land cover and crop type labels, downstream classifiers can learn decision boundaries more reliably, reducing the instability observed across random seeds. This works because semantic class structure in embedding space corresponds to real-world class separability.

### Mechanism 3
Compact, pre-computed embeddings reduce temporal transfer variance by filtering out year-specific noise present in raw time series. Raw satellite data contains year-specific variations that classifiers may overfit. Pre-trained embeddings abstract away this noise while preserving task-relevant structure, yielding more stable cross-year predictions. This works because the embedding model's pre-training objective filters out nuisance variation while retaining signal relevant to downstream crop classification.

## Foundational Learning

**Geospatial Foundation Models** - These are foundation models pre-trained on large Earth observation corpora that generate fixed representations (embeddings) rather than being fine-tuned end-to-end. Understanding that embeddings are pre-computed representations is essential for interpreting the experimental design. Quick check: Can you explain why the authors use pre-computed embeddings as fixed inputs rather than fine-tuning the foundation model on Senegal labels?

**Spectral-Temporal Metrics (STMs)** - These are traditional baseline features requiring hand-engineered statistics (quantiles, vegetation indices, Tasseled Cap transformations computed over seasonal windows). The paper positions embeddings against this established approach. Quick check: What information might STMs lose compared to learned embeddings, given that STMs aggregate time series into summary statistics?

**Classifier Ensembling for Uncertainty Reduction** - The paper selects two best-performing classifier heads per input type and averages their probability outputs to reduce high standard deviation observed across single-model runs. Understanding this ensembling approach is important for reproducing results. Quick check: Why might ensembling MLP and XGBoost produce more stable predictions than using either classifier alone?

## Architecture Onboarding

**Component map:** Sentinel-1/2 time series → (path A) raw VIs (1106 features), (path B) STMs (228 features), (path C) TESSERA embeddings (128 dims), (path D) AlphaEarth embeddings (64 dims) → Ensemble of two classifiers per input → Per-pixel class prediction → Wall-to-wall maps

**Critical path:**
1. Obtain labeled polygons (JECAM dataset) and split by polygon into train/validation/test
2. Download pre-computed TESSERA embeddings via GeoTessera package for study years
3. Train classifier ensemble on 2018 labels, evaluate on 2019 and 2021 for temporal transfer
4. Generate wall-to-wall maps using all labels with multi-seed probability aggregation
5. Validate plausibility by checking year-over-year cropland change against regional statistics

**Design tradeoffs:** Pre-computed embeddings eliminate feature engineering but remove control over temporal windowing and band selection. Ensembling reduces variance but adds complexity. Using "core cropland" mask improves precision but may exclude legitimate interannual rotation patterns.

**Failure signatures:** High standard deviation across runs (>±0.05 on F1) suggests embedding-classifier mismatch or label noise. Year-over-year cropland change >5% indicates classifier instability. Temporal transfer accuracy below random baseline indicates learned year-specific artifacts. "Starburst" UMAP pattern without class clustering suggests embeddings lack semantic structure.

**First 3 experiments:**
1. Replicate 2018 land cover classification with TESSERA embeddings using MLP and XGBoost ensemble; target accuracy ≥0.96 and macro F1 ≥0.90 with standard deviation <±0.01
2. Train on 2018 labels, evaluate on 2019 crop type classification; verify TESSERA achieves >60% accuracy while raw and STM baselines fall below random (20%)
3. Generate wall-to-wall maps for all three years and compute cropland area change; confirm TESSERA shows 2-3% aggregate change while raw data shows >15% (implausible)

## Open Questions the Paper Calls Out

**Transferability to diverse smallholder regions:** Can TESSERA embeddings maintain their performance advantages for crop type classification across diverse smallholder regions with different management systems, crop compositions, and data availability? This remains unresolved because the study only evaluates one region in Senegal.

**Intercropping disentanglement:** How can embedding-based approaches be extended to explicitly disentangle intercropped or secondary crops in mixed cropping systems? Current approach only classifies primary crops, though intercropping rates varied from 0–78% across crop types and years.

**Error pattern quantification:** What are the spatial and crop-type-specific error patterns in TESSERA-based classification outputs? The paper reports aggregate accuracy but does not analyze where or why errors occur systematically.

**AlphaEarth performance gap:** What causes AlphaEarth embeddings to underperform TESSERA for crop type classification despite comparable land cover performance? The authors hypothesize spatial smoothing effects but this remains untested.

## Limitations

- Limited cross-year validation with single-year label sets makes it difficult to disentangle embedding quality from potential label noise
- "Core cropland" mask used to improve classification precision may systematically exclude rotational patterns common in smallholder systems
- Paper does not fully explore hyperparameter sensitivity or provide complete implementation details for some experimental choices

## Confidence

- **High confidence:** TESSERA embeddings outperform traditional methods for land cover classification (accuracy 0.965, F1 0.906) based on robust multi-run evaluation
- **Medium confidence:** TESSERA demonstrates superior temporal transfer for crop type classification (>28% accuracy improvement) given limited cross-year validation
- **Medium confidence:** The plausibility criterion (year-over-year cropland change <5%) effectively validates method stability

## Next Checks

1. Generate UMAP visualizations for all embedding types on the same labeled sample to verify the "starburst" pattern observation for AlphaEarth and natural clustering for TESSERA
2. Implement a cross-validation experiment where classifiers trained on 2018 labels are tested on 2019 data with and without the "core cropland" mask to quantify its impact on rotational pattern detection
3. Replicate the temporal transfer experiment using 2021 as the source year instead of 2018 to test robustness to different label quality years