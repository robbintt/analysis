---
ver: rpa2
title: A robust and adaptive MPC formulation for Gaussian process models
arxiv_id: '2507.02098'
source_url: https://arxiv.org/abs/2507.02098
tags:
- control
- robust
- online
- which
- bound
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper presents a robust and adaptive model predictive control
  (MPC) framework that integrates Gaussian Processes (GPs) for learning uncertain
  nonlinear dynamics with bounded disturbances and unmodeled nonlinearities. The key
  contribution is the use of contraction metrics to construct robust predictions for
  GP models, enabling theoretical guarantees on recursive feasibility, robust constraint
  satisfaction, and convergence to a reference state with high probability.
---

# A robust and adaptive MPC formulation for Gaussian process models

## Quick Facts
- arXiv ID: 2507.02098
- Source URL: https://arxiv.org/abs/2507.02098
- Reference count: 40
- Primary result: Novel robust and adaptive MPC framework using contraction metrics with GPs, enabling theoretical guarantees and online adaptation.

## Executive Summary
This paper presents a robust and adaptive model predictive control (MPC) framework that integrates Gaussian Processes (GPs) for learning uncertain nonlinear dynamics with bounded disturbances and unmodeled nonlinearities. The key contribution is the use of contraction metrics to construct robust predictions for GP models, enabling theoretical guarantees on recursive feasibility, robust constraint satisfaction, and convergence to a reference state with high probability. The approach uses online data to update the GP model during operation, reducing uncertainty and improving performance. A numerical example with a planar quadrotor subject to ground effects demonstrates significant improvements in tracking accuracy and constraint satisfaction compared to existing GP-MPC methods. The method is computationally efficient and applicable to a broad class of nonlinear continuous-time systems.

## Method Summary
The proposed GP-RAMPC scheme combines contraction theory with Gaussian Process regression for robust adaptive MPC. Offline, a contraction metric is synthesized via LMIs to compute a feedback policy and terminal set. Online, a collection of GPs is maintained, and at each step, an optimal control problem is solved to find a nominal trajectory and feedback policy. The uncertainty tube is propagated using a scalar differential equation derived from the contraction metric, preventing exponential growth. New data points are added to the GP models, and the intersection of confidence bounds ensures recursive feasibility. The OCP minimizes a quadratic cost subject to tightened constraints, guaranteeing robust satisfaction with high probability.

## Key Results
- Novel integration of contraction metrics with GPs for robust predictions prevents exponential uncertainty growth typical of linearization methods.
- Multi-model GP collection with confidence bound intersection enables recursive feasibility during online adaptation.
- Numerical quadrotor example demonstrates improved tracking performance and constraint satisfaction compared to baseline GP-MPC methods.
- Theoretical guarantees provided for recursive feasibility, robust constraint satisfaction, and convergence to reference state with high probability.

## Why This Works (Mechanism)

### Mechanism 1
Using contraction metrics to parameterize reachable sets prevents the exponential growth of uncertainty typically seen in sequential robust propagation methods. Instead of propagating uncertainty via linearization (which accumulates error) or interval arithmetic (which expands rapidly), the paper derives a scalar differential equation (Eq. 23d) for a tube scaling factor $\delta$. This equation is stabilized by the contraction rate $\rho$ of the control policy. The uncertain dynamics are treated as a perturbation to the contraction metric, ensuring the "tube" radius remains bounded if the system is contractive under the feedback law. The core assumption is the system dynamics are exponentially stabilizable and a Control Contraction Metric (CCM) exists. Break condition: If the contraction rate $\rho$ is insufficient to dominate the worst-case model error $w(z)$, the tube expands until constraints become infeasible.

### Mechanism 2
Recursive feasibility is preserved during online model updates by maintaining a collection of Gaussian Process models and intersecting their confidence bounds. When new data arrives, standard GP updating changes the mean function, which can invalidate previous feasibility guarantees. This method stores a collection of GPs $M_k$. It constructs a composite uncertainty bound $\tilde{w}$ using the intersection of confidence intervals from all active GPs. This ensures the uncertainty bound is non-increasing as data is added. The optimizer effectively finds a feasible trajectory that stays within the intersection of all valid models. The core assumption is the true function $g$ lies in the RKHS of the kernel used for all GP models in the collection, and noise is conditionally R-sub-Gaussian. Break condition: If the true system dynamics drift outside the RKHS of the kernel used for the GP collection, the high-probability bounds fail, and the intersection may not cover the true state.

### Mechanism 3
Robust constraint satisfaction is achieved by optimizing a nominal trajectory subject to constraints tightened by the predicted tube size. The control input consists of a nominal feedforward term and a feedback term $\kappa$ derived from the contraction metric. The Optimal Control Problem (OCP) minimizes the cost of the nominal trajectory but enforces constraints $h_j(z, v) + c_j \delta \leq 0$ (Eq. 15e). Because Theorem 1 guarantees the true state remains within the tube radius $\delta$ of the nominal state $z$ with high probability, the tightened constraints ensure the actual system respects safety limits. The core assumption is the terminal set $X_f$ is positively invariant under the feedback law and robust to the residual uncertainty. Break condition: If the initial state is outside the feasible region defined by the tightened constraints, or if the terminal set cannot be reached due to excessive noise $d(t)$.

## Foundational Learning

- **Concept:** Contraction Theory / Control Contraction Metrics (CCM)
  - **Why needed here:** It provides the mathematical machinery to define a "distance" ($V_\delta$) that shrinks under feedback, enabling the scalar tube propagation that distinguishes this method from linearization-based approaches.
  - **Quick check question:** Can you explain why a contraction metric is superior to a Lyapunov function for tracking arbitrary trajectories (i.e., incremental stability)?

- **Concept:** Gaussian Process (GP) Regression & RKHS
  - **Why needed here:** This serves as the non-parametric model structure. Understanding the link between the kernel choice, the Reproducing Kernel Hilbert Space (RKHS) norm, and the probabilistic error bounds ($\beta \sigma$) is critical for setting the safety parameters.
  - **Quick check question:** What does the hyperparameter $\beta_N$ in Lemma 1 represent in terms of the confidence interval and model complexity?

- **Concept:** Model Predictive Control (MPC) & Recursive Feasibility
  - **Why needed here:** The paper operates within the MPC framework. One must understand how feasibility at time $t$ implies feasibility at $t+1$ to appreciate the contribution of the RAMPC scheme.
  - **Quick check question:** Why does changing the model online (adaptation) typically break recursive feasibility in standard MPC schemes?

## Architecture Onboarding

- **Component map:** Offline LMI solver -> Contraction metric computation -> Constant pre-calculation -> Online RAMPC loop (State estimator -> GP batch evaluator -> Bound intersector -> OCP solver -> Controller)
- **Critical path:** The OCP solve time is the bottleneck. The paper notes that evaluating the GP batch (fixed size $n_b=10$) takes ~80ms, dominating the QP solve time (~10ms). Optimizing the GP evaluation or using sparse approximations is crucial for higher frequencies.
- **Design tradeoffs:**
  - **Kernel Selection:** A "richer" kernel reduces model error but may increase $\beta_N$ and conservatism. A simpler kernel might violate the RKHS assumption.
  - **Batch Size ($n_b$) vs. Performance:** Limiting the GP collection size ensures real-time operation but may discard older, potentially valid model constraints, risking safety margins during rapid adaptation.
  - **Probability $p$:** Setting $p$ very low (high safety) increases the error bound $\beta$, causing larger tubes $\delta$ and potentially infeasibility.
- **Failure signatures:**
  - **Infeasible OCP:** The tube scaling $\delta$ grows too large, causing tightened constraints $h + c\delta \le 0$ to conflict with physical limits.
  - **Constraint Violation:** The true trajectory leaves the tube $V_\delta(x, z) \le \delta$.
  - **Chattering:** The feedback law $\kappa$ is too aggressive relative to the discretization step $T_s$.
- **First 3 experiments:**
  1. **Static Validation:** Reproduce the "Planar Quadrotor" example (Sec 5) comparing the proposed contraction-based tube against the baseline (Koller et al. [26]) to verify the reduction in conservatism.
  2. **Ablation on Adaptation:** Run the system with RAMPC enabled vs. RMPC (static GP) to quantify the performance gain (cost reduction) and tube shrinkage over time.
  3. **Robustness Test:** Inject noise $d(t)$ at the boundary of set $D$ to stress-test the constraint tightening logic and verify constraint satisfaction never fails.

## Open Questions the Paper Calls Out
- How can tailored optimization methods, such as zero-order optimization, be integrated to further enhance the numerical efficiency of the GP-RAMPC scheme? (The conclusion explicitly lists this as an open issue.)
- What data management strategies can be developed to allow for indefinite online learning without exceeding computational limits? (The conclusion identifies this as an open issue.)
- Can the framework be extended to handle dependent multi-output Gaussian processes without relying on the simplifying assumption of output independence? (Appendix B extends results but assumes independent GPs for each output dimension.)

## Limitations
- The computational scaling with state dimension is unclear, relying on LMIs for the contraction metric and batch GP evaluations.
- The method assumes the true dynamics lie within the RKHS of the GP kernel, which may not hold for all systems.
- The approach is validated on a 6-state quadrotor example; broader applicability to more complex systems remains to be shown.

## Confidence
- **Non-Expansive Uncertainty Propagation Guarantee:** Medium confidence (theoretical justification is sound, but numerical validation is limited to one baseline comparison).
- **Adaptive Model Update Feasibility:** Low confidence (paper does not validate behavior when true dynamics drift outside RKHS assumption).
- **Computational Tractability for Larger Systems:** Low confidence (claims broad applicability but lacks validation on higher-dimensional systems).

## Next Checks
1. **Baseline Comparison Expansion:** Reproduce the quadrotor experiment but explicitly compare the contraction-based tube against sequential linearization-based tubes and interval arithmetic methods. Measure the tube radius growth over the prediction horizon to quantify conservatism reduction.
2. **RKHS Assumption Stress Test:** Modify the simulation to use a ground effect function outside the RKHS of the chosen GP kernel. Verify whether constraint violations occur and whether the multi-model intersection strategy degrades gracefully.
3. **Scalability Assessment:** Apply the method to a higher-dimensional system (e.g., a 12-state hexarotor with additional degrees of freedom). Profile the LMI solve time for the contraction metric and the GP batch evaluation to identify computational bottlenecks.