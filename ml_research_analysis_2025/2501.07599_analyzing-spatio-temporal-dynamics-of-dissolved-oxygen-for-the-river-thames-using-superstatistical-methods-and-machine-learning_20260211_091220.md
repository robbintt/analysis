---
ver: rpa2
title: Analyzing Spatio-Temporal Dynamics of Dissolved Oxygen for the River Thames
  using Superstatistical Methods and Machine Learning
arxiv_id: '2501.07599'
source_url: https://arxiv.org/abs/2501.07599
tags:
- time
- data
- river
- water
- which
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study analyzed dissolved oxygen (DO) dynamics in the River
  Thames using superstatistical methods and machine learning. A novel multiplicative
  Empirical Mode Decomposition method was introduced for detrending, yielding the
  highest log-likelihood in nearly all fittings.
---

# Analyzing Spatio-Temporal Dynamics of Dissolved Oxygen for the River Thames using Superstatistical Methods and Machine Learning

## Quick Facts
- arXiv ID: 2501.07599
- Source URL: https://arxiv.org/abs/2501.07599
- Reference count: 40
- This study analyzed dissolved oxygen (DO) dynamics in the River Thames using superstatistical methods and machine learning, introducing a novel multiplicative Empirical Mode Decomposition method and demonstrating the Informer model's superiority for long-term forecasting.

## Executive Summary
This study analyzes Dissolved Oxygen (DO) dynamics in the River Thames using superstatistical methods and machine learning. The authors introduce a novel multiplicative Empirical Mode Decomposition (EMD) for detrending tidal river data, yielding superior q-Gaussian fits compared to additive methods. After detrending, DO fluctuations exhibit heavy-tailed distributions. For same-time prediction, Light Gradient Boosting Machine (LGBM) outperforms other models, while the Informer model achieves the lowest error for long-term forecasting using 192 historical time steps, attributed to its ProbSparse self-attention mechanism.

## Method Summary
The study analyzes 9 monitoring sites with 15-minute resolution DO data (2017-2022). A novel multiplicative EMD method detrends the data by applying a logarithmic transformation before EMD decomposition. q-Gaussian distributions are fitted to the fluctuations using Maximum Likelihood Estimation. For same-time prediction, LGBM is trained with temporal features and SHAP analysis identifies key predictors. For long-term forecasting, the Informer model with ProbSparse self-attention processes 192-step input windows to predict 48-step futures. The models are evaluated using MAE, SMAPE, and log-likelihood metrics.

## Key Results
- Multiplicative EMD yielded the highest log-likelihood in nearly all fittings compared to additive methods
- The optimally fitted width parameter (β) of q-Gaussian distributions showed a negative correlation with distance to the sea
- For same-time prediction, LGBM outperformed other models, with temperature, pH, and time of year identified as crucial predictors
- For long-term forecasting, the Informer model achieved the lowest MAE and SMAPE using 192 historical time steps, attributed to its ProbSparse self-attention mechanism

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Multiplicative Empirical Mode Decomposition (EMD) provides a superior signal detrending fit for tidal river data compared to additive methods.
- **Mechanism:** By applying a logarithmic transformation (log(y_t) = log(T̂_t) + log(F̂_t) + log(R̂_t)), the multiplicative model converts varying amplitude oscillations typical of tidal dynamics into an additive problem, allowing EMD to more effectively isolate intrinsic mode functions (IMFs) and retrieve fluctuations that adhere to q-Gaussian distributions.
- **Core assumption:** The time series contains positive values and follows a multiplicative structure where trend and fluctuation components interact proportionally rather than linearly.
- **Evidence anchors:**
  - [abstract] "A novel multiplicative Empirical Mode Decomposition method was introduced for detrending, yielding the highest log-likelihood in nearly all fittings."
  - [section] Page 6, Eq. 6 and description: "Given the additive nature of EMD, when applying a multiplicative decomposition, a logarithmic transformation is applied... to obtain... an additive one."
- **Break condition:** If the input data contains non-positive values or zeros, the logarithmic transformation required for the multiplicative model fails.

### Mechanism 2
- **Claim:** The Informer model's ProbSparse self-attention mechanism enables superior long-term forecasting by dynamically focusing on informative historical time steps.
- **Mechanism:** The ProbSparse mechanism filters the dominant queries in the attention matrix, reducing quadratic complexity to O(L log L). This allows the model to process long sequences (192 steps) and identify specific long-range dependencies (e.g., half-life cycles of Dissolved Oxygen) that LSTM or Dense models miss.
- **Core assumption:** The most informative elements in the time series are sparse and sufficient for predicting long horizons, meaning not all historical points contribute equally to the output.
- **Evidence anchors:**
  - [abstract] "For long-term forecasting, the Informer model achieved the lowest MAE and SMAPE... attributed to its ProbSparse self-attention mechanism."
  - [section] Page 11: "The ProbSparse self-attention mechanism... dynamically focuses on the most informative parts of a long input sequence."
- **Break condition:** If the underlying dependencies are dense and uniformly distributed across all time steps, the sparsity assumption of ProbSparse may discard critical information.

### Mechanism 3
- **Claim:** The scale parameter (β) of the q-Gaussian distribution acts as a spatial proxy for water stability relative to distance from the sea.
- **Mechanism:** The parameter β (width) is inversely proportional to the variance of local fluctuations. The observed negative correlation between β and distance to the sea suggests that inland sites exhibit greater fluctuation variability (lower stability) compared to coastal sites, likely due to tidal mixing and seawater buffering.
- **Core assumption:** The system exhibits superstatistical properties where local fluctuations are Gaussian, but the variance fluctuates over a longer timescale (resulting in a marginal q-Gaussian distribution).
- **Evidence anchors:**
  - [abstract] "The optimally fitted width parameter showed a negative correlation with the distance to the sea."
  - [section] Page 8, Fig. 3: "We observe a linear decreasing trend in β versus distance to the sea... This observation suggests that DO dynamics are influenced by spatial location."
- **Break condition:** This correlation may break if the physical drivers of mixing (e.g., salinity fronts, sediment) change non-linearly or if distinct pollution events dominate the signal over tidal effects.

## Foundational Learning

- **Concept: Superstatistics**
  - **Why needed here:** To model non-Gaussian, heavy-tailed probability distributions of Dissolved Oxygen fluctuations that standard Gaussian statistics fail to capture.
  - **Quick check question:** If the fluctuation distribution was perfectly Gaussian (q=1), what would that imply about the system's timescale separation?

- **Concept: Empirical Mode Decomposition (EMD)**
  - **Why needed here:** To decompose non-stationary and non-linear tidal signals into Intrinsic Mode Functions (IMFs), separating the underlying trend from high-frequency fluctuations without assuming a fixed basis function.
  - **Quick check question:** Why is EMD preferred over Fourier transforms for analyzing tidal river data where frequency components vary over time?

- **Concept: ProbSparse Self-Attention**
  - **Why needed here:** To enable the Transformer (Informer) architecture to handle long sequence inputs (192 time steps) efficiently by limiting attention to only the "active" queries, thereby reducing computational load.
  - **Quick check question:** How does the O(L log L) complexity of ProbSparse compare to the standard self-attention complexity in a vanilla Transformer?

## Architecture Onboarding

- **Component map:** Data Source -> Multiplicative EMD Detrending -> q-Gaussian Fitting -> Regression (LGBM) or Forecasting (Informer)

- **Critical path:**
  1. **Detrending:** Apply log-transform to raw DO → EMD → drop first m modes → retrieve fluctuations
  2. **Fitting:** Fit q-Gaussian PDF to fluctuations → Extract q (shape) and β (scale)
  3. **Forecasting:** Train Informer on 192-step windows → ProbSparse attention selects dominant keys → Generative decoder predicts 48-step future

- **Design tradeoffs:**
  - **Additive vs. Multiplicative Detrending:** Multiplicative yields higher log-likelihood for tidal data but fails on non-positive data
  - **LGBM vs. Informer:** LGBM is faster and better for same-time regression; Informer is computationally heavier but superior for long-sequence (multivariate) forecasting
  - **Input Length:** Increasing input steps (48 → 192) improves Informer performance for longer horizons but increases memory usage

- **Failure signatures:**
  - **Low Log-Likelihood:** Occurs when additive detrending is applied to strongly tidal sites (amplitude varies with mean)
  - **SMAPE Spikes:** Site TBGP (near sea) shows highest error, indicating model struggle with complex "coastal conditions" or rapid tidal mixing
  - **Baseline Outperformance:** If "Last" or "Linear" models beat Informer on 1-step predictions, the Transformer may be overfitting noise on short horizons (Table 2 confirms this for t=1)

- **First 3 experiments:**
  1. **Validate Detrending:** Apply multiplicative EMD to a single site (e.g., TCaP) and verify that the log-likelihood of the q-Gaussian fit exceeds that of the additive EMD method
  2. **Spatial Parameter Check:** Plot the extracted β parameter against "distance to sea" for all 9 sites to confirm the negative linear correlation reported
  3. **Ablation on Input Length:** Train the Informer model with input lengths of 48, 96, and 192 steps to reproduce the performance gain (lower MAE/SMAPE) observed for the 192-step configuration on the TBGP dataset

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** Does the multiplicative Empirical Mode Decomposition (EMD) detrending method and the resulting q-Gaussian distribution of fluctuations hold for other water quality indicators, such as electrical conductivity, in river systems outside the UK?
- **Basis in paper:** [explicit] The introduction and conclusion state, "Future studies may extend our methodology to other observables, such as electrical conductivity, in different river systems also outside the UK."
- **Why unresolved:** The current study focused exclusively on Dissolved Oxygen (DO) within the River Thames, leaving the applicability of this specific detrending and statistical fitting to other indicators and geographic locations untested.
- **Evidence to resolve:** Replicating the analysis pipeline on electrical conductivity time-series data from rivers with differing hydrological and tidal characteristics.

### Open Question 2
- **Question:** To what extent does incorporating high-resolution rainfall data improve the predictive accuracy of the dissolved oxygen forecasting models?
- **Basis in paper:** [explicit] The discussion notes, "Currently, the resolution discrepancy between our rainfall data and other environmental parameters has limited its utility... High-resolution rainfall data in future studies could refine our analysis."
- **Why unresolved:** The study utilized daily or hourly rainfall data paired with 15-minute resolution water quality data, preventing the models from effectively utilizing rainfall as a predictor for short-term DO fluctuations.
- **Evidence to resolve:** Re-training the Informer and LGBM models using rainfall data measured at the same 15-minute resolution as the other water quality indicators and comparing the resulting error metrics (MAE, SMAPE).

### Open Question 3
- **Question:** Can advanced probabilistic models like Natural Gradient Boosting (NGBoost) or Probabilistic Transformers provide reliable uncertainty estimates alongside point predictions for DO dynamics?
- **Basis in paper:** [explicit] The conclusion suggests, "future studies should explore advanced models like the Temporal Fusion Transformer and Natural Gradient Boosting to enhance accuracy and account for uncertainty."
- **Why unresolved:** The current Informer model implementation provides deterministic point forecasts without quantifying the confidence or uncertainty of the predictions.
- **Evidence to resolve:** Implementing NGBoost to generate prediction intervals and evaluating the calibration of these intervals against the actual distribution of extreme DO events.

## Limitations
- The study focuses on a single river system (River Thames), limiting generalizability to other aquatic environments with different physical and chemical characteristics
- The multiplicative EMD approach assumes a logarithmic relationship between trend and fluctuations, which may not hold for all tidal rivers or water quality parameters
- While ProbSparse attention reduces complexity, the Informer model still requires significant computational resources, potentially limiting real-time deployment

## Confidence
- **High Confidence:** The negative correlation between q-Gaussian width parameter (β) and distance to sea is well-supported by the data and aligns with physical understanding of tidal mixing effects
- **Medium Confidence:** The superiority of multiplicative EMD for tidal data is demonstrated through log-likelihood comparisons, but the method's sensitivity to data quality and assumptions warrants further validation
- **Medium Confidence:** The Informer model's performance advantage for long-term forecasting is supported by metrics, but the specific contribution of ProbSparse attention versus other architectural choices requires ablation studies

## Next Checks
1. **Data Quality Assessment:** Perform a comprehensive data quality audit to identify and quantify the impact of missing values, sensor faults, and the August 2022 artificial injection event on model performance
2. **Cross-Environment Testing:** Apply the complete methodology (multiplicative EMD + Informer forecasting) to a different river system with distinct tidal characteristics to evaluate model robustness and generalization
3. **Ablation Study on Attention Mechanism:** Conduct controlled experiments comparing the Informer model with and without ProbSparse attention, as well as with different attention mechanisms (e.g., standard self-attention, linear attention) to isolate the specific contribution of ProbSparse to forecasting performance