---
ver: rpa2
title: 'Rashomon Sets for Prototypical-Part Networks: Editing Interpretable Models
  in Real-Time'
arxiv_id: '2503.01087'
source_url: https://arxiv.org/abs/2503.01087
tags:
- prototypes
- proto-rset
- prototype
- each
- user
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper addresses the \u201Cinteraction bottleneck\u201D in\
  \ ProtoPNets, where debugging and refining models is slow due to repeated retraining.\
  \ Proto-RSet computes a Rashomon set\u2014a collection of equally performant ProtoPNets\u2014\
  enabling users to select or edit models in real time without retraining."
---

# Rashomon Sets for Prototypical-Part Networks: Editing Interpretable Models in Real-Time

## Quick Facts
- **arXiv ID:** 2503.01087
- **Source URL:** https://arxiv.org/abs/2503.01087
- **Reference count:** 40
- **Primary result:** Enables real-time editing of ProtoPNets by approximating the Rashomon set of the final linear layer, removing prototypes in seconds without retraining.

## Executive Summary
This paper addresses the "interaction bottleneck" in ProtoPNets, where debugging and refining models is slow due to repeated retraining. Proto-RSet computes a Rashomon set—a collection of equally performant ProtoPNets—enabling users to select or edit models in real time without retraining. By fixing the backbone and prototypes and optimizing only the final linear layer, Proto-RSet approximates the Rashomon set as an ellipsoid in weight space. Experiments show Proto-RSet produces accurate models quickly, meeting user constraints (e.g., removing biased prototypes) in seconds versus hours for baselines. In a user study on bird identification with synthetic bias, users corrected models in ~2 minutes on average, achieving similar accuracy to slower methods. A case study on skin cancer classification reduced prototypes from 21 to 12 while improving accuracy. Proto-RSet thus enables real-time, interpretable model refinement for non-experts.

## Method Summary
Proto-RSet enables real-time editing of ProtoPNets by approximating the Rashomon set—the collection of all models with similar performance to a reference model. The method freezes the backbone and prototype weights, then approximates the set of possible final linear layer weights as an ellipsoid in weight space. This approximation is based on a quadratic Taylor expansion of the loss around its minimum. To handle memory constraints from the large number of prototypes, the method uses "positive reasoning" to restrict connections between prototypes and classes, reducing the Hessian matrix size from O(m²t²) to O(m²). Users can edit models by intersecting this ellipsoid with constraint hyperplanes (e.g., setting a prototype's weight to zero), then sampling new weights from the resulting set without retraining.

## Key Results
- Users corrected biased bird identification models in ~2 minutes on average, achieving similar accuracy to methods requiring hours of retraining.
- On skin cancer classification, reducing prototypes from 21 to 12 while maintaining/improving accuracy demonstrated practical utility.
- Prototype removal via ellipsoid-hyperplane intersection succeeded in seconds, compared to hours for full retraining baselines.

## Why This Works (Mechanism)
The Rashomon set captures the idea that multiple models can achieve similar performance on a dataset. By approximating this set as an ellipsoid in the final layer's weight space, Proto-RSet enables efficient exploration of alternative models that satisfy user constraints. The quadratic Taylor expansion provides a computationally tractable approximation, while "positive reasoning" makes the Hessian calculation feasible by exploiting the ProtoPNet architecture's structure. This allows real-time model editing by solving geometric intersection problems rather than expensive retraining.

## Foundational Learning

**Rashomon Set**: The set of all models with similar performance (within a tolerance) on a given dataset. *Why needed*: Provides the theoretical foundation for finding alternative models without retraining. *Quick check*: Verify that the ellipsoid approximation captures models within the specified loss threshold.

**Quadratic Taylor Expansion**: Approximating the loss function as a quadratic form around its minimum to create an ellipsoidal confidence region. *Why needed*: Enables tractable computation of the Rashomon set in high-dimensional weight space. *Quick check*: Confirm the approximation is accurate by comparing actual losses of sampled weights to the predicted quadratic form.

**Hessian Matrix**: The matrix of second-order partial derivatives of the loss function with respect to the weights. *Why needed*: Defines the shape of the ellipsoidal Rashomon set. *Quick check*: Ensure the Hessian is positive definite and correctly captures curvature in the loss landscape.

**Ellipsoid-Hyperplane Intersection**: Computing the intersection between an ellipsoid and a hyperplane to enforce user constraints. *Why needed*: Enables efficient prototype removal without retraining. *Quick check*: Verify the intersection is non-empty and produces valid weight vectors.

## Architecture Onboarding

**Component Map**: Backbone -> Prototypes -> Final Linear Layer -> Rashomon Set Approximation -> User Constraints

**Critical Path**: Reference model training → Hessian computation (with positive reasoning) → Ellipsoid approximation → Constraint intersection → Weight sampling

**Design Tradeoffs**: The quadratic approximation trades exactness for computational efficiency, enabling real-time editing at the cost of potential approximation error. Positive reasoning reduces memory requirements but restricts the space of possible models.

**Failure Signatures**: Memory blow-up if positive reasoning isn't implemented correctly; empty set intersection if removing critical prototypes; accuracy drop if the quadratic approximation is poor.

**First Experiments**:
1. Train a reference ProtoPNet on CUB-200 and verify it achieves baseline accuracy.
2. Compute the Rashomon ellipsoid and sample weights to confirm they maintain accuracy within tolerance.
3. Remove a non-critical prototype and verify the new model has zero weight for that prototype while maintaining accuracy.

## Open Questions the Paper Calls Out
None

## Limitations
- The ellipsoid-hyperplane intersection implementation is not fully detailed, relying on external toolboxes.
- The quadratic Taylor expansion may not accurately capture the loss landscape near constraint boundaries.
- The method's effectiveness depends on the Rashomon set being sufficiently large to contain good models after constraints are applied.

## Confidence

**Major Uncertainties:**
The most significant uncertainty lies in the practical implementation of the ellipsoid-hyperplane intersection for prototype removal. While the paper references the Ellipsoidal Toolbox [26], it does not provide complete algorithmic details for sampling from the resulting constrained set, which is critical for the "editing" functionality. Additionally, the accuracy of the Rashomon set approximation depends heavily on the quadratic Taylor expansion assumption, which may not hold for complex loss landscapes near the constraint boundary.

**Confidence Labels:**
- **High Confidence**: The core theoretical framework (ellipsoid approximation, positive reasoning for Hessian compression) and the concept of enabling real-time editing without retraining are well-established and mathematically sound.
- **Medium Confidence**: The experimental results showing rapid editing (seconds) and user study outcomes are compelling, but the lack of detailed implementation specifications for the ellipsoid intersection introduces uncertainty about reproducibility.
- **Medium Confidence**: The claim that the method "finds equally accurate models" is supported by reported accuracies, but the quality of the Rashomon set approximation (i.e., how close the edited models are to the true set of all good models) is not empirically validated beyond loss thresholds.

## Next Checks

1. **Implementation Verification**: Reproduce the prototype removal for a known model on CUB-200, ensuring the removed prototype's weight is exactly zero and accuracy is maintained within the specified loss threshold.

2. **Approximation Quality**: For a small test case (e.g., 2 prototypes), compute the empirical loss of multiple models in the approximated ellipsoid to verify the quadratic Taylor approximation is accurate.

3. **Constraint Flexibility**: Test the system's ability to handle more complex user constraints beyond simple prototype removal (e.g., requiring a prototype to activate for a specific class) to assess the generality of the positive reasoning framework.