---
ver: rpa2
title: Where is the Watermark? Interpretable Watermark Detection at the Block Level
arxiv_id: '2512.14994'
source_url: https://arxiv.org/abs/2512.14994
tags:
- image
- detection
- watermark
- watermarking
- watermarked
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a post-hoc image watermarking method that embeds
  watermark signals into the discrete wavelet transform (DWT) domain using a block-wise
  statistical approach. Unlike traditional schemes that provide only global detection
  scores, the method generates interpretable detection maps revealing which regions
  of an image are watermarked or altered.
---

# Where is the Watermark? Interpretable Watermark Detection at the Block Level

## Quick Facts
- arXiv ID: 2512.14994
- Source URL: https://arxiv.org/abs/2512.14994
- Reference count: 40
- Embeds watermarks in DWT domain using statistical partitioning, enabling interpretable detection maps

## Executive Summary
This paper presents a post-hoc image watermarking method that embeds watermark signals into the discrete wavelet transform (DWT) domain using a block-wise statistical approach. Unlike traditional schemes that provide only global detection scores, the method generates interpretable detection maps revealing which regions of an image are watermarked or altered. The watermark is highly imperceptible and robust to common image manipulations including compression, noise, and blur. It remains detectable even when up to 50% of the image is cropped, with true positive rates reaching 91%. The method is training-free and computationally efficient, using a lightweight detector based on projections in DWT space, while maintaining competitive robustness compared to state-of-the-art post-hoc watermarking approaches.

## Method Summary
The method embeds watermarks by partitioning the DWT coefficient domain into allowed ("green") and disallowed ("red") intervals using a pseudorandom function keyed with a secret. Coefficients in red intervals are perturbed to the center of the nearest green interval during embedding. Detection works by counting the fraction of coefficients in green intervals per block - a significantly elevated proportion indicates watermark presence. Block-specific seeds derived from block content (rounded mean color) enable independent per-block verification and crop-resilient detection. The watermark is embedded in the low-frequency LL band of multi-level DWT for robustness to high-frequency perturbations while maintaining imperceptibility.

## Key Results
- PSNR values >36 dB and SSIM >0.98 demonstrate high imperceptibility
- Robust to JPEG compression, Gaussian noise, and blur while maintaining detection
- Crop-resilient detection achieves TPR >90% at 30% crop and >76% at 50% crop
- Generates interpretable detection maps showing which regions are watermarked or altered

## Why This Works (Mechanism)

### Mechanism 1: Statistical Partitioning of DWT Coefficients
The method partitions the DWT coefficient domain into allowed (green) and disallowed (red) intervals, embedding watermarks by perturbing coefficients in red intervals to green centers. Detection counts green coefficients - elevated proportions (>50%) indicate watermark presence. Natural images have ~50/50 green/red split under any seed, making statistical deviation detectable. This breaks under extreme brightness/contrast changes where coefficient distributions shift.

### Mechanism 2: Block-wise Localization via Seed Derivation
Block-specific seeds derived from rounded mean color enable independent per-block watermark verification. Since seeds derive from block content, detection doesn't require stored metadata - cropped images can be detected via brute-force grid alignment. The seed function must survive common manipulations while preventing attackers from feasibly shifting means without severe visual degradation.

### Mechanism 3: Low-Frequency (LL Band) Embedding for Robustness-Imperceptibility Tradeoff
Embedding in the LL subband provides robustness to high-frequency perturbations (compression, noise, blur) while maintaining imperceptibility. Multi-level DWT spreads embedding perturbations across spatially diffused coefficients. However, semantic/geometric edits affect LL coefficients substantially, intentionally breaking detection for tamper forensics but limiting robustness claims.

## Foundational Learning

- **Discrete Wavelet Transform (DWT)**: Essential for understanding frequency subbands (LL, LH, HL, HH) and multi-level decomposition that enables LL-band embedding tradeoffs. Quick check: If you apply 3 levels of DWT to an 8×8 sub-block, what is the spatial size of the resulting LL subband? (Answer: 1×1)

- **One-Sided Hypothesis Testing**: Detection uses per-block hypothesis tests to distinguish watermarked from non-watermarked blocks based on green-coefficient counts exceeding a threshold. Quick check: For N=144 coefficients per block and significance level α=0.05, what's the approximate threshold for rejecting H₀ (not watermarked)? (Answer: ~82, per Appendix B.3)

- **Pseudorandom Functions (PRF) for Keyed Hashing**: Security relies on PRF unpredictability without the key, preventing forgery. Quick check: Why must the PRF be keyed rather than deterministic from the seed alone? (Answer: Without the key, an attacker could compute the red/green partition and forge watermarks.)

## Architecture Onboarding

- **Component map**: Input image → Channel split (R,G,B) → Partition into m×m blocks → Per-block: compute seed (rounded mean) → Partition into k×k sub-blocks → Apply d-level DWT → Project LL coefficients to nearest green interval → Inverse DWT → Reassemble watermarked image

- **Critical path**: Seed stability (rounded mean color must survive manipulations), interval alignment (DWT coefficient range and interval length must match exactly), hypothesis test threshold calibration (calibrated per dataset to achieve target FPR)

- **Design tradeoffs**: Interval length (larger → more robust but higher visibility), block size (smaller → finer localization but weaker statistical power), sub-block size & DWT levels (k ≥ 2^d), entropy-based filtering (skip low-entropy blocks to avoid visible artifacts)

- **Failure signatures**: False positive clusters in monochromatic regions (mitigated by post-processing low-pass filter), brightness/contrast attacks (break seed recovery and coefficient alignment), seed-collision attacks (many blocks with identical rounded means leak partition statistics)

- **First 3 experiments**: 1) Imperceptibility baseline: Watermark 100 MS-COCO images, compute PSNR/SSIM/LPIPS vs. originals (target PSNR >36, SSIM >0.98). 2) Localization validation: Watermark image, insert non-watermarked region, verify detection map shows red cluster. 3) Cropping robustness: Randomly crop 10-50% of watermarked images, apply brute-force detection, plot TPR vs. crop percentage (target TPR >90% at 30% crop).

## Open Questions the Paper Calls Out

### Open Question 1
Can alternative hashing functions for seed computation improve robustness or security compared to the current rounded mean color approach? The authors acknowledge exploring "more sophisticated hash functions" is left as future work. Evidence needed: Comparative analysis of different hash functions evaluating resistance to forgery and stability under image noise.

### Open Question 2
Does the adaptive strategy of excluding low-entropy image blocks create blind spots where malicious tampering can be concealed? The paper doesn't analyze if low-entropy regions (like clear skies) are vulnerable to undetected manipulation. Evidence needed: Adversarial experiments targeting low-entropy regions to determine if edits evade the localized detection map.

### Open Question 3
How can the block-based DWT framework be adapted to maintain alignment under arbitrary geometric distortions like non-rigid warping or non-90-degree rotations? Current detection relies on fixed grid sensitive to transformations that displace pixels. Evidence needed: Modified detection algorithm capable of registering warped images before applying statistical hypothesis test.

## Limitations

- Security against adaptive attacks is claimed but not rigorously quantified or empirically tested
- Seed stability under extreme brightness/contrast attacks is not fully characterized
- Block-based approach inherently fragile to geometric transformations that displace pixels relative to fixed grid

## Confidence

- **High Confidence**: Imperceptibility results (PSNR/SSIM values), crop-robustness claims (TPR values at specific crop percentages), computational efficiency assertions
- **Medium Confidence**: Statistical mechanism works as described, but natural image distribution assumption (50/50 split) not empirically validated across diverse datasets
- **Low Confidence**: Security against adaptive attacks and practical feasibility of seed-collision attacks in real-world scenarios not quantitatively evaluated

## Next Checks

1. **Security analysis**: Conduct differential attack to measure statistical distinguishability between watermarked and non-watermarked blocks, comparing against theoretical bounds

2. **Seed stability boundary**: Systematically vary brightness/contrast adjustments and measure exact point where seed recovery fails, plotting against perceptual quality metrics

3. **Real-world transferability**: Test watermark detector on images from social media platforms applying compression, resizing, and color space transformations, measuring degradation in detection performance