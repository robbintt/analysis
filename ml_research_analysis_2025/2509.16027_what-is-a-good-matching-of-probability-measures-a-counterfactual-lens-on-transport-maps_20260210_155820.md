---
ver: rpa2
title: What is a good matching of probability measures? A counterfactual lens on transport
  maps
arxiv_id: '2509.16027'
source_url: https://arxiv.org/abs/2509.16027
tags:
- maps
- transport
- counterfactual
- causal
- proposition
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper explores the relationship between transport maps in
  statistics and counterfactual reasoning in causal inference. The authors compare
  three types of transport maps - cyclically monotone, quantile-preserving, and triangular
  monotone (Knothe-Rosenblatt) - and establish conditions under which they coincide.
---

# What is a good matching of probability measures? A counterfactual lens on transport maps

## Quick Facts
- arXiv ID: 2509.16027
- Source URL: https://arxiv.org/abs/2509.16027
- Reference count: 40
- This paper establishes conditions under which three types of transport maps coincide and shows Knothe-Rosenblatt transports are the only class consistently corresponding to counterfactual maps from structural causal models.

## Executive Summary
This paper bridges statistical transport maps and counterfactual reasoning in causal inference by comparing three transport map constructions: cyclically monotone (CM), quantile-preserving (QP), and triangular monotone (Knothe-Rosenblatt/KR). The authors establish precise conditions for when these maps coincide and characterize which SCM structures induce each type of counterfactual map. The key finding is that Knothe-Rosenblatt transports uniquely correspond to counterfactuals from acyclic SCMs, while CM and QP maps face algebraic and structural limitations that prevent consistent causal interpretation.

## Method Summary
The paper uses optimal transport theory to analyze three map types: CM maps computed via linear programming, QP maps as compositions of CM maps with a uniform reference measure, and KR maps approximated through entropic regularization (OT_ε with ε→0). The theoretical framework proves equivalence conditions between these constructions and connects them to structural causal models by examining when SCM counterfactuals satisfy the mathematical properties of each transport type. Computational experiments use discrete measures with 49 support points (7×7 grid) and the Python Optimal Transport (POT) library.

## Key Results
- CM and QP maps coincide only under specific algebraic conditions that exclude non-diagonal transformations
- Knothe-Rosenblatt transports are the only class that consistently corresponds to counterfactual maps from acyclic structural causal models
- Cyclic SCMs produce cyclically monotone counterfactuals, while acyclic SCMs produce Knothe-Rosenblatt counterfactuals
- Quantile-preserving transports require restricted causal graph structures (cyclic or edgeless) to be valid counterfactuals

## Why This Works (Mechanism)
The paper's approach works by establishing mathematical equivalence between transport map properties and causal model structures. Counterfactual reasoning requires deterministic, invertible mappings that preserve causal dependencies, which aligns with the triangular structure of Knothe-Rosenblatt transports. CM and QP maps, while useful for statistical transport, lack the consistent causal semantics needed for counterfactual interpretation due to algebraic constraints and structural limitations in their construction.

## Foundational Learning
- Cyclically Monotone Maps: Transport maps that are gradients of convex functions; needed for optimal transport theory, check by verifying convexity of potential function
- Quantile-Preserving Maps: Compositions of CM maps with reference measure; needed for comparing distributions through common reference, check by verifying composition yields valid transport
- Knothe-Rosenblatt Transports: Triangular monotone maps preserving conditional distributions; needed for causal interpretation, check by verifying triangular structure
- Structural Causal Models: Directed acyclic graphs with functional dependencies; needed for counterfactual reasoning framework, check by verifying graph acyclicity and mechanism specifications
- Entropic Regularization: Smooth approximation of optimal transport; needed for computational efficiency, check by varying ε parameter
- Path Independence: Property required for consistent counterfactuals; needed to ensure causal consistency, check by verifying transport map composition properties

## Architecture Onboarding
Component map: Discrete Measures → CM/QP/KR Maps → Counterfactual Analysis
Critical path: Define measures → Compute transport maps → Verify properties → Characterize causal structure
Design tradeoffs: CM maps offer optimality but limited causal interpretation; KR maps provide causal consistency but may be computationally expensive
Failure signatures: Non-monotonic transport indicates invalid counterfactual; non-convex potential indicates non-CM map; composition failure indicates invalid QP construction
First experiments: 1) Test CM map computation on simple Gaussian examples, 2) Verify KR approximation convergence at different ε values, 3) Check QP composition yields expected algebraic properties

## Open Questions the Paper Calls Out
- What is the precise characterization of SCMs inducing CM counterfactuals? The paper provides necessary conditions but lacks complete classification of required graph structures and mechanisms.
- How do graphical conditions for QP counterfactuals change with non-diagonal transformations Φ? Current results restrict to cyclic/edgeless structures; general case unexplored.
- Do entropic regularization approaches admit clear causal interpretation? Stochasticity from regularization may conflict with deterministic SCM semantics.
- How to extend framework to non-deterministic couplings for counterfactuals? Current focus on deterministic maps leaves stochastic coupling and identifiability challenges unresolved.

## Limitations
- Missing specification of exact source/target measures used in computational examples limits reproducibility
- Algebraic constraints on QP maps restrict valid causal graph structures to specific cases
- Computational complexity of exact CM/KR computations may limit scalability for large problems
- Framework focuses on deterministic transport, leaving stochastic counterfactuals unexplored

## Confidence
- High confidence in theoretical claims: Mathematical proofs establishing transport map equivalences appear rigorous
- Medium confidence in numerical reproducibility: Computational methodology described but lacks complete parameter specifications
- Medium confidence in practical applicability: Theoretical connections compelling but practical examples limited

## Next Checks
1. Implement three transport map constructions using different discrete measure pairs to verify reported behaviors hold across examples
2. Experiment with KR approximation OT_ε at multiple values (10⁻⁸, 10⁻¹⁰, 10⁻¹²) to determine numerical stability threshold
3. Verify QP map composition by checking if CM(p₀,ν)∘CM(p₀,μ)⁻¹ produces cyclically monotone map as expected from Proposition 2.3