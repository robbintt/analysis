---
ver: rpa2
title: 'Integrating Meteorological and Operational Data: A Novel Approach to Understanding
  Railway Delays in Finland'
arxiv_id: '2601.16592'
source_url: https://arxiv.org/abs/2601.16592
tags:
- data
- weather
- delay
- train
- dataset
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces the first integrated dataset combining Finnish
  railway operational data with meteorological observations from 2018-2024, covering
  38.5 million records across 5,915 km of rail network. The dataset aligns train schedules
  and delays with weather data from 209 stations using spatial-temporal matching via
  Haversine distance and includes 28 engineered features spanning operational and
  meteorological variables.
---

# Integrating Meteorological and Operational Data: A Novel Approach to Understanding Railway Delays in Finland

## Quick Facts
- arXiv ID: 2601.16592
- Source URL: https://arxiv.org/abs/2601.16592
- Reference count: 29
- Introduces first integrated Finnish railway-meteorological dataset (2018-2024) achieving 2.73 MAE minutes in delay prediction

## Executive Summary
This study presents the first integrated dataset combining Finnish railway operational data with meteorological observations from 2018-2024, covering 38.5 million records across 5,915 km of rail network. The dataset aligns train schedules and delays with weather data from 209 stations using spatial-temporal matching via Haversine distance and includes 28 engineered features spanning operational and meteorological variables. Analysis reveals seasonal delay patterns with winter months exceeding 25% delay rates and geographic clustering in central and northern Finland. A baseline XGBoost regression experiment achieves a Mean Absolute Error of 2.73 minutes for station-specific delay prediction, demonstrating the dataset's utility for machine learning applications in railway operations research.

## Method Summary
The dataset integrates Finnish railway operational data from Digitraffic API with meteorological observations from FMI's WFS API (2018-2024). Spatial-temporal matching pairs each train station with its nearest environmental monitoring station using Haversine distance, then aligns timestamps via nearest-neighbor matching. Missing weather data is mitigated through a spatial fallback algorithm searching within 50km radius. Feature engineering includes cyclical encoding of temporal variables, computation of station-specific offset targets to isolate local delays from propagated delays, and robust scaling of weather measurements. A baseline XGBoost regression model achieves 2.73 minutes MAE using 19 input features including weather variables and cyclical temporal encodings.

## Key Results
- Dataset covers 38.5 million records across 5,915 km Finnish rail network with 209 weather stations
- Winter months show highest delay rates exceeding 25%, with geographic clustering in central and northern Finland
- Baseline XGBoost achieves 2.73 minutes MAE for station-specific delay prediction using differenceInMinutes_eachStation_offset target
- Spatial fallback reduces missing weather data to 10-20% for most parameters, though precipitation amount remains at 86.91% missing rate

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Spatial-temporal alignment via Haversine distance enables meaningful weather-to-delay associations at the station level.
- Mechanism: Each train station is matched to its geographically nearest environmental monitoring station (EMS) using great-circle distance. Weather observations are then temporally aligned to train records using nearest-neighbor matching within tolerance windows, preserving all train records while attaching contextually relevant weather data.
- Core assumption: Weather conditions within the matched radius and time window are sufficiently representative of conditions affecting train operations at that station.
- Evidence anchors:
  - [section] Section III-A describes the two-stage process: "spatial matching" using Haversine formula (Eq. 3) followed by "temporal alignment" via left join with nearest-neighbor matching.
  - [section] Figure 4 visualizes the spatial matching across Finland's rail network.
  - [corpus] RSTGCN (arXiv:2510.01262) similarly emphasizes spatial relationships for delay prediction using graph structures.
- Break condition: If weather patterns vary significantly at sub-10km scales (e.g., localized microbursts), the nearest-station assumption degrades.

### Mechanism 2
- Claim: Station-specific delay targets (offset variables) improve prediction accuracy by isolating local causal factors from propagated delays.
- Mechanism: The dataset provides `differenceInMinutes_eachStation_offset`, which subtracts inherited delays from upstream stations. This isolates the incremental delay added at each segment, allowing models to learn weather impacts at specific locations rather than accumulating noise from cascading delays.
- Core assumption: Delay propagation follows a predictable additive pattern that can be cleanly decomposed.
- Evidence anchors:
  - [abstract] "A baseline XGBoost regression experiment achieves a Mean Absolute Error of 2.73 minutes for station-specific delay prediction."
  - [section] Figure 8 shows station-specific target achieving MAE of 2.73 vs. 4.21 for cumulative delay target.
  - [corpus] The Dutch railway study (arXiv:2507.11776) uses topological features but does not isolate station-level offsets, limiting direct comparison.
- Break condition: If delays interact nonlinearly (e.g., compound delays from multiple simultaneous disruptions), the linear offset decomposition becomes inaccurate.

### Mechanism 3
- Claim: Spatial fallback with 50km radius mitigates missing weather data without sacrificing representativeness.
- Mechanism: When a meteorological feature is unavailable at the nearest EMS, the algorithm searches within 50km for an alternative station measuring that parameter. This exploits spatial continuity in regional weather phenomena while avoiding systematic feature loss.
- Core assumption: Weather measurements remain spatially correlated within 50km for the parameters of interest.
- Evidence anchors:
  - [section] Section III-B details the radial search algorithm with 50km threshold.
  - [section] Table VII shows post-mitigation missing rates (e.g., precipitation amount still at 86.91% despite fallback, indicating genuine sensor coverage gaps).
  - [corpus] No direct corpus comparison for this specific fallback strategy; neighboring papers focus on model architectures rather than data imputation.
- Break condition: For localized phenomena (thunderstorms, fog patches), 50km fallback may introduce noise rather than signal.

## Foundational Learning

- Concept: **Haversine distance for geospatial matching**
  - Why needed here: Essential for understanding how train stations are paired with weather stations across Finland's 5,915 km network.
  - Quick check question: Given two lat/lon pairs, can you compute the great-circle distance and explain why Euclidean distance is inappropriate?

- Concept: **Cyclical encoding of temporal features**
  - Why needed here: Hour (0-23) and month (1-12) wrap around; raw integers mislead distance-based models about proximity (23:00 vs. 00:00).
  - Quick check question: Why does sine-cosine encoding preserve the circular relationship, and which model families benefit most?

- Concept: **Robust scaling vs. standard normalization**
  - Why needed here: Weather sensors produce outliers (e.g., extreme gusts); RobustScaler uses quartiles to resist distortion.
  - Quick check question: How does the interquartile range differ from standard deviation in handling a dataset with 5% extreme outliers?

## Architecture Onboarding

- Component map:
  - Digitraffic API -> Spatial matching module -> Temporal alignment module -> Missing data handler -> Feature engineering -> Scaling layer -> Model layer

- Critical path:
  1. Acquire train records → 2. Match to nearest EMS → 3. Align timestamps → 4. Apply spatial fallback for missing weather → 5. Compute offset targets → 6. Split before scaling → 7. Fit scaler on train, apply to both → 8. Train model

- Design tradeoffs:
  - **50km fallback radius**: Balances data completeness vs. spatial representativeness; smaller radius increases missingness, larger radius risks irrelevant weather.
  - **Offset vs. cumulative targets**: Offset targets yield better MAE (2.73 vs. 4.21) but require assumption of additive delay propagation.
  - **Retaining raw temporal columns alongside cyclical encodings**: Supports tree-based models (raw) and gradient-based models (encoded) at cost of dimensionality.

- Failure signatures:
  - **Data leakage**: If scaling or imputation computed on full dataset before split, test performance is optimistically biased.
  - **Unrealistic temporal matching**: If time tolerance too loose, weather attached to train records may not reflect actual conditions.
  - **Ignoring delay propagation**: Using cumulative delay target for station-level predictions yields higher MAE and conflates local vs. inherited causes.

- First 3 experiments:
  1. Replicate baseline: Train XGBoost on Oulu station data using `differenceInMinutes_eachStation_offset` with 80/20 split and report MAE; confirm ~2.73 minutes.
  2. Ablate weather features: Remove all meteorological variables and measure MAE degradation to quantify weather contribution.
  3. Test generalization: Train on 2018-2022 data, test on 2023-2024 to assess temporal drift and seasonal robustness.

## Open Questions the Paper Calls Out
None

## Limitations
- Spatial-temporal matching assumes nearest-station weather observations adequately represent conditions affecting train operations without quantitative validation.
- 50km fallback radius is arbitrary without sensitivity analysis and varies in effectiveness across weather parameters (precipitation amount remains at 86.91% missing rate post-mitigation).
- Geographic imbalance in weather station density (fewer stations in northern Finland) could introduce sampling bias in regions with highest delay rates.

## Confidence
- **High confidence**: Dataset construction methodology, feature engineering pipeline, and spatial-temporal matching implementation are well-documented with reproducible code patterns.
- **Medium confidence**: The baseline MAE of 2.73 minutes is reported but lacks full hyperparameter specification and seed values for exact reproduction.
- **Low confidence**: The assumption that 50km spatial fallback preserves weather representativeness for localized phenomena like thunderstorms and fog patches is not empirically validated.

## Next Checks
1. **Spatial representativeness validation**: Compute correlation between weather measurement similarity (Euclidean distance in feature space) and Haversine distance for all station pairs to quantify how quickly weather conditions decorrelate spatially.
2. **Fallback radius sensitivity**: Repeat the baseline experiment with fallback radii of 25km, 50km, and 75km to measure impact on MAE and weather feature coverage.
3. **Temporal alignment tolerance analysis**: Vary the nearest-neighbor time matching window (±5, ±15, ±30 minutes) and measure degradation in prediction accuracy to establish appropriate temporal tolerance thresholds.