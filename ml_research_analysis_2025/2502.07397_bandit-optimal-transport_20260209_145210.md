---
ver: rpa2
title: Bandit Optimal Transport
arxiv_id: '2502.07397'
source_url: https://arxiv.org/abs/2502.07397
tags:
- problem
- which
- regret
- transport
- optimal
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper is the first study of the stochastic bandit optimal
  transport problem, where an agent repeatedly solves a transport problem with unknown
  cost function using bandit feedback. The paper constructs a phase-space representation
  using Fourier analysis to transform the problem into a linear bandit on a Hilbert
  space.
---

# Bandit Optimal Transport

## Quick Facts
- arXiv ID: 2502.07397
- Source URL: https://arxiv.org/abs/2502.07397
- Reference count: 40
- Primary result: First study of stochastic bandit optimal transport with $\tilde{O}(\sqrt{T})$ regret bounds using Fourier analysis and entropic regularization

## Executive Summary
This paper introduces the first theoretical framework for stochastic bandit optimal transport, where an agent learns an unknown cost function through repeated transport problem solutions with bandit feedback. The key innovation is transforming the problem from a duality pairing between functions and measures into a linear bandit on a Hilbert space using Fourier analysis. By exploiting the regularity of entropic optimal transport, the method ensures valid actions throughout learning and achieves regret bounds matching those of linear bandits.

## Method Summary
The algorithm constructs a phase-space representation using Fourier transforms to convert the transport problem into a linear bandit on a Hilbert space. It employs infinite-dimensional least-squares estimators and confidence sets within an Optimism in the Face of Uncertainty framework. The method uses entropic regularization to guarantee valid actions and introduces a basis truncation technique to manage the infinite-dimensional nature of the problem. This allows regret rates to interpolate between $\tilde{O}(\sqrt{T})$ and $\tilde{O}(T)$ depending on the regularity of the cost function.

## Key Results
- Establishes $\tilde{O}(\sqrt{T})$ regret bounds for stochastic bandit optimal transport, matching linear bandit rates
- Introduces Fourier analysis technique to transform transport problems into linear bandits on Hilbert spaces
- Develops basis truncation method that interpolates regret rates based on cost function regularity
- Proves that entropic regularization ensures valid actions throughout learning by forcing smooth transport plans

## Why This Works (Mechanism)

### Mechanism 1: Fourier Transform Reduction
- Claim: The optimal transport problem with measure-valued actions reduces to a standard linear bandit via phase-space transformation
- Mechanism: Fourier transform converts duality pairing $\langle c^*|\pi \rangle$ into inner product $\langle \mathcal{F}c^*|\mathcal{F}\pi \rangle_{L^2}$ in Hilbert space
- Core assumption: Cost function $c^* \in L^2$ and transport plans have $L^2$ densities
- Break condition: Fails if transport plan is singular (lacks $L^2$ density)

### Mechanism 2: Entropic Regularization
- Claim: Entropic regularization guarantees mathematical validity of optimism-selected actions
- Mechanism: Solving entropy-regularized OT produces smooth transport plans with strictly positive density
- Core assumption: Entropic parameter $\varepsilon$ must be managed to ensure absolute continuity
- Break condition: Fails if using Kantorovich solver without entropy for optimism

### Mechanism 3: Basis Truncation
- Claim: Infinite-dimensional costs managed via truncation with regret interpolating by regularity
- Mechanism: Estimate cost function via orthonormal basis coefficients, truncate to finite dimension $n_t$
- Core assumption: Fourier coefficients decay at rate governed by regularity function $\zeta(n)$
- Break condition: Fails if cost function lacks regularity (slow coefficient decay)

## Foundational Learning

- **Duality Pairing vs. Inner Product**
  - Why needed: Core innovation transforms $\langle c|\pi \rangle = \int c d\pi$ to $\langle f|g \rangle = \int f g d\rho$ via Fourier transform
  - Quick check: Explain why Dirac delta fails to have $L^2$ representation and why this matters for confidence sets

- **Optimism in the Face of Uncertainty (OFU)**
  - Why needed: EntUCB algorithm selects actions assuming unknown parameter is as optimistic as statistically plausible
  - Quick check: In this paper, does "optimism" mean assuming transport cost is low or high?

- **Regularity and Compactness in OT**
  - Why needed: Entropic regularization smooths transport map, preventing concentration on measure-zero sets
  - Quick check: If $\varepsilon \to 0$, does transport plan become smoother or more singular?

## Architecture Onboarding

- **Component map**: Fourier features $\mathcal{F}\pi$ -> RLS estimator $\hat{f}_t$ -> Confidence set $C_t(\delta)$ -> Entropic OT solver -> Transport plan $\pi_{t+1}$
- **Critical path**: 
  1. Receive reward $R_t$ for plan $\pi_t$
  2. Update RLS estimator $\hat{f}_t$ using Fourier features
  3. Construct confidence set $C_t(\delta)$ around $\hat{f}_t$
  4. Solve optimistic entropic OT: $\min_{\pi, c \in C_t} \langle c|\pi \rangle + \varepsilon H(\pi|\varrho)$
  5. Output $\pi_{t+1}$
- **Design tradeoffs**: 
  - Low $n_t$: Reduces cost but increases approximation error
  - High $n_t$: Improves approximation but slows learning
  - High $\varepsilon$: Ensures regularity but biases away from true optimum
- **Failure signatures**:
  - Vacuous bounds if cost function is irregular
  - Numerical instability if $\varepsilon$ is too small
  - Action violation if solver outputs non-absolutely continuous plan
- **First 3 experiments**:
  1. Discrete sanity check on finite grid to verify $\tilde{\mathcal{O}}(\sqrt{NT})$ regret
  2. Regularization sensitivity test comparing fixed vs decaying $\varepsilon_t$
  3. Dimensionality scaling test varying $n_t$ on smooth cost functions

## Open Questions the Paper Calls Out

### Open Question 1: Finite-Time Numerical Algorithm
- Question: Can a numerical algorithm output a valid $\epsilon$-optimal transport plan in finitely many steps for the optimism step?
- Basis: Section 6 states implementing Eq 14 requires such an algorithm, absent from literature
- Why unresolved: Standard Sinkhorn converges only in the limit, producing invalid plans at finite steps
- What resolves: Modified Sinkhorn or new method with finite-time convergence guarantees

### Open Question 2: Monge Problem Learnability
- Question: Is the Monge problem of Optimal Transport learnable in a bandit setting?
- Basis: Section 6 and Appendix G.2 identify Monge problem as open direction
- Why unresolved: Monge involves non-linear functionals and map constraints, unclear if phase-space representation applies
- What resolves: Theoretical analysis establishing regret bounds or proof of hardness

### Open Question 3: Action-Set Violations
- Question: How should regret analysis handle action-set violations from approximate numerical solvers?
- Basis: Appendix G.1.2 asks about finitely many violations vs penalized regret framework
- Why unresolved: Theoretical bounds assume valid actions, but approximations may violate marginal constraints
- What resolves: Modified regret definition or algorithm analysis bounding cumulative error

## Limitations

- Requires numerical algorithm for optimism step that outputs valid transport plans in finitely many steps, which is currently absent from literature
- Assumes cost functions have sufficient Fourier coefficient decay, which may not hold for practical applications
- Provides theoretical analysis without empirical validation or experimental results
- Entropic regularization introduces bias that must be carefully managed through scheduling

## Confidence

- **High**: Fourier-based reduction to linear bandits and entropy-regularized optimism mechanism
- **Medium**: Practical implementation details including basis truncation and optimization oracle
- **Low**: Empirical validation claims due to lack of experimental results

## Next Checks

1. Implement discrete linear bandit version of EntUCB to verify $\tilde{\mathcal{O}}(\sqrt{NT})$ regret bound on synthetic cost functions
2. Develop and test practical algorithm for optimism step solving entropy-regularized OT with cost constraints
3. Experimentally evaluate basis truncation method by varying $n_t$ on smooth cost functions to demonstrate regret rate interpolation