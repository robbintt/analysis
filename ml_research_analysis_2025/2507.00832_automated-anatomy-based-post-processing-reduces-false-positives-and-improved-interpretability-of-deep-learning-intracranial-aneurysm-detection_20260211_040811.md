---
ver: rpa2
title: Automated anatomy-based post-processing reduces false positives and improved
  interpretability of deep learning intracranial aneurysm detection
arxiv_id: '2507.00832'
source_url: https://arxiv.org/abs/2507.00832
tags:
- mask
- cpm-net
- d-cnn-tr
- were
- venous
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study demonstrates that automated, anatomy-based post-processing
  can significantly reduce false positives in deep learning intracranial aneurysm
  detection models. The method employs segmented brain, artery, vein, and cavernous
  venous sinus masks to filter model outputs, effectively removing extracranial (27.3-42.3%),
  venous (29.1-56.3%), and arterial (11.9-53.3%) false positives.
---

# Automated anatomy-based post-processing reduces false positives and improved interpretability of deep learning intracranial aneurysm detection

## Quick Facts
- arXiv ID: 2507.00832
- Source URL: https://arxiv.org/abs/2507.00832
- Reference count: 13
- Key outcome: Anatomy-based post-processing reduces false positives by 51.6-70.6% without sacrificing true positives in deep learning intracranial aneurysm detection.

## Executive Summary
This study demonstrates that automated, anatomy-based post-processing can significantly reduce false positives in deep learning intracranial aneurysm detection models. The method employs segmented brain, artery, vein, and cavernous venous sinus masks to filter model outputs, effectively removing extracranial (27.3-42.3%), venous (29.1-56.3%), and arterial (11.9-53.3%) false positives. Using the optimal method (method 5), false positive rates were reduced by 70.6% (89/126) for CPM-Net and 51.6% (94/182) for 3D-CNN-TR without sacrificing true positive detections. This brought the false positive/case rate down from 0.88 to 0.26 for CPM-Net and from 1.27 to 0.62 for 3D-CNN-TR. The approach provides an interpretable, generalizable solution that could improve clinical acceptance of AI-assisted aneurysm detection.

## Method Summary
The method applies anatomy-based post-processing to deep learning aneurysm detection outputs using four key masks: brain mask (TotalSegmentator, dilated 3.6mm), artery-vein segmentation (nnUNet on 4D CTA), and cavernous venous sinus (CVS) mask (ANTs atlas registration, expanded 3.2mm). Method 5, the optimal approach, filters detections by removing those outside the combined brain+CVS mask and those where vein overlap exceeds artery overlap. The pipeline was validated on two models (CPM-Net and 3D-CNN-TR) trained on 1,186 CTAs with 1,373 aneurysms, tested on 143 held-out CTAs with 218 aneurysms.

## Key Results
- False positive rates reduced by 70.6% (89/126) for CPM-Net and 51.6% (94/182) for 3D-CNN-TR
- False positive/case rates improved from 0.88 to 0.26 for CPM-Net and 1.27 to 0.62 for 3D-CNN-TR
- All extracranial false positives removed via brain mask filtering
- No true positives lost using the optimal method (method 5)

## Why This Works (Mechanism)

### Mechanism 1: Extracranial Removal via Brain Mask Dilation
A dilated brain mask removes extracranial false positives by filtering detections outside intracranial anatomy. The brain mask from TotalSegmentator is dilated 3.6mm and merged with a CVS region box, ensuring all intracranial structures are captured.

### Mechanism 2: Venous FP Removal via Artery-Vein Overlap Comparison
Detections overlapping more with vein masks than artery masks are removed, targeting venous false positives. Method 3 (vein > artery overlap) preserves all true positives while Method 2 (any vein overlap) removes 10 TPs per model.

### Mechanism 3: CVS Exclusion to Preserve Para-Sellar TPs
The cavernous venous sinus is subtracted from the vein mask to prevent over-filtering near para-sellar regions where aneurysms commonly occur. CVS is segmented via atlas registration and excluded from venous filtering.

## Foundational Learning

- **3D Bounding Box Detection**: Understanding 3D volumetric intersections is essential for calculating overlap between detection boxes and anatomical masks. Quick check: Given two axis-aligned 3D boxes with center coordinates and sizes, can you compute whether they overlap and by what volume?

- **Medical Image Registration**: CVS mask generation relies on affine registration of an atlas CTA to each patient's CTA using ANTs. Quick check: What is the difference between affine and deformable registration, and when would each be appropriate?

- **Artery-Vein Segmentation on CTA**: The pipeline depends on accurate artery and vein masks from an nnUNet-based algorithm trained on 4D CTA. Quick check: Why might artery-vein separation be challenging on single-phase CTA compared to 4D dynamic CTA?

## Architecture Onboarding

- **Component map**: CTA Input → [Brain Mask (TotalSegmentator)] → [Artery/Vein Masks (nnUNet on 4D CTA data)] → [CVS Mask (ANTs atlas registration + vein overlap)] → DL Model (CPM-Net or 3D-CNN-TR) → Bounding Box Outputs → Post-Processing Rules (Methods 1–5) → Filtered Detections

- **Critical path**: Artery-vein segmentation accuracy is the gating factor—errors cascade to both FP removal and potential TP loss. Brain mask dilation must capture all skull base structures without over-inclusion. CVS registration quality determines para-sellar preservation.

- **Design tradeoffs**: Method 2 vs. Method 3: Method 2 removes more FPs but loses 10 TPs per model; Method 3 preserves all TPs but leaves some venous FPs. Mask dilation amounts (3.6mm brain, 3.2mm CVS) balance TP preservation vs FP filtering. CPM-Net had more venous FPs; 3D-CNN-TR had more arterial FPs—effectiveness is model-dependent.

- **Failure signatures**: Arterial branch points, infundibula, and vessel caliber changes remain as FPs. Non-vascular structures like choroid plexus and pineal gland are only partially removed. Poor artery-vein segmentation near skull base reduces method effectiveness.

- **First 3 experiments**:
  1. Reproduce the pipeline on a held-out sample: Run both models with confidence threshold 0.8, apply Method 5, and verify FP/case rates match reported values (0.26 for CPM-Net, 0.62 for 3D-CNN-TR).
  2. Ablation by mask: Disable each mask (brain, vein, CVS) individually to quantify contribution; expect brain mask to remove ~30–40% of FPs and vein-based filtering to remove an additional ~30%.
  3. Sensitivity analysis on dilation parameters: Test brain mask dilation at 2.0mm, 3.6mm, and 5.0mm to measure tradeoff between FP reduction and TP preservation.

## Open Questions the Paper Calls Out

- **Refining post-processing for non-pathologic arterial structures**: Can automated post-processing be refined to effectively distinguish non-pathologic arterial structures, such as branchpoints and infundibula, from true aneurysms? Current anatomy-based masks failed to filter these specific arterial false positives that closely mimic aneurysm morphology.

- **Generalizability to other architectures**: Is this anatomy-based post-processing method generalizable to a broader range of deep learning detection architectures? The study validated the pipeline using only CPM-Net and 3D-CNN-TR; effectiveness on other model types remains unconfirmed.

- **Large-scale multi-center validation**: Does the pipeline maintain its performance and robustness when deployed on large-scale, multi-center datasets? The evaluation relied on 143 held-out cases from a single hospital system, which may not capture full clinical variability.

## Limitations
- Method depends critically on accurate artery-vein segmentation, which is challenging on single-phase CTA data
- Assumes venous structures never host true aneurysms, potentially problematic in rare cases
- CVS registration quality may vary across populations and scanning protocols
- Fixed dilation parameters (3.6mm brain, 3.2mm CVS) may not generalize optimally across all acquisition parameters

## Confidence
- **High confidence**: Extracranial FP reduction via brain mask dilation (direct evidence showing all extracranial FPs removed)
- **Medium confidence**: Venous FP reduction mechanism (methodologically sound but limited corpus support for specific heuristic)
- **Medium confidence**: CVS exclusion preserves para-sellar TPs (plausible but no direct corpus evidence)

## Next Checks
1. **Ablation study on mask contributions**: Systematically disable each anatomical mask (brain, vein, CVS) to quantify individual impact on FP reduction and TP preservation.
2. **Cross-population generalization**: Apply the method to CTAs from different institutions/protocols to test robustness of CVS registration and segmentation accuracy.
3. **Edge case analysis**: Manually review all TPs that overlap with vein masks to identify any false negatives caused by the vein > artery overlap rule, particularly at arterial-venous junctions.