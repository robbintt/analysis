---
ver: rpa2
title: 'ProRCA: A Causal Python Package for Actionable Root Cause Analysis in Real-world
  Business Scenarios'
arxiv_id: '2503.01475'
source_url: https://arxiv.org/abs/2503.01475
tags:
- causal
- anomaly
- root
- profit
- node
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper presents ProRCA, a Python package for root cause analysis
  (RCA) in complex systems. ProRCA addresses the challenge of identifying multi-hop
  causal pathways from observed anomalies back to their initial triggers, which traditional
  correlation-based RCA methods often fail to achieve.
---

# ProRCA: A Causal Python Package for Actionable Root Cause Analysis in Real-world Business Scenarios

## Quick Facts
- **arXiv ID**: 2503.01475
- **Source URL**: https://arxiv.org/abs/2503.01475
- **Reference count**: 14
- **Primary result**: ProRCA accurately identifies multi-hop causal pathways from anomalies to root causes in synthetic retail data using a combined scoring metric and DFS.

## Executive Summary
ProRCA is a Python package designed to perform root cause analysis (RCA) in complex systems by identifying multi-hop causal pathways from observed anomalies back to their initial triggers. Unlike traditional correlation-based methods, ProRCA leverages causal inference techniques, specifically the DoWhy library, extended with a novel combined node score, depth-first search (DFS) for pathway discovery, and a path significance evaluation metric. Experiments on a synthetic retail dataset demonstrate ProRCA's effectiveness in accurately identifying correct multi-hop causal pathways for various injected anomaly types, with high Combined Scores for all nodes in the pathways.

## Method Summary
ProRCA uses the DoWhy causal inference library as its foundation, extending it with three key innovations: a combined node score that fuses conditional anomaly scores and noise contribution, a depth-first search algorithm to trace causal chains from observed anomalies upstream through a Directed Acyclic Graph (DAG), and a path significance evaluation metric that ranks identified paths based on noise consistency. The method requires a pre-defined DAG structure and performs anomaly detection using IQR-based methods before applying causal analysis to identify the root causes.

## Key Results
- ProRCA accurately identified correct multi-hop causal pathways for four different anomaly types (ExcessiveDiscount, COGSOverstatement, FulfillmentSpike, and ReturnSurge).
- Combined Scores for all nodes in the pathways ranged from 0.8166 to 0.9086, indicating high accuracy.
- The method successfully demonstrated its ability to provide comprehensive and actionable root cause analysis in complex, data-intensive environments.

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: ProRCA identifies root causes by reconstructing full causal chains rather than isolating single anomalous nodes.
- **Mechanism**: The system utilizes a Depth-First Search (DFS) algorithm starting from an observed anomaly (target node). It traverses upstream through the Directed Acyclic Graph (DAG), filtering paths based on a "Combined Score" threshold. A path is accepted only if intermediate nodes meet a relaxed threshold (βθ) and the terminal (root) node meets a strict threshold (θ).
- **Core assumption**: The causal structure (DAG) is known, accurate, and acyclic; anomalies propagate predictably along these defined edges.
- **Evidence anchors**:
  - [abstract]: Mentions "depth-first search (DFS) for pathway discovery" to reveal "multi-hop causal chains."
  - [section 4.2.2]: Explicitly defines the DFS algorithm and acceptance criteria (Eq. 4-6) for path discovery.
  - [corpus]: "Graph-Free Root Cause Analysis" highlights that assuming the root cause has the highest anomaly score fails during propagation, validating the need for pathway tracing.
- **Break condition**: If the provided DAG is incomplete or contains incorrect edges (e.g., confounding paths omitted), the DFS will terminate prematurely at a proxy node rather than the true root trigger.

### Mechanism 2
- **Claim**: A combined scoring metric improves root cause ranking accuracy over single-metric heuristics.
- **Mechanism**: The package calculates a `CombinedScore(v)` as a weighted sum (α=0.7) of the "Conditional Anomaly Score" (structural deviation) and "Noise Contribution" (intrinsic mechanism deviation). This fusion aims to balance the magnitude of the observed error against the statistical likelihood of it being an anomaly.
- **Core assumption**: High anomaly scores and high noise contributions are positively correlated with causal responsibility in this specific dataset context.
- **Evidence anchors**:
  - [abstract]: States the package extends DoWhy with a "novel combined node score."
  - [section 4.2.1]: Defines the Combined Score formula (Eq. 3) integrating structural and noise metrics.
  - [corpus]: "Unifying Explainable Anomaly Detection..." suggests combining detection and localization is a distinct challenge, supporting the need for composite scoring.
- **Break condition**: If a node has high noise but low structural impact (or vice versa) and the weight α is inappropriate for the domain, the node may be filtered out erroneously during the DFS traversal.

### Mechanism 3
- **Claim**: Path Significance Evaluation (PSE) distinguishes true causal propagation from coincidental correlation.
- **Mechanism**: After DFS identifies candidate paths, ProRCA ranks them using a `Significance` score. This score aggregates the average noise at the terminal node with the "Causal Consistency"—measured by the Pearson correlation of noise vectors between adjacent nodes in the path.
- **Core assumption**: True causal propagation manifests as correlated noise patterns along the causal chain; spurious paths lack this noise coherence.
- **Evidence anchors**:
  - [abstract]: Mentions a "path significance evaluation metric" to rank causes by overall significance.
  - [section 4.2.3]: Details the Significance metric (Eq. 7-10) combining terminal noise and path consistency.
  - [corpus]: Weak/missing explicit evidence for noise-correlation ranking in related work; this appears to be ProRCA's specific heuristic.
- **Break condition**: If independent anomalies occur simultaneously on a spurious path, random noise correlations might falsely elevate the path's significance ranking.

## Foundational Learning

- **Concept**: **Structural Causal Models (SCMs) & DAGs**
  - **Why needed here**: ProRCA is not model-free; it requires a pre-defined Directed Acyclic Graph to know which variables are parents (causes) and children (effects). The entire DFS traversal relies on this structure.
  - **Quick check question**: Can you sketch the relationship between `Unit Cost`, `Sales`, and `Profit` such that `Profit` is a child of both?

- **Concept**: **Noise Attribution (Heteroscedasticity)**
  - **Why needed here**: ProRCA leverages DoWhy's ability to separate the variance of a node into "explained" (by parents) and "noise" (intrinsic). A root cause is identified when the "noise" component is anomalously high, indicating a break in the expected data-generation process.
  - **Quick check question**: If `Profit` drops because `Sales` dropped, is that a noise anomaly in `Profit`, or is it inherited from `Sales`?

- **Concept**: **Depth-First Search (DFS) in Graphs**
  - **Why needed here**: Unlike correlation matrices which show flat associations, DFS allows the algorithm to walk "backwards" step-by-step from a symptom (e.g., Low Profit Margin) to a distant trigger (e.g., Excessive Discount).
  - **Quick check question**: Why would a Breadth-First Search (BFS) potentially be less efficient or effective if you are looking for the *origin* of a fault rather than all immediate neighbors?

## Architecture Onboarding

- **Component map**: Data Aggregation -> Anomaly Date Detection -> SCM Fitting (DoWhy) -> Noise/Score Calculation -> DFS Path Extraction -> Path Significance Ranking.
- **Critical path**: Data Aggregation → Anomaly Date Detection → SCM Fitting (DoWhy) → Noise/Score Calculation → DFS Path Extraction → Path Significance Ranking.
- **Design tradeoffs**:
  - **DAG vs. Discovery**: The package relies on a known DAG (Assumption) rather than automated discovery. This increases precision if domain knowledge is good but fails if the system topology changes dynamically.
  - **Threshold Sensitivity**: The `min_score_threshold` (e.g., 0.3 vs 0.8) trades off between finding *all* potential paths (high recall, more noise) vs. finding only the most likely path (high precision, risk of missing root cause).
  - **Model Complexity**: DoWhy fits 9 models per node; this provides robustness but increases computational overhead compared to simple linear regression.
- **Failure signatures**:
  - **Empty Path Output**: Usually indicates the `min_score_threshold` is too high for the detected signal strength.
  - **Wrong Root Node**: Often suggests the DAG is missing the true parent, forcing the DFS to backtrack up a spurious correlation.
  - **Path Flooding**: Occurs if the anomaly threshold is too low, resulting in many unrelated nodes being flagged as part of the chain.
- **First 3 experiments**:
  1. **Validation on Known Anomalies**: Run the provided synthetic retail dataset. Verify that the DFS returns `PROFIT MARGIN -> NET SALES -> DISCOUNT` for the "ExcessiveDiscount" injection date to confirm the pipeline is working.
  2. **Threshold Sensitivity Analysis**: Toggle `min_score_threshold` from 0.3 to 0.8. Observe how the number of returned paths decreases and check if the "true" path remains ranked #1.
  3. **DAG Ablation Test**: Deliberately remove a critical edge (e.g., `UNIT COST -> COGS`) from the input DAG and verify that ProRCA either fails to find a path or produces a significantly lower Significance score for the resulting broken path.

## Open Questions the Paper Calls Out
None

## Limitations
- ProRCA's effectiveness is critically dependent on having a complete and accurate pre-defined DAG structure; missing or incorrect edges can lead to false negatives or identifying proxy causes instead of true root causes.
- The performance of the Combined Score weighting (α=0.7) and the Path Significance Evaluation heuristic are domain-dependent and not extensively validated beyond the synthetic retail scenario.
- The method's sensitivity to the `min_score_threshold` parameter requires careful calibration per use case, as it directly impacts the balance between recall and precision.

## Confidence
- **High Confidence**: The mechanism of using DFS to trace multi-hop causal chains in a known DAG (Mechanism 1) is sound and well-supported by the synthetic experiment results showing accurate pathway identification.
- **Medium Confidence**: The efficacy of the Combined Score (Mechanism 2) for ranking nodes is plausible given the problem framing, but its optimality and generalizability beyond the specific retail anomaly types tested are uncertain.
- **Medium Confidence**: The Path Significance Evaluation (Mechanism 3) using noise correlation is a novel heuristic for ranking paths; while logical, its performance in filtering spurious paths versus true causal chains in noisy, real-world data requires further validation.

## Next Checks
1. **Real-world Dataset Validation**: Apply ProRCA to a complex, real-world business dataset (e.g., IT operations logs, supply chain data) with known or semi-known anomalies to assess performance outside the controlled synthetic environment and validate the DAG assumption.
2. **DAG Structure Sensitivity Test**: Systematically evaluate ProRCA's performance on datasets where the true DAG is known but is deliberately perturbed (edges added, removed, or weights altered) to quantify the impact of structural errors on root cause identification accuracy.
3. **Hyperparameter Robustness Analysis**: Conduct a comprehensive sensitivity analysis across a wider range of values for `min_score_threshold` and the Combined Score weight (α) on multiple synthetic anomaly scenarios to determine the stability and optimal settings for different anomaly severities and data characteristics.