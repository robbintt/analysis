---
ver: rpa2
title: 'An in depth look at the Procrustes-Wasserstein distance: properties and barycenters'
arxiv_id: '2507.00894'
source_url: https://arxiv.org/abs/2507.00894
tags:
- distance
- point
- wasserstein
- problem
- barycenters
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper establishes Procrustes-Wasserstein (PW) as a valid distance
  on a quotient space of discrete probability measures, proving it is invariant to
  rigid transformations while preserving optimal transport properties. The authors
  introduce PW barycenters, extending optimal transport barycenter theory, and provide
  algorithms for their computation with respect to both support locations and probability
  weights.
---

# An in depth look at the Procrustes-Wasserstein distance: properties and barycenters

## Quick Facts
- arXiv ID: 2507.00894
- Source URL: https://arxiv.org/abs/2507.00894
- Authors: Davide Adamo; Marco Corneli; Manon Vuillien; Emmanuelle Vila
- Reference count: 26
- Primary result: Procrustes-Wasserstein distance is a valid metric on a quotient space of discrete probability measures, invariant to rigid transformations while preserving optimal transport properties.

## Executive Summary
This paper establishes Procrustes-Wasserstein (PW) as a valid distance on a quotient space of discrete probability measures, proving it is invariant to rigid transformations while preserving optimal transport properties. The authors introduce PW barycenters, extending optimal transport barycenter theory, and provide algorithms for their computation with respect to both support locations and probability weights. Experimental results demonstrate PW's superior performance in point cloud alignment and clustering tasks compared to standard Wasserstein and Gromov-Wasserstein methods, achieving higher ARI (0.77) and NMI (0.84) in MNIST clustering. The framework is validated through an archaeological application tracking morphological evolution of sheep astragalus bones, showcasing PW's ability to produce geometrically faithful interpolations between shapes.

## Method Summary
The method computes PW distance through alternating optimization between transport plans and orthogonal alignment, solved via EMD and SVD respectively. Barycenters are computed using Newton updates for support locations and exponential gradient updates for weights. The framework handles discrete measures as point clouds with associated probability weights, incorporating preprocessing steps like centering and scaling. The POT toolbox provides OT solvers, while Fiedler-W initialization consistently outperforms alternatives in practice.

## Key Results
- PW distance is a valid metric on quotient space Md/∼ with PW₂ ≤ W₂
- PW barycenters admit closed-form Newton updates for support locations
- MNIST clustering achieves ARI 0.77 and NMI 0.84, outperforming Wasserstein and Gromov-Wasserstein
- Archaeological application successfully tracks morphological evolution of sheep astragalus bones

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Alternating optimization between transport plan and orthogonal alignment converges to valid point cloud matching, though initialization quality critically affects convergence.
- **Mechanism:** The joint minimization over (P, Γ) decouples into two tractable subproblems: (1) For fixed P, solve standard Wasserstein transport via EMD (linear program); (2) For fixed Γ, solve orthogonal Procrustes via SVD decomposition Y^T Γ^T X = UΣV^T, yielding P = UV^T. Iterating these steps produces stationary points.
- **Core assumption:** The alternating scheme reaches good local minima; this depends heavily on initialization quality.
- **Evidence anchors:** [abstract]: "Algorithms to solve the PW problems already exist, however we extend the PW framework by discussing and testing several initialization strategies"; [section 4.1, Figure 2]: Convergence heatmaps show Fiedler-W initialization succeeds consistently across 50 perturbed shapes, while UPCA-W fails frequently in 3D; [corpus]: Corpus paper "Procrustes Wasserstein Metric" (arxiv 2503.16580) provides Benamou-Brenier formulation with similar invariance but different computational approach; Even et al. (2024) cited in related work provides convergence guarantees only under restrictive assumptions (equal point counts, Gaussian noise, permutation model).
- **Break condition:** Poor initialization Γ0 causes convergence to wrong correspondences (blue cells in Figure 2); no theoretical guarantee of global optimum.

### Mechanism 2
- **Claim:** Defining PW on a quotient space of measures (equivalence classes under rigid transformations and permutations) yields a proper metric while achieving isometry invariance.
- **Mechanism:** The equivalence relation μX1 ∼ μX2 iff ∃P ∈ O(d), ∃σ ∈ S(n): X1 = σ(X2)P and p1 = σ(p2) identifies all rotated/reflected/permuted versions of a shape. The PW distance PW2(μX, μY) := min_{P∈O(d)} W2(μX, μYP) then measures the minimal Wasserstein cost after optimal alignment, guaranteed to satisfy identity, symmetry, and triangle inequality on Md/∼.
- **Core assumption:** Semantic shape equivalence under rigid pose changes; transformations preserve intrinsic geometry.
- **Evidence anchors:** [abstract]: "Due to its invariance to rigid transformations such as rotations and reflections... show that over that space PW actually is a distance"; [section 2, Theorem 2.1]: Formal proof that PW2 is a distance on Md/∼; Corollary 2.2 proves PW2 ≤ W2 (PW never exceeds Wasserstein); [corpus]: Limited direct corpus validation; related work Alvarez-Melis et al. (2019) extends to broader invariance classes but without metric guarantees.
- **Break condition:** When shapes differ by non-rigid deformations or topological changes, the rigid-isometry assumption fails; PW cannot model elastic distortions.

### Mechanism 3
- **Claim:** Barycenter support locations admit closed-form Newton updates X(k+1) = diag(p^(-1)) Γ*YP*, enabling iterative barycenter computation.
- **Mechanism:** The objective g(X) = ⟨u,p⟩ - 2⟨X, Γ*YP*⟩F has gradient ∇Xg = 2 diag(p)X - 2Γ*YP* and constant positive-definite Hessian HXg = 2 diag(p). The Newton step collapses to a weighted average: each barycenter point becomes the transport-weighted centroid of aligned source points.
- **Core assumption:** Fixed (Γ*, P*) from individual PW solves during the update step; alternating optimization converges despite non-convexity.
- **Evidence anchors:** [section 3.1]: Explicit acknowledgment that "the best we can do is to look for local minima via Newton-Raphson" due to non-convexity; [section 3.1]: Geometric interpretation—"diag(p^(-1))Γ* computes weighted barycenters of points in Y, with weights defined by the optimal transport plan"; [corpus]: Corpus paper "Robust Barycenters of Persistence Diagrams" discusses similar assignment arithmetic mean strategies but for topological data.
- **Break condition:** Non-convex landscape yields local minima; input measures with fundamentally different structures produce uninterpretable barycenters.

## Foundational Learning

- **Concept: Wasserstein Distance and Kantorovich Formulation**
  - **Why needed here:** PW extends Wasserstein by jointly optimizing over transport plans AND rigid alignments. Without understanding W2 as min_{Γ∈Π(p,q)} ⟨C,Γ⟩F, the PW formulation is opaque.
  - **Quick check question:** Given two discrete measures μX = Σp_i δx_i and μY = Σq_j δy_j, write W2²(μX, μY) as a linear program. What constraints must Γ satisfy?

- **Concept: Orthogonal Procrustes Problem and SVD Solution**
  - **Why needed here:** The inner optimization min_{P∈O(d)} W2(μX, μYP) reduces to the classical Procrustes problem, solved via SVD. Algorithm 1 line 10 (UΣV^T ← SVD(Y^T Γ^T X)) is incomprehensible without this background.
  - **Quick check question:** Given matrices A ∈ R^(n×d) and B ∈ R^(m×d), how do you find the rotation matrix P that minimizes ‖A - BP‖²_F? What if reflections are also allowed?

- **Concept: Quotient Spaces and Equivalence Relations in Metric Geometry**
  - **Why needed here:** PW is only a valid distance on Md/∼, not on Md. The paper's main theoretical contribution (Theorem 2.1) requires understanding why quotienting is necessary (two rotated copies of a shape should have distance zero).
  - **Quick check question:** Why does PW2(μX, μY) = 0 fail to imply μX = μY in the original space Md? What does the equivalence class [μX] represent?

## Architecture Onboarding

- **Component map:** Preprocessing (center/scale) -> Initialization (Fiedler-W recommended) -> PW solver (Algorithm 1: EMD -> SVD iteration) -> Barycenter optimizer (Algorithm 2: outer loop with Newton updates) -> Weight optimizer (Algorithm 3: dual LP formulation)

- **Critical path:** 1. Normalization — Skipping centering/scaling breaks invariance properties; 2. Initialization Γ0 — Determines whether Algorithm 1 converges to correct correspondence (see Figure 2 red/blue patterns); 3. Convergence checks — Both inner PW solver and outer barycenter loop need stopping criteria

- **Design tradeoffs:** Initialization: Fiedler-W (fast, robust for structured shapes) vs. GW methods (more general, O(n²) cost prohibitive for large clouds); Support size n: Larger n → finer barycenter resolution but O(n²) per PW solve; paper uses 10k vertices for bone data; Entropic regularization ε: Speed vs. matching precision

- **Failure signatures:** Correspondence failure: Points matched to wrong locations (visualize transport plan as edge colors); Local minimum trap: Distance plateaus without reaching zero for identical shapes under rotation; Degenerate barycenter: Output collapses to unrecognizable shape—check if input measures share underlying structure; Numerical instability: Very small probability masses cause diag(p^(-1)) explosion

- **First 3 experiments:** 1. Validate PW solver: Take a point cloud, apply random rotation/reflection, verify PW distance ≈ 0 while Wasserstein distance is large; 2. Initialization comparison: Replicate Figure 2 on your own shape class—confirm Fiedler-W success rate >90%; 3. Barycenter sanity check: Compute PW barycenter of 10 MNIST "1" digits; verify output resembles an average "1" shape (compare to Figure 3 centroids)

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** How can the Procrustes-Wasserstein framework be theoretically extended to incorporate invariance to translation and scaling directly within the optimization problem?
- **Basis:** [explicit] Page 5 states, "We leave for future works extensions of the PW framework accounting for translations and scaling."
- **Why unresolved:** The current method relies on a pre-processing step where point clouds are centered and scaled to a unit ball, rather than treating these transformations as intrinsic parameters of the distance metric.
- **Evidence:** A formal modification of Theorem 2.1 and Algorithm 1 that optimizes over translation vectors and scaling factors alongside the orthogonal matrix $P$, validated on unnormalized data.

### Open Question 2
- **Question:** Under what geometric conditions does the UPCA-W initialization strategy fail, and can it be modified to provide robust convergence for 3D data?
- **Basis:** [explicit] Page 6 notes, "We leave a further investigation of this approach [UPCA-W] for future works" after observing it "does not demonstrate effectiveness, particularly in the 3D case."
- **Why unresolved:** The method was empirically observed to fail in 3D scenarios (Figure 2) compared to Fiedler-W, but the specific geometric causes (e.g., axis ambiguity) were not analyzed.
- **Evidence:** A theoretical analysis relating principal component instability to convergence failure, followed by an improved UPCA-W algorithm that matches the convergence rates of Fiedler-W.

### Open Question 3
- **Question:** Does the entropic regularization of the PW barycenter provide sufficient numerical stability and smoothness for application to large-scale, dense datasets?
- **Basis:** [explicit] Page 9 suggests, "Future works could explore denser formulations of the barycenter problem (via entropic regularization) leading to smoother solutions and broader applicability to large-scale datasets."
- **Why unresolved:** While Appendix C derives the regularized update, the paper only validates the discrete version on larger tasks (MNIST, bones), leaving the scalability and "smoothness" benefits of the regularized version unverified.
- **Evidence:** Computational complexity benchmarks and visual quality assessments of regularized PW barycenters on point clouds with significantly higher vertex counts ($n > 10^4$).

## Limitations
- No theoretical convergence guarantees for the alternating optimization scheme beyond empirical validation
- Barycenter optimization is non-convex, yielding only local minima with no quality bounds
- Initialization sensitivity severely impacts convergence, with standard methods like UPCA-W failing completely in 3D
- Archaeological application lacks quantitative validation beyond visual inspection of shape evolution

## Confidence

- **High confidence**: The PW distance is a valid metric on the quotient space (Theorem 2.1) and satisfies PW₂ ≤ W₂. The alternating algorithm's mechanics are well-specified, and initialization strategies are empirically validated.
- **Medium confidence**: PW barycenter existence and basic properties follow from optimal transport theory, but the non-convexity of support optimization means results depend heavily on initialization. Clustering performance claims (ARI 0.77, NMI 0.84) are specific to the MNIST subset tested.
- **Low confidence**: Convergence rates for both PW solver and barycenter optimization are unspecified. The archaeological application, while visually compelling, lacks quantitative validation beyond visual inspection of shape evolution.

## Next Checks

1. **Convergence verification**: Reproduce Figure 2 initialization comparison on a new shape class (e.g., different animal bones or object categories). Test Fiedler-W against UPCA-W and random initialization across 50 trials, measuring success rate and final PW distance.

2. **Barycenter stability analysis**: Compute PW barycenters for 10-20 MNIST digits of the same class (e.g., all "1"s). Repeat with different initializations and measure barycenter consistency using Fr\'echet variance or visual similarity metrics. Verify the closed-form Newton update produces stable, interpretable averages.

3. **Robustness to noise and outliers**: Take a clean point cloud, add Gaussian noise or outliers, and measure how PW distance and barycenter quality degrade compared to standard Wasserstein. This validates the practical utility of rigid transformation invariance in real archaeological or medical imaging scenarios.