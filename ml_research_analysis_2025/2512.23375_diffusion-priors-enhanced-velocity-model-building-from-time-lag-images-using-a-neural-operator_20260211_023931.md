---
ver: rpa2
title: Diffusion priors enhanced velocity model building from time-lag images using
  a neural operator
arxiv_id: '2512.23375'
source_url: https://arxiv.org/abs/2512.23375
tags:
- velocity
- neural
- inversion
- operator
- diffusion
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a novel velocity model building framework that
  combines neural operators with diffusion models to efficiently reconstruct high-resolution
  subsurface velocity models. The approach leverages a neural operator to rapidly
  generate time-lag RTM images from velocity models, serving as a differentiable surrogate
  for modeling and migration operations.
---

# Diffusion priors enhanced velocity model building from time-lag images using a neural operator

## Quick Facts
- arXiv ID: 2512.23375
- Source URL: https://arxiv.org/abs/2512.23375
- Authors: Xiao Ma; Mohammad Hasyim Taufik; Tariq Alkhalifah
- Reference count: 20
- Primary result: Achieves 300-fold acceleration in velocity model building while improving resolution through neural operator + diffusion model integration

## Executive Summary
This paper presents a novel framework for high-resolution velocity model building that combines neural operators with diffusion models. The approach uses a neural operator as a differentiable surrogate for forward modeling and migration operations, enabling gradient-based velocity inversion from time-lag RTM images. A diffusion model is incorporated as regularization to suppress artifacts and recover high-frequency components. The method demonstrates improved velocity model quality and data fitting performance compared to neural operator-only approaches on both synthetic and field datasets.

## Method Summary
The framework trains a neural operator to map velocity models to time-lag RTM images, then uses this operator in an iterative inversion loop where gradients are computed via automatic differentiation. An unconditional diffusion model is trained on high-resolution velocity distributions and applied as a single-step regularization during inversion. The neural operator provides rapid forward modeling (~300x speedup) while the diffusion model conditions the velocity updates to suppress artifacts and enhance high-wavenumber recovery. The method is demonstrated through synthetic experiments and field data applications using patch-based processing.

## Key Results
- Neural operator achieves ~300-fold acceleration in forward modeling while maintaining accuracy
- Time-lag RTM images enable superior recovery of mid-wavenumber velocity components compared to zero-lag images
- Diffusion model regularization effectively suppresses inversion artifacts and stabilizes reconstruction
- Field data application demonstrates practical utility on real seismic datasets

## Why This Works (Mechanism)

### Mechanism 1
A neural operator serves as a differentiable surrogate for the combined forward-modeling-and-migration operation, enabling gradient-based velocity inversion. The neural operator learns the mapping from (true velocity, migration velocity) → time-lag RTM images. During inversion, the true velocity channel is replaced with the current velocity estimate, and automatic differentiation computes gradients of the image misfit with respect to this velocity. Iterative updates minimize the discrepancy between predicted and observed time-lag images.

### Mechanism 2
Time-lag RTM extended images provide richer velocity information than zero-lag images alone, enabling better recovery of mid-wavenumber components. The time-shift imaging condition R(r, τ) correlates forward- and backward-propagated wavefields with temporal shift τ. Non-zero τ values reveal wavefield misalignment caused by velocity errors, encoding kinematic information that zero-lag images suppress. This additional information guides velocity updates beyond reflectivity alone.

### Mechanism 3
A diffusion model trained on high-resolution velocity distributions can regularize inversion by injecting learned structural priors, suppressing artifacts and recovering high-frequency details. An unconditional DDPM learns the distribution of plausible high-resolution velocity models. During inversion, the neural operator's output velocity seeds the reverse diffusion process (single-step sampling). The denoiser refines the velocity toward the learned distribution, suppressing artifacts while preserving physically consistent high-wavenumber structures.

## Foundational Learning

- **Fourier Neural Operators (FNO)**: Uses Fourier layers to capture global spectral correlations in velocity-to-image mapping, enabling resolution-independent learning and efficient surrogate modeling. Quick check: Can you explain why FNO operates in the Fourier domain and what advantage this provides for learning PDE solution operators?

- **Denoising Diffusion Probabilistic Models (DDPM)**: The diffusion model learns the prior distribution of velocity models. Understanding the forward/reverse process and noise schedule is essential for interpreting how single-step conditioning works. Quick check: What is the difference between unconditional and conditional diffusion sampling, and how does this paper achieve conditioning without explicit conditional training?

- **Time-lag Reverse Time Migration (RTM)**: The paper's core innovation uses time-lag RTM images as the observable data for inversion. Understanding the imaging condition explains why τ ≠ 0 provides velocity information. Quick check: Why does a non-zero time lag in the imaging condition reveal velocity errors, and what information does it encode that zero-lag RTM suppresses?

## Architecture Onboarding

- **Component map**: Migration velocity -> Neural Operator (FNO encoder → U-Net with ResNet-101 backbone → FNO decoder) -> Time-lag RTM images -> Inversion loop with diffusion regularization -> Updated velocity model

- **Critical path**: 1) Generate synthetic training data: velocity models → seismic simulation → time-lag RTM with smoothed migration velocity 2) Train neural operator on (velocity pairs, time-lag images) pairs 3) Train unconditional diffusion model on high-resolution velocities 4) Inversion: Initialize with migration velocity → iterate neural operator gradient updates + single-step diffusion refinement

- **Design tradeoffs**: Single-step diffusion sampling vs. full reverse process (4x faster but potentially weaker prior guidance); Time-lag vs. zero-lag RTM (richer information but requires more storage/computation); Patch-based inversion for field data (enables large-scale application but may introduce boundary artifacts)

- **Failure signatures**: Noisy artifacts in neural-operator-only inversion; poor boundary accuracy due to RTM geometric limitations; salt flank imaging failure when insufficient velocity contrast exists; divergence if migration velocity is severely inaccurate

- **First 3 experiments**: 1) Forward modeling validation: Pass test-set velocity pairs through trained neural operator; compare predicted time-lag images against conventional RTM 2) Ablation on time-lag vs. zero-lag: Run inversion with τ = 0 only vs. full time-lag images; compare wavenumber spectrum recovery 3) Diffusion regularization effect: Run inversion with and without diffusion prior on synthetic salt model; quantify artifact suppression and high-frequency recovery

## Open Questions the Paper Calls Out
None

## Limitations
- Neural operator may not generalize to field data outside training distribution, causing unreliable gradients
- Method fails to recover salt flanks when insufficient velocity contrast exists in migration velocity
- Single-step diffusion sampling may provide weaker prior guidance than full reverse process
- Field data results rely on unstated patch-based strategy with unknown stitching approach

## Confidence

- **High confidence**: Neural operator provides differentiable surrogate for RTM (supported by gradient-based inversion and 300x speedup claims)
- **Medium confidence**: Time-lag RTM provides superior velocity information (supported by wavenumber spectrum analysis, but corpus lacks direct evidence)
- **Medium confidence**: Diffusion model effectively suppresses artifacts (supported by visual comparisons, but single-step conditioning differs from full reverse process literature)

## Next Checks

1. **Time-lag information content**: Run ablation study comparing τ = 0 vs full time-lag inversion on synthetic salt model; quantify mid-wavenumber recovery through spectral analysis

2. **Diffusion conditioning strength**: Compare inversion results with 1-step vs multi-step diffusion refinement; measure artifact reduction and velocity accuracy trade-offs

3. **Robustness to initial velocity**: Test inversion with progressively degraded migration velocities (σ = 10, 20, 30 grids); document divergence thresholds and failure modes