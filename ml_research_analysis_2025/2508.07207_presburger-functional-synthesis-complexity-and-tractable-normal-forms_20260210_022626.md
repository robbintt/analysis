---
ver: rpa2
title: 'Presburger Functional Synthesis: Complexity and Tractable Normal Forms'
arxiv_id: '2508.07207'
source_url: https://arxiv.org/abs/2508.07207
tags:
- formula
- presburger
- circuit
- function
- then
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper investigates the complexity of functional synthesis
  for Presburger Arithmetic (PA) specifications. The main contributions are: Complexity
  Results: PFnS can be solved in EXPTIME with an exponential upper bound on circuit
  size A matching exponential lower bound is provided, showing this blowup is unavoidable
  PFnS for one input and one output is as hard as general Boolean functional synthesis
  Normal Forms for Tractable Synthesis: PSyNF (semantic normal form): guarantees polynomial-time
  synthesis and poly-size circuits PSySyNF (syntactic normal form): easier to check
  but exponentially less succinct than PSyNF Key Technical Contributions: Presburger
  circuits as representation for Skolem functions Interval-based characterization
  of Skolem functions for modulo-tame formulas Use of geometric insights from recent
  quantifier elimination techniques The paper establishes fundamental complexity results
  for Presburger functional synthesis and identifies normal forms that enable efficient
  synthesis under certain conditions.'
---

# Presburger Functional Synthesis: Complexity and Tractable Normal Forms

## Quick Facts
- **arXiv ID:** 2508.07207
- **Source URL:** https://arxiv.org/abs/2508.07207
- **Reference count:** 40
- **Primary result:** Presburger functional synthesis is EXPTIME-complete, but tractable normal forms enable polynomial-time synthesis for certain formula classes

## Executive Summary
This paper establishes the fundamental complexity of Presburger Functional Synthesis (PFnS), proving it is EXPTIME-complete with matching upper and lower bounds. The authors identify normal forms that enable efficient synthesis: PSyNF (semantic normal form) guarantees polynomial-time synthesis and polynomial-size circuits, while PSySyNF (syntactic normal form) is easier to verify but exponentially less succinct. The work demonstrates important differences between Presburger and Boolean functional synthesis, particularly regarding tractability and the role of modulo constraints.

## Method Summary
The paper develops a geometric approach to Presburger functional synthesis using Presburger circuits as Skolem function representations. For general formulas, synthesis proceeds via DNF conversion and geometric bound computation to enumerate candidate affine solutions. For tractable subclasses, the authors introduce PSyNF (semantic normal form) based on modulo-tameness and local quantification properties, enabling polynomial-time synthesis. PSySyNF (syntactic normal form) provides an easier-to-verify alternative by explicitly annotating formula branches with affine transformations. The interval-based characterization of Skolem functions leverages recent quantifier elimination techniques to compute valid ranges as unions of arithmetic progressions.

## Key Results
- PFnS can be solved in EXPTIME with an exponential upper bound on circuit size, with a matching exponential lower bound
- PSyNF enables polynomial-time synthesis and poly-size circuits by restricting formulas to be modulo-tame and satisfying local quantification
- PSySyNF provides a syntactic normal form that is easier to check but can be exponentially less succinct than PSyNF
- Single-output PFnS for one input and one output is as hard as general Boolean functional synthesis

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Restricting specifications to be "modulo-tame" enables the computation of Skolem functions as unions of arithmetic intervals in polynomial time.
- **Mechanism:** By ensuring that within any conjunctive subformula, all modulo constraints on a specific output variable $y$ share a single modulus $M$, the valid range for $y$ collapses into a set of arithmetic progressions. These progressions can be represented as bounded and unbounded intervals. A Presburger circuit can then compute the endpoints of these intervals using linear combinations and division gates (`div`), picking a valid output value without traversing an exponential search space.
- **Core assumption:** The specification formula $\phi(\bar{x}, y)$ can be converted to a semantically equivalent $y$-modulo-tame form, which may incur a worst-case exponential blow-up for general formulas but is poly-time if already tame.
- **Evidence anchors:**
  - [abstract] Mentions PSyNF is defined using "modulo-tameness" and guarantees poly-time solvability.
  - [section 5] Definition 5.1 defines $y$-modulo-tame; Theorem 5.7 proves poly-time synthesis for this class.
- **Break condition:** If the formula contains mixed moduli for $y$ within a single conjunction and cannot be easily normalized, the direct interval computation fails.

### Mechanism 2
- **Claim:** A "local quantification" condition allows greedy, variable-by-variable synthesis for multiple outputs without backtracking.
- **Mechanism:** For multiple outputs $y_1, \dots, y_m$, the mechanism enforces a semantic property: if locally replacing constraints on later variables $y_{i+1} \dots y_m$ with $\top$ yields a valid solution for $y_i$, then a globally valid solution must exist. This allows the synthesizer to fix $y_1$ using a Skolem circuit, then proceed to $y_2$ treating $y_1$ as fixed, and so on. This decomposes the vector synthesis problem into a sequence of scalar synthesis problems.
- **Core assumption:** The input formula strictly satisfies the ordering $\forall \bar{x} \forall y_1 \dots y_i (\exists_{local} y_{i+1} \dots \phi \to \exists y_{i+1} \dots \phi)$.
- **Evidence anchors:**
  - [abstract] Describes "local quantification" as a key component of the PSyNF normal form.
  - [section 5] Equation (1) formally defines the condition; the proof of Theorem 5.3 details the iterative composition of circuits.
- **Break condition:** If local solvability does not imply global solvability for the chosen variable ordering, the greedy composition outputs a function that might satisfy $y_i$ locally but finds no valid assignment for subsequent variables $y_{i+1}$.

### Mechanism 3
- **Claim:** Explicitly annotating formula branches with affine transformations (PSySyNF) reduces synthesis to simple evaluation.
- **Mechanism:** This is a knowledge compilation approach. Instead of reasoning about the formula during synthesis, the normal form PSySyNF pre-computes and embeds affine maps $A_i$ directly into the syntax (specifically, within maximal conjunctive subformulas). Synthesis becomes a lookup operation: find the satisfied conjunction and apply the associated affine transformation to the inputs.
- **Core assumption:** The user can afford the potentially exponential blow-up in formula size required to convert a general formula into PSySyNF.
- **Evidence anchors:**
  - [section 6] Theorem 6.1 proves every PSySyNF is in PSyNF; Theorem 6.2 guarantees compilation exists but notes the blow-up.
  - [abstract] Highlights that this syntactic form is "easier to verify but can be exponentially less succinct."
- **Break condition:** If the formula contains complex interactions that prevent the solution set from being covered by a tractable number of affine maps, the compiled PSySyNF formula becomes too large to store or process.

## Foundational Learning

- **Concept:** Presburger Arithmetic (PA)
  - **Why needed here:** This is the underlying logic of the specifications. Unlike Peano arithmetic, it lacks multiplication between variables but includes linear inequalities and modulo. Understanding PA is necessary to grasp why "circuits" (linear maps + div + max) are the target output format.
  - **Quick check question:** Can you express $x = y \cdot z$ in PA? (Answer: No, but you can express linear relationships like $3x = y + 2$).

- **Concept:** Skolem Functions
  - **Why needed here:** The entire paper addresses the "functional synthesis" problem, which is essentially finding a constructive Skolem function for the relation $\forall \bar{x} \exists \bar{y} : \phi(\bar{x}, \bar{y})$.
  - **Quick check question:** Given $\forall x \exists y : (y > x)$, what is a valid Skolem function for $y$? (Answer: e.g., $y = x + 1$).

- **Concept:** Complexity Class EXPTIME
  - **Why needed here:** The paper proves the general synthesis problem is EXPTIME-complete. This justifies the move toward normal forms (PSyNF), as it proves efficient general algorithms are impossible.
  - **Quick check question:** If a problem is EXPTIME-complete, can it be solved in polynomial time on a standard Turing machine? (Answer: Generally assumed no).

## Architecture Onboarding

- **Component map:** Input PA formula -> Normalizer (checks modulo-tameness and local quantification) -> Synthesizer (constructs Presburger circuit) -> Output Presburger circuit
- **Critical path:** The transformation of non-modulo-tame constraints. The paper suggests replacing constraints like $ax + by \equiv r \pmod M$ with explicit residue checks, which significantly increases formula size.
- **Design tradeoffs:**
  - **PSyNF vs. PSySyNF:** Choose **PSyNF** for semantic succinctness if you can handle the coNP-complete check for the normal form. Choose **PSySyNF** if you need linear-time verification of the form (e.g., in a trusted compiler), but accept the potential for exponential size growth.
- **Failure signatures:**
  - **Blow-up:** If the normalization step results in a formula size exceeding memory limits (due to mixed moduli or complex quantifier dependencies).
  - **Not in Form:** If the `coNP` check for PSyNF fails, the polynomial-time synthesis guarantee is void.
- **First 3 experiments:**
  1. **Single-Output Verification:** Implement the check for $y$-modulo-tameness on a set of sample PA formulas. Verify that non-tame formulas are correctly identified.
  2. **Interval Circuit Construction:** For a simple $y$-modulo-tame formula, manually construct the interval-computing Presburger circuit as described in Section 5, Step II.
  3. **Greedy Composition:** Implement the multi-output synthesis loop (Theorem 5.3) that composes circuits for $y_1, \dots, y_m$, ensuring the local quantification condition holds between steps.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** What are the necessary and sufficient conditions for polynomial-time synthesis for general (multi-output) Presburger formulas?
- **Basis:** [explicit] The paper states: "We leave the development of such a necessary and sufficient condition for polynomial time synthesis for Presburger formulas as a challenging open problem."
- **Why unresolved:** The paper provides this characterization (Theorem 5.10) only for single-output specifications; generalizing to multiple outputs remains open.
- **What evidence would resolve it:** A theoretical characterization defining the precise class of multi-output PA formulas for which PFnS is solvable in polynomial time.

### Open Question 2
- **Question:** What is the precise relationship between the interval-based representation of Skolem functions in PA and the Skolem basis representation in Boolean logic?
- **Basis:** [explicit] The authors note: "This warrants further investigation into the relation between these representations."
- **Why unresolved:** While Boolean synthesis can be encoded as PFnS, there is no natural connection identified yet between the specific structural representations (intervals vs. on-set/don't-care sets) used in each domain.
- **What evidence would resolve it:** A complexity-theoretic or structural mapping showing how interval representations in PA correspond to Boolean Skolem bases under standard encodings.

### Open Question 3
- **Question:** Can alternate characterizations or normal forms be developed to avoid the potential blowups caused by the current definition of modulo-tameness?
- **Basis:** [explicit] The conclusion suggests: "The modulo-tameness definition currently can lead to blowups that can potentially be avoided by finding alternate characterizations and normal forms."
- **Why unresolved:** While PSyNF guarantees poly-time synthesis, the compilation process to this form can incur exponential costs due to the strictness of modulo-tameness.
- **What evidence would resolve it:** A new normal form that retains the polynomial-time synthesis property of PSyNF but compiles more efficiently (e.g., with sub-exponential blowup) for a broader subset of PA formulas.

## Limitations

- PSyNF normalization may incur exponential blow-up for formulas that are only slightly non-tame, creating a gap between theoretical tractability and practical feasibility
- The local quantification condition for multiple outputs is difficult to verify in practice due to its coNP-completeness
- The geometric bound computation for the general EXPTIME algorithm relies on external work that may have implementation-specific complexities

## Confidence

- **High confidence:** EXPTIME upper and lower bounds for general PFnS; correctness of PSySyNF compilation; single-output PSyNF synthesis
- **Medium confidence:** PSyNF verification complexity (coNP-complete); multi-output synthesis via local quantification; practical applicability of normal forms
- **Low confidence:** Performance characteristics on real-world specifications; effectiveness of the geometric bounds approach in practice

## Next Checks

1. Implement the PSyNF verification algorithm on benchmark Presburger formulas to measure the practical cost of the coNP-complete check
2. Construct concrete examples where PSyNF normalization causes exponential blow-up, quantifying the gap between PSyNF and PSySyNF succinctness
3. Develop a prototype implementation of the multi-output greedy synthesis algorithm and test on specifications with known solution structures to validate the local quantification condition in practice