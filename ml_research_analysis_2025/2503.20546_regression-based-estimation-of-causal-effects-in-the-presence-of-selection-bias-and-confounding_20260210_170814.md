---
ver: rpa2
title: Regression-Based Estimation of Causal Effects in the Presence of Selection
  Bias and Confounding
arxiv_id: '2503.20546'
source_url: https://arxiv.org/abs/2503.20546
tags:
- selection
- causal
- bias
- data
- which
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of estimating causal effects in
  the presence of both selection bias and confounding. The authors propose a two-step
  regression estimator (TSR) that leverages external data and proxy variables to adjust
  for both types of bias.
---

# Regression-Based Estimation of Causal Effects in the Presence of Selection Bias and Confounding

## Quick Facts
- **arXiv ID:** 2503.20546
- **Source URL:** https://arxiv.org/abs/2503.20546
- **Reference count:** 40
- **Primary result:** Two-Step Regression (TSR) estimator that leverages external data and proxy variables to adjust for both selection bias and confounding, achieving lower variance than repeated regression when confounding is absent.

## Executive Summary
This paper addresses the fundamental challenge of estimating causal effects when data is subject to both selection bias and confounding. The authors propose a novel Two-Step Regression (TSR) estimator that combines selected observational data with external unbiased population data to recover the causal effect. By decomposing proxy variables into descendants and non-descendants of the treatment, the method provides a systematic approach to adjusting for both types of bias simultaneously. The approach extends prior work on selection bias correction by incorporating confounding adjustments through a carefully constructed regression framework.

## Method Summary
The Two-Step Regression (TSR) estimator works by first fitting a regression model on the selected dataset to estimate coefficients relating treatment, proxies, and outcome. In the second step, it uses external unbiased population data to estimate expected values of proxy variables and their conditional distributions. These estimates are then combined according to a theoretical formula that adjusts for both selection bias and confounding. The method leverages proxy variables that satisfy specific causal graph conditions, decomposing them into descendants and non-descendants of the treatment variable to enable separate adjustments for each type of bias.

## Key Results
- The TSR estimator can recover causal effects in scenarios with both selection bias and confounding when sufficient proxy variables are available
- Under conditions of no confounding, TSR achieves lower variance than repeated regression methods
- Extensive simulations demonstrate effectiveness across various scenarios including unobserved confounding
- The method requires access to external unbiased population data for proxy variables, which may be restrictive in practice

## Why This Works (Mechanism)
The TSR estimator works by exploiting the structure of the causal graph to separate the adjustments needed for selection bias from those needed for confounding. By decomposing proxy variables into descendants and non-descendants of the treatment, the method can use external data to estimate the distribution of non-descendant proxies while using selected data to capture the relationship between treatment and descendant proxies. This decomposition allows the estimator to properly account for the different ways each type of bias affects the observed data.

## Foundational Learning
- **Causal Graphs and DAGs**: Understanding directed acyclic graphs is essential for identifying the relationships between variables and determining which adjustments are needed. Quick check: Can you identify the descendants and non-descendants of a treatment variable in a given DAG?
- **Selection Bias vs Confounding**: These are distinct phenomena requiring different adjustment strategies. Selection bias arises from non-random sampling, while confounding involves backdoor paths between treatment and outcome. Quick check: Can you distinguish between scenarios requiring selection bias adjustment versus confounding adjustment?
- **Proxy Variables**: Variables that carry information about unobserved confounders. The quality and structure of proxy variables determine whether causal effects are recoverable. Quick check: Given a causal graph, can you identify valid proxy variables for unobserved confounders?
- **Identifiability Conditions**: Specific assumptions about the causal structure that allow causal effects to be recovered from observational data. Quick check: Can you verify whether the identifiability conditions hold for a given dataset structure?

## Architecture Onboarding

**Component Map:** Dataset S (selected) -> Regression 1 (coefficients) -> Dataset D (external) -> Regression 2 (expectations) -> TSR formula -> Causal effect estimate

**Critical Path:** The core estimation pipeline requires: (1) Selected data with treatment, outcome, and proxies; (2) External population data with treatment and proxies; (3) Valid proxy variables satisfying the descendant/non-descendant decomposition; (4) Correct implementation of the TSR formula combining regression outputs.

**Design Tradeoffs:** The method trades the restrictive requirement of external unbiased data for the ability to handle both selection bias and confounding simultaneously. Alternative approaches might relax the external data requirement but would need to make stronger assumptions about the causal structure or proxy variable quality.

**Failure Signatures:** 
- If proxy variables are incorrectly classified as descendants vs non-descendants, the confounding adjustment will fail while selection bias adjustment may still work
- If external data lacks support in regions where selected data has high selection probability, extrapolation errors will occur
- If proxy variables have weak correlation with unobserved confounders, neither bias can be adequately adjusted

**First Experiments:**
1. Implement the TSR estimator on the linear simulation data and verify it tracks the ground truth E[Y|do(X)] while naive OLS tracks E[Y|X]
2. Systematically vary proxy variable quality (correlation with Y) and measure impact on TSR performance relative to baselines
3. Implement the general TSR formula using density estimation for non-linear simulation scenarios to verify linearity simplification validity

## Open Questions the Paper Calls Out
- **Non-linear extensions:** How can the TSR framework be extended to non-linear settings using flexible function approximators like neural networks while maintaining theoretical guarantees?
- **External data availability:** Can the causal effect be recovered using TSR if access to unbiased external data for X and Z is unavailable or incomplete?
- **Robustness to non-Gaussian errors:** How robust is the TSR estimator to violations of the Gaussian error assumption and the presence of non-Gaussian noise distributions?

## Limitations
- Requires access to external unbiased population data, which may not be available in many practical scenarios
- Performance depends critically on the quality and structure of proxy variables, which must satisfy specific decomposition requirements
- Theoretical guarantees and variance analysis rely on linearity and OLS properties, limiting applicability to non-linear settings
- The method assumes the causal graph structure is known or can be reliably estimated, which is often challenging in practice

## Confidence

**High Confidence:** The theoretical identifiability conditions and basic TSR estimation procedure are well-specified and reproducible.

**Medium Confidence:** The simulation results showing TSR's effectiveness are plausible, but parameter sensitivity and performance in high-dimensional settings are not fully explored.

**Medium Confidence:** The variance reduction claim compared to repeated regression is supported by theory but would benefit from broader empirical validation.

## Next Checks
1. Implement TSR and compare against naive OLS and repeated regression baselines on linear simulation data, verifying tracking of ground truth E[Y|do(X)]
2. Evaluate TSR robustness by systematically varying proxy variable correlation strength with Y
3. Implement general TSR formula with density estimation for non-linear scenarios to validate linearity simplification