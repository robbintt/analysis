---
ver: rpa2
title: 'CFLight: Enhancing Safety with Traffic Signal Control through Counterfactual
  Learning'
arxiv_id: '2512.09368'
source_url: https://arxiv.org/abs/2512.09368
tags:
- safety
- traffic
- learning
- safe
- action
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: ''
---

# CFLight: Enhancing Safety with Traffic Signal Control through Counterfactual Learning

## Quick Facts
- arXiv ID: 2512.09368
- Source URL: https://arxiv.org/abs/2512.09368
- Reference count: 40
- Primary result: Achieves zero collisions in synthetic intersections while maintaining efficiency via counterfactual data augmentation

## Executive Summary
CFLight introduces a novel framework for traffic signal control that enhances safety through counterfactual learning. By leveraging Structural Causal Models (SCM) and counterfactual data augmentation, the system learns from "what-if" scenarios to avoid collisions while maintaining traffic efficiency. The method combines a BiCoGAN-based SCM for generating counterfactual trajectories with a modular "X" architecture that separately optimizes safety and efficiency objectives. Experiments demonstrate significant improvements in collision reduction and Pareto-optimal trade-offs between safety and throughput.

## Method Summary
CFLight implements a CF+"X" framework where counterfactual trajectories are generated via a BiCoGAN-based SCM when collisions occur. The system detects collisions in SUMO, rewinds to pre-collision states, and uses the SCM to predict outcomes of alternative safe actions. These counterfactual experiences are added to the replay buffer for training a 3DQN agent. The architecture decouples safety and efficiency into separate components, allowing flexible trade-offs. The method is evaluated on both synthetic intersections and real-world Cologne dataset with collision rates up to 40%.

## Key Results
- Achieves zero collisions in synthetic intersection scenarios while maintaining efficiency
- Outperforms baseline methods (DQN, FuzzyLight, VLMLight) on safety metrics
- Demonstrates Pareto-optimal trade-offs between safety and efficiency through weight tuning
- Shows robustness to varying collision rates and traffic densities

## Why This Works (Mechanism)

### Mechanism 1: Counterfactual Data Augmentation via SCM
When collisions occur, CFLight identifies the pre-collision state and uses an SCM (approximated by BiCoGAN) to invert observations and estimate exogenous noise. By performing interventions with safe alternative actions, the system predicts counterfactual next states and rewards, which are added to the training buffer. This allows the agent to learn from mistakes without repeating them. The core assumption is that structural equations are monotonic with respect to exogenous noise, enabling unique inversion to identify the specific noise context of collisions.

### Mechanism 2: CF Objective Optimization
The framework defines a counterfactual objective (e.g., CF Reward = $r_{cf} - r_{ac}$) that quantifies the improvement of counterfactual actions over actual actions. This creates a direct optimization signal for safety by contrasting real unsafe outcomes with predicted safe outcomes. The policy is conditioned to prefer actions that the SCM predicts will lead to higher rewards, even for state-action pairs not fully explored in the factual world. The effectiveness relies on the predicted counterfactual reward being an accurate proxy for the true expected return.

### Mechanism 3: Modular "X" Framework Decoupling
The architecture separates efficient RL components from safety components, allowing flexible trade-offs without destabilizing the base algorithm. The efficient component handles standard throughput optimization while the safety component manages collision penalties. The CF module injects safety-specific data, preventing efficiency rewards from overwhelming safety signals immediately. This modular approach enables exploration of the Pareto frontier between safety and efficiency more effectively.

## Foundational Learning

- **Structural Causal Models (SCMs) & Counterfactuals**: Essential for understanding how the system "rewinds" time to compute probabilities of outcomes under alternative actions. Quick check: Can you explain why inferring noise variable $U$ (Abduction) is necessary before predicting counterfactual outcomes, rather than just running forward simulation?

- **Generative Adversarial Networks (GANs) / BiCoGAN**: The paper uses BiCoGAN to approximate the SCM. Understanding how Generator and Encoder interact to model transition dynamics and latent noise is crucial. Quick check: In the BiCoGAN setup, what does the Generator take as input to produce the "fake" next state and reward?

- **Safe Reinforcement Learning (Constrained RL)**: Provides context for the problem. Standard RL maximizes cumulative reward, while Safe RL introduces constraints like collision counts. Quick check: How does adding a "collision penalty" to the reward differ from a hard constraint on expected collisions?

## Architecture Onboarding

- **Component map**: SUMO Environment -> Experience Buffer -> SCM Module (BiCoGAN) -> X-Module -> Updated Agent
- **Critical path**: 1) Detect Collision in SUMO 2) Trigger Rewind: Retrieve pre-collision state 3) CF Construction: SCM generates outcome for safe alternative action 4) Buffer Injection: Add imaginary safe tuple 5) Update: Train Agent on mixed batch
- **Design tradeoffs**: BiCoGAN vs. simple model (complex generative model captures stochasticity but is harder to train), Simulation vs. Real (requires accurate world model for counterfactual reasoning)
- **Failure signatures**: High variance in safety (unrealistic CFs lead to "magical thinking"), Efficiency collapse (overly cautious policy), GAN instability (CF rewards become noise)
- **First 3 experiments**: 1) SCM Validation: Test BiCoGAN's state prediction and inversion accuracy before RL integration 2) Ablation on CF frequency: Compare performance with CF data added every collision vs. every 10th collision 3) Pareto Frontier Analysis: Vary weights w1 (Safety) and w2 (Efficiency) to confirm traversable trade-off curve

## Open Questions the Paper Calls Out

### Open Question 1
How can the framework be augmented to maintain safety when SCM predictions are significantly inaccurate due to high environmental noise? While the authors test sensitivity to noise, they don't propose mechanisms to mitigate performance degradation when SCM inputs have noise scales > 0.5.

### Open Question 2
Does the BiCoGAN-based SCM strictly satisfy the monotonicity assumption required for counterfactual identifiability? The paper claims monotonicity is essential but provides no guarantees that neural networks learn strictly monotonic functions, potentially making CF inference ambiguous.

### Open Question 3
What is the cumulative computational latency of the CTC process in dense traffic scenarios with high collision frequencies? While single-step generation is fast, the framework requires rewinding and generating trajectories for every unsafe event, which could theoretically overload the control loop in dense traffic.

## Limitations

- The paper lacks detailed ablation studies on counterfactual data volume and monotonicity penalty impact
- Claims of "zero collisions" lack statistical significance tests or variance reporting across multiple random seeds
- Real-world applicability claims need validation on more diverse city layouts beyond the Cologne dataset
- Computational latency under high collision frequencies is not thoroughly benchmarked

## Confidence

- **High** for the theoretical framework of using SCM for CF augmentation in RL
- **Medium** for the specific BiCoGAN implementation and its stability across different traffic scenarios
- **Low** for claims about real-world applicability without further validation on more diverse city layouts

## Next Checks

1. **Statistical robustness**: Run the Cologne experiment with 10 different random seeds and report meanÂ±std for all metrics to confirm if "zero collisions" is consistent or an outlier

2. **SCM validation**: Isolate and test the BiCoGAN on its own (without RL) to verify monotonicity constraints and state inversion accuracy on a held-out test set of collision/non-collision scenarios

3. **Pareto frontier verification**: Systematically sweep the weights w1 (safety) and w2 (efficiency) and plot the resulting trade-off curve to confirm the claimed "harmonious equilibrium" is achievable across the full range