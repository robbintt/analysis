---
ver: rpa2
title: Cross-Sample Augmented Test-Time Adaptation for Personalized Intraoperative
  Hypotension Prediction
arxiv_id: '2512.15762'
source_url: https://arxiv.org/abs/2512.15762
tags:
- csa-tta
- prediction
- data
- case
- time
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces CSA-TTA, a test-time adaptation framework
  designed to improve personalized intraoperative hypotension (IOH) prediction by
  addressing the scarcity of individual IOH events. CSA-TTA enriches adaptation data
  through cross-sample retrieval, using a coarse-to-fine strategy to find temporally
  and semantically similar patient segments, combined with multi-task optimization
  (self-supervised masked reconstruction and sequence forecasting).
---

# Cross-Sample Augmented Test-Time Adaptation for Personalized Intraoperative Hypotension Prediction

## Quick Facts
- arXiv ID: 2512.15762
- Source URL: https://arxiv.org/abs/2512.15762
- Reference count: 40
- Key outcome: CSA-TTA improves personalized intraoperative hypotension prediction through test-time adaptation, achieving up to +7.46% Recall and +5.07% F1-score in zero-shot settings

## Executive Summary
This work introduces CSA-TTA, a test-time adaptation framework designed to improve personalized intraoperative hypotension (IOH) prediction by addressing the scarcity of individual IOH events. CSA-TTA enriches adaptation data through cross-sample retrieval, using a coarse-to-fine strategy to find temporally and semantically similar patient segments, combined with multi-task optimization (self-supervised masked reconstruction and sequence forecasting). Evaluated on VitalDB and a real-world in-hospital dataset using TimesFM and UniTS backbones, CSA-TTA consistently enhances performance, notably improving Recall by up to +7.46% and F1-score by +5.07% in zero-shot settings, and reducing regression errors in both settings. The approach effectively adapts to rapid physiological changes and rare events, demonstrating strong robustness and generalization for real-time clinical monitoring.

## Method Summary
CSA-TTA addresses the challenge of personalized intraoperative hypotension prediction by implementing a cross-sample augmented test-time adaptation framework. The method uses a coarse-to-fine retrieval strategy to find temporally and semantically similar patient segments from a cross-sample bank, combined with multi-task optimization including self-supervised masked reconstruction and sequence forecasting. The framework operates in two stages: first forecasting blood pressure trajectories, then classifying IOH events. During test time, similar patient segments are retrieved and augmented with perturbations, then used for fine-tuning with partial parameter updates. The approach was evaluated on VitalDB and a real-world in-hospital dataset using TimesFM and UniTS backbones, demonstrating consistent performance improvements across both datasets.

## Key Results
- CSA-TTA improved Recall by up to +7.46% and F1-score by +5.07% in zero-shot settings
- Regression errors were reduced in both zero-shot and fine-tuned settings across all tested horizons
- The framework showed consistent performance improvements on both VitalDB and real-world in-hospital datasets
- CSA-TTA demonstrated strong robustness to rapid physiological changes and rare IOH events

## Why This Works (Mechanism)
The effectiveness of CSA-TTA stems from its ability to leverage cross-sample information during test-time adaptation, addressing the scarcity of individual IOH events. By using a coarse-to-fine retrieval strategy, the framework identifies temporally and semantically similar patient segments that can inform the adaptation process. The multi-task optimization, combining supervised prediction with self-supervised masked reconstruction, enables the model to learn robust representations that generalize well to individual patient variations. The partial fine-tuning approach allows for efficient adaptation while preserving learned temporal dependencies.

## Foundational Learning
- **Intraoperative Hypotension (IOH) Prediction**: Forecasting blood pressure drops during surgery is critical for patient safety; required for developing adaptive monitoring systems
- **Test-Time Adaptation (TTA)**: Adapting models during inference without retraining on new data; quick check: verify adaptation improves performance on unseen patient data
- **Cross-Sample Retrieval**: Finding similar patient segments from historical data to augment adaptation; quick check: measure similarity distribution between retrieved samples and query windows
- **Masked Reconstruction**: Self-supervised learning task where parts of input are masked and model learns to reconstruct them; quick check: test multiple masking ratios (10-50%) for optimal performance
- **DTW (Dynamic Time Warping)**: Distance measure for comparing time series sequences; quick check: validate DTW similarity scores against domain expert knowledge
- **K-Shape Clustering**: Shape-based clustering algorithm for time series; quick check: verify cluster purity and separation on validation data

## Architecture Onboarding

**Component Map:** Input features (MAP, HR, temp, ECG) -> Backbone (TimesFM/UniTS) -> Masked Reconstruction Head + Sequence Forecasting Head -> Cross-sample Retrieval (K-Shape + DTW) -> Augmented Data -> Partial Fine-tuning (input/output/layer-norm layers)

**Critical Path:** During test time, patient data flows through the backbone, retrieves similar samples via cross-sample bank, undergoes augmentation, then fine-tunes the model parameters for personalized prediction

**Design Tradeoffs:** The framework balances between adaptation effectiveness and computational efficiency by using partial fine-tuning rather than full model updates, and by limiting retrieved samples to Top-K=3

**Failure Signatures:** Poor adaptation performance may indicate: retrieval returning irrelevant samples, class imbalance in retrieved set, or insufficient masking in self-supervised task

**First Experiments:**
1. Implement and validate the DTW-based cross-sample retrieval with K=3, measuring similarity distributions between retrieved samples and query windows
2. Test multiple masking ratios (10-50%) for the self-supervised reconstruction task to determine optimal configuration
3. Verify the IOH detection algorithm implementation by comparing detected events against ground truth on a held-out validation set

## Open Questions the Paper Calls Out
None

## Limitations
- Critical hyperparameters for the self-supervised reconstruction task (masking ratio, pattern, loss formulation) are not fully specified
- Augmentation parameters including Gaussian noise scale and temporal scaling ranges are missing
- Some IOH detection algorithm hyperparameters (τ_bp, τ_event, β, δ, τ_soft, λ_hard, λ_soft) are not completely specified

## Confidence
- **High Confidence**: Cross-sample retrieval strategy, multi-task optimization framework, overall evaluation methodology
- **Medium Confidence**: Adaptation performance gains, generalization across datasets, robustness to physiological changes
- **Low Confidence**: Exact implementation details of masked reconstruction, precise augmentation parameters, IOH detection algorithm thresholds

## Next Checks
1. Implement and validate the DTW-based cross-sample retrieval with K=3, measuring similarity distributions between retrieved samples and query windows
2. Test multiple masking ratios (10-50%) for the self-supervised reconstruction task to determine optimal configuration
3. Verify the IOH detection algorithm implementation by comparing detected events against ground truth on a held-out validation set