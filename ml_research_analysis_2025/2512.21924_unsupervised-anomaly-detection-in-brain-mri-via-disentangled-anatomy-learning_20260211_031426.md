---
ver: rpa2
title: Unsupervised Anomaly Detection in Brain MRI via Disentangled Anatomy Learning
arxiv_id: '2512.21924'
source_url: https://arxiv.org/abs/2512.21924
tags:
- image
- anatomical
- images
- anomaly
- imaging
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of unsupervised anomaly detection
  in brain MRI by proposing a novel framework that disentangles anatomical and imaging
  information to improve generalizability across different modalities and centers.
  The key innovation is the edge-to-image restoration module, which reconstructs pseudo-healthy
  images using only anatomical edge information, effectively suppressing anomalies
  while preserving personalized normal details.
---

# Unsupervised Anomaly Detection in Brain MRI via Disentangled Anatomy Learning

## Quick Facts
- arXiv ID: 2512.21924
- Source URL: https://arxiv.org/abs/2512.21924
- Authors: Tao Yang; Xiuying Wang; Hao Liu; Guanzhong Gong; Lian-Ming Wu; Yu-Ping Wang; Lisheng Wang
- Reference count: 11
- Key outcome: +18.32% AP and +13.64% DSC over 17 SOTA methods on 9 multi-center datasets

## Executive Summary
This paper addresses unsupervised anomaly detection in brain MRI by proposing a framework that disentangles anatomical and imaging information to improve cross-modality and cross-center generalization. The key innovation is an edge-to-image restoration module that reconstructs pseudo-healthy images using only anatomical edges, suppressing anomalies while preserving normal structural details. Evaluated on 4,443 patients across nine datasets, the method demonstrates significant improvements over state-of-the-art approaches.

## Method Summary
The method uses a two-module architecture: a Disentangled Representation Module (DRM) that separates brain MRI into anatomical and modality components, and an Edge-to-Image Restoration Module (EIRM) that reconstructs healthy images from anatomical edges. The DRM employs a 3D U-Net to extract anatomical images, which are binarized into three tissue types, then processed through an anatomy encoder and restorer. The EIRM uses Canny edge detection on anatomical maps to reconstruct healthy anatomy, which is then recoupled with modality information. Anomaly detection is performed by comparing the input with the reconstructed pseudo-healthy image using a hybrid score combining intensity differences and structural similarity.

## Key Results
- Achieves +18.32% average precision improvement over 17 state-of-the-art methods
- Demonstrates +13.64% Dice similarity coefficient improvement
- Shows superior generalization across different MRI modalities (T1, T2) and acquisition centers
- Outperforms baselines on nine multi-center datasets with 4,443 patients

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Disentangling anatomy from imaging improves cross-modality and cross-center generalization
- Mechanism: The disentangled representation module decouples brain MRI into imaging-invariant anatomical representations (constrained to 3 tissue types via one-hot encoding) and non-spatial modality vectors. Reconstruction then operates on anatomy alone, while modality is recoupled only at the final stage
- Core assumption: Anatomical structure is imaging-invariant across sequences and scanners; anomalies primarily manifest as deviations from healthy anatomical distributions
- Evidence anchors: [abstract] "disentangled representation module is proposed to improve generalizability by decoupling brain MRI into imaging information and essential imaging-invariant anatomical images"

### Mechanism 2
- Claim: Edge-only input to restoration suppresses anomaly propagation while preserving normal structural detail
- Mechanism: The edge-to-image restoration module reconstructs pseudo-healthy images from Canny edges of anatomical maps, not from intensity images. This limits abnormal pixel input and forces the model to infer healthy anatomy from high-frequency structure
- Core assumption: Anomalous regions leave detectable traces in intensity but edges predominantly encode normal anatomy; edge information is sufficient to reconstruct healthy brain structure
- Evidence anchors: [abstract] "edge-to-image restoration module... suppresses abnormal residuals in PHI by reducing abnormal pixels input through edge-only input"

### Mechanism 3
- Claim: Hybrid anomaly scoring combining L1 and SSIM differences improves localization over single metrics
- Mechanism: The proposed hybrid score multiplies pixel-wise intensity difference by (1 - SSIM), emphasizing regions with both luminance and structural deviations while smoothing grainy noise via post-processing filters
- Core assumption: Anomalies produce both intensity and structural mismatches; SSIM captures structural discrepancy that pure L1 misses
- Evidence anchors: [Section 3.5.2] "hybrid anomaly score that incorporates structural similarity (SSIM) to enhance structure-based difference measurement"

## Foundational Learning

### Concept: Unsupervised anomaly detection via reconstruction
- Why needed here: The entire approach assumes anomalies can be detected by comparing abnormal inputs to pseudo-healthy reconstructions; understanding reconstruction-based UAD fundamentals is essential
- Quick check question: Can you explain why an autoencoder trained on normal data might produce high reconstruction error for anomalies?

### Concept: Disentangled representation learning
- Why needed here: The core innovation separates anatomy from modality; grasping disentanglement constraints (consistency, similarity losses) is required to understand how representations are kept distinct
- Quick check question: What would happen if anatomical representations captured imaging information (e.g., T1 vs T2 intensity distributions)?

### Concept: Brain MRI imaging physics basics (T1/T2 contrast)
- Why needed here: The method explicitly handles multi-modality (T1/T2); knowing why tissues appear differently in T1 vs T2 helps evaluate whether disentanglement is biologically plausible
- Quick check question: How does white matter appear in T1-weighted versus T2-weighted images?

## Architecture Onboarding

### Component map
Input → Anatomy Extractor (E_A) → Anatomical Image → Edge Detection → Anatomy Restorer (R_E) → Anatomical Code + Modality Extractor (E_M) → Modality Vector → Representation Combiner (R_D) → Pseudo-Healthy Image → Hybrid Score → Anomaly Map

### Critical path
Edge extraction from anatomical image → restoration to anatomical code → recoupling with modality. Errors here propagate directly to anomaly maps.

### Design tradeoffs
(1) Binarization enforces disentanglement but loses soft tissue boundary information; (2) Edge-only input suppresses anomalies but may struggle with deformation-based pathologies; (3) Joint training on paired T1/T2 enables modality-agnostic inference but requires paired training data.

### Failure signatures
(1) High false positives in normal regions → likely modality misalignment or insufficient modality reuse; (2) Low sensitivity to lesions → edge preservation may include anomalous structure, or restoration too aggressive; (3) Performance drop on new centers → training data diversity insufficient.

### First 3 experiments
1. Validate disentanglement: Visualize anatomical maps from T1/T2 pairs; verify they are near-identical and binarized correctly
2. Edge restoration sanity check: Input only edges from normal scans; confirm R_E reconstructs plausible anatomy without intensity leakage
3. Modality reuse alignment: Compute t-SNE of modality vectors before/after reconstruction (as in Fig. 6); verify minimal shift with modality reuse enabled

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the framework be adapted to detect abnormal anatomical deformations, such as brain warping or atrophy, given that the current edge-conditioned reconstruction preserves these structural features?
- Basis in paper: [explicit] The authors state in Section 5.4 that the method "may face challenges in identifying the abnormal anatomical deformations caused by the underlying pathology" because the pseudo-healthy generation is conditioned on the input's anatomical edges
- Why unresolved: The current architecture relies on the input's edges to restore images; if the anatomy is deformed, these edges are preserved in the pseudo-healthy output, rendering the deformation invisible to the anomaly score
- What evidence would resolve it: A modification to the anatomy restorer that predicts "normative" anatomical edges rather than strictly using the input edges, validated on datasets featuring atrophy or structural warping

### Open Question 2
- Question: To what degree does the current hyperparameter selection strategy, which relies on the BraTS-GLI and MSLUB datasets, bias detection performance towards specific lesion types?
- Basis in paper: [explicit] Section 5.4 notes that hyperparameters were selected based on specific datasets and that this "might bias the results towards certain lesion types"
- Why unresolved: The study currently lacks a validation set that is balanced across the diverse lesion types used for testing, making it difficult to isolate the impact of hyperparameter tuning on generalization
- What evidence would resolve it: An ablation study where hyperparameters are selected using a dedicated, balanced validation set containing all lesion types, compared against the current performance metrics

### Open Question 3
- Question: Can the disentangled representation module be extended to incorporate additional imaging sequences (e.g., FLAIR) efficiently without requiring the retraining of the entire model?
- Basis in paper: [explicit] Section 5.2 discusses scalability to new imaging sequences, stating that incorporating FLAIR would require "retraining the whole model by extending the relevant loss functions"
- Why unresolved: While the authors suggest the framework is scalable, they do not demonstrate whether new sequences can be added with fine-tuning or modular updates rather than full retraining
- What evidence would resolve it: Experiments training the model on triplets (T1, T2, FLAIR) and comparing the computational cost and performance degradation against the paired T1/T2 baseline

## Limitations

- Network architecture details remain underspecified, limiting exact reproduction
- The method requires paired T1/T2 training data, which is not always available in clinical practice
- Edge extraction via Canny may not adequately capture subtle anomalies that don't significantly alter edge structure
- Binarization approach uses approximate hard-coded values that may not generalize across different scanners

## Confidence

- High confidence in the core innovation of edge-to-image restoration for anomaly suppression
- Medium confidence in the generalizability claims across modalities/centers due to potential dependency on training data diversity
- Medium confidence in the hybrid scoring mechanism given limited ablation studies

## Next Checks

1. Validate disentanglement effectiveness by testing whether anatomical representations remain consistent across different imaging modalities from the same subject
2. Test robustness to unseen acquisition protocols by evaluating on data from centers not represented in the training set
3. Assess whether the binarization threshold values (0.29, 0.48, 0.72) need adaptation for different scanner vendors or protocols