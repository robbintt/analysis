---
ver: rpa2
title: Conformal Prediction for Uncertainty Estimation in Drug-Target Interaction
  Prediction
arxiv_id: '2505.18890'
source_url: https://arxiv.org/abs/2505.18890
tags:
- drug
- prediction
- calibration
- protein
- coverage
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper evaluates conformal prediction (CP) methods for quantifying\
  \ uncertainty in drug-target interaction (DTI) prediction, addressing the need for\
  \ reliable interval estimates in drug discovery. The authors compare marginal, group-conditioned,\
  \ and three cluster-conditioned CP variants\u2014nonconformity-based, feature-based,\
  \ and nearest-neighbor\u2013based\u2014using the KIBA dataset and a gradient boosting\
  \ regressor."
---

# Conformal Prediction for Uncertainty Estimation in Drug-Target Interaction Prediction

## Quick Facts
- arXiv ID: 2505.18890
- Source URL: https://arxiv.org/abs/2505.18890
- Reference count: 38
- This paper evaluates conformal prediction (CP) methods for quantifying uncertainty in drug-target interaction (DTI) prediction, addressing the need for reliable interval estimates in drug discovery. The authors compare marginal, group-conditioned, and three cluster-conditioned CP variants—nonconformity-based, feature-based, and nearest-neighbor–based—using the KIBA dataset and a gradient boosting regressor. Experiments with four data-splitting strategies (including challenging new drug-protein splits) show that nonconformity-based clustering yields the tightest intervals and lowest subgroup coverage gaps, especially in sparse or novel scenarios. Group-conditioned CP performs well when one molecular entity is familiar, but cluster-conditioned methods provide more robust uncertainty estimates overall, highlighting their potential for reliable DTI prediction under uncertainty.

## Executive Summary
This work addresses the critical need for reliable uncertainty quantification in drug-target interaction prediction, a key step in drug discovery. The authors propose and evaluate multiple conformal prediction (CP) methods to provide calibrated prediction intervals for binding affinity predictions. By comparing marginal, group-conditioned, and three cluster-conditioned approaches across challenging data-splitting scenarios, they demonstrate that clustering calibration samples by their nonconformity score distributions (rather than treating interactions as atomic units or using raw features) produces tighter intervals and more reliable coverage, particularly when dealing with sparse or novel molecular entities.

## Method Summary
The authors implement a comprehensive evaluation of conformal prediction methods for DTI regression using the KIBA dataset with 2068 drugs and 229 proteins. They train a GradientBoostingRegressor on concatenated drug-target features (Morgan fingerprints + Mordred descriptors for drugs; AAC + ProtBERT embeddings for proteins) and apply five CP variants: marginal CP (MCP), group-conditioned CP (GCP), and three cluster-conditioned CP methods (nonconformity-based, feature-based, and nearest-neighbor–based). The key innovation is splitting calibration data into clustering and quantile-estimation subsets using a parameter γ, then applying k-means clustering on ECDF percentile embeddings of residuals to group drugs and proteins with similar error patterns. They systematically evaluate coverage, interval width, and Mean Absolute Coverage Gap (MACG) across four data-splitting strategies including challenging new drug-protein combinations.

## Key Results
- Nonconformity-based clustering (CCP-NC) yields the tightest prediction intervals and lowest subgroup coverage gaps across all data-splitting strategies
- Cluster-conditioned CP methods significantly outperform marginal and group-conditioned approaches in Drug and Protein splits where calibration data is sparse
- GCP performs well when one molecular entity is familiar (e.g., proteins in Drug split), but cluster-conditioned methods provide more robust uncertainty estimates overall
- The optimal configuration (γ, n_clusters) varies by split strategy, with γ=0.5 and n_clusters=20-30 showing good performance across most scenarios

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Clustering calibration samples by their nonconformity score distributions enables tighter, subgroup-aware prediction intervals than marginal or identity-based approaches.
- **Mechanism**: The system computes empirical CDF embeddings (10th-90th percentiles) of absolute residuals for each drug and protein, applies k-means to group entities with similar error patterns, then estimates cluster-specific quantile thresholds. This pools calibration data across behaviorally similar entities rather than treating each identity separately or globally.
- **Core assumption**: Entities with similar residual distributions exhibit similar uncertainty characteristics; exchangeability holds within clusters.
- **Evidence anchors**:
  - [abstract]: "nonconformity-based clustering yields the tightest intervals and lowest subgroup coverage gaps, especially in sparse or novel scenarios"
  - [Section 3.4.3 / Figure 3]: Describes ECDF embedding extraction and two-level k-means clustering for drugs and proteins
  - [corpus]: Weak—neighbor papers focus on DTI prediction architectures without CP-based uncertainty quantification
- **Break condition**: When calibration samples per cluster fall below ~20-30, quantile estimates become unstable (wide intervals, coverage gaps).

### Mechanism 2
- **Claim**: Conditioning prediction intervals on both drug and protein clusters (jointly, not as atomic interaction units) captures uncertainty from either molecular entity.
- **Mechanism**: Each interaction (di, tj) inherits a cluster pair (κdrug, κprotein). At test time, if both clusters are represented in calibration, thresholds are pooled; if only one side is available, that cluster's threshold is used; if neither, fall back to global. This adaptive logic (Equation 10) handles partial observability.
- **Core assumption**: Prediction uncertainty is decomposable into drug-driven and protein-driven components with additive or selectable contributions.
- **Evidence anchors**:
  - [abstract]: "construct calibration sets by conditioning on both components of a drug–target interaction, rather than treating the interaction as a single atomic unit"
  - [Section 3.4.3, Equation 10]: Formal threshold selection logic based on cluster availability
  - [corpus]: Not addressed in neighbors—no comparative CP methods for DTI
- **Break condition**: When both entities are novel and no similar entities exist in calibration, system defaults to global threshold (loss of adaptivity).

### Mechanism 3
- **Claim**: Splitting the calibration set into clustering and quantile-estimation subsets (controlled by γ) with joint tuning of (γ, nclusters) reduces subgroup coverage gaps.
- **Mechanism**: A grid search over γ ∈ {0.25, 0.5, 0.75} and nclusters ∈ {1, 5, ..., 50} minimizes the combined Mean Absolute Coverage Gap (MACG) across drugs and proteins (Equation 7). This trades off clustering fidelity (more data) against quantile stability (more samples per cluster).
- **Core assumption**: Optimal configuration generalizes from calibration to test within a given split strategy; subgroup-level MACG is a valid proxy for conditional validity.
- **Evidence anchors**:
  - [Section 3.4.3]: "The splitting ratio is controlled by a parameter γ ∈ {0.25, 0.5, 0.75}"
  - [Figure 8]: Shows MACG surfaces across cluster counts and γ values; red stars mark optimal configurations
  - [corpus]: No direct equivalent—hyperparameter tuning in neighbors focuses on model architecture, not calibration split ratios
- **Break condition**: When optimal (γ, nclusters) varies substantially across split strategies, indicating sensitivity to distribution shift; no universal configuration exists.

## Foundational Learning

- **Concept**: Conformal Prediction (Split/Inductive)
  - **Why needed here**: Core framework providing finite-sample coverage guarantees; understanding the calibration set role, exchangeability assumption, and quantile construction is prerequisite.
  - **Quick check question**: Given a calibration set of 100 residuals, what is the conformal quantile at α=0.1, and what coverage does it guarantee?

- **Concept**: Heteroscedasticity and Conditional vs. Marginal Coverage
  - **Why needed here**: Motivation for cluster-conditioned methods; marginal CP fails when error distributions vary across subgroups.
  - **Quick check question**: Why does marginal CP potentially under-cover specific drug families even if global coverage is satisfied?

- **Concept**: K-means Clustering on Non-Standard Features (ECDF Embeddings)
  - **Why needed here**: CCP-NC clusters on percentile-based ECDF embeddings of residuals, not raw features; understanding this representation is critical for implementation.
  - **Quick check question**: If a drug has only 3 calibration residuals, can you reliably compute a 9-dimensional ECDF embedding (10th-90th percentiles)?

## Architecture Onboarding

- **Component map**: Predictive Model -> Calibration Set Splitter -> Cluster Module -> Quantile Estimator -> Interval Constructor
- **Critical path**:
  1. Train base regressor on Dtrain (split-dependent)
  2. Compute absolute residuals on calibration subset
  3. Build ECDF embeddings per drug/protein (CCP-NC) or use raw features (CCP-FC)
  4. Run k-means to assign cluster IDs
  5. Compute cluster-wise quantiles on held-out calibration portion
  6. At inference: map test drug/protein to clusters, select threshold via Equation 10, output interval

- **Design tradeoffs**:
  - **CCP-NC vs. CCP-FC**: NC clusters by error behavior (adaptive to model failures); FC clusters by input similarity (domain-informed but model-agnostic). Paper shows NC superior in most splits.
  - **γ (clustering vs. quantile split)**: Higher γ improves cluster quality but reduces samples per cluster for quantile estimation; optimal varies by split (Figure 8).
  - **nclusters**: Too few → underfitting heterogeneity; too many → sparse clusters, unstable quantiles.
  - **GCP vs. CCP**: GCP excels when entities are well-represented in calibration (e.g., proteins in Drug Split); CCP generalizes better for sparse/novel entities.

- **Failure signatures**:
  - **Global over-coverage + wide intervals**: nclusters=1 (effectively MCP); increase cluster count.
  - **High MACG for sparse entities**: Cluster assignments unstable; reduce nclusters or increase γ.
  - **Under-coverage in New Drug–Protein split**: Exchangeability violated; consider normalized nonconformity scores (Equation 2) or covariate-shift CP.
  - **NaN/infinite thresholds**: Empty cluster in quantile estimation subset; ensure cluster coverage in both calibration splits.

- **First 3 experiments**:
  1. **Replicate Random Split baseline**: Implement MCP and CCP-NC with γ=0.5, nclusters ∈ {10, 20, 30}. Verify coverage ≈ 1-α and that CCP-NC widths ≤ MCP widths. Log MACG per drug and protein.
  2. **Ablate calibration split ratio**: Fix nclusters=20, vary γ ∈ {0.25, 0.5, 0.75} under Drug Split. Plot MACG vs. γ; identify if optimal aligns with paper (γ=0.5 common).
  3. **Stress test on New Drug–Protein split**: Train on 50% drugs × 50% proteins; calibrate and test on remaining combinations. Compare GCP (fallback to global for unseen entities) vs. CCP-NC (cluster-based fallback). Expect CCP-NC to show lower MACG and narrower intervals per Figure 6–7.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: How do cluster-conditioned conformal prediction methods generalize to other DTI benchmarks beyond KIBA, particularly datasets with different protein families or chemical diversity?
- **Basis in paper**: [explicit] The authors state they "evaluated our models exclusively on the KIBA benchmark dataset" (Section 3.1), leaving other benchmarks unexplored.
- **Why unresolved**: KIBA focuses specifically on kinase-inhibitor interactions; performance on broader protein classes (GPCRs, ion channels) or datasets like BindingDB, DAVIS, or ChEMBL remains unknown.
- **What evidence would resolve it**: Experiments replicating the CP framework on at least 2-3 additional DTI datasets with distinct protein target distributions, comparing coverage, interval width, and MACG metrics.

### Open Question 2
- **Question**: Would normalized nonconformity scores accounting for heteroscedasticity improve interval efficiency compared to the absolute residual used in this study?
- **Basis in paper**: [explicit] The authors acknowledge using normalized scores (Equation 2) when data is heteroscedastic, but state they "assume that the transformed data exhibit homoscedastic behavior" and use absolute residuals instead.
- **Why unresolved**: The homoscedasticity assumption after Box-Cox transformation was not empirically validated; residual variance may still vary across drug/protein subgroups, affecting interval tightness.
- **What evidence would resolve it**: Analysis of residual variance across drug and protein clusters post-transformation, followed by comparative experiments using variance-normalized nonconformity scores.

### Open Question 3
- **Question**: Can alternative clustering algorithms (e.g., hierarchical clustering, Gaussian mixture models) improve CCP-FC performance relative to k-means?
- **Basis in paper**: [inferred] CCP-FC underperforms CCP-NC across most splits despite using biologically meaningful features; k-means may not capture complex feature relationships optimal for calibration grouping.
- **Why unresolved**: Only k-means was tested; the paper does not explore whether different clustering paradigms could better align feature-based groupings with nonconformity patterns.
- **What evidence would resolve it**: Systematic comparison of 3-4 clustering algorithms on the same feature representations, evaluating resulting MACG and interval width under identical split strategies.

### Open Question 4
- **Question**: How sensitive are coverage guarantees to violations of exchangeability in the New Drug-Protein split, where distribution shift between calibration and test sets is most severe?
- **Basis in paper**: [inferred] The paper notes "observed deviations from the ideal coverage line may not necessarily indicate violations of the exchangeability assumption" but does not quantify or test exchangeability directly in this challenging scenario.
- **Why unresolved**: Exchangeability is assumed but not verified; when both drugs and proteins are unseen, calibration and test distributions may diverge significantly.
- **What evidence would resolve it**: Formal statistical tests for distributional similarity between calibration and test residuals in the New Drug-Protein split, combined with sensitivity analysis under controlled distribution shifts.

## Limitations
- The effectiveness of clustering-based CP methods depends on having sufficient calibration samples per entity to compute reliable ECDF embeddings
- The paper assumes homoscedasticity after Box-Cox transformation without empirical validation of this assumption
- Performance may degrade when both drug and protein entities are novel with no similar entities in calibration (New Drug-Protein split)

## Confidence

- **High**: CCP-NC achieves lower MACG and tighter intervals than MCP/GCP across multiple splits (supported by quantitative results in Tables 2-3 and Figure 7)
- **Medium**: The mechanism of exchangeability violation in Drug/Protein splits and its mitigation by clustering (supported by ablation studies but requires stronger distributional assumptions)
- **Medium**: Optimal γ and nclusters selection via grid search generalizes across splits (shows consistency in Figure 8 but optimal values vary substantially)

## Next Checks

1. **Stress test with minimal calibration**: For entities with <5 calibration samples, measure how CCP-NC interval widths and coverage compare to GCP fallback performance
2. **Exchangeability diagnostics**: Quantify residual distribution shifts between calibration and test sets per entity using KL divergence or Wasserstein distance; correlate with coverage gaps
3. **Scaling experiment**: Apply CCP-NC to a larger DTI dataset (e.g., STITCH or ChEMBL subsets) with >10K proteins to evaluate whether clustering remains effective when entity space grows exponentially