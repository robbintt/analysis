---
ver: rpa2
title: Single-Channel Distance-Based Source Separation for Mobile GPU in Outdoor and
  Indoor Environments
arxiv_id: '2501.03045'
source_url: https://arxiv.org/abs/2501.03045
tags:
- outdoor
- speech
- source
- indoor
- environments
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces a single-channel distance-based source separation
  (DSS) model for mobile GPUs that effectively handles both outdoor and indoor environments.
  The proposed architecture integrates a two-stage conformer block with linear relation-aware
  self-attention (RSA) and utilizes the TensorFlow Lite GPU delegate to optimize performance
  on mobile devices.
---

# Single-Channel Distance-Based Source Separation for Mobile GPU in Outdoor and Indoor Environments

## Quick Facts
- **arXiv ID:** 2501.03045
- **Source URL:** https://arxiv.org/abs/2501.03045
- **Authors:** Hanbin Bae; Byungjun Kang; Jiwon Kim; Jaeyong Hwang; Hosang Sung; Hoon-Young Cho
- **Reference count:** 32
- **Primary result:** 20x energy reduction and 10x speed improvement on mobile GPU while achieving better separation quality in both outdoor and indoor environments

## Executive Summary
This paper introduces a single-channel distance-based source separation (DSS) model optimized for mobile GPU deployment that effectively handles both outdoor and indoor environments. The proposed architecture integrates a two-stage conformer block with linear relation-aware self-attention (RSA) and utilizes the TensorFlow Lite GPU delegate to achieve significant performance improvements on mobile devices. The model demonstrates robust separation quality across various signal-to-noise ratios and outperforms existing approaches in SI-SDRi metrics while maintaining efficient mobile execution.

## Method Summary
The method uses a modified CMGAN architecture with four two-stage conformer (TS-Conformer) blocks that capture time and frequency dependencies through multi-head self-attention and CNN layers. The key innovation is replacing standard quadratic self-attention with linear RSA using EfficientAttention combined with Rotary Positional Embedding (RoPE), reducing computational complexity from O(N²d) to O(Nd²). The model outputs both near and far source estimates through separate decoder paths that receive intermediate outputs from the 2nd and 4th TS-Conformer blocks respectively. Training uses a 60:40 indoor-to-outdoor data ratio with simulated room impulse responses, and the implementation follows specific constraints for TFLite GPU delegate compatibility including avoiding reshapes and using only supported operations.

## Key Results
- Achieves 20x energy reduction and 10x speed improvement (0.15% energy, 0.16 RTF) compared to mobile CPU processing (3.00% energy, 1.55 RTF)
- Outperforms existing approaches in SI-SDRi metrics across all distance ranges, with near-only cases showing 68.2 dB improvement versus 24.6 dB for baseline
- Mixed 60:40 indoor-outdoor training improves both indoor and outdoor performance compared to pure indoor training
- Demonstrates robust separation quality in outdoor environments containing background noise

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Linear relation-aware self-attention (RSA) reduces computational complexity from O(N²d) to O(Nd²) while preserving distance-based separation quality.
- **Mechanism:** The architecture replaces traditional quadratic RSA with linear RSA using EfficientAttention combined with Rotary Positional Embedding (RoPE). The linear form computes σ_q(Q_r){σ_k(K_r^T)V}/√d, where RoPE provides relative positional information without trainable embedding parameters.
- **Core assumption:** Relative positional relationships critical for distance perception can be captured through rotary embeddings rather than learned relative positional matrices.
- **Evidence anchors:** Abstract states linear RSA enhances context awareness leading to improved DSS performance; Section III-B details O(Nd²) complexity and efficiency benefits.
- **Break condition:** If relative distance cues require explicit learnable positional embeddings rather than fixed rotary patterns, separation quality may degrade for sources at ambiguous distances.

### Mechanism 2
- **Claim:** Two-stage conformer blocks enable GPU delegate compatibility while capturing joint time-frequency dependencies for distance estimation.
- **Mechanism:** Four TS-Conformer blocks process encoded spectrograms through interleaved multi-head self-attention and CNN layers. Outputs from the 2nd and 4th blocks route to separate decoder paths for near and far sources.
- **Core assumption:** Near and far sources have distinguishable time-frequency signatures that can be separated at different processing depths.
- **Evidence anchors:** Section III-A describes the hierarchical separation approach; Table II shows significant improvements for near-only cases.
- **Break condition:** If environmental noise shares spectral characteristics with near speech, early-block separation may incorrectly route noise to near output.

### Mechanism 3
- **Claim:** TensorFlow Lite GPU delegate achieves 20x energy reduction and 10x speed improvement by enforcing tensor shape consistency and using GPU-optimized operations.
- **Mechanism:** Implementation follows two constraints: use only GPU-supported layers and maintain consistent batch size across all tensors. Specific optimizations include excluding reshape operations and implementing custom Conv1D.
- **Core assumption:** The GPU delegate's supported operation set is sufficient for conformer-based audio processing without architectural compromises that degrade quality.
- **Evidence anchors:** Section III-C details the two rules for GPU delegate compatibility; Table I shows measured energy and RTF improvements.
- **Break condition:** If future TFLite updates change GPU delegate operation support, custom layers may require reimplementation.

## Foundational Learning

- **Concept: Self-attention complexity scaling**
  - Why needed here: Understanding why O(N²) attention becomes prohibitive for audio sequences explains the motivation for linear attention alternatives.
  - Quick check question: Given a 3-second audio input with STFT hop size 128 samples at 16kHz, approximately how many time frames does the attention mechanism process? (Answer: ~375 frames; quadratic attention would require ~140,000 pairwise comparisons)

- **Concept: Direct-to-reverberation ratio (DRR) as distance cue**
  - Why needed here: The paper explicitly states DRR difficulty in outdoor environments motivates specialized training; understanding this explains why outdoor DSS is harder than indoor.
  - Quick check question: In an anechoic outdoor environment versus a reverberant room, which would have a more distinguishable DRR difference between a source at 0.3m versus 1.5m? (Answer: Reverberant room; outdoor anechoic conditions eliminate reverberation cues)

- **Concept: STFT-based masking for source separation**
  - Why needed here: The architecture outputs both a spectral mask and complex spectrogram refinement; understanding mask-based separation is prerequisite to interpreting the dual-decoder design.
  - Quick check question: If a mask value at a time-frequency bin is 0.8 for the near output and 0.2 for the far output, what does this imply about the source contribution at that bin? (Answer: 80% of energy attributed to near source, 20% to far; near mask dominates)

## Architecture Onboarding

- **Component map:** Input waveform → STFT → Power-law compression → Encoder (Dilated DenseNet) → Separator (4× TS-Conformer with linear RSA) → Near Decoder (from Block 2) and Far Decoder (from Block 4) → ISTFT → Output waveforms

- **Critical path:** The linear RSA implementation in TS-Conformer is the make-or-break component for GPU delegate compatibility. Verify that RoPE is correctly applied to Q and K before kernel feature maps, and confirm no reshape operations occur within the attention computation.

- **Design tradeoffs:**
  - Linear RSA vs Quadratic RSA: Linear enables mobile GPU deployment but may lose explicit physical cue modeling; paper acknowledges this tradeoff
  - 60:40 indoor:outdoor training ratio: Mixed training outperforms indoor-only even for indoor test cases, but requires 40% more outdoor data collection
  - Separate near/far decoder depth: Blocks 2→near, 4→far creates asymmetric processing; assumption is far sources require more refinement

- **Failure signatures:**
  - Permutation ambiguity in UR-0 range (0.5-0.8m): Near sources incorrectly appear in far output; paper identifies this as unresolved
  - GPU delegate fallback to CPU: Check for unsupported operations via TFLite profiling; bidirectional LSTM and quadratic RSA will trigger fallback
  - SI-SDRi degradation on unseen outdoor noise: If test noise differs substantially from training noise categories, far separation quality drops

- **First 3 experiments:**
  1. **Validate GPU delegate activation:** Run inference on target mobile device with TFLite profiler; confirm GPU delegate handles all operations (no CPU fallback). Compare RTF against Table I baseline (target: ≤0.16 RTF).
  2. **Ablate training data ratio:** Train with 100:0, 75:25, 60:40, 40:60 indoor:outdoor ratios on held-out test set; plot SI-SDRi for both environment types to verify 60:40 optimality claim for your deployment context.
  3. **Characterize UR-0 boundary behavior:** Synthesize test samples with near sources at distances [0.4, 0.5, 0.6, 0.7, 0.8, 0.9]m; measure near→far leakage rate to quantify permutation ambiguity severity for your application's distance threshold requirements.

## Open Questions the Paper Calls Out

- **Question:** Can hierarchical embeddings jointly representing distance and speaker information resolve the permutation ambiguity problem in the near-far boundary region (UR-0: 0.5–0.8 m)?
- **Question:** Would integrating a metric GAN with task-specific discriminators improve DSS performance, and can it be made compatible with mobile GPU delegates?
- **Question:** To what extent does the simplified outdoor simulation (anechoic walls in Pyroomacoustics) fail to capture real-world outdoor acoustic phenomena?

## Limitations

- **Permutation Ambiguity in Distance Classification:** The model exhibits difficulty distinguishing sources within the 0.5-0.8m range (UR-0), where near sources may incorrectly appear in the far output, representing a fundamental limitation of single-channel DSS.
- **Computational Complexity Tradeoffs:** While linear RSA reduces complexity from O(N²d) to O(Nd²), the paper acknowledges this may not capture physical distance cues as explicitly as quadratic attention.
- **Environmental Generalization:** The 60:40 indoor-outdoor training ratio improves overall performance but requires substantial outdoor data collection, and effectiveness for specific outdoor noise types not represented in training remains untested.

## Confidence

- **High Confidence:** Mobile GPU optimization claims supported by measured RTF and energy consumption metrics; linear RSA computational complexity reduction verified through mathematical formulation.
- **Medium Confidence:** Outdoor DSS performance improvements in mixed training scenarios; two-stage conformer block effectiveness for near/far hierarchical separation.
- **Low Confidence:** Permutation ambiguity severity in UR-0 range; generalization to unseen outdoor noise environments; long-term stability of mobile GPU delegate compatibility across TFLite versions.

## Next Checks

1. **GPU Delegate Compatibility Verification:** Profile TFLite GPU delegate execution on target mobile device to confirm all operations map to GPU (no CPU fallback) and measure actual RTF against claimed 0.16 benchmark.

2. **UR-0 Range Characterization:** Systematically test separation quality for sources at distances 0.4-0.9m in 0.1m increments to quantify permutation ambiguity severity and identify distance thresholds where misclassification occurs.

3. **Environmental Noise Generalization:** Test model performance on outdoor noise types (wind, traffic, crowd noise) not present in training corpus to assess real-world deployment robustness beyond simulated anechoic conditions.