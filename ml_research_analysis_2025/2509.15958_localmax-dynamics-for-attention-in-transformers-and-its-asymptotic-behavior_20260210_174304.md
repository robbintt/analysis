---
ver: rpa2
title: Localmax dynamics for attention in transformers and its asymptotic behavior
arxiv_id: '2509.15958'
source_url: https://arxiv.org/abs/2509.15958
tags:
- dynamics
- iptq
- such
- xiptq
- then
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a new discrete-time attention model called
  localmax dynamics, which interpolates between softmax and hardmax dynamics by introducing
  an alignment-sensitivity parameter. The key contribution is the definition of quiescent
  sets to characterize the invariant behavior of tokens near vertices of the limiting
  convex polytope.
---

# Localmax dynamics for attention in transformers and its asymptotic behavior

## Quick Facts
- **arXiv ID:** 2509.15958
- **Source URL:** https://arxiv.org/abs/2509.15958
- **Reference count:** 33
- **Primary result:** Introduces localmax dynamics with alignment-sensitivity parameter and characterizes asymptotic behavior via quiescent sets near polytope vertices.

## Executive Summary
This paper introduces localmax dynamics, a discrete-time attention model that interpolates between softmax and hardmax by introducing an alignment-sensitivity parameter δ. The key innovation is the definition of quiescent sets to characterize the invariant behavior of tokens near vertices of the limiting convex polytope. The paper proves that localmax dynamics does not exhibit finite-time convergence and characterizes asymptotic behavior under time-varying alignment sensitivity parameters, showing that vanishing δ recovers hardmax behavior. Lyapunov-based methods from classical opinion dynamics are adapted but found to have limitations in the asymmetric setting of localmax interactions.

## Method Summary
The method analyzes a discrete-time dynamical system where tokens update positions based on weighted averages of neighbors within an alignment-sensitive strip. The update rule uses a neighborhood defined by tokens whose inner product with the reference token is within δ of the maximum. The analysis assumes a symmetric positive definite interaction matrix A (set to identity in the theoretical treatment) and studies how tokens converge to vertices of a limiting convex polytope. The framework introduces quiescent sets to capture invariant behavior near vertices and proves geometric convergence rates for trapped tokens. The method extends classical opinion dynamics techniques while highlighting their limitations for asymmetric interactions.

## Key Results
- Localmax dynamics converges to a convex polytope K, with tokens clustering around vertices or points in the Maximal Alignment Set S
- Quiescent sets B(v, ε) trap tokens near non-zero vertices v, ensuring geometric convergence to those vertices
- Constant δ can lead to artifacts (non-vertex limit points), while vanishing δ(t) → 0 recovers hardmax behavior
- Standard Lyapunov methods fail to fully characterize convergence due to asymmetric neighborhood structures

## Why This Works (Mechanism)

### Mechanism 1: Alignment-Sensitive Neighborhood Relaxation
By parameterizing the strict "hardmax" selection rule with an alignment sensitivity parameter δ, the dynamics interpolate between exclusive attention to the most influential token and broader soft-max-like mixing. The model modifies the neighborhood definition from selecting only tokens maximizing influence to selecting tokens within a "strip" of width δ relative to the maximizer, allowing weighted average influence from neighbors within this strip rather than just the top-aligned token or all tokens.

### Mechanism 2: Asymptotic Invariance via Quiescent Sets
Tokens entering a sufficiently small neighborhood of a non-zero vertex of the limiting convex polytope eventually become "quiescent," meaning they remain trapped and converge to that vertex geometrically. The paper defines "quiescent sets" and proves that if a token enters a ball B(v, ε) around a vertex v, it cannot leave and converges to v with a geometric rate proportional to 1/(1+α).

### Mechanism 3: Recovery of Hardmax Dynamics via Vanishing Sensitivity
Introducing a time-varying, vanishing alignment sensitivity δ(t) → 0 eliminates "spurious" equilibrium points and forces convergence to the Maximal Alignment Set (vertices or projections). While constant δ allows tokens to get stuck in "artifacts" or points outside the Maximal Alignment Set, forcing the neighborhood width to shrink over time recovers the asymptotic behavior of hardmax.

## Foundational Learning

- **Concept: Convex Hulls & Polytopes**
  - **Why needed here:** The paper proves that the convex hull of tokens collapses to a limiting convex polytope K. Understanding the geometry of K (vertices, facets) is essential to predicting where tokens cluster.
  - **Quick check question:** Can you identify the vertices of the convex hull for a set of 3 points in a 2D plane?

- **Concept: Discrete-time Dynamical Systems**
  - **Why needed here:** The model is defined by a recurrence relation x(t+1) = x(t) + .... The analysis depends on understanding how state updates iteratively, unlike the continuous-time ODEs also common in attention literature.
  - **Quick check question:** If x(t+1) = 0.5 x(t), what is the asymptotic limit of x(t)?

- **Concept: Lyapunov Stability**
  - **Why needed here:** The authors adapt Lyapunov methods to analyze stability but find them insufficient for the asymmetric case. Section 6 explicitly discusses the challenges and failure modes of standard Lyapunov functions.
  - **Quick check question:** What property must a function V(x) satisfy to be a valid Lyapunov function for a stable system?

## Architecture Onboarding

- **Component map:** Input X → Neighborhood Computation C_i^δ(t) → Update Rule → Output X(t+1) and limiting polytope K

- **Critical path:** The calculation of the neighborhood C_i^δ(t) is the computational bottleneck. It requires computing O(n²) inner products per step plus the sorting/thresholding logic to find the δ-strip.

- **Design tradeoffs:**
  - **Constant δ:** Higher expressivity; allows for more complex clustering and non-vertex equilibria. *Risk:* May converge to "artifacts" (non-vertex points) and never strictly settle (geometric convergence only).
  - **Vanishing δ(t):** Enforces convergence to vertices (Maximal Alignment Set), behaving like hardmax asymptotically. *Risk:* Loses the "soft" interpolation benefits early in training/inference if δ vanishes too fast.
  - **Symmetry:** The mechanism assumes A is symmetric (Q^T K). Standard transformer attention uses asymmetric QK^T; applying this model requires architectural constraints or approximations on Q and K.

- **Failure signatures:**
  - **Rank Collapse:** If interactions are too strong or normalization fails, tokens may collapse to a single point (vertex or origin) prematurely.
  - **Non-Vertex Clustering:** With constant δ, observing tokens settling on edges or facets of K (not vertices) is expected behavior, not a bug.
  - **Oscillation:** If δ is large and α is aggressive, tokens might oscillate near vertices without settling (though Theorem 4.1 suggests geometric convergence if trapped).

- **First 3 experiments:**
  1. **Visualizing the Strip:** Implement Eq. (5) in 2D. Plot the "strip" Z_i(t) for a token to verify visually that it captures the "local max" neighbors plus the δ-band, contrasting it with standard hardmax (k=1) and softmax (k=n).
  2. **Quiescent Set Verification:** Initialize tokens randomly near a vertex of a predefined polytope. Run the dynamics with constant δ. Verify that tokens inside B(v, δ/(2+2α)) never leave and converge geometrically (plot log(distance) vs time).
  3. **Vanishing δ Test:** Compare constant δ vs δ(t) = 1/t. Run the dynamics for a fixed large T. Plot the histogram of final token distances to the nearest vertex. Confirm that vanishing δ drives tokens closer to vertices (Set S) while constant δ leaves residual artifacts.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** Can a complete characterization of the asymptotic convergence properties of localmax dynamics be derived, specifically overcoming the challenges posed by the asymmetric neighborhood structure?
- **Basis:** Section 7.1 (Point 1) states that despite macro-level results, a "complete understanding of the convergence properties... remains elusive" and attributes this to asymmetry.
- **Why unresolved:** Standard Lyapunov methods used for symmetric dynamics (like Hegselmann-Krause) fail to capture the behavior of tokens in the set S₂ (tokens not converging to vertices), as shown in Section 6.
- **What evidence would resolve it:** A rigorous mathematical proof classifying all possible limit sets (beyond just the maximal alignment set) or a counter-example demonstrating non-convergent behavior.

### Open Question 2
- **Question:** Can suitably designed, potentially non-monotone, Lyapunov functions be constructed to effectively analyze the convergence of asymmetric localmax dynamics?
- **Basis:** Section 7.1 (Point 2) notes that while classical methods fail, "non-monotone [Lyapunov functions] – may still be viable."
- **Why unresolved:** The Lyapunov candidate (Eq. 41) presented in Section 6 provides only an estimate on the decrease rate and fails to describe the dynamics of the set S₂ (Theorem 6.3).
- **What evidence would resolve it:** The derivation of a specific non-monotone Lyapunov function that strictly decreases along trajectories, leading to a convergence theorem for the asymmetric case.

### Open Question 3
- **Question:** Do limit points located outside the maximal alignment set S carry physical or interpretive meaning, or are they merely numerical artifacts of the constant alignment sensitivity?
- **Basis:** Section 7.1 (Point 4) asks if such points "carry any physical or interpretive meaning... or merely numerical artifacts."
- **Why unresolved:** While the paper proves convergence to a convex polytope K, it shows via Remark 3.1 that trajectories can converge to points in Sᶜ (non-vertices), a phenomenon caused by constant δ that lacks theoretical explanation.
- **What evidence would resolve it:** An interpretation of these non-vertex limit points within the context of opinion dynamics or empirical evidence linking them to specific stable configurations in transformer attention.

## Limitations
- The theoretical analysis assumes a symmetric positive definite interaction matrix A = I_d, but standard transformer attention uses asymmetric QK^T, creating a practical implementation gap.
- While asymptotic convergence to the Maximal Alignment Set S is proven, explicit convergence rates for the full system are not provided, only geometric rates for tokens trapped in quiescent sets.
- The quiescent set analysis depends critically on the parameter constraint ε ≤ δ/(2+2α); violating this condition breaks the convergence guarantees.

## Confidence
- **High Confidence:** The characterization of quiescent sets and their invariance properties (Theorem 4.1) is mathematically rigorous and well-supported by the proof structure.
- **Medium Confidence:** The claim that vanishing δ(t) → 0 recovers hardmax behavior (Theorem 5.1) is proven, but its practical implementation and effectiveness in preventing artifacts requires empirical validation.
- **Low Confidence:** The adaptation of Lyapunov methods to localmax dynamics is discussed in Section 6, but the failure modes and limitations are not fully resolved. The asymmetric nature of standard attention suggests these methods may need significant modification.

## Next Checks
1. **Practical Implementation Gap:** Implement the localmax dynamics using the asymmetric QK^T matrix from standard transformers. Compare convergence behavior with the theoretical predictions based on A = I_d. Document any divergence or clustering patterns that emerge.

2. **Convergence Rate Validation:** For varying n (token count), α, and δ, measure the actual time to convergence to vertices of the limiting polytope K. Compare these empirical rates against the theoretical geometric convergence rates for quiescent sets. Identify parameter regimes where convergence is impractically slow.

3. **Lyapunov Function Construction:** Attempt to construct a valid Lyapunov function for localmax dynamics with asymmetric A. Test whether the function decreases along trajectories in practice. If it fails, document the specific interaction patterns that cause the failure and explore alternative stability analysis techniques.