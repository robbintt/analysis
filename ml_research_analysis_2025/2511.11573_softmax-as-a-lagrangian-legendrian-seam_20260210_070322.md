---
ver: rpa2
title: Softmax as a Lagrangian-Legendrian Seam
arxiv_id: '2511.11573'
source_url: https://arxiv.org/abs/2511.11573
tags:
- softmax
- seam
- geometry
- contact
- screen
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper establishes a geometric framework modeling softmax as
  a contact interface between two potential-generated Lagrangian descriptions. The
  logits-to-probabilities transformation is represented as a Legendrian seam on a
  contact screen (the probability simplex) within a folded symplectic collar.
---

# Softmax as a Lagrangian-Legendrian Seam

## Quick Facts
- arXiv ID: 2511.11573
- Source URL: https://arxiv.org/abs/2511.11573
- Authors: Christopher R. Lee-Jenkins
- Reference count: 9
- One-line primary result: Softmax is modeled as a Legendrian seam on a contact screen where two potential-generated Lagrangian graphs meet in a folded symplectic collar.

## Executive Summary
This paper establishes a geometric framework for understanding softmax as a contact interface between two potential-generated Lagrangian descriptions. The logit-to-probability transformation is represented as a Legendrian seam on a contact screen (the probability simplex) within a folded symplectic collar. This construction reveals bias-shift invariance as Reeb flow on the screen and provides the Fenchel-Young equality/KL gap as a computable distance to the seam. The work demonstrates these concepts concretely for two- and three-class cases, offering a bridge between machine learning normalization steps and symplectic/contact geometry.

## Method Summary
The method models softmax using convex duality between negative entropy ϕ(y) = Σ yᵢ log yᵢ and log-sum-exp ϕ*(z) = log Σ eᵐᶻ. These potentials generate two Lagrangian graphs (L+ and L-) in a folded symplectic collar M = Rᵣ × Z with 2-form ωₐ = dr ∧ α + r²dα. The graphs meet along a Legendrian seam Γ at r = 0, where y = softmax(z). The contact 1-form α = Σ zᵢ dyᵢ on the screen Z captures the logit-to-probability relationship, while the Fenchel-Young gap ϕ(y) + ϕ*(z) - ⟨z,y⟩ = KL(y||softmax(z)) provides a quantitative measure of distance to the seam.

## Key Results
- Softmax transformation is geometrically represented as passage through a Legendrian seam where two Lagrangian graphs meet
- Bias-shift invariance z → z + c1 is intrinsic to the contact geometry as Reeb flow on the screen
- The Fenchel-Young gap/KL divergence provides a computable geometric distance from any (z,y) pair to the seam
- Concrete 2-class and 3-class visualizations demonstrate the seam structure and verification of theoretical claims

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Softmax can be modeled as a Legendrian seam where two Lagrangian graphs meet on a contact screen
- Mechanism: The logit-to-probability transformation connects two potential-generated descriptions: negative entropy ϕ(y) = Σ yᵢ log yᵢ and its convex conjugate ϕ*(z) = log Σ eᵐᶻ. Their gradients satisfy y = ∇ϕ*(z) = softmax(z) and z ∈ ∇ϕ(y) = log y + c1. These graphs (L+ and L-) lie in a folded symplectic collar M = Rᵣ × Z with 2-form ωₐ = dr ∧ α + r²dα, meeting along the seam Γ where Fenchel-Young equality holds
- Core assumption: The convex duality relationship persists under the folded symplectic extension near r = 0
- Evidence anchors:
  - [abstract] "Two potential-generated, conservative descriptions (from negative entropy and log-sum-exp) meet along a Legendrian 'seam' on a contact screen"
  - [section 2] "The seam Γ ⊂ {r = 0} consists of pairs (y, [z]) with y = ∇ϕ*(z)" and "is Legendrian: α annihilates all tangents to Γ"
- Break condition: If the 2-form ωₐ fails to remain nondegenerate for r ≠ 0, or if the Legendrian condition ker α fails on Γ

### Mechanism 2
- Claim: Bias-shift invariance z → z + c1 integrates the Reeb flow on the contact screen
- Mechanism: The contact 1-form α = Σ zᵢ dyᵢ on screen Z has Reeb vector field R characterized by α(R) = 1 and dα(R, ·) = 0. The flow z → z + c1 satisfies these conditions, making bias invariance intrinsic to the contact geometry rather than an algebraic accident
- Core assumption: The quotient space Rᵈ/⟨1⟩ properly captures logit equivalence classes
- Evidence anchors:
  - [abstract] "Bias-shift invariance appears as Reeb flow on the screen"
  - [section 2] "The flow z → z + c1 integrates the Reeb vector field, making bias-shift invariance intrinsic to the screen"
- Break condition: If the Reeb flow fails to preserve the contact structure, or if α is not well-defined on the quotient

### Mechanism 3
- Claim: The KL divergence provides a computable geometric distance from any (z, y) pair to the seam
- Mechanism: The Fenchel-Young gap ϕ(y) + ϕ*(z) - ⟨z, y⟩ equals KL(y∥softmax(z)), which is nonnegative and zero precisely on the seam. This converts the geometric condition "being Legendrian" into a numerically tractable loss
- Core assumption: KL divergence properly measures deviation from Legendrian contact in this construction
- Evidence anchors:
  - [abstract] "The Fenchel-Young equality/KL gap provides a computable distance to the seam"
  - [section 2] "The nonnegativity ϕ(y) + ϕ*(z) - ⟨z, y⟩ = KL(y∥softmax(z)) ≥ 0 provides a quantitative, readily computed distance from any (z, y) to the seam"
- Break condition: If the KL gap fails to vanish on Legendrian points or is nonzero off-seam

## Foundational Learning

- Concept: Contact Geometry and Legendrian Submanifolds
  - Why needed here: Provides the mathematical framework for the screen Z, the 1-form α, and why the seam being "Legendrian" means α vanishes on tangent vectors to Γ
  - Quick check question: Given a contact 1-form α on a (2n+1)-dimensional manifold, what dimension must a Legendrian submanifold have?

- Concept: Convex Conjugacy (Fenchel Duality)
  - Why needed here: Explains why negative entropy and log-sum-exp are paired potentials whose gradients give softmax and its inverse
  - Quick check question: If ϕ*(z) is the convex conjugate of ϕ(y), what is the relationship between ∇ϕ and ∇ϕ*?

- Concept: Symplectic Fold and Quadratic Collar
  - Why needed here: The 2-form ωₐ = dr ∧ α + r²dα creates a "fold" at r = 0 where the form degenerates; understanding this is essential for seeing how L+ and L- meet at Γ
  - Quick check question: For what values of r is ωₐ nondegenerate, and what happens at r = 0?

## Architecture Onboarding

- Component map:
  - Logit space: Rᵈ with quotient Rᵈ/⟨1⟩ (logits modulo constant shifts)
  - Probability simplex: Int Δ = {y : yᵢ > 0, Σ yᵢ = 1}
  - Screen Z: Product of simplex with logit equivalence classes, carrying 1-form α = Σ zᵢ dyᵢ
  - Folded collar M: Rᵣ × Z with quadratic symplectic form ωq = dr∧α + r²dα
  - Lagrangian graphs L±: Potential-generated submanifolds on r > 0 and r < 0 sides
  - Seam Γ: Legendrian intersection at r = 0 where softmax transformation lives

- Critical path: Understanding softmax as passage through the seam—from logit equivalence class [z] in L- to probability y = softmax(z) in L+ across the contact screen at r = 0

- Design tradeoffs: The paper notes this construction is local; global invariants require compactifying logit space (projective or spherical models). Gauge choice (e.g., zero-mean Π(y)) affects numerical representation but translates along Reeb direction

- Failure signatures: Numerical instability near r = 0 (the fold); KL gap failing to converge to zero indicating off-seam dynamics; loss of contact structure if α becomes degenerate

- First 3 experiments:
  1. Reproduce the 2-class visualization: plot the seam p = σ(Δ) on (Δ, p) coordinates with Fenchel-Young gap as background to verify it vanishes on the seam
  2. Implement the 3-class centered-logit map: verify α = (z₁ - z₃)du + (z₂ - z₃)dv is invariant under z → z + c1
  3. Test gauge dependence: apply zero-mean gauge Π(y) vs. alternative gauges and confirm they differ only by Reeb translation

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the local folded symplectic construction be extended to a compact ambient model (projective or spherical) for logit space?
- Basis in paper: [explicit] "What we present is also local... one would like a compact ambient model for logit space—e.g., working modulo scale and mean so that logits descend to a projective space, or after normalization to a sphere"
- Why unresolved: The current construction uses an open collar near the fold; extending to a closed manifold requires new geometric machinery
- What evidence would resolve it: Explicit construction of a compact symplectic manifold containing the seam with preserved Legendrian/Lagrangian structure and global coordinate charts

### Open Question 2
- Question: What is the precise geometric relationship between replicator dynamics and the contact/symplectic structure on the screen?
- Basis in paper: [explicit] Abstract mentions "connections to information geometry where on-screen dynamics manifest as replicator flows"; conclusion states "screen dynamics... are exactly replicator dynamics"
- Why unresolved: The connection is noted but the interaction between replicator flow and Reeb flow/Legendrian condition remains unexplored
- What evidence would resolve it: Theorems characterizing replicator trajectories as geodesics or Hamiltonian flows within the contact structure, with explicit formulas relating the two

### Open Question 3
- Question: Do new geometric phenomena emerge in the d > 3 class setting beyond the d=2,3 cases?
- Basis in paper: [inferred] The paper provides explicit computations only for two- and three-class cases; generalization to higher dimensions is stated but not verified
- Why unresolved: Contact geometry can exhibit dimension-dependent phenomena (e.g., overtwisted structures appear only in dimension ≥ 3)
- What evidence would resolve it: Explicit construction and analysis of the seam, Lagrangian graphs, and collar form for d ≥ 4, with comparison to low-dimensional behavior

### Open Question 4
- Question: Can this framework yield practical ML benefits such as compact logit parameterizations or new optimization strategies?
- Basis in paper: [explicit] Abstract states this "potentially enabl[es] compact logit models"; conclusion proposes "next steps for ML: compact logit models (projective or spherical)"
- Why unresolved: No implementation or experiments are provided; the framework remains theoretical without demonstrated utility
- What evidence would resolve it: Neural network architectures using the proposed compact parameterization, showing reduced parameter count or improved training dynamics on benchmark tasks

## Limitations
- The construction is local rather than global, requiring additional mathematical machinery for compactification
- No practical machine learning applications or implementations are demonstrated beyond toy examples
- Computational considerations for high-dimensional settings are not addressed
- The theoretical framework lacks experimental validation on real-world ML tasks

## Confidence

- Mechanism 1 (Legendrian seam as softmax interface): **High** - The mathematical construction is well-defined with explicit formulas and the Fenchel-Young gap provides a concrete verification criterion
- Mechanism 2 (Bias-shift as Reeb flow): **High** - The contact geometry is standard and the characterization of the Reeb vector field is explicit and verifiable
- Mechanism 3 (KL as geometric distance): **High** - The KL divergence formula and its relationship to the Fenchel-Young gap are standard results in convex analysis, directly applicable here

## Next Checks

1. **Numerical Verification**: Implement the 3-class centered-logit map and verify that the KL gap vanishes exactly on the seam while maintaining numerical stability across different gauge choices

2. **Geometric Invariance**: Test the Reeb flow property by confirming that the KL gap and seam structure remain invariant under arbitrary logit shifts z → z + c·1 for various values of c

3. **Generalization Test**: Extend the construction to 4+ classes and verify that the Legendrian seam property and contact geometry framework continue to hold, particularly examining how the dimensional growth affects the quadratic collar structure