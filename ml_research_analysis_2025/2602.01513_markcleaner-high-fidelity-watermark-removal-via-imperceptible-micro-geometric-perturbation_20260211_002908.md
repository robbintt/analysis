---
ver: rpa2
title: 'MarkCleaner: High-Fidelity Watermark Removal via Imperceptible Micro-Geometric
  Perturbation'
arxiv_id: '2602.01513'
source_url: https://arxiv.org/abs/2602.01513
tags:
- watermark
- removal
- image
- semantic
- gaussian
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper identifies that semantic watermarks, which embed signals
  through high-level semantic structure coupling, are fundamentally vulnerable to
  micro-geometric perturbations that disrupt phase alignment. To exploit this vulnerability,
  the authors propose MarkCleaner, a novel framework that removes watermarks by learning
  imperceptible spatial displacements rather than regenerating content.
---

# MarkCleaner: High-Fidelity Watermark Removal via Imperceptible Micro-Geometric Perturbation

## Quick Facts
- **arXiv ID:** 2602.01513
- **Source URL:** https://arxiv.org/abs/2602.01513
- **Reference count:** 39
- **Primary result:** Achieves TPR@1%FPR ≈ 0 across 12 watermarking schemes with 5.58 FPS real-time inference

## Executive Summary
MarkCleaner introduces a novel approach to watermark removal by exploiting the vulnerability of semantic watermarks to micro-geometric perturbations that disrupt phase alignment in the latent Fourier domain. Instead of regenerating content, the method learns imperceptible spatial displacements through a 2D Gaussian Splatting decoder, trained with geometrically perturbed supervision to maintain semantic consistency. The framework achieves superior watermark removal effectiveness while preserving visual fidelity and enabling real-time performance, orders of magnitude faster than existing methods. The work reveals that geometric robustness should be prioritized in future watermark design.

## Method Summary
MarkCleaner removes watermarks by learning imperceptible spatial displacements rather than regenerating content. The framework combines mask-guided encoding with a 2D Gaussian Splatting decoder to parameterize geometric perturbations, trained using geometrically perturbed supervision to maintain semantic consistency. The method uses a UNet encoder with dual-domain masking (Frequency Band Masking + Spatial Random Masking) followed by a 2DGS decoder that predicts Gaussian parameters per patch. During training, the rendered output is supervised against a perturbed target (rotation → translation → scaling → padding), forcing the model to learn perturbation-invariant features while the decoder applies learned displacements at inference.

## Key Results
- Achieves TPR@1%FPR ≈ 0 across 12 diverse watermarking schemes
- Outperforms state-of-the-art methods by 0.4-7.4 dB in PSNR
- Enables real-time inference at 5.58 FPS, orders of magnitude faster than existing methods
- Maintains high visual fidelity (FID ≈ 133) while achieving complete watermark removal

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Semantic watermarks fail under micro-geometric perturbations due to phase coherence collapse in the latent Fourier domain.
- **Mechanism:** Pixel-domain transformations induce fractional latent shifts via VAE strided sampling, producing frequency-dependent phase ramps that rotate watermark vectors away from the real-axis manifold.
- **Core assumption:** Watermark detection relies on point-wise alignment between recovered latent Fourier coefficients and the embedded key within a ring mask.
- **Evidence anchors:** Abstract mentions breaking phase alignment; Section 3.2 shows phase modulation inflates L1 detection distance; neighbor papers focus on different watermarking domains.
- **Break condition:** If watermarks are phase-invariant or use magnitude-only representations, this mechanism degrades.

### Mechanism 2
- **Claim:** 2D Gaussian Splatting decouples geometry from appearance, enabling learnable sub-pixel spatial displacements without forced pixel-grid resynthesis.
- **Mechanism:** Each Gaussian primitive has explicit parameters (mean μ, covariance Σ, color c, opacity α). Patch-level rasterization allows micro-offsets to μ_i that spatially shift content while preserving appearance.
- **Core assumption:** The detector requires rigid pixel-grid synchronization; continuous rasterization disrupts this.
- **Evidence anchors:** Abstract mentions explicit parameterization of geometric perturbations; Section 4.2 defines Gaussian contributions with constrained μ_bias; no corpus papers discuss Gaussian splatting for watermark removal.
- **Break condition:** If detectors operate on continuous fields or are robust to sub-pixel shifts, displacement effects diminish.

### Mechanism 3
- **Claim:** Geometrically perturbed supervision trains the model to internalize spatial displacement as generation behavior rather than reconstruction error.
- **Mechanism:** During training, the rendered output is supervised against a perturbed target, not the original input, forcing the encoder to learn perturbation-invariant features while the decoder applies learned displacements at inference.
- **Core assumption:** DINOv2 features provide semantic anchors that survive masking and geometric shifts.
- **Evidence anchors:** Abstract mentions separating semantic content from strict spatial alignment; Section 4.3 explains supervising against perturbed targets; related watermark removal papers use regeneration or optimization, not perturbed supervision.
- **Break condition:** Without geometric augmentation, ablation shows TPR = 1.0 (complete failure) despite high fidelity.

## Foundational Learning

- **Concept: Fourier Phase Spectrum and Shift Theorem**
  - **Why needed here:** Understanding why translation causes phase scrambling in latent space, and why amplitude remains preserved.
  - **Quick check question:** If a 7-pixel translation in a 512×512 image flows through a VAE with stride 8, what fractional latent shift occurs? (Answer: δ = 7/8 ≈ 0.875 latent units)

- **Concept: VAE Strided Sampling and Aliasing**
  - **Why needed here:** The paper exploits non-equivariance of strided convolutions—geometric transforms don't propagate linearly.
  - **Quick check question:** Why does a rotation in pixel space not equal a rotation in latent space? (Answer: VAE kernels are fixed on rectilinear grids; rotational non-equivariance introduces distortion)

- **Concept: Differentiable Rasterization and Alpha Blending**
  - **Why needed here:** The 2DGS decoder requires understanding how gradients flow through Gaussian primitives to learn μ_bias.
  - **Quick check question:** In the rasterization equation, how does opacity α_i affect gradient magnitude for μ_i? (Answer: Higher opacity increases contribution weight, amplifying gradients through that primitive's position)

## Architecture Onboarding

- **Component map:** Input → FBM (frequency band masking) → SRM (spatial random masking) → UNet encoder → Gaussian decoder (MLP heads for μ_bias, c, σ, α) → Patch-level rasterization → Output

- **Critical path:**
  1. Geometric perturbation generation (rotation → translation → scaling → padding) creates perturbed target
  2. Dual-domain masking disrupts watermark patterns
  3. Gaussian decoder predicts μ_bias per patch; μ = μ_bias + μ_fix
  4. Rasterization renders displaced output; DINOv2 alignment preserves semantics

- **Design tradeoffs:**
  - **Fidelity vs. Erasure:** Ablation shows w/o GA achieves best FID but TPR = 1.0; full model trades ~2 FID points for TPR ≈ 0
  - **Patch size vs. memory:** Smaller patches reduce concurrent memory but increase blending complexity
  - **Mask ratio vs. feature quality:** Higher SRM ratios degrade DINOv2 features; MLP adapter compensates

- **Failure signatures:**
  - **w/o GA:** High fidelity, zero erasure—model reconstructs original spatial alignment
  - **w/o GR (UNet decoder):** Texture blurring, reduced geometric displacement—grid-based decoders struggle with sub-pixel shifts
  - **w/o CA:** Semantic drift despite geometric perturbation—DINOv2 guidance essential for content preservation
  - **Large visible watermarks:** Performance degrades; training uses random discrete masks, not continuous block masks

- **First 3 experiments:**
  1. Validate phase vulnerability by applying isolated rotation (5°) and translation (8px) to TreeRing-watermarked images; measure TPR@1%FPR drop (expect ~40% reduction)
  2. Ablate GA magnitude by sweeping translation from 0–15px with fixed 5° rotation; plot TPR vs. FID to find Pareto frontier (critical threshold at ||∆||₂ ≥ 8px)
  3. Test cross-scheme generalization by training on TreeRing only, evaluating on all 12 schemes to confirm displacement mechanism generalizes

## Open Questions the Paper Calls Out

- **Question:** Can training with continuous block-wise masking strategies bridge the performance gap for removing large contiguous visible watermarks?
- **Basis in paper:** The discussion notes that the random discrete masking strategy is less optimized for "large, continuous holes," and suggests incorporating "continuous mask patterns during training" as future work.
- **Why unresolved:** The current training objective optimizes for scattered perturbations, creating a domain gap when inferring on large, contiguous visible watermarks.
- **What evidence would resolve it:** Evaluation of a MarkCleaner variant trained with block-wise masks against datasets of large visible watermarks.

- **Question:** Can watermarking schemes be designed to be robust against micro-geometric phase-scrambling without relying on strict spatial alignment?
- **Basis in paper:** The paper concludes that "geometric robustness should be treated as a first-class consideration" and suggests regularizing encoders against phase-scrambling or using alias-free architectures to create geometry-invariant provenance.
- **Why unresolved:** Current semantic watermarks fundamentally rely on phase alignment, which MarkCleaner exploits; counter-measures are currently theoretical.
- **What evidence would resolve it:** A new watermarking method that maintains high detection rates after undergoing the micro-geometric perturbations applied by MarkCleaner.

- **Question:** Is it possible to close the fidelity gap induced by geometric perturbation supervision without sacrificing watermark removal effectiveness?
- **Basis in paper:** Table 3 shows a trade-off: the "Full Model" successfully removes watermarks (TPR 0.0) but has slightly worse FID (133.196) compared to the non-perturbed baseline (FID 131.487).
- **Why unresolved:** The geometric deviation strategy is the "decisive factor" for erasure, but it currently introduces a marginal cost to reconstruction fidelity.
- **What evidence would resolve it:** A modified MarkCleaner that achieves identical watermark suppression while matching or exceeding the FID of the "w/o GA" baseline.

## Limitations
- The core mechanism's vulnerability to phase scrambling may not extend to frequency-domain watermarking schemes that explicitly preserve phase
- The claim of "imperceptible" perturbations lacks quantitative validation through user studies or perceptual threshold analysis
- The reported 5.58 FPS real-time performance is measured only at 512×512 resolution, with no scaling analysis for larger images

## Confidence
- **High confidence:** Ablation study results (w/o GA failing completely, w/o CA causing semantic drift) are robust and directly support core claims
- **Medium confidence:** Fourier phase vulnerability mechanism is theoretically sound but lacks empirical validation across diverse watermark designs
- **Low confidence:** Real-time inference claim needs clarification—performance typically degrades significantly with larger resolutions, no scaling analysis provided

## Next Checks
1. **Phase-invariant watermark test:** Evaluate MarkCleaner against a frequency-domain watermarking scheme (e.g., DCT-based) that explicitly preserves phase coherence to determine if the geometric perturbation vulnerability generalizes
2. **Perceptual threshold validation:** Conduct a user study measuring just-noticeable differences (JND) for the micro-displacements (<1 pixel) to empirically confirm they meet the "imperceptible" claim
3. **Cross-resolution scalability:** Measure inference speed and watermark removal effectiveness at 1024×1024 resolution to validate real-time performance scales beyond 512×512 test conditions