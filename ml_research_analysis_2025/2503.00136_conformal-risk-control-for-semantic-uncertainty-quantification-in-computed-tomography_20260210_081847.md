---
ver: rpa2
title: Conformal Risk Control for Semantic Uncertainty Quantification in Computed
  Tomography
arxiv_id: '2503.00136'
source_url: https://arxiv.org/abs/2503.00136
tags:
- uncertainty
- risk
- length
- sem-crc
- control
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces a conformal risk control (CRC) procedure for
  organ-dependent uncertainty estimation in CT reconstruction. The key idea is to
  construct semantically adaptive uncertainty intervals by leveraging segmentation
  models that assign each pixel to an organ group, then minimize mean interval length
  via convex optimization.
---

# Conformal Risk Control for Semantic Uncertainty Quantification in Computed Tomography

## Quick Facts
- arXiv ID: 2503.00136
- Source URL: https://arxiv.org/abs/2503.00136
- Reference count: 34
- Primary result: Semantic-CRC achieves shorter uncertainty intervals (8.72×10^-2 vs 9.37×10^-2) while maintaining valid risk control at 0.10 for CT reconstruction tasks

## Executive Summary
This paper introduces conformal risk control (CRC) for semantic uncertainty quantification in CT reconstruction, providing organ-dependent uncertainty intervals that are both tighter and clinically interpretable. The method leverages segmentation models to assign pixels to organ groups and uses convex optimization to minimize mean interval length while ensuring risk control. Experiments on denoising and FBP-UNet reconstruction tasks demonstrate that the semantic-CRC approach consistently achieves shorter intervals than standard pixel-wise methods while maintaining valid coverage. The uncertainty maps generated are sharper and provide organ-specific information that reflects model performance across diverse patient anatomies.

## Method Summary
The approach combines conformal prediction with semantic segmentation to create organ-dependent uncertainty intervals. First, a 3D UNet quantile regression model is trained to predict 0.1 and 0.9 quantiles of the output distribution. A segmentation model (SuPrem) assigns each pixel to one of nine organ groups. The CRC framework then constructs intervals by minimizing mean interval length subject to a risk constraint (percentage of voxels outside intervals). Three variants are proposed: baseline CRC using pixel-wise quantiles, K-CRC grouping pixels into K clusters, and sem-CRC using semantic organ groups. The optimization problem is solved via convex programming with an ℓγ upper bound, and calibration is performed on held-out data to ensure valid coverage.

## Key Results
- Semantic-CRC achieves shortest mean interval lengths: 8.72×10^-2 for denoising and 2.12×10^-2 for reconstruction
- Maintains valid risk control at 0.10 tolerance across all methods and tasks
- Organ-specific risk control successfully achieved for individual structures
- Uncertainty maps are sharper and more clinically interpretable than baseline methods
- Performance consistent across denoising and FBP-UNet reconstruction tasks

## Why This Works (Mechanism)
The method works by exploiting semantic structure in medical images rather than treating each pixel independently. By grouping pixels into semantically meaningful organ categories, the optimization can learn different uncertainty scales for different structures based on their inherent variability and reconstruction difficulty. This allows tighter intervals for stable organs (like bones) while maintaining adequate coverage for challenging structures (like pancreas). The conformal framework ensures statistical validity regardless of the underlying model, while the semantic grouping provides the flexibility to adapt interval widths to local image characteristics.

## Foundational Learning
- **Conformal prediction**: Framework for creating statistically valid uncertainty intervals; needed for guaranteed coverage without distributional assumptions; quick check: verify risk ≤ 0.10 on calibration set
- **Quantile regression**: Predicts specific quantiles of output distribution rather than mean; needed to construct uncertainty intervals; quick check: verify pinball loss convergence during training
- **Convex optimization**: Solves the interval length minimization problem; needed to find optimal λ values efficiently; quick check: confirm convergence of solver within specified iterations
- **Semantic segmentation**: Groups pixels into organ categories; needed to create semantically adaptive intervals; quick check: verify organ-wise F1 scores > 0.8
- **Risk control**: Ensures bounded percentage of points outside intervals; needed for clinical reliability; quick check: compute empirical risk on test set
- **CT reconstruction geometry**: Helical cone beam with specific detector parameters; needed to generate realistic test cases; quick check: verify forward/backward projection consistency

## Architecture Onboarding

**Component Map**: TotalSegmentator/FLARE23 datasets -> Preprocessing (resample, window) -> ODL+ASTRA (sinogram generation) -> AbdomenAtlas-8K training -> 3D UNet quantile regression -> SuPrem segmentation -> CRC optimization (baseline/K-CRC/sem-CRC) -> Risk/calibration evaluation

**Critical Path**: Quantile regression model → Segmentation model → Convex optimization → Risk evaluation
The pipeline requires accurate quantile predictions, reliable segmentation, and successful convex optimization to produce valid uncertainty intervals.

**Design Tradeoffs**: 
- Semantic grouping vs pixel-wise: Semantic provides tighter intervals but depends on segmentation accuracy
- Number of groups (K vs organs): More groups allow finer adaptation but require more calibration data
- Calibration split size: Larger ncal improves coverage guarantees but reduces test data

**Failure Signatures**:
- Risk > 0.10: Calibration set not exchangeable with training, segmentation errors, or optimization failure
- Interval lengths not improving: Poor segmentation accuracy (F1 < 0.8) or λ values not varying across organs
- Non-convergence: Incorrect convex optimization setup or incompatible γ parameter

**3 First Experiments**:
1. Train 3D UNet quantile regression on AbdomenAtlas-8K and verify 0.1/0.9 quantile predictions on held-out data
2. Run SuPrem segmentation on TotalSegmentator test set and compute structure-wise F1 scores for 9 organs
3. Implement baseline CRC and verify risk control at 0.10 on calibration set before proceeding to semantic variants

## Open Questions the Paper Calls Out
None

## Limitations
- Exact 3D UNet architecture and training hyperparameters are unspecified, affecting reproducibility
- SuPrem model version and inference settings unknown, potentially impacting semantic grouping
- Convex optimization solver settings (particularly γ parameter) are unspecified
- Clinical utility of organ-specific intervals depends on segmentation accuracy in diverse anatomies

## Confidence

**High Confidence**: The theoretical framework of conformal risk control is sound, and the methodology is clearly described. The claim that sem-CRC achieves shorter intervals while maintaining risk control at 0.10 is directly supported by numerical results.

**Medium Confidence**: The claim about clinical interpretability assumes accurate organ segmentations. While F1 scores are reported, actual clinical utility depends on organ selection and segmentation quality across diverse patient anatomies.

**Low Confidence**: The qualitative claim about "sharper" uncertainty maps lacks quantitative sharpness metrics, though interval length comparisons are clear.

## Next Checks

1. Verify risk control empirically: Run 20 independent trials with ncal=512 and confirm average risk remains below 0.10 for all methods, with sem-CRC showing tightest intervals.

2. Test organ-specific performance: Compute risk and mean interval length separately for each organ to verify sem-CRC maintains coverage while providing shorter intervals for individual semantic groups.

3. Ablation study on segmentation quality: Train with varying SuPrem F1 scores to quantify how segmentation accuracy affects performance gap between sem-CRC and baseline methods.