---
ver: rpa2
title: Repulsive Monte Carlo on the sphere for the sliced Wasserstein distance
arxiv_id: '2509.10166'
source_url: https://arxiv.org/abs/2509.10166
tags:
- carlo
- point
- monte
- distance
- spherical
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper studies Monte Carlo integration on the sphere for estimating
  the sliced Wasserstein distance, focusing on repulsive point processes to reduce
  variance. It compares five new estimators: importance sampling with von Mises-Fisher
  proposals, three determinantal point processes (orthogonal polynomial ensemble,
  harmonic ensemble, spherical ensemble), and repelled point processes.'
---

# Repulsive Monte Carlo on the sphere for the sliced Wasserstein distance

## Quick Facts
- **arXiv ID:** 2509.10166
- **Source URL:** https://arxiv.org/abs/2509.10166
- **Reference count:** 40
- **Primary result:** Five repulsive Monte Carlo estimators compared for Sliced Wasserstein distance; UnifOrtho dominates in high dimensions, randomized grids excel in low dimensions.

## Executive Summary
This paper develops and benchmarks repulsive Monte Carlo methods for estimating the Sliced Wasserstein (SW) distance by integrating over the unit sphere. The authors propose five new estimators that replace independent uniform samples with negatively dependent (repulsive) point processes, including importance sampling, three determinantal point processes (DPPs), and repelled point processes. The UnifOrtho estimator, which uses columns of random orthogonal matrices, shows particular promise in high dimensions due to its implicit spectral filtering properties. Experiments demonstrate that different estimators excel in different regimes: randomized quasi-Monte Carlo methods dominate in low dimensions (d ≤ 3), while UnifOrtho provides superior performance in high dimensions (d > 10). The work bridges Monte Carlo integration theory with optimal transport estimation, offering practical recommendations for practitioners.

## Method Summary
The paper compares five new Monte Carlo estimators for the Sliced Wasserstein distance: ISVMF (importance sampling with von Mises-Fisher proposals), three DPPs (orthogonal polynomial ensemble, harmonic ensemble, spherical ensemble), and repelled point processes. The spherical harmonic control variates (SHCV) estimator is also evaluated as a baseline. The UnifOrtho estimator, which samples columns from random orthogonal matrices, emerges as particularly effective in high dimensions due to its implicit variance reduction mechanism. The repelled point process applies a single gradient descent step to minimize Coulomb energy between points. The paper derives the variance of UnifOrtho (Proposition 4) and shows it depends on the integrand's spherical harmonic coefficients, explaining its success in high dimensions. Experiments use Gaussian toy examples, 3D point clouds from ShapeNet, and MCMC chains targeting banana-shaped distributions.

## Key Results
- UnifOrtho dominates in high dimensions (d > 10) for SW estimation, with variance reduction depending on integrand spectral profile
- Randomized quasi-Monte Carlo methods (Sobol, Halton) excel in low dimensions (d ≤ 3)
- Repelled point processes show moderate variance reduction (factor of ~2) with simple gradient step
- DPP-based methods face computational bottlenecks in high dimensions despite theoretical advantages
- Optimal repulsion strength ε ≈ 1/N for repelled points, but performance is sensitive to tuning

## Why This Works (Mechanism)

### Mechanism 1: Repulsion via Determinantal Point Processes (DPPs)
Replacing independent uniform samples with negatively correlated points via DPPs reduces integration variance by enforcing spatial coverage of the sphere. A projection DPP defines a joint density $P(X) \propto \det(K(x_i, x_j))$. If two points $x_i, x_j$ are close, the kernel columns are similar, reducing the determinant to zero, forcing points apart. This spatial diversity reduces error typically caused by random clustering in standard Monte Carlo. The method assumes the integrand is smooth enough or belongs to an RKHS compatible with the DPP kernel. Break condition: In high dimensions ($d \gg 3$), sampling specific DPPs becomes computationally intractable or undefined, and performance gap closes.

### Mechanism 2: Spectral Filtering in UnifOrtho
UnifOrtho reduces variance in high dimensions by implicitly filtering the integrand's spectral energy profile. The variance depends on spherical harmonic coefficients $\mu_\ell(f)$ of the integrand. Variance reduction occurs if the integrand's energy is concentrated in lower frequencies (even harmonics), which is often the case for SW integrands in high dimensions. Core assumption: The integrand has a "spectral profile" where energy decays or shifts favorably as dimension increases. Break condition: If the integrand is an odd function or has high energy at specific frequencies, UnifOrtho may yield higher variance than i.i.d. sampling.

### Mechanism 3: Gradient-Based Energy Minimization (Repelled Points)
Applying a single gradient descent step to minimize the Coulomb energy of sample points provides low-cost variance reduction by regularizing point spacing. Points are treated as charged particles, with force $F_{s,X}(x) = \sum (x-y)/\|x-y\|^s$ pushing points apart. Moving points slightly along this force reduces clustering without heavy computational cost of exact DPP sampling. Core assumption: The repulsion strength $\epsilon$ is correctly tuned (heuristic suggests $\epsilon \propto 1/N$) and the integrand is locally smooth enough that moving evaluation point slightly does not introduce bias larger than variance reduced. Break condition: Method is sensitive; if $\epsilon$ is too large, points distort excessively, increasing error.

## Foundational Learning

### Sliced Wasserstein Distance (SW)
**Why needed:** SW is the integration target. You must understand that it projects high-dimensional measures onto lines (directions on the sphere) and computes 1D Wasserstein distances.
**Quick check:** Can you explain why calculating SW requires an integral over the unit sphere $S^{d-1}$ rather than the space $\mathbb{R}^d$?

### Spherical Harmonics
**Why needed:** These form the orthonormal basis used to analyze the variance of UnifOrtho and construct the Harmonic Ensemble DPP.
**Quick check:** If an integrand has high energy in high-degree spherical harmonics, would you expect the UnifOrtho estimator to perform well?

### Determinantal Point Processes (DPPs)
**Why needed:** This is the primary "repulsive" machinery. Understanding the trade-off between sampling cost of DPPs and their variance reduction properties is central to the paper.
**Quick check:** Why does the determinant in the DPP density formula encourage points to be spread apart?

## Architecture Onboarding

**Component map:** Input measures → Sampler (UnifOrtho for d>10, QMC/Spherical Ensemble for d≤3, Repelled for moderate gains) → Projector (1D Wasserstein per direction) → Aggregator (Monte Carlo average)

**Critical path:** The sampling step is the focus of optimization. If d is high, the UnifOrtho sampler (union of orthogonal bases) is the default recommendation.

**Design tradeoffs:**
- **Accuracy vs. Cost:** DPPs offer strong theoretical variance reduction but scale poorly in N and d (sampling involves O(N³) operations or rejection sampling). UnifOrtho is cheap (O(dN) matrix ops) but variance reduction depends on specific integrand.
- **Robustness vs. Performance:** Repelled points are computationally cheap (O(N²) for force step) but require tuning ε and can be unstable.

**Failure signatures:**
- **High Variance in High D:** Using QMC or specific DPPs (Spherical Ensemble) in d=20 will likely fail or be too slow.
- **Variance Explosion:** Using UnifOrtho on integrand known to be "odd" or high-frequency (counterexamples exist).
- **Bias Introduction:** In Repelled points, setting repulsion strength ε too high can distort the uniform measure, introducing bias.

**First 3 experiments:**
1. **Dimensional Sweep:** Run Gaussian toy example (Sec 6.1) comparing i.i.d. vs. UnifOrtho across d=2, 10, 20 to confirm crossover point where UnifOrtho dominates.
2. **Tuning Repulsion:** Implement Repelled point process on 3D sphere and plot Variance vs. ε to validate "dip" at ε ≈ 1/N (Appendix A.4).
3. **Spectral Analysis:** Estimate spectral coefficients μ_ℓ(f) for SW integrand between two 3D point clouds to predict if UnifOrtho will succeed or fail based on Proposition 4.

## Open Questions the Paper Calls Out

### Open Question 1
How can the repulsion strength parameter ε be theoretically determined for repelled point processes on the sphere to ensure robust variance reduction across different dimensions? The authors currently rely on heuristics (ε ≈ 1/N) and observe that small variations in ε can drastically increase variance, particularly when repelling structured points or using control variates. Resolution would require theoretical analysis establishing the relationship between ε, dimension d, and integrand's regularity.

### Open Question 2
Can the spectral profile of the sliced Wasserstein integrand be characterized using easy-to-estimate features of the input measures to guide estimator selection? While Proposition 4 links UnifOrtho's variance reduction to the integrand's spectral profile (μ_ℓ(f)), calculating this profile is generally as difficult as the integration problem itself. Resolution would involve deriving bounds or approximations for spherical harmonic coefficients based solely on simple statistics of the measures μ and ν.

### Open Question 3
Does combining the UnifOrtho estimator with spherical harmonic control variates guarantee a uniform decrease in variance compared to using either method individually? It is unknown how the structural negative dependence of UnifOrtho interacts with the function approximation properties of the control variates. Resolution would require theoretical proof showing that the variance of the combined estimator is strictly lower than both standard UnifOrtho and the SHCV estimator across a general class of integrands.

## Limitations

- Variance reduction of UnifOrtho depends critically on unproven assumptions about the spectral characteristics of Sliced Wasserstein integrands
- Repelled point process exhibits sensitivity to repulsion strength and can introduce bias if over-perturbed
- DPP-based methods face computational bottlenecks in high dimensions, limiting practical applicability despite strong theoretical foundations

## Confidence

**High Confidence:** The empirical superiority of UnifOrtho in high dimensions (d > 10) is well-supported by experiments. The computational advantages of randomized grids in low dimensions are clearly demonstrated. The general principle that repulsive point processes can reduce variance is theoretically sound.

**Medium Confidence:** The specific variance reduction claims for UnifOrtho depend on unproven assumptions about the spectral characteristics of Sliced Wasserstein integrands. The tuning of repulsion strength for the Repelled process shows promising results but requires careful hyperparameter selection that may not generalize across tasks.

**Low Confidence:** The computational complexity claims for DPP sampling in high dimensions are stated but not empirically validated. The crossover dimension where UnifOrtho becomes preferable (around d=10) is empirically observed but lacks theoretical justification.

## Next Checks

1. **Spectral Profile Analysis:** For the Gaussian toy example, compute and visualize the spherical harmonic coefficients of the Sliced Wasserstein integrand across dimensions d=2, 10, 20 to verify the even-harmonic dominance assumption that enables UnifOrtho's variance reduction.

2. **Repulsion Strength Sensitivity:** Systematically vary the repulsion parameter ε across several orders of magnitude for the Repelled point process on a 3D sphere, measuring both variance reduction and potential bias introduction to map out the optimal operating regime.

3. **DPP Scaling Experiment:** Implement the Spherical Ensemble DPP sampling for increasing dimensions (d=3, 5, 7, 10) and number of points (N=50, 100, 200) to empirically measure the computational scaling and identify the practical dimensionality limits.