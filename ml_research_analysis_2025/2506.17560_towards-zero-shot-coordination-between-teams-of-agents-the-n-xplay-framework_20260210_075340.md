---
ver: rpa2
title: 'Towards Zero-Shot Coordination between Teams of Agents: The N-XPlay Framework'
arxiv_id: '2506.17560'
source_url: https://arxiv.org/abs/2506.17560
tags:
- agents
- n-xplay
- coordination
- unseen
- teams
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of zero-shot coordination (ZSC)
  in multi-team systems (MTS), where agents must balance intra-team coordination with
  inter-team collaboration with previously unseen teammates. The authors introduce
  N-player Overcooked, an extension of the popular two-agent ZSC benchmark to N-agent
  scenarios, enabling evaluation of ZSC in more complex organizational structures.
---

# Towards Zero-Shot Coordination between Teams of Agents: The N-XPlay Framework

## Quick Facts
- arXiv ID: 2506.17560
- Source URL: https://arxiv.org/abs/2506.17560
- Authors: Ava Abderezaei; Chi-Hui Lin; Joseph Miceli; Naren Sivagnanadasan; Stéphane Aroca-Ouellette; Jake Brawer; Alessandro Roncone
- Reference count: 12
- One-line primary result: N-XPlay framework enables zero-shot coordination in multi-team systems by training a subset of agents with shared policy alongside sampled collaborators, outperforming self-play as the ratio of unseen-to-total agents increases.

## Executive Summary
This paper addresses the challenge of zero-shot coordination (ZSC) in multi-team systems (MTS), where agents must balance intra-team coordination with inter-team collaboration with previously unseen teammates. The authors introduce N-player Overcooked, an extension of the popular two-agent ZSC benchmark to N-agent scenarios, enabling evaluation of ZSC in more complex organizational structures. They propose N-XPlay, a framework that extends existing two-agent ZSC approaches to N-agent settings by training a subset of agents (N-X) with a shared policy alongside X agents sampled from a diverse population.

Experiments comparing N-XPlay against Self-Play (SP) across two-, three-, and five-player Overcooked scenarios show that N-XPlay-trained agents outperform SP-trained agents when paired with varying numbers of unseen collaborators, particularly as the ratio of unseen-to-total agents increases. This demonstrates N-XPlay's effectiveness in finding policies that can simultaneously perform both intra- and inter-team collaboration, addressing a critical gap in current ZSC methods for complex MTS settings.

## Method Summary
The N-XPlay framework extends zero-shot coordination to N-agent multi-team systems by combining self-play (intra-team coordination) with population-based sampling (inter-team coordination). During training, N−X agents share a policy trained via self-play, while X agents are independently sampled from a diverse pre-trained population in each episode. This creates an ego-team that learns to coordinate both with replicas of itself and with diverse outsiders. The framework is evaluated on N-player Overcooked environments across varying team sizes and layout complexities, comparing N-XPlay against traditional self-play baselines at different ratios of unseen-to-total agents.

## Key Results
- N-XPlay-trained agents outperform self-play baselines when paired with unseen collaborators, especially as the ratio of unseen-to-total agents increases
- Performance advantage emerges at higher unseen-agent ratios (N-2Play outperforms SP when at least 3/5 agents are unseen)
- Layout complexity significantly impacts performance - N-XPlay excels in high-coordination layouts but underperforms in low-coordination scenarios where teams can work independently
- The framework successfully extends zero-shot coordination beyond two-agent settings to multi-team organizational structures

## Why This Works (Mechanism)

### Mechanism 1: Population-Sampled Training for Robust Coordination Policies
- Claim: Training ego-agents against a diverse population of partners produces policies that generalize to unseen collaborators.
- Mechanism: During each training episode, X collaborators are sampled from a pre-trained population, exposing the ego-team to varied coordination strategies. This forces the ego-team policy to learn adaptable behaviors rather than overfitting to a fixed partner policy.
- Core assumption: The pre-trained population captures sufficient behavioral diversity to represent the distribution of unseen partners encountered at test time.
- Evidence anchors:
  - [abstract]: "N-XPlay... combines intra-team coordination (via self-play) with inter-team coordination (via population-based sampling)"
  - [section]: "X agents independently sampled from a diverse population of pre-trained policies, similar to existing Population-Based (PB) methods [6, 4, 10]"
  - [corpus]: Related work FCP [10] and PECAN [6] validate population-based approaches for two-agent ZSC, though corpus lacks direct N-agent extensions.
- Break condition: If population diversity is low (e.g., all agents converge to similar policies), inter-team coordination learning provides no benefit over self-play.

### Mechanism 2: Dual Coordination Objective Balancing
- Claim: Simultaneously optimizing for intra-team and inter-team coordination yields policies that degrade gracefully as team composition varies.
- Mechanism: N−X ego-agents share a policy trained via self-play (intra-team), while X sampled agents provide inter-team signal. The gradient signal balances coordination with replicas of self against coordination with diverse outsiders.
- Core assumption: Intra-team and inter-team coordination objectives are not fundamentally conflicting (i.e., a single policy can satisfy both).
- Evidence anchors:
  - [abstract]: "agents trained with N-XPlay are better able to simultaneously balance 'intra-team' and 'inter-team' coordination than agents trained with SP"
  - [section]: "This combination of SP and PB enables learning both intra-team coordination within the 'ego-team' and inter-team coordination with an unseen group of agents"
  - [corpus]: Corpus papers on ZSC (OvercookedV2, Cross-environment Cooperation) focus on dyadic settings; MTS-specific dual objectives are not directly validated externally.
- Break condition: If coordination conventions required for intra-team vs. inter-team are mutually exclusive (e.g., conflicting communication protocols), the policy may satisfy neither.

### Mechanism 3: Unseen-to-Total Ratio as Performance Predictor
- Claim: The relative benefit of N-XPlay over self-play scales with the proportion of unseen agents in the collective.
- Mechanism: When the ego-team represents a smaller fraction of the total agents, the collective outcome depends more heavily on inter-team coordination—the skill N-XPlay explicitly trains. Self-play policies, optimized for intra-team performance, become bottlenecks.
- Core assumption: The task requires organization-level coordination; subgroups cannot independently complete the task.
- Evidence anchors:
  - [section]: "As the ratio of unseen over collective size increases (i.e. the ego-team represents a smaller portion of the collective), the performance of both SP and N-XPlay declines with N-XPlay starting to outperform SP"
  - [section]: "N-XPlay only overtakes SP when at least three teammates are unseen (3/5)"
  - [corpus]: Weak/missing—corpus does not systematically examine unseen-agent ratio effects in N-agent settings.
- Break condition: If the ego-team can independently accomplish the task (e.g., low-coordination layouts), inter-team coordination provides marginal benefit and self-play suffices.

## Foundational Learning

- **Zero-Shot Coordination (ZSC)**
  - Why needed here: The core problem formulation; understanding why self-play fails to generalize is essential.
  - Quick check question: Why does training an agent entirely against copies of itself lead to brittle coordination with new partners?

- **Population-Based Training (PBT)**
  - Why needed here: N-XPlay relies on a pre-trained diverse population; understanding PBT methods (FCP, MEP) clarifies the diversity source.
  - Quick check question: How would you ensure a population of agents exhibits meaningfully different coordination strategies rather than minor policy variations?

- **Multi-Team Systems (MTS)**
  - Why needed here: The paper explicitly models hierarchical team structures; distinguishing intra- vs. inter-team coordination is foundational.
  - Quick check question: In a 5-agent scenario with 2 teams, what coordination challenges arise that would not exist in a single 5-agent team?

## Architecture Onboarding

- **Component map:**
  Environment -> Population Generator -> Ego-Team Policy -> Sampling Controller -> Reward Signal

- **Critical path:**
  1. Generate diverse population using existing PBT methods (SP checkpoints at varied skill levels)
  2. Initialize ego-team policy
  3. For each episode: sample X collaborators, run N-agent episode, compute collective reward, update ego-team policy
  4. Evaluate by pairing ego-team with held-out unseen collaborators

- **Design tradeoffs:**
  - *X selection*: Larger X increases inter-team training signal but reduces intra-team learning stability
  - *Population size/composition*: More diverse populations improve generalization but increase training variance
  - *Layout choice*: High-coordination layouts show N-XPlay advantage; low-coordination layouts favor SP

- **Failure signatures:**
  - N-XPlay underperforms SP on low-coordination layouts (agents can work independently; inter-team training is overhead)
  - Performance collapses if population is too homogeneous (no meaningful diversity signal)
  - Ego-team overfits to population quirks if sampling is not sufficiently randomized

- **First 3 experiments:**
  1. **Baseline replication**: Implement N-XPlay on 2-player Overcooked layouts; compare N-1Play vs. self-play with 0 and 1 unseen collaborators to verify paper's Fig. 2 pattern.
  2. **Ratio sensitivity test**: On 5-player layouts, sweep X from 1 to 4; confirm N-XPlay advantage emerges at higher X/N ratios as claimed.
  3. **Population diversity ablation**: Train N-XPlay with reduced population diversity (e.g., only high-performance checkpoints); measure degradation in inter-team coordination performance.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the inherent coordination complexity of a task environment determine the ideal ratio of ego-team agents to sampled collaborators during training?
- Basis in paper: [explicit] The authors observe that "layout configuration significantly impacts the evaluation," noting that N-XPlay lags in low-coordination layouts (e.g., No Counter Space) but succeeds in high-coordination ones.
- Why unresolved: The paper establishes that performance depends on layout but does not offer a method to predict the optimal $X/N$ ratio based on environment features before training.
- What evidence would resolve it: A correlation analysis linking specific environment metrics (e.g., workspace overlap, dependency depth) to the optimal training configuration.

### Open Question 2
- Question: Can the performance of N-XPlay be improved by dynamically adjusting the ratio of ego-team agents to population-sampled agents during the training process?
- Basis in paper: [inferred] The paper evaluates static configurations (N-1Play, N-2Play) and compares them post-hoc, selecting the best performer for analysis without exploring adaptive curricula.
- Why unresolved: It is unclear if a fixed ratio is optimal throughout the entire learning process or if a gradual shift from self-play to population-based training would yield better convergence.
- What evidence would resolve it: Experiments using a variable $X$ during training (e.g., annealing the number of sampled partners) compared against the static variants presented.

### Open Question 3
- Question: Does the N-XPlay framework generalize to multi-team systems where agent capabilities are heterogeneous rather than uniform?
- Basis in paper: [inferred] The paper assumes the "ego-team" shares an identical policy, whereas the introduction highlights that real-world "heterogeneous organizations" require agents with distinct capabilities.
- Why unresolved: The current framework relies on a shared policy for the ego-team ($N-X$ agents), which may limit its applicability to teams where members have specialized, non-interchangeable roles.
- What evidence would resolve it: Evaluating N-XPlay in a modified N-player Overcooked environment where agents possess different movement or action constraints.

## Limitations

- The study focuses on a single domain (Overcooked), leaving unclear whether findings transfer to other multi-team coordination problems
- The pre-trained population generation is not fully specified, creating reproducibility challenges
- The paper does not systematically analyze when and why N-XPlay succeeds or fails across different task types

## Confidence

The paper's claims about N-XPlay's effectiveness in zero-shot coordination carry **Medium confidence**. The core experimental design is sound, but several limitations affect generalizability. The pre-trained population generation is not fully specified (RL algorithm, hyperparameters, exact layout configurations), creating reproducibility challenges. The study focuses on Overcooked as a single domain, leaving unclear whether findings transfer to other multi-team coordination problems. Additionally, while the paper demonstrates performance improvements at higher unseen-to-total ratios, it does not systematically analyze the mechanisms behind when and why N-XPlay succeeds or fails across different task types.

- Population diversity mechanism: **Medium confidence** - supported by related work but lacking direct N-agent validation
- Dual coordination objective balancing: **Medium-Low confidence** - not empirically tested for compatibility
- Unseen-to-total ratio predictor: **Medium confidence** - reasonable theoretical grounding but weak external validation

## Next Checks

1. **Population diversity quantification**: Measure behavioral diversity of pre-trained population using policy embeddings or coordination patterns, then correlate with N-XPlay performance to confirm diversity is the key driver of inter-team coordination success.

2. **Cross-domain transfer**: Implement N-XPlay in a different multi-agent coordination domain (e.g., particle-based environments or traffic coordination) to test whether the framework generalizes beyond Overcooked.

3. **Ablation on team independence**: Design experiments with varying levels of task interdependence between teams (fully independent vs. fully dependent) to systematically validate the claim that N-XPlay's advantage scales with organizational-level coordination requirements.