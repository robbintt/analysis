---
ver: rpa2
title: 'IR-Agent: Expert-Inspired LLM Agents for Structure Elucidation from Infrared
  Spectra'
arxiv_id: '2508.16112'
source_url: https://arxiv.org/abs/2508.16112
tags:
- expert
- spectra
- information
- smiles
- table
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'IR-Agent is a multi-agent framework for molecular structure elucidation
  from IR spectra. It models expert-driven analysis processes by integrating three
  specialized LLM agents: a Table Interpretation Expert that extracts local structural
  features from IR absorption tables, a Retriever Expert that identifies global structural
  patterns from similar spectra, and a Structure Elucidation Expert that integrates
  both analyses to generate final SMILES predictions.'
---

# IR-Agent: Expert-Inspired LLM Agents for Structure Elucidation from Infrared Spectra

## Quick Facts
- arXiv ID: 2508.16112
- Source URL: https://arxiv.org/abs/2508.16112
- Authors: Heewoong Noh; Namkyeong Lee; Gyoung S. Na; Kibum Kim; Chanyoung Park
- Reference count: 40
- Primary result: Multi-agent framework with specialized experts achieves superior IR structure elucidation performance over single-agent and transformer baselines

## Executive Summary
IR-Agent introduces a multi-agent framework that mimics expert-driven molecular structure elucidation from infrared spectra. The system decomposes the complex task into three specialized LLM agents: a Table Interpretation Expert that extracts local structural features from IR absorption tables, a Retriever Expert that identifies global structural patterns from similar spectra, and a Structure Elucidation Expert that integrates both analyses to generate final SMILES predictions. This architecture demonstrates superior performance over both standalone transformer models and single-agent approaches, achieving higher Top-K accuracy in structure prediction. The framework also flexibly incorporates additional chemical information through prompt-based updates without requiring model retraining.

## Method Summary
The IR-Agent framework combines a transformer-based IR Spectra Translator with three specialized LLM agents. The translator generates candidate SMILES from raw IR spectra using a 1D sequence-to-sequence transformer with 2 encoder and 2 decoder layers. The Table Interpretation Expert uses a peak-finding tool and absorption table knowledge to map spectral peaks to functional groups. The Retriever Expert performs cosine similarity-based retrieval against a database of known spectra to identify global structural motifs. The Structure Elucidation Expert synthesizes these analyses with candidate SMILES to produce ranked predictions. The system supports prompt-based constraint injection for incorporating auxiliary chemical information without retraining.

## Key Results
- Multi-agent framework consistently outperforms single-agent baselines across different LLM models (GPT-4o-mini, GPT-4o, o3-mini)
- Combining local (absorption table) and global (retrieval) features yields higher Top-K accuracy than either approach alone (10.3% vs 9.8% or 8.9%)
- Prompt-based constraint injection significantly improves performance (Top-1 accuracy rises from 10.3% to 12.7% with Atom Types info)
- System achieves flexible integration of chemical constraints without requiring model retraining

## Why This Works (Mechanism)

### Mechanism 1: Specialized Agent Decomposition
Decomposing structure elucidation into specialized sub-agents mitigates reasoning limitations of single-LLM systems by separating distinct cognitive loads: mapping peaks to functional groups, identifying structural motifs from examples, and synthesizing hypotheses. This prevents a single model from simultaneously juggling raw data interpretation, database lookup, and chemical synthesis logic.

### Mechanism 2: Local-Global Feature Integration
Integrating local heuristic rules (absorption tables) with global similarity search (retrieval) resolves ambiguity inherent in IR spectra. The TI Expert anchors analysis in established chemical rules while the Ret Expert grounds structure in observed chemical space. The SE Expert acts as a constraint solver finding consensus between rule-based and example-based predictions.

### Mechanism 3: Prompt-Based Constraint Fusion
Prompt-based fusion of auxiliary chemical constraints allows error correction without weight updates. Instead of fine-tuning, the framework injects constraints as natural language context into agent prompts. The LLM uses pre-trained reasoning capabilities to filter candidates violating constraints during final integration.

## Foundational Learning

- **SMILES (Simplified Molecular Input Line Entry System)**
  - Why needed here: This is the output format. Understanding SMILES as string representations of molecular graphs is crucial to grasp why the Structure Elucidation Expert can use text-based reasoning to assemble chemical structures.
  - Quick check: Can a standard LLM validate the valency of a carbon atom just by looking at a SMILES string, or does it need external tool verification? (Answer: It relies on statistical likelihood; explicit valency checks usually require tools)

- **IR Spectral Peaks vs. Noise**
  - Why needed here: The TI Expert relies on identifying peaks. Understanding that raw spectra are noisy, continuous signals, not discrete lists of features, is essential to appreciate the difficulty of the IR Peak Table Assigner tool's job.
  - Quick check: Why might a broad peak (e.g., O-H stretch) be harder for a rule-based lookup tool to classify than a sharp peak?

- **Retrieval-Augmented Generation (RAG) in Science**
  - Why needed here: The Ret Expert is essentially a RAG module. Understanding how cosine similarity in spectral space translates to structural similarity is key to evaluating this component.
  - Quick check: If the database contains only small molecules, how would the Ret Expert fail when analyzing a large polymer spectrum?

## Architecture Onboarding

- **Component map:** IR Spectra Translator -> TI Expert + Ret Expert (parallel) -> SE Expert
- **Critical path:** The system performance is strictly bottlenecked by the IR Spectra Translator. If the correct SMILES is not in the initial candidate set C, the downstream agents cannot recover it; they can only re-rank existing candidates.
- **Design tradeoffs:** 
  - Cost vs. Accuracy: Using three distinct LLM agents incurs high API latency and cost compared to a single Transformer pass.
  - Flexibility vs. Reliability: Prompt-based integration of chemical info is flexible but "soft"â€”it relies on the LLM obeying instructions, whereas hard constraints in code would be more reliable but less flexible.
- **Failure signatures:**
  - Noisy Candidate Degradation: Increasing beam width too far degrades performance as agents get overwhelmed by low-quality candidates.
  - Hallucination: The SE Expert might output a valid SMILES never in the candidate list C if not strictly prompted to only re-rank.
- **First 3 experiments:**
  1. Run IR Spectra Translator alone to establish "recoverability" upper bound (what % of ground truths are in top-10 candidates before agents touch them).
  2. Corrupt the Absorption Table and verify if TI Expert and SE Expert outputs degrade logically.
  3. Test with contradictory constraints (e.g., "molecule contains Fe" but candidates are organic) to observe filtering behavior.

## Open Questions the Paper Calls Out
None

## Limitations
- The framework's performance is fundamentally constrained by the IR Spectra Translator's ability to generate the correct candidate SMILES; if the ground-truth structure is not in the initial candidate set, the multi-agent pipeline cannot recover it.
- The reliance on LLM-based reasoning for critical analytical steps introduces variability that may not be consistent across different models or temperature settings.
- The evaluation focuses exclusively on exact-match accuracy without examining partial correctness or the interpretability of intermediate reasoning steps.

## Confidence

- **High Confidence:** Multi-agent architecture outperforms single-agent baselines (directly supported by Table 3 ablation study).
- **Medium Confidence:** Separating cognitive loads improves performance (Table 1 shows gains but doesn't directly test architectural specialization vs other factors).
- **Medium Confidence:** Prompt-based constraint injection effectiveness (Table 2 shows improvements but hasn't been rigorously stress-tested with edge cases).

## Next Checks

1. **Recoverability Baseline Test:** Run IR Spectra Translator alone on test set to determine what percentage of ground-truth structures appear in top-10 candidate list before any agent reasoning occurs.

2. **Constraint Robustness Test:** Systematically inject contradictory or numerically precise constraints and observe whether SE Expert correctly filters candidates, hallucinates new structures, or produces no valid output.

3. **Ablation with Corrupted Inputs:** Deliberately corrupt the Absorption Table and rerun full pipeline to verify agents are actually using provided tools rather than relying on pre-trained knowledge.