---
ver: rpa2
title: Pharmacophore-based design by learning on voxel grids
arxiv_id: '2512.02031'
source_url: https://arxiv.org/abs/2512.02031
tags:
- molecules
- molecule
- query
- hits
- each
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: Voxel-based generative model (VoxCap) for ligand-based drug discovery,
  generating SMILES from pharmacophore-shape voxelized inputs. Outperforms prior method
  (PGMG) on de-novo generation by 10x in hits (116.5 vs 11.5 median hits per query),
  with high diversity (55.5 unique scaffolds).
---

# Pharmacophore-based design by learning on voxel grids

## Quick Facts
- arXiv ID: 2512.02031
- Source URL: https://arxiv.org/abs/2512.02031
- Reference count: 14
- Outperforms prior method (PGMG) on de-novo generation by 10x in hits (116.5 vs 11.5 median hits per query), with high diversity (55.5 unique scaffolds)

## Executive Summary
VoxCap is a generative model for ligand-based drug discovery that converts 3D pharmacophore-shape profiles into SMILES strings. The model voxelizes molecules into 7-channel grids (6 pharmacophore types + shape) and uses a 3D CNN encoder with LSTM decoder to generate novel molecules matching the query's 3D profile. It achieves 10x more hits than prior methods while maintaining high diversity, and enables fast virtual screening workflows that reduce expensive 3D comparisons by orders of magnitude.

## Method Summary
VoxCap generates SMILES from 3D pharmacophore-shape voxelized inputs using a 3D CNN encoder and LSTM decoder. Molecules are voxelized into 7-channel grids (6 pharmacophore types plus shape) at 0.35Å resolution, then compressed to a latent vector by the encoder. The decoder generates SMILES tokens autoregressively using teacher forcing. The model is trained on GEOM-drugs and ChEMBL datasets with data augmentation (random translation/rotation) and early stopping based on validation scaffold hits to prevent mode collapse.

## Key Results
- 10x improvement over PGMG on hits (116.5 vs 11.5 median hits per query)
- High diversity with 55.5 unique scaffolds per query
- Fast search workflow reduces 3D ROCS comparisons from 1.3M to 500 while maintaining hit discovery
- Primary bottleneck is 2D similarity matching (median 0.38 similarity to database molecules)

## Why This Works (Mechanism)

### Mechanism 1
Voxelized pharmacophore-shape representations enable more effective 3D-to-SMILES generation than graph-based pharmacophore encodings. Gaussian-like densities centered on pharmacophore positions create smooth, continuous 3D grids that preserve geometric relationships critical for binding.

### Mechanism 2
Early stopping on validation scaffold hits prevents mode collapse despite continued cross-entropy loss improvement. The voxel representation's specificity to each molecule causes the model to overfit to a sharp distribution around the most probable molecule per query with extended training.

### Mechanism 3
Fast search workflow reduces 3D ROCS comparisons by orders of magnitude while maintaining hit discovery. The workflow generates candidates matching the query's 3D profile, then uses 2D similarity matching to identify database analogs for expensive 3D comparison.

## Foundational Learning

- **Pharmacophores and shape profiles**: Understanding that 6 pharmacophore types plus shape define binding-relevant 3D features is essential for interpreting the 7-channel input. Quick check: Can you explain why a molecule might have high shape overlap but low pharmacophore overlap with a query?

- **Autoregressive SMILES generation with teacher forcing**: The LSTM decoder generates tokens sequentially, conditioned on encoder output and previous tokens. Quick check: What happens to output diversity if τ→1 (lower) vs τ→2 (higher)?

- **ROCS Tanimoto Combo score**: The evaluation metric combines shape and color (pharmacophore) overlap, scored 0-2. Hits are defined as TC≥1.2. Quick check: Why might a generated molecule with TC=1.4 be more valuable than one with TC=1.8 if the former has a novel scaffold?

## Architecture Onboarding

- Component map: Input: 3D conformer → Pharmacophore extraction → Voxelization (7 channels × 48³/64³ grid) → 3D CNN Encoder → AvgPool → Vector → LSTM Decoder → SMILES tokens → Output

- Critical path: Voxelization quality → Encoder spatial feature extraction → Decoder SMILES validity → Generated molecule conformer generation. The paper notes 2D similarity matching (not ROCS) is the primary bottleneck in fast search.

- Design tradeoffs: Grid resolution (0.35Å) vs memory; Early stopping epoch vs diversity; ng × na in fast search: more generations/analog lookups increase hits but reduce speed advantage.

- Failure signatures: High cross-entropy loss continuing to decrease while validation scaffold hits drop → mode collapse from overtraining; Many invalid SMILES generated → decoder regularization needed or vocabulary issue; Low 2D similarity to database molecules → generated molecules too novel; High standard deviation across queries → model performance is query-dependent.

- First 3 experiments:
  1. Sanity check: Sample 100 molecules from a single query's pharmacophore-shape profile with τ=1.0, validate SMILES parsing and compute TC scores. Expected: median 50-150 hits based on paper.
  2. Early stopping ablation: Train identical models, stopping at epoch 2, 5, 10, 20. Evaluate unique scaffold hits on 10 validation queries. Expected: peak performance at early epoch.
  3. Fast search validation: For 5 test queries, run both brute-force ROCS and fast search (ng=100, na=5). Compare hits and ROCS comparison count. Expected: ~10x fewer comparisons but ~10x fewer hits than brute force.

## Open Questions the Paper Calls Out

- Can coarser or noisier input representations prevent the model from learning a distribution that is too sharply peaked around the most likely molecule?

- What regularization strategies can ensure generated molecules have closer 2D analogs in existing databases?

- How can the high variance in hit rates across different query molecules be reduced?

## Limitations

- The voxelized representation is extremely specific to each molecule's conformation, making the model prone to mode collapse
- The 2D similarity matching bottleneck (median 0.38 similarity to database molecules) limits the fast search workflow's utility
- Reliance on OpenEye ROCS for 3D evaluation creates a significant barrier to independent validation

## Confidence

- 10x improvement over PGMG on hits (116.5 vs 11.5): High confidence
- Voxel representation enables better 3D-to-SMILES generation: Medium confidence
- Early stopping prevents mode collapse: Medium confidence
- Fast search workflow orders-of-magnitude reduction: High confidence
- 2D similarity correlation (r=0.4) sufficient for fast search: Low confidence

## Next Checks

1. Sanity check generation: Generate 100 molecules from a single query molecule's voxelized pharmacophore-shape profile using τ=1.0. Validate that at least 50% produce valid SMILES and compute ROCS TC scores. Compare the median hits to the paper's reported 116.5 to verify the baseline generation capability.

2. Early stopping ablation study: Train four identical models on GEOM-drugs with early stopping at epochs 2, 5, 10, and 20. Evaluate unique scaffold hits on 10 validation queries. Verify that performance peaks at early epochs and declines with continued training, confirming the mode collapse mechanism.

3. Fast search hit coverage analysis: For 5 test queries, compare brute-force ROCS evaluation against the full training+validation set versus the fast search workflow (ng=100, na=5). Calculate the percentage of brute-force hits recovered by fast search and the actual reduction in 3D comparisons to verify the "orders of magnitude" claim while quantifying the recall penalty.