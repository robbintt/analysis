---
ver: rpa2
title: 'AortaDiff: A Unified Multitask Diffusion Framework For Contrast-Free AAA Imaging'
arxiv_id: '2510.01498'
source_url: https://arxiv.org/abs/2510.01498
tags:
- segmentation
- lumen
- cect
- thrombus
- diffusion
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents AortaDiff, a unified multitask diffusion framework
  for generating synthetic contrast-enhanced CT (CECT) images and segmenting aortic
  anatomy from non-contrast CT (NCCT) scans. The method addresses the clinical need
  to reduce iodinated contrast agent use in abdominal aortic aneurysm (AAA) imaging
  by jointly performing CECT synthesis and lumen/thrombus segmentation in an end-to-end
  fashion.
---

# AortaDiff: A Unified Multitask Diffusion Framework For Contrast-Free AAA Imaging

## Quick Facts
- arXiv ID: 2510.01498
- Source URL: https://arxiv.org/abs/2510.01498
- Reference count: 29
- Primary result: PSNR of 25.61 dB for CECT synthesis (vs 23.80 dB single-task baseline), lumen Dice 0.89 (vs 0.87), thrombus Dice 0.53 (vs 0.48)

## Executive Summary
This paper presents AortaDiff, a unified multitask diffusion framework for generating synthetic contrast-enhanced CT (CECT) images and segmenting aortic anatomy from non-contrast CT (NCCT) scans. The method addresses the clinical need to reduce iodinated contrast agent use in abdominal aortic aneurysm (AAA) imaging by jointly performing CECT synthesis and lumen/thrombus segmentation in an end-to-end fashion. Key innovations include a shared encoder-decoder architecture that eliminates the need for coarse initial predictions, and a semi-supervised training strategy that leverages unlabeled data. Evaluated on 264 patients, AortaDiff achieved significant improvements in both synthesis and segmentation metrics compared to single-task baselines.

## Method Summary
AortaDiff uses a conditional diffusion model with a shared U-Net backbone and two prediction heads (denoised image, segmentation mask) to jointly perform CECT synthesis and aortic lumen/thrombus segmentation. The model employs a semi-supervised training strategy with supervised loss on labeled NCCT-CECT-mask triplets and reconstruction loss on unlabeled NCCT-CECT pairs. Training uses LPIPS loss for perceptual image quality, SDF mask representation, and uncertainty-aware multi-task weighting. The method includes aorta-restricted generation with background fusion and uses RePaint for inference. Evaluation is performed on the OxAAA dataset with 264 patients, measuring synthesis quality (PSNR/SSIM/LPIPS), segmentation accuracy (Dice), and clinical measurements (lumen diameter MAE, thrombus area error).

## Key Results
- CECT synthesis PSNR: 25.61 dB (AortaDiff-F) vs 23.80 dB (single-task baseline)
- Lumen segmentation Dice: 0.89 (AortaDiff-F) vs 0.87 (baseline)
- Thrombus segmentation Dice: 0.53 (AortaDiff-F) vs 0.48 (baseline)
- Clinical lumen diameter MAE: 4.19 mm (AortaDiff-F) vs 5.78 mm (baseline)
- Thrombus area error: 33.85% (AortaDiff-F) vs 41.45% (baseline)

## Why This Works (Mechanism)
The unified multitask architecture enables information sharing between synthesis and segmentation tasks, eliminating the need for separate coarse predictions and reducing error propagation. The semi-supervised learning strategy leverages the large amount of unlabeled NCCT-CECT pairs to improve model generalization. The use of LPIPS loss instead of MSE helps preserve perceptual quality and anatomical details in the synthetic CECT images. Aorta-restricted generation focuses the model on the region of interest, reducing artifacts in irrelevant areas.

## Foundational Learning
- **Conditional diffusion models**: Why needed - to generate high-quality synthetic images from NCCT inputs; Quick check - verify denoising process preserves anatomical structures
- **Semi-supervised learning**: Why needed - to leverage unlabeled data and improve segmentation performance; Quick check - compare labeled-only vs semi-supervised training curves
- **SDF (signed distance field) representation**: Why needed - to provide smooth, differentiable mask representations for better training stability; Quick check - visualize SDF masks and verify smooth gradients
- **Perceptual loss (LPIPS)**: Why needed - to capture perceptual similarity beyond pixel-wise MSE; Quick check - compare LPIPS vs MSE-based reconstructions visually
- **Uncertainty-aware multi-task weighting**: Why needed - to balance contributions from synthesis and segmentation tasks; Quick check - verify task weights adapt during training
- **Aorta-restricted generation**: Why needed - to focus on region of interest and reduce background artifacts; Quick check - verify conditioning masks properly constrain generation

## Architecture Onboarding

Component map: NCCT slices -> Shared U-Net encoder -> [Image denoising head, Mask segmentation head] -> CECT synthesis + Aortic masks

Critical path: NCCT input → Shared encoder → Two prediction heads → Output CECT + masks

Design tradeoffs: Joint vs separate training (joint reduces error propagation but increases complexity), perceptual vs pixel-wise loss (perceptual better preserves details but may reduce pixel accuracy), semi-supervised vs fully supervised (semi-supervised leverages more data but adds complexity)

Failure signatures: Blurry synthesis indicates MSE loss issues, poor segmentation shows task imbalance, background artifacts suggest conditioning problems

First experiments:
1. Train single-task baseline (CECT synthesis only) and compare PSNR to joint model
2. Implement and validate SDF mask conversion and visualization
3. Test semi-supervised training by varying labeled/unlabeled data ratios

## Open Questions the Paper Calls Out

### Open Question 1
Can the inference latency of the AortaDiff framework be reduced to support real-time clinical deployment without sacrificing the anatomical fidelity achieved by the diffusion process? The authors state that "DDPM-based models have longer inference time than CycleGAN or U-Net based models, and the use of RePaint further increases inference time, posing challenges for clinical deployment." The iterative denoising nature of diffusion models and the additional steps required by RePaint for inpainting are computationally expensive compared to single-pass CNNs, creating a trade-off between image quality and speed. Implementation of acceleration techniques (e.g., fewer denoising steps, distillation) that achieve inference times comparable to U-Net baselines while maintaining a PSNR > 25.0 dB on the OxAAA dataset would resolve this.

### Open Question 2
Can the latent representations learned by AortaDiff be leveraged to perform fully unsupervised lumen prediction, eliminating the dependency on manually annotated lumen masks during training? While the model currently uses a semi-supervised strategy to handle missing labels, it still relies on a subset of annotated data (45 cases) to learn the segmentation task explicitly. A variation of the model trained with zero lumen segmentation labels that successfully predicts lumen masks, validated by achieving Dice scores statistically comparable to the current semi-supervised model, would resolve this.

### Open Question 3
How can uncertainty be effectively quantified for both the synthetic CECT generation and segmentation outputs to increase clinical trust and safety? The current framework provides deterministic outputs (or samples without confidence intervals) and lacks a mechanism to flag low-confidence predictions in challenging cases (e.g., thrombus with Dice < 0.53). Integration of an uncertainty quantification method (e.g., Monte Carlo Dropout or ensemble variance) that correlates strongly with error metrics (MAE for diameter, Dice for segmentation), allowing for the automated rejection of low-confidence scans, would resolve this.

## Limitations
- The exact formulation of the uncertainty-aware multi-task loss and semi-supervised training schedule are not fully specified, affecting reproducibility
- Thrombus segmentation Dice scores remain relatively low (~0.53) due to the thin-ring nature of target structures
- The method requires careful implementation of patient-level splitting and aorta Dice threshold quality control to avoid data leakage

## Confidence
- **High confidence**: Image synthesis PSNR/SSIM/LPIPS metrics and their improvement over baselines; clinical diameter MAE improvements
- **Medium confidence**: Segmentation Dice scores, particularly for thrombus due to inherent data difficulty and method sensitivity
- **Medium confidence**: Semi-supervised benefits, pending clarity on loss schedule and mixing criteria

## Next Checks
1. Re-implement and validate the uncertainty-aware multi-task loss and semi-supervised loss switching logic to ensure fair comparison
2. Verify aorta mask quality and subtraction logic for thrombus segmentation to rule out implementation errors
3. Conduct ablation studies removing aorta-restricted conditioning to quantify its impact on synthesis and segmentation quality