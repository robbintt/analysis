---
ver: rpa2
title: Emergence and Localisation of Semantic Role Circuits in LLMs
arxiv_id: '2511.20910'
source_url: https://arxiv.org/abs/2511.20910
tags:
- roles
- role
- circuit
- circuits
- across
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces COMPASS, a causal-temporal methodology for
  discovering and tracking semantic-role circuits in large language models. By combining
  contrastive minimal pairs with edge-attribution patching, the method isolates role-specific
  computational subgraphs and follows their evolution across training checkpoints.
---

# Emergence and Localisation of Semantic Role Circuits in LLMs

## Quick Facts
- arXiv ID: 2511.20910
- Source URL: https://arxiv.org/abs/2511.20910
- Reference count: 40
- Key outcome: Semantic roles are encoded by highly concentrated circuits (89–94% of attribution mass in ≤28 nodes) that emerge through gradual structural refinement rather than discrete transitions, with moderate structural conservation (24–59% node overlap) across model scales and families.

## Executive Summary
This work introduces COMPASS, a causal-temporal methodology for discovering and tracking semantic-role circuits in large language models. By combining contrastive minimal pairs with edge-attribution patching, the method isolates role-specific computational subgraphs and follows their evolution across training checkpoints. Results show that semantic roles are encoded by highly concentrated circuits (89–94% of attribution mass in ≤28 nodes), that these circuits emerge through gradual structural refinement rather than discrete transitions, and that larger models reuse similar components while rewiring connections. Cross-scale and cross-family analyses reveal moderate structural conservation (24–59% node overlap) alongside high spectral similarity, indicating partial transferability of semantic mechanisms.

## Method Summary
The COMPASS methodology constructs role-cross minimal pairs that differ only in role-indicating scaffolds while controlling for lexical and syntactic confounds. Edge-Attribution Patching with Integrated Gradients (EAP-IG) computes causal edge scores by interpolating between clean and corrupted inputs and integrating gradients along the path. Top-K edges are extracted per checkpoint and aggregated to node-level importance scores. Circuits are tracked temporally by computing faithfulness via ablation, measuring structural stability with Jaccard overlap, and detecting consolidation thresholds. Cross-model comparisons use node/edge overlap and spectral distance metrics to assess architectural conservation.

## Key Results
- Semantic role circuits are highly localized, with 89–94% of attribution mass concentrated in ≤28 nodes per role
- Circuits emerge through continuous structural refinement rather than discrete transitions, with consolidation occurring 1–5 orders of magnitude before functional indispensability
- Cross-model analysis shows moderate node overlap (24–59%) and high spectral similarity, indicating partial transferability of semantic mechanisms across scales and families

## Why This Works (Mechanism)

### Mechanism 1: Edge Attribution Patching with Integrated Gradients (EAP-IG)
- Claim: EAP-IG approximates first-order causal effects of individual edges on role-specific predictions by integrating gradients along interpolation paths between clean and corrupted inputs.
- Mechanism: Compute activation differences Δu = z(clean) − z(corrupt) for each node. Interpolate between inputs at m=5 evenly-spaced points. Average gradients along the path: ḡv = (1/m)Σg(k)v. Edge score SIG(u→v) = Δ⊤uḡv captures accumulated non-linear response, reducing sensitivity to local gradient saturation.
- Core assumption: Straight-line interpolation through activation space provides meaningful gradient estimates; first-order approximation suffices for edge importance ranking.
- Evidence anchors:
  - [Section 3.2, Phase 1]: "EAP-IG computes edge scores approximating their causal contribution to LCNP: SIG(u→v) = Δ⊤uḡv"
  - [Appendix D.2]: Full interpolation and gradient integration formalization
  - [corpus]: Weak/no direct corpus evidence for EAP-IG on semantic roles; Hanna et al. (2024) cited as method source
- Break condition: If circuits require second-order edge interactions, or if 5-step integration misses saturation effects, attribution may miss causally important pathways.

### Mechanism 2: Role-Cross Minimal Pair Construction
- Claim: Contrasting prompts differing only in role-indicating scaffold (e.g., "delivered the package to the" vs "with the") isolates predicate-argument binding by controlling lexical/syntactic confounds.
- Mechanism: Fix agent, verb, theme across pairs; vary only the prepositional scaffold. Enforce token parity |toks(x(r))| = |toks(x(s))|. Filter to retain examples where model predicts correctly in BOTH contexts, ensuring circuits reflect active role processing.
- Core assumption: Semantic role computation is localizable; model behavior reflects abstract role binding rather than lexical pattern matching.
- Evidence anchors:
  - [Section 3.1]: "We construct role-cross minimal pairs that differ only in the scaffold... this behaviour should be mediated by localised role circuits C(r)"
  - [Appendix F.5]: Paraphrase controls show stable faithfulness under scaffold variation (INSTRUMENT: +0.02, LOCATION: -0.05)
  - [corpus]: Weak/no corpus evidence; paper notes first work combining causal localization with temporal tracking for compositional semantics
- Break condition: If models use diffuse representations, or if scaffolds introduce systematic confounds (e.g., frequency differences), contrastive approach misattributes.

### Mechanism 3: Continuous Structural Refinement with Structure-Function Dissociation
- Claim: Semantic role circuits emerge through gradual sparsification, not discrete phase transitions; structural consolidation precedes functional indispensability by many steps.
- Mechanism: Structural metrics (size, density, Top-K mass) evolve smoothly. Faithfulness exhibits non-monotonic crashes and recoveries. Consolidation tcons marks structural stability (Jaccard ≥0.6); change-point t̂c estimated via piecewise regression with bootstrap CIs showing extremely wide intervals (e.g., TIME: [128, 114,000]).
- Core assumption: Smooth structural evolution reflects continuous optimization; faithfulness fluctuations reflect changes in circuit engagement, not circuit formation.
- Evidence anchors:
  - [Section 5.2]: "Roles become indispensable within 0–512 steps, while structural refinement continues for over 143K steps... circuit presence does not guarantee circuit engagement"
  - [Table 3]: Change-point CIs extremely wide, "ruling out discrete transitions"
  - [corpus]: Related work (Nanda et al., 2023; Power et al., 2021) shows grokking has sharp transitions—contrastingly, this paper finds smooth evolution for semantic roles
- Break condition: If checkpoint spacing is insufficient to detect genuine phase transitions, apparent continuous refinement could be measurement artifact.

## Foundational Learning
- Concept: Transformer computational graphs as DAGs
  - Why needed here: Paper models transformers as G=(V,E) with nodes (type, layer, head, position); essential for interpreting edge attribution.
  - Quick check question: For a 16-layer transformer with 8 heads per layer and 12-token input, approximately how many attention-head nodes exist?
- Concept: Integrated Gradients and saturation
  - Why needed here: EAP-IG uses IG to mitigate gradient saturation; understanding why interpolation helps is prerequisite.
  - Quick check question: Why might gradients at the clean input alone be unreliable for attribution, and how does path integration address this?
- Concept: Semantic roles (theta-roles)
  - Why needed here: Paper tests predicate-argument binding (AGENT, THEME, INSTRUMENT); this linguistic framework underpins minimal pair construction.
  - Quick check question: In "The chef cut the vegetables with the knife," what semantic roles do "chef," "vegetables," and "knife" play?

## Architecture Onboarding
- Component map: Role-cross pairs → EAP-IG (per checkpoint) → Top-K edges → C(r)t → Faithfulness (ablation) vs Structure (Jaccard) → Emergence metrics: tind, t̂c, tcons → Cross-model: Jaccard overlap, spectral distance dspec
- Critical path: (1) Generate parity-matched pairs → (2) Filter dual-correct predictions → (3) EAP-IG at each checkpoint → (4) Extract top-K=200 edges, aggregate to nodes → (5) Compute faithfulness via ablation → (6) Detect tind/tcons from temporal signals → (7) Compare cross-model with Jaccard and Laplacian spectral distance.
- Design tradeoffs: K=20 for within-model vs K=30-50 for cross-model (precision vs coverage). IG steps m=5 chosen for tractability over 143K checkpoints—spot-checks confirmed sufficiency. Faithfulness and structure can diverge; don't conflate presence with engagement.
- Failure signatures: High faithfulness + low stability suggests overfitting to prompts. Cross-model node overlap <0.2 suggests architecture-specific mechanisms. Paraphrase faithfulness drop >0.1 indicates scaffold-specific circuits, not role-abstract.
- First 3 experiments:
  1. Replicate localization on INSTRUMENT for 1B model: generate 500 pairs, run EAP-IG at final checkpoint, verify Top-20 nodes capture >85% mass.
  2. Test structure-function dissociation: track faithfulness and Top-K mass across 10 checkpoints; confirm faithfulness fluctuates while mass increases monotonically.
  3. Validate paraphrase robustness: for 100 LOCATION examples, replace "in the" with "at the," recompute circuit, check Top-20 node overlap ≥0.7.

## Open Questions the Paper Calls Out
- Do semantic role circuits with similar localisation and emergence properties exist in typologically diverse languages with different argument realisation patterns? The study focuses exclusively on English; languages with case-marking, pro-drop, or non-configurational syntax may implement role binding through fundamentally different mechanisms.
- Do comparable localised circuits mediate other semantic abstractions such as quantification, modality, scope, and negation? This study isolates shallow predicate–argument binding; deeper semantic composition may require more distributed or fundamentally different computational mechanisms.
- What mechanisms drive the structure–function dissociation where circuits structurally consolidate thousands of steps before becoming functionally indispensable? The paper documents this dissociation but does not identify what triggers functional engagement after structural stabilisation.
- Why does cross-family node overlap (PYTHIA↔LLAMA: 51%) exceed the strongest within-family pairing (410M↔1B: 42%) despite different pretraining corpora and tokenisation? This counterintuitive finding suggests architectural convergence may override training differences, but the mechanism remains unidentified.

## Limitations
- Method relies on first-order edge attribution, which may miss higher-order interactions or saturation effects in semantic role circuits
- Temporal tracking depends heavily on checkpoint sampling density, with extremely wide change-point intervals raising questions about whether smooth refinement reflects true emergence or measurement artifacts
- Contrastive minimal pair construction assumes scaffolds isolate role-specific computation without introducing systematic confounds, though this remains largely theoretical given limited corpus validation

## Confidence
- High confidence: Circuit localization methodology (EAP-IG + top-K aggregation) and cross-model spectral similarity results are methodologically sound and reproducible
- Medium confidence: Emergence findings (smooth refinement vs discrete transitions) depend on checkpoint sampling assumptions and may overstate continuity if phase transitions occur between sampled points
- Medium confidence: Cross-family conservation results (24–59% node overlap) are robust, but structural transferability claims should be tempered given architectural differences

## Next Checks
1. **Checkpoint density validation:** Re-run temporal tracking on 1B model with 5× denser sampling (every 10K steps instead of 50K) to test whether apparent smooth refinement persists or reveals discrete transitions
2. **Higher-order attribution test:** Compare EAP-IG results with second-order methods (e.g., Shapley values or double-backpropagation) on a subset of circuits to quantify first-order approximation error
3. **Scaffold confound analysis:** Systematically vary scaffold frequency and length in minimal pairs to measure impact on circuit localization, ensuring observed role-specificity isn't driven by lexical/syntactic artifacts