---
ver: rpa2
title: 'FABLE: A Localized, Targeted Adversarial Attack on Weather Forecasting Models'
arxiv_id: '2505.12167'
source_url: https://arxiv.org/abs/2505.12167
tags:
- adversarial
- x2k1
- attack
- forecasting
- where
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the vulnerability of deep learning weather
  forecasting models to adversarial attacks. Existing methods struggle to balance
  faithfulness (achieving desired forecasts at targeted locations), closeness (keeping
  perturbations minimal and undetectable), and geospatio-temporal realisticness (preserving
  natural data dependencies).
---

# FABLE: A Localized, Targeted Adversarial Attack on Weather Forecasting Models

## Quick Facts
- **arXiv ID**: 2505.12167
- **Source URL**: https://arxiv.org/abs/2505.12167
- **Reference count**: 40
- **Key outcome**: FABLE achieves better geospatio-temporal realisticness and closeness than baseline methods while maintaining comparable faithfulness to targeted adversarial attacks on weather forecasting models.

## Executive Summary
This paper addresses the vulnerability of deep learning weather forecasting models to adversarial attacks by proposing FABLE, a novel framework that applies adversarial perturbations to wavelet-decomposed components of weather data rather than the raw input. By strategically applying larger perturbations to high-frequency components while preserving low-frequency structures, FABLE achieves better geospatio-temporal realisticness and closeness while maintaining comparable faithfulness to baseline methods. Experiments on NLDAS and ERA5 datasets show FABLE consistently outperforms existing approaches in realisticness and closeness metrics, with comparable faithfulness, and demonstrates lower detectability by anomaly detection methods.

## Method Summary
FABLE operates by decomposing weather data using 3D Haar wavelet transform into 8 sub-bands, then applying adversarial perturbations to these coefficients rather than the raw input. The optimization process uses frequency-specific penalty weights to apply larger perturbations to high-frequency components while preserving low-frequency structures that determine autocorrelation patterns. The framework balances three objectives: faithfulness (achieving desired forecasts at targeted locations), closeness (keeping perturbations minimal and undetectable), and geospatio-temporal realisticness (preserving natural data dependencies). The method uses gradient-based optimization with constraints to ensure perturbations remain within a specified ℓ∞ ball while maintaining realistic weather patterns.

## Key Results
- FABLE consistently outperforms baseline methods (TAAOWPF, PGD) in geospatio-temporal realisticness metrics (RS/RT) across both NLDAS and ERA5 datasets
- FABLE achieves lower detectability by wavelet-based anomaly detection methods with F1 scores of 0.47 compared to 0.98 for baseline methods
- The framework maintains comparable faithfulness (in-AE) to targeted attacks while significantly improving closeness and realisticness metrics

## Why This Works (Mechanism)

### Mechanism 1
Perturbing high-frequency wavelet components more than low-frequency components preserves geospatio-temporal autocorrelation better than direct input perturbation. The 3D Haar wavelet decomposition separates the input into 8 sub-bands, and by assigning lower penalty weights to high-frequency coefficients during optimization, larger perturbations are applied to detail components that capture fine-grained variations rather than smooth large-scale patterns. This disproportionately preserves the autocorrelation structure. The core assumption is that weather signals satisfy Σ|a₀(k)| ≥ Σ|d₀(k)| (approximation coefficients dominate detail coefficients in magnitude). Theorem 1 proves that perturbing approximation coefficients causes larger autocorrelation deviation than perturbing detail coefficients when this condition holds.

### Mechanism 2
Wavelet-domain perturbation achieves lower detectability by anomaly detection methods than direct input-space perturbation. The wavelet-based anomaly detector (Daubechies-4, level-2 decomposition with autoencoder) flags inputs with high reconstruction error. FABLE's perturbations, concentrated in high-frequency bands that naturally exhibit higher entropy and variability, produce reconstruction errors within normal bounds (μ + 3σ threshold), whereas baseline methods perturb all frequencies uniformly, triggering detection. This works because the anomaly detector's training distribution captures natural high-frequency variability but flags unnatural low-frequency alterations.

### Mechanism 3
The faithfulness-realisticness trade-off is controllable via regularization strength λ and frequency-specific penalty weights ω_f. The optimization objective L_f(Ŷ', g(X'(C'))) + λL_C(C, C'; ω) balances adversarial target alignment (faithfulness) against coefficient perturbation magnitude weighted by ω_f. Increasing λ prioritizes realisticness at faithfulness cost; decreasing ω_f for high-frequency bands allows more aggressive detail perturbation without proportional autocorrelation damage. The loss landscape permits gradient-based optimization without severe local minima trapping the iterative process.

## Foundational Learning

- **3D Discrete Wavelet Transform (Haar basis)**: Decomposes spatiotemporal weather tensors into frequency sub-bands, enabling frequency-aware perturbation control. Quick check: Given a 4×4×4 tensor, what are the dimensions of each wavelet sub-band after level-1 3D Haar decomposition?

- **Moran's I (Spatial Autocorrelation)**: Quantifies realisticness by measuring spatial dependency preservation between original and adversarial inputs. Quick check: If Moran's I ≈ 0 for a spatial map, what does this imply about the spatial structure?

- **Projected Gradient Descent (PGD) for Adversarial Attacks**: Baseline attack method; understanding it clarifies why FABLE's wavelet-domain approach differs from direct input perturbation. Quick check: In PGD, what does the projection step ensure about the adversarial sample?

## Architecture Onboarding

- **Component map**: Input layer (X) → 3D Haar wavelet decomposition → 8 coefficient tensors (C_f) → Perturbation module (Adam optimizer) → Inverse wavelet transform → Reconstructed input (X') → Forecast model (g(X'))

- **Critical path**: 1. Initialize C = WaveletDecompose(X); 2. For N iterations: compute gradients ∇_C'(L_f + λL_C), update C', clip X' to ε-ball; 3. Return X' with lowest loss across all iterations

- **Design tradeoffs**: λ selection (high λ → better realisticness, worse faithfulness); ω_f assignment (paper uses {LLH: 0.8, LHL: 0.8, HLL: 0.8, LHH: 0.5, HLH: 0.5, HHL: 0.5, HHH: 0.2}); iteration count (paper uses 1000 with best-loss selection; 500 often sufficient)

- **Failure signatures**: High out-AE with low in-AE (over-regularization, λ too large); high RS/RT values (ω_f weights not emphasizing high-frequency enough); non-convergence (learning rate mismatch with ε clipping threshold)

- **First 3 experiments**: 1. Replicate NLDAS-TMP2M baseline with λ=1e-4, verify in-AE ≈ 0.43, RS ≈ 0.03; 2. Ablation: Set all ω_f = 1.0 (uniform perturbation), measure RS/RT degradation vs. default weights; 3. Transfer test: Apply FABLE perturbations from FourCastNet to CLCRN, assess if realisticness advantage persists across model architectures

## Open Questions the Paper Calls Out

1. **Black-box extension**: Extending the study to black-box scenarios where the adversary lacks full access to the weather forecasting model architecture and parameters is deferred to future work.

2. **Alternative wavelet bases**: Future directions include exploring higher-level decompositions and alternative wavelet bases for adversarial attacks beyond the current Haar decomposition.

3. **Multivariate settings**: Extending FABLE to multivariate geospatio-temporal settings, where ensuring physical consistency and realisticness across correlated variables remains a key challenge.

4. **Cross-domain transfer**: The generality of Theorems 1 and 2 suggests that FABLE's strategy is to generate attacks on other spatiotemporal data, though empirical validation outside weather datasets is needed.

## Limitations

- The theoretical justification for frequency-specific perturbation weights depends on the assumption that low-frequency components dominate signal energy, which requires broader empirical validation across diverse weather datasets.
- The detectability evasion claims are based on a single wavelet-based anomaly detection method; performance against other detection approaches (gradient-based, ensemble methods) remains untested.
- The optimal λ value for balancing faithfulness-realisticness trade-offs is presented as sensitive but the specific choice for main experiments is not explicitly stated, creating reproducibility concerns.

## Confidence

- **High Confidence**: Comparative performance results showing FABLE's superior realisticness (RS/RT) and detectability (lower F1 scores against wavelet-based anomaly detectors) are well-supported by experimental data across two datasets and two model architectures.
- **Medium Confidence**: Mechanism claims regarding autocorrelation preservation through frequency-weighted perturbations are theoretically grounded (Theorem 1) but rely on assumptions about signal energy distribution that require broader validation.
- **Low Confidence**: Detectability evasion claims are based on a single wavelet-based anomaly detection method; performance against other detection approaches remains untested.

## Next Checks

1. **Signal Energy Distribution Validation**: Test the Σ|a₀(k)| ≥ Σ|d₀(k)| condition across multiple weather variables and datasets to verify the theoretical foundation for frequency-weighted perturbations.

2. **Cross-Detector Evaluation**: Assess FABLE's evasion performance against gradient-based and ensemble anomaly detection methods to determine if wavelet-domain evasion transfers to other detection paradigms.

3. **Extreme Weather Scenario Testing**: Evaluate FABLE's performance when targeting rare events (tropical cyclones, extreme precipitation) where low-frequency components may not dominate as expected, potentially challenging the theoretical assumptions.