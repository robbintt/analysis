---
ver: rpa2
title: Geometry of Drifting MDPs with Path-Integral Stability Certificates
arxiv_id: '2601.21991'
source_url: https://arxiv.org/abs/2601.21991
tags:
- path
- geometry
- fixed
- mdps
- each
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper addresses nonstationary reinforcement learning, where\
  \ the environment evolves along a differentiable homotopy path. It quantifies tracking\
  \ difficulty via a length\u2013curvature\u2013kink decomposition: cumulative drift\
  \ (PL), drift-rate variation (Curv), and action-gap-induced nonsmoothness (\u03A6\
  )."
---

# Geometry of Drifting MDPs with Path-Integral Stability Certificates

## Quick Facts
- arXiv ID: 2601.21991
- Source URL: https://arxiv.org/abs/2601.21991
- Reference count: 40
- Primary result: Nonstationary RL tracking difficulty decomposes into length, curvature, and kink terms; lightweight replay-based proxies enable adaptive hyperparameter tuning that reduces dynamic regret.

## Executive Summary
This paper addresses nonstationary reinforcement learning, where the environment evolves along a differentiable homotopy path. It quantifies tracking difficulty via a length–curvature–kink decomposition: cumulative drift (PL), drift-rate variation (Curv), and action-gap-induced nonsmoothness (Φ). Under mild regularity, it proves a path-integral stability bound bounding optimal-value displacement and derives gap-safe feasible regions that certify local stability away from switch regimes. Building on these results, it introduces Homotopy-Tracking RL (HT-RL) and HT-MCTS—lightweight wrappers that estimate replay-based proxies for length, curvature, and near-tie proximity online and adapt learning or planning intensity accordingly. Experiments on synthetic and drifting-control benchmarks show improved tracking and lower dynamic regret than matched static baselines, with largest gains in oscillatory and switch-prone regimes.

## Method Summary
The method frames nonstationary RL as tracking a fixed point along a differentiable homotopy path τ ↦ M(τ). It estimates geometric quantities (Path Length, Curvature, Kinks) using replay buffer data via Wasserstein-1 proxies on reward and feature drift. These signals drive a scheduler that modulates learning rate, target-update rate, and regularization. For MCTS planning, it adjusts depth and budget analogously. The core theory provides a stability bound separating displacement into path length, curvature, and kink terms, and constructs gap-safe feasible tubes for local stability certification.

## Key Results
- Proves a path-integral stability bound: optimal-value displacement decomposes into length/(1-γ)², curvature/(1-γ)³, and kink penalty terms.
- Introduces gap-safe feasible tubes that certify local stability away from action-switch regimes.
- HT-RL wrapper reduces dynamic regret by 10-25% on drifting control benchmarks vs. static baselines, with largest gains in switch-prone regimes.
- HT-MCTS similarly improves tracking in nonstationary planning tasks.

## Why This Works (Mechanism)

### Mechanism 1: Length–Curvature–Kink Decomposition
The paper models environment evolution as a differentiable homotopy path τ ↦ M(τ). By analyzing the induced motion of the optimal Bellman fixed point Q*_τ, it derives a path-integral stability bound (Theorem 5.4) that separates displacement into a first-order term (Path Length), a second-order term (Curvature), and a nonsmooth penalty term (Kinks) where the greedy action flips. Core assumption: the MDP path is differentiable in τ and the optimal value function admits a uniform Lipschitz scale. Evidence: explicit bound formula, synthetic experiments showing regime-dependent tracking difficulty. Break condition: bound loosens if path is non-differentiable or kinks persist over wide intervals.

### Mechanism 2: Gap-Safe Feasible Tubes
On the "regular region" (where action gap g_τ ≥ ξ), the Implicit Function Theorem bounds Q*_drift (Lemma 5.2). First- and second-order tubes (Theorems 5.5 & 5.6) define how far τ can move before value deviation exceeds ε, enforcing a "Gap-safe" constraint to prevent crossing into switch regimes. Core assumption: Jacobian of optimality map is invertible. Evidence: formal tube definitions, stability claims for regular regions. Break condition: construction fails at kinks where gap = 0 and derivative is undefined.

### Mechanism 3: Replay-Based Geometry Proxies
HT-RL estimates Path Length via max deviation in reward EMA and transition-feature means, Curvature via rate of change of this deviation, and Kinks via minimum action-gap proxy. These drive a scheduler modulating learning rate, target-update rate, and regularization. Core assumption: replay buffer contains sufficient recent data to approximate Wasserstein-1 drift. Evidence: Algorithm 1 equations, experiments showing adaptive tuning benefits. Break condition: high noise or insufficient replay diversity may misestimate geometric drift.

## Foundational Learning

- **Concept: Homotopy Continuation**
  - **Why needed here:** Frames nonstationary RL as tracking a fixed point along a deforming path, rather than solving static problems or reacting to discrete jumps.
  - **Quick check question:** Can you explain why differentiating the Bellman fixed point requires the optimal policy to be locally constant (the "envelope property")?

- **Concept: Lipschitz Continuity & Wasserstein-1 Distance**
  - **Why needed here:** Geometry metrics rely on bounding changes in transition kernels; dual W*_1 norm measures drift in value-relevant scale.
  - **Quick check question:** How does the Lipschitz constant of optimal value function (C_mix) scale the impact of transition drift (Path Length)?

- **Concept: Contraction Mapping Theory**
  - **Why needed here:** Stability analysis depends on Bellman operator being a γ-contraction; feasible tubes derive from inverting (I - γP^π_τ).
  - **Quick check question:** In Theorem 5.4, why does Curvature term scale with (1-γ)^(-3) while Path Length scales with (1-γ)^(-2)?

## Architecture Onboarding

- **Component map:** Replay Buffer -> Proxy Estimator -> Homotopy Scheduler -> Base Solver
- **Critical path:** System stability depends on Scheduler's hysteresis and EMA smoothing. If proxies fluctuate wildly, hyperparameter process becomes unstable, destroying solver's contraction properties.
- **Design tradeoffs:**
  - Proxy Window Size (W_1, W_2): Larger windows reduce noise but increase latency detecting drift curvature.
  - Gap Threshold (ε_gap): High threshold treats many states as "kink-prone" (conservative), low threshold risks instability during action switches.
  - Scheduler Aggressiveness: Strong Curvature reaction reduces dynamic regret but may introduce oscillations if path is noisy.
- **Failure signatures:**
  - Chattering: Hyperparameters oscillate rapidly; indicates insufficient hysteresis or EMA smoothing.
  - Stale Tracking: Proxies report low drift while optimal policy lags; suggests feature map φ is insensitive to value-relevant changes.
  - Collapse at Kinks: Performance drops sharply at environment changes; indicates Gap proxy failed to detect near-tie or learning rate was too high during switch.
- **First 3 experiments:**
  1. Implement synthetic ring MDP with n=20 states, 3 actions; construct three homotopy regimes (length-dominated via linear reward center movement, curvature-dominated via S-curve, kink-prone via competing action rewards). Verify Theorem 5.4 bound by computing Q*_τ via value iteration and comparing ∥Q*_(τ_1) - Q*_(τ_0)∥∞ against PL/(1-γ)² + Curv/(1-γ)³ + Φ.
  2. On synthetic path, plot "first-order tube" and "second-order tube" against actual deviation of Q* to validate tubes are tight.
  3. On continuous control task (e.g., LunarLander), ablate Kink/Gap-awareness in scheduler (set β_1=0) to demonstrate performance degradation specifically in switch-prone regimes.

## Open Questions the Paper Calls Out

- **Can the path-integral stability bound be extended to non-differentiable or discontinuous homotopy paths (e.g., adversarial jumps)?**
  - Basis: Section 3 defines environment as "differentiable homotopy path," and bounds rely on first- and second-order derivatives which don't exist at sharp discontinuities.
  - Why unresolved: Bounds use path length/curvature integrals that integrate derivatives; no treatment of abrupt non-smooth shifts.
  - What evidence would resolve: Derivation using total variation or jump-diffusion measures instead of path length/curvature integrals.

- **How can the kink penalty (action-gap-induced nonsmoothness) be rigorously defined for continuous action spaces?**
  - Basis: Definition 4.2 defines global action gap g_τ and kink set K by taking max/min over discrete action set A; Appendix D.6 mentions proxy using "top-1" modes but acknowledges difficulty.
  - Why unresolved: Gap becomes ill-defined or zero in dense continuous spaces; kink concept relies on discrete boundaries.
  - What evidence would resolve: Formal extension of Theorem 5.4 where Φ is defined via gradient norms or manifold boundaries in continuous action space.

- **Do dynamic regret guarantees (Theorem 6.3) hold for non-monotone, cyclic, or reversing homotopy paths?**
  - Basis: Section 6.2 states guarantee applies to "any (possibly stochastic) monotone path (τ_t)_t=1^T".
  - Why unresolved: Real-world nonstationarity often involves oscillatory cycles where τ may reverse, potentially causing geometric decomposition terms to accrue differently than in monotone case.
  - What evidence would resolve: Generalization where geometric term accounts for path "backtracking" or oscillation frequency without requiring monotonicity.

## Limitations
- Theoretical bounds rely heavily on smoothness assumptions and uniform Lipschitz constants that may not hold in complex deep RL environments.
- Gap-safe tube construction is local and requires starting in a regular region; performance may degrade near or at kinks.
- Proxy estimation quality depends on feature map sensitivity to transition drift; poorly chosen φ may yield misleading geometric signals.

## Confidence
- **High**: Length–curvature–kink decomposition is well-supported by theorem and synthetic experiments; bound structure is mathematically rigorous.
- **Medium**: Gap-safe feasible tube theory is sound but relies on strong regularity conditions; practical tightness in noisy deep RL settings is uncertain.
- **Medium**: Replay-based proxies are lightweight and intuitive, but robustness to high-dimensional or stochastic environments needs empirical validation.

## Next Checks
1. **Bound Verification:** On synthetic ring MDP, compute true Q* deviation ∥Q*_τ₁ - Q*_τ₀∥∞ and compare against Theorem 5.4 bound for all three regimes (length-, curvature-, kink-dominated).
2. **Tube Tightness:** Plot first- and second-order safe tubes (Theorems 5.5 & 5.6) against actual Q* drift in synthetic path to assess over-conservatism.
3. **Proxy Sensitivity:** In LunarLander with gravity drift, ablate Kink-awareness (set β₁=0) and measure performance loss specifically in switch-prone vs. smooth-drift regimes.