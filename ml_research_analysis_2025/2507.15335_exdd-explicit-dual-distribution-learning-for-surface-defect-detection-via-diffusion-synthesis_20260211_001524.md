---
ver: rpa2
title: 'ExDD: Explicit Dual Distribution Learning for Surface Defect Detection via
  Diffusion Synthesis'
arxiv_id: '2507.15335'
source_url: https://arxiv.org/abs/2507.15335
tags:
- detection
- anomaly
- defect
- exdd
- memory
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper presents ExDD, a surface defect detection framework that
  explicitly models dual feature distributions (normal and anomalous) using parallel
  memory banks, overcoming limitations of traditional one-class methods. The approach
  integrates diffusion-based synthetic anomaly generation via text-conditioned latent
  diffusion models to address data scarcity, creating in-distribution defects that
  preserve industrial context.
---

# ExDD: Explicit Dual Distribution Learning for Surface Defect Detection via Diffusion Synthesis

## Quick Facts
- arXiv ID: 2507.15335
- Source URL: https://arxiv.org/abs/2507.15335
- Reference count: 20
- Key outcome: State-of-the-art surface defect detection with 94.2% image-level AUROC and 97.7% pixel-level AUROC on KSDD2 dataset

## Executive Summary
ExDD introduces a novel surface defect detection framework that explicitly models dual feature distributions (normal and anomalous) using parallel memory banks, overcoming limitations of traditional one-class methods. The approach integrates diffusion-based synthetic anomaly generation via text-conditioned latent diffusion models to address data scarcity, creating in-distribution defects that preserve industrial context. ExDD employs a neighborhood-aware ratio scoring mechanism that combines distance-to-normal and similarity-to-defect metrics for robust anomaly detection. Experiments on the KSDD2 dataset demonstrate state-of-the-art performance with 94.2% image-level AUROC and 97.7% pixel-level AUROC, with optimal synthetic augmentation achieved at 100 samples.

## Method Summary
The ExDD framework operates by first extracting patch features from industrial surface images using a WideResNet50 backbone. Features from layers 2 and 3 are concatenated and projected to 128D, then stored in two asymmetric memory banks: a Negative Memory Bank (MN) containing 2% subsampled normal patches and a Positive Memory Bank (MP) containing 10% subsampled defective patches (including synthetic defects). Synthetic anomalies are generated via SDXL inpainting using text prompts "copper metal scratches" and "white marks on the wall" applied to defect-free regions identified by ground-truth masks. For anomaly detection, ExDD computes neighborhood-aware ratio scores combining distance-to-normal (s_N) and similarity-to-defect (s_P) metrics, followed by Gaussian smoothing for localization.

## Key Results
- Achieves 94.2% image-level AUROC and 97.7% pixel-level AUROC on KSDD2 dataset
- Outperforms state-of-the-art methods with margin exceeding 5% in both image and pixel metrics
- Demonstrates optimal synthetic augmentation at 100 generated samples (50 per text prompt)
- Provides both detection and precise localization capabilities for industrial surface inspection

## Why This Works (Mechanism)
The dual distribution modeling approach overcomes the fundamental limitation of one-class methods that treat normal data as the only class. By explicitly maintaining separate representations for normal and anomalous features, ExDD can capture the full feature space geometry rather than just the normal manifold. The neighborhood-aware ratio scoring mechanism provides robustness by considering both absolute distances and relative similarities within local neighborhoods. Synthetic anomaly generation via diffusion models addresses the critical data scarcity issue in industrial defect detection, creating realistic defects that preserve the underlying material texture and lighting conditions.

## Foundational Learning
- **Diffusion-based synthetic anomaly generation**: Creates realistic defect samples by conditioning on defect types (scratches, white marks) while preserving industrial context; needed because real defective samples are scarce; quick check: verify synthetic defects match real defect morphology
- **Dual memory bank architecture**: Separates normal and anomalous feature distributions with asymmetric sampling ratios; needed to capture full feature space geometry; quick check: MN should be significantly larger than MP (5:1 ratio)
- **Neighborhood-aware ratio scoring**: Combines absolute distance and relative similarity metrics; needed for robust detection insensitive to feature scaling; quick check: ratio scores should peak at defect locations after Gaussian smoothing

## Architecture Onboarding

**Component Map:**
Image → WideResNet50 → Layer 2+3 features → 3×3 neighborhood aggregation → Random projection (1536→128D) → MN/MP → Ratio scoring → Gaussian smoothing → Detection map

**Critical Path:**
Patch feature extraction → Memory bank construction → Neighborhood-aware ratio scoring → Gaussian smoothing → Localization

**Design Tradeoffs:**
- Asymmetric memory bank sampling (2% normal, 10% defective) balances memory efficiency with representation coverage
- Random projection to 128D reduces dimensionality while preserving discriminative information
- SDXL inpainting with strength=0.99 ensures realistic defects while maintaining industrial context

**Failure Signatures:**
- Poor detection if synthetic defects are out-of-distribution (prompt quality issues)
- Degraded performance if memory banks are incorrectly subsampled (symmetric vs asymmetric ratios)
- Localization errors if Gaussian smoothing parameters are suboptimal

**3 First Experiments:**
1. Verify memory bank construction by checking MN/MP size ratios (should be ~5:1)
2. Ablation study: vary synthetic sample count (25, 50, 100, 200) to confirm optimal value
3. Test framework on NEU-DET dataset to evaluate generalization beyond KSDD2

## Open Questions the Paper Calls Out
None

## Limitations
- Implementation details for random projection normalization and greedy coreset subsampling are underspecified
- Synthetic defect quality highly dependent on prompt engineering and mask selection, limiting generalization
- Performance relies on maintaining precise asymmetric memory bank sampling ratios

## Confidence

**High confidence**: Dual distribution modeling concept and theoretical advantages over one-class approaches
**Medium confidence**: Reproducibility of neighborhood-aware ratio scoring mechanism with well-defined mathematical framework
**Medium confidence**: Diffusion-based synthetic augmentation approach, though prompt effectiveness may vary across defect types
**Low confidence**: Achieving identical performance metrics without exact random projection and coreset implementation details

## Next Checks

1. Verify memory bank construction by checking that negative memory bank size exceeds positive memory bank size by approximately 5×, confirming correct asymmetric subsampling
2. Perform ablation studies by varying synthetic sample count (25, 50, 100, 200) to confirm the reported optimal value of 100 samples
3. Test the framework on a different industrial surface defect dataset (e.g., NEU-DET) to evaluate generalization beyond KSDD2