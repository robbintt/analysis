---
ver: rpa2
title: Predicting Mycotoxin Contamination in Irish Oats Using Deep and Transfer Learning
arxiv_id: '2512.22243'
source_url: https://arxiv.org/abs/2512.22243
tags:
- tabpfn
- mycotoxin
- were
- toxin
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This study developed deep learning models to predict mycotoxin
  contamination in Irish oats, addressing food safety and agricultural productivity
  challenges. The researchers created a dataset of 24 mycotoxins across 100+ Irish
  locations with environmental, agronomic, and geographical predictors, then tested
  five modelling approaches: baseline MLP, pre-trained MLP, TabPFN, TabNet, and FT-Transformer.'
---

# Predicting Mycotoxin Contamination in Irish Oats Using Deep and Transfer Learning

## Quick Facts
- arXiv ID: 2512.22243
- Source URL: https://arxiv.org/abs/2512.22243
- Reference count: 40
- Primary result: Transfer learning approach TabPFN achieved RMSE of 0.81 µg/kg and AUC of 0.96 for predicting mycotoxin contamination in Irish oats

## Executive Summary
This study developed deep learning models to predict mycotoxin contamination in Irish oats, addressing food safety and agricultural productivity challenges. The researchers created a dataset of 24 mycotoxins across 100+ Irish locations with environmental, agronomic, and geographical predictors, then tested five modelling approaches: baseline MLP, pre-trained MLP, TabPFN, TabNet, and FT-Transformer. The transfer learning approach TabPFN achieved the best overall performance, outperforming other models across three of four evaluation metrics, while the baseline neural network was a close second. Variable importance analysis revealed that weather patterns during the 90-day pre-harvest period, particularly humidity history, were the most influential predictors.

## Method Summary
The study created a dataset of 300+ samples from 100+ Irish locations (2022-2023) with 40 agronomic predictors, 90-day pre-harvest weather variables from ERA5, and 24 mycotoxin response variables. Five models were compared: Baseline MLP (128→64 units, ReLU, dropout 0.2), Pre-trained MLP (autoencoder), TabPFN, TabNet, and FT-Transformer. Custom masked MSE/BCE loss functions handled missing responses without discarding samples. The 80/20 train/test split preserved location-year groups to avoid leakage. Models were evaluated using RMSE, R² for regression and AUC, F1-score for classification, both per-toxin and averaged.

## Key Results
- TabPFN achieved best overall performance with RMSE of 0.81 µg/kg and AUC of 0.96
- Baseline MLP was second-best with R² of 0.57
- Weather patterns during 90-day pre-harvest period, particularly humidity history, were most influential predictors
- Custom masked loss functions enabled handling missing values without discarding incomplete samples

## Why This Works (Mechanism)

### Mechanism 1
Pre-trained tabular priors enable strong generalization from limited agricultural samples. TabPFN encodes a learned prior over millions of synthetic tabular problems and conditions on the provided training set at inference, leveraging inductive biases about tabular structure that transfer to small, heterogeneous mycotoxin datasets. Core assumption: synthetic pre-training overlaps sufficiently with real agricultural contamination tasks. Break condition: if target data distributions differ drastically from synthetic pre-training.

### Mechanism 2
Masked loss functions preserve training signal across partially observed multi-response targets. For each sample, a binary mask identifies observed vs. missing toxin labels, and the loss aggregates error only over observed entries. This enables joint multi-task learning across 24 toxins without discarding samples with incomplete measurements. Core assumption: missingness is not systematically informative about the outcome. Break condition: if missingness correlates with contamination levels, the model may learn biased representations.

### Mechanism 3
Pre-harvest humidity and moisture signals capture conditions favorable to fungal proliferation and toxin production. Fungal growth and mycotoxin biosynthesis are highly moisture-dependent, and the 90-day pre-harvest window includes critical crop development stages. Cumulative humidity and seed moisture at harvest reflect both ambient conditions and crop state that modulate fungal activity. Core assumption: the 90-day lag window adequately captures the causal exposure period. Break condition: if local microclimates deviate significantly from ERA5 grid estimates, the humidity signal may weaken.

## Foundational Learning

- **Concept**: Transfer learning for tabular data (Prior-Data Fitted Networks)
  - Why needed: TabPFN's success depends on understanding that tabular transfer differs from image/NLP transfer; it amortizes inference across datasets via a transformer trained on synthetic tasks
  - Quick check: Can you explain why TabPFN does not require gradient-based fine-tuning on the target task?

- **Concept**: Multi-task learning with heterogeneous missingness
  - Why needed: The 24-toxin prediction task has variable missingness; masked losses enable shared backbone learning without sample wastage
  - Quick check: What would happen to effective sample size if you dropped all samples with any missing toxin label?

- **Concept**: Permutation-based variable importance with grouped categorical features
  - Why needed: One-hot encoded factors (county, variety) require grouped permutation to preserve categorical structure during importance estimation
  - Quick check: Why does permuting individual dummy variables independently break the meaning of importance scores?

## Architecture Onboarding

- **Component map**: Input (454 features) -> Baseline MLP (Dense(128, ReLU, dropout=0.2) → Dense(64, ReLU, dropout=0.2)) -> Output heads (Regression head: 24 units, ReLU; Classification head: 24 units, sigmoid) -> Masked MSE + masked BCE loss

- **Critical path**: 1. Data preprocessing: multiple imputation, log(x+1) transform, sine-cosine date encoding 2. Mask creation for response variables 3. Train/val/test split preserving location-year blocks 4. Model training with early stopping 5. Permutation importance using masked losses

- **Design tradeoffs**: TabPFN: best classification, no custom loss support; Baseline MLP: supports masked multi-task, requires more training data; FT-Transformer: flexible heads with masking, moderate performance; Autoencoder pre-training: unfrozen fine-tuning outperforms frozen, adds complexity

- **Failure signatures**: TabNet: negative R² and low AUC; Frozen encoder transfer: R² drops from 0.47 to 0.26; High missingness toxins: reduced reliability, some AUC scores inflated by small test sets

- **First 3 experiments**: 1. Reproduce baseline MLP with masked losses on single toxin to verify loss computation 2. Compare TabPFN vs. baseline on reduced feature set (weather only) 3. Ablate grouped vs. ungrouped permutation importance on categorical variable

## Open Questions the Paper Calls Out

- **Question**: Can transfer learning approaches (particularly TabPFN) generalize to mycotoxin prediction in other geographic regions with different climatic conditions and agricultural practices?
  - Basis: Geographic specificity limits generalization to other regions
  - Why unresolved: Study limited to Irish oats from ~100 locations
  - Evidence needed: Evaluation on independent oat datasets from contrasting climates

- **Question**: Would ensemble approaches combining strengths of different architectures yield superior performance?
  - Basis: Each model excels on different toxin-metric combinations
  - Why unresolved: No ensemble was tested
  - Evidence needed: Systematic comparison of stacked/weighted ensemble models

- **Question**: Would incorporating additional data sources (remote sensing, soil microbiome, real-time sensors) significantly improve predictive accuracy?
  - Basis: Current predictors limited to weather, agronomic, and geographic variables
  - Why unresolved: Spectral or microbiome signals remain unexplored
  - Evidence needed: Ablation or augmentation study measuring changes when adding new data modalities

- **Question**: Can predictive models be effectively integrated into operational decision support systems for real-time mycotoxin risk management?
  - Basis: Study focused on retrospective prediction, not prospective deployment
  - Why unresolved: Live weather feeds and user acceptance not tested
  - Evidence needed: Pilot deployment with live weather feeds, evaluating lead time and user acceptance

## Limitations

- Dataset comprises only two years of data from a single country, potentially limiting model robustness to diverse growing conditions
- TabPFN's superior performance cannot be fully attributed to transfer learning without ablation studies comparing against models trained from scratch on synthetic data
- Masked loss approach assumes missingness is not systematically informative about contamination levels, which may not hold if certain toxins are only tested when visually suspicious

## Confidence

- **High confidence**: Performance metrics for TabPFN (RMSE 0.81, AUC 0.96) and baseline MLP (R² 0.57) based on reported results
- **Medium confidence**: Humidity and moisture as key predictors, supported by permutation importance but lacking direct corpus validation for agricultural mycotoxin applications
- **Low confidence**: Generalizability of TabPFN to other agricultural prediction tasks without additional validation studies

## Next Checks

1. Conduct cross-validation across multiple growing seasons to assess model stability and seasonal variation effects
2. Compare TabPFN performance against models trained on domain-specific synthetic agricultural data rather than generic tabular datasets
3. Analyze missingness patterns to determine if toxins are systematically omitted from testing and whether this introduces bias in the masked loss training approach