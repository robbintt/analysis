---
ver: rpa2
title: Thompson Sampling for Repeated Newsvendor
arxiv_id: '2502.09900'
source_url: https://arxiv.org/abs/2502.09900
tags:
- demand
- regret
- lemma
- distribution
- newsvendor
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper studies Thompson Sampling (TS) for the repeated newsvendor
  problem, a classic framework in inventory management. The challenge is to learn
  an unknown demand distribution while minimizing inventory costs under censored feedback,
  where only sales up to the order quantity are observed.
---

# Thompson Sampling for Repeated Newsvendor

## Quick Facts
- arXiv ID: 2502.09900
- Source URL: https://arxiv.org/abs/2502.09900
- Reference count: 40
- This paper studies Thompson Sampling for the repeated newsvendor problem, establishing optimal (up to logarithmic factors) frequentist regret bounds under Weibull demand distributions.

## Executive Summary
This paper studies Thompson Sampling (TS) for the repeated newsvendor problem, a classic framework in inventory management. The challenge is to learn an unknown demand distribution while minimizing inventory costs under censored feedback, where only sales up to the order quantity are observed. TS is proposed to dynamically adjust order quantities by sampling from a posterior distribution initialized with a Gamma prior. The analysis establishes optimal (up to logarithmic factors) frequentist regret bounds under Weibull demand, showing that TS automatically balances exploration and exploitation: when past orders are large, it accurately estimates demand parameters for near-optimal ordering; when past orders are small, it increases future order quantities to gather more information. The method is also extended to general parametric demand distributions, with Bayesian regret bounds derived using Kaplan-Meier estimators. Extensive numerical experiments demonstrate that TS outperforms conservative approaches like online convex optimization, UCB, and myopic Bayesian dynamic programming.

## Method Summary
The paper proposes Thompson Sampling for the repeated newsvendor problem, where an agent must learn an unknown demand distribution while minimizing inventory costs under censored feedback. The method initializes a Gamma prior over demand parameters and updates the posterior distribution based on observed sales data, which is censored at the order quantity. At each period, TS samples from the posterior to determine the order quantity, balancing exploration (gathering information about demand) and exploitation (ordering near-optimal quantities). The analysis establishes regret bounds under Weibull demand distributions and extends the approach to general parametric families using Kaplan-Meier estimators for censored data.

## Key Results
- Establishes optimal (up to logarithmic factors) frequentist regret bounds for Thompson Sampling under Weibull demand distributions
- Demonstrates TS automatically balances exploration and exploitation through adaptive ordering behavior
- Shows TS outperforms conservative approaches including online convex optimization, UCB, and myopic Bayesian dynamic programming
- Extends the method to general parametric demand distributions with Bayesian regret bounds using Kaplan-Meier estimators

## Why This Works (Mechanism)
Thompson Sampling works for the repeated newsvendor problem because it naturally handles the exploration-exploitation trade-off inherent in learning unknown demand distributions under censored feedback. By sampling from a posterior distribution initialized with a Gamma prior, TS dynamically adjusts order quantities based on accumulated information. When past orders are large, the posterior concentrates around accurate demand estimates, leading to near-optimal ordering. When past orders are small, the posterior remains diffuse, encouraging larger future orders to gather more information about demand. This adaptive behavior allows TS to achieve optimal regret bounds while handling the censoring inherent in the newsvendor setting.

## Foundational Learning
- **Repeated newsvendor problem**: Why needed - provides the foundational inventory management framework with censored feedback; Quick check - verify understanding of how only sales up to order quantity are observed
- **Thompson Sampling**: Why needed - core algorithm for balancing exploration and exploitation in Bayesian settings; Quick check - confirm understanding of posterior sampling mechanism
- **Censored feedback**: Why needed - distinguishes this problem from standard bandit settings where full outcomes are observed; Quick check - ensure comprehension of how censoring affects learning
- **Kaplan-Meier estimator**: Why needed - extends TS to general parametric distributions with censored data; Quick check - verify understanding of non-parametric survival analysis techniques
- **Frequentist vs Bayesian regret**: Why needed - different performance metrics for evaluating online learning algorithms; Quick check - confirm understanding of the distinction between these regret types

## Architecture Onboarding

**Component Map**
Gamma prior -> Posterior update -> Thompson Sampling -> Order quantity -> Observed sales (censored) -> Regret calculation

**Critical Path**
Initialization with Gamma prior → Posterior update using censored sales data → Thompson Sampling for order quantity → Cumulative regret computation

**Design Tradeoffs**
- Prior choice: Gamma prior allows conjugacy but may not match all demand distributions
- Exploration vs exploitation: TS automatically balances these through posterior sampling rather than explicit tuning
- Computational efficiency: Sampling from posterior is tractable compared to exact Bayesian optimization

**Failure Signatures**
- Poor regret performance when true demand distribution significantly differs from assumed parametric family
- Over-conservative ordering when prior is too informative relative to limited data
- Instability in posterior updates when censoring is severe and data is sparse

**3 First Experiments**
1. Compare TS regret against myopic ordering policy on synthetic Weibull demand data
2. Test sensitivity to prior hyperparameters by varying Gamma distribution parameters
3. Evaluate performance degradation when demand distribution deviates from Weibull assumption

## Open Questions the Paper Calls Out
None

## Limitations
- Theoretical analysis currently limited to Weibull demand distributions, with extensions to general parametric families requiring further validation
- Claim of optimal (up to logarithmic factors) frequentist regret bounds is specific to Weibull case and may not generalize
- Empirical comparison uses synthetic data and limited set of baselines, lacking real-world validation

## Confidence
- Theoretical regret bounds for Weibull demand: High
- Extension to general parametric distributions: Medium
- Empirical performance claims: Medium

## Next Checks
1. Validate theoretical bounds for additional demand distributions beyond Weibull, particularly for exponential and normal distributions
2. Conduct real-world experiments using actual demand data from retail or supply chain operations
3. Compare performance against a broader set of baselines including reinforcement learning approaches and model predictive control methods