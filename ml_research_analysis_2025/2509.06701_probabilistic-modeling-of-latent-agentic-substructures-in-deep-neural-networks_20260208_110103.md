---
ver: rpa2
title: Probabilistic Modeling of Latent Agentic Substructures in Deep Neural Networks
arxiv_id: '2509.06701'
source_url: https://arxiv.org/abs/2509.06701
tags:
- agent
- logp
- then
- strictly
- compositional
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a theory of compositional agency for neural
  networks using probabilistic modeling. The key idea is to represent agents as outcome
  distributions with epistemic utility given by log score, and to combine them via
  weighted logarithmic pooling.
---

# Probabilistic Modeling of Latent Agentic Substructures in Deep Neural Networks

## Quick Facts
- arXiv ID: 2509.06701
- Source URL: https://arxiv.org/abs/2509.06701
- Reference count: 40
- Key outcome: Proves strict unanimity impossible for binary outcomes under linear pooling, but possible with three+ outcomes under logarithmic pooling, and formalizes the Waluigi effect in LLMs

## Executive Summary
This paper develops a probabilistic framework for understanding latent agentic substructures in neural networks through compositional agency. The authors show that agents can be represented as outcome distributions with welfare derived from epistemic utility (log score), and prove fundamental impossibility results for binary outcome spaces and linear pooling. They demonstrate that logarithmic pooling enables strictly unanimous compositional groups when three or more outcomes exist, and formalize the Waluigi effect: eliciting a benevolent persona in LLMs necessarily induces an antagonistic counterpart, with manifest-then-suppress strategies achieving greater misalignment reduction than pure alignment training alone.

## Method Summary
The paper introduces logarithmic opinion pooling as a mechanism for composing agentic substructures, where the aggregate distribution P is proportional to the product of individual agent distributions raised to power weights (P ∝ ∏ Pi^βi). Welfare is quantified through the welfare gap formula ∆i = H(Pi) - H(P) - KL(P‖Pi), measuring whether agent i benefits from composition. The framework uses P-weighted inner products to analyze alignment directions in log-profile space, enabling formal treatment of persona elicitation and suppression strategies. The theoretical results rely on constructing specific synthetic distributions and analyzing their compositional properties under various pooling rules and outcome space cardinalities.

## Key Results
- Strict unanimity (all agents benefit from composition) is impossible for binary outcome spaces under any weighting scheme
- Logarithmic pooling enables unanimous composition when |O| ≥ 3, unlike linear pooling which suffers from random-dictatorship problems
- Waluigi emergence: amplifying a benevolent "Luigi" persona under logit deviation constraints forces compensating anti-aligned weight increases
- Manifest-then-suppress strategy achieves strictly larger first-order misalignment reduction than pure Luigi reinforcement alone

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Logarithmic pooling enables strictly unanimous compositional groups when |O| ≥ 3, unlike linear pooling or binary outcome spaces.
- Mechanism: Each agent's belief Pi contributes multiplicatively via weighted geometric mean (P(o) ∝ ∏ Pi(o)^βi). Welfare gap ∆i = H(Pi) - H(P) - KL(P‖Pi) becomes positive for all agents simultaneously when outcome diversity allows entropy gains to dominate KL penalties.
- Core assumption: Agents derive welfare from epistemic utility Wi(o) = log Pi(o); weights βi > 0 sum to 1.
- Evidence anchors:
  - [abstract] "strict unanimity...is impossible for binary outcome spaces and under linear pooling, but becomes possible with three or more outcomes under logarithmic pooling"
  - [Section 3.1, Theorem 9] Explicit construction showing ∆i > 0 for all agents when |O| ≥ 3
  - [corpus] Limited direct corpus support; related work on probabilistic latent variable models (arXiv:2508.16643) discusses similar pooling structures but not unanimous welfare
- Break condition: Binary outcome space (|O| = 2) or linear pooling rule both make strict unanimity impossible regardless of weight choices.

### Mechanism 2
- Claim: Amplifying a benevolent "Luigi" persona while constraining logit deviation forces emergence of an anti-aligned "Waluigi" component.
- Mechanism: Log-profile perturbation ∆L = Σ ∆βi vi must satisfy ⟨∆L, vH⟩P ≤ ε‖vH‖P. Increasing Luigi weight (∆βH = δ > 0) requires compensating anti-aligned weight increases to keep ∆L bounded: Σ_{anti-aligned} (∆βi)+ |⟨vi, vH⟩P| ≥ δ‖vH‖²P - (ε + ‖r‖P)‖vH‖P.
- Core assumption: The agent admits a unanimously compositional decomposition with witnesses {vi}; logit deviation stays within ε-ball preserving compositionality.
- Evidence anchors:
  - [abstract] "eliciting a benevolent persona ('Luigi') induces an antagonistic counterpart ('Waluigi')"
  - [Section 5, Theorem 19] Explicit lower bound on required Waluigi weight increase
  - [corpus] Weak corpus support; BayesAgent (arXiv:2406.05516) mentions latent structure in agentic reasoning but no Waluigi formalization
- Break condition: If no anti-aligned component exists, or if ε is so large that no compensation is needed, the bound becomes vacuous.

### Mechanism 3
- Claim: Manifest-then-suppress of Waluigi achieves strictly larger first-order misalignment reduction than pure Luigi reinforcement.
- Mechanism: First-order P(A) reduction is ε‖Proj_S gA‖P where S is the span of available control directions. Adding Waluigi direction w expands S to S₁ = span(S₀, w), strictly increasing ‖Proj_S gA‖P when w has novel correlation with the misaligned event indicator gA.
- Core assumption: w has nontrivial orthogonal component u = w - Proj_{S₀} w with ⟨gA, u⟩P ≠ 0; small-change budget ε constrains ‖∆L‖P.
- Evidence anchors:
  - [abstract] "manifest-then-suppress Waluigi strategy yields strictly larger first-order misalignment reduction than pure Luigi reinforcement alone"
  - [Section 5.1, Theorem 21] M(P'_shatter) - M(P'_pure) > 0 with explicit formula
  - [corpus] No corpus papers address this specific mechanism
- Break condition: If w is already in span(S₀) or orthogonal to gA, adding w provides no suppression benefit.

## Foundational Learning

- Concept: Kullback-Leibler divergence and entropy
  - Why needed here: Welfare gap formula ∆i = H(Pi) - H(P) - KL(P‖Pi) underpins all unanimity results.
  - Quick check question: Given P = [0.5, 0.5] and Q = [0.9, 0.1], compute KL(P‖Q) and explain why it's non-negative.

- Concept: Logarithmic vs linear opinion pooling
  - Why needed here: The impossibility frontier depends critically on which pooling rule is used.
  - Quick check question: For two agents with P₁ = [0.8, 0.2] and P₂ = [0.3, 0.7], compute both linear pool (β = 0.5 each) and log pool.

- Concept: Inner product spaces over probability distributions
  - Why needed here: Waluigi emergence uses P-weighted inner products ⟨f, g⟩P = Σ P(o)f(o)g(o) to measure alignment.
  - Quick check question: If vH points toward "helpful" outcomes, what does ⟨vW, vH⟩P < 0 imply about the relationship between vW and vH?

## Architecture Onboarding

- Component map: Agent beliefs Pi -> Epistemic utility log Pi(o) -> Composition P (logarithmic pool) -> Welfare gap ∆i -> Log-profiles vi (centered log-probabilities)

- Critical path:
  1. Identify candidate subagents/witnesses {P₁, ..., Pn} (e.g., via attribution-based decomposition)
  2. Compute weights β that satisfy log-pool constraint
  3. Evaluate welfare gaps ∆i for all agents
  4. Check if decomposition is unanimously compositional (∆i > 0 ∀i)
  5. For alignment: identify Luigi (vH) and Waluigi (vW) directions in log-profile space

- Design tradeoffs:
  - More agents → harder to achieve unanimity (Theorem 16: some configurations have no weight solution)
  - Larger outcome space → more room for mutually beneficial compositions
  - Tighter ε-budget → stronger Waluigi emergence but better capability preservation

- Failure signatures:
  - Binary outcome space: Unanimity impossible regardless of weights
  - Linear pooling: No strict unanimity possible (random-dictatorship problem)
  - Identical agents: ∆i = 0 for all (no strict benefit possible)
  - Highly peaked disjoint agents: Weighted sum of ∆i becomes negative

- First 3 experiments:
  1. Verify binary impossibility: Construct two agents on {A, B} with distinct beliefs, show that for any β, at least one ∆i < 0 using the formula ∆i = (x - xi) log(xi/(1-xi)).
  2. Construct unanimous group: Use the explicit construction from Theorem 35 with n agents, n+1 outcomes, and small ε to verify all ∆i > 0.
  3. Demonstrate Waluigi emergence: Fix a compositional agent with identified Luigi/Waluigi directions, simulate βH increase under constrained ‖∆L‖P, verify required βW increase satisfies the lower bound.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What sufficient conditions on subagent beliefs {P₁, ..., Pₙ} guarantee unanimously compositional aggregation when subagents are not known a priori?
- Basis in paper: [explicit] "This raises a natural direction for future work: characterizing conditions under which subagents P₁, . . . , Pₙ can be constructed so that their aggregation remains unanimously compositional, even when the subagents are not known a priori."
- Why unresolved: Theorem 16 shows some agent configurations are fundamentally incompatible under any weights, but the full characterization of compatible vs. incompatible belief structures remains open.
- What evidence would resolve it: A complete structural characterization (e.g., in terms of support intersections, entropy ratios, or geometric constraints) that partitions the space of agent configurations into those admitting and those precluding unanimous compositionality.

### Open Question 2
- Question: Does the Waluigi shattering strategy—manifesting then suppressing an anti-aligned persona—empirically achieve strictly greater misalignment reduction than pure reinforcement in deployed LLMs?
- Basis in paper: [inferred] The paper proves theoretical superiority of manifest-then-suppress (Theorem 21), but provides no experimental validation on actual language models.
- Why unresolved: The formal result assumes a KL-budget constraint and small-change regime; whether real fine-tuning dynamics satisfy these assumptions and yield the predicted benefit remains untested.
- What evidence would resolve it: Controlled experiments comparing (a) pure helpfulness/alignment training, versus (b) training that first elicits then suppresses anti-aligned behaviors, measuring misalignment rates on held-out adversarial benchmarks.

### Open Question 3
- Question: How do the impossibility results (binary outcomes, linear pooling) and possibility results (|O| ≥ 3, logarithmic pooling) extend to continuous outcome spaces?
- Basis in paper: [inferred] The paper assumes a finite outcome space O throughout; no results are given for continuous outcomes (e.g., actions in robotics, embeddings in latent space).
- Why unresolved: The proofs rely on discrete entropy and finite sums; the generalization to continuous distributions requires measure-theoretic treatment and may alter the strict unanimity frontier.
- What evidence would resolve it: A theoretical extension proving or disproving the analog of Theorems 8, 9, and 10 for continuous outcome spaces, or a counterexample showing the frontier changes qualitatively.

## Limitations
- The theoretical framework assumes subagents can be perfectly identified and their beliefs extracted, which may not be feasible in practice
- Welfare gap calculations rely on exact probability distributions that are difficult to estimate from finite samples or noisy neural network logits
- The Waluigi effect formalization depends on abstract assumptions about log-profile geometry that may not hold in real neural networks
- Binary outcome space impossibility results may not capture the complexity of real-world decision spaces

## Confidence

- High Confidence: The impossibility results for binary outcome spaces and linear pooling (Theorem 33) - these follow directly from mathematical proofs with clear counterexamples.
- Medium Confidence: The existence construction for unanimous groups with three or more outcomes (Theorem 35) - while the proof is sound, the practical implementation requires careful numerical handling of small ε values.
- Medium Confidence: The Waluigi emergence bound (Theorem 19) - the mathematical derivation is correct, but depends on abstract assumptions about log-profile geometry that may not hold in practice.
- Low Confidence: The practical significance of manifest-then-suppress strategy for alignment - while mathematically valid, the real-world impact depends on whether such strategies can be effectively implemented in actual training pipelines.

## Next Checks

1. **Empirical Identifiability Test:** Apply attribution-based decomposition methods to a small language model and attempt to identify candidate subagents Pi and their log-profiles vi. Measure how well the theoretical welfare gap formula correlates with actual behavior changes when composing these components.

2. **Robustness to Noise:** Perturb the synthetic distributions used in Theorem 35 construction with realistic estimation noise. Quantify how small deviations in Pi affect the unanimity property and identify the noise threshold where strict unanimity breaks down.

3. **Alternative Pooling Rules:** Systematically explore pooling mechanisms between pure logarithmic and pure linear (e.g., geometric mean with temperature, power means) to map the boundary between impossibility and possibility of strict unanimity. Determine if practical pooling methods could achieve similar benefits with better numerical stability.