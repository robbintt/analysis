---
ver: rpa2
title: Visualizing and Controlling Cortical Responses Using Voxel-Weighted Activation
  Maximization
arxiv_id: '2506.04379'
source_url: https://arxiv.org/abs/2506.04379
tags:
- images
- responses
- fmri
- across
- visual
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This work demonstrates that activation maximization\u2014a technique\
  \ originally developed to interpret deep neural networks\u2014can be applied to\
  \ DNN-based encoding models to generate interpretable visualizations of human visual\
  \ cortex selectivity and drive targeted fMRI responses. The authors trained an Inception\
  \ V3-based encoding model using adaptively downsampled activations to predict voxelwise\
  \ fMRI responses across multiple visual areas with high accuracy."
---

# Visualizing and Controlling Cortical Responses Using Voxel-Weighted Activation Maximization

## Quick Facts
- **arXiv ID:** 2506.04379
- **Source URL:** https://arxiv.org/abs/2506.04379
- **Reference count:** 38
- **Primary result:** Activation maximization can generate interpretable visualizations and drive targeted fMRI responses in human visual cortex using DNN-based encoding models

## Executive Summary
This paper demonstrates that activation maximization—a technique originally developed to interpret deep neural networks—can be applied to DNN-based encoding models to generate interpretable visualizations of human visual cortex selectivity and drive targeted fMRI responses. The authors trained an Inception V3-based encoding model using adaptively downsampled activations to predict voxelwise fMRI responses across multiple visual areas with high accuracy. They then applied activation maximization to synthesize images optimized for predicted responses in individual voxels and whole ROIs. Experiment 1 showed that voxel-optimized images qualitatively matched known selectivity patterns (e.g., retinotopic patches in V2, face features in face-selective regions). Experiment 2 validated that ROI-optimized images effectively drove targeted fMRI responses, with significant activation increases in 4 of 5 tested regions. Experiment 3 demonstrated cross-subject generalization, with images optimized for averaged responses reliably activating corresponding regions in new participants. These findings show that activation maximization can flexibly characterize and modulate cortical responses without requiring natively generative models.

## Method Summary
The authors trained a voxelwise encoding model using Inception V3 activations to predict fMRI responses from six subjects watching naturalistic movies. They extracted activations from 21 layers, adaptively pooled to ~5000 features per layer (~78K total), and fit ridge regression models per voxel with 10-fold cross-validation. To synthesize images, they applied activation maximization in Fourier space using gradient descent to maximize predicted responses weighted by contrast-adjusted feature importance. Experiment 1 tested voxel-specific optimization, Experiment 2 tested ROI-specific optimization with new subjects, and Experiment 3 tested cross-subject generalization using averaged encoding models.

## Key Results
- Voxel-optimized images produced interpretable visualizations matching known selectivity patterns (retinotopic patches, face features)
- ROI-optimized images significantly drove targeted fMRI responses in 4 of 5 tested regions versus non-target regions
- Cross-subject generalization succeeded, with averaged model images reliably activating corresponding regions in new participants

## Why This Works (Mechanism)
The method works by leveraging the bidirectional relationship between visual stimuli and neural responses. By training a DNN to predict voxel responses from images, the model learns the forward mapping from pixels to brain activity. Activation maximization then inverts this mapping by finding input images that maximize predicted responses for target voxels. The adaptive pooling ensures sufficient feature diversity while controlling dimensionality, and the Fourier-based optimization with augmentations enables efficient synthesis of meaningful visual patterns. The weighted contrast enhancement prioritizes features most predictive of the target voxel's response.

## Foundational Learning
**DNN-based encoding models**: Map visual stimuli to predicted neural responses using DNN activations as intermediate representations. Needed because direct voxel-to-pixel relationships are too complex to model without hierarchical feature extraction.
*Quick check:* Verify encoding model predicts held-out voxel responses above noise ceiling.

**Activation maximization**: Iterative optimization technique to find inputs that maximize a network's output. Needed to invert the encoding model and synthesize stimuli that drive target responses.
*Quick check:* Confirm loss decreases monotonically during optimization.

**Adaptive spatial pooling**: Dynamically adjusts spatial resolution per layer to balance feature diversity with computational tractability. Needed to prevent memory overflow while preserving representational power.
*Quick check:* Validate pooled feature dimensions match expected ~78K total.

**Ridge regression with temporal lags**: Models voxel responses with multiple temporal delays to account for hemodynamic lag. Needed because BOLD responses peak 4-6 seconds after stimulus onset.
*Quick check:* Ensure cross-validated R² exceeds 0 for majority of voxels.

## Architecture Onboarding
**Component map:** Naturalistic videos → Inception V3 (21 layers) → Adaptive pooling → Ridge regression → fMRI predictions → Activation maximization → Synthesized images

**Critical path:** Inception V3 extraction → Adaptive pooling → Ridge regression → Activation maximization → fMRI validation

**Design tradeoffs:** Adaptive pooling trades spatial resolution for computational efficiency; ridge regression trades model complexity for stability; Fourier optimization trades convergence speed for smooth solutions.

**Failure signatures:** Low encoding R² indicates poor feature selection or temporal misalignment; noisy synthesized images suggest insufficient regularization; weak fMRI responses indicate optimization instability or ROI misdefinition.

**Three first experiments:**
1. Verify adaptive pooling produces ~78K features and encoding model achieves cross-validated R² > 0.1 on held-out data
2. Generate single-voxel optimized images and visually inspect for interpretable patterns versus noise
3. Test ROI-optimized images on new subjects and confirm target activation increases via independent t-test

## Open Questions the Paper Calls Out
**Open Question 1:** Can the visual features in synthesized images be quantified to objectively confirm the selectivity of target brain regions? The authors note that their characterization of image contents remains qualitative and that "quantification of image features... would enable a more objective assessment."

**Open Question 2:** How do different optimization initializations and regularizations impact the efficacy of synthesized images in driving actual neural responses? The authors state that while specific initializations improved visual interpretability, "their effects on actual fMRI responses remain a subject for future investigation."

**Open Question 3:** Can this activation maximization framework extend to dynamic stimuli (video) or language inputs to characterize temporal or semantic selectivity? The conclusion suggests that "generation of other stimulus formats—such as videos or text—and application to other measurement techniques, such as MEG, would extend our approach."

## Limitations
- Method requires access to naturalistic movie datasets and subject-specific ROI definitions
- Cross-subject generalization relies on averaging encoding models without accounting for individual variability
- Validation focuses on visual inspection rather than quantitative feature analysis of synthesized images

## Confidence
- **High:** Core methodological framework (DNN encoding, activation maximization, cross-validation)
- **Medium:** Experimental validation results requiring specific fMRI datasets and ROI definitions
- **Low:** Cross-subject generalization claims without access to multiple subjects' data

## Next Checks
1. Implement the adaptive spatial pooling using the provided formula Si = (5000/C)^(1/n) and verify the ~78K feature dimension
2. Test ridge regression with 10-fold CV and α selection on a smaller subset of voxels to confirm convergence
3. Generate activation maximization images for a single voxel and visually inspect for interpretable patterns versus noise