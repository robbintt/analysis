---
ver: rpa2
title: 'HeaRT: A Hierarchical Circuit Reasoning Tree-Based Agentic Framework for AMS
  Design Optimization'
arxiv_id: '2511.19669'
source_url: https://arxiv.org/abs/2511.19669
tags:
- circuit
- design
- reasoning
- heart
- optimization
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces HeaRT, a hierarchical circuit reasoning tree-based
  agentic framework for AMS design optimization. The method constructs an analytically
  guided hierarchical knowledge graph through DC current path-guided circuit decomposition
  and bottom-up knowledge consolidation, enabling context-aware reasoning for topology
  selection and sizing refinement.
---

# HeaRT: A Hierarchical Circuit Reasoning Tree-Based Agentic Framework for AMS Design Optimization

## Quick Facts
- arXiv ID: 2511.19669
- Source URL: https://arxiv.org/abs/2511.19669
- Reference count: 40
- 40 benchmark circuits, >97% reasoning accuracy, >98% Pass@1 performance, <0.5× real-time token budget of baselines, >3× faster convergence

## Executive Summary
HeaRT introduces a hierarchical circuit reasoning tree-based agentic framework for analog/mixed-signal (AMS) design optimization. The method constructs an analytically guided hierarchical knowledge graph through DC current path-guided circuit decomposition and bottom-up knowledge consolidation, enabling context-aware reasoning for topology selection and sizing refinement. Experiments on 40 benchmark circuits show HeaRT achieves superior performance while operating at significantly lower computational cost compared to state-of-the-art baselines.

## Method Summary
HeaRT operates in two phases: offline and online. The offline phase constructs a hierarchical reasoning tree by first building a bipartite graph from SPICE netlists, then extracting DC-connected subcircuits via multi-source BFS from supply rails while removing non-conductive terminals. These subcircuits are consolidated bottom-up with LLM assistance to form a hierarchical tree structure. The online phase performs query-conditioned retrieval using branch-cut pruning with relevance-weighted edges, followed by scoped sizing optimization or rank-based topology retrieval from a pre-ranked database. The framework preserves prior design intent through PCKRI metrics quantifying structural and parametric retention.

## Key Results
- Achieves >97% reasoning accuracy and >98% Pass@1 performance across 40 benchmark circuits
- Operates at <0.5× the real-time token budget of state-of-the-art baselines (1176 vs ≥2480 tokens)
- Delivers >3× faster convergence in both sizing and topology design adaptation tasks while preserving prior design intent

## Why This Works (Mechanism)

### Mechanism 1
- Claim: DC current path-guided decomposition improves subcircuit identification accuracy over unstructured LLM reasoning.
- Mechanism: Algorithm 1 constructs a bipartite graph from SPICE netlists, removes non-DC-conductive terminals (MOS gates, capacitor nodes), then performs multi-source BFS from supply rails to identify DC-connected components. These analytically-derived constraints guide LLM-assisted subcircuit extraction with metadata (subcircuit_ID, role_hint, port annotations).
- Core assumption: DC connectivity correlates with functional subcircuit boundaries in AMS designs.
- Evidence anchors: [abstract] "DC current path-guided circuit decomposition and bottom-up knowledge consolidation"; [section 3.1.1] Algorithm 1 formally specifies the ExtractDCSubcircuits function with BFS from VDD/GND; [corpus] Related work similarly uses topology understanding but without explicit DC-path analytical grounding.
- Break condition: Circuits where functional blocks share DC paths (e.g., cascode stages, merged bias networks) may require additional semantic hints beyond DC connectivity alone.

### Mechanism 2
- Claim: Hierarchical tree traversal with branch-cut pruning reduces token usage while preserving reasoning accuracy.
- Mechanism: During online retrieval, the LLM assigns query-conditioned relevance weights to tree edges. The Branch_Cut criterion (Equation 3) halts expansion when all children have low weights (below τ_stop) or similar weights (within ε), preventing unnecessary traversal. This bounds retrieval to O(tree_depth) rather than full-context inference.
- Core assumption: Query-relevant subcircuits cluster along dominant branches; uniform relevance indicates either irrelevance or insufficient discrimination.
- Evidence anchors: [abstract] "operating at <0.5× the real-time token budget of SOTA baselines"; [section 3.2.2] Equation 3 defines Branch_Cut with τ_stop and ε thresholds; [table 2] HeaRT uses 1176 avg tokens vs. ≥2480 for GPT-5 single-shot, with 97.24–100% accuracy across complexity tiers; [corpus] AutoSizer, AMS-IO-Agent report sizing improvements but do not quantify token efficiency.
- Break condition: Queries requiring multi-region analysis (e.g., global feedback loops spanning distant subtrees) may need relaxed τ_stop or multi-path traversal.

### Mechanism 3
- Claim: Rank-based topology retrieval with feasibility constraints enables context-aware topology adaptation while preserving prior design intent.
- Mechanism: Pre-ranked topology database keyed by functional category and performance metrics. Given objectives S and constraints U, HeaRT computes FoM_rank (Equation 4) summing weighted ranks over S, filtered by feasibility region φ(U) (Equation 5) requiring ranks within 3 of prior on strict metrics. PCKRI (Equations 1–2) quantifies structural (TRS) and parametric (DVRS) retention.
- Core assumption: Prior topology rankings generalize across design instances within the same functional category; rank deviations correlate with acceptable performance trade-offs.
- Evidence anchors: [abstract] ">3× faster convergence in both sizing and topology design adaptation tasks while preserving prior design intent"; [section 4.3.2] Scenario 2 shows ≥60% FoM improvement via scoped sizing, ≥1.9× via topology reconfiguration, with PCKRI ≥0.59; [table 3] Consistent PCKRI improvement (0.59–0.71) across BO, DE, DNN-Opt, MA-RL baselines; [corpus] Weak direct comparison—neighboring papers focus on sizing without explicit knowledge-retention metrics.
- Break condition: Novel performance objectives outside pre-ranked metric columns require database extension or fallback to unconstrained search.

## Foundational Learning

- Concept: Bipartite graph representation of circuits
  - Why needed here: Algorithm 1 transforms SPICE netlists into device-net bipartite graphs; understanding node types (V_D for devices, V_N for nets) and edge semantics is prerequisite to DC-path extraction.
  - Quick check question: Given a simple common-source amplifier (MOS + resistor + caps), can you sketch the bipartite graph and identify which edges are removed for DC analysis?

- Concept: KCL and DC operating point analysis
  - Why needed here: The decomposition relies on DC current paths; gates and capacitors are explicitly removed because they don't conduct DC. Understanding why this is valid requires grasping bias-point stability and AC-coupling isolation.
  - Quick check question: Why does removing MOS gates from the DC graph preserve correctness for bias-path identification, but would be incorrect for small-signal analysis?

- Concept: Bayesian optimization and reinforcement learning for circuit sizing
  - Why needed here: HeaRT integrates with BO, DE, DNN-Opt, MA-RL baselines. Understanding how these optimizers sample the design space clarifies why scoping (limiting optimization to subcircuits) accelerates convergence.
  - Quick check question: If HeaRT scopes optimization to a comparator within an oscillator, how does reducing the parameter space dimensionality affect BO acquisition function sampling?

## Architecture Onboarding

- Component map: SPICE netlist -> Bipartite graph -> DC subcircuit extraction (Algorithm 1) -> LLM-assisted node labeling -> Bottom-up consolidation -> Hierarchical reasoning tree (JSON per node) -> Query-conditioned BFS traversal with Branch_Cut -> Scoped subcircuit extraction -> (A) Scoped sizing optimization OR (B) Topology database retrieval -> Ranked FoM selection -> Sized netlist output

- Critical path: DC-path extraction correctness determines subcircuit boundary quality; Branch-cut thresholds control precision-recall trade-off in retrieval; Topology database coverage limits applicability to novel architectures; PCKRI weighting affects sensitivity to parametric drift vs. structural change

- Design tradeoffs: τ_stop too high → premature termination, missed relevant subcircuits; too low → excessive traversal, token bloat; Feasibility constraint (|r_j - r̄_j| ≤ 3) too strict → empty search space; too loose → poor prior retention; Knowledge tree depth vs. breadth: deep trees capture fine-grained hierarchy but increase traversal cost

- Failure signatures: Low reasoning accuracy on "Hard" circuits (>40 devices): likely DC decomposition mis-partitioning or insufficient global context; High token usage despite branch-cut: edge weights poorly calibrated; PCKRI near 0 on adaptation tasks: scoping logic failing to identify reusable subcircuits; Empty φ(U) feasibility region: prior ranks incompatible with new objectives

- First 3 experiments: 1) Reproduce Table 2 on a held-out circuit (e.g., a simple two-stage OPAMP): verify DC subcircuit extraction matches manual partition, measure token count vs. single-shot GPT-4o baseline; 2) Ablation study on τ_stop: sweep [0.1, 0.3, 0.5] and plot reasoning accuracy vs. token usage to find operating point matching reported ~1176 tokens at ≥97% accuracy; 3) Scenario 1 reproduction on relaxation oscillator: validate that comparator scoping yields ≥3× PCKRI improvement over full-circuit sizing with fixed simulation budget (200), confirming prior-intent preservation claim

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Does integrating real-time simulation metadata into the reasoning tree improve optimization convergence rates?
- Basis in paper: [explicit] The conclusion identifies future directions as "enriching the reasoning tree with simulation metadata and real-time analysis."
- Why unresolved: The current framework constructs the tree via an "offline, one-time knowledge-building stage" (Section 3), lacking dynamic feedback from actual simulation runs.
- What evidence would resolve it: Benchmarks comparing the static tree's convergence speed against a modified HeaRT that ingests simulation data during the knowledge consolidation phase.

### Open Question 2
- Question: Can the framework effectively automate layout-constraint extraction from circuit netlists?
- Basis in paper: [explicit] The conclusion lists "exploring new applications from automated circuit understanding, such as layout-constraint extraction" as a future goal.
- Why unresolved: HeaRT currently focuses on "topology selection and sizing refinement" (Abstract) rather than physical design constraints or geometric mapping.
- What evidence would resolve it: Demonstration of HeaRT generating valid layout constraints (e.g., matching, symmetry) from a netlist that successfully guide a layout automation tool.

### Open Question 3
- Question: Does the simplification of MOSFETs to three-terminal devices degrade reasoning accuracy for body-sensitive circuits?
- Basis in paper: [inferred] Algorithm 1 states: "we reasonably simplify MOSFETs as three-terminal devices (D, G, S), omitting body connections."
- Why unresolved: Body biasing and substrate currents are critical in many analog designs; removing these connections may sever valid DC current paths required for correct graph analysis.
- What evidence would resolve it: Evaluation of reasoning accuracy (A2/A3 metrics) on circuits heavily reliant on body effects, comparing the 3-terminal assumption against a full 4-terminal model.

## Limitations
- LLM prompt templates and in-context exemplars for subcircuit extraction remain unspecified, creating significant reproducibility barriers
- Threshold parameters τ_stop and ε for the Branch_Cut criterion are not disclosed, making it impossible to reproduce the reported 1176 average token usage at >97% accuracy
- Topology database construction methodology and human expert ranking procedures are absent, limiting understanding of how performance metrics are pre-ranked across functional categories

## Confidence

- High: DC current path-guided decomposition mechanism (Algorithm 1 is formally specified with clear bipartite graph construction and BFS-based extraction)
- Medium: Hierarchical traversal efficiency (Branch_Cut mechanism is mathematically defined, but threshold sensitivity and real-world performance impact require validation)
- Low: Knowledge retention metrics (PCKRI formulation is clear, but without topology database details, verification of >3× faster convergence claims is not possible)

## Next Checks

1. Implement Algorithm 1 on a simple common-source amplifier and verify DC subcircuit boundaries match manual analysis, then extend to a two-stage op-amp from the benchmark set to check hierarchical decomposition quality
2. Reproduce Table 2 token usage and accuracy for a held-out circuit (e.g., relaxation oscillator) by implementing the Branch_Cut mechanism with varying τ_stop thresholds [0.1, 0.3, 0.5] to find the operating point achieving ~1176 tokens at ≥97% accuracy
3. Validate Scenario 1 PCKRI improvements by comparing scoped sizing (comparator-only optimization) against full-circuit sizing on the oscillator benchmark, ensuring ≥3× improvement in design retention under fixed simulation budget (200)