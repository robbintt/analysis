---
ver: rpa2
title: 'SAMRI-2: A Memory-based Model for Cartilage and Meniscus Segmentation in 3D
  MRIs of the Knee Joint'
arxiv_id: '2502.10559'
source_url: https://arxiv.org/abs/2502.10559
tags:
- segmentation
- cartilage
- dataset
- knee
- performance
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces SAMRI-2, a memory-based Visual Foundational
  Model for accurate cartilage and meniscus segmentation in 3D knee MRIs. Leveraging
  a Hybrid Shuffling Strategy (HSS) and a segmentation mask propagation technique,
  SAMRI-2 improves spatial awareness and reduces annotation effort.
---

# SAMRI-2: A Memory-based Model for Cartilage and Meniscus Segmentation in 3D MRIs of the Knee Joint

## Quick Facts
- arXiv ID: 2502.10559
- Source URL: https://arxiv.org/abs/2502.10559
- Reference count: 40
- Key outcome: 5-point DSC improvement over baselines, up to 12 points for tibial cartilage, with only 3 user clicks needed per volume

## Executive Summary
SAMRI-2 is a memory-based Visual Foundational Model for accurate cartilage and meniscus segmentation in 3D knee MRIs. The model improves upon standard SAM2 through a Hybrid Shuffling Strategy (HSS) that enhances spatial awareness by preserving slice-to-slice correlations during training, and a memory-based mask propagation technique that enables full-volume segmentation with minimal user interaction. Trained on 270 patients using public (OAI DESS) and internal GE Healthcare datasets, SAMRI-2 achieved an average Dice Similarity Coefficient (DSC) improvement of 5 points over other models, with a peak of 12 points for tibial cartilage, and reduced cartilage thickness errors by up to threefold. The model maintained high performance with as few as three user clicks per volume, offering a reliable AI-assisted solution for musculoskeletal imaging.

## Method Summary
SAMRI-2 builds on the SAM2 architecture with a Hiera Tiny backbone, fine-tuned for 3D knee MRI segmentation. The key innovation is the Hybrid Shuffling Strategy (HSS), which shuffles training data at the chunk level (groups of consecutive slices) rather than individual slices, preserving spatial correlations. The model uses a memory bank to store and retrieve features from previously segmented slices, enabling mask propagation throughout the volume with minimal prompts. Training involved pre-training on OAI DESS dataset (176 volumes, 88 patients) followed by fine-tuning on internal CUBE dataset (399 studies, 182 patients). The model was evaluated on 57 external cases including multi-radiologist annotations and varied acquisitions, using DSC, IoU, and cartilage thickness absolute error as metrics.

## Key Results
- Average DSC improvement of 5 points over baselines (0.809-0.831 for cartilage/meniscus)
- Peak improvement of 12 points for tibial cartilage segmentation
- Reduced cartilage thickness errors by up to threefold
- Maintained high performance with only 3 user clicks per volume

## Why This Works (Mechanism)

### Mechanism 1
The Hybrid Shuffling Strategy (HSS) restructures volumetric data by sampling contiguous sub-volumes ("chunks" of consecutive slices along z-axis) and shuffling at chunk-level rather than slice-level during training. This preserves spatial correlations between adjacent slices, enabling the memory attention layer's cross-attention mechanism to better capture and leverage 3D spatial dependencies. Core assumption: Spatial coherence across consecutive slices carries anatomically meaningful information that improves segmentation when properly encoded. Evidence: Abstract states HSS "improves spatial awareness and convergence," and the paper shows prompting alone didn't substantially improve performance without HSS. Break condition: Inconsistent slice spacing or missing slices may degrade HSS benefits.

### Mechanism 2
Memory-based mask propagation enables full-volume segmentation with minimal user prompts by maintaining cross-slice consistency. The memory bank stores feature embeddings from previously segmented slices. When processing a new slice, the model retrieves relevant features via cross-attention, using prior predictions to generate prompt tokens (mask + clicks) for the next slice. This propagates anatomical context throughout the volume. Core assumption: Anatomical structures in knee MRI have predictable spatial continuity that can be encoded and retrieved across slices. Evidence: Abstract notes SAMRI-2 maintained high performance with as few as three user clicks per volume, reducing annotation effort. Break condition: Discontinuous structure appearance between slices may cause error accumulation.

### Mechanism 3
Iterative multi-click prompting with error-map-guided point selection improves segmentation accuracy over single-click or bounding-box approaches for non-convex structures. Initial click placed near centroid (within 30th percentile of Euclidean distances to mask boundary). Subsequent clicks selected from highest-error regions between prediction and ground truth. Points classified as positive (false negative regions) or negative (false positive regions), allowing targeted correction. Core assumption: Error regions systematically correspond to anatomically challenging areas that benefit from explicit user guidance. Evidence: Paper uses point click prompts instead of bounding boxes for non-convex knee soft tissue shapes. Break condition: Poorly placed user clicks may prevent convergence.

## Foundational Learning

- **Segment Anything Model (SAM) Architecture**: SAMRI-2 builds on SAM2's encoder-decoder structure with promptable segmentation. Understanding image encoder (ViT), prompt encoder (points/boxes/masks), and mask decoder is prerequisite. Quick check: Can you explain how SAM encodes different prompt types (points vs. boxes vs. masks) into a shared embedding space?

- **Memory Attention in Video/Volumetric Segmentation**: SAMRI-2 adapts SAM2's temporal memory mechanism to 3D spatial volumes. Requires understanding cross-attention between current frame/slice and stored memory embeddings. Quick check: How does the memory bank decide which prior embeddings are relevant for the current slice?

- **3D MRI Spatial Properties**: Knee MRI has anisotropic resolution (e.g., 0.36×0.36×0.7mm), slice-to-slice correlation, and tissue-specific contrast characteristics that affect segmentation strategy. Quick check: Why might a 2D per-slice approach fail to capture structures that span multiple slices with subtle boundary transitions?

## Architecture Onboarding

- **Component map**: Image Encoder (SAM2 Hiera Tiny) -> Memory Encoder (generates embeddings) -> Memory Attention Layer (cross-attention with HSS) -> Prompt Encoder (click points as tokens) -> Mask Decoder (segmentation masks)

- **Critical path**: Pre-training on DESS dataset (176 volumes, 88 patients) for geometric feature learning → Fine-tuning on CUBE dataset (399 studies, 182 patients) for domain adaptation → Inference: Initial click → first slice prediction → memory bank population → propagation with memory-guided prompts

- **Design tradeoffs**: SAMRI-2 (38M params, 4.24s inference) vs. 3D-VNet (11M params, 0.46s): 9× slower but higher accuracy; Sparse prompts (every 10-50 slices) vs. all-slice prompts: ~2-5 DSC drop but reduced effort; Tiny architecture vs. full SAM2: Faster training but may limit capacity for complex anatomical variations

- **Failure signatures**: DSC < 0.6 on peripheral slices (memory propagation breakdown—check chunk boundaries); High thickness error (>0.3mm) (model may hallucinate boundaries in low-contrast regions); Inter-annotator disagreement > model error (dataset quality issue, not model failure)

- **First 3 experiments**: 1) Ablate HSS: Train SAMRI-2 with slice-level shuffling instead of chunk-level; expect 5-12 point DSC drop; 2) Prompt sensitivity: Test inference with 1, 3, 5, 10 clicks per volume on D7; plot DSC vs. click count; 3) Cross-sequence generalization: Train only on CUBE (no DESS pre-training), test on D50; quantify generalization gap

## Open Questions the Paper Calls Out

- **Question**: How does SAMRI-2 perform in a clinical setting with direct radiologist interaction compared to the simulated prompting strategy used for evaluation? The authors explicitly state that the iterative click-prompt segmentation was evaluated using a predefined strategy derived from reference standards, which may have influenced results, and call for a dedicated reader study.

- **Question**: Does SAMRI-2 maintain high segmentation accuracy across the full spectrum of osteoarthritis (OA) severity, particularly in late-stage disease? While varying osteoarthritis severity is listed as an aim, the evaluation datasets lack pathology readings, meaning performance was not explicitly stratified by OA grade.

- **Question**: Does the sequential, memory-based processing of the 3D volume introduce directional bias or error accumulation along the z-axis? The mask propagation technique passes predictions from one slice to the next, but the paper does not analyze the spatial distribution of errors to see if they compound at the "end" of the volume.

## Limitations

- Internal CUBE dataset is not publicly available, limiting external validation
- Evaluation relies on simulated user prompts rather than real clinical interaction
- Sample sizes for external validation (D7, D50) are relatively small
- No explicit stratification of performance by osteoarthritis severity grades

## Confidence

- **High confidence**: Overall performance improvements (5-12 point DSC gains, threefold thickness error reduction) and effectiveness of memory-based propagation with minimal prompts
- **Medium confidence**: HSS mechanism's specific contribution as a novel adaptation without direct comparative ablation in literature
- **Low confidence**: Long-term clinical utility claims lacking temporal stability analysis and real-world user interaction studies

## Next Checks

1. **Ablation Study**: Implement SAMRI-2 with and without HSS to quantify the exact performance contribution of the chunk-level shuffling mechanism.

2. **Cross-Dataset Validation**: Test SAMRI-2 on publicly available knee MRI datasets (e.g., OAI, K2S Challenge datasets) to assess generalization beyond the internal CUBE data.

3. **Annotation Efficiency Study**: Conduct a controlled user study measuring actual annotation time and accuracy when using 1, 3, and 8 click prompts on real clinical cases.