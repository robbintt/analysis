---
ver: rpa2
title: Landmark-Free Preoperative-to-Intraoperative Registration in Laparoscopic Liver
  Resection
arxiv_id: '2504.15152'
source_url: https://arxiv.org/abs/2504.15152
tags:
- registration
- liver
- point
- intraoperative
- cloud
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a landmark-free preoperative-to-intraoperative
  registration framework, Self-P2IR, for laparoscopic liver surgery. The method transforms
  the traditional 3D-2D registration task into a 3D-3D pipeline, decoupling it into
  rigid and non-rigid registration subtasks.
---

# Landmark-Free Preoperative-to-Intraoperative Registration in Laparoscopic Liver Resection

## Quick Facts
- arXiv ID: 2504.15152
- Source URL: https://arxiv.org/abs/2504.15152
- Reference count: 40
- Primary result: Introduces Self-P2IR, a landmark-free registration framework achieving Dice scores up to 78.89% and Chamfer distances as low as 2.97mm for laparoscopic liver surgery.

## Executive Summary
This paper presents Self-P2IR, a landmark-free preoperative-to-intraoperative registration framework for laparoscopic liver surgery. The method transforms the traditional 3D-2D registration task into a 3D-3D pipeline, decoupling it into rigid and non-rigid registration subtasks. A feature-disentangled transformer learns robust correspondences for rigid alignment, while a structure-regularized deformation network adjusts the preoperative model to align with the intraoperative liver surface. The framework leverages self-supervised learning using intraoperative visual cues such as liver masks and reconstructed point clouds, eliminating the need for manual landmark annotation.

## Method Summary
Self-P2IR reformulates 3D-2D registration as a 3D-3D point cloud registration task. It decouples the problem into rigid (global pose) and non-rigid (local deformation) subtasks. The rigid branch uses a Feature Disentangled Transformer (FDT) with rotary positional embeddings to establish robust correspondences between partial intraoperative surfaces and complete preoperative models. The non-rigid branch employs Structure-Regularized Shape Adaptation (SRSA) with a low-rank transformer to compute deformation weights based on geometric similarity. The entire framework is trained in a self-supervised manner using differentiable rendering to minimize the difference between projected and actual intraoperative liver masks.

## Key Results
- Outperforms state-of-the-art methods with Dice scores up to 78.89%
- Achieves Chamfer distances as low as 2.97mm
- Demonstrates robustness to 15% surface overlap between preoperative and intraoperative data
- Validated on a new in-vivo dataset (P2I-LReg) containing 346 annotated keyframes from 21 patients

## Why This Works (Mechanism)

### Mechanism 1
Decoupling registration into rigid (global) and non-rigid (local) subtasks improves convergence and robustness compared to end-to-end direct regression. The Feature Disentangled Transformer (FDT) uses rotary encoding to disentangle geometric position embeddings from high-level semantic features, establishing robust correspondences between partial intraoperative surfaces and complete preoperative models. Core assumption: The intraoperative liver surface, even if partial, contains sufficient geometric uniqueness to determine the global pose relative to the preoperative CT model.

### Mechanism 2
Structure-Regularized Shape Adaptation (SRSA) prevents implausible warping by conditioning deformation on the similarity between preoperative and intraoperative geometric features. A low-rank transformer computes a deformation weight matrix based on structural similarity, modulating a deformation pyramid to selectively adapt regions with high correspondence confidence while maintaining anatomical integrity of uncertain regions. Core assumption: Geometric similarity in feature space correlates with physical correspondence.

### Mechanism 3
Self-supervised learning via differentiable rendering bridges the synthetic-to-real domain gap without requiring ground-truth deformation labels. The framework projects the deformed 3D model onto the 2D image plane and computes losses (Dice and BCE) between the projected mask and the segmented intraoperative mask. This allows learning the deformation field by minimizing silhouette difference, using the 2D liver boundary as free supervision signal. Core assumption: The 2D liver mask and sparse 3D point cloud provide sufficient constraints to approximate complex 3D volumetric deformation.

## Foundational Learning

- **Point Cloud Registration (Rigid & Non-Rigid):** Essential for understanding how the framework reformulates 3D-2D registration as 3D-3D point cloud registration. Quick check: Can you explain why the Iterative Closest Point (ICP) algorithm fails when the overlap between two point clouds is low (e.g., < 30%)?

- **Rotary Positional Embedding (RoPE):** Critical for the Feature Disentangled Transformer to encode relative spatial positions, enabling the model to understand liver geometry rather than treating it as a bag of points. Quick check: How does encoding relative position (RoPE) differ from absolute positional encoding in standard Transformers, and why is it beneficial for rotation-invariant tasks?

- **Differentiable Rendering:** Core to the self-supervision loop, enabling gradients to flow from 2D mask similarity losses back through the rendering process to update 3D mesh vertices. Quick check: If the rendered silhouette does not overlap the ground truth mask, how does the gradient signal guide the 3D mesh vertices?

## Architecture Onboarding

- **Component map:** Preprocessing (Depth Estimation → Unscale Point Cloud → PCA Scale Alignment) → Rigid Branch (KPFPN Backbone → FDT → SVD Solver) → Non-Rigid Branch (Deformation Pyramid → SRSA) → Differentiable Renderer → Supervision (Mask/Depth Loss)

- **Critical path:** The Rigid Registration must be accurate first. If the global alignment (R, t) is wrong, the Non-Rigid network (SRSA) receives a misaligned input and will likely fail to converge or produce artifacts. The paper specifically trains Rigid on synthetic data and freezes it to ensure stability.

- **Design tradeoffs:**
  - Frozen Rigid Network: Pro: Prevents overfitting to small in-vivo dataset and reduces training time (approx. 9h vs 14h). Con: Cannot correct systematic rigid pose errors from synthetic-to-real domain gap.
  - Superpoint Scheme: Pro: Computational efficiency. Con: Loss of fine-grained surface detail, potentially reducing precision in rigid alignment step.

- **Failure signatures:**
  - "Shrinking" Mesh: PCA scale alignment fails, causing projected mesh to look correct in shape but physically smaller/larger than liver in image.
  - Distorted Anatomy: SRSA weights not constrained, causing mesh to twist unnaturally to fit 2D mask, violating internal anatomy.
  - High Rotation Error (RRE): FDT fails to find robust correspondences, likely due to low surface overlap or noise.

- **First 3 experiments:**
  1. Unit Test Rigid Alignment: Feed synthetic pairs with known GT transformations. Verify SVD solver and Confidence Matrix correctly recover pose under varying overlap ratios (20% vs 50%).
  2. Scale Sensitivity Check: Ablate PCA scale alignment step. Feed raw Depth Anything output into pipeline and measure drop in Chamfer Distance.
  3. Visualizing SRSA: Run non-rigid deformation on single in-vivo case. Visualize "Similarity Map" to confirm high weights correspond to visible liver regions and low weights to occluded areas.

## Open Questions the Paper Calls Out

- **Scale Consistency Integration:** Can the scale-consistent calibration step be effectively integrated into end-to-end network optimization rather than remaining an offline preprocessing step? Current PCA-based geometric assumption works for initialization but limits fully learnable self-supervision.

- **Physics-Based Deformation:** Can incorporating physics-based simulations of respiratory effects and pneumoperitoneum improve estimation of deformation in invisible liver regions? Current data-driven deformation pyramid fits visible surfaces well but lacks physical constraints for predicting movement of occluded internal structures.

- **Segmentation Dependency:** To what extent does accuracy of automated segmentation models degrade registration performance in challenging surgical scenarios compared to manual labeling? While method is "landmark-free," it substitutes dependency on accurate 2D masks, which may fail under severe occlusion or bleeding.

## Limitations
- Performance degrades significantly with poor surface reconstruction quality, suggesting potential brittleness in challenging clinical scenarios
- PCA-based scale alignment may fail when liver shape changes substantially due to retraction or blood flow variations during surgery
- Generalization capability beyond specific surgical setup used in dataset remains uncertain due to lack of cross-center validation

## Confidence

- **High Confidence:** Decoupled rigid-non-rigid architecture design and theoretical advantages are well-supported by ablation studies and comparison with state-of-the-art methods. Self-supervised learning approach using differentiable rendering is sound with clear experimental improvements.

- **Medium Confidence:** Claims about clinical utility and robustness to real surgical conditions have moderate support from in-vivo dataset (346 frames from 21 patients) but limited evidence under extreme conditions like heavy bleeding or minimal visible surface.

- **Low Confidence:** Generalization capability beyond specific surgical setup remains uncertain as paper does not report cross-center validation or performance on different laparoscopic camera systems.

## Next Checks

1. **Occlusion Robustness Test:** Systematically evaluate registration performance with controlled amounts of liver surface occlusion (using synthetic data) to quantify claimed 15% overlap threshold and identify failure points.

2. **Domain Adaptation Validation:** Train and test framework on completely independent laparoscopic liver surgery dataset from different institution to verify cross-center generalization and assess real-world deployment readiness.

3. **Clinical Workflow Integration:** Conduct formal user study measuring actual time savings and error rates when surgeons use augmented reality overlay in simulated surgical environment compared to standard navigation methods.