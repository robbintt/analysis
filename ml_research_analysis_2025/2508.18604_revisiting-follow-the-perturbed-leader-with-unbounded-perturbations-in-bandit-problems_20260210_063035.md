---
ver: rpa2
title: Revisiting Follow-the-Perturbed-Leader with Unbounded Perturbations in Bandit
  Problems
arxiv_id: '2508.18604'
source_url: https://arxiv.org/abs/2508.18604
tags:
- perturbations
- ftpl
- distribution
- function
- chet-type
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper explores the relationship between FTPL and FTRL policies
  in multi-armed bandit problems, focusing on achieving Best-of-Both-Worlds (BOBW)
  results with unbounded perturbations. While FTRL has achieved BOBW results through
  hybrid regularizers, analogous results for FTPL have been limited due to analytical
  challenges.
---

# Revisiting Follow-the-Perturbed-Leader with Unbounded Perturbations in Bandit Problems

## Quick Facts
- arXiv ID: 2508.18604
- Source URL: https://arxiv.org/abs/2508.18604
- Reference count: 40
- Key outcome: Establishes Best-of-Both-Worlds results for FTPL with asymmetric unbounded Fréchet-type perturbations while identifying limitations of symmetric perturbations for K≥3 arms

## Executive Summary
This paper bridges the gap between FTRL and FTPL approaches for achieving Best-of-Both-Worlds (BOBW) guarantees in multi-armed bandits. While FTRL has achieved BOBW results through hybrid regularizers like Shannon+Tsallis entropy, FTPL has been limited due to analytical challenges. The authors establish BOBW results for FTPL using asymmetric unbounded Fréchet-type perturbations, including hybrid perturbations combining Gumbel-type and Fréchet-type tails. They also identify a fundamental limitation: symmetric Fréchet-type perturbations that work for K=2 arms fail to satisfy key conditions for BOBW analysis in general K≥3 multi-armed bandits.

## Method Summary
The paper implements Follow-the-Perturbed-Leader (FTPL) with asymmetric unbounded Fréchet-type perturbations. The algorithm samples perturbations from distributions like Laplace-Pareto (combining exponential left tails with polynomial right tails) and uses geometric resampling to estimate importance-weighted losses when closed-form arm-selection probabilities are intractable. The learning rate follows ηₜ = m/√t with m=0.23 for Laplace-Pareto. The method is evaluated in both adversarial settings (oblivious/adaptive) and stochastic settings with unique optimal arms, comparing regret against theoretical bounds of O(√KT) for adversarial and O(log T/Δᵢ) for stochastic settings.

## Key Results
- Asymmetric unbounded Fréchet-type perturbations achieve BOBW guarantees with O(√KT) adversarial regret and O(log T/Δᵢ) stochastic regret
- Laplace-Pareto perturbation provides explicit bounds: 49.25√KT + O(√K + K log T) adversarial regret
- Symmetric Fréchet-type perturbations achieve BOBW results for K=2 arms but violate key conditions for K≥3 arms
- Numerical investigation shows symmetric Fréchet-type perturbations correspond to 1/2-Tsallis entropy regularizer (conjectural)

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Asymmetric unbounded Fréchet-type perturbations enable Best-of-Both-Worlds (BOBW) guarantees in multi-armed bandits.
- Mechanism: By utilizing perturbation distributions where the left tail is significantly heavier (polynomial decay index $\beta \ge \alpha + 2$) than the right tail (index $\alpha$), the algorithm maintains the stability of arm-selection probabilities ($\phi_i$). This asymmetry prevents the violation of the monotonicity condition $f/F$ required for standard BOBW analysis, effectively bounding the stability term $-\phi_i'/\phi_i$ by $O(\sigma_i^{-1/\alpha})$.
- Core assumption: The tail indices satisfy $\beta \ge \alpha + 2$ (e.g., Laplace-Pareto), and the distribution is unimodal.
- Evidence anchors:
  - [abstract] "establish BOBW results for FTPL under a broad family of asymmetric unbounded Fréchet-type perturbations"
  - [section 4] Theorem 4.1 establishes the bound for $U_{\alpha, \beta}$ when $\alpha > 1$ and $\beta \ge \alpha + 2$.
  - [corpus] Corpus papers confirm FTPL is a viable framework for BOBW in various settings, but do not specifically address this novel asymmetric perturbation theory.
- Break condition: If the left tail is not sufficiently heavier than the right tail (violating $\beta \ge \alpha+2$), the stability bounds derived in Theorem 4.1 may not hold, potentially degrading adversarial regret guarantees.

### Mechanism 2
- Claim: Hybrid perturbations combining Gumbel-type and Fréchet-type tails serve as functional analogues to hybrid regularizers (e.g., Shannon + Tsallis entropy) in FTRL.
- Mechanism: The Laplace-Pareto perturbation combines an exponential left tail (Gumbel-type, associated with Shannon entropy) and a polynomial right tail (Fréchet-type, associated with Tsallis entropy). This mix allows the policy to approximate the behavior of hybrid FTRL methods, balancing the exploration-exploitation trade-off dynamically without explicitly defining a complex regularization function.
- Core assumption: The duality between the specific perturbation distribution and the implicit regularizer holds such that the "implicit" regularization behaves like the intended hybrid.
- Evidence anchors:
  - [abstract] "including hybrid perturbations combining Gumbel-type and Fréchet-type tails"
  - [section 4] "Laplace-Pareto perturbations can be roughly viewed as hybrid regularizers combining Shannon and Tsallis entropies."
  - [corpus] Evidence in the corpus regarding hybrid regularizers is weak; neighbors focus on linear or combinatorial extensions rather than specific entropy analogies.
- Break condition: If the mapping from perturbation to regularizer is not approximately convex or well-behaved, the theoretical guarantees derived from the regularizer analogy may not transfer to the FTPL implementation.

### Mechanism 3
- Claim: Symmetric Fréchet-type perturbations fail to satisfy standard BOBW conditions for $K \ge 3$ arms, despite working for $K=2$.
- Mechanism: In the two-armed case ($K=2$), symmetric perturbations maintain necessary stability ($-\phi_i'/\phi_i^{3/2}$ is bounded). However, for $K \ge 3$, the ratio $-\phi_i'/\phi_i$ fails to scale as $O(1/\lambda_i)$ required for logarithmic stochastic regret, effectively violating the conditions needed for the self-bounding technique used in BOBW proofs.
- Core assumption: The "standard analysis" (specifically relying on conditions like Assumption 2.3) is the only pathway to BOBW guarantees; alternative non-standard analyses are not considered ruled out but are currently unavailable.
- Evidence anchors:
  - [abstract] "demonstrates that symmetric Fréchet-type perturbations achieve BOBW results in two-armed bandits but violate key conditions... in general multi-armed bandits."
  - [section 5.3] Proposition 5.5 shows that for $K \ge 3$, $-\phi_i'/\phi_i \ge \tilde{\Omega}(1/(K\sqrt{K}))$, violating the decay needed for stochastic regret.
  - [corpus] Corpus neighbors do not discuss the limitation of symmetric perturbations in $K \ge 3$, highlighting the novelty of this negative result.
- Break condition: Applying symmetric Fréchet-type perturbations (e.g., simple Pareto) to problems with $K \ge 3$ arms will likely result in suboptimal stochastic regret, even if adversarial regret remains near-optimal.

## Foundational Learning

- Concept: **Regret Bounds (Adversarial vs. Stochastic)**
  - Why needed here: The paper's primary goal is a "Best-of-Both-Worlds" (BOBW) guarantee. You must understand the target metrics: $O(\sqrt{KT})$ for the adversarial setting (no distributional assumptions) and $O(\log T / \Delta_i)$ for the stochastic setting (i.i.d. losses), to judge the algorithm's success.
  - Quick check question: What are the regret orders achieved by the Laplace-Pareto perturbation in both settings? (Answer: $49.25\sqrt{KT}$ adversarial, $O(\log T / \Delta_i)$ stochastic).

- Concept: **Fréchet-type Distributions and Tail Indices**
  - Why needed here: The core mechanism relies on "Fréchet-type" perturbations, characterized by polynomial tail decay. Understanding the "tail index" ($\alpha$) is crucial, as it dictates the perturbation's heaviness and directly controls the algorithm's stability constants.
  - Quick check question: How does the tail index $\alpha$ affect the perturbation's behavior? (Answer: Smaller $\alpha$ implies heavier tails; $\alpha=\infty$ corresponds to Gumbel/exponential types).

- Concept: **FTPL vs. FTRL Duality**
  - Why needed here: The paper bridges "Follow-the-Perturbed-Leader" (adding noise to cumulative loss) and "Follow-the-Regularized-Leader" (adding a convex penalty). Understanding this duality explains why the authors compare their perturbations to entropy regularizers like Tsallis or Shannon entropy.
  - Quick check question: What regularizer corresponds to Gumbel perturbations in the FTPL-FTRL duality? (Answer: Negative Shannon entropy).

## Architecture Onboarding

- Component map:
  - Loss Estimator -> Perturbation Engine -> Selector
- Critical path: The **Perturbation Engine**. Generating samples from the asymmetric Fréchet-type distributions (specifically the hybrid Laplace-Pareto) efficiently and correctly is the most critical implementation step, as standard libraries may not support these exact hybrid forms natively.
- Design tradeoffs: **Asymmetric vs. Symmetric**. Asymmetric perturbations (Proposition 1.1) offer BOBW for all K but require complex distribution implementations. Symmetric perturbations (Proposition 1.2) are simpler and theoretically elegant (linked to Tsallis) but are strictly limited to K=2 arms for proven BOBW guarantees.
- Failure signatures:
  - **K≥3 Stochastic Failure**: If you use symmetric Fréchet-type perturbations (e.g., simple Pareto) on K≥3 arms, expect the logarithmic regret guarantee to break (regret will not scale as O(log T)).
  - **Implementation Drift**: Incorrectly implementing the tail index or mixing the Laplace/Pareto boundaries will violate the $\beta \ge \alpha+2$ condition, potentially losing the adversarial robustness.
- First 3 experiments:
  1. **Sanity Check (K=2)**: Implement FTPL with Symmetric Pareto perturbations on a simple stochastic 2-armed bandit to verify the O(log T) regret scaling.
  2. **Stress Test (K≥3)**: Run the Symmetric Pareto implementation on K=10 arms. Plot the regret against T to visually confirm the failure to achieve logarithmic regret (comparing against the asymmetric Laplace-Pareto implementation).
  3. **Hybrid Validation**: Implement the Laplace-Pareto perturbation and benchmark it against a standard FTRL hybrid regularizer (e.g., Tsallis-INF) to validate the theoretical "analogue" claim regarding regret magnitude.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can symmetric Fréchet-type perturbations achieve Best-of-Both-Worlds (BOBW) guarantees for $K \ge 3$?
- Basis in paper: [inferred] from Section 5.3 and Conclusion. The authors show standard conditions fail but do not preclude alternative analyses.
- Why unresolved: Key stability conditions ($-\phi'_i/\phi_i^{3/2} = O(1)$) are violated in specific counterexamples.
- What evidence would resolve it: A novel regret analysis bypassing standard conditions or proof that BOBW is impossible for this class.

### Open Question 2
- Question: Does a symmetric perturbation exist that exactly reproduces FTRL with the $1/2$-Tsallis entropy regularizer?
- Basis in paper: [explicit] Conjecture 5.2 in Section 5.1.
- Why unresolved: Numerical observations support the existence, but a formal proof regarding the characteristic function is lacking.
- What evidence would resolve it: Proof that the function $\sqrt{\bar{g}}$ is positive definite, implying it is a valid characteristic function.

### Open Question 3
- Question: Which specific regularizers are analytically associated with hybrid perturbations, such as the Laplace-Pareto distribution?
- Basis in paper: [explicit] Discussion following Proposition 1.1 (Page 3) states it "remains unclear which regularizers are associated."
- Why unresolved: While duality between FTPL and FTRL is established, the exact closed-form regularizer for these hybrids is uncharacterized.
- What evidence would resolve it: Derivation of the regularizer function corresponding to hybrid perturbations, e.g., a sum of Shannon and Tsallis entropies.

## Limitations

- Theoretical analysis relies on precise tail index relationships ($\beta \ge \alpha + 2$) that may be difficult to verify empirically
- Connection between symmetric Fréchet-type perturbations and 1/2-Tsallis entropy remains conjectural with only numerical evidence
- Symmetric perturbations' failure for K≥3 arms limits practical applicability of theoretically elegant Tsallis connection

## Confidence

- Asymmetric Fréchet-type BOBW results (Proposition 4.1): **High** - Contains complete proofs with explicit constants and verified tail conditions
- Laplace-Pareto as hybrid regularizer analogue: **Medium** - Theoretical justification exists but empirical validation is limited to specific cases
- Symmetric perturbations failure for K≥3: **High** - Complete mathematical proof provided with explicit counterexamples
- Conjecture 5.2 (symmetric Pareto = Tsallis): **Low** - Only numerical evidence presented without formal proof

## Next Checks

1. Implement the Laplace-Pareto perturbation in a K=5 bandit problem and verify the adversarial regret scales as O(√KT) while maintaining logarithmic stochastic regret

2. Conduct extensive numerical experiments testing Conjecture 5.2 by computing the inverse Fourier transform for various α values and comparing against the theoretical Tsallis entropy regularizer

3. Test the robustness of asymmetric perturbations by systematically violating the $\beta \ge \alpha + 2$ condition and measuring degradation in adversarial regret performance