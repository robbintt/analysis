---
ver: rpa2
title: 'SynCraft: Guiding Large Language Models to Predict Edit Sequences for Molecular
  Synthesizability Optimization'
arxiv_id: '2512.20333'
source_url: https://arxiv.org/abs/2512.20333
tags:
- syncraft
- chemical
- molecule
- atom
- page
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces SynCraft, a framework that reframes synthesizability
  optimization as a precise structural editing problem. Instead of generating entire
  SMILES strings, SynCraft leverages large language models to predict executable sequences
  of atom-level edits, addressing the syntactic fragility of LLMs while harnessing
  their chemical reasoning capabilities.
---

# SynCraft: Guiding Large Language Models to Predict Edit Sequences for Molecular Synthesizability Optimization

## Quick Facts
- arXiv ID: 2512.20333
- Source URL: https://arxiv.org/abs/2512.20333
- Reference count: 40
- Primary result: Reframes synthesizability optimization as atom-level edit prediction, outperforming baselines in generating synthesizable analogs with high structural fidelity

## Executive Summary
SynCraft addresses the syntactic fragility of LLMs in molecular generation by reframing synthesizability optimization as a discrete structural editing problem. Instead of generating full SMILES strings, the framework uses large language models to predict executable sequences of atom-level edits, which are then deterministically executed by a chemical toolkit. Through extensive benchmarking on large-scale datasets, SynCraft significantly outperforms state-of-the-art baselines in generating synthesizable analogs while preserving key pharmacophores. The method successfully navigates the "synthesis cliff" by performing minimal modifications that restore synthetic feasibility, demonstrating practical utility in real-world drug discovery workflows.

## Method Summary
SynCraft reframes synthesizability optimization as a discrete structural editing problem where LLMs predict sequences of atom-level edits rather than generating full SMILES strings. The framework constructs a "Synthesis Cliff" dataset of ~3.3k unsynthesizable-to-synthesizable molecule pairs sourced from GenBench3D outputs. For inference, it uses RAG retrieval (top-5 Morgan fingerprints) to provide few-shot examples to Gemini-2.5-Pro, which generates reasoning traces and JSON edit sequences. These edits are deterministically executed via RDKit to produce chemically valid molecules. Optional interaction-aware constraints can be added for structure-based optimization by identifying key binding atoms through AutoDock Vina and PLIP analysis.

## Key Results
- SynCraft achieves significantly higher success rates in generating synthesizable analogs compared to state-of-the-art baselines at medium-to-high similarity thresholds (Tanimoto > 0.7)
- The method successfully navigates the "synthesis cliff" by performing minimal modifications that restore synthetic feasibility while preserving key pharmacophores
- Retrosynthesis validation and prospective optimization of high-scoring but previously shelved drug candidates demonstrate practical utility in real-world drug discovery workflows

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Reframing synthesizability optimization from sequence translation to discrete structural editing reduces LLM syntactic errors in molecular generation.
- Mechanism: The framework uses an LLM (Gemini 2.5 Pro) to predict a sequence of atom-level edit commands (e.g., `DEL_ATOM`, `ADD_BOND`) rather than a full SMILES string. These discrete commands are executed by a deterministic chemical toolkit (RDKit), guaranteeing a chemically valid output graph.
- Core assumption: The LLM possesses sufficient "chemical intuition" to reason about synthetic liabilities and propose chemically sound edits, even if it struggles with SMILES grammar.

### Mechanism 2
- Claim: Providing in-context examples of successful "unsynthesizable-to-synthesizable" transformations guides the LLM to perform more effective and targeted edits.
- Mechanism: SynCraft uses Retrieval-Augmented Generation (RAG). For a query molecule, it retrieves top-k (k=5) similar examples from a "Synthesis Cliff" datasetâ€”pairs of unsynthesizable and synthesizable molecules. These examples, with reasoning traces and edit sequences, are injected into the prompt as few-shot demonstrations.
- Core assumption: The "Synthesis Cliff" dataset of ~3.3k pairs contains transformation patterns generalizable to new, unseen unsynthesizable molecules.

### Mechanism 3
- Claim: Explicitly defining protein-ligand interaction constraints in natural language allows the LLM to preserve critical pharmacophores during synthesizability optimization.
- Mechanism: For structure-based optimization, an interaction-aware pipeline identifies key atoms involved in binding interactions. This information is translated into textual descriptions (e.g., "Atom [12]... forms a critical Hydrogen Bond with ASP156") and added to the prompt, framing the task as a constrained optimization problem.
- Core assumption: The LLM can interpret spatial constraints expressed in natural language and translate them into graph edits that preserve the specified interactions.

## Foundational Learning

- **Syntactic Fragility of LLMs in Chemistry**: Understanding this weakness motivates the entire edit-based architecture. *Quick check*: Ask a general-purpose LLM to generate a SMILES string for a moderately complex molecule and validate it with RDKit. Multiple attempts will likely show a non-zero failure rate.

- **Retrieval-Augmented Generation (RAG) for Few-Shot Prompting**: This is the primary inference mechanism guiding the LLM's chemical reasoning. *Quick check*: Manually perform a simple RAG process: embed a small text corpus, then for a new query retrieve the top-2 most similar documents and use them as context to answer a question based only on that information.

- **Scaffold Hopping and Bioisosterism in Medicinal Chemistry**: These are key strategies for improving synthesizability without losing biological activity. *Quick check*: For a molecule with a synthetically challenging chiral center, what is a common bioisosteric strategy to remove chirality while preserving functional group spatial arrangement?

## Architecture Onboarding

- **Component map**: Reference database ("Synthesis Cliff" pairs) -> Retrieval engine (Morgan fingerprint similarity) -> LLM reasoner (Gemini 2.5 Pro) -> Editing toolkit (command parser & RDKit graph executor) -> Interaction-aware pipeline (AutoDock Vina & PLIP)

- **Critical path**: Query Molecule -> Fingerprinting & Retrieval -> Prompt Construction (RAG examples + optional constraints) -> LLM Inference (reasoning + JSON edits) -> Edit Parsing -> Deterministic Graph Execution -> Validated, Optimized Molecule

- **Design tradeoffs**:
  - Cost vs. Precision: ~$3-5 per 100 optimizations is expensive for massive enumeration. System is designed for high-value hit optimization, not high-throughput screening.
  - Fidelity vs. Tractability: Model navigates "synthesis cliff" but can fail if required edits are too drastic with no close synthesizable analog.

- **Failure signatures**:
  - Irrelevant Retrieval: RAG pulls examples with different scaffolds, causing incoherent or simplistic edits ("structural drift").
  - Graph Alignment Failure: Atom indices from docking pose don't match 2D atom map, causing LLM to "protect" the wrong atoms.
  - Edit Logic Error: LLM reasons correctly in text but outputs invalid JSON or a chemically unstable edit sequence.

- **First 3 experiments**:
  1. RAG Ablation Validation: Test on held-out unsynthesizable molecules with (a) 5-shot, (b) 1-shot, (c) zero-shot. Compare success rates at high similarity threshold (Tanimoto > 0.7).
  2. Interaction-Awareness Fidelity Check: Run pipeline on molecules with known binding modes (e.g., PDB binders). Verify if edits truly preserve key literature-reported interactions, not just docking scores.
  3. Manual Edit Sequence Verification: Run on 10-20 diverse examples. Manually inspect JSON edit sequences and reasoning traces. Do reasoning and edits align? Are edits chemically sound? This builds intuition for failure modes.

## Open Questions the Paper Calls Out

- Can the SynCraft framework be effectively distilled or optimized for high-throughput screening of massive virtual libraries, given current LLM inference cost constraints?
- How robust is the interaction-aware optimization against errors in the initial docking pose used to generate constraints?
- Does the method's performance generalize to smaller, open-source Large Language Models, or is it dependent on the specific reasoning capabilities of proprietary models like Gemini-2.5-Pro?

## Limitations

- Data Representativeness: The Synthesis Cliff dataset (~3.3k pairs) may not fully represent the diversity of real-world drug discovery challenges, particularly for novel chemical scaffolds.
- Retrosynthesis Validation Constraints: SimpRetro evaluation uses a 30-minute timeout per molecule and Enamine building blocks, which may underestimate synthetic feasibility for molecules requiring longer routes or alternative building blocks.
- Generalization Boundaries: The RAG-based approach relies on retrieving similar examples from the training set. Performance may degrade for molecules in chemical space regions poorly represented in the Synthesis Cliff dataset.

## Confidence

- **High Confidence**: The edit-based architecture effectively addresses LLM syntactic fragility (Mechanism 1). The deterministic graph execution via RDKit ensures chemical validity of outputs.
- **Medium Confidence**: RAG with few-shot prompting improves edit quality (Mechanism 2). The ablation studies provide supporting evidence, but the specific approach hasn't been validated against other few-shot strategies.
- **Medium Confidence**: Interaction-aware constraints preserve pharmacophores during optimization (Mechanism 3). Case studies show promise, but systematic evaluation across diverse protein targets is needed.

## Next Checks

1. Out-of-Distribution Testing: Evaluate SynCraft on a held-out set of unsynthesizable molecules from different chemical space regions than the Synthesis Cliff training pairs to assess generalization limits.
2. Alternative Retrosynthesis Validation: Compare SimpRetro results with at least one additional retrosynthesis tool (e.g., ASKCOS) using different building block sources to verify synthetic feasibility assessments.
3. Human Expert Validation: Have medicinal chemistry experts blind-review a subset of SynCraft outputs for both synthetic feasibility and preservation of drug-like properties to validate automated metrics against domain expertise.