---
ver: rpa2
title: Spatially Aware Dictionary-Free Eigenfunction Identification for Modeling and
  Control of Nonlinear Dynamical Systems
arxiv_id: '2511.22648'
source_url: https://arxiv.org/abs/2511.22648
tags:
- koopman
- eigenfunctions
- system
- control
- dynamics
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a dictionary-free method for identifying
  Koopman eigenfunctions directly from data without predefined basis functions. The
  approach uses a reference trajectory and projects other trajectories onto a temporal
  basis derived from eigenvalues to obtain initial eigenfunction values.
---

# Spatially Aware Dictionary-Free Eigenfunction Identification for Modeling and Control of Nonlinear Dynamical Systems

## Quick Facts
- arXiv ID: 2511.22648
- Source URL: https://arxiv.org/abs/2511.22648
- Reference count: 40
- Key outcome: Dictionary-free method identifies Koopman eigenfunctions from data, enabling improved prediction and control of nonlinear systems without predefined basis functions

## Executive Summary
This paper introduces a novel dictionary-free approach for identifying Koopman eigenfunctions directly from data, eliminating the need for predefined basis functions. The method uses a reference trajectory to project other trajectories onto a temporal basis derived from eigenvalues, then enforces spatial integrity through gradient-based penalties. A global optimizer refines the eigenvalues to minimize both temporal and spatial cost terms. The approach successfully identifies eigenfunctions for various nonlinear systems including the FitzHugh-Nagumo model, van der Pol and Duffing oscillators, and a 2-spool turbojet engine, enabling improved prediction accuracy and control design through gain-scheduled LQG control.

## Method Summary
The method begins by selecting a reference trajectory that serves as the foundation for eigenfunction discovery. Other trajectories are projected onto a temporal basis constructed from the Koopman eigenvalues to obtain initial eigenfunction values. Spatial integrity is enforced by computing gradients of the estimated eigenfunctions and penalizing deviations from the Koopman partial differential equation (KPDE). A global optimizer iteratively adjusts the eigenvalues to minimize a combined cost function that includes both temporal projection errors and spatial KPDE residuals. This process discovers the Koopman spectral components without requiring a dictionary of predefined basis functions, making it particularly suitable for systems where appropriate dictionaries are difficult to construct.

## Key Results
- Successfully identified Koopman eigenfunctions for multiple nonlinear systems including FitzHugh-Nagumo, van der Pol, Duffing oscillators, and a 2-spool turbojet engine
- Discovered geometric features like invariant partitions and isochrons directly from data without predefined basis functions
- Achieved improved Koopman predictor accuracy compared to dictionary-based methods
- Enabled effective gain-scheduled LQG control of engine spool speeds, outperforming classical PID controllers

## Why This Works (Mechanism)
The method works by combining temporal and spatial consistency constraints in the eigenfunction identification process. The temporal basis projection captures the evolution of eigenfunctions along trajectories, while the spatial gradient-based penalty enforces that eigenfunctions satisfy the Koopman PDE across the state space. By using a reference trajectory for initialization and projecting other data onto the resulting temporal basis, the method establishes a consistent framework for eigenfunction values. The global optimization then refines eigenvalues to minimize both projection errors and spatial inconsistencies, ensuring that the discovered eigenfunctions accurately represent the underlying dynamics while maintaining mathematical consistency with Koopman theory.

## Foundational Learning
- Koopman operator theory: Provides linear representation of nonlinear dynamics through infinite-dimensional operator acting on observable functions. Needed to understand how eigenfunctions relate to system dynamics.
- Eigenfunction projection: Maps trajectory data onto temporal basis to obtain initial eigenfunction values. Required for initializing the optimization with consistent estimates.
- Spatial gradient enforcement: Computes and penalizes deviations from KPDE using numerical gradients. Ensures mathematical consistency of discovered eigenfunctions across state space.
- Global optimization for eigenvalues: Iteratively refines spectral components to minimize combined temporal and spatial costs. Critical for accurate eigenfunction identification without predefined dictionaries.
- Control design using Koopman eigenfunctions: Enables model-based control synthesis using the discovered spectral components. Allows for advanced control strategies like gain-scheduled LQG.

## Architecture Onboarding

**Component Map:**
Reference Trajectory -> Temporal Basis Projection -> Initial Eigenfunction Values -> Spatial Gradient Computation -> Combined Cost Function -> Global Optimizer -> Refined Eigenvalues -> Koopman Predictor

**Critical Path:**
The most critical sequence is Reference Trajectory selection -> Temporal Basis Projection -> Global Optimization. Poor reference trajectory selection directly impacts initial eigenfunction estimates, which affects the spatial integrity constraints and ultimately the quality of the discovered eigenfunctions and resulting controller performance.

**Design Tradeoffs:**
- Reference trajectory selection: Long, complex trajectories provide better coverage but increase computational cost
- Temporal basis size: More eigenfunctions capture finer dynamics but increase optimization complexity and risk overfitting
- Gradient computation method: Numerical differences are simple but introduce errors; analytical methods are more accurate but require more implementation effort
- Optimizer choice: Global methods ensure convergence but are slower than local methods

**Failure Signatures:**
- Poor eigenfunction shapes with unrealistic gradients indicate inadequate reference trajectory coverage
- High KPDE residuals suggest numerical gradient computation errors or insufficient temporal basis components
- Oscillatory optimization behavior may indicate poor scaling between temporal and spatial cost terms
- Low prediction accuracy reveals either poor eigenfunction identification or insufficient temporal basis representation

**First Experiments:**
1. Validate on a simple harmonic oscillator where analytical eigenfunctions are known to establish baseline accuracy
2. Test with synthetic data from a bistable system to verify discovery of different eigenfunctions for each basin
3. Evaluate sensitivity to reference trajectory selection by comparing results from multiple trajectory choices

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the proposed dictionary-free method scale effectively to higher-dimensional or chaotic systems, such as the Lorenz system or flow around a cylinder?
- Basis: [explicit] The conclusion states that future research will investigate applications to higher-dimensional systems like dissipative Lorenz systems and chaotic systems.
- Why unresolved: The current framework relies on grid-based sampling and numerical gradient computation, which become computationally laborious and expensive as the state dimension increases.
- Evidence: Successful identification of eigenfunctions and stable control synthesis for a chaotic or 3D system using the same spatial integrity constraints without prohibitive computational cost.

### Open Question 2
- Question: Can an automated metric for reference trajectory selection be developed to ensure robust coverage of system dynamics?
- Basis: [explicit] The methods section suggests testing "automatic reference trajectory selection based on relevant coverage metrics."
- Why unresolved: The paper demonstrates that poor reference trajectory selection significantly degrades accuracy, yet the current selection relies on intuition (e.g., picking the longest trajectory) rather than a quantified metric.
- Evidence: A defined coverage metric that correlates strongly with minimized temporal and KPDE cost functions, removing the need for manual trial-and-error in trajectory selection.

### Open Question 3
- Question: How does the Koopman-based controller perform when applied to a gas turbine engine operating under varying flight conditions (Mach number and altitude)?
- Basis: [explicit] The conclusion notes that for direct thrust control, the estimator should be trained on flight data and the algorithm "should be tested in varying flight conditions."
- Why unresolved: The turbojet engine validation was performed on normalized data simulating a specific operating region, but did not validate robustness against the changing ambient conditions inherent in real flight envelopes.
- Evidence: Validation of the gain-scheduled LQG controller on simulation or experimental data where inlet pressure and temperature vary significantly during the tracking task.

### Open Question 4
- Question: Does analytical differentiation of the spline interpolant provide superior accuracy for the KPDE cost term compared to the current numerical central difference method?
- Basis: [explicit] The remarks section notes that "analytical differentiation of the spline interpolant might be tested."
- Why unresolved: The current method uses central differences to compute gradients, which introduces numerical errors that can distort the spatial integrity penalty, particularly in regions with complex eigenfunction landscapes.
- Evidence: A comparative analysis showing lower KPDE residuals and improved eigenfunction shape discovery when using analytical derivatives versus finite differences on the same non-linear benchmarks.

## Limitations
- Heavy reliance on reference trajectory quality, with poor selection leading to incomplete or inaccurate eigenfunctions
- Computational complexity increases significantly with state dimension due to grid-based sampling and gradient computation
- No systematic method for selecting optimal temporal basis size or number of eigenfunctions
- Spatial gradient enforcement assumes KPDE holds pointwise, which may not hold for noisy or highly nonlinear systems

## Confidence

**High:**
- Mathematical formulation of the optimization problem and spatial integrity enforcement through gradients
- Numerical results demonstrating improved prediction accuracy over dictionary-based methods on benchmark systems
- Control application results showing effective gain-scheduled LQG design

**Medium:**
- Method's ability to discover physically meaningful eigenfunctions in all cases, depending heavily on data quality and trajectory coverage
- Robustness to noise and incomplete state space coverage in the training data

**Low:**
- Scalability to very high-dimensional systems (10+ dimensions) or systems with multiple isolated attractors
- Generalizability of the method to systems with discontinuous dynamics or non-smooth potentials

## Next Checks
1. Test the method on a bistable system with two isolated attractors to verify discovery of different eigenfunctions for each basin
2. Evaluate performance with varying levels of noise in the training data to establish robustness bounds
3. Compare discovered eigenfunctions against analytical solutions for a double-well potential system where they are known to validate accuracy