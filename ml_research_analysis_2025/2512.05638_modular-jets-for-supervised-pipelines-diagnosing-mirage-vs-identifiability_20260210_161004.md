---
ver: rpa2
title: 'Modular Jets for Supervised Pipelines: Diagnosing Mirage vs Identifiability'
arxiv_id: '2512.05638'
source_url: https://arxiv.org/abs/2512.05638
tags:
- jets
- linear
- perturbations
- modular
- input
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: Modular Jets introduce a post-hoc evaluation framework for supervised
  pipelines that goes beyond standard risk metrics by estimating local linear response
  maps (jets) at module-level taps. By probing modules with structured input perturbations
  and fitting ridge-regularised linear models, jets reveal how each module locally
  responds to input changes, enabling mirage versus identifiability diagnostics.
---

# Modular Jets for Supervised Pipelines: Diagnosing Mirage vs Identifiability

## Quick Facts
- arXiv ID: 2512.05638
- Source URL: https://arxiv.org/abs/2512.05638
- Reference count: 19
- Key outcome: Modular Jets enable post-hoc evaluation of supervised pipelines by estimating module-level jets to distinguish between mirage (non-unique internal factorizations) and identifiable internal structures, going beyond standard risk metrics.

## Executive Summary
Modular Jets introduce a post-hoc evaluation framework for supervised pipelines that goes beyond standard risk metrics by estimating local linear response maps (jets) at module-level taps. By probing modules with structured input perturbations and fitting ridge-regularised linear models, jets reveal how each module locally responds to input changes, enabling mirage versus identifiability diagnostics. The method is validated across synthetic linear/nonlinear regression and classification tasks, plus a real digits classification case, showing that models with identical risk can differ sharply in jet-based diagnostics.

## Method Summary
The MoJet algorithm estimates empirical jets by generating input perturbations, collecting module tap representations, and fitting ridge-regularised linear models to estimate local Jacobians. For each base input, perturbations are applied and the full pipeline is run to collect tapped representations. Ridge regression is then used to estimate the empirical Jacobian matrix at each module tap. Numerical rank and subspace similarity (JetSim) metrics are computed from these Jacobians to diagnose mirage versus identifiability regimes.

## Key Results
- In linear two-module regression, risk-only evaluation admits an r²-parameter family of indistinguishable mirage decompositions
- Module-level jets uniquely determine the internal factorization under mild rank conditions
- Experiments show models with identical risk can differ sharply in jet-based diagnostics, revealing hidden internal differences or mirage regimes

## Why This Works (Mechanism)

### Mechanism 1: Risk-Only Evaluation Permits Non-Unique Decompositions
Standard predictive risk metrics are insufficient to uniquely determine a model's internal factorization in linear two-module pipelines, admitting an r²-parameter family of indistinguishable "mirage" decompositions. An invertible linear transformation Q applied to a module's output can be counteracted by its inverse Q⁻¹ in the subsequent module, leaving the final input-to-output map unchanged.

### Mechanism 2: Module-Level Jets Disambiguate Internal Structure
Estimating local linear response maps ("jets") at internal module taps provides evidence for decomposition identifiability where risk-only evaluation fails. A jet contains both the module's local representation z(x) and its empirical Jacobian A. Under full-rank assumptions, if two distinct linear decompositions produce identical jets, their internal weight matrices must be identical.

### Mechanism 3: Perturbation Design Reveals or Obscures Internal Differences
The choice of input perturbation family determines whether models with similar risk appear as "mirage" or "identifiable." Coarse, isotropic perturbations probe the full input space including nuisance directions, while structured, aligned perturbations probe only task-relevant subspaces. This evaluation design controls visibility of internal structure differences.

## Foundational Learning

- **Jacobian Matrix / Gradient**: The core mechanism relies on estimating empirical Jacobians of module representations with respect to inputs. For a function f: ℝᵈ → ℝ, what does its Jacobian (a 1xd vector) represent geometrically at a point x₀?
- **Ridge Regression (Tikhonov Regularization)**: The MoJet algorithm uses ridge regression to fit the empirical Jacobian, stabilizing the solution when the probe matrix is ill-conditioned. How does adding an λI term to the matrix XᵀX in (XᵀX + λI)⁻¹Xᵀy affect the solution when XᵀX is singular or near-singular?
- **Subspace Affinity / Principal Angles**: The diagnostic relies on computing jet similarity, which measures the alignment of two subspaces. If two linear subspaces have an average principal angle of 0 degrees, what can be said about their relationship?

## Architecture Onboarding

- **Component map**: Pipeline (input → M₁ → M₂ → ... → output) with tap functions accessing intermediate representations zₘ at each module
- **Critical path**: 1) Select base inputs, 2) Design perturbations (coarse and aligned), 3) Run MoJet for data collection (generate perturbed inputs and record tapped representations), 4) Run MoJet for jet estimation (solve ridge-regularized least-squares), 5) Compute diagnostics (numerical rank and JetSim)
- **Design tradeoffs**: Perturbation scale (ε) must balance local linearity with numerical stability; probe count (J) affects estimation accuracy; perturbation type (coarse vs aligned) reveals different aspects of internal structure
- **Failure signatures**: Low JetSim with similar risk indicates fundamentally different internal representations; high JetSim with dissimilar risk suggests pipeline issues; sensitive jets indicate perturbation scale problems
- **First 3 experiments**: 1) Linear sanity check: replicate OLS experiment with d=10, verify jet-estimated gradient matches OLS coefficients, 2) Mirage detection: build PCA+logistic pipeline and dense classifier, verify coarse probes show different ranks/low similarity while aligned probes show matching ranks/JetSim≈1.0, 3) Robustness ablation: test MoJet across perturbation scales and probe counts, confirm JetSim and ranks stabilize

## Open Questions the Paper Calls Out

### Open Question 1
Can formal identifiability guarantees be extended from linear two-module pipelines to deep nonlinear networks? The theoretical proof relies on matrix rank arguments specific to linear algebra that do not readily generalize to high-capacity, non-linear activations.

### Open Question 2
What constitutes an optimal perturbation design to maximize the detection of mirage regimes? The experiments show coarse and aligned perturbations yield different similarity scores, but no principle is provided for selecting the best probes.

### Open Question 3
Can Modular Jets be computationally scaled to audit large-scale systems like Large Language Models (LLMs)? The current experiments are deliberately small-scale, and the algorithm may be computationally prohibitive for high-dimensional hidden states and massive parameter counts.

## Limitations
- Core theoretical framework is limited to simplified linear two-module settings
- Extension to deep nonlinear pipelines lacks rigorous generalization guarantees
- Perturbation-based jet estimation relies on local linearity assumptions that may break down near activation boundaries

## Confidence
- **High**: Linear mirage theorem (Theorem 1a) and identifiability result (Theorem 1b) are mathematically rigorous within stated assumptions
- **Medium**: Empirical validation across datasets demonstrates robustness, but theoretical justification for nonlinear cases is limited to local approximations
- **Medium**: Perturbation design recommendations are supported by experiments but lack systematic analysis of coverage and sensitivity

## Next Checks
1. Test MoJet on a multi-module nonlinear pipeline (e.g., 3+ layers) to assess whether jet similarity patterns persist beyond the two-module case
2. Evaluate jet stability under structured noise or adversarial perturbations to quantify robustness to input distribution shifts
3. Compare MoJet with alternative internal representation similarity metrics (e.g., centered kernel alignment) to benchmark diagnostic specificity