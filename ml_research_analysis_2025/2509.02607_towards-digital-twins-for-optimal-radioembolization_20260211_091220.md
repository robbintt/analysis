---
ver: rpa2
title: Towards Digital Twins for Optimal Radioembolization
arxiv_id: '2509.02607'
source_url: https://arxiv.org/abs/2509.02607
tags:
- flow
- radioembolization
- liver
- digital
- microsphere
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: Radioembolization planning is challenged by complex hepatic arterial
  anatomy and uncertainty in microsphere transport, requiring precise patient-specific
  dosimetry. This work proposes a framework for liver digital twins combining high-fidelity
  computational fluid dynamics (CFD) and physics-informed machine learning to predict
  microsphere distribution and optimize treatment planning.
---

# Towards Digital Twins for Optimal Radioembolization

## Quick Facts
- arXiv ID: 2509.02607
- Source URL: https://arxiv.org/abs/2509.02607
- Reference count: 0
- Primary result: Physics-informed machine learning can accelerate radioembolization treatment planning by predicting microsphere distribution in patient-specific hepatic arterial trees

## Executive Summary
Radioembolization planning is challenged by complex hepatic arterial anatomy and uncertainty in microsphere transport, requiring precise patient-specific dosimetry. This work proposes a framework for liver digital twins combining high-fidelity computational fluid dynamics (CFD) and physics-informed machine learning to predict microsphere distribution and optimize treatment planning. While CFD offers accurate modeling, its computational cost limits real-time clinical use. Physics-informed neural networks (PINNs) and generative models (PI-GANs, PI-DMs, transformer-based architectures) accelerate simulations while maintaining physical fidelity and enabling uncertainty-aware predictions. These AI surrogates reduce computational time, support rapid sampling of diverse flow scenarios, and facilitate personalized treatment optimization. Future validation should include rigorous comparisons against CFD and in vivo imaging to ensure clinical reliability.

## Method Summary
The framework combines patient-specific CFD modeling with physics-informed machine learning surrogates. CFD solves Navier-Stokes equations with Lagrangian particle tracing on 3D vascular meshes reconstructed from CBCT/CECT imaging, capturing microsphere transport under patient-specific boundary conditions. Physics-informed neural networks learn to approximate these solutions by embedding governing equations as soft constraints, reducing computational cost from hours to seconds. Generative extensions like PI-GANs and PI-DMs model distributions of physically consistent solutions for uncertainty quantification. Transformer-based architectures enable temporally resolved predictions by capturing sequential dependencies in spatiotemporal flow fields.

## Key Results
- CFD can model patient-specific microsphere transport in hepatic arterial trees with one-way coupling between fluid and particles
- PINNs integrate Navier-Stokes equations into neural network training, enabling mesh-free approximation with reduced computational cost
- Physics-informed generative models (PI-GANs, PI-DMs, transformer-based architectures) enable uncertainty-aware predictions while maintaining physical fidelity

## Why This Works (Mechanism)

### Mechanism 1
- Claim: High-fidelity CFD can model patient-specific microsphere transport in the hepatic arterial tree if provided accurate vascular geometry and boundary conditions.
- Mechanism: Patient-specific 3D vascular meshes reconstructed from CBCT/CECT imaging are discretized and solved using Navier-Stokes equations with particle tracing (one-way or two-way coupling). Velocity fields predict microsphere trajectories, enabling dose distribution estimation for treatment planning.
- Core assumption: Blood flow dynamics captured at imaging resolution (~200-500 µm) adequately represent hemodynamics influencing 20-60 µm microsphere distribution; catheter position effects dominate over unmodeled microsphere-microsphere interactions.
- Evidence anchors:
  - [abstract] "CFD approach involves microsphere transport calculations in the hepatic arterial tree with individual patient data"
  - [section 2.1.4] Equations 1-4 define continuity, Navier-Stokes, and particle motion; one-way coupling assumes "microspheres do not influence the fluid flow"
  - [corpus] Limited direct corpus evidence for radioembolization-specific validation; neighbor paper on coronary artery digital twins supports general physics-informed modeling feasibility
- Break condition: Mesh resolution insufficient to capture flow features at bifurcations near catheter tip; patient-specific boundary conditions unavailable or substantially inaccurate.

### Mechanism 2
- Claim: Physics-informed neural networks (PINNs) can approximate CFD solutions with reduced computational cost by embedding governing equations as soft constraints in the loss function.
- Mechanism: MLP-based networks learn mappings from spatial-temporal coordinates to velocity/pressure fields. Automatic differentiation computes PDE residuals (Navier-Stokes) at collocation points. Loss function combines data terms with physics residual terms, enabling mesh-free training without requiring large labeled datasets.
- Core assumption: PDE residuals at sampled collocation points sufficiently constrain the solution space across the entire domain; network capacity and training dynamics allow convergence to physically valid solutions.
- Evidence anchors:
  - [abstract] "PINNs integrate governing equations, such as the Navier-Stokes equations, directly into the neural network training process, enabling mesh-free, data-efficient approximation"
  - [section 2.2.1] "PINNs treat the problem as a function approximation task...trained to produce outputs that minimize PDE residuals at a finite set of collocation points"
  - [corpus] Neighbor paper "Physics-informed self-supervised learning for coronary artery digital twins" provides supporting evidence for PINN-based vascular flow modeling
- Break condition: Highly irregular patient-specific geometries with complex boundary conditions cause training instability; stochastic dimensions (uncertain parameters) exceed network's representational capacity for uncertainty quantification.

### Mechanism 3
- Claim: Generative AI extensions (PI-GANs, PI-DMs, transformer-based architectures) may enable uncertainty-aware, temporally resolved predictions by modeling distributions of physically consistent solutions.
- Mechanism: PI-GANs use adversarial training with physics-informed loss terms to generate flow field distributions. PI-DMs learn denoising processes conditioned on physics constraints. Transformers (PINNsFormer) capture temporal dependencies via self-attention on pseudo-sequences of spatiotemporal inputs.
- Core assumption: Generative models can learn to sample from the space of physically valid solutions without exhaustive CFD enumeration; latent variable representations capture relevant uncertainty sources (boundary conditions, anatomy variations).
- Evidence anchors:
  - [abstract] "Physics-informed generative adversarial networks (PI-GANs), diffusion models (PI-DMs), and transformer-based architectures further enable uncertainty-aware, temporally resolved predictions"
  - [section 2.2.2-2.2.4] "PI-GANs are explicitly designed to model distributions of solutions"; "PI-DMs exhibit greater training stability"; transformers "explicitly modeling sequential dependencies"
  - [corpus] Weak corpus evidence for clinical validation; paper explicitly states "systematic benchmarks reporting their accuracy and computational performance remain limited"
- Break condition: Mode collapse in GANs fails to capture solution diversity; diffusion model denoising steps remain computationally expensive for real-time use; transformer quadratic attention cost scales poorly with high-resolution 3D domains.

## Foundational Learning

- Concept: **Navier-Stokes equations and incompressible flow**
  - Why needed here: Core physics governing blood flow in the hepatic artery; understanding conservation laws (mass, momentum) is prerequisite for interpreting both CFD solvers and PINN physics constraints.
  - Quick check question: Can you explain why the continuity equation (∇·**u**=0) enforces incompressibility and what physical assumption this makes about blood?

- Concept: **Patient-specific boundary conditions in vascular CFD**
  - Why needed here: Simulation accuracy depends critically on inlet flow rates (from Doppler sonography) and outlet conditions (Windkessel models, zero pressure); poor boundary conditions produce clinically irrelevant results regardless of solver quality.
  - Quick check question: Why might using generic flow waveforms instead of patient-specific measurements lead to incorrect microsphere distribution predictions?

- Concept: **Automatic differentiation in physics-informed learning**
  - Why needed here: PINNs require computing derivatives of network outputs with respect to inputs to evaluate PDE residuals; understanding autodiff distinguishes PINNs from purely data-driven approaches.
  - Quick check question: How does automatic differentiation enable evaluating ∂**u**/∂t and ∇²**u** without explicit mesh-based discretization?

## Architecture Onboarding

- Component map:
  - Imaging pipeline: CBCT/CECT → segmentation (U-Net variants) → 3D surface mesh → volumetric mesh
  - CFD solver: Mesh + boundary conditions + Navier-Stokes equations → velocity/pressure fields → particle tracing → microsphere distribution
  - PINN surrogate: Spatiotemporal coordinates → MLP → velocity/pressure prediction; loss = data_loss + λ₁·boundary_loss + λ₂·PDE_residual_loss
  - Generative extensions: Latent variable z + geometry conditioning → generator → flow field distribution; discriminator (PI-GAN) or denoising network (PI-DM) enforces realism
  - Digital twin loop: Predicted dose distribution → compare to target → update injection parameters → repeat

- Critical path: Accurate 3D vascular reconstruction from patient imaging → correct boundary condition specification → validated CFD baseline (for training/comparison) → trained physics-informed surrogate → optimization over injection locations/activities → dose distribution prediction meeting clinical constraints.

- Design tradeoffs:
  - **CFD vs. PINN**: CFD provides higher fidelity but hours-days compute time; PINNs offer faster inference after training but require CFD data for validation and may sacrifice accuracy on complex geometries
  - **One-way vs. two-way coupling**: One-way simpler, faster; two-way captures microsphere-backflow effects at high concentrations but increases computational complexity
  - **MLP vs. generative architectures**: MLP-based PINNs are deterministic, simpler to train; PI-GANs/PI-DMs capture uncertainty but introduce training instability and require careful tuning

- Failure signatures:
  - Training loss plateaus with high PDE residuals → network capacity insufficient or learning rate too high
  - Generated flow fields violate incompressibility → physics loss weight too low relative to data/adversarial terms
  - Predictions accurate on training geometries but fail on new patients → overfitting to specific anatomical features; need more diverse training data or architecture improvements
  - Microsphere distribution predictions inconsistent with post-treatment imaging → boundary condition mismatch, mesh resolution inadequate, or unmodeled particle interactions

- First 3 experiments:
  1. **Reproduce baseline CFD pipeline**: Take open hepatic artery mesh, apply literature boundary conditions, run Navier-Stokes solver, verify velocity fields match published hemodynamic parameters (WSS, TAWSS).
  2. **Train PINN on single patient geometry**: Implement basic MLP-PINN with Navier-Stokes residuals; compare predicted velocity field against CFD ground truth using relative L² error and pointwise velocity differences at bifurcations.
  3. **Validate surrogate generalization**: Train PINN on 3-5 patient geometries; test on held-out patient; quantify accuracy degradation and identify which anatomical features cause largest errors.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can physics-informed generative models (PI-GANs, PI-DMs) achieve benchmark accuracy comparable to gold-standard CFD across full, patient-specific hepatic arterial trees?
- Basis in paper: [explicit] The authors note that PI-DMs "have not yet been comprehensively benchmarked against gold-standard CFD across full arterial trees" and that "systematic benchmarks reporting their accuracy... remain limited."
- Why unresolved: Most current studies rely on simplified geometries or small domains, rather than the complex, high-resolution meshes required for clinical radioembolization planning.
- What evidence would resolve it: Rigorous error quantification (e.g., relative L2 norms) of AI predictions against high-fidelity CFD results for hemodynamic biomarkers in large patient cohorts.

### Open Question 2
- Question: Do AI-based microsphere distribution predictions correlate with in vivo outcomes, such as post-treatment 90Y PET/CT or 4D flow MRI data?
- Basis in paper: [explicit] The paper explicitly calls for "future validation [to] include... in vivo imaging" and notes that large-scale patient-specific validations are scarce due to limited data availability.
- Why unresolved: Validating these models is difficult due to the lack of high-precision ground truth data; current validation is often restricted to synthetic data or in vitro experiments.
- What evidence would resolve it: Multi-center clinical studies demonstrating quantitative agreement between AI-predicted dose distributions and actual post-treatment imaging.

### Open Question 3
- Question: Can transformer-based PINNs overcome scalability and error accumulation challenges to handle high-dimensional, unsteady blood flow simulations in complex vascular geometries?
- Basis in paper: [inferred] While discussing transformer architectures (e.g., PINNsFormer), the authors state they "struggle with scalability in high-dimensional CFD problems" and "may accumulate errors during long-time rollouts."
- Why unresolved: The quadratic cost of self-attention mechanisms grows prohibitively with the spatial resolution required for detailed arterial trees.
- What evidence would resolve it: Demonstration of stable, accurate flow predictions in high-resolution patient geometries without the computational expense that currently limits clinical application.

## Limitations
- Clinical accuracy claims for microsphere distribution predictions lack quantitative validation against real patient outcomes or post-treatment imaging data
- Physics-informed generative models (PI-GANs, PI-DMs) lack comprehensive benchmarking against gold-standard CFD across full patient-specific hepatic arterial trees
- Boundary condition specification remains challenging, with patient-specific pulsatile flow rates and outlet resistance parameters requiring validation against measured flow data

## Confidence
- **High Confidence**: The fundamental physics (Navier-Stokes equations for incompressible flow) and basic CFD implementation methodology are well-established in the literature and correctly described.
- **Medium Confidence**: The feasibility of PINN surrogates for vascular flow problems is supported by recent work in related domains (coronary arteries), but direct evidence for hepatic arterial flows and microsphere transport is limited.
- **Low Confidence**: Clinical accuracy claims for microsphere distribution predictions and treatment optimization capabilities lack quantitative validation against real patient outcomes or post-treatment imaging data.

## Next Checks
1. **Benchmark Accuracy Against CFD Baseline**: Implement the PINN architecture on a standardized hepatic artery geometry (e.g., from public datasets) and quantitatively compare predicted velocity fields, wall shear stress distributions, and microsphere trajectories against a validated CFD solver across multiple boundary conditions.

2. **Validate Boundary Condition Sensitivity**: Systematically vary patient-specific inlet flow rates (within clinically measured ranges) and outlet resistance parameters to quantify how these uncertainties propagate through both CFD and PINN predictions, identifying which boundary conditions most impact microsphere distribution accuracy.

3. **Cross-Anatomy Generalization Test**: Train physics-informed models on 3-5 patient anatomies with varying complexity (simple bifurcations to tortuous vessels), then evaluate performance on a held-out patient with substantially different vascular geometry to assess true generalization capability beyond interpolation.