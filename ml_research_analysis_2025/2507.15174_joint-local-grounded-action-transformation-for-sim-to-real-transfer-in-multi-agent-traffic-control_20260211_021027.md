---
ver: rpa2
title: Joint-Local Grounded Action Transformation for Sim-to-Real Transfer in Multi-Agent
  Traffic Control
arxiv_id: '2507.15174'
source_url: https://arxiv.org/abs/2507.15174
tags:
- agent
- traffic
- action
- jl-gat
- each
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the sim-to-real gap in multi-agent traffic
  signal control by proposing JL-GAT, which extends Grounded Action Transformation
  (GAT) to multi-agent settings. The method balances scalability and grounding capability
  by incorporating neighboring agents' information through local joint states and
  actions, avoiding the complexity of centralized GAT while capturing essential inter-agent
  interactions.
---

# Joint-Local Grounded Action Transformation for Sim-to-Real Transfer in Multi-Agent Traffic Control

## Quick Facts
- arXiv ID: 2507.15174
- Source URL: https://arxiv.org/abs/2507.15174
- Reference count: 35
- This paper proposes JL-GAT, extending Grounded Action Transformation to multi-agent traffic signal control, significantly reducing the sim-to-real performance gap compared to direct transfer and other GAT variants.

## Executive Summary
This paper addresses the sim-to-real gap in multi-agent traffic signal control by proposing JL-GAT, which extends Grounded Action Transformation (GAT) to multi-agent settings. The method balances scalability and grounding capability by incorporating neighboring agents' information through local joint states and actions, avoiding the complexity of centralized GAT while capturing essential inter-agent interactions. Comprehensive experiments on various road networks under simulated adverse weather conditions show that JL-GAT significantly reduces the sim-to-real performance gap compared to direct transfer and other GAT variants. The cascading invalidation effect, a novel challenge in multi-agent GAT, is identified and mitigated using pattern or probabilistic grounding strategies. JL-GAT with uncertainty quantification further improves performance.

## Method Summary
JL-GAT extends single-agent GAT to multi-agent settings by incorporating neighboring agents' information into forward and inverse models. Each agent maintains local joint states (own state plus neighbors within radius r) and actions. The forward model predicts next observations using these local joint inputs, while the inverse model generates grounded actions considering both local joint observations and predicted next states. Pattern grounding and probabilistic grounding strategies mitigate the cascading invalidation effect where simultaneous grounding of neighboring agents creates invalid action assumptions. The approach trains policies in simulation with grounded actions that better match real-world dynamics, then transfers them to real environments.

## Key Results
- JL-GAT with pattern grounding reduces ATT gap to 144.38 (rainy) and 335.66 (snowy) compared to Direct Transfer at 188.64 and 378.94 respectively
- Incorporating neighboring agent information is critical - removing it degrades performance to Direct Transfer levels
- Probabilistic grounding with p=0.2 outperforms higher probabilities, suggesting sparse grounding is beneficial
- Uncertainty quantification with JL-GAT further reduces the sim-to-real gap by selectively applying grounding based on model confidence

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Incorporating neighboring agents' states and actions into the GAT forward and inverse models improves transition dynamics modeling for sim-to-real transfer in multi-agent settings.
- Mechanism: The forward model $f_{i,\phi^+}$ predicts the next individual observation $\hat{o}_{i,t+1}$ using local joint state $o^L_{i,t}$ and local joint action $a^L_{i,t}$ (Equation 4). The inverse model $h_{i,\phi^-}$ generates grounded actions $\hat{a}^g_{i,t}$ considering both local joint observations and the predicted next state (Equation 6). This captures inter-agent dependencies without centralized overhead.
- Core assumption: The actions of neighboring agents within radius $r$ remain unchanged during each grounding step.
- Evidence anchors:
  - [abstract] "JL-GAT balances scalability and grounding capability by incorporating neighboring agents' information through local joint states and actions"
  - [Section 5.2.3] "Including neighboring agent actions $a_{j,t}$ into the inverse model is invaluable for multi-agent settings, as it allows us to capture local agent interactions"
  - [Table 6] Ablation study shows removing neighbor states/actions from forward/inverse models degrades performance to Direct Transfer levels
- Break condition: If neighboring agents frequently change actions simultaneously, the fixed-action assumption violates and cascading invalidation occurs.

### Mechanism 2
- Claim: Pattern grounding and probabilistic grounding mitigate the cascading invalidation effect unique to multi-agent GAT.
- Mechanism: Pattern grounding restricts which agents can ground actions per epoch (e.g., alternating between agent subsets). Probabilistic grounding applies grounding with probability $P^i_{ground}(t) = p_{ground}$ per agent. Both prevent conflicting grounding assumptions where Agent A assumes Agent B's action is fixed while Agent B simultaneously grounds its action.
- Core assumption: Partial grounding coverage is sufficient to improve dynamics alignment over training epochs.
- Evidence anchors:
  - [abstract] "The cascading invalidation effect, a novel challenge in multi-agent GAT, is identified and mitigated using pattern or probabilistic grounding strategies"
  - [Section 5.3] "If the actions of an agent and one of its neighbors within the predefined radius $r$ are grounded simultaneously, both grounded actions become invalid"
  - [Table 3] Probabilistic grounding with $p=0.2$ outperforms higher probabilities, suggesting sparse grounding is beneficial
- Break condition: If grounding probability is too high (e.g., 0.8), cascading invalidations increase and performance degrades.

### Mechanism 3
- Claim: Integrating uncertainty quantification with JL-GAT further reduces the sim-to-real gap by selectively applying grounding based on model confidence.
- Mechanism: Dynamic grounding rate computes average model uncertainty over previous epochs and uses a threshold to decide whether to ground. High uncertainty triggers fallback to original (non-grounded) actions.
- Core assumption: Model uncertainty correlates with grounding reliability—low uncertainty indicates trustworthy grounded actions.
- Evidence anchors:
  - [Table 4] JL-GAT with uncertainty quantification shows reduced ATT gap (140.26 vs 142.35 in rainy, 335.66 vs 338.20 in snowy)
  - [Section 6.6] "If the agent's predicted uncertainty exceeds a dynamic threshold, the original (non-grounded) action is used instead"
  - [corpus] Related work on uncertainty in RL (Abdar et al., 2021; Gal & Ghahramani, 2016) supports UQ for decision reliability, though not directly tested in multi-agent GAT contexts
- Break condition: If uncertainty estimates are poorly calibrated, the threshold mechanism may skip valid grounding or apply unreliable grounding.

## Foundational Learning

- **Dec-POMDP (Decentralized Partially Observable Markov Decision Process)**
  - Why needed here: The paper formulates multi-agent traffic signal control as a Dec-POMDP where each intersection is an agent with partial observations. Understanding local vs. global state, joint actions, and the coordination problem is essential.
  - Quick check question: Can you explain why each agent only observes $o_{i,t}$ but the environment transitions based on joint action $\mathbf{a}_t$?

- **Grounded Action Transformation (GAT)**
  - Why needed here: JL-GAT extends single-agent GAT. You need to understand how forward models predict real-world next states and inverse models generate simulator actions that produce equivalent outcomes.
  - Quick check question: Given state $s_t$ and action $a_t$, what does the inverse model $h_{\phi^-}$ output and why?

- **Sim-to-Real Gap in RL**
  - Why needed here: The core problem is dynamics mismatch between simulator $E_{sim}$ and real environment $E_{real}$. Understanding why direct policy transfer fails (distribution shift, unmodeled dynamics) motivates the GAT approach.
  - Quick check question: Why doesn't domain randomization alone solve dynamics mismatch for traffic signal control?

## Architecture Onboarding

- **Component map:**
  - Forward model $f_{i,\phi^+}$ -> predicts next observation $\hat{o}_{i,t+1}$ using local joint state $o^L_{i,t}$ and local joint action $a^L_{i,t}$
  - Inverse model $h_{i,\phi^-}$ -> generates grounded action $\hat{a}^g_{i,t}$ using $o^L_{i,t}$, $a^L_{i,t}$, and $\hat{o}_{i,t+1}$
  - Policy network $\pi_{i,\theta}$ -> outputs traffic signal phase action given local observation $o_{i,t}$
  - Grounding controller -> applies pattern/probabilistic logic to determine which agents ground per step

- **Critical path:**
  1. Pre-train policies in $E_{sim}$ for $M$ iterations
  2. Collect trajectories in both $E_{sim}$ and $E_{real}$ (offline or rollouts)
  3. Train forward models on $D_{real}$ (real transition dynamics)
  4. Train inverse models on $D_{sim}$ (simulator transition dynamics)
  5. Execute policy training episodes with grounded actions in $E_{sim}$
  6. Update policies via RL with improved dynamics

- **Design tradeoffs:**
  - **Sensing radius $r$**: Larger $r$ captures more inter-agent dependencies but increases model complexity and cascading invalidation risk. Paper uses Manhattan distance with implicit small $r$ (neighbors shown in 3×3 grid).
  - **Pattern vs. probabilistic grounding**: Pattern guarantees no conflicts but reduces training flexibility. Probabilistic allows emergent patterns but may occasionally conflict.
  - **Centralized vs. decentralized GAT**: Centralized captures global dynamics but doesn't scale (Table 1 shows centralized GAT fails to improve on 4×4 networks). Decentralized scales but ignores interactions.

- **Failure signatures:**
  - **Cascading invalidation**: If agents within radius $r$ ground simultaneously, grounded actions become invalid. Symptom: performance no better than direct transfer.
  - **Forward model overfitting**: If $D_{real}$ is insufficient, forward model predictions diverge. Symptom: high MSE loss on validation trajectories.
  - **Inverse model mode collapse**: If action space is underexplored in $D_{sim}$, inverse model fails to generate diverse grounded actions. Symptom: grounded actions cluster around few phases.

- **First 3 experiments:**
  1. **Reproduce 1×3 rainy environment results**: Train JL-GAT with pattern grounding, compare ATT gap against Direct Transfer and decentralized GAT. Verify Table 1 values (JL-GAT Pattern: 144.38 vs Direct: 188.64).
  2. **Ablation on neighbor information**: Remove neighbor states from forward model, then neighbor actions from inverse model. Confirm performance degrades to near Direct Transfer levels (Table 6).
  3. **Sweep probabilistic grounding rates**: Test $p \in \{0.1, 0.2, 0.3, 0.5, 1/N\}$ on 1×3 rainy. Verify optimal around 0.2 and degradation at 0.8 (Table 3).

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** Can a learned or dynamic grounding strategy outperform the fixed pattern and probabilistic grounding methods in mitigating the cascading invalidation effect?
- **Basis in paper:** [Explicit] The conclusion states, "a promising direction for future work lies in dynamically selecting which agents should engage in GAT and when," and Section 5.3 lists "learned grounding patterns" as an unexplored avenue.
- **Why unresolved:** The current paper evaluates only rigid "pattern grounding" and random "probabilistic grounding," leaving adaptive selection strategies untested.
- **What evidence would resolve it:** Experiments showing that a dynamic policy for selecting grounding agents reduces the sim-to-real gap more effectively than the $1/N$ probabilistic baseline.

### Open Question 2
- **Question:** Do clustering-based or algorithmic grouping approaches provide a more robust solution to the cascading invalidation effect than the proposed methods?
- **Basis in paper:** [Explicit] Section 5.3 explicitly acknowledges "clustering groups for grounding, learned grounding patterns, and algorithmic approaches to grounding" as alternative solutions that "remain to be explored."
- **Why unresolved:** The authors introduce pattern and probabilistic grounding to handle the effect but do not implement or compare these alternative structural approaches.
- **What evidence would resolve it:** A comparative analysis where agents are grouped via clustering algorithms for simultaneous grounding, demonstrating higher stability or convergence speeds than the proposed JL-GAT variants.

### Open Question 3
- **Question:** Does JL-GAT maintain its performance improvements when transferring policies to physical real-world traffic systems rather than surrogate simulations?
- **Basis in paper:** [Inferred] The paper relies on a "sim-to-sim" setup (CityFlow to SUMO) to approximate reality. The authors note this avoids "unexpected behaviors in the real world," implying the method is unproven in physical settings with sensor noise and true human driver behavior.
- **Why unresolved:** While the method aligns transition dynamics between two simulators, it is unclear if the local joint state approximations hold when exposed to the full complexity and noise of physical intersections.
- **What evidence would resolve it:** A field study or hardware-in-the-loop experiment where JL-GAT policies are deployed on physical traffic signal controllers.

## Limitations

- The cascading invalidation effect solution is heuristic without theoretical guarantees
- The fixed-action assumption during grounding steps is a critical simplification that may break in highly dynamic traffic scenarios
- The offline learning setup assumes sufficient real-world data collection is feasible, which may not hold in safety-critical traffic systems

## Confidence

**High confidence**: Incorporating neighboring agent information into GAT models demonstrably improves sim-to-real transfer, supported by systematic ablation studies showing degradation to direct transfer performance when neighbor information is removed.

**Medium confidence**: Pattern and probabilistic grounding show performance improvements, but the analysis doesn't fully characterize the tradeoff between grounding coverage and invalidation rate across diverse traffic patterns.

**Medium confidence**: The ATT gap reduction with uncertainty quantification is observed, but the paper doesn't provide evidence that the uncertainty threshold is well-calibrated or that UQ improves grounding reliability rather than just reducing grounding frequency.

## Next Checks

1. **Cascading invalidation characterization**: Systematically measure the frequency and impact of cascading invalidations across different traffic densities and pattern grounding configurations. Compare performance when different agent subsets are grounded to understand which interactions are most critical.

2. **Uncertainty calibration analysis**: Validate whether model uncertainty actually predicts grounding reliability by computing precision-recall curves for grounded actions above different uncertainty thresholds. Test whether well-calibrated uncertainty improves performance more than simple thresholding.

3. **Sensing radius scalability**: Experiment with varying sensing radii r beyond the implicit 3×3 grid to identify the scaling limits of JL-GAT. Measure computational overhead and performance gains/degradation as r increases to understand the practical neighborhood size constraints.