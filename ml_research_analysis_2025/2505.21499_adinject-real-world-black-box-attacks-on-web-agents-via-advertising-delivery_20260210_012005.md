---
ver: rpa2
title: 'AdInject: Real-World Black-Box Attacks on Web Agents via Advertising Delivery'
arxiv_id: '2505.21499'
source_url: https://arxiv.org/abs/2505.21499
tags:
- agent
- content
- agents
- attack
- arxiv
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents AdInject, a real-world black-box attack method
  targeting Vision-Language Model (VLM) based Web Agents through internet advertising
  delivery. Unlike prior work, AdInject operates under a realistic threat model with
  no access to agent internals, static content constraints, and no knowledge of user
  intent.
---

# AdInject: Real-World Black-Box Attacks on Web Agents via Advertising Delivery

## Quick Facts
- arXiv ID: 2505.21499
- Source URL: https://arxiv.org/abs/2505.21499
- Authors: Haowei Wang; Junjie Wang; Xiaojun Jia; Rupeng Zhang; Mingyang Li; Zhe Liu; Yang Liu; Qing Wang
- Reference count: 40
- Key outcome: Real-world black-box attacks on Vision-Language Model (VLM) based Web Agents through internet advertising delivery, achieving over 60% attack success rates on standard benchmarks.

## Executive Summary
AdInject presents a novel real-world black-box attack method targeting Vision-Language Model (VLM) based Web Agents through internet advertising delivery. Unlike prior work, AdInject operates under a realistic threat model with no access to agent internals, static content constraints, and no knowledge of user intent. The method leverages advertising platforms to inject malicious static content into web pages. Experimental evaluations on VisualWebArena and OSWorld benchmarks demonstrate attack success rates exceeding 60% in most scenarios and approaching 100% in certain cases. The study reveals that prevalent advertising delivery constitutes a potent real-world vector for environment injection attacks against Web Agents, highlighting critical security vulnerabilities that necessitate robust defense mechanisms.

## Method Summary
AdInject introduces a black-box attack framework that exploits internet advertising delivery to compromise Vision-Language Model (VLM) based Web Agents. The attack injects static content (text, images, links) into web pages via advertising platforms without requiring access to agent internals or knowledge of user intent. The method employs a mock ad server using Chrome DevTools Protocol (CDP) to inject HTML/JS into the DOM. AdInject includes strategies for designing deceptive ad content that frames clicking as necessary for task completion, and a VLM-based optimization technique that infers potential user intents from the target website context to make ads appear more relevant. The attack framework was evaluated on VisualWebArena (72 tasks) and OSWorld (43 browser-related tasks) benchmarks, demonstrating significant effectiveness against multiple VLM-based Web Agents.

## Key Results
- Attack Success Rates (ASR) exceeding 60% across most tested scenarios on VisualWebArena and OSWorld benchmarks
- Attack success rates approaching 100% in certain specific cases
- Effectiveness demonstrated across multiple VLM-based Web Agents including GPT-4o and various commercial systems
- The VLM-based optimization strategy significantly improves attack effectiveness by inferring potential user intents from website context

## Why This Works (Mechanism)
The attack works by exploiting the fundamental design of Web Agents that rely on visual and textual cues to make decisions. By injecting deceptive advertisements that appear contextually relevant and necessary for task completion, the attack manipulates the agent's decision-making process. The VLM-based optimization strategy allows the attacker to craft ads that align with potential user intents inferred from the website context, making the malicious content appear legitimate and increasing the likelihood of agent interaction.

## Foundational Learning
- **Vision-Language Models (VLMs)**: AI models that process both visual and textual information simultaneously - needed to understand how Web Agents perceive and interpret web pages; quick check: can the model describe what's in an image and answer questions about it
- **Accessibility Tree**: A hierarchical representation of UI elements that assistive technologies use - needed because Web Agents typically use this to understand page structure; quick check: can you extract all interactive elements from a webpage
- **Chrome DevTools Protocol (CDP)**: A protocol for remotely controlling Chrome/Chromium browsers - needed to inject malicious content into web pages; quick check: can you execute JavaScript in a browser remotely
- **Black-box Attack**: An attack method that doesn't require knowledge of the target system's internal workings - needed to make the attack practical in real-world scenarios; quick check: can you attack a system without seeing its source code
- **Set-of-Marks**: A representation of webpage elements that Web Agents use for navigation - needed to understand how agents identify clickable elements; quick check: can you list all clickable elements on a webpage
- **Mock Ad Server**: A simulated advertising delivery system - needed to test the attack in a controlled environment before real-world deployment; quick check: can you serve HTML content to a browser programmatically

## Architecture Onboarding

**Component Map**: Mock Ad Server -> Chrome Browser -> Accessibility Tree -> Web Agent -> Decision Making

**Critical Path**: The attacker creates deceptive ad content → Ad is injected via CDP into the browser DOM → The Accessibility Tree is updated with new elements → Web Agent processes the updated tree → Agent makes decision based on visual/textual cues → If the agent clicks the ad, attack succeeds

**Design Tradeoffs**: 
- Uses static content only (text/images) to ensure broad compatibility and avoid detection
- Leverages existing advertising infrastructure to make attacks realistic and scalable
- Operates under strict black-box constraints to ensure practical applicability
- Employs VLM-based optimization to improve attack effectiveness without requiring user intent knowledge

**Failure Signatures**: 
- Ad not visible in Accessibility Tree (injection failed or timing issue)
- Agent ignores ad despite visibility (insufficient contextual relevance or poor ad design)
- Task crashes due to CDP injection interfering with page load
- Agent completes task without clicking ad (task solution doesn't require ad interaction)

**First Experiments**:
1. Basic injection test: Inject the default "Close AD" pop-up on a simple webpage and verify it appears in the Accessibility Tree
2. Basic agent test: Run a simple agent (e.g., GPT-4o) on a single VisualWebArena task with the ad injected and observe if it clicks the ad
3. Optimization test: Run the VLM-based intent inference on a homepage screenshot and verify it generates relevant ad text

## Open Questions the Paper Calls Out
None specified in the provided content.

## Limitations
- Attack effectiveness depends on the specific VLM-based Web Agent implementation and its decision-making process
- The study focuses on static content injection, potentially missing other attack vectors
- Real-world deployment faces practical challenges like ad platform restrictions and content filtering
- The VLM-based optimization strategy's effectiveness may vary significantly across different websites and user contexts

## Confidence

**High Confidence**: The core methodology of AdInject, including the mock ad server implementation and the basic attack framework, is well-defined and reproducible. The reported attack success rates on the specified benchmarks are likely accurate within the controlled experimental setup.

**Medium Confidence**: The effectiveness of the VLM-based optimization strategy for refining ad content is moderately supported by the results. However, the generalizability of this approach to diverse real-world scenarios requires further investigation.

**Low Confidence**: The study's implications regarding the severity of the security vulnerability and the potential for widespread exploitation in real-world settings are speculative. More extensive real-world testing and analysis of defense mechanisms are needed to fully assess the practical impact of AdInject.

## Next Checks
1. Benchmark Expansion: Validate the attack's effectiveness on a broader range of Web Agent benchmarks and diverse task types beyond VisualWebArena and OSWorld
2. Real-World Deployment: Conduct experiments in real-world advertising environments (e.g., Google Ads) to assess the practicality and scalability of AdInject attacks
3. Defense Mechanisms: Investigate and evaluate the effectiveness of potential defense mechanisms, such as ad content filtering, agent training, and user awareness programs, in mitigating AdInject attacks