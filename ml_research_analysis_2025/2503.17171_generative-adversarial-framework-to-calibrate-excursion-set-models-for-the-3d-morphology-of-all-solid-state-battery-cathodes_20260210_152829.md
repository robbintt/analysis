---
ver: rpa2
title: Generative adversarial framework to calibrate excursion set models for the
  3D morphology of all-solid-state battery cathodes
arxiv_id: '2503.17171'
source_url: https://arxiv.org/abs/2503.17171
tags:
- data
- random
- image
- materials
- which
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a computational method for generating virtual
  3D morphologies of functional materials using low-parametric stochastic geometry
  models calibrated with 2D microscopy images. The method combines generative adversarial
  networks (GANs) with advanced stochastic geometry models, specifically excursion
  sets of random fields, to address the limitations of both approaches.
---

# Generative adversarial framework to calibrate excursion set models for the 3D morphology of all-solid-state battery cathodes

## Quick Facts
- arXiv ID: 2503.17171
- Source URL: https://arxiv.org/abs/2503.17171
- Reference count: 40
- Primary result: A computational method combining GANs with excursion set models to generate calibrated 3D microstructures of all-solid-state battery cathodes from 2D images.

## Executive Summary
This paper presents a hybrid computational approach for generating 3D virtual morphologies of functional materials, specifically all-solid-state battery cathodes. The method combines the realism of generative adversarial networks (GANs) with the interpretability and systematic tunability of low-parametric excursion set models. By calibrating these models using only 2D microscopy images, the approach enables the generation of parametric digital twins that support systematic exploration of structural scenarios and their macroscopic properties. The framework demonstrates its effectiveness through a calibrated 3D model of ASSB cathodes, showing accurate reproduction of key structural descriptors across all three phases.

## Method Summary
The method employs a hybrid GAN framework where a low-parametric excursion set model serves as the generator, parameterized by covariance functions of Gaussian and chi-squared random fields. The calibration process minimizes a combined loss function incorporating both two-point coverage probability functions (TPPFs) computed via FFT-based convolution and an adversarial loss from a CNN discriminator. A differentiable sigmoid approximation replaces the non-differentiable Heaviside step function to enable gradient flow through the thresholding operation. The isotropic 3D model is calibrated from 2D sections and extended to anisotropic structures via post-hoc coordinate scaling based on directional chord length distributions.

## Key Results
- The combined GAN-TPPF approach generates 3D microstructures that closely match experimental data, with errors below 2% for key structural descriptors (volume fractions, specific surface area, chord length distributions).
- The low-parametric model (70 parameters) successfully captures the complex morphologies while maintaining interpretability for systematic virtual materials testing.
- Post-hoc anisotropic scaling (b_s=0.94) effectively extends the isotropic model to capture the cylindrical anisotropy of pressed cathode materials.
- The calibrated model enables generation of parametric digital twins that support exploration of structural variations and their impact on macroscopic properties.

## Why This Works (Mechanism)

### Mechanism 1: Hybrid Loss Combining Geometric Statistics with Learned Discriminator Features
The discriminator learns to distinguish model realizations from data, implicitly encoding higher-order statistics not captured by pair-correlation metrics alone. These learned features complement explicit geometric constraints in the loss function. The discriminator converges on meaningful morphological features before overfitting to artifacts of early training iterations. Discriminator loss < 0.4 threshold triggers training skip, preventing overfitting.

### Mechanism 2: Differentiable Approximation Enables Gradient Flow Through Discrete Thresholding
Replacing the non-differentiable Heaviside step function with a sigmoid approximation (ν=10) preserves gradient information while maintaining morphological fidelity. The approximation error from soft thresholding does not systematically bias calibrated parameters away from their optimal discrete-model values. ν=10 empirically balances approximation softness against gradient preservation.

### Mechanism 3: Stereological Calibration with Post-Hoc Anisotropy Correction
An isotropic 3D model calibrated from 2D sections can be extended to anisotropic structures via coordinate scaling derived from directional chord length distributions. Under cylindrical isotropy assumption, 2D x-y plane sections capture the isotropic statistics. The material exhibits cylindrical isotropy (isotropic in x-y plane, potentially different in z), which holds for uniaxially pressed cathode materials. Simple z-scaling is insufficient for materials with more complex anisotropy.

## Foundational Learning

- **Gaussian Random Fields and Covariance Functions**
  - Why needed: The excursion set model builds on GRFs as base structures; covariance functions determine spatial correlation structure and must be parameterized.
  - Quick check: Given a kernel k(t), can you compute the covariance function ρ(s,t) for the resulting GRF? (Answer: ρ = k * k_mirrored)

- **GAN Training Dynamics and Mode Collapse**
  - Why needed: The discriminator-generator minmax optimization can fail if balance is lost; discriminator may overfit or provide uninformative gradients.
  - Quick check: Why does the algorithm skip discriminator training when loss_D < 0.4? (Answer: Prevents discriminator from becoming too strong relative to generator)

- **Monte Carlo Gradient Estimation**
  - Why needed: Two-point coverage probabilities for complex models lack closed-form solutions; Monte Carlo sampling with batch size 32 approximates expectations.
  - Quick check: Why does the loss function use multiple independent realizations per batch rather than a single sample? (Answer: Reduce variance of gradient estimates)

## Architecture Onboarding

- **Component map:** Parameter vector θ (505 dims for high-parametric, 70 for low-parametric) → Kernels kα via Eq. (11) → Random field realizations (5 GRFs: X, Y, ẽX, ẽY, ẽZ) via Eq. (5) FFT convolution → χ²-fields X', Y' via Eq. (16) → Excursion sets Ξ1, Ξ2, Ξ3 via Eq. (20) → Approximative model ƐΞθ via Eq. (32) sigmoid → Estimated TPPFs Ĉij,θ via Eq. (24) → Combined loss via Eq. (37)

- **Critical path:** Initialize θ with Gaussian noise → Pre-train generator for 100 steps using TPPF-only loss → Pre-train discriminator for 100 steps → Alternate generator/discriminator training with combined loss until early stopping (no improvement in volume fraction/surface area error for 500 epochs)

- **Design tradeoffs:** High-parametric (p=505) vs Low-parametric (p=70): High-parametric achieves better fit but parameters are uninterpretable; low-parametric enables systematic virtual materials testing. TPPF-only vs Combined loss: TPPF-only produces overly rough phase boundaries; combined loss yields visually realistic structures. 2D calibration vs 3D calibration: 2D is computationally cheaper but requires isotropy assumption.

- **Failure signatures:** Rough/irregular phase boundaries → TPPF-only calibration without discriminator guidance. Large visual discrepancy from training data → Pure GAN calibration with discriminator-generator imbalance. Poor match to solid electrolyte descriptors in 3D → Low-parametric covariance family too restrictive for this phase. Discriminator loss stuck near 0.5 → Learning rate imbalance between generator and discriminator.

- **First 3 experiments:**
  1. Ablation on loss components: Train with TPPF-only, discriminator-only, and combined loss on same 2D data; compare volume fractions, specific surface area, and chord length distributions to quantify improvement from hybrid approach.
  2. Parameter sensitivity analysis: Systematically perturb individual parameters of the low-parametric model ΞALP within ±10% of calibrated values; measure impact on structural descriptors to identify which parameters control which morphological features.
  3. Cross-scale validation: Generate 3D microstructures at different sampling window sizes; verify that structural descriptors are scale-invariant (confirming stationarity assumption) and that computational cost scales as expected with domain size.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** How do systematic perturbations to the fitted parameters influence the generated 3D morphologies and the effective macroscopic properties of all-solid-state battery (ASSB) cathodes?
- **Basis in paper:** [explicit] The conclusion states that future research will "investigate how perturbations to fitted parameters influence the structure of generated 3D morphologies" to derive structure-property relationships.
- **Why unresolved:** The current study focuses on the development and validation of the calibration framework (the "digital twin") rather than exploring the parameter space or simulating macroscopic properties like ionic conductivity.
- **What evidence would resolve it:** A study correlating specific variations in the parameter vector θ with simulated performance metrics (e.g., tortuosity, conductivity) generated from the resulting morphologies.

### Open Question 2
- **Question:** Can the current parametric model be calibrated to accurately represent ASSB cathode materials manufactured with differently sized solid electrolyte particles?
- **Basis in paper:** [explicit] The authors state an intention to "calibrate the parametric digital twin using additional image data of ASSB cathode materials with differently sized solid electrolyte particles" to identify additional parameters in the model's space.
- **Why unresolved:** The current calibration relies on a dataset derived from a specific manufacturing process (comminuted particles), and the model's capacity to generalize to different particle size distributions without structural changes to the random fields is unproven.
- **What evidence would resolve it:** Successful calibration of the model to new image datasets with distinct particle size distributions, resulting in parameter vectors that reflect the structural changes.

### Open Question 3
- **Question:** Can the deviation in structural descriptors for the solid electrolyte phase be reduced by modifying the parametric family of covariance functions?
- **Basis in paper:** [inferred] The discussion notes that errors in the solid electrolyte descriptors (Table 2) presumably stem from "model assumptions on covariance functions in Eq. (38)" used to create the low-parametric model.
- **Why unresolved:** The chosen parametric family (Eq. 38) may be insufficiently flexible to capture the specific correlation structure of the solid electrolyte phase compared to the high-parametric model.
- **What evidence would resolve it:** Recalibrating the model using alternative or more complex parametric covariance families and observing a statistically significant reduction in the error for electrolyte chord length and specific surface area.

## Limitations
- The current approach assumes cylindrical isotropy, limiting its applicability to materials with more complex anisotropic structures.
- Errors in solid electrolyte phase descriptors suggest the parametric covariance family may be too restrictive for this phase.
- The method requires 2D microscopy images with sufficient quality and coverage to capture representative structural statistics.

## Confidence
High: Core calibration framework combining GANs with excursion set models is methodologically sound and demonstrates effectiveness through quantitative validation.
Medium: Generalization to different manufacturing processes and particle size distributions remains to be demonstrated.
Low: Long-term effectiveness for structure-property relationship exploration has not yet been validated through systematic parameter perturbation studies.

## Next Checks
1. Verify that the combined loss function with γ=1.0 achieves the reported <2% error in structural descriptors compared to pure TPPF or pure adversarial approaches.
2. Confirm that the sigmoid approximation with ν=10 successfully preserves gradient information through the excursion set thresholding operation.
3. Validate that the post-hoc anisotropic scaling (b_s=0.94) accurately captures the cylindrical anisotropy of pressed cathode materials by comparing 3D chord length distributions before and after scaling.