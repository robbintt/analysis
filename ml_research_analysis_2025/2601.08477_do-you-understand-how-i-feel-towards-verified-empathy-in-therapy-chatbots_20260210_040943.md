---
ver: rpa2
title: 'Do You Understand How I Feel?: Towards Verified Empathy in Therapy Chatbots'
arxiv_id: '2601.08477'
source_url: https://arxiv.org/abs/2601.08477
tags:
- dialogue
- empathy
- formal
- therapy
- language
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a framework integrating natural language processing
  and formal verification to engineer empathetic therapy chatbots. The approach combines
  dialogue analysis with formal modeling via Stochastic Hybrid Automata (SHA) to capture
  therapy dynamics and verify empathy-related properties using Statistical Model Checking.
---

# Do You Understand How I Feel?: Towards Verified Empathy in Therapy Chatbots

## Quick Facts
- arXiv ID: 2601.08477
- Source URL: https://arxiv.org/abs/2601.08477
- Reference count: 40
- One-line primary result: A framework integrating NLP and formal verification enables engineering of empathetic therapy chatbots with verified empathy properties.

## Executive Summary
This paper presents a novel framework for engineering empathetic therapy chatbots by combining natural language processing with formal verification. The approach extracts dialogue features from therapy data using a Transformer model, translates these into a Stochastic Hybrid Automaton (SHA) model, and verifies empathy-related properties using Statistical Model Checking. The framework evaluates three dialogue strategies (random, data-driven, and valence-maximizing) against MITL-specified empathy requirements, demonstrating that formal verification can guide the synthesis of empathetic dialogue strategies.

## Method Summary
The method involves fine-tuning a Transformer language model on therapy dialogues to extract dialogue phases, acts, and emotional states from the MEMO corpus. These features are translated into a Stochastic Hybrid Automaton where locations represent dialogue phases, edges represent dialogue acts with probability weights derived from training frequencies, and valence dynamics are modeled as continuous variables following phase-specific ODEs. Three dialogue strategies are synthesized and evaluated through Statistical Model Checking in UPPAAL, computing the probability of satisfying three MITL-specified empathy requirements regarding sympathetic reasoning, positive session endings, and sustained positive emotional states.

## Key Results
- The SHA model captures therapy dynamics with good fidelity, achieving reasonable transition probability predictions on test data
- High Valence strategy improves probability of satisfying sustained positivity requirement (REQ3) compared to baseline approaches
- Mixed results for session-ending positivity (REQ2), with High Valence underperforming Data-driven strategy
- Formal verification successfully computes probability bounds for empathy-related properties expressed in Metric Interval Temporal Logic

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Transformer-extracted dialogue features can populate a formal SHA model that captures therapy dynamics with sufficient fidelity for downstream verification
- Mechanism: A fine-tuned Transformer classifies dialogue acts and phases from the MEMO corpus; these labels map directly to SHA locations (phases) and edge events (acts). Transition probabilities are computed as relative frequencies from training data. Utterance durations from IEMOCAP define phase timing invariants
- Core assumption: The discrete-phase, act-based structure of therapy dialogue generalizes from training corpus to new sessions
- Evidence anchors: [abstract] "A Transformer-based model extracts dialogue features, which are then translated into a Stochastic Hybrid Automaton model"; [Section 3.1] "we synthesised a formal model starting from the dialogue stages and dialogue acts labelled in the MEMO corpus"

### Mechanism 2
- Claim: Stochastic Hybrid Automata with valence dynamics enable Statistical Model Checking of empathy-related properties expressed in MITL
- Mechanism: Each speaker has an SHA with continuous valence variable V governed by phase-specific ODEs (flow conditions). MITL properties like `P_M(♢≤τ patient.V > V_min)` are evaluated via Monte Carlo simulation over the SHA network, yielding probability bounds
- Core assumption: Valence evolution within a phase can be modeled as a deterministic function of time (or simple ODE), and this abstraction preserves the properties of interest
- Evidence anchors: [abstract] "Empathy-related properties can then be verified through Statistical Model Checking"; [Section 2.2] "Emotional status uses a dimensional notation... The dynamics of valence (variable V) in a phase follows flow condition f(t)"

### Mechanism 3
- Claim: Strategy synthesis selecting dialogue acts that maximize patient valence improves the probability of satisfying empathy requirements compared to random or purely data-driven strategies
- Mechanism: Three strategies resolve the SHA's probabilistic choices: (1) Random—uniform act selection; (2) Data-driven—select acts by empirical training frequencies; (3) High Valence—select acts yielding highest expected valence improvement per phase. SMC computes probability of three MITL-specified empathy requirements under each strategy
- Core assumption: Maximizing immediate valence improvement correlates with satisfying broader empathy requirements (reachability of sympathetic reasoning, positive session end, sustained positive state)
- Evidence anchors: [abstract] "ad-hoc strategies improve the probability of satisfying empathy requirements"; [Section 3.2, Table 1] REQ3 (sustained positivity): High Valence [0.9112, 0.9872] exceeds both baselines

## Foundational Learning

- **Stochastic Hybrid Automata (SHA)**:
  - Why needed here: SHA unify discrete event systems (dialogue acts triggering phase transitions) with continuous dynamics (valence evolving over time per phase). Standard automata cannot represent both
  - Quick check question: Can you explain why a committed location (no time elapse) is needed after each dialogue act edge?

- **Statistical Model Checking (SMC)**:
  - Why needed here: Exact probabilistic verification over continuous-valued SHA is intractable; SMC estimates probability bounds via simulation, making verification feasible for empathy properties
  - Quick check question: What is the difference between SMC returning `[0.74, 0.84]` vs. returning `0.79` for a property?

- **Metric Interval Temporal Logic (MITL)**:
  - Why needed here: Empathy requirements involve time-bounded properties (e.g., "within τ time units, the patient reaches a positive state"). MITL provides the formal syntax for these
  - Quick check question: How does `♢≤τ ψ` differ semantically from `□≤τ ψ`?

## Architecture Onboarding

- **Component map**: Dialogue Corpus (MEMO, IEMOCAP) -> Transformer Annotation Model -> SHA Generator -> UPPAAL SMC -> Strategy Synthesizer -> In-Context Learning Interface (envisioned)
- **Critical path**: Dialogue feature extraction quality -> SHA model fidelity -> verification validity. If the Transformer misclassifies phases or acts, all downstream probability estimates are compromised
- **Design tradeoffs**: Model granularity (more phases/acts capture finer dynamics but increase state space and parameter estimation variance); Valence model complexity (simple ODEs enable verification but may miss patient-specific emotional trajectories); Strategy objectives (pure valence maximization vs. clinically-informed multi-objective)
- **Failure signatures**: Low model fidelity (empirical transition frequencies from test data fall outside SMC confidence bounds); Strategy underperforms baseline (valence-maximizing strategy yields lower requirement satisfaction than random); Verification infeasible (SMC simulation runs exceed time budget)
- **First 3 experiments**: 1) Reproduce transition probability validation (train on MEMO training split, generate SHA, compare predicted vs. empirical transition probabilities on test split); 2) Ablate strategy components (run SMC with each strategy disabled to isolate contribution of valence lookahead); 3) Stress-test valence dynamics (replace phase-specific ODEs with alternative models and measure sensitivity of REQ2/REQ3 probabilities)

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: How can the strategy synthesis objective function be enhanced to capture complex empathy mechanisms (e.g., interpretation, exploration) beyond simple valence maximization?
- **Basis in paper**: [explicit] Section 4 states that "only optimising the cumulative variation of valence... may not be the only objective," and proposes defining a "better objective function based on models extracted from EPITOME"
- **Why unresolved**: The current preliminary study only tested a "High Valence" strategy, which the authors admit may not fully reflect the multi-faceted nature of therapist objectives
- **What evidence would resolve it**: A comparative evaluation of strategies synthesized using EPITOME-based metrics versus the current valence-only approach, showing higher satisfaction rates for complex empathy requirements

### Open Question 2
- **Question**: Can the verified formal strategies effectively guide Large Language Models (LLMs) to generate clinically appropriate responses via in-context learning?
- **Basis in paper**: [explicit] Section 4 outlines the plan to "complete our framework by implementing a module that generates suggested responses based on the empathetic strategy predictions"
- **Why unresolved**: The current prototype stops at strategy synthesis and verification; the actual feedback loop to constrain LLM generation using these strategies has not been implemented
- **What evidence would resolve it**: A functioning pipeline where synthesized SHA strategies successfully prompt an LLM to select dialogue acts that satisfy the verified empathy requirements in real-time

### Open Question 3
- **Question**: Does the Stochastic Hybrid Automaton (SHA) model maintain fidelity when scaling to diverse or unseen therapeutic contexts outside the MEMO corpus?
- **Basis in paper**: [inferred] Section 3 notes the model is "simple" and relies on transition probabilities mined specifically from the MEMO corpus and IEMOCAP
- **Why unresolved**: It is unclear if the extracted probability weights and flow conditions generalize to different therapy modalities, patient demographics, or conversational styles
- **What evidence would resolve it**: Cross-validation results showing the model's transition predictions align with empirical data from external, diverse therapy datasets

## Limitations
- The framework assumes therapy dialogue dynamics are sufficiently captured by the MEMO corpus's discrete phase and act vocabulary; real-world deviations compromise SHA reliability
- Valence dynamics are modeled as deterministic ODEs per phase, ignoring patient-specific or session-specific factors that may not generalize to diverse therapeutic contexts
- Limited empirical corpus support for the NLP-to-SHA translation; most related work focuses on LLM therapy delivery, not formal verification

## Confidence
- **High**: Transformer-based feature extraction populates SHA with reasonable fidelity (validated by transition probability comparisons)
- **Medium**: SHA with valence dynamics enables meaningful SMC of empathy properties (novel approach, but valence modeling assumptions untested in clinical settings)
- **Low**: Strategy synthesis reliably improves empathy satisfaction (positive results for REQ3 but mixed for REQ2; clinical impact unestablished)

## Next Checks
1. **Cross-corpus validation**: Apply the SHA model trained on MEMO to an independent therapy corpus; compare predicted vs. empirical transition probabilities and property satisfaction rates
2. **Clinical outcome correlation**: Run the three strategies in a pilot deployment with actual therapy sessions; measure not only MITL property satisfaction but also clinician-assessed empathy and patient-reported outcomes
3. **Ablation of valence model complexity**: Replace the current ODE-based valence dynamics with a learned, patient-specific model (if data permits); quantify sensitivity of REQ2/REQ3 probabilities to this change