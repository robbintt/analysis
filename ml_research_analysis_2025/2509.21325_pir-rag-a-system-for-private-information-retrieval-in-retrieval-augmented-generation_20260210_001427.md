---
ver: rpa2
title: 'PIR-RAG: A System for Private Information Retrieval in Retrieval-Augmented
  Generation'
arxiv_id: '2509.21325'
source_url: https://arxiv.org/abs/2509.21325
tags:
- pir-rag
- private
- retrieval
- system
- systems
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: PIR-RAG addresses the privacy risks in Retrieval-Augmented Generation
  (RAG) systems, where user queries are exposed to service providers during document
  retrieval. The system introduces a novel architecture that combines coarse-grained
  semantic clustering with a fast, lattice-based Private Information Retrieval (PIR)
  protocol.
---

# PIR-RAG: A System for Private Information Retrieval in Retrieval-Augmented Generation

## Quick Facts
- arXiv ID: 2509.21325
- Source URL: https://arxiv.org/abs/2509.21325
- Reference count: 11
- Key outcome: Achieves 0.799 NDCG@10 with 16.84s end-to-end query time using a clustering + batched PIR architecture

## Executive Summary
PIR-RAG addresses privacy vulnerabilities in Retrieval-Augmented Generation systems by preventing service providers from learning which documents users query. The system introduces a novel architecture that combines coarse-grained semantic clustering with a fast, lattice-based Private Information Retrieval protocol. By organizing documents into clusters and retrieving entire clusters in single batched operations, PIR-RAG uniquely optimizes for the RAG workflow requirement of fetching full document content rather than individual passages. The system demonstrates competitive search quality (0.799 NDCG@10) while achieving practical end-to-end latency of 16.84 seconds.

## Method Summary
PIR-RAG operates through a three-phase process: First, during indexing, document embeddings are clustered using K-means and organized into a chunk-transposed matrix structure where rows represent document chunks and columns represent clusters. Second, at query time, the client computes the nearest cluster centroid, encrypts a one-hot vector identifying that cluster, and sends it to the server. Third, the server performs homomorphic matrix-vector multiplication using an LWE-based Linearly Homomorphic Encryption scheme to return the entire target cluster's content in one batched response. This design enables efficient retrieval of complete documents while maintaining query privacy through semantic clustering and homomorphic computation.

## Key Results
- Achieves 0.799 NDCG@10 search quality on MS MARCO
- Demonstrates 16.84-second end-to-end "RAG-Ready Latency"
- Outperforms baseline architectures when considering full document retrieval workflow
- Shows communication costs between 47MB and 474MB depending on cluster size
- Validates scalability on both MS MARCO and SIFT1M datasets

## Why This Works (Mechanism)
PIR-RAG's effectiveness stems from aligning its cryptographic architecture with the specific requirements of RAG systems. Traditional PIR schemes retrieve individual documents or passages, but RAG systems need complete document context for LLM inference. By clustering semantically similar documents and retrieving entire clusters through batched homomorphic operations, PIR-RAG minimizes the number of cryptographic operations while satisfying RAG's content requirements. The semantic clustering provides an additional privacy layer by obscuring individual document boundaries within clusters, while the lattice-based homomorphic encryption ensures the server cannot learn which cluster was queried.

## Foundational Learning
**Semantic Clustering** - Documents are grouped by semantic similarity using K-means on embeddings. Why needed: Reduces the number of PIR operations from document-level to cluster-level, dramatically improving efficiency. Quick check: Verify cluster purity by measuring intra-cluster similarity scores.

**Chunk-Transposed Matrix Format** - Database organized as rows of document chunks and columns of clusters. Why needed: Enables efficient homomorphic matrix-vector multiplication for batched cluster retrieval. Quick check: Confirm matrix dimensions match (chunks per cluster) × (number of clusters).

**Linearly Homomorphic Encryption (LWE-based)** - Supports homomorphic addition and limited multiplication operations. Why needed: Allows server to compute cluster retrieval without decrypting the query. Quick check: Validate that encrypted one-hot vectors produce correct plaintext cluster outputs after homomorphic multiplication.

**RAG-Ready Latency Metric** - End-to-end time including encryption, server computation, decryption, and local re-ranking. Why needed: Captures the true user experience rather than just retrieval time. Quick check: Measure each component's contribution to total latency.

## Architecture Onboarding

**Component Map:** Client -> Semantic Encoder -> Homomorphic Encryption -> Server -> LWE-based Computation -> Cluster Content -> Client Decryption -> Re-ranking

**Critical Path:** Query embedding → Cluster identification → One-hot vector encryption → Server-side homomorphic matrix-vector multiplication → Cluster content retrieval → Client-side decryption and re-ranking

**Design Tradeoffs:** The system trades some search precision (0.799 NDCG@10 vs 0.901 for graph-based methods) for significant latency improvements and practical scalability. Coarse-grained clustering provides privacy but may reduce retrieval accuracy compared to fine-grained document-level selection.

**Failure Signatures:** High memory consumption during matrix-vector multiplication indicates improper matrix dimensions; communication costs outside the 47-474MB range suggest incorrect cluster sizing; search quality below 0.799 NDCG@10 may indicate poor clustering parameters.

**First Experiments:** 1) Measure encryption/decryption times for different vector sizes to establish baseline overhead; 2) Test homomorphic multiplication accuracy with varying LWE parameters; 3) Evaluate cluster quality by measuring intra-cluster document similarity scores.

## Open Questions the Paper Calls Out
**Open Question 1:** Can the search quality of the "cluster-and-fetch" architecture be improved to rival graph-based methods like PACMANN without sacrificing end-to-end latency? The evaluation shows Graph-PIR achieves 0.901 NDCG@10 while PIR-RAG achieves 0.799 NDCG@10. This accuracy gap represents a design trade-off that hasn't been explored through mechanisms like overlapping clusters.

**Open Question 2:** How can PIR-RAG efficiently support dynamic document corpora without requiring full recomputation of the chunk-transposed database? The system relies on static matrix structure for homomorphic operations, and the paper doesn't discuss handling streaming data or deletions.

**Open Question 3:** Can the protocol be extended to guarantee privacy against malicious servers that may tamper with the database or computation? The current system lacks mechanisms to verify correct matrix-vector multiplication execution on authentic database state.

## Limitations
- Limited parameter specification for cryptographic parameters (LWE dimension, modulus, error distribution) and clustering configurations
- Security claims lack formal analysis and threat model discussion
- Evaluation scope limited to MS MARCO and SIFT1M datasets without addressing document updates or multi-user concurrency

## Confidence
**High confidence:** The core architectural innovation of combining semantic clustering with batched PIR operations is sound and technically feasible, with well-demonstrated performance improvements for the specific evaluation setup.

**Medium confidence:** The claimed "RAG-Ready Latency" of 16.84 seconds represents meaningful improvement, but this metric is highly sensitive to implementation choices and hardware configurations not fully specified.

**Low confidence:** Security guarantees and privacy claims lack formal verification, making the actual privacy protection offered by the system uncertain without a detailed threat model or security proof.

## Next Checks
1. **Parameter exploration:** Systematically vary the number of clusters and chunk size to understand their impact on performance, communication costs, and retrieval quality, establishing operational boundaries.

2. **Security formalization:** Develop a formal security model for PIR-RAG including threat assumptions and privacy guarantees, conducting experiments to test semantic clustering's effectiveness against inference attacks.

3. **Cross-dataset validation:** Evaluate the system on additional document collections with different characteristics (varying document lengths, update frequencies, and semantic structures) to assess generalizability beyond MS MARCO and SIFT1M.