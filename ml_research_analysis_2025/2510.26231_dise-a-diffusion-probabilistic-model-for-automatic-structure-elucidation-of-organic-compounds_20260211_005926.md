---
ver: rpa2
title: 'DiSE: A diffusion probabilistic model for automatic structure elucidation
  of organic compounds'
arxiv_id: '2510.26231'
source_url: https://arxiv.org/abs/2510.26231
tags:
- dise
- structure
- molecular
- shifts
- elucidation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "DiSE is an end-to-end diffusion-based generative model that automatically\
  \ elucidates organic compound structures from MS, \xB9\xB3C and \xB9H NMR, HSQC,\
  \ and COSY spectra. It uses a graph transformer architecture to learn spectrum-structure\
  \ correlations and generate molecular graphs via iterative denoising."
---

# DiSE: A diffusion probabilistic model for automatic structure elucidation of organic compounds

## Quick Facts
- arXiv ID: 2510.26231
- Source URL: https://arxiv.org/abs/2510.26231
- Reference count: 0
- DiSE achieves 92.76% Top-1 accuracy on QM9-NMR dataset for automatic structure elucidation

## Executive Summary
DiSE is an end-to-end diffusion-based generative model that automatically elucidates organic compound structures from MS, ¹³C and ¹H NMR, HSQC, and COSY spectra. It uses a graph transformer architecture to learn spectrum-structure correlations and generate molecular graphs via iterative denoising. On the QM9-NMR dataset, DiSE achieved Top-1 and Top-3 accuracies of 92.76% and 96.78%, outperforming prior models. On PCQM4Mv2-NMR, it reached 92.11% and 96.41% Top-1 and Top-3 accuracy. For 45 molecules with experimental shifts, DiSE correctly identified 84.4% at Top-1 and 93.3% at Top-5.

## Method Summary
DiSE employs discrete diffusion with 500 steps using a cosine-annealed schedule to generate molecular graphs from spectroscopic data. The Graph Transformer model has 20 residual blocks with 32 attention heads, processing node features (element type, chemical shifts, cycles, λ, valence, charge) and edge features (bond types, COSY correlations). The model is trained on QM9-NMR and PCQM4Mv2-NMR datasets with calculated NMR shifts, using cross-entropy loss on edge-type predictions. During inference, 100 independent samples are generated per molecule and ranked by frequency.

## Key Results
- QM9-NMR: 92.76% Top-1 accuracy, 96.78% Top-3 accuracy
- PCQM4Mv2-NMR: 92.11% Top-1 accuracy, 96.41% Top-3 accuracy
- Experimental validation: 84.4% Top-1 accuracy on 45 molecules
- Natural products: 63.6% Top-10 accuracy on 11 molecules

## Why This Works (Mechanism)
DiSE works by learning the joint distribution of molecular graphs and their associated NMR spectra through a diffusion process. The model learns to reverse a noising process, starting from a prior edge distribution and iteratively refining the molecular structure by predicting the original edge types from noisy observations. The Graph Transformer architecture captures complex dependencies between spectral features and molecular topology, enabling accurate structure generation even with partial spectral information.

## Foundational Learning
- **Discrete diffusion processes**: Required to understand the iterative denoising mechanism that generates molecular structures
  - Why needed: Core mechanism for structure generation from noisy spectral data
  - Quick check: Verify understanding of forward noising (q) and reverse process (p) transitions
- **Graph neural networks**: Essential for processing molecular structures as graphs with node and edge features
  - Why needed: Backbone architecture for learning spectrum-structure correlations
  - Quick check: Confirm knowledge of node/edge feature propagation in GNNs
- **Graph transformer attention**: Critical for capturing long-range dependencies in molecular graphs
  - Why needed: Enables modeling of complex structural patterns beyond local neighborhoods
  - Quick check: Verify understanding of multi-head self-attention in graph contexts
- **NMR spectral interpretation**: Necessary for understanding input features and their relationship to molecular structure
  - Why needed: Determines quality of node features (chemical shifts, correlations)
  - Quick check: Confirm ability to interpret HSQC/COSY patterns from calculated shifts

## Architecture Onboarding

**Component map:**
Spectroscopic inputs → Graph representation → Discrete diffusion process → Graph Transformer → Edge prediction → Molecular graph generation

**Critical path:**
Graph representation construction → Diffusion forward process (noising) → Graph Transformer denoising → Edge prediction → Molecular graph assembly

**Design tradeoffs:**
The model prioritizes accuracy over speed by using 500 diffusion steps and 20 residual blocks, trading computational efficiency for higher Top-K accuracy. The choice of discrete diffusion over continuous allows for exact sampling from categorical edge distributions.

**Failure signatures:**
- Invalid molecular graphs (valence violations, disconnected components)
- Systematic failures on heteroatom-rich molecules
- Overfitting to training distribution (low accuracy on natural products)

**First experiments:**
1. Validate Graph Transformer implementation by reproducing attention patterns on synthetic molecular graphs
2. Test discrete diffusion implementation by verifying reverse process accuracy on noised molecular graphs
3. Evaluate spectrum-structure correlation learning by measuring feature importance on validation set

## Open Questions the Paper Calls Out

**Open Question 1:** Can the DiSE framework be extended to resolve stereochemistry, such as distinguishing between diastereomers, directly within the diffusion process?
- Basis in paper: [explicit] The authors state in the conclusion, "Finally, DiSE does not yet resolve stereochemistry. Integrating external methods (e.g., SVM-M, DP4) could enable diastereomer discrimination..."
- Why unresolved: The current implementation models molecules as 2D graphs using connectivity data (COSY/HSQC) but lacks features to describe 3D spatial arrangements or coupling constants required for chirality determination.
- What evidence would resolve it: A modified DiSE model that incorporates stereochemical descriptors or relevant spectral data (e.g., NOESY, ROESY, or J-couplings) and successfully differentiates isomers in a benchmark set of chiral molecules.

**Open Question 2:** Does the integration of vibrational spectroscopy (IR/Raman) effectively resolve the "silent node" problem for heteroatoms (O, N) where NMR provides limited direct information?
- Basis in paper: [explicit] The authors note, "Incorporating heteroatom-specific information, such as IR and Raman spectra, into future model will likely improve performance" regarding the difficulty of resolving heteroatom-rich compounds.
- Why unresolved: In the current framework, heteroatoms are "silent nodes" because standard NMR inputs (HSQC, COSY) focus on the hydrogen-bonded carbon skeleton, forcing the model to infer heteroatom connectivity indirectly.
- What evidence would resolve it: Training a DiSE variant with IR/Raman embeddings and demonstrating significantly higher Top-1 accuracy on heteroatom-dense molecules (high nSPS) compared to the NMR-only baseline.

**Open Question 3:** Can incorporating long-range heteronuclear correlations (HMBC) overcome the limitations in resolving molecules with complex topological structures?
- Basis in paper: [explicit] The paper concludes, "Integrating additional spectral modalities, such as heteronuclear multiple bond coherence (HMBC) may improve performance in these cases."
- Why unresolved: The current model relies on COSY edges ($E_{COSY}$), which detect only vicinal proton-proton couplings. This creates ambiguity in fragments linked by quaternary carbons or heteroatoms where no vicinal coupling exists.
- What evidence would resolve it: A comparative study showing that adding HMBC-derived edge features improves the elucidation accuracy for molecules with long-range connectivities or macrocyclic structures that currently cause failures.

## Limitations
- Graph Transformer architecture details remain underspecified, particularly attention formulation and FFN layer configurations
- Method for reconstructing 2D NMR correlations from 1D chemical shift predictions is described but not algorithmically detailed
- Validation on experimental data is limited to 45 molecules with calculated shifts, with no direct experimental NMR validation reported

## Confidence
- QM9/PCQM4Mv2 benchmark results: **High** - Multiple runs, large test sets, consistent Top-K metrics reported
- Experimental structure elucidation: **Medium** - Limited sample size (45 molecules), calculated shifts used rather than experimental data
- Algorithm reproducibility: **Low** - Critical architectural details and NMR correlation generation methods not fully specified

## Next Checks
1. Implement RDKit-based sanitization of generated molecules and measure invalid structure rates across different heteroatom compositions to verify valence constraint handling
2. Reconstruct COSY correlations from calculated 1H shifts using the described connectivity rules and validate against published QM9-HSQC patterns to ensure 2D spectrum generation fidelity
3. Train on 10% subset of PCQM4Mv2-NMR and compare Top-K accuracy against reported benchmarks to verify implementation correctness before full-scale training