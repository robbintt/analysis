---
ver: rpa2
title: 'Let Physics Guide Your Protein Flows: Topology-aware Unfolding and Generation'
arxiv_id: '2509.25379'
source_url: https://arxiv.org/abs/2509.25379
tags:
- protein
- structure
- process
- preprint
- cartesian
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces PhysFlow, a generative model for protein
  structure prediction that uses a physics-informed noising process based on Hamiltonian
  dynamics. Unlike traditional linear diffusion models, PhysFlow unfolds proteins
  into secondary structures while preserving structural integrity and avoiding collisions
  through a Coulomb-like repulsion potential.
---

# Let Physics Guide Your Protein Flows: Topology-aware Unfolding and Generation

## Quick Facts
- arXiv ID: 2509.25379
- Source URL: https://arxiv.org/abs/2509.25379
- Reference count: 40
- Primary result: PhysFlow achieves state-of-the-art performance in unconditional protein generation and outperforms existing methods in sequence-conditioned monomer folding with lower RMSD

## Executive Summary
PhysFlow introduces a generative model for protein structure prediction that replaces traditional linear diffusion with a physics-informed noising process based on Hamiltonian dynamics. The model unfolds proteins into secondary structures while preserving structural integrity and avoiding collisions through a Coulomb-like repulsion potential. By integrating this process with flow matching on SE(3) and incorporating sequence information via pre-trained embeddings, PhysFlow achieves superior performance in both unconditional protein generation and sequence-conditioned folding tasks.

## Method Summary
PhysFlow models protein unfolding as a second-order dynamical system governed by an energy potential combining quadratic attraction toward a target state with Coulomb-like repulsion between residues. The protein backbone is parameterized as rigid frames and processed through a multimodal network with Invariant Point Attention transformers for structure and ESM2 for sequence, trained via conditional flow matching on the SE(3) manifold. The method produces more designable structures by grounding the noising process in classical physics rather than relying on linear diffusion.

## Key Results
- Achieves state-of-the-art performance in unconditional protein generation with more designable and novel structures
- Outperforms existing methods in sequence-conditioned monomer folding with lower RMSD (11.08/15.11 Å)
- Produces structures with better preservation of topological integrity and reduced steric clashes

## Why This Works (Mechanism)

### Mechanism 1: Hamiltonian Unfolding with Repulsion Potentials
Replaces linear diffusion with physics-informed noising process preserving structural topology and preventing steric clashes. The forward process uses a second-order dynamical system with Coulomb-like repulsion to avoid residue collisions during unfolding.

### Mechanism 2: SE(3) Flow Matching on Frames
Parameterizes protein backbone as rigid frames and applies flow matching on SE(3) manifold, enforcing rotational and translational equivariance while reducing network learning burden through geodesic interpolation.

### Mechanism 3: Sequence-Structure Multimodal Conditioning
Uses pre-trained sequence embeddings (ESM2) to enable accurate "reverse folding" by fusing structure and sequence representations through a dual-encoder architecture with IPA transformers.

## Foundational Learning

- **Lie Groups (SE(3) and SO(3))**: Essential for operating on rigid body motions; rotations and translations combine via product group structure. *Quick check: Why can't we use Euclidean distances to measure error between two protein frames?*
- **Flow Matching (Conditional Normalizing Flows)**: Training paradigm learning vector fields to push noise to data; offers "simulation-free" property making it faster than standard Neural ODEs. *Quick check: What makes CFM faster than Neural ODEs?*
- **Internal Coordinates (Angular Representation)**: Unfolding uses internal angles rather than Cartesian coordinates to ensure translation invariance and simplify physics. *Quick check: How does the paper map angular unfolding back to Cartesian frames?*

## Architecture Onboarding

- **Component map**: Input (noised Frames + Sequence) -> Structure Encoder (IPA Transformer) + Sequence Encoder (ESM2) -> Combiner (triangular self-attention) -> Decoder (IPA Transformer predicting velocities)
- **Critical path**: Forward Simulation (Section 4.2) - must simulate Hamiltonian ODE to generate training trajectories before training can begin
- **Design tradeoffs**: Physics vs. Speed (simulation scales with protein length); Stability (high Coulomb weight prevents clashes but creates oscillatory dynamics requiring careful drag tuning)
- **Failure signatures**: "Explosion" in generation (steric clashes indicate repulsion weight too low); Drift in Frame Generation (non-physical bond lengths suggest SE(3) flow decoupling from internal constraints)
- **First 3 experiments**: 1) Trajectory Visualization - plot collision count over time on known protein to verify k₂ impact; 2) Ablation on Drag (γ) - train with different drag coefficients to find convergence sweet spot; 3) Designability Check - generate 10 samples, fold with ESMFold, check scRMSD > 2Å

## Open Questions the Paper Calls Out

- **Complex generation**: Can the framework be extended to model protein complexes and higher-order oligomeric assemblies? The current architecture is limited to single-chain monomers.
- **Data scale impact**: How does performance scale when trained on massive datasets like AlphaFold Database compared to large-scale pretrained models? The current study used only 24,003 structures.
- **Secondary structure target bias**: To what extent does fixing the noise destination to linear β-sheets constrain diversity? Ablation against other secondary structure targets is missing.

## Limitations

- Physics fidelity gap: No ablation isolates whether repulsion potential truly prevents clashes versus acting as regularizer; steric clash rates not quantified
- SE(3) manifold approximation: Independent SO(3) and R³ flows may oversimplify coupled backbone dynamics; no analysis of approximation error
- Sequence conditioning effectiveness: Unclear if ESM2 uniquely guides folding versus providing generic structure priors; ablation on sequence masking impact missing

## Confidence

- **High Confidence**: Physics-informed noising improves designability over linear diffusion; SE(3) flow matching framework is correctly implemented and stable; sequence conditioning with ESM2 improves folding accuracy
- **Medium Confidence**: Claim of more designable structures supported by scRMSD but lacks direct comparison to all major baselines; Coulomb repulsion weight selection empirically tuned without theoretical justification
- **Low Confidence**: Novelty and diversity metrics sensitive to structural alignment quality; claim of preserved topology lacks rigorous topological invariants beyond bond maintenance

## Next Checks

1. **Collision frequency analysis**: Generate 100 unconditional samples, compute pairwise Cα distances, report percentage of clashes (<3.5Å), compare against baseline diffusion models
2. **Ablation on repulsion potential**: Train models with k₂ = 0, k₂ = optimal, and k₂ = 10× optimal; measure designability (scRMSD) and generation speed
3. **Sequence conditioning ablation**: Train with (a) full ESM2 conditioning, (b) random sequence embeddings, (c) no sequence input; compare RMSD on sequence folding task