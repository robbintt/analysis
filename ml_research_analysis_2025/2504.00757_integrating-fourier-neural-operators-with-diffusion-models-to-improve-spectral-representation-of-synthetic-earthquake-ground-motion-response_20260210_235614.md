---
ver: rpa2
title: Integrating Fourier Neural Operators with Diffusion Models to improve Spectral
  Representation of Synthetic Earthquake Ground Motion Response
arxiv_id: '2504.00757'
source_url: https://arxiv.org/abs/2504.00757
tags:
- mifno
- ddpm
- diffusion
- neural
- earthquake
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a novel AI-based approach to generate synthetic
  earthquake ground motion by combining a physics-based neural operator (MIFNO) with
  a denoising diffusion probabilistic model (DDPM). The MIFNO acts as a fast surrogate
  for 3D elastodynamics simulations, predicting velocity fields at the Earth's surface
  from geological and source characteristics.
---

# Integrating Fourier Neural Operators with Diffusion Models to improve Spectral Representation of Synthetic Earthquake Ground Motion Response

## Quick Facts
- **arXiv ID:** 2504.00757
- **Source URL:** https://arxiv.org/abs/2504.00757
- **Reference count:** 29
- **Primary result:** MIFNO+DDPM improves spectral representation across 0-5 Hz frequency range, reducing frequency biases from -0.44 to 0.11 and improving phase GOF scores from 6.65 to 7.52

## Executive Summary
This paper presents a novel AI-based approach to generate synthetic earthquake ground motion by combining a physics-based neural operator (MIFNO) with a denoising diffusion probabilistic model (DDPM). The MIFNO acts as a fast surrogate for 3D elastodynamics simulations, predicting velocity fields at the Earth's surface from geological and source characteristics. However, MIFNO shows limitations in capturing mid-frequency spectral content. To address this, the authors train a DDPM to correct the ground motion time series generated by MIFNO, conditioned on MIFNO's output. The DDPM learns to add realistic high-frequency content while preserving the physical consistency of the MIFNO predictions.

The method is trained on the HEMEWS-3D database of 3D elastodynamics simulations and evaluated on 3000 test samples. Results show that the MIFNO+DDPM combination improves spectral representation across the 0-5 Hz frequency range, reducing frequency biases from -0.44 to 0.11 (high frequencies) and improving phase GOF scores from 6.65 to 7.52. The approach enables fast inference (50ms per wavefield prediction) while maintaining physical consistency and shows promise for probabilistic seismic hazard assessment in nuclear engineering applications.

## Method Summary
The authors propose a two-stage approach: first, a physics-based neural operator (MIFNO) generates velocity wavefields from geological and source parameters; second, a DDPM refines these predictions by adding realistic high-frequency content. The MIFNO, based on Fourier layers, provides fast but spectrally-biased predictions. The DDPM is trained to denoise Gaussian noise into velocity residuals, guided by the MIFNO output as conditioning. The MIFNO weights are frozen during DDPM training to stabilize the conditioning distribution. The combined model is trained on synthetic data from the HEMEWS-3D database and evaluated on 3000 test samples, showing improved spectral representation while maintaining physical consistency.

## Key Results
- MIFNO+DDPM improves spectral representation across 0-5 Hz frequency range
- Reduces frequency biases from -0.44 to 0.11 (high frequencies)
- Improves phase GOF scores from 6.65 to 7.52
- Enables fast inference (50ms per wavefield prediction)
- Maintains physical consistency while adding realistic high-frequency content

## Why This Works (Mechanism)

### Mechanism 1: Physics-Guided Conditioning for Generative Correction
The system improves spectral fidelity by using a physics-based surrogate (MIFNO) to constrain a generative model (DDPM), preventing the generative model from hallucinating low-frequency physics while allowing it to focus on high-frequency details. The MIFNO predicts the velocity field based on geological and source parameters. This output acts as a conditioning signal for the DDPM. The DDPM, trained via a denoising objective, learns to estimate the noise residual required to transform the MIFNO prediction into the target ground truth. By conditioning on MIFNO outputs, the DDPM effectively learns the residual distribution rather than the full distribution from scratch.

### Mechanism 2: Spectral Bias Mitigation via Stochastic Refinement
Fourier Neural Operators exhibit spectral bias (difficulty learning high-frequency modes), which is mitigated by the diffusion model's capacity to model complex, high-frequency distributions. Standard FNOs often "blur" high-frequency spatial or temporal features due to spectral bias or truncation in the Fourier layers. The DDPM, typically a U-Net, operates directly on the time series and is trained to minimize the L₂ norm of predicted noise. This objective forces the model to recover fine-grained details lost in the MIFNO's spectral representation, effectively performing a learned, stochastic super-resolution in the frequency domain.

### Mechanism 3: Frozen-Weight Feature Extraction
Freezing the weights of the MIFNO during DDPM training stabilizes the conditioning distribution, allowing the diffusion model to adapt to the surrogate's specific failure modes. The authors freeze the pre-trained MIFNO, ensuring that the input conditioning distribution remains stationary while the DDPM trains. This transforms the problem into a supervised "translation" task rather than an end-to-end joint optimization, which separates the physical constraint (MIFNO) from the generative correction (DDPM).

## Foundational Learning

- **Concept: Fourier Neural Operators (FNO)**
  - **Why needed here:** Understanding that MIFNO learns a mapping between function spaces (geology → velocity) using spectral convolutions is crucial. The "mechanism" relies on the FNO being good at global, low-frequency physics but poor at local, high-frequency resolution.
  - **Quick check question:** Can you explain why convolving in the Fourier domain makes a neural network computationally efficient for PDEs but prone to spectral bias?

- **Concept: Denoising Diffusion Probabilistic Models (DDPM)**
  - **Why needed here:** The DDPM is the "refiner." You must understand the Markov chain of adding noise (forward) and learning to remove it (reverse) to grasp how it generates realistic high-frequency "texture" on top of the MIFNO "structure."
  - **Quick check question:** How does the noise schedule (β_τ) control the trade-off between sample diversity and fidelity in the generated seismograms?

- **Concept: Elastodynamics & Green's Functions**
  - **Why needed here:** The MIFNO approximates the Green's operator. Foundational knowledge of wave propagation (source → medium → receiver) is required to interpret the "phase GOF" and "envelope GOF" metrics used to validate the physics.
  - **Quick check question:** What physical characteristic of a seismogram does the "Phase GOF" metric primarily measure, and why is it critical for structural engineering?

## Architecture Onboarding

- **Component map:** Input (Geological Field + Source Params) -> MIFNO (Frozen) -> Conditioning Interface (MIFNO output) -> DDPM (U-Net) -> Output (Refined Velocity Wavefield)

- **Critical path:** The conditioning injection. The system fails if the MIFNO output does not effectively guide the DDPM. Specifically, if the MIFNO predicts near-zero amplitude (silence), the DDPM lacks the "prompt" needed to generate the corresponding earthquake signal.

- **Design tradeoffs:**
  - Speed vs. Consistency: MIFNO is fast (50ms); DDPM is slower (inference involves iterative denoising steps)
  - Physics vs. Realism: Relying more on DDPM increases realism (high-freqs) but risks violating physics (spatial correlation is currently neglected between sensors)
  - Metrics: Point-wise metrics (MAE) slightly degrade (noise injection), but physics metrics (GOF) improve

- **Failure signatures:**
  - Spatial Decorrelation: The paper notes the DDPM treats sensors independently. Expect failure modes where adjacent sensors show unrealistic incoherence in high-frequency noise
  - Low-Amplitude Dropout: If MIFNO amplitude is very small, the DDPM may fail to generate the appropriate signal energy
  - Spectral Falloff: If DDPM is under-trained, it will not correct the -0.44 high-frequency bias shown in Table 1

- **First 3 experiments:**
  1. Spectral Bias Benchmark: Run inference using only MIFNO and plot the Fourier spectrum against ground truth to confirm the mid-frequency falloff (verify the problem exists)
  2. Ablation on Conditioning: Train the DDPM *unconditionally* (without MIFNO output) vs. conditionally. Compare the Phase GOF to prove the MIFNO is necessary for temporal alignment
  3. Spatial Coherence Test: Generate a wavefield for a dense grid of sensors. Compute the correlation of high-frequency content between adjacent stations to quantify the "independent sensor" limitation discussed in the paper

## Open Questions the Paper Calls Out

### Open Question 1
How can the DDPM architecture be extended to account for spatial correlation between sensors within the same earthquake realization?
- Basis in paper: The authors state that the current "DDPM treats the seismograms from the same realization (i.e., same source and same geology but observed at two different sensors) independently. Therefore, the spatial correlation between them is neglected." They explicitly call for "Further work... to extend the current DDPM architecture."
- Why unresolved: The current architecture processes single-station seismograms independently, failing to capture the complex spatio-temporal patterns required for a cohesive regional wavefield.
- What evidence would resolve it: A modified DDPM architecture that generates sensor outputs simultaneously or uses attention mechanisms to enforce spatial consistency, validated by spatial correlation metrics.

### Open Question 2
How can the model mitigate the degradation of envelope Goodness-of-Fit (GOF) scores in scenarios where the MIFNO conditioning signal has very low amplitude?
- Basis in paper: The results section notes that "the diffusion model degrades the envelope GOF... in most cases when the MIFNO amplitude is very small and the DDPM is not able to extract enough physical information from the MIFNO conditioning."
- Why unresolved: The diffusion model struggles to denoise/correct effectively when the physics-based conditioning signal (MIFNO) provides a weak or insufficient guide for the underlying physical process.
- What evidence would resolve it: Demonstrated stability of GOF scores across low-amplitude samples, potentially through a modified loss function or conditioning mechanism that amplifies the signal-to-noise ratio of the conditioning input.

### Open Question 3
Does the performance of the MIFNO+DDPM surrogate model generalize to recorded seismograms, given that training was limited to synthetic numerical simulations?
- Basis in paper: The study relies entirely on the synthetic HEMEWS-3D database for training and testing. The authors acknowledge the "residual gap in accuracy presumably lies within the epistemic uncertainty margins of 0-5 Hz numerical simulations compared to recorded seismograms."
- Why unresolved: The model has learned physics from a specific numerical solver (SEM3D); it is unknown if this captures the full complexity of real Earth structures and source behaviors required for practical hazard assessment.
- What evidence would resolve it: A benchmark evaluation of the proposed method against a dataset of recorded strong ground motions to quantify the simulation-to-reality gap.

## Limitations
- The DDPM currently treats each sensor independently, potentially producing spatially incoherent high-frequency noise patterns across adjacent stations
- The approach shows sensitivity to MIFNO amplitude, with degraded envelope GOF scores when MIFNO conditioning signals have very low amplitude
- Performance generalization to real recorded seismograms remains untested, as the model was trained exclusively on synthetic data

## Confidence

**High Confidence:** The spectral improvement mechanism is well-supported by results showing reduced frequency bias (-0.44 to 0.11) and improved Phase GOF scores (6.65 to 7.52). The physics-guided conditioning approach is technically sound and the 50ms inference speed is clearly demonstrated.

**Medium Confidence:** The claim that freezing MIFNO weights stabilizes training is reasonable but lacks strong empirical validation in the seismology domain. The assertion that DDPM learns "realistic" high-frequency content depends on training data quality and spectral bandwidth.

**Low Confidence:** The spatial decorrelation limitation is acknowledged but not quantitatively evaluated. The amplitude sensitivity failure mode (DDPM struggling with near-zero MIFNO predictions) is mentioned but not tested.

## Next Checks

1. **Phase Error Sensitivity:** Introduce controlled phase shifts in MIFNO outputs and measure how DDPM performance degrades to quantify the conditioning dependency.

2. **Spatial Coherence Quantification:** Compute cross-correlation of high-frequency components between adjacent sensors in DDPM outputs versus ground truth to measure the spatial decorrelation effect.

3. **Ablation on Freezing:** Compare results when fine-tuning MIFNO weights jointly with DDPM versus the frozen approach to validate the stability vs. flexibility tradeoff.