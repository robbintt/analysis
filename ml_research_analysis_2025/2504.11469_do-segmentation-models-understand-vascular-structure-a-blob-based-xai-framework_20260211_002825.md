---
ver: rpa2
title: Do Segmentation Models Understand Vascular Structure? A Blob-Based XAI Framework
arxiv_id: '2504.11469'
source_url: https://arxiv.org/abs/2504.11469
tags:
- vessel
- attribution
- blob
- segmentation
- vascular
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces a structured XAI framework to interpret deep
  learning models for 3D vascular segmentation. It uses vascular graph-derived points
  of interest (bifurcations, endpoints, mid-branches) to guide gradient-based Saliency
  attribution analysis.
---

# Do Segmentation Models Understand Vascular Structure? A Blob-Based XAI Framework

## Quick Facts
- arXiv ID: 2504.11469
- Source URL: https://arxiv.org/abs/2504.11469
- Reference count: 40
- Primary result: Gradient-based XAI framework reveals vascular segmentation models rely on localized cues rather than global structural context

## Executive Summary
This paper introduces a structured explainability framework for 3D vascular segmentation models that uses anatomically meaningful Points of Interest (bifurcations, endpoints, mid-branches) to guide gradient-based saliency attribution analysis. The framework employs a custom Frangi-based blob detector to isolate compact attribution regions and compares them against vessel-level features like connectivity and thickness. Experiments on IRCAD and Bullitt datasets reveal that model attributions are highly localized near POIs with little correlation to anatomical properties, suggesting models rely on local visual cues rather than understanding global vascular structure.

## Method Summary
The framework computes gradient-based saliency maps at specific vascular Points of Interest (POIs) extracted from 3D segmentation outputs, then applies a custom Frangi-based blob detector to isolate compact attribution regions. It analyzes the spatial relationship between POI locations and attribution blobs, along with correlations between blob characteristics and vessel anatomical features (connectivity, thickness, tubularity). The method uses standard 3D U-Net architecture trained on raw image patches, vascular graph extraction via Voreen, and Spearman's rank correlation for statistical analysis.

## Key Results
- Model attributions are highly localized near POIs, with median distances of 0.64 voxels for IRCAD and 0.41 for Bullitt
- Attribution blobs show 109x higher L1-norm inside versus outside regions, confirming signal concentration
- Tubularity shows counterintuitive negative correlation with attribution strength, suggesting lack of anatomical reasoning
- Little evidence that models leverage topological features like connectivity for vascular understanding

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Gradient-based saliency maps, when constrained to anatomically meaningful POIs, reveal that segmentation models rely on highly localized visual cues rather than global structural context.
- Mechanism: The framework computes the gradient of the output logit at specific vessel points (bifurcation, endpoint, or mid-branch) with respect to input voxels, identifying influential regions driving predictions. Analysis of distance between POI and attribution blob centroid quantifies spatial locality.
- Core assumption: Gradient of the logit with respect to input provides faithful approximation of model's reasoning strategy.
- Evidence anchors: Distance distributions heavily skewed toward low values (median 0.64 voxel for IRCAD); SWinMamba literature suggests standard models struggle with discontinuity.
- Break condition: If model used global context, attribution blobs would be diffuse or centered on distant connected vessels, resulting in high distances or multi-modal distributions.

### Mechanism 2
- Claim: Custom multi-scale Frangi filter effectively isolates compact influential regions within noisy saliency maps, distinguishing signal from spurious gradients.
- Mechanism: Adapts vesselness filter (typically for tubular structures) to enhance blob-like structures in saliency maps using Hessian matrix eigenvalue analysis, then applies Otsu thresholding to create binary blob masks.
- Core assumption: Explanatory power concentrates in compact, blob-like regions rather than dispersed tubular structures.
- Evidence anchors: Custom filter described as able to enhance blob-like structures; average L1-norm inside blob is 109±53.5 times higher than outside.
- Break condition: If saliency maps were structurally aligned with vessels, Frangi filter (tuned for blobs) would suppress attribution signal.

### Mechanism 3
- Claim: Correlation analysis between attribution features and anatomical properties exposes lack of anatomical reasoning in standard U-Net architectures.
- Mechanism: Computes Spearman's rank correlation coefficients between blob statistics (size, norm) and ground-truth vascular features (thickness, connectivity, tubularity). Low or counterintuitive correlations indicate model ignores domain-specific features.
- Core assumption: If model "understands" vascular structure, attribution strength should correlate with structural clarity (e.g., higher attribution for more connected or tubular regions).
- Evidence anchors: Tubularity negatively correlated with attribution strength in Bullitt dataset; little evidence model leverages topological features.
- Break condition: If model utilized global features, correlations would show positive monotonic relationships with structural metrics.

## Foundational Learning

- **Concept: Gradient-based Saliency Maps**
  - Why needed here: Core observability tool for segmentation models. Unlike classification, segmentation requires selecting specific output voxels (POIs) to compute gradients, mapping "why did you predict this voxel as vessel?"
  - Quick check question: In binary segmentation map, does positive saliency gradient at voxel indicate model wants to increase or decrease probability of "vessel" class at target POI?

- **Concept: Vascular Graph Extraction (Voreen)**
  - Why needed here: Raw segmentation masks are volumes. Extracting centerline graph is prerequisite for defining anatomically meaningful POIs (bifurcations/endpoints) rather than random points.
  - Quick check question: Why is "mid-branch" point defined differently in graph extraction phase compared to bifurcation node?

- **Concept: Scale-Space Blob Detection (Frangi Filter)**
  - Why needed here: Saliency maps are noisy. Understanding how Hessian matrix eigenvalues discriminate between plate-like, tubular, and blob-like structures is required to understand adaptation of vesselness filter to find blob-like attribution regions.
  - Quick check question: Frangi filter usually highlights vessels (tubes). How did authors modify eigenvalue analysis logic conceptually to highlight compact blobs instead?

## Architecture Onboarding

- **Component map:** Input 3D patches + Ground Truth Mask → Voreen Graph Extraction → POI Selection (Bifurcation/End/Mid) → Standard 3D U-Net → Gradient computation at POI → Saliency Map → Custom Frangi Blob Detector → Binary Blob Mask → Statistical analysis

- **Critical path:** Validity hinges on POI-to-Patch alignment. Since training uses 3D patches with overlap, single POI exists in up to 8 patches. Architecture must aggregate or select correct saliency map for specific POI context.

- **Design tradeoffs:**
  - Saliency vs. Integrated Gradients: Chose Saliency (Simonyan et al.) for simplicity and speed as baseline, acknowledging it may be noisier than sophisticated methods
  - U-Net vs. nnU-Net: Chose standard U-Net to avoid complexity of model ensembling (used in nnU-Net), prioritizing interpretability of single architecture over maximum performance

- **Failure signatures:**
  - Disconnected Attributions: Blobs detected at large distances from POI centroid (Figure 6 outliers) indicate model looking at irrelevant context or artifacts
  - Negative Tubularity Correlation: If attribution strength goes down as vessel clarity goes up, model likely learning spurious texture features (noise) rather than anatomy

- **First 3 experiments:**
  1. Localization Check: Reproduce distance histogram (Figure 6). Verify distribution of blob-centroid-to-POI distance is skewed < 1.0 voxel
  2. Contrast Check: Implement Fisher Contrast-to-Noise Ratio (Eq. 4) to confirm blob region is statistically distinct from background (Table 1)
  3. Correlation Check: Run Spearman's rank correlation between blob L1-norm and vessel thickness. Confirm hypothesis that ρ≈0 (no correlation)

## Open Questions the Paper Calls Out

- **Open Question 1:** Do spatial distance or multiplicity of attribution blobs correlate with specific segmentation errors (False Positives and False Negatives)?
  - Basis in paper: [explicit] Authors state, "Extending the analysis to False Positives and False Negatives could reveal whether blob distance or multiplicity relates to prediction errors."
  - Why unresolved: Current study restricted analysis exclusively to True Positive points of interest to establish baseline for correct model behavior.
  - What evidence would resolve it: Statistical correlation analysis between blob metrics (distance to centroid, blob count) and error type (FP vs. FN) of corresponding voxels.

- **Open Question 2:** Does model attend to vascular content distinctively when analyzing True Negative points, or does it simply react to queried location?
  - Basis in paper: [explicit] Text asks, "Similarly, examining True Negative POIs would clarify whether model attends to vascular content or simply reacts to queried locations."
  - Why unresolved: Framework applied only to vascular points; attribution behavior for background/non-vascular regions remains unexplored.
  - What evidence would resolve it: Applying proposed blob-based pipeline to True Negative POIs and comparing resulting attribution patterns against those found at vessel points.

- **Open Question 3:** Is observed size of attribution blobs causally determined by implicit "average vessel" scale learned during training?
  - Basis in paper: [explicit] Authors note, "...further analysis is needed to confirm this relationship" regarding correspondence between blob size variability and vessel size distributions across datasets.
  - Why unresolved: While results show smaller blobs for smaller-vessel Bullitt dataset and larger blobs for IRCAD, observation relies on correlation rather than controlled experimentation.
  - What evidence would resolve it: Training models on datasets with controlled, varying vessel calibers and measuring resulting adaptive changes in attribution blob geometry.

## Limitations

- Framework assumes anatomical features like connectivity should positively correlate with attribution strength if model "understands" vascular structure
- Custom Frangi-based blob detector represents departure from standard approaches and requires careful parameter tuning
- Gradient-based saliency maps may provide noisier attributions compared to more sophisticated XAI methods

## Confidence

- **High Confidence**: Localization of attributions near POIs (Mechanism 1) - well-supported by distance distribution analysis
- **Medium Confidence**: Effectiveness of Frangi blob detector (Mechanism 2) - custom method with limited comparative validation
- **Medium Confidence**: Lack of anatomical correlation findings (Mechanism 3) - interpretation depends on assumptions about expected relationships

## Next Checks

1. Cross-validation of XAI method: Compare Saliency map attributions with Integrated Gradients or SmoothGrad on same POI set to assess robustness of localization findings

2. Ablation of blob detector: Test alternative blob detection methods (LoG, Difference of Gaussians) on same saliency maps to confirm Frangi filter specifically captures attribution signal

3. Model architecture comparison: Apply same XAI framework to structurally-aware model (e.g., SWinMamba or graph-based approaches) to determine if observed localization and correlation patterns are architecture-specific