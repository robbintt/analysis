---
title: Generalizable Agent Modeling for Agent Collaboration-Competition Adaptation
  with Multi-Retrieval and Dynamic Generation
arxiv_id: '2506.16718'
source_url: https://arxiv.org/abs/2506.16718
generated_at: '2026-02-03T12:58:26'
quality_score: 8
citation_count: 40
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# Generalizable Agent Modeling for Agent Collaboration-Competition Adaptation with Multi-Retrieval and Dynamic Generation

*Chenxu Wang; Yonggang Jin; Cheng Hu; Youpeng Zhao; Zipeng Dai; Jian Zhao; Shiyu Huang; Liuyu Xiang; Junge Zhang; Zhaofeng He*

---

> ### ‚ö° Quick Facts
>
> *   **Proposed Method:** MRDG (Multi-Retrieval and Dynamic Generation)
> *   **Problem Setting:** ACCA (Agent Collaborative-Competitive Adaptation)
> *   **Key Benchmarks:** SMAC, Overcooked-AI, Melting Pot
> *   **Performance Highlight:** 100% Win Rate (SMAC Corridor) vs 0% (MAPPO)
> *   **Quality Score:** 8/10

---

## üìã Executive Summary

Multi-agent reinforcement learning (MARL) systems frequently fail in real-world deployments because they are typically trained on fixed sets of partners, leading to distribution shifts when encountering new teammates or opponents. This paper addresses the **Agent Collaborative-Competitive Adaptation (ACCA)** setting, a unified and complex scenario requiring an agent to simultaneously collaborate with unseen partners while competing against unknown adversaries. This problem is critical because it targets the need for agents that can operate robustly in dynamic environments populated by heterogeneous entities without requiring retraining, moving beyond the limitations of simplified coordination or competition-specific training.

The authors propose the **Multi-Retrieval and Dynamic Generation (MRDG)** framework, which decouples adaptation from the policy network through three integrated technical components. First, a Multi-Retrieval Module maintains a memory bank of historical trajectories to identify and retrieve relevant behavioral patterns (specifically $K=4$ neighbors) based on the current context. Second, a Viewpoint Alignment module maps these retrieved features into the ego-agent‚Äôs observational space to resolve discrepancies caused by partial observability. Third, a Dynamic Generation Hypernetwork synthesizes these aligned trajectories to dynamically generate policy weights in real-time. Additionally, the framework incorporates structural components such as a positional encoder to handle variable team sizes, ensuring the architecture remains effective across diverse configurations.

MRDG was evaluated across standard benchmarks including SMAC (competitive), Overcooked-AI, and Melting Pot (collaborative), consistently outperforming established baselines such as IQL, MAPPO, and ToMnet. In Overcooked-AI Zero-Shot Coordination scenarios, MRDG achieved an average normalized score of **86.2%**, significantly surpassing MAPPO at **64.9%** and ToMnet at **56.4%**. On the competitive SMAC benchmark, specifically in the "Corridor" scenario, MRDG secured a **100%** win rate compared to **0%** for the MAPPO baseline. Ablation studies validated that retrieving multiple trajectories ($K > 1$) yields superior performance over single-retrieval methods, and that the hypernetwork is essential; its removal resulted in a substantial performance drop, confirming its role in enabling rapid adaptation.

This research significantly advances the field by formally defining the ACCA setting, which generalizes beyond previous simplified scenarios to address the complexity of simultaneous collaboration and competition. The successful integration of specific structural mechanisms‚Äîsuch as the positional encoder for variable team sizes and the viewpoint alignment module‚Äîprovides a novel technical solution to the challenges of heterogeneity and perspective differences in multi-agent systems. By proving that agents can effectively model others through behavior trajectory analysis and dynamic network generation, this work establishes a new precedent for building adaptable, generalizable AI capable of operating in open-ended environments.

---

## üîë Key Findings

*   **Robust Adaptation:** The proposed Multi-Retrieval and Dynamic Generation (MRDG) method significantly improves an agent's ability to robustly collaborate with unseen teammates and compete against unknown opponents.
*   **Benchmark Superiority:** Extensive testing across standard benchmarks (**SMAC**, **Overcooked-AI**, and **Melting Pot**) demonstrated that MRDG surpasses established baselines.
*   **Effective Modeling:** The use of behavioral trajectories, combined with viewpoint alignment, allows for the effective modeling of other agents despite differences in observational perspectives.
*   **Enhanced Learning:** The integration of a hypernetwork module successfully enhances the agent's learning capabilities and adaptability to new tasks and environments.

---

## üß© Methodology

The paper introduces **Multi-Retrieval and Dynamic Generation (MRDG)**, a novel modeling framework designed to handle the Agent Collaborative-Competitive Adaptation (ACCA) setting. The approach relies on three core technical components:

1.  **Behavioral Trajectory Modeling:** Analyzes historical trajectories rather than relying on pre-set assumptions about other agents.
2.  **Structural Components:** Utilizes a positional encoder to handle varying team sizes and a hypernetwork module for rapid adaptation.
3.  **Viewpoint Alignment:** Harmonizes the observational perspectives of retrieved agents with the learning agent to ensure consistency.

---

## ‚öôÔ∏è Technical Details

The MRDG framework addresses Zero-Shot Coordination and ad-hoc teamwork through the following specific mechanisms:

*   **Multi-Retrieval Module:**
    *   Maintains a memory bank of historical trajectories.
    *   Retrieves multiple relevant neighbors (K) based on context to capture diverse behaviors.
*   **Viewpoint Alignment Module:**
    *   Maps other agents' features into the ego-agent's feature space.
    *   Specifically designed to handle partial observability challenges.
*   **Dynamic Generation Hypernetwork:**
    *   The core component that takes aligned retrieved trajectories as input.
    *   Dynamically generates the weights for the agent's policy network, allowing for on-the-fly customization for new partners or opponents.

---

## üìä Results

MRDG was rigorously evaluated against established baselines (IQL, MAPPO, and ToMnet) across three distinct environments.

### Performance Metrics

| Benchmark | Scenario | MRDG Performance | Best Baseline | Improvement |
| :--- | :--- | :--- | :--- | :--- |
| **SMAC** (Competitive) | Corridor | **100%** Win Rate | MAPPO (0%) | +100% |
| **Overcooked-AI** (Collaborative) | ZSC Average | **86.2%** Score | MAPPO (64.9%) | +21.3 pts |
| **Overcooked-AI** (Collaborative) | ZSC Average | **86.2%** Score | ToMnet (56.4%) | +29.8 pts |

### Ablation Study Insights

*   **Multi-Retrieval vs. Single:** Studies confirmed that retrieving multiple trajectories ($K > 1$) yields better performance than retrieving a single trajectory.
*   **Hypernetwork Necessity:** The hypernetwork is essential for the framework's success; removing it caused a significant performance drop, validating its role in dynamic adaptation.

---

## üìù Contributions

*   **Definition of ACCA:** The authors define Agent Collaborative-Competitive Adaptation (ACCA), a comprehensive setting that generalizes beyond previous simplified scenarios.
*   **MRDG Framework:** The proposal of the MRDG framework provides a new technical solution for generalizable agent modeling, specifically addressing the challenges of dynamic collaboration and competition.
*   **Structural Mechanisms:** The introduction of specific mechanisms, such as the positional encoder for variable team sizes and the viewpoint alignment module, addresses specific structural challenges in multi-agent systems regarding heterogeneity and perspective differences.

---

**Paper Quality Score:** 8/10  
**References:** 40 citations