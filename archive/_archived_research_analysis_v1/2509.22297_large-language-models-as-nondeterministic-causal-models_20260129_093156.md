# Large Language Models as Nondeterministic Causal Models
*Sander Beckers*

> ### ðŸ“Š Quick Facts
> *   **Quality Score:** 8/10
> *   **Citations:** 20
> *   **Model Type:** Nondeterministic Causal Models
> *   **Key Innovation:** 'Simple Semantics' for counterfactuals
> *   **Compatibility:** Black-box / Closed-source models

---

## Executive Summary

Current interpretations of Large Language Models (LLMs) are theoretically misaligned because they force inherently probabilistic, nondeterministic systems into deterministic causal frameworks. This inaccurate modeling creates significant challenges in generating counterfactual explanationsâ€”the "what-if" scenarios essential to understanding model behavior. When treated as deterministic models, LLMs suffer from the identifiability bounds problem, resulting in mathematically unbounded probabilities for counterfactual outcomes. This paper addresses this fundamental disconnect, arguing that existing formalisms fail to respect the intended semantics of LLMs, thereby limiting the reliability and interpretability of causal reasoning applied to these systems.

The key innovation is the formalization of LLMs as **Nondeterministic Causal Models**, represented as a tuple $M=(V, G, P^M)$, rather than attempting to map them to deterministic structural equation models. The authors introduce "Simple Semantics," a framework that computes counterfactuals by treating token generation strictly through conditional probability distributions. Technically, this method simplifies counterfactual generation to a direct query: 

$$P^*(Y^*=y^*|Y=y, X=x, X^*=x^*) = P(Y=y^*|X=x^*)$$

This approach eliminates the need for complex ablation or intervention on intermediate hidden states; instead, it generates counterfactuals purely by querying the model's output distribution under modified inputs.

The research presents analytical findings demonstrating that the proposed nondeterministic framework resolves the theoretical ambiguities of previous approaches. While deterministic causal models yield unbounded counterfactual probabilities, the nondeterministic models produce unique, fixed probabilities. The authors prove **Theorem 1**, which establishes that deterministic and nondeterministic models are equivalent at zero temperature, theoretically reconciling the new method with existing literature. Additionally, the method is validated as a black-box solution; it requires no access to internal weights or activation states, relying solely on input/output interfaces to function correctly with commercial, closed-source models.

This research significantly advances the field by establishing a rigorous theoretical basis for LLM counterfactuals that aligns with the probabilistic nature of the models. It clarifies the scope of previous methods, defining exactly where deterministic approaches are valid (e.g., zero temperature) and where they fail. By offering an implementation-agnostic method that works on black-box models, this work democratizes access to high-level causal interpretability tools, enabling researchers to reason about the semantics of proprietary models like GPT-4 without needing internal access. This shift toward nondeterministic causal modeling provides a more stable foundation for future work in AI safety, alignment, and explanation.

---

## Key Findings

*   **Critique of Existing Interpretations:** The paper critiques current interpretations for incorrectly modeling nondeterministic systems as deterministic causal models.
*   **Universal Method Development:** Develops a simplified, universal method that aligns with the 'intended interpretation' of LLMs by representing them as nondeterministic causal models.
*   **Implementation Agnostic:** The method can be applied to any black-box LLM without modification or internal access.
*   **Theoretical Reconciliation:** Provides a theoretical reconciliation relating the new method to existing ones, clarifying the scope of prior methods.

---

## Methodology

The research proposes a shift in formal representation by treating LLMs intrinsically as **nondeterministic causal models** rather than forcing them into a deterministic framework.

*   **Core Shift:** Moving away from deterministic structural equation models to representations that respect the probabilistic nature of LLMs.
*   **Semantic Alignment:** The approach adheres to the intended semantics of the model.
*   **Counterfactual Generation:** Allows for the generation of counterfactuals without interference in the model's implementation or sampling mechanism.

---

## Research Contributions

*   **A Novel Counterfactual Generation Framework:** Introduction of a simplified, theoretically sound technique for generating LLM counterfactuals that respects the probabilistic nature of the models.
*   **Accessibility for Black-Box Models:** Provision of a method that does not require access to internal implementation details, making it viable for commercial APIs.
*   **Theoretical Foundation for Semantics:** Establishment of a rigorous theoretical basis for reasoning about counterfactuals based on the intended semantics of LLMs.

---

## Technical Details

The paper provides a rigorous mathematical framework for the proposed model:

**Model Definitions**
*   **Nondeterministic Causal Models:** Defined as a tuple $M=(V, G, P^M)$.
*   **Contrast:** Explicitly contrasted with prior deterministic models $M=(V, U, G, f, P^U)$.

**LLM Architecture Variables**
*   **$X$:** The input prompt.
*   **$T_i$:** Intermediate tokens.
*   **$Y$:** The final output.

**Governing Equations**
*   The system is governed by conditional probability distributions:
    $$P(T_i \mid T_1, \dots, T_{i-1})$$
*   **Simple Semantics Calculation:** 
    $$P^*(Y^*=y^*|Y=y, X=x, X^*=x^*) = P(Y=y^*|X=x^*)$$
*   This allows sampling counterfactuals by querying $P(Y|X^*)$ without ablation.

---

## Analytical Results

The study presents several critical analytical outcomes:

*   **Identifiability Bounds Problem:** Deterministic causal models produce mathematically unbounded counterfactual probabilities. The proposed nondeterministic models resolve this, yielding unique, fixed probabilities.
*   **Theorem 1:** Establishes that deterministic and nondeterministic models are equivalent at zero temperature.
*   **Black-Box Validation:** The 'Simple Semantics' method is validated as requiring only black-box access to the LLM input/output interface, making it fully compatible with closed-source commercial models.

---

### Paper Metrics & References

*   **Quality Score:** 8/10
*   **References:** 20 citations