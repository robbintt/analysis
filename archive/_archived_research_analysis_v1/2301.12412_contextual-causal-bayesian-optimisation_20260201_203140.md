# Contextual Causal Bayesian Optimisation
*Vahan Arsenyan; Antoine Grosnit; Haitham Bou-Ammar; Arnak Dalalyan*

> ### ðŸ“Š Quick Facts
>
> *   **Quality Score:** 8/10
> *   **References:** 40 citations
> *   **Core Algorithm:** CoCa-BO (Contextual Causal Bayesian Optimisation)
> *   **Performance Guarantee:** Sublinear regret bound ($\tilde{O}(\sqrt{T})$)
> *   **Primary Application:** High-dimensional optimization with structural dependencies

---

## Executive Summary

This research addresses the optimization of black-box functions embedded in systems characterized by intricate structural dependencies and dynamic environmental shifts. It tackles the critical inefficiency inherent in treating Causal Bayesian Optimisation (CBO) and Contextual Bayesian Optimisation (Contextual BO) as isolated problems. In high-dimensional settings where interventions affect a target variable through a known causal graph and external contexts influence performance, existing methods fail to efficiently maximize target expectations.

The authors introduce **CoCa-BO** (Contextual Causal Bayesian Optimisation), the first unified framework to jointly leverage causal graph structures and contextual information. The algorithm optimizes over "Mixed Policy Scopes" (MPS) using a novel three-component pipeline:

1.  **POMPS Identification:** Identifies potentially optimal scopes via combinatorial search restricted to discrete structural subsets.
2.  **Scope Selection:** Formulates the choice of variable sets as a Multi-Armed Bandit problem, utilizing running averages of Upper Confidence Bound (UCB).
3.  **Intra-Scope Optimization:** Performs standard Bayesian Optimization using a Gaussian Process surrogate and UCB acquisition.

The paper provides rigorous theoretical and empirical validation, proving that CoCa-BO achieves a cumulative regret bound of $\tilde{O}(\sqrt{T})$, establishing sublinear regret in contrast to baseline methods (which suffer from linear regret). Consequently, CoCa-BO is poised to influence future research in automated decision-making systems, particularly in complex domains such as personalized medicine and industrial control.

---

## Key Findings

*   **Unified Framework:** Successfully integrates contextual information and causal graph structures to maximize target variable expectation.
*   **Theoretical Guarantees:** Achieves sublinear regret and reduces sample complexity, particularly in high-dimensional settings. Satisfies both worst-case and instance-dependent high-probability regret bounds.
*   **Superior Performance:** Experimental validation confirms theoretical predictions, demonstrating better results than methods treating context and causality separately.
*   **Limitation Resolution:** Resolves specific limitations inherent in previous Causal and Contextual Bayesian Optimisation approaches.

---

## Methodology

The researchers introduce a unified framework leveraging observed contextual information and known causal graph structures.

*   **Joint Optimization:** They propose a novel algorithm designed to simultaneously optimize intervention policies and the sets of variables upon which the policies are defined.
*   **Objective:** The primary goal is to maximize the expectation of the target variable within this high-dimensional environment.

---

## Core Contributions

*   **First Unified Framework:** The paper provides the first framework successfully merging Causal Bayesian Optimisation and Contextual Bayesian Optimisation.
*   **Joint Strategy:** Introduces a joint optimization strategy enabling simultaneous optimization of policies and intervention variable sets.
*   **Theoretical Rigor:** Contributes significant theoretical backing by deriving both worst-case and instance-dependent high-probability regret bounds.
*   **Efficiency Proof:** Establishes that integrating context and causality yields practical efficiency gains, specifically proving reduced sample complexity in high-dimensional environments.

---

## Technical Details

**Algorithm:** CoCa-BO (Contextual Causal Bayesian Optimisation)

**Mechanism:**
Maximizes a target variable using a Structural Causal Model and Directed Acyclic Graph (DAG) by optimizing over **Mixed Policy Scopes (MPS)**.

**Pipeline Components:**
1.  **POMPS Identification**
    *   Brute-force search for possibly optimal scopes.
    *   *Note:* Possesses exponential complexity.
2.  **Scope Selection**
    *   Utilizes a Multi-Armed Bandit strategy.
    *   Relies on the running average of Upper Confidence Bound (UCB).
3.  **Intra-Scope Optimization**
    *   Standard Bayesian Optimisation implementation.
    *   Uses a Gaussian Process surrogate and UCB acquisition function.

**Assumptions & Guarantees:**
*   Sublinear regret guaranteed under assumptions of convex/compact domains and bounded kernels.
*   Offers favorable scaling compared to Model-Based Causal BO.

---

## Experimental Results

**Evaluation Metrics:**
*   Time-Normalized Cumulative Regret
*   Immediate Pseudo-Regret
*   Cumulative MPS Selection Frequency

**Baselines:**
*   CaBO
*   CoBO

**Configurations:**
*   **Config I:** Scenarios assessing overhead.
*   **Config II:** Validation of scope-selection.

**Outcome:**
The method demonstrates superior performance and sublinear regret compared to baselines that suffer from linear regret. Significant gains were specifically noted in high-dimensional settings.