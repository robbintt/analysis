# Contextual Causal Bayesian Optimisation

*Vahan Arsenyan; Antoine Grosnit; Haitham Bou-Ammar; Arnak Dalalyan*

---

<details>
<summary><strong>ðŸ“Š Quick Facts</strong></summary>

*   **Algorithm:** CoCa-BO (Contextual Causal Bayesian Optimisation)
*   **Key Performance:** Sublinear Regret & Reduced Sample Complexity
*   **Core Innovation:** Joint optimization of policies and variable sets using SCMs and DAGs
*   **Quality Score:** 7/10
*   **References:** 40 Citations

</details>

---

## Executive Summary

This research addresses the critical challenge of optimizing expensive black-box functions in **high-dimensional environments** where system variables are influenced by dynamic external contexts.

Existing methods suffer from isolation: Contextual Bayesian Optimisation (CoBO) with a fixed scope often suffers from provable linear regret, while Causal Bayesian Optimisation (CaBO) struggles to adapt to shifting contextual dynamics. This separation leads to unsustainable sample complexity and inefficient search space navigation.

The authors propose **Contextual Causal Bayesian Optimisation (CoCa-BO)**, a unified framework integrating Structural Causal Models (SCMs) and Directed Acyclic Graphs (DAGs). The algorithm operates via a three-step mechanism: Scope Identification (computing optimal scopes via DAG), Arm Selection (treating scopes as arms in a Multi-Armed Bandit), and Action Selection (using Bayesian Optimization with Gaussian Processes).

Experimental validation confirms that CoCa-BO resolves the linear regret issue, achieving **sublinear regret bounds** and superior sample efficiency. This establishes the framework as a robust solution for complex, dynamic applications such as personalized medicine and adaptive control systems.

---

## Key Findings

The proposed unified framework demonstrates significant advancements in optimization efficiency and theoretical grounding:

*   **Unified Optimization:** Effectively maximizes the expectation of a target variable by synthesizing contextual information with causal graph structures.
*   **Efficient Convergence:** Achieves **sublinear regret**, indicating that the algorithm converges efficiently over time rather than stagnating.
*   **Reduced Complexity:** Significantly lowers sample complexity, a crucial improvement for high-dimensional settings where data acquisition is expensive.
*   **Resolved Limitations:** Experimental results confirm that the unified approach resolves specific limitations and suboptimal results associated with using Causal or Contextual Bayesian Optimisation in isolation.

---

## Methodology

The research introduces **Contextual Causal Bayesian Optimisation**, a framework designed to bridge the gap between observed context and known causal structures.

*   **Core Concept:** The methodology integrates observed contextual information and known causal graph structures into a single cohesive model.
*   **Joint Optimization:** The core algorithm performs simultaneous optimization over:
    *   Intervention policies.
    *   The specific sets of variables on which these policies are defined.
*   **Guided Search:** It leverages both context and causal structure to intelligently guide the search process through the variable space.

### Main Contributions

*   **Theoretical Unification:** Provides the first rigorous theoretical unification of Causal Bayesian Optimisation (CaBO) and Contextual Bayesian Optimisation (CoBO).
*   **Algorithmic Innovation:** Introduces a novel algorithm capable of jointly optimizing policies and variable sets.
*   **Rigorous Analysis:** Delivers a robust theoretical analysis, including high-probability regret bounds.
*   **Validation:** Demonstrates reduced sample complexity in high-dimensional environments through performance validation.

---

## Technical Details: The CoCa-BO Framework

The **Contextual Causal Bayesian Optimisation (CoCa-BO)** framework is designed to optimize expensive black-box functions by maximizing the expected reward of a policy $\pi$. It operates over **Mixed Policy Scopes (MPS)** defined by a Structural Causal Model (SCM) and Directed Acyclic Graph (DAG).

### Algorithm Architecture

The algorithm utilizes a distinct three-step process:

1.  **Scope Identification:**
    *   Computes **Possibly Optimal Mixed Policy Scopes ($S^*$)**.
    *   Utilizes brute-force search restricted by the DAG structure to ensure efficiency.

2.  **Arm Selection:**
    *   Treats the identified scopes as "arms" in a **Multi-Armed Bandit (MAB)** problem.
    *   Optimizes the selection of the scope using the **Upper Confidence Bound (UCB)** algorithm.

3.  **Action Selection:**
    *   Employs a standard Bayesian Optimization routine.
    *   Uses a **Gaussian Process surrogate model** to determine the optimal intervention values within the selected scope.

### Theoretical Guarantees

*   **Regret Bounds:** The method achieves sublinear regret under specific theoretical assumptions.
*   **Assumptions:** Requires convex compact domains and assumes the use of smooth bounded kernels.

---

## Results

The performance of CoCa-BO was evaluated against CaBO and CoBO baselines across two distinct configurations.

### Metrics Used
*   **Time-Normalized Cumulative Regret**
*   **Immediate Pseudo-Regret**
*   **Cumulative MPS Selection Frequency**

### Outcome Summary
*   **Regret Resolution:** CoCa-BO successfully resolves the "provable linear regret" issue often associated with fixed-scope CoBO, achieving **sublinear regret**.
*   **Sample Efficiency:** The approach demonstrates significantly improved sample efficiency, particularly in high-dimensional settings.
*   **Convergence:** The Multi-Armed Bandit component effectively converges to select the optimal Mixed Policy Scope over iterations.
*   **Stability:** Unlike competing baselines which exhibit unbounded linear growth in regret, CoCa-BO stabilizes at low regret levels.

---