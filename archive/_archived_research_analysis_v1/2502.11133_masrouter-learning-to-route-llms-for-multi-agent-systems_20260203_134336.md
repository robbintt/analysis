---
title: 'MasRouter: Learning to Route LLMs for Multi-Agent Systems'
arxiv_id: '2502.11133'
source_url: https://arxiv.org/abs/2502.11133
generated_at: '2026-02-03T13:43:36'
quality_score: 9
citation_count: 37
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# MasRouter: Learning to Route LLMs for Multi-Agent Systems

*Yanwei Yue; Guibin Zhang; Boyang Liu; Guancheng Wan; Kun Wang; Dawei Cheng; Yiyan Qi*

---

> ###  Quick Facts
>
> | Metric | Benchmark | Result |
> | :--- | :--- | :--- |
> | **"Performance Improvement"** | MBPP | **+1.8% to 8.2%** |
> | **"Computational Reduction"** | HumanEval | **-52.07%** |
> | **"Integration Overhead Reduction"** | Mainstream MAS | **-17.21% to 28.17%** |
> | **"Quality Score"** | N/A | **9/10** |
> | **"Citations"** | N/A | 37 |

---

## Executive Summary

### Problem
Current Multi-Agent Systems (MAS) based on Large Language Models (LLMs) suffer from inefficiency and static configurations. Existing frameworks often rely on fixed agent and model setups, resulting in unnecessary computational costs or suboptimal performance for varying query complexities. This research addresses this by formally introducing the **Multi-Agent System Routing (MASR)** problem, which aims to dynamically optimize the selection of collaboration modes, agent roles, and LLM backbones to balance high utility against computational cost.

### Innovation
The core innovation is **MasRouter**, a framework designed to solve the MASR problem via a cascaded controller network. Unlike static systems, MasRouter dynamically constructs heterogeneous MAS architectures through three progressive steps:
1.  **Collaboration Determiner:** Selects the optimal topology based on query difficulty.
2.  **Role Allocator:** Assigns specific agent roles.
3.  **Agent LLM Router:** Selects the most appropriate LLM backbone for each role.

The system operates within a search space of models, roles, and topologies, utilizing a joint optimization objective function: `max E[U(S; Q, a) - 位路C(S; Q)]`.

### Results
Empirical validation confirms MasRouter effectively balances performance gains with computational efficiency:
*   **MBPP Benchmark:** Performance improved by **1.8% to 8.2%** over baselines.
*   **HumanEval Benchmark:** Computational overhead reduced by up to **52.07%**.
*   **Integration:** Reduced system overhead by **17.21% to 28.17%** within mainstream MAS frameworks.

### Impact
This work presents the first high-performing, cost-effective, inductive solution to the MASR problem. By unifying the optimization of collaboration modes, role allocation, and model selection, MasRouter establishes a new paradigm for dynamic, self-organizing multi-agent systems. It provides empirical evidence that optimizing system topology yields substantial benefits over simply scaling model size.

---

## Key Findings

*   **Performance Gains:** Achieved a **1.8% to 8.2%** improvement on the MBPP benchmark compared to baseline methods.
*   **Cost Efficiency:** Reduced computational overhead by up to **52.07%** on the HumanEval benchmark.
*   **Seamless Integration:** Integrates with mainstream MAS frameworks, reducing overhead by **17.21% to 28.17%**.
*   **Dynamic Balance:** Successfully balances effectiveness and efficiency by dynamically constructing multi-agent systems tailored to specific tasks.

---

## Methodology

The authors propose **MasRouter**, a framework built upon the Multi-Agent System Routing (MASR) problem formulation. The system employs a **cascaded controller network** to progressively construct a multi-agent system. This construction occurs through three distinct steps:

1.  **Collaboration Mode Determination**
2.  **Role Allocation**
3.  **LLM Routing**

This stepwise approach allows for the dynamic customization of the system architecture based on the specific requirements of the input query.

---

## Contributions

*   **Problem Formulation:** Introduced the **Multi-Agent System Routing (MASR)** problem, unifying the optimization of modes, roles, and models.
*   **Novel Framework:** Presented MasRouter as the first high-performing, cost-effective, inductive solution utilizing a cascaded controller architecture.
*   **Empirical Validation:** Provided comprehensive evidence demonstrating that optimizing collaboration modes and role allocation yields significant performance and efficiency gains over static approaches.

---

## Technical Details

### System Architecture & Search Space
MasRouter defines the search space as **S = (M, R, T)**, comprising:
*   **M:** LLM backbones
*   **R:** Agent roles
*   **T:** Collaboration modes

### Objective Function
The system aims to maximize the utility-cost trade-off:
`max E[U(S; Q, a) - 位路C(S; Q)]`

### Core Modules
The architecture is composed of three integrated modules:

1.  **Collaboration Determiner**
    *   Analyzes query difficulty.
    *   Selects the optimal topology (collaboration mode).

2.  **Role Allocator**
    *   Assigns specific roles to agents based on the determined topology.

3.  **Agent LLM Router**
    *   Selects specific LLM backbones for each agent based on their assigned roles.

### Optimization
The system employs **joint optimization** to update controller parameters. This update process relies on continuous feedback loops regarding both task performance and computational cost.

---

## Results

*   **Benchmark Performance (MBPP):** MasRouter outperformed baseline methods with a performance increase ranging from **1.8% to 8.2%**.
*   **Computational Efficiency (HumanEval):** Demonstrated significant cost savings, reducing computational overhead by up to **52.07%**.
*   **Framework Integration:** When applied to mainstream MAS frameworks, the system successfully reduced overall overhead by **17.21% to 28.17%**.