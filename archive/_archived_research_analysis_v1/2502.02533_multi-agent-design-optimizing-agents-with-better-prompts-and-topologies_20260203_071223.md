---
title: 'Multi-Agent Design: Optimizing Agents with Better Prompts and Topologies'
arxiv_id: '2502.02533'
source_url: https://arxiv.org/abs/2502.02533
generated_at: '2026-02-03T07:12:23'
quality_score: 9
citation_count: 40
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# Multi-Agent Design: Optimizing Agents with Better Prompts and Topologies

*Han Zhou; Xingchen Wan; Ruoxi Sun; Hamid Palangi; Shariq Iqbal; Ivan VuliÄ‡; Anna Korhonen; Sercan Ã–. ArÄ±k*

---

> ### ðŸ“Š Quick Facts
> * **Quality Score:** 9/10
> * **Proposed Framework:** MASS (Multi-Agent System Search)
> * **Underlying Model:** Gemini 1.5 Pro
> * **Optimization Strategy:** 3-Stage "Local-to-Global" Pipeline
> * **Key Performance Gain:** Block-level optimization improved accuracy from **62% to 79%**
> * **Datasets:** 7 Benchmarks (MATH, HotpotQA, LiveCodeBench, etc.)

---

## Executive Summary

The research addresses the inherent complexity and inefficiency of designing effective Multi-Agent Systems (MAS). While LLM-based agents are increasingly used to solve complex tasks, the design spaceâ€”defined by local agent instructions (prompts) and structural interaction patterns (topologies)â€”is vast and typically navigated through trial and error. 

The authors identify that the effectiveness of MAS is not merely a function of scaling compute or adding more agents, but rather depends critically on the interplay between specific prompts and topological arrangements. The key innovation is **MASS (Multi-Agent System Search)**, a novel automated framework designed to systematically optimize the MAS design space through a three-stage "local-to-global" pipeline:

1.  **Block-level Prompt Optimization (1PO):** Independently optimizing agent modules (Reflect, Debate, Summarize) using MIPRO.
2.  **Workflow Topology Optimization (2TO):** Utilizing an "Incremental Influence" metric and probabilistic pruning to sample valid structural configurations.
3.  **Workflow-level Prompt Optimization (3PO):** Global refinement of the fully composed system.

Evaluated using Gemini 1.5 Pro on diverse benchmarks, MASS consistently outperforms existing alternative methods like ADAS and AFlow. Crucially, stages 1 and 2 are parallelizable, offering significant computational efficiency advantages. This research shifts MAS design from an artisanal, intuition-based process to a rigorous, automated optimization discipline, establishing a new standard for efficiency and performance in agentic workflows.

---

## Key Findings

*   **Critical Factors Identified:** Prompts and topologies are identified as the two most critical factors influencing the effectiveness of Multi-Agent Systems (MAS).
*   **Interplay is Key:** Optimizing MAS requires considering the complex interplay between local agent instructions (prompts) and structural interaction patterns (topologies).
*   **Superior Performance:** Systems optimized using the proposed MASS framework significantly outperform existing alternative methods.
*   **Design Principles:** The optimization process yields concrete, data-driven design principles that can guide the future construction of effective multi-agent systems.

---

## Methodology

The authors propose **Multi-Agent System Search (MASS)**, an automated optimization framework designed to exploit the complex MAS design space. The approach utilizes a **three-stage interleaved optimization strategy** progressing from local to global scopes:

1.  **Block-level (local) prompt optimization**
2.  **Workflow topology optimization**
3.  **Workflow-level (global) prompt optimization**

The methodology employs a conditioned progression where each optimization stage is dependent upon and iteratively improved based on the results of the preceding stages.

---

## Technical Details

### Framework Overview
**MASS (Multi-Agent System Search)** is a multistage optimization algorithm designed for Multi-Agent Systems (MAS) using a 'local to global' strategy to optimize local agent instructions and structural interaction patterns.

### Search Space Definition

| Component | Elements |
| :--- | :--- |
| **Prompts** | â€¢ Instructions (defining roles and behavioral shaping)<br>â€¢ Few-shot Demonstrations (in-context examples) |
| **Agentic Building Blocks** | â€¢ **Reflect** (error correction)<br>â€¢ **Debate** (multi-agent discussion)<br>â€¢ **Summarize** (long-context capability)<br>â€¢ **Aggregate** (combining outputs)<br>â€¢ **Tool-use** (code execution or retrieval) |

### Optimization Stages

1.  **Block-level Prompt Optimization (1PO)**
    *   Independent optimization of agent modules.
    *   Utilizes MIPRO to jointly optimize instructions and 1-shot exemplars.

2.  **Workflow Topology Optimization (2TO)**
    *   Conditioned on 1PO results.
    *   Uses 'Incremental Influence' metric and probabilistic pruning to sample valid configurations in the sequence: `[summarize, reflect, debate, aggregate]`.

3.  **Workflow-level Prompt Optimization (3PO)**
    *   Final refinement of instructions on the fully composed MAS.
    *   Conditioned on the best topology from Stage 2.

### Computational Efficiency
Stages 1 and 2 optimization can be **completely parallelized**, unlike iterative baselines such as ADAS and AFlow, resulting in faster optimization times.

---

## Results

### Models and Datasets
*   **Model:** Gemini 1.5 Pro
*   **Datasates:** MATH, HotpotQA, LiveCodeBench, DROP, 2WikiMQA, HumanEval, MuSiQue

### Performance Insights
*   **Prompting vs. Scaling Compute:** On the MATH dataset, utilizing compute for effective prompting yields better accuracy than scaling agents with default prompts (Self-Consistency, Self-Refine, Multi-Agent Debate).
*   **Topology Efficacy:** Not all topologies are beneficial; beneficial topologies represent a small fraction of the design space (e.g., only 'debate' helped on HotpotQA).
*   **Comparative Results:** MASS consistently outperforms AFlow on MATH and MuSiQue. AFlow remains competitive on 2WikiMQA and HumanEval due to its 'expansion' phase using implicit textual gradients.

### Ablation Study Metrics
*   **1PO Gain:** +6% average gain over single-agent APO baseline.
*   **2TO Gain:** +3% average gain over block-level optimization.
*   **Pruning Necessity:** Significant performance degradation occurs without search space pruning or prior prompt optimization.

### Specific Metric Improvements
*   **Block-level Optimization:** 62% â†’ 79%
*   **Workflow-level Optimization:** 83% â†’ 85%

---

## Contributions

*   **Systematic Analysis:** A systematic in-depth analysis of the MAS design space to understand the underlying factors contributing to effective systems.
*   **Novel Framework (MASS):** The introduction of the MASS framework, a novel automated framework capable of simultaneously optimizing both the prompts and topologies of multi-agent systems.
*   **Algorithmic Pipeline:** The development of a specific three-stage algorithmic pipeline that efficiently navigates the design space by transitioning from local to global optimization.
*   **Design Principles:** The extraction and proposal of high-level design principles for MAS derived from the successful system configurations discovered by the MASS algorithm.

---

**Quality Score:** 9/10  
**References:** 40 citations