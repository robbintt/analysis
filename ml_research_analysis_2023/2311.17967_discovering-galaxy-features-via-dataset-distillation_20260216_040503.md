---
ver: rpa2
title: Discovering Galaxy Features via Dataset Distillation
arxiv_id: '2311.17967'
source_url: https://arxiv.org/abs/2311.17967
tags:
- dataset
- galaxy
- distillation
- images
- data
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces a novel method to extract galaxy morphological
  features using Dataset Distillation (DD), a technique that condenses a large dataset
  into a smaller synthetic one while retaining performance. The authors apply DD to
  galaxy classification, aiming to visualize the features a neural network "sees"
  when classifying galaxies.
---

# Discovering Galaxy Features via Dataset Distillation

## Quick Facts
- arXiv ID: 2311.17967
- Source URL: https://arxiv.org/abs/2311.17967
- Reference count: 40
- Key outcome: Introduces a novel method to extract galaxy morphological features using Dataset Distillation (DD), showing that synthesized images capture key differentiating attributes of galaxy types.

## Executive Summary
This work introduces a novel approach to extract galaxy morphological features using Dataset Distillation (DD), a technique that condenses large datasets into smaller synthetic ones while retaining performance. The authors develop a self-adaptive version of the Matching Trajectory (MTT) algorithm called Self-Adaptive Trajectory Matching (STM), which automates the distillation process and shows improved performance on computer vision benchmarks. Applied to galaxy classification, STM creates synthesized prototypical images that capture essential morphological features like core size, arm shape, and galactic bars, providing insights beyond predefined characteristics.

## Method Summary
The authors curate a high-confidence, class-balanced version of the Galaxy Zoo 2 dataset and train a CNN classifier to serve as a teacher model. They then apply their STM algorithm to distill this knowledge into synthetic images, using validation loss as an early stopping mechanism and automatically tuning the training trajectory size. The method incorporates rotational data augmentation to capture orientation-invariant features. Finally, they evaluate the distilled images by training new classifiers from scratch on them and comparing classification accuracy to baselines.

## Key Results
- STM algorithm shows improved performance on CIFAR-10 and CIFAR-100 benchmarks compared to MTT
- Distilled galaxy images capture key differentiating attributes of galaxy types including core size, arm shape, and galactic bars
- The blue tint of spiral galaxies in distilled images indicates the presence of young stars
- Models trained on distilled datasets achieve competitive accuracy compared to those trained on full datasets

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Dataset distillation can extract high-level morphological features from galaxy images that are directly useful for classification, bypassing the need for hand-crafted feature engineering.
- **Mechanism:** The self-adaptive trajectory matching (STM) algorithm optimizes a synthetic dataset by aligning the parameter trajectories of a model trained on the synthetic data with the trajectory of a model trained on real data. This alignment forces the distilled images to retain the essential features needed for accurate classification.
- **Core assumption:** The trajectory matching objective captures the most salient features for the classification task, and these features are visually interpretable.
- **Evidence anchors:**
  - [abstract] "Dataset distillation... can be viewed as a form of dataset curation as a bi-level optimization task involving a neural net classifier."
  - [section] "The MTT method... aims to approximate the optimization... via gradient descent by minimizing the difference between θD_t and θDsyn_t."
  - [corpus] Weak correlation; no direct mention of feature extraction in related papers.
- **Break condition:** If the distilled images lose their visual correspondence to real galaxy morphologies or the synthetic dataset fails to maintain classification accuracy, the mechanism fails.

### Mechanism 2
- **Claim:** The self-adaptive mechanism in STM automatically tunes the training trajectory size, eliminating the need for manual hyperparameter selection.
- **Mechanism:** STM monitors the validation loss trend during distillation. If the validation loss decreases significantly over time, it expands the training trajectory by adding more teacher epochs. This process continues until the validation loss no longer decreases significantly or a maximum iteration limit is reached.
- **Core assumption:** The validation loss is a reliable indicator of the synthetic dataset's capacity to capture knowledge from the teacher trajectory.
- **Evidence anchors:**
  - [abstract] "STM eliminates the need for some hyperparameters in MTT and introduces an early stopping mechanism based on validation loss."
  - [section] "To achieve this goal, we propose using a validation loss curve as an indicator of the capacity of the synthetic dataset."
  - [corpus] No direct mention of self-adaptive mechanisms in related papers.
- **Break condition:** If the validation loss is noisy or unreliable, or if the optimal trajectory size varies unpredictably across different datasets, the self-adaptive mechanism may fail.

### Mechanism 3
- **Claim:** Rotational data augmentation improves the distilled images' ability to capture orientation-invariant features, leading to better classification performance.
- **Mechanism:** By augmenting the training data with rotated versions of galaxy images, the model learns to recognize morphological features regardless of the galaxy's orientation. This augmented knowledge is then transferred to the distilled images, making them more representative of the true underlying galaxy morphologies.
- **Core assumption:** Galaxy morphologies are inherently rotationally symmetric or at least exhibit features that are orientation-invariant.
- **Evidence anchors:**
  - [abstract] "given that galaxy imaging does not have a preferred orientation, we also construct an augmented curated GZ2 by rotating each galaxy image 36 degrees for 10 times."
  - [section] "Data augmentation is often helpful in deep learning applications and given that galaxy imaging does not have a preferred orientation..."
  - [corpus] No direct mention of rotational augmentation in related papers.
- **Break condition:** If galaxy morphologies are highly orientation-dependent or if the augmentation introduces unrealistic distortions, the mechanism fails.

## Foundational Learning

- **Concept:** Dataset distillation and bi-level optimization
  - **Why needed here:** Understanding how dataset distillation works as a bi-level optimization problem is crucial for grasping the core mechanism of the STM algorithm.
  - **Quick check question:** What is the difference between the outer and inner loops in dataset distillation, and what are they optimizing?

- **Concept:** Matching training trajectories and gradient matching
  - **Why needed here:** The MTT and STM algorithms rely on matching the training trajectories of models trained on real and synthetic data. Understanding gradient matching is essential for understanding how these algorithms work.
  - **Quick check question:** How does gradient matching differ from other dataset distillation objectives, such as distribution matching?

- **Concept:** Convolutional neural networks and their application to galaxy morphology classification
  - **Why needed here:** The paper uses CNNs to classify galaxy morphologies, and the distilled images are intended to visualize what the CNN "sees." Understanding CNNs is crucial for interpreting the results.
  - **Quick check question:** How do CNNs extract features from images, and why are they particularly well-suited for image classification tasks?

## Architecture Onboarding

- **Component map:** Data curation -> Teacher model training -> Dataset distillation -> Evaluation
- **Critical path:** Data curation → Teacher model training → Dataset distillation → Evaluation
- **Design tradeoffs:**
  - Dataset size vs. accuracy: Using a smaller, curated dataset improves training efficiency but may limit the generalizability of the results.
  - Number of distilled images per class: Using fewer images per class reduces the computational cost of distillation but may lead to a loss of information.
  - Initialization method: Initializing the synthetic dataset from real images vs. noise can affect the quality of the distilled images.
- **Failure signatures:**
  - Distilled images that are visually uninterpretable or do not resemble real galaxies.
  - Models trained on the distilled dataset that perform significantly worse than models trained on the full dataset.
  - The STM algorithm failing to converge or producing unstable results.
- **First 3 experiments:**
  1. Train a CNN classifier on the curated Galaxy Zoo 2 dataset and evaluate its accuracy.
  2. Apply the STM algorithm to distill the knowledge from the trained classifier into a synthetic dataset with 1 image per class.
  3. Train models from scratch on the distilled dataset and compare their accuracy to models trained on the full dataset.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the distilled galaxy images capture spectral data characteristics in addition to morphological features?
- Basis in paper: [explicit] The authors state "This opens the possibility of extracting even more informative images when adding spectroscopic or multi-frequency data as additional inputs to the classifier in the future."
- Why unresolved: The current methodology focuses solely on visual morphology. The paper acknowledges this as a future direction but does not implement or test incorporating spectral data.
- What evidence would resolve it: Successfully training a classifier on galaxy images with additional spectral data channels and demonstrating that dataset distillation can extract meaningful features from this combined input.

### Open Question 2
- Question: What is the optimal trade-off between the number of distilled images per class and the quality/representativeness of the distilled features?
- Basis in paper: [inferred] The authors test 1, 10, and 50 images per class (IPC) but note that 10 IPC images are "visually closer to real galaxies" than 1 IPC, suggesting a quality tradeoff exists.
- Why unresolved: The paper presents results for multiple IPC values but does not systematically analyze the diminishing returns or optimal point for different galaxy classification tasks.
- What evidence would resolve it: A comprehensive study varying IPC values and measuring classification accuracy, feature representativeness, and computational efficiency to identify the optimal balance.

### Open Question 3
- Question: How do the distilled galaxy features relate to physical processes in galaxy evolution, such as star formation rates or merger history?
- Basis in paper: [explicit] The authors note that "the blue tint of spiral galaxies indicates the presence of young stars" in the distilled images, suggesting a connection to physical processes.
- Why unresolved: While the paper identifies some morphological features, it does not establish a systematic connection between the distilled features and underlying physical mechanisms driving galaxy evolution.
- What evidence would resolve it: Correlating the distilled features with independent measurements of physical properties (e.g., star formation rates, metallicity, merger signatures) to validate and interpret the extracted features.

## Limitations

- Claims about "discovering" features beyond predefined characteristics are limited by the curated dataset's selection criteria and the inherent constraints of using a 9-class taxonomy.
- Results may not generalize beyond the specific GZ2 subset used, raising questions about the broader applicability of the method.
- The validation is primarily internal (comparing distilled vs. real data performance) rather than external (comparing against astrophysical domain knowledge).

## Confidence

- Technical implementation of STM and its improved performance metrics: High confidence
- Claims about visualizing galaxy morphological features through dataset distillation: Medium confidence
- Broader claims about scientific discovery of new galaxy features: Low confidence

## Next Checks

1. Test STM on additional galaxy morphology datasets with different taxonomies to assess generalizability beyond the GZ2 9-class system.

2. Conduct a blinded expert review where astrophysicists classify distilled images without knowing the ground truth labels to assess feature authenticity.

3. Compare distilled features against independent morphological measurements (e.g., Sérsic indices, bulge-to-disk ratios) from the literature to verify scientific validity.