---
ver: rpa2
title: Frequency Domain-based Dataset Distillation
arxiv_id: '2311.08819'
source_url: https://arxiv.org/abs/2311.08819
tags:
- uni00000013
- frequency
- dataset
- fred
- domain
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces FreD, a novel dataset distillation method
  that leverages frequency domain parameterization to improve efficiency and performance.
  Unlike conventional spatial domain methods, FreD transforms data into the frequency
  domain, selects important frequency dimensions based on explained variance ratio,
  and optimizes only those dimensions.
---

# Frequency Domain-based Dataset Distillation

## Quick Facts
- arXiv ID: 2311.08819
- Source URL: https://arxiv.org/abs/2311.08819
- Authors: 
- Reference count: 40
- Key outcome: FreD achieves significant performance gains in dataset distillation by leveraging frequency domain parameterization, improving efficiency and performance across various benchmark datasets.

## Executive Summary
This paper introduces FreD, a novel dataset distillation method that leverages frequency domain parameterization to improve efficiency and performance. Unlike conventional spatial domain methods, FreD transforms data into the frequency domain, selects important frequency dimensions based on explained variance ratio, and optimizes only those dimensions. This approach reduces memory requirements and allows more instances to be synthesized within the same budget. FreD is compatible with existing distillation methods and consistently improves their performance across various benchmark datasets, including SVHN, CIFAR-10, CIFAR-100, and ImageNet-Subset. Empirical results show that FreD achieves significant performance gains, especially under extreme budget constraints, while also demonstrating robustness to data corruption and generalization across different network architectures.

## Method Summary
FreD transforms spatial domain images to frequency domain using Discrete Cosine Transform (DCT), selects frequency dimensions based on explained variance ratio (EVR) at the class level, applies binary masking to retain only top-k dimensions, and performs dataset distillation optimization in this compressed frequency space. The method maintains orthogonality with existing distillation techniques by simply replacing the spatial parameterization with frequency domain parameterization while keeping the same distillation objectives. During inference, the selected frequency dimensions are inverse transformed back to spatial domain to generate synthetic training data.

## Key Results
- FreD consistently outperforms spatial domain methods across all tested IPC settings, with particularly dramatic improvements at extreme compression levels (IPC=1)
- The method achieves 15.75% improvement on SVHN, 2.43% on CIFAR-10, 3.23% on CIFAR-100, and 3.04% on ImageNet-Subset compared to state-of-the-art spatial methods
- FreD demonstrates strong robustness to various data corruptions and generalizes well across different network architectures

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Frequency domain compression preserves most task-relevant information while reducing dimensionality.
- Mechanism: Spatial domain images have their energy concentrated in low-frequency components; by selecting only top-k frequency dimensions based on explained variance ratio (EVR), most information is retained while significantly reducing the number of parameters needed per instance.
- Core assumption: The frequency domain inherently concentrates task-relevant information in fewer dimensions than the spatial domain.
- Evidence anchors:
  - [abstract] "By leveraging the concentration of spatial domain information on specific frequency components, FreD intelligently selects a subset of frequency dimensions for optimization"
  - [section] "natural images tend to exhibit the energy compaction property, which is a concentration of energy in the low-frequency region"
  - [corpus] No direct evidence; the claim is primarily supported by the paper's theoretical and empirical analysis.
- Break condition: If task-relevant information is distributed across high-frequency components (e.g., fine medical details, digital watermarks), EVR-based masking may lose critical information.

### Mechanism 2
- Claim: Gradient-based optimization in frequency domain is more efficient than in spatial domain.
- Mechanism: Gradients of dataset distillation losses (e.g., trajectory matching) are concentrated in fewer frequency dimensions, allowing faster convergence with fewer parameters.
- Core assumption: The optimization landscape in frequency domain is more compact than in spatial domain.
- Evidence anchors:
  - [abstract] "Through the selection of frequency dimensions based on the explained variance, FreD demonstrates both theoretical and empirical evidence of its ability to operate efficiently within a limited budget"
  - [section] "Figure 2b shows the magnitude of gradient for LDD(S, D) i.e. ∥∇SLDD(S, D)∥... the gradients w.r.t frequency domain are condensed into certain dimensions"
  - [corpus] Weak evidence; no corpus papers directly discuss gradient concentration in frequency domain for dataset distillation.
- Break condition: If the dataset distillation loss landscape does not exhibit frequency concentration (e.g., certain augmentation strategies), the efficiency gain may diminish.

### Mechanism 3
- Claim: FreD is orthogonal to existing dataset distillation methods and improves their performance.
- Mechanism: By replacing spatial domain parameterization with frequency domain parameterization while keeping the same distillation objective, FreD achieves better performance without changing the loss function.
- Core assumption: The frequency domain parameterization can be applied to any existing spatial domain dataset distillation method.
- Evidence anchors:
  - [abstract] "Furthermore, based on the orthogonal compatibility of FreD with existing methods, we confirm that FreD consistently improves the performances of existing distillation methods"
  - [section] "FreD can be orthogonally applied to existing spatial-based methods without constraining the available loss functions"
  - [corpus] Weak evidence; no corpus papers directly discuss orthogonal compatibility of frequency-based parameterization with existing methods.
- Break condition: If the distillation method relies heavily on spatial domain-specific operations (e.g., spatial augmentations), the compatibility may break.

## Foundational Learning

- Concept: Discrete Cosine Transform (DCT)
  - Why needed here: DCT is the primary frequency transform used in FreD to convert spatial domain images to frequency domain.
  - Quick check question: What property of DCT makes it particularly suitable for image compression?

- Concept: Explained Variance Ratio (EVR)
  - Why needed here: EVR is used to select the most informative frequency dimensions for each class.
  - Quick check question: How does EVR differ from simply selecting low-frequency components?

- Concept: Dataset Distillation
  - Why needed here: FreD is a parameterization method for dataset distillation, so understanding the core concept is essential.
  - Quick check question: What is the key difference between dataset distillation and data compression?

## Architecture Onboarding

- Component map: Synthetic Frequency Memory -> Binary Mask Memory -> Inverse Frequency Transform -> Dataset Distillation Training
- Critical path: Synthetic data generation → Frequency transform → EVR-based masking → Inverse transform → Dataset distillation training
- Design tradeoffs:
  - More frequency dimensions per instance → Better reconstruction quality but fewer total instances
  - Fewer frequency dimensions per instance → More instances but potential quality loss
  - Different frequency transforms (DCT, DFT, DWT) → Different performance characteristics
- Failure signatures:
  - Poor performance despite high frequency dimension count → Masking strategy may not match task requirements
  - Training instability → Frequency transform or inverse transform implementation issues
  - Cross-architecture generalization failure → Frequency domain may not capture architecture-invariant features
- First 3 experiments:
  1. Implement DCT-based frequency transform and verify energy compaction property on sample images
  2. Implement EVR-based masking and visualize selected frequency dimensions for different classes
  3. Integrate FreD with a simple dataset distillation method (e.g., DC) and compare performance on CIFAR-10 with IPC=1

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the impact of using frequency transforms that are not linearly bijective on the performance of FreD?
- Basis in paper: [explicit] The paper discusses the importance of linear bijectivity in the theoretical analysis but notes potential issues with non-bijective transforms.
- Why unresolved: The paper only briefly mentions potential issues without providing empirical evidence or a detailed analysis of the impact on performance.
- What evidence would resolve it: Experimental results comparing FreD's performance using bijective and non-bijective frequency transforms on various datasets.

### Open Question 2
- Question: How does the choice of masking strategy affect the robustness of FreD to different types of dataset corruption?
- Basis in paper: [inferred] The paper demonstrates FreD's robustness to various corruptions but uses EVR-based masking consistently. It mentions the possibility of using gradient-based masking as an alternative.
- Why unresolved: The paper does not explore the impact of different masking strategies on robustness to specific types of corruption.
- What evidence would resolve it: Comparative experiments evaluating FreD's robustness using different masking strategies (EVR-based, gradient-based, etc.) across various corruption types.

### Open Question 3
- Question: Can FreD be effectively applied to datasets with high-frequency task-specific information, such as medical imaging?
- Basis in paper: [explicit] The paper acknowledges that FreD might struggle with datasets where essential information is in the high-frequency region, citing medical imaging as an example.
- Why unresolved: The paper does not provide any experimental results or detailed analysis on applying FreD to such datasets.
- What evidence would resolve it: Empirical studies applying FreD to medical imaging datasets and comparing its performance with spatial domain methods.

## Limitations
- Dataset bias: Effectiveness relies on energy compaction property of natural images, which may not hold for specialized domains
- Computational overhead: Frequency transforms add computational cost that isn't fully quantified against memory savings
- Cross-architecture generalization: Limited systematic ablation studies on which architectural features are compatible

## Confidence
- Empirical results on benchmark datasets: Medium-High
- Theoretical guarantees about frequency concentration properties: Low-Medium
- Claims about orthogonal compatibility with existing methods: Medium

## Next Checks
1. Implement and compare FreD with DFT and DWT transforms on CIFAR-10 to quantify the impact of transform choice on performance and convergence speed.
2. Test FreD on a dataset where high-frequency information is critical (e.g., MNIST with added noise, or a medical imaging dataset) to validate the energy compaction assumption.
3. Measure and compare total training time and memory usage between spatial domain methods and FreD across different IPC settings to quantify the actual efficiency gains.