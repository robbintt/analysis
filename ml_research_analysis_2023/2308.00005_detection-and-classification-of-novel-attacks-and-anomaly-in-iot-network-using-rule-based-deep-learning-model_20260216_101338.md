---
ver: rpa2
title: Detection and Classification of Novel Attacks and Anomaly in IoT Network using
  Rule based Deep Learning Model
arxiv_id: '2308.00005'
source_url: https://arxiv.org/abs/2308.00005
tags:
- attack
- detection
- learning
- network
- attacks
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper proposes a rule-based deep learning model for detecting
  and classifying novel attacks and anomalies in IoT networks. The model uses a two-stage
  approach: a deep learning stage to learn attack patterns and calculate probability
  distributions, and a rule-based stage to classify input samples into "Normal," "Known
  Attack," or "Novel Attack" categories.'
---

# Detection and Classification of Novel Attacks and Anomaly in IoT Network using Rule based Deep Learning Model

## Quick Facts
- arXiv ID: 2308.00005
- Source URL: https://arxiv.org/abs/2308.00005
- Authors: 
- Reference count: 39
- Primary result: Achieves 99.5% accuracy and 99.9% recall in detecting novel attacks and anomalies in IoT networks using a rule-based deep learning model

## Executive Summary
This paper proposes a rule-based deep learning model for detecting and classifying novel attacks and anomalies in IoT networks. The model uses a two-stage approach: a deep learning stage to learn attack patterns and calculate probability distributions, and a rule-based stage to classify input samples into "Normal," "Known Attack," or "Novel Attack" categories. The model is trained and tested on the CICIDS 2017 dataset, which contains various attack types and normal traffic data. The proposed model achieves an overall accuracy of 99.5% and a recall rate of 99.9% for four attack categories. It also maintains a low false positive rate (<0.025) and a high true positive rate (>98.5%). The rule-based approach enhances security by efficiently handling large amounts of network traffic and improving detection accuracy compared to traditional machine learning techniques.

## Method Summary
The proposed model uses a two-stage approach for detecting and classifying novel attacks and anomalies in IoT networks. First, a deep neural network learns attack patterns and calculates probability distributions for each attack class. The network consists of 78 input neurons, 7 hidden layers with ReLU activation, and 5 output neurons with Softmax activation. The model is trained on 70% of the CICIDS 2017 dataset and tested on the remaining 30%. In the second stage, a rule-based classifier uses predefined probability thresholds to categorize network traffic as "Normal," "Known Attack," or "Novel Attack." The model is evaluated using standard metrics such as accuracy, recall, false positive rate (FPR), and false negative rate.

## Key Results
- The model achieves an overall accuracy of 99.5% and a recall rate of 99.9% for four attack categories.
- It maintains a low false positive rate (<0.025) and a high true positive rate (>98.5%).
- The rule-based approach enhances security by efficiently handling large amounts of network traffic and improving detection accuracy compared to traditional machine learning techniques.

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The rule-based deep learning model achieves high detection accuracy by combining probability thresholds with explicit rule definitions for classifying network traffic.
- Mechanism: The model first uses a deep neural network to compute probability distributions for each attack class in the input sample. These probabilities are then fed into a rule-based system that applies predefined thresholds to categorize the traffic as "Normal," "Known Attack," or "Novel Attack."
- Core assumption: The probability outputs from the deep learning stage accurately reflect the likelihood of each attack class, and the chosen thresholds (.80 for normal and known attacks, < .80 for novel) effectively separate the classes.
- Evidence anchors:
  - [abstract] "The model uses a two-stage approach: a deep learning stage to learn attack patterns and calculate probability distributions, and a rule-based stage to classify input samples..."
  - [section] "The classes are 'Normal', 'Known attack' and 'Novel attack'. We employ data with three new attack types... to test the proposed model's propensity to recognize novel attacks."
- Break condition: If the probability distributions from the deep learning stage are not well-calibrated or the thresholds are not properly tuned, the rule-based classification will misclassify traffic, leading to false positives or negatives.

### Mechanism 2
- Claim: The model maintains low false positive and false negative rates by leveraging a deep learning architecture with ReLU activation and Softmax output, combined with cross-entropy loss and Adam optimizer.
- Mechanism: The deep neural network uses ReLU activation functions in the hidden layers for faster convergence and Softmax in the output layer to produce a normalized probability distribution. The Adam optimizer with a small learning rate (0.0001) and cross-entropy loss function ensures stable training and minimizes classification errors.
- Core assumption: The chosen architecture, activation functions, optimizer, and loss function are well-suited for the CICIDS2017 dataset and the specific classification task of distinguishing between normal, known, and novel attacks.
- Evidence anchors:
  - [section] "Seven hidden layers and the activation function are both part of the deep learning architecture. In the proposed architecture, we have used ReLU activation function in the hidden layer... The output layer and Softmax() function both have 5 neurons, matching the number of attack types in the training dataset."
  - [section] "Cross-entropy is employed as the cost function in the deep learning model, while Adam is used as the optimizer with a learning rate of 0.0001."
- Break condition: If the dataset characteristics change significantly or the model architecture is not well-suited for the new data, the low false positive and false negative rates may not be maintained.

### Mechanism 3
- Claim: The model's effectiveness is demonstrated by its high accuracy (99.5%) and recall (99.9%) rates on the CICIDS2017 dataset, with low false positive rates (<0.025) and false negative rates.
- Mechanism: The model's performance is evaluated using standard metrics such as accuracy, recall, false positive rate (FPR), and false negative rate. The high accuracy and recall rates indicate that the model correctly identifies a large proportion of attacks, while the low FPR and false negative rates suggest that it minimizes misclassifications.
- Core assumption: The CICIDS2017 dataset is representative of real-world IoT network traffic and contains a diverse range of attack types, allowing for a comprehensive evaluation of the model's performance.
- Evidence anchors:
  - [section] "The system's overall accuracy is 99.5%, while the recall rate for the four categories is 99.9%. The ruled-based model performs well to classify the Infiltration and Heartbleed novel attacks."
  - [section] "The result shows a low false positive (FP) rate of less than 0.025 and a high true positive (TP) rate of more than 98.5%."
- Break condition: If the CICIDS2017 dataset does not accurately represent the diversity and complexity of real-world IoT network traffic, or if the model is tested on a different dataset with different characteristics, the high accuracy and recall rates may not be achieved.

## Foundational Learning

- Concept: Probability Distributions and Classification Thresholds
  - Why needed here: Understanding how the deep learning model generates probability distributions for each attack class and how the rule-based system uses these probabilities to classify network traffic is crucial for grasping the model's decision-making process.
  - Quick check question: How does the rule-based system determine whether a network traffic sample is "Normal," "Known Attack," or "Novel Attack" based on the probability distributions?

- Concept: Deep Learning Architecture and Optimization
  - Why needed here: Familiarity with the components of the deep neural network (input layer, hidden layers, output layer, activation functions, optimizer, and loss function) and their roles in the model's training and performance is essential for understanding how the model learns to detect and classify attacks.
  - Quick check question: What is the purpose of using ReLU activation functions in the hidden layers and Softmax in the output layer, and how do they contribute to the model's performance?

- Concept: Performance Metrics for Intrusion Detection Systems
  - Why needed here: Knowledge of the key performance metrics used to evaluate intrusion detection systems, such as accuracy, recall, false positive rate (FPR), and false negative rate, is necessary for interpreting the model's results and comparing its performance to other approaches.
  - Quick check question: What do the accuracy, recall, FPR, and false negative rate metrics indicate about the model's ability to detect and classify network attacks, and how are they calculated?

## Architecture Onboarding

- Component map:
  - Data preprocessing: Cleaning, normalization, and feature scaling of the CICIDS2017 dataset
  - Deep learning model: Input layer (78 neurons), 7 hidden layers with ReLU activation, output layer (5 neurons) with Softmax activation
  - Rule-based classifier: Threshold-based rules for classifying network traffic as "Normal," "Known Attack," or "Novel Attack"
  - Performance evaluation: Calculation of accuracy, recall, FPR, and false negative rate on the test dataset

- Critical path:
  1. Preprocess the CICIDS2017 dataset (cleaning, normalization, feature scaling)
  2. Train the deep learning model on the preprocessed training dataset
  3. Apply the trained model to the test dataset to generate probability distributions
  4. Use the rule-based classifier to categorize network traffic based on the probability distributions
  5. Evaluate the model's performance using accuracy, recall, FPR, and false negative rate metrics

- Design tradeoffs:
  - Using a deep learning model with multiple hidden layers and ReLU activation allows for complex pattern learning but may increase computational complexity and training time
  - The rule-based approach provides interpretability and control over the classification process but relies on well-tuned thresholds
  - Balancing the dataset to address class imbalance may improve the model's performance on minority attack classes but could lead to overfitting or reduced generalization

- Failure signatures:
  - High false positive rates: The model is incorrectly classifying normal traffic as attacks, indicating potential issues with the rule-based thresholds or the deep learning model's ability to distinguish between normal and attack traffic
  - High false negative rates: The model is failing to detect actual attacks, suggesting problems with the deep learning model's pattern recognition or the rule-based classifier's ability to identify known and novel attacks
  - Low accuracy or recall: The model's overall performance is suboptimal, which could be due to issues with the dataset, the deep learning architecture, or the rule-based classification rules

- First 3 experiments:
  1. Evaluate the model's performance on a subset of the CICIDS2017 dataset containing only the most common attack types to assess its ability to detect and classify well-represented attacks
  2. Test the model's robustness by introducing noise or anomalies into the network traffic samples and measuring its ability to maintain low false positive and false negative rates
  3. Compare the model's performance with and without the rule-based classifier to determine the impact of the rule-based approach on the overall accuracy and interpretability of the results

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the rule-based deep learning model perform on real-time network traffic data compared to benchmark datasets like CICIDS2017?
- Basis in paper: [inferred] The paper mentions that the model is evaluated on the CICIDS2017 dataset, but also notes that the dataset alone does not offer enough reference points for developing a comprehensive picture in general, and the model may exhibit varied behaviors on real-time traffic data.
- Why unresolved: The paper does not provide any experimental results or analysis of the model's performance on real-time network traffic data.
- What evidence would resolve it: Conducting experiments to evaluate the model's performance on real-time network traffic data and comparing the results with those obtained from benchmark datasets like CICIDS2017.

### Open Question 2
- Question: How does the rule-based deep learning model handle zero-day attacks that are not present in the training dataset?
- Basis in paper: [explicit] The paper mentions that the model classifies network traffic into "Normal," "Known Attack," or "Novel Attack" categories, and in case of a novel attack, the traffic is sent to a cyber forensic team for further analysis.
- Why unresolved: The paper does not provide any details on how the model detects and classifies zero-day attacks that are not present in the training dataset.
- What evidence would resolve it: Analyzing the model's behavior and performance when exposed to zero-day attacks that are not present in the training dataset.

### Open Question 3
- Question: How does the rule-based deep learning model scale to handle large-scale IoT networks with diverse devices and traffic patterns?
- Basis in paper: [inferred] The paper mentions that the model is designed to handle large amounts of network traffic efficiently, but does not provide any details on its scalability to large-scale IoT networks.
- Why unresolved: The paper does not provide any experimental results or analysis of the model's scalability to large-scale IoT networks.
- What evidence would resolve it: Conducting experiments to evaluate the model's performance and scalability on large-scale IoT networks with diverse devices and traffic patterns.

## Limitations
- The exact architecture of the 7 hidden layers is unspecified, preventing full verification of the model's design.
- The probability thresholds for the rule-based classification stage are not provided, making it difficult to reproduce the model's decision-making process.
- The paper lacks ablation studies to isolate the contributions of the deep learning and rule-based components separately.

## Confidence
- Medium: While the reported results are impressive, several critical details are missing that prevent full verification of the model's performance and design.

## Next Checks
1. Implement the model with varying numbers of neurons per hidden layer (e.g., 64, 128, 256) to determine optimal architecture for this task.
2. Test the model's performance on the BoT-IoT dataset to assess generalization across different IoT attack scenarios.
3. Conduct an ablation study comparing the full rule-based deep learning model against a pure deep learning approach to quantify the contribution of the rule-based component.