---
ver: rpa2
title: 'CAD-DA: Controllable Anomaly Detection after Domain Adaptation by Statistical
  Inference'
arxiv_id: '2310.14608'
source_url: https://arxiv.org/abs/2310.14608
tags:
- inference
- cad-da
- data
- domain
- after
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper proposes CAD-DA, a statistical method for testing anomaly
  detection results under domain adaptation. The key idea is to leverage selective
  inference to handle the influence of domain adaptation, enabling valid inference
  while controlling false positive rate.
---

# CAD-DA: Controllable Anomaly Detection after Domain Adaptation by Statistical Inference

## Quick Facts
- arXiv ID: 2310.14608
- Source URL: https://arxiv.org/abs/2310.14608
- Authors: 
- Reference count: 40
- Primary result: CAD-DA achieves highest true positive rate among competing methods while controlling false positive rate through conditional selective inference

## Executive Summary
This paper addresses the challenge of detecting anomalies in a target domain when only limited data is available, by leveraging a related source domain. The proposed method, CAD-DA, combines domain adaptation with statistical inference to control the false positive rate while maximizing the true positive rate. By using conditional selective inference to handle the selection bias introduced by both domain adaptation and anomaly detection, CAD-DA provides a rigorous framework for valid statistical inference in this setting. The method is demonstrated to outperform competing approaches on both synthetic and real-world datasets.

## Method Summary
CAD-DA is a statistical method for testing anomaly detection results under domain adaptation. It leverages selective inference to handle the influence of domain adaptation, enabling valid inference while controlling the false positive rate. The method applies Optimal Transport-based domain adaptation to transform source data to the target domain, followed by anomaly detection. Valid p-values are computed using conditional selective inference, conditioning on the results of both domain adaptation and anomaly detection. A hierarchical line search approach is employed to efficiently identify the truncation region, minimizing the false negative rate while maintaining FPR control. The method can be applied to various anomaly detection algorithms whose operations can be characterized by linear or quadratic inequalities.

## Key Results
- CAD-DA achieves the highest true positive rate among competing methods while properly controlling the false positive rate
- The method successfully extends to multi-dimensional data while maintaining statistical guarantees
- Experimental results on synthetic and real-world datasets demonstrate the effectiveness of CAD-DA in practical scenarios

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** The proposed method controls the false positive rate (FPR) under a specified significance level α by leveraging conditional selective inference to handle the influence of domain adaptation.
- **Mechanism:** By conditioning on the anomaly detection results after domain adaptation, the method computes a valid p-value that accounts for the selection bias introduced by both the adaptation and detection processes. This conditioning ensures that the FPR is theoretically controlled at the desired level.
- **Core assumption:** The anomaly detection algorithm's operations can be characterized by linear or quadratic inequalities, allowing for the analytical characterization of the conditional data space.

### Mechanism 2
- **Claim:** The hierarchical line search approach minimizes the false negative rate (FNR) by efficiently identifying the truncation region Z without excessive conditioning.
- **Mechanism:** The method breaks down the problem into sub-problems by conditioning on the transportation for domain adaptation and the steps of the anomaly detection algorithm. It then hierarchically combines these steps to efficiently characterize the truncation region Z, which is used to compute the selective p-value.

### Mechanism 3
- **Claim:** The method extends to multi-dimensional data by generalizing the test statistic and conditional distribution to account for multiple dimensions.
- **Mechanism:** For multi-dimensional data, the test statistic is defined as the sum of absolute differences across all dimensions. The conditional distribution is then computed by extending the techniques used in the univariate case to handle the additional complexity of multiple dimensions.

## Foundational Learning

- **Concept:** Conditional selective inference
  - **Why needed here:** To handle the selection bias introduced by domain adaptation and anomaly detection, ensuring valid statistical inference.
  - **Quick check question:** How does conditioning on the anomaly detection results after domain adaptation help control the false positive rate?

- **Concept:** Optimal transport-based domain adaptation
  - **Why needed here:** To transfer data from a source domain to a target domain, enabling anomaly detection in scenarios with limited target data.
  - **Quick check question:** What is the role of the optimal transport matrix in transforming the source data to the target domain?

- **Concept:** Hierarchical line search
  - **Why needed here:** To efficiently identify the truncation region Z, minimizing the false negative rate while controlling the false positive rate.
  - **Quick check question:** How does the hierarchical line search approach differ from a naive search in terms of efficiency?

## Architecture Onboarding

- **Component map:** Data preprocessing -> Domain adaptation -> Anomaly detection -> Statistical inference -> Evaluation
- **Critical path:** Data preprocessing → Domain adaptation → Anomaly detection → Statistical inference → Evaluation
- **Design tradeoffs:**
  - Computational complexity vs. accuracy in identifying the truncation region Z
  - Flexibility in supporting different anomaly detection algorithms vs. complexity in characterizing their operations
  - Extension to multi-dimensional data vs. computational feasibility
- **Failure signatures:**
  - Inability to control FPR under the specified significance level
  - High FNR indicating excessive false negatives
  - Computational infeasibility for high-dimensional data
- **First 3 experiments:**
  1. **Synthetic univariate data:** Generate synthetic data with known anomalies and evaluate FPR and TPR for different sample sizes and anomaly strengths
  2. **Synthetic multi-dimensional data:** Generate synthetic multi-dimensional data and assess the impact of dimensionality on FPR and TPR
  3. **Real-world data:** Apply the method to real-world datasets (e.g., heart disease dataset) and compare FPR and TPR with baseline methods

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** Can the CAD-DA method be extended to handle MMD-based domain adaptation methods?
- **Basis in paper:** [explicit] The paper states that the method currently does not support MMD-based DAs and suggests a potential solution involving a sampling-based approach to approximate the truncation region.
- **Why unresolved:** The paper only mentions this as a future direction without providing concrete details or experimental validation.
- **What evidence would resolve it:** A working implementation of CAD-DA with MMD-based DA and experimental results showing valid FPR control would resolve this question.

### Open Question 2
- **Question:** How does the CAD-DA method perform when applied to more complex anomaly detection algorithms beyond those with analytically characterizable events?
- **Basis in paper:** [explicit] The paper states that the method is applicable to AD algorithms with analytically characterizable events, such as MAD and robust regression methods, but mentions extending it to more complex AD algorithms as a valuable contribution.
- **Why unresolved:** The paper does not provide any experimental results or theoretical analysis for AD algorithms that do not have analytically characterizable events.
- **What evidence would resolve it:** Experimental results showing the performance of CAD-DA with complex AD algorithms that do not have analytically characterizable events would resolve this question.

### Open Question 3
- **Question:** How does the hierarchical line search in CAD-DA affect the true positive rate compared to using only extra-conditioning?
- **Basis in paper:** [explicit] The paper mentions that the hierarchical line search step is introduced to remove the extra-conditioning for the purpose of minimizing the false negative rate (FNR) and shows that CAD-DA has a higher true positive rate compared to CAD-DA-oc in the experiments.
- **Why unresolved:** While the paper demonstrates the effectiveness of the hierarchical line search in improving TPR, it does not provide a detailed analysis of the trade-off between FPR control and TPR improvement when using the hierarchical line search versus only extra-conditioning.
- **What evidence would resolve it:** A detailed analysis of the trade-off between FPR control and TPR improvement when using the hierarchical line search versus only extra-conditioning, along with experimental results, would resolve this question.

## Limitations

- The method's effectiveness relies on the ability to characterize anomaly detection operations through linear or quadratic inequalities, which may not hold for all detection algorithms.
- The computational complexity for high-dimensional data remains uncertain, with limited empirical evidence provided in the paper.
- The method currently does not support MMD-based domain adaptation methods, limiting its applicability in certain scenarios.

## Confidence

- False positive rate control under α: High confidence based on rigorous conditional selective inference framework
- Hierarchical line search efficiency: Medium confidence due to limited computational complexity analysis
- Multi-dimensional extension: Medium confidence with weak empirical support

## Next Checks

1. Evaluate computational runtime and scalability for high-dimensional datasets (d > 10) to assess practical feasibility
2. Test the method with diverse anomaly detection algorithms beyond MAD to verify the generality of the inequality characterization approach
3. Conduct extensive experiments across multiple real-world domains to validate FPR control under varying domain shift conditions