---
ver: rpa2
title: C(NN)FD -- a deep learning framework for turbomachinery CFD analysis
arxiv_id: '2306.05889'
source_url: https://arxiv.org/abs/2306.05889
tags:
- clearance
- variations
- performance
- flow
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The study addresses the challenge of predicting the impact of manufacturing
  and build variations, particularly tip clearance variations, on the performance
  of axial compressors in gas turbines. This is of significant industrial and environmental
  relevance due to the associated scatter in efficiency and CO2 emissions.
---

# C(NN)FD -- a deep learning framework for turbomachinery CFD analysis

## Quick Facts
- arXiv ID: 2306.05889
- Source URL: https://arxiv.org/abs/2306.05889
- Reference count: 22
- Primary result: Real-time CFD predictions with accuracy comparable to benchmarks for manufacturing variation effects

## Executive Summary
This paper presents C(NN)FD, a novel deep learning framework that predicts the impact of manufacturing variations on axial compressor performance in gas turbines. The framework achieves real-time predictions with accuracy comparable to traditional CFD while reducing computational costs significantly. By using a U-Net architecture with 3D convolutions and residual connections, C(NN)FD learns the mapping from manufacturing variations to full 3D flow fields, enabling rapid assessment of design changes. The methodology is generalizable across different compressor designs and scalable to industrial applications through intelligent data filtering.

## Method Summary
The C(NN)FD framework uses a U-Net variant with 3D convolutions and residual connections to predict the full 3D flow field from manufacturing variation inputs. The method extracts engineering-relevant data from CFD simulations, reducing computational cost while retaining critical information. The network is trained on 500 CFD simulations with tip clearance variations between 0.1% and 2.0% of blade height, using Latin-hypercubic sampling. After predicting the flow field, the framework calculates overall performance metrics including mass-flow, pressure-ratio, and polytropic efficiency through mass-flow averaging of radial profiles.

## Key Results
- Achieved R2 close to 1 and MAE smaller than known CFD uncertainties for mass-flow, pressure-ratio, and polytropic efficiency predictions
- Demonstrated real-time predictions with accuracy comparable to CFD benchmarks
- Showed excellent qualitative agreement between predicted and ground truth flow fields across all test cases
- Reduced computational requirements by filtering only engineering-relevant CFD data while maintaining accuracy

## Why This Works (Mechanism)

### Mechanism 1
- Claim: C(NN)FD predicts the full 3D flow field in real-time with accuracy comparable to CFD.
- Mechanism: A U-Net variant with 3D convolutions and residual connections learns the mapping from tip clearance inputs to flow field outputs. The architecture captures both low-level and high-level flow features through its encoder-decoder structure with skip connections.
- Core assumption: The flow field can be accurately represented on a simplified grid that retains all engineering-relevant information while reducing computational cost.
- Evidence anchors:
  - [abstract] "The proposed C(NN)FD architecture achieves in real-time accuracy comparable to the CFD benchmark"
  - [section] "The C(NN)FD architecture illustrated in Fig. 9 is a novel variant of the U-Net, with 3D convolutions and residual connections"
  - [corpus] No direct corpus evidence available for this specific architecture, but related work on U-Nets for flow prediction exists
- Break condition: If the flow field cannot be adequately represented on the simplified grid, or if the residual connections fail to improve convergence for larger models.

### Mechanism 2
- Claim: The methodology is generalizable to different compressor designs and manufacturing variations.
- Mechanism: By predicting the flow field and then calculating overall performance using relevant physical equations, the framework can adapt to different geometries and operating conditions without requiring retraining on the entire flow field.
- Core assumption: The relationship between manufacturing variations and flow field changes follows consistent physical principles that can be learned by the model.
- Evidence anchors:
  - [abstract] "Predicting the flow field and using it to calculate the corresponding overall performance renders the methodology generalisable"
  - [section] "As the impact of tip clearances variations depends on the aerodynamic loading distribution of a given aerofoil, the methodology should be generalisable to different designs"
  - [corpus] Weak corpus evidence - only related works on similar frameworks but not specifically on generalizability across designs
- Break condition: If the physical relationships between manufacturing variations and flow fields are too complex or non-linear for the model to learn effectively.

### Mechanism 3
- Claim: The framework achieves scalability to industrial applications by filtering only relevant CFD data.
- Mechanism: Pre-processing step extracts engineering-relevant data (blade-to-blade planes, blade surfaces, axial cuts, etc.) and interpolates to a simplified grid, reducing computational cost without accuracy loss.
- Core assumption: Engineering assessments require only specific parts of the full CFD solution, and filtering does not remove critical information.
- Evidence anchors:
  - [abstract] "filtering only relevant parts of the CFD solution makes the methodology scalable to industrial applications"
  - [section] "The CFD mesh for each simulation consists of more than one million nodes, while the post-processed domain includes only 16 thousand nodes, it contains all the information required for the engineering assessment of interest"
  - [corpus] No direct corpus evidence, but assumption aligns with common CFD post-processing practices
- Break condition: If the pre-defined relevant data extraction misses critical flow features needed for accurate performance predictions.

## Foundational Learning

- Concept: Convolutional Neural Networks (CNNs) and U-Net architecture
  - Why needed here: The 3D CNN with U-Net structure is crucial for learning spatial patterns in the flow field data and reconstructing the output from encoded features
  - Quick check question: Can you explain how the skip connections in U-Net help preserve spatial information during the encoding-decoding process?

- Concept: Computational Fluid Dynamics (CFD) and flow field analysis
  - Why needed here: Understanding CFD outputs, flow variables (pressure, velocity, temperature), and how manufacturing variations affect these fields is essential for designing and evaluating the ML framework
  - Quick check question: What are the key flow variables that need to be predicted to calculate overall compressor performance, and why are they important?

- Concept: Mass-flow averaging and performance calculation in turbomachinery
  - Why needed here: The predicted flow fields must be processed to extract radial profiles and overall performance metrics using standard turbomachinery equations
  - Quick check question: How do you calculate mass-flow averaged quantities from 2D flow field data, and what physical quantities are needed for polytropic efficiency?

## Architecture Onboarding

- Component map:
  Input layer (Tip clearances) -> Encoder (3D conv + max-pooling) -> Bottleneck (Feature compression) -> Decoder (3D transposed conv + skip connections) -> Output layer (4×64×64×6 tensor) -> Post-processing (Mass-flow averaging)

- Critical path:
  1. Pre-process CFD data to extract relevant flow variables and geometries
  2. Train C(NN)FD on the simplified grid representation
  3. Predict flow fields for new tip clearance inputs
  4. Calculate radial profiles and overall performance metrics
  5. Evaluate accuracy against CFD ground truth

- Design tradeoffs:
  - Grid resolution vs. computational cost: Higher resolution increases accuracy but also model size and training time
  - Network depth vs. convergence: Deeper networks can capture more complex patterns but may suffer from vanishing gradients without residual connections
  - Number of training samples vs. generalization: More diverse data improves generalizability but increases data generation and training costs

- Failure signatures:
  - Large errors in regions with steep gradients (end-wall regions) indicate insufficient model capacity or inadequate grid resolution
  - Poor performance on hold-out set suggests overfitting or insufficient training data diversity
  - Slow convergence during training may indicate inappropriate learning rate or architecture issues

- First 3 experiments:
  1. Train on a small subset of the data with simplified network architecture to verify data pipeline and basic functionality
  2. Evaluate prediction accuracy on the validation set and visualize predicted vs. ground truth flow fields to identify failure modes
  3. Test scalability by predicting flow fields for unseen tip clearance combinations and calculating overall performance metrics

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How well does the C(NN)FD framework generalize to different compressor designs beyond the single geometry considered?
- Basis in paper: [explicit] The paper states the methodology should be generalisable to different designs, but only a single compressor geometry was considered. Future work will consider the effect of geometrical variations and different designs.
- Why unresolved: The current study only tested the framework on one compressor design and operating point. The authors acknowledge that generalization to different designs is a future direction.
- What evidence would resolve it: Testing the C(NN)FD framework on a diverse set of compressor designs with varying geometries and operating conditions, and comparing the prediction accuracy to CFD benchmarks.

### Open Question 2
- Question: What is the impact of including other manufacturing variations (e.g., surface roughness, geometry variations) on the prediction accuracy of the C(NN)FD framework?
- Basis in paper: [explicit] The paper focuses on tip clearance variations and states that future work will include other manufacturing variations such as surface roughness and geometry variations.
- Why unresolved: The study only considers tip clearance variations as input variables. The effect of other manufacturing variations on the framework's performance is unknown.
- What evidence would resolve it: Extending the C(NN)FD framework to include multiple manufacturing variations as input variables and evaluating the prediction accuracy on a diverse set of compressor designs.

### Open Question 3
- Question: How does the C(NN)FD framework perform in predicting the effects of circumferential non-uniformities on compressor performance?
- Basis in paper: [explicit] The paper mentions that circumferential non-uniformities could be relevant for in-service degradation applications or casing distortion, and will be addressed in future work.
- Why unresolved: The current study assumes rotational periodicity and considers only a single passage, neglecting circumferential variations. The framework's ability to handle circumferential non-uniformities is untested.
- What evidence would resolve it: Testing the C(NN)FD framework on cases with significant circumferential variations, such as those arising from casing distortion or in-service degradation, and comparing the predictions to full-annulus CFD results.

## Limitations
- Framework relies on CFD-generated ground truth data, introducing numerical approximation uncertainties
- Generalizability claims remain partially validated as testing across different compressor designs was not explicitly demonstrated
- Architecture's scalability to more complex configurations with additional design variables requires further verification

## Confidence
- C(NN)FD prediction accuracy (High): Strong quantitative metrics (R2 close to 1, MAE below CFD uncertainties) and qualitative agreement between predicted and ground truth flow fields support this claim.
- Generalizability across designs (Medium): While the methodology is designed to be generalizable, explicit testing across different compressor designs is not presented.
- Scalability to industrial applications (Medium): The framework demonstrates reduced computational cost through data filtering, but real-world implementation challenges are not addressed.

## Next Checks
1. Test the framework on a different compressor design to validate generalizability claims and assess performance degradation when applied to unseen geometries.
2. Compare prediction accuracy against experimental data from physical prototypes to evaluate real-world performance and quantify any discrepancies between CFD and physical measurements.
3. Implement the framework on an industrial-scale problem with more design variables and assess computational efficiency gains versus traditional CFD approaches.