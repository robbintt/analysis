---
ver: rpa2
title: 'Learning to Infer Unobserved Behaviors: Estimating User''s Preference for
  a Site over Other Sites'
arxiv_id: '2312.16177'
source_url: https://arxiv.org/abs/2312.16177
tags:
- site
- data
- focal
- user
- other
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper proposes a method to estimate individual users\u2019\
  \ preference for a focal website over other websites, without any data from other\
  \ sites. The authors use a hierarchical Bayesian approach, combining a distribution\
  \ of time between engagements with a Markov model to allocate engagements to the\
  \ focal site."
---

# Learning to Infer Unobserved Behaviors: Estimating User's Preference for a Site over Other Sites

## Quick Facts
- arXiv ID: 2312.16177
- Source URL: https://arxiv.org/abs/2312.16177
- Reference count: 6
- Key outcome: Hierarchical Bayesian model accurately estimates personalized share of engagement (PSE) for individual users using only focal site data, with RMSE 0.15-0.30 and sMAPE 15-30% when there are sufficient visits

## Executive Summary
This paper addresses the challenge of estimating individual users' preference for a focal website without requiring data from other sites. The authors propose a hierarchical Bayesian approach that combines an Inter-Engagement Time (IET) distribution with a Markov model to allocate engagements to the focal site. Using only the focal site's own data, the model estimates personalized share of engagement (PSE) for each user, demonstrating strong performance especially when users have more visits to the focal site. The approach shows promise for applications across various website types while maintaining user privacy by avoiding cross-site data collection.

## Method Summary
The method employs a two-part model: first, an IET distribution (using Erlang-2 or Erlang-1) captures the timing of engagements across all sites; second, a Markov model allocates engagements to the focal site based on transition probabilities. Parameters are estimated hierarchically using either MCMC (Metropolis Hastings + Gibbs Sampling) or Stochastic Gradient with Langevin Dynamics (SGLD), with individual-level parameters expressed as functions of user features like loyalty status, offers received, and total purchases. The model is validated through a simulation framework that suppresses portions of visits to create "observed" versus "unobserved" engagements.

## Key Results
- The model accurately estimates PSE values with RMSE ranging from 0.15 to 0.30 and sMAPE from 15% to 30%
- Performance improves significantly as the number of visits to the focal site increases
- Both MCMC and SGLD estimation methods produce comparable results, with SGLD offering computational efficiency
- The hierarchical Bayesian approach successfully handles individual-level parameter estimation despite limited data per user

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Hierarchical Bayesian approach enables accurate estimation without requiring data from other sites
- Mechanism: Combines IET distribution with Markov model to allocate engagements to focal site, allowing PSE estimation
- Core assumption: Users' engagement patterns on focal site follow Erlang distribution and transition to other sites follows Markov process
- Evidence anchors: Abstract states method computes focal site's share without data from other sites; section describes Hierarchical Bayes approach learning incidence with other firms from observed data
- Break condition: Performance degrades when users have very few engagements with focal site

### Mechanism 2
- Claim: Two-part model effectively allocates engagements without requiring external data
- Mechanism: IET distribution captures timing across all sites while Markov model allocates based on transition probabilities
- Core assumption: Timing of engagements on focal site is representative of overall engagement pattern
- Evidence anchors: Section demonstrates model using alternative candidate probability distributions; section describes binary state model for user engagement
- Break condition: Performance degrades when focal site engagement pattern differs significantly from overall pattern

### Mechanism 3
- Claim: Hierarchical Bayesian approach with MCMC/SGLD provides robust parameter estimation
- Mechanism: User parameters expressed as functions of available features, overcoming constraint of insufficient individual data
- Core assumption: Available features (loyalty status, offers, purchases) are predictive of engagement patterns
- Evidence anchors: Section explains Hierarchical Bayes overcomes constraint of limited data points per user; section describes departure from prior work by using only log data without external profiling
- Break condition: Performance degrades when features are not predictive or heterogeneity exists beyond what features capture

## Foundational Learning

- Concept: Hierarchical Bayesian modeling
  - Why needed here: To overcome constraint of insufficient data for individual-level parameter estimation
  - Quick check question: How does hierarchical Bayesian approach enable estimation of individual-level parameters when limited data exists for each user?

- Concept: MCMC and SGLD estimation methods
  - Why needed here: To provide robust parameter estimation for individual users in hierarchical Bayesian model
  - Quick check question: What are key differences between MCMC and SGLD estimation methods, and when might one be preferred over other?

- Concept: Erlang distribution and Markov process modeling
  - Why needed here: To capture timing of engagements across all sites and allocate engagements to focal site
  - Quick check question: How do Erlang distribution and Markov process modeling work together to allocate engagements without requiring data from other sites?

## Architecture Onboarding

- Component map: IET distribution modeling -> Markov model allocation -> Hierarchical Bayesian parameter estimation -> PSE computation
- Critical path: (1) Estimate IET distribution parameters for each user, (2) Estimate Markov model transition probabilities, (3) Combine IET and Markov to allocate engagements, (4) Estimate hierarchical Bayesian parameters, (5) Compute personalized share of engagement
- Design tradeoffs: Model complexity versus estimation accuracy; computational complexity of MCMC/SGLD versus robustness; choice of IET distribution affecting performance
- Failure signatures: Poor convergence in MCMC, overestimation of PSE for users with few visits, performance degradation with sparse engagement data, significant deviation from actual cross-site behavior patterns
- First 3 experiments:
  1. Validate choice of IET distribution by comparing model performance on simulated data with known ground truth
  2. Compare performance of MCMC versus SGLD estimation methods on simulated data
  3. Evaluate model performance on real data by comparing estimated PSE values to industry benchmarks or user surveys

## Open Questions the Paper Calls Out
The paper suggests several directions for future research, including testing the model across different website types and domains beyond electronics/entertainment products, exploring alternative IET distributions beyond Erlang-2 and Erlang-1, and investigating whether incorporating user profiling data could improve PSE estimation accuracy while maintaining privacy considerations.

## Limitations
- Performance degrades significantly for users with sparse engagement data (fewer than 5 visits)
- Model assumes Erlang distribution for inter-engagement times, which may not capture all user behavior patterns
- Binary state assumption (focal site vs other sites) oversimplifies complex landscape of user online behavior across multiple competing sites
- Validation relies on artificially suppressed data rather than truly independent cross-site measurements

## Confidence
- Technical methodology: High confidence
- Generalizability across domains: Medium confidence
- Performance on sparse data: Medium confidence
- Assumption validity (Erlang distribution, binary states): Medium confidence

## Next Checks
1. Test the model on truly independent datasets from different domains (news sites, social media, financial services) to assess cross-domain generalizability
2. Conduct ablation studies comparing the hierarchical Bayesian approach against simpler baselines like time-weighted engagement ratios
3. Validate predictions against ground truth from user surveys or panel data where actual cross-site behavior is measured