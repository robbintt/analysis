---
ver: rpa2
title: 'MWPRanker: An Expression Similarity Based Math Word Problem Retriever'
arxiv_id: '2307.01240'
source_url: https://arxiv.org/abs/2307.01240
tags:
- https
- expression
- word
- math
- problem
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents MWPRanker, a tool for retrieving similar Math
  Word Problems (MWPs) based on expression similarity. The key idea is to parse MWPs
  into algebraic expressions using a neural expression generator, then match expression
  trees to identify MWPs with the same sequence of operations.
---

# MWPRanker: An Expression Similarity Based Math Word Problem Retriever

## Quick Facts
- arXiv ID: 2307.01240
- Source URL: https://arxiv.org/abs/2307.01240
- Authors: 
- Reference count: 17
- Primary result: Expression similarity approach achieves 83.76% (MAWPS) and 85.41% (ASDIV-a) accuracy for MWP retrieval

## Executive Summary
This paper presents MWPRanker, a tool for retrieving similar Math Word Problems (MWPs) based on expression similarity. The key idea is to parse MWPs into algebraic expressions using a neural expression generator, then match expression trees to identify MWPs with the same sequence of operations. The tool was evaluated on two datasets (MAWPS and ASDIV-a) and achieved accuracy of 83.76% and 85.41% respectively, outperforming a semantic similarity baseline (61.54% and 42.71%). User studies with 19 participants found the tool easy to use (94%) and produced relevant results (84%). The main contribution is a hybrid approach leveraging expression tree similarity for MWP retrieval, which can aid in generating practice problems for learners.

## Method Summary
MWPRanker uses a hybrid approach combining Graph2Tree neural expression generation with tree matching algorithms. First, MWPs are parsed into dependency graphs using Stanford CoreNLP, then converted to algebraic expressions via the Graph2Tree model. Expression trees are constructed from these expressions and matched using postorder traversal, with variable names preserved and constant values replaced by placeholders. The system indexes these trees in a repository and retrieves similar MWPs by comparing input expression trees against the indexed collection.

## Key Results
- MWPRanker achieved 83.76% accuracy on MAWPS dataset and 85.41% on ASDIV-a dataset
- Outperformed semantic similarity baseline (61.54% on MAWPS, 42.71% on ASDIV-a)
- User study showed 94% found the tool easy to use and 84% found retrieved problems relevant
- Flask API with Streamlit frontend provides web-based interface

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Parsing MWPs into algebraic expressions enables matching of underlying problem models despite surface linguistic differences.
- Mechanism: The Graph2Tree model converts natural language MWPs into structured algebraic expressions by leveraging dependency parsing and graph embeddings, then expression trees are compared via postorder traversal to find structurally identical operations.
- Core assumption: Problems with identical expression trees have the same sequence of mathematical operations regardless of wording or thematic context.
- Evidence anchors:
  - [abstract] "We propose a hybrid approach to retrieve similar MWPs with the same problem model...the sequence of operations to be performed to arrive at the solution."
  - [section 2.2] "The expression trees are matched pairwise through postorder traversal...variable nodes must match...constant nodes contain the same placeholder."
  - [corpus] Weak evidence - neighboring papers focus on generation or solving MWPs but not retrieval based on expression trees.

### Mechanism 2
- Claim: Expression tree similarity outperforms semantic similarity for MWP retrieval because it captures arithmetic and logical operation sequences.
- Mechanism: By comparing tree structures rather than textual meaning, the system identifies MWPs requiring the same mathematical reasoning even when language varies, addressing limitations of vector-based semantic approaches.
- Core assumption: Semantic similarity approaches cannot reliably distinguish MWPs requiring different operations despite similar wording.
- Evidence anchors:
  - [abstract] "better than semantic similarity-based approaches, which fail to capture the arithmetic and logical sequence of the MWPs."
  - [section 1] "Certain works like Recall and Learn [3] leverage the task of retrieving analogous problems to solve MWPs using semantic similarity. However, they may wrongly recommend problems with different algebraic operations."
  - [section 3.2] "We observe that the proposed MWPRanker tool outperforms the semantic similarity based approach by a significant margin."

### Mechanism 3
- Claim: Using placeholder constants ("<CONSTANT>") in expression trees enables matching of structurally similar problems with different numerical values.
- Mechanism: During tree matching, specific numbers are replaced with a constant placeholder to focus on operation structure rather than exact values, allowing retrieval of MWPs with similar mathematical reasoning patterns.
- Core assumption: The mathematical structure and variable relationships are more important than specific numerical values for determining problem similarity.
- Evidence anchors:
  - [section 2.2] "We replace numbers that represent variables with variable names...replace constant values with the expression '<CONSTANT>'"
  - [abstract] "the problem model refers to the sequence of operations to be performed to arrive at the solution"

## Foundational Learning

- Concept: Tree traversal algorithms (postorder traversal)
  - Why needed here: The system uses postorder traversal to compare expression trees structurally, ensuring operators and operands are matched in correct hierarchical order.
  - Quick check question: What traversal method visits child nodes before their parent, and why is this useful for expression tree comparison?

- Concept: Dependency parsing and graph embeddings
  - Why needed here: Graph2Tree relies on dependency parsing to build heterogeneous graphs representing MWP structure, then uses graph embeddings to capture contextual relationships between linguistic elements.
  - Quick check question: How does dependency parsing help identify relationships between key phrases in MWPs for algebraic expression generation?

- Concept: Semantic vs structural similarity in information retrieval
  - Why needed here: Understanding when to use semantic similarity (for meaning) versus structural similarity (for operation sequences) is crucial for appropriate problem retrieval applications.
  - Quick check question: In what scenarios would semantic similarity outperform structural similarity for MWP retrieval, and vice versa?

## Architecture Onboarding

- Component map:
  - Input MWP → Stanford CoreNLP dependency parser → Graph2Tree neural expression generator → Algebraic expression → Expression tree converter → Tree matching algorithm → Repository of indexed expression trees → Retrieved MWPs
  - Flask API server → Streamlit UI frontend
  - Graph2Tree model (BiGraphSAGE + Bi-LSTM decoder)

- Critical path: MWP input → expression generation → tree matching → result retrieval. The expression generation step is the bottleneck and most critical for accuracy.

- Design tradeoffs:
  - Accuracy vs. computational efficiency: Expression tree comparison is more computationally intensive than vector similarity but provides more precise matching.
  - Generalization vs. specificity: Using constant placeholders enables broader matching but may conflate distinct problem types.
  - Model complexity vs. interpretability: Graph2Tree is complex but provides traceable mappings from text to expressions.

- Failure signatures:
  - Incorrect expression generation leading to wrong tree structures
  - Over-matching due to constant placeholders treating distinct problems as similar
  - Under-matching when surface linguistic differences aren't captured in tree representation
  - Performance degradation with complex MWPs containing nested operations

- First 3 experiments:
  1. Test expression generation accuracy on a held-out set of MWPs by comparing generated expressions to ground truth expressions.
  2. Evaluate tree matching precision by creating controlled pairs of MWPs with known similarities/differences.
  3. Benchmark response time for different repository sizes to identify scaling bottlenecks in the tree matching algorithm.

## Open Questions the Paper Calls Out
No specific open questions were explicitly called out in the provided content.

## Limitations
- Expression generator accuracy is critical but not independently validated, potentially propagating errors through tree matching
- Constant placeholders may conflate distinct problem types that share operation sequences but differ in mathematical meaning
- User study with 19 participants provides suggestive but not statistically robust evidence of practical utility

## Confidence
- **High**: The architectural approach of using expression tree similarity for MWP retrieval is sound and technically feasible
- **Medium**: The reported accuracy improvements over semantic baselines are credible but depend on the quality of the expression generator
- **Medium**: User study results indicating ease of use and relevance are plausible but based on a small sample size

## Next Checks
1. Conduct ablation studies removing the constant placeholder substitution to quantify its impact on matching precision and recall
2. Test the system's robustness on MWPs with nested or complex operations that may challenge the expression generator
3. Perform controlled experiments comparing MWPRanker's retrievals against human expert judgments for difficult borderline cases