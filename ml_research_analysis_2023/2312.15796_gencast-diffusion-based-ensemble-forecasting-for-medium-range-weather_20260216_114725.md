---
ver: rpa2
title: 'GenCast: Diffusion-based ensemble forecasting for medium-range weather'
arxiv_id: '2312.15796'
source_url: https://arxiv.org/abs/2312.15796
tags:
- ensemble
- gencast
- forecast
- weather
- lead
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: GenCast is a diffusion-based model for probabilistic medium-range
  weather forecasting that generates ensembles of global 15-day forecasts at 12-hour
  steps and 0.25 degree resolution. Unlike traditional numerical weather prediction,
  it is trained on reanalysis data and samples from the joint probability distribution
  of future weather states.
---

# GenCast: Diffusion-based ensemble forecasting for medium-range weather

## Quick Facts
- arXiv ID: 2312.15796
- Source URL: https://arxiv.org/abs/2312.15796
- Reference count: 40
- GenCast outperforms operational ENS on 97.4% of evaluated targets

## Executive Summary
GenCast introduces a diffusion-based generative model for probabilistic medium-range weather forecasting. Unlike traditional numerical weather prediction methods, it generates ensembles of stochastic 15-day global forecasts by sampling from the joint probability distribution of future weather states. Trained on ERA5 reanalysis data, GenCast demonstrates superior skill to the operational ENS ensemble forecast on 97.4% of evaluated targets, with particularly strong performance in predicting extreme weather events, tropical cyclones, and wind power production.

## Method Summary
GenCast is a diffusion-based model that generates probabilistic weather forecasts by sampling from the joint distribution of future weather states. It uses a sparse transformer architecture on an icosahedral mesh, trained to denoise residuals from previous states conditioned on two prior timesteps. The model employs spherical harmonic noise sampling to preserve physical plausibility and generates forecasts at 1째 resolution with 12-hour time steps over 15-day horizons. Training uses ERA5 reanalysis data (1979-2019) with MSE loss weighted by latitude-longitude area and noise level, while evaluation compares against deterministic analysis using CRPS, Ensemble-Mean RMSE, and Brier scores.

## Key Results
- GenCast has greater skill than ENS on 97.4% of evaluated targets across 80 lead times and 90-day testing period
- The model provides more accurate forecasts of extreme weather events, tropical cyclones, and wind power production
- GenCast generates ensemble members in ~8 minutes on a single TPU, enabling orders of magnitude larger ensembles than traditional methods

## Why This Works (Mechanism)

### Mechanism 1
Diffusion models can generate physically plausible ensemble members by sampling from the joint probability distribution of future weather states. GenCast uses a diffusion model to iteratively refine noisy weather states into coherent forecasts, preserving high-frequency spatial structure through spherical harmonic noise sampling. The second-order Markov assumption (conditioning only on two previous timesteps) enables efficient sampling while maintaining spatio-temporal coherence.

### Mechanism 2
Using diffusion models instead of MSE minimization avoids the blurring effect seen in deterministic ML forecasts at longer lead times. Unlike GraphCast which minimizes RMSE, GenCast samples sharp individual realizations from the weather distribution rather than averaging them. This allows the model to capture the full ensemble spread needed for probabilistic forecasting rather than collapsing to a single deterministic forecast.

### Mechanism 3
The spherical harmonic noise distribution improves physical plausibility by respecting the spherical geometry of weather variables. Instead of i.i.d. Gaussian noise on the latitude-longitude grid, GenCast samples isotropic Gaussian white noise on the sphere and projects it, maintaining a flat spherical harmonic power spectrum. This preserves high-frequency spatial structure and ensures physically realistic atmospheric patterns.

## Foundational Learning

- **Concept**: Diffusion models for generative modeling
  - Why needed here: Understanding how diffusion models work is crucial for implementing and debugging GenCast's sampling process
  - Quick check question: What is the role of the noise schedule in diffusion models, and how does it affect sample quality?

- **Concept**: Spherical harmonic transforms and power spectra
  - Why needed here: The spherical harmonic power spectrum is used to evaluate physical plausibility of weather forecasts
  - Quick check question: How does the spherical harmonic power spectrum differ from a regular Fourier spectrum, and why is it important for global weather modeling?

- **Concept**: Ensemble forecasting and probabilistic weather prediction
  - Why needed here: Understanding the goals and challenges of ensemble forecasting helps contextualize GenCast's advantages
  - Quick check question: What are the main limitations of traditional NWP-based ensemble forecasts, and how does ML-based ensemble forecasting aim to address them?

## Architecture Onboarding

- **Component map**: Initial conditions -> Diffusion solver (20 steps) -> Denoiser (sparse transformer) -> Weather forecast
- **Critical path**: 1) Sample initial conditions from NWP analysis plus EDA perturbations 2) Run diffusion solver to generate 15-day trajectory 3) Evaluate forecast using CRPS, Ensemble-Mean RMSE, and Brier scores
- **Design tradeoffs**: 1째 resolution vs. higher resolution (faster training/inference but potentially less accurate) / 20 diffusion steps vs. fewer steps (better sample quality but slower generation) / Spherical harmonic noise vs. i.i.d. grid noise (better physical plausibility but more complex implementation)
- **Failure signatures**: Loss of high-frequency content in forecasts (issues with noise distribution or diffusion process) / Under-dispersed ensembles (problems with initial condition perturbations) / Biased forecasts of derived variables (issues with model architecture or training objective)
- **First 3 experiments**: 1) Verify diffusion sampling produces coherent 12-hour forecasts from ERA5 analysis 2) Compare spherical harmonic noise vs. i.i.d. grid noise on forecast quality and physical plausibility 3) Test ensemble spread and reliability using rank histograms and spread-skill ratios

## Open Questions the Paper Calls Out

- **Question**: How would GenCast perform at operational ECMWF model resolution (0.08째) versus the 1째 resolution used in this study?
- **Question**: Would incorporating flow-dependent perturbations into GenCast's initial conditions improve ensemble spread and skill at longer lead times?
- **Question**: How would GenCast perform when evaluated against ensemble analysis rather than deterministic analysis?

## Limitations
- The model is trained on reanalysis data that may contain observational and model errors
- The second-order Markov assumption may not capture all relevant temporal dependencies in atmospheric dynamics
- The diffusion model's performance depends heavily on noise schedule and solver parameters tuned specifically on ERA5

## Confidence
- **High confidence**: The core mechanism of using diffusion models for probabilistic weather forecasting and the implementation details are explicitly specified
- **Medium confidence**: Performance claims relative to ENS depend on evaluation methodology and dataset split
- **Low confidence**: Physical plausibility claims based on spherical harmonic power spectra lack direct experimental validation

## Next Checks
1. Evaluate GenCast performance on independent observational datasets (e.g., satellite data) not used in training to assess robustness to dataset shifts
2. Conduct systematic ablation study comparing spherical harmonic noise against i.i.d. grid noise across multiple forecast quality metrics
3. Perform comprehensive reliability analysis for forecasts beyond 10 days, including spread-skill ratios, rank histograms, and proper scoring rules