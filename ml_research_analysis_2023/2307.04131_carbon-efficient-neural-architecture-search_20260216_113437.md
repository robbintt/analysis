---
ver: rpa2
title: Carbon-Efficient Neural Architecture Search
arxiv_id: '2307.04131'
source_url: https://arxiv.org/abs/2307.04131
tags:
- search
- carbon
- ce-nas
- architecture
- energy
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents CE-NAS, a carbon-aware neural architecture
  search (NAS) framework that dynamically allocates GPU resources between energy-efficient
  sampling and energy-consuming evaluation tasks based on real-time carbon intensity.
  The approach integrates a multi-objective optimizer with one-shot and vanilla NAS
  algorithms, using a heuristic strategy to balance workload across different carbon
  periods.
---

# Carbon-Efficient Neural Architecture Search

## Quick Facts
- arXiv ID: 2307.04131
- Source URL: https://arxiv.org/abs/2307.04131
- Reference count: 35
- Key outcome: CE-NAS achieves 2.22-3.48× lower carbon emissions while maintaining comparable search efficiency to vanilla LaMOO

## Executive Summary
This paper presents CE-NAS, a carbon-aware neural architecture search framework that dynamically allocates GPU resources between energy-efficient sampling and energy-consuming evaluation based on real-time carbon intensity. The approach integrates a multi-objective optimizer with one-shot and vanilla NAS algorithms, using a heuristic strategy to balance workload across different carbon periods. Trace-driven simulations using HW-NASBench and carbon intensity data from electricityMap show that CE-NAS achieves the lowest relative carbon emissions while maintaining search efficiency comparable to vanilla LaMOO.

## Method Summary
CE-NAS dynamically allocates GPU resources between energy-efficient sampling (one-shot NAS) and energy-consuming evaluation (vanilla NAS) based on real-time carbon intensity. The framework uses LaMOO for multi-objective optimization, partitioning the search space into promising regions likely to contain the Pareto frontier. During high carbon intensity periods, more resources are allocated to one-shot sampling, while during low carbon periods, more resources are allocated to full training evaluations. The GPU allocation follows the heuristic: Gt * λs and Gt * λe, where λs is calculated as (Ccur-Cmin)/(Cmax-Cmin) based on current carbon intensity.

## Key Results
- CE-NAS achieves only 0.034% lower hypervolume compared to vanilla LaMOO while reducing carbon emissions by 2.22-3.48×
- The framework maintains search efficiency comparable to vanilla LaMOO while significantly reducing carbon emissions
- CE-NAS outperforms three baselines including one-shot LaMOO and random GPU allocation strategies

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Dynamic GPU allocation based on carbon intensity enables energy-efficient sampling during high-carbon periods and energy-intensive evaluation during low-carbon periods
- Mechanism: The framework monitors real-time carbon intensity and allocates GPU resources proportionally to the current carbon intensity. During high-carbon periods, more resources are allocated to energy-efficient sampling (one-shot NAS), while during low-carbon periods, more resources are allocated to energy-consuming evaluation (vanilla NAS)
- Core assumption: The carbon intensity of electricity varies predictably over time and can be monitored in real-time
- Evidence anchors:
  - [abstract]: "CE-NAS dynamically balances energy-efficient sampling and energy-consuming evaluation tasks based on current carbon emissions"
  - [section 3.5]: "We calculate λs as Ccur−Cmin/Cmax−Cmin, where Ccur is the current carbon intensity. The GPU allocations for the sampling and evaluation processes are, therefore, Gt ∗ λs and Gt ∗ λe"
  - [corpus]: Weak - corpus papers mention carbon efficiency but don't provide direct evidence for this specific mechanism
- Break condition: If carbon intensity data is unavailable or if the relationship between carbon intensity and time becomes unpredictable

### Mechanism 2
- Claim: Multi-objective optimization using LaMOO partitions the search space to focus on promising regions likely to contain the Pareto frontier
- Mechanism: LaMOO recursively divides the search space into promising and non-promising regions based on observed samples, using Monte-Carlo Tree Search to select optimal sub-spaces for exploration
- Core assumption: The Pareto frontier can be effectively approximated through space partitioning
- Evidence anchors:
  - [abstract]: "The proposed framework, called carbon-efficient NAS (CE-NAS), consists of NAS evaluation algorithms with different energy requirements, a multi-objective optimizer"
  - [section 3.3]: "We utilize LaMOO [30] to partition the search space, Ω, into several sub-search spaces... Each partitioned region can then be mapped to a node in a search tree"
  - [section 4.2]: "Our results show that the architectures in the region selected by LaMOO have higher average accuracy and lower average edge GPU energy consumption compared to those in the entire search space"
- Break condition: If the search space cannot be effectively partitioned or if LaMOO fails to identify promising regions

### Mechanism 3
- Claim: Using energy-efficient one-shot NAS for sampling reduces carbon emissions without significantly impacting search quality
- Mechanism: One-shot NAS uses a trained supernet to estimate architecture accuracy without full training, reducing energy consumption during the sampling phase
- Core assumption: One-shot evaluation provides sufficient accuracy estimates to guide the search process
- Evidence anchors:
  - [abstract]: "Using a recent NAS benchmark dataset and two carbon traces, our trace-driven simulations demonstrate that CE-NAS achieves better carbon and search efficiency than the three baselines"
  - [section 3.3]: "During high carbon emission periods, CE-NAS will try to perform this process to save energy and produce as little carbon as possible"
  - [section 4.3]: "Vanilla LaMOO's superior performance can be attributed to its approach of training all sampled architectures to obtain their true accuracy... However, when considering the relative carbon emission, vanilla LaMOO consumes 2.22X-3.48X carbon compared to other approaches"
- Break condition: If one-shot evaluation fails to provide accurate enough estimates to guide the search effectively

## Foundational Learning

- Concept: Neural Architecture Search (NAS)
  - Why needed here: Understanding the baseline NAS process is crucial to appreciate how CE-NAS modifies it for carbon efficiency
  - Quick check question: What are the main steps in a typical NAS workflow?

- Concept: Multi-objective optimization
  - Why needed here: CE-NAS uses multi-objective optimization to balance accuracy and energy efficiency
  - Quick check question: How does multi-objective optimization differ from single-objective optimization in the context of NAS?

- Concept: Carbon intensity and grid electricity
  - Why needed here: Understanding how carbon intensity varies helps explain why dynamic allocation is effective
  - Quick check question: What factors cause carbon intensity of electricity to vary over time and location?

## Architecture Onboarding

- Component map:
  - NAS evaluation algorithms (energy-efficient and energy-consuming) -> Multi-objective optimizer (LaMOO) -> GPU allocation strategy -> Carbon intensity monitoring system -> Search space partitioning module

- Critical path:
  1. Initialize search with random samples
  2. Partition search space using LaMOO
  3. Allocate GPUs based on carbon intensity
  4. Perform energy-efficient sampling during high-carbon periods
  5. Perform energy-consuming evaluation during low-carbon periods
  6. Update search space partition with new samples
  7. Repeat until convergence or budget exhausted

- Design tradeoffs:
  - Energy vs. search quality: More energy-efficient methods may sacrifice some search quality
  - Carbon efficiency vs. search speed: Waiting for low-carbon periods may slow down the search
  - Complexity vs. adaptability: More sophisticated GPU allocation strategies may be more effective but harder to implement

- Failure signatures:
  - Search quality degrades despite carbon efficiency
  - GPU resources are consistently underutilized
  - Carbon emissions remain high despite dynamic allocation
  - Search process fails to converge

- First 3 experiments:
  1. Run CE-NAS with a fixed carbon trace and compare relative carbon emissions and search quality to vanilla LaMOO
  2. Test CE-NAS with different carbon trace patterns (high variability vs. low variability) to assess adaptability
  3. Compare CE-NAS performance with and without the dynamic GPU allocation strategy to quantify its impact on carbon efficiency

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How effective would a learned GPU allocation strategy (e.g., using deep reinforcement learning) be compared to the current heuristic approach in reducing carbon emissions while maintaining search efficiency?
- Basis in paper: [explicit] The paper mentions that "one can train an agent, e.g., use deep reinforcement learning, to automatically output different GPU allocation strategies based on historical carbon traces" as a future direction.
- Why unresolved: The current implementation uses a simple heuristic strategy, and the paper suggests that more sophisticated strategies could lead to better results but does not test this approach.
- What evidence would resolve it: Comparative experiments showing carbon emissions and search efficiency metrics between the heuristic approach and a learned GPU allocation strategy.

### Open Question 2
- Question: Can accurate carbon intensity prediction models significantly improve the carbon efficiency of CE-NAS compared to using real-time carbon intensity data?
- Basis in paper: [explicit] The paper suggests developing models capable of accurately predicting carbon intensity as a future direction, stating that "with such predictive models, CE-NAS can better schedule the NAS tasks to a dynamic set of GPUs."
- Why unresolved: The current implementation uses real-time carbon intensity data, and the potential benefits of using predictive models are not evaluated.
- What evidence would resolve it: Experiments comparing CE-NAS performance using real-time vs. predicted carbon intensity data, showing differences in carbon emissions and search efficiency.

### Open Question 3
- Question: How would extending CE-NAS to span across geographic locations with different carbon intensities impact its overall carbon efficiency and search performance?
- Basis in paper: [inferred] The paper mentions the possibility of scheduling NAS tasks to a "dynamic set of GPUs that can span across geographic locations" as a future direction, implying that geographic diversity in carbon intensity could be leveraged.
- Why unresolved: The current implementation uses carbon intensity data from a single geographic location, and the potential benefits of geographic diversity are not explored.
- What evidence would resolve it: Comparative experiments showing CE-NAS performance when using carbon intensity data from multiple geographic locations versus a single location, measuring carbon emissions and search efficiency.

## Limitations
- Reliance on trace-driven simulations rather than real-world deployment introduces uncertainty about generalizability
- Limited to a single benchmark dataset (HW-NASBench) and two carbon traces from specific regions
- Effectiveness depends on predictable carbon intensity patterns which may not hold in all scenarios

## Confidence
- Carbon emission reduction claims: Medium confidence (based on simulations that may not capture all real-world complexities)
- Search efficiency claims: Medium confidence (limited scope of benchmark dataset and specific search space)
- Dynamic allocation effectiveness: Medium confidence (depends on predictable carbon patterns)

## Next Checks
1. Verify that the GPU allocation heuristic correctly follows carbon intensity patterns in the simulation environment
2. Confirm that one-shot evaluations are consistently used during high-carbon periods and full training during low-carbon periods
3. Test the framework's adaptability to different carbon trace patterns beyond the two provided in the paper