---
ver: rpa2
title: Automated Detection of hidden Damages and Impurities in Aluminum Die Casting
  Materials and Fibre-Metal Laminates using Low-quality X-ray Radiography, Synthetic
  X-ray Data Augmentation by Simulation, and Machine Learning
arxiv_id: '2311.12041'
source_url: https://arxiv.org/abs/2311.12041
tags:
- x-ray
- data
- feature
- images
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper investigates the challenges and opportunities of using
  data-driven machine learning models for automated damage detection in composite
  materials like fiber metal laminates (FML) and aluminum die castings. The key problem
  is the lack of sufficient labeled training data, especially for detecting hidden
  defects like pores, cracks, and delaminations.
---

# Automated Detection of hidden Damages and Impurities in Aluminum Die Casting Materials and Fibre-Metal Laminates using Low-quality X-ray Radiography, Synthetic X-ray Data Augmentation by Simulation, and Machine Learning

## Quick Facts
- arXiv ID: 2311.12041
- Source URL: https://arxiv.org/abs/2311.12041
- Reference count: 0
- Primary result: Demonstrates automated damage detection in composite materials using synthetic X-ray data and CNNs, achieving ~95% true positive detection for pores.

## Executive Summary
This paper investigates the challenges and opportunities of using data-driven machine learning models for automated damage detection in composite materials like fiber metal laminates (FML) and aluminum die castings. The key problem is the lack of sufficient labeled training data, especially for detecting hidden defects like pores, cracks, and delaminations. The authors propose to overcome this by generating synthetic X-ray images from CAD models and using them to train supervised convolutional neural networks. Experiments compare high-, mid-, and low-quality X-ray devices, showing that even low-quality images can yield usable results for defect marking, albeit with some noise sensitivity. The synthetic data approach enables ground truth labeling, allowing robust CNN models to achieve ~95% true positive detection for pores. However, synthetic modeling of complex damage types in FMLs remains challenging. The method shows promise for in-field applications where high-end CT is impractical.

## Method Summary
The authors address the challenge of insufficient labeled training data for damage detection by generating synthetic X-ray images from CAD models of aluminum plates and fiber-metal laminates. They use Constructive Solid Geometry (CSG) to model defects as subtractive features, simulate X-ray projections using the Beer-Lambert law, and train a CNN-based semantic pixel classifier on the synthetic data. The trained model is then applied to real X-ray images from low-, mid-, and high-quality devices. For 3D CT volumes of FMLs, they employ a z-slice profiling approach with an LSTM autoencoder to detect anomalies in the depth-wise intensity profiles. The method leverages synthetic data to provide ground truth labels, enabling supervised learning without requiring labeled real-world data.

## Key Results
- CNN trained on synthetic X-ray images achieves ~95% true positive detection rate for pores in aluminum plates.
- The method successfully detects defects in real measured X-ray images from low-quality devices, though with some noise sensitivity.
- Z-slice profiling with LSTM autoencoder shows promise for detecting delaminations in fiber-metal laminates, though complex damage patterns remain challenging to model synthetically.
- Synthetic data generation provides a viable solution to the lack of labeled training data, enabling robust supervised learning for damage detection.

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Synthetic X-ray image generation from CAD models provides ground truth labels for supervised training.
- Mechanism: By simulating X-ray projections of precisely modeled defects in CAD, the system can create pixel-perfect masks for defect regions, enabling supervised learning without requiring labeled real-world data.
- Core assumption: The simulated X-ray images closely approximate the statistical properties of real X-ray measurements, including noise and contrast patterns.
- Evidence anchors:
  - [abstract] "It will be shown that only simulation of data can deliver a ground truth data set and accurate labeling."
  - [section] "The CAD model-based approach together with the synthetic data generation provides accurate annotated training examples."
- Break condition: If the simulated noise profile differs significantly from real device noise, the model may overfit to synthetic patterns and underperform on real data.

### Mechanism 2
- Claim: CNN-based semantic pixel classifiers can detect hidden pores in low-quality X-ray images by learning from synthetic data.
- Mechanism: The CNN learns to recognize local intensity patterns and texture features that correlate with pore locations, even when the contrast is low and the signal-to-noise ratio is degraded.
- Core assumption: Local spatial context in the X-ray image contains sufficient discriminative information about pore presence, regardless of overall image quality.
- Evidence anchors:
  - [section] "The trained model was then applied to real measured single-projection X-ray images using the Mid-Q and Low-Q devices... the detected pores, the spatial distribution, and their orientation correlated with the manufacturing process and known observations."
  - [section] "The TP rate (detecting a pixel of a pore) was about 95%, the FN rate was about 5% using synthetic X-ray images computed form the two synthetic plates."
- Break condition: If pores are too small relative to the pixel resolution, or if the noise overwhelms the intensity differences, the classifier will produce many false positives or miss defects entirely.

### Mechanism 3
- Claim: Z-slice profiling of 3D CT volumes enables anomaly detection for complex damage patterns in fiber-metal laminates.
- Mechanism: By averaging intensity along the XY plane for each depth slice, the system creates 1D profiles that capture layer integrity; deviations from the learned baseline indicate delaminations or cracks.
- Core assumption: Structural anomalies in composite laminates manifest as measurable changes in the depth-wise intensity profile, which can be captured by a 1D sequence model.
- Evidence anchors:
  - [section] "The AE 'learns' the z-profile structure of the FML plates and outputs a simplified representation... If there is a damage/defect, the AE is not able to reconstruct the base-line structure, and an error occurs with respect to the input z-slice signal."
  - [section] "The z-slices are typically averaged by square x-y average filters... It is assumed that relevant defects are changing the z-profile structure, e.g., delaminations will stretch the z-structure locally (change in z-profile frequencies)."
- Break condition: If damage patterns do not produce consistent z-profile deviations, or if noise in the CT reconstruction dominates the signal, the anomaly detector will fail to generalize.

## Foundational Learning

- Concept: Constructive Solid Geometry (CSG) modeling
  - Why needed here: CSG allows precise definition of complex multi-material geometries and defect shapes in the CAD models used for synthetic X-ray generation.
  - Quick check question: How would you model a pore as a subtractive feature in a CSG-based aluminum plate?

- Concept: Beer-Lambert law for X-ray attenuation
  - Why needed here: The simulator uses this physical law to compute X-ray absorption through 3D mesh geometries, producing realistic intensity images.
  - Quick check question: What parameters of the CAD model directly influence the Beer-Lambert absorption calculation?

- Concept: Convolutional Neural Network (CNN) for semantic segmentation
  - Why needed here: CNNs are used to classify each pixel in an X-ray image as defect or background, enabling automated ROI detection.
  - Quick check question: What is the effect of using a small vs. large convolution kernel size on the ability to detect small pores?

## Architecture Onboarding

- Component map:
  - CAD model generator → STL mesh → X-ray simulator → synthetic training images
  - Real X-ray device (Low-Q / Mid-Q / High-Q) → measured images → feature detector
  - CNN or LSTM-AE model → trained on synthetic data → applied to real data
  - Post-processing (DBSCAN clustering, ellipse fitting) → geometric characterization

- Critical path:
  1. Generate CAD models with realistic defect distributions.
  2. Simulate X-ray projections with noise matching real devices.
  3. Train pixel classifier on synthetic data only.
  4. Apply trained model to real X-ray images.
  5. Cluster detected pixels and fit geometric primitives.

- Design tradeoffs:
  - High-resolution CAD vs. simulation speed: finer meshes improve realism but increase compute time.
  - CNN depth vs. overfitting: deeper networks may overfit synthetic noise patterns.
  - Noise injection level: too little yields poor generalization; too much masks real features.

- Failure signatures:
  - High false positive rate on noise-only regions (model too sensitive).
  - Systematic directional bias in detections (training data bias).
  - No detections on real data despite good synthetic performance (reality gap).

- First 3 experiments:
  1. Train CNN on synthetic aluminum plate with pores; test on real Low-Q X-ray; measure precision/recall.
  2. Vary Gaussian noise level in synthetic data; observe effect on real data performance.
  3. Replace CNN with LSTM-AE for z-slice profiling; compare anomaly detection rates on real CT data.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can synthetic X-ray simulation accurately model complex damage types like delaminations and cracks in fiber metal laminates while preserving material volume and density constraints?
- Basis in paper: [explicit] The paper discusses that modeling secondary damages (cracks, delamination) is complicated because they overlap spatially and must preserve material volume and mass, which is challenging with subtractive geometry.
- Why unresolved: The authors state this is still work under progress and have not yet demonstrated accurate volume-preserving synthetic damage modeling.
- What evidence would resolve it: Successful generation of synthetic X-ray images from CAD models of FMLs with impact damages that accurately preserve material density and volume, validated against real measurements.

### Open Question 2
- Question: What is the true false negative rate for pore detection using the semantic pixel classifier on real measured X-ray images from low-quality devices?
- Basis in paper: [inferred] The paper mentions that due to missing ground truth in real specimens, no statistical analysis can be performed, and the false negative error rate is unknown.
- Why unresolved: The lack of ground truth labeling in real specimens prevents proper statistical validation of the classifier's performance.
- What evidence would resolve it: Comprehensive ground truth data from real specimens that would allow calculation of true positive, false positive, and false negative rates for the classifier.

### Open Question 3
- Question: How sensitive are the CNN-based damage detectors to different types of noise (Gaussian vs non-Gaussian with spatial correlation) in X-ray images?
- Basis in paper: [explicit] The paper observes that the feature detector trained with Gaussian noise shows artifacts and sensitivity when applied to low-Q devices with significant non-Gaussian noise with spatial correlation.
- Why unresolved: The paper identifies noise sensitivity but doesn't provide systematic analysis of different noise types or their impact on detection performance.
- What evidence would resolve it: Comparative studies of classifier performance using training data with different noise characteristics (Gaussian, non-Gaussian, spatially correlated) applied to test images with known noise profiles.

## Limitations
- The approach relies heavily on synthetic data generation, which may not fully capture the statistical properties of real X-ray devices.
- Complex damage patterns in FMLs are difficult to simulate accurately, limiting the method's applicability to certain defect types.
- The CNN model's sensitivity to noise and image quality can lead to false positives on noise-only regions.

## Confidence
- Synthetic data generation for ground truth labeling: **High** - Multiple experiments demonstrate successful use of synthetic data for training, with clear performance metrics.
- CNN-based pore detection in low-quality X-ray images: **Medium** - Strong results on synthetic data, but real-world performance shows noise sensitivity and requires careful parameter tuning.
- Z-slice profiling for FML anomaly detection: **Low** - Limited experimental validation; the method shows promise but faces significant challenges with complex damage patterns that are difficult to simulate.

## Next Checks
1. Conduct ablation studies varying the noise injection levels in synthetic training data to identify optimal parameters for real-world generalization.
2. Test the CNN model on a diverse dataset of real aluminum castings with known defect distributions to validate cross-factory applicability.
3. Develop and validate a methodology for generating synthetic X-ray images of complex FML damage patterns, including delaminations and fiber fractures, to improve the realism of training data.