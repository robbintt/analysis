---
ver: rpa2
title: 'Abide by the Law and Follow the Flow: Conservation Laws for Gradient Flows'
arxiv_id: '2307.00144'
source_url: https://arxiv.org/abs/2307.00144
tags:
- laws
- conserved
- relu
- functions
- conservation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper rigorously formalizes the notion of conservation laws
  in gradient flows, defining them as maximal sets of functions preserved during training
  of neural networks with any dataset and loss. The authors characterize the number
  of independent conservation laws by analyzing the Lie algebra generated by the Jacobian
  of the model.
---

# Abide by the Law and Follow the Flow: Conservation Laws for Gradient Flows

## Quick Facts
- arXiv ID: 2307.00144
- Source URL: https://arxiv.org/abs/2307.00144
- Reference count: 40
- Primary result: Formalizes conservation laws for gradient flows using Lie algebra analysis of neural network Jacobians

## Executive Summary
This paper provides a rigorous mathematical framework for understanding conservation laws in gradient flow optimization of neural networks. The authors define conservation laws as maximal sets of functions preserved during training across any dataset and loss function. They characterize the number of independent conservation laws by analyzing the Lie algebra generated by the Jacobian vector fields of the model. The work introduces algorithms for computing polynomial conservation laws and determining the maximum number of independent laws, which are then applied to verify the completeness of known conservation laws for linear and ReLU networks.

## Method Summary
The method centers on analyzing the Lie algebra generated by Jacobian vector fields of the neural network mapping. Conservation laws are characterized through the algebraic structure of these vector fields, with the number of independent laws determined by the difference between parameter dimension and Lie algebra trace dimension. The authors provide two algorithms: one for computing polynomial conservation laws using algebraic manipulations and Gröbner bases, and another for determining the maximal number of independent (not necessarily polynomial) laws. These are implemented using SageMath and applied to linear and ReLU network architectures to verify the completeness of known conservation laws.

## Key Results
- Characterizes the number of independent conservation laws via Lie algebra dimension analysis
- Provides algorithms for computing polynomial conservation laws and determining maximum independent laws
- Confirms completeness of known conservation laws for linear and ReLU networks
- Shows how over-parameterized flows can be recast as low-dimensional Riemannian flows under certain conditions

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Conservation laws are characterized by analyzing the Lie algebra generated by Jacobian vector fields
- Mechanism: Number of independent conservation laws equals parameter dimension minus Lie algebra trace dimension
- Core assumption: Lie algebra dimension is locally constant (rank(∂φ(θ)) constant on domain)
- Evidence anchors: Theorem 3.3, abstract statement on Lie algebra analysis
- Break condition: Variable rank(∂φ(θ)) across domain causes non-constant Lie algebra dimension

### Mechanism 2
- Claim: Polynomial conservation laws can be computed using orthogonality condition between gradients and Jacobian vector fields
- Mechanism: Conservation laws satisfy ∇h(θ) orthogonal to span{∇φ₁(θ), ..., ∇φd(θ)}, translated to polynomial equations
- Core assumption: Model mapping φ is polynomial
- Evidence anchors: Abstract mention of polynomial law computation algorithm
- Break condition: Non-polynomial φ makes vector fields non-polynomial

### Mechanism 3
- Claim: Known conservation laws for linear and ReLU networks are complete
- Mechanism: Compare computed Lie algebra dimension with number of known conservation laws
- Core assumption: Algorithm correctly computes Lie algebra dimension and literature is accurate
- Evidence anchors: Abstract on recovering known laws, Corollary 4.4 on completeness
- Break condition: Algorithm errors or missed conservation laws in literature

## Foundational Learning

- Concept: Lie algebra and Lie bracket operations
  - Why needed here: Characterization relies on algebraic structure of vector fields generated by Jacobian
  - Quick check question: What is the Lie bracket of two vector fields and how does it relate to their Jacobians?

- Concept: Frobenius theorem in differential geometry
  - Why needed here: Provides conditions for existence and finding of conservation laws
  - Quick check question: What is the Frobenius theorem and how does it characterize integrable distributions?

- Concept: Polynomial algebra and Gröbner bases
  - Why needed here: Algorithm involves solving polynomial equations for conservation laws
  - Quick check question: How do you determine if a set of polynomials is linearly independent using Gröbner bases?

## Architecture Onboarding

- Component map: Lie algebra dimension calculator -> Polynomial conservation law finder -> Completeness verifier
- Critical path: Input architecture → Compute Jacobian vector fields → Build Lie algebra → Calculate dimension → Compare with known laws → Output completeness result
- Design tradeoffs: Polynomial approach enables tractable computation but limits analysis to polynomial mappings
- Failure signatures: Variable rank(∂φ(θ)) across domain; non-polynomial φ breaking vector field approach
- First 3 experiments:
  1. Test algorithm on two-layer linear network with known conservation laws
  2. Apply to ReLU network without biases to verify r conservation laws
  3. Test completeness verification on deep linear network

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Does Theorem 2.8 hold for deep ReLU networks?
- Basis in paper: Authors explicitly state this as open problem
- Why unresolved: Proof techniques for linear and shallow ReLU networks may not extend to deep networks
- What evidence would resolve it: Proof of equivalence or counterexample showing difference

### Open Question 2
- Question: Are there other (non-polynomial) conservation laws beyond known ones?
- Basis in paper: Work is complementary to assuming known symmetries
- Why unresolved: Focus on polynomial laws without exploring general function spaces
- What evidence would resolve it: Systematic search in general function spaces or proof of polynomial restriction

### Open Question 3
- Question: How does initialization affect Riemannian metric in Proposition 3.8 and optimization dynamics?
- Basis in paper: Authors mention as interesting perspective
- Why unresolved: Mentioned as perspective without detailed analysis
- What evidence would resolve it: Theoretical analysis of initialization effects or empirical studies

## Limitations
- Relies on locally constant rank assumption which may not hold for all architectures
- Polynomial approach excludes networks with non-polynomial activation functions
- Completeness verification depends on accuracy of literature's known conservation laws

## Confidence
- Linear networks: High (rank conditions explicitly verified)
- ReLU networks: Medium (more complex algebraic structure)
- General non-polynomial networks: Low (theoretical framework breaks down)

## Next Checks
1. Verify locally constant rank assumption for ReLU networks with varying widths/depths using empirical rank analysis
2. Test polynomial conservation law algorithm on two-layer network with tanh activation to identify failure points
3. Cross-validate Lie algebra dimension computations using alternative numerical methods (randomized vector field independence testing)