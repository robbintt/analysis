---
ver: rpa2
title: Unsupervised textile defect detection using convolutional neural networks
arxiv_id: '2312.00224'
source_url: https://arxiv.org/abs/2312.00224
tags:
- fabric
- defect
- detection
- image
- training
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces a motif-based unsupervised approach for textile
  defect detection using a dynamic convolutional neural network architecture. The
  method extracts fabric pattern periods, segments the image into overlapping patches,
  and performs adaptive feature selection without predefined filters or backpropagation.
---

# Unsupervised textile defect detection using convolutional neural networks

## Quick Facts
- arXiv ID: 2312.00224
- Source URL: https://arxiv.org/abs/2312.00224
- Reference count: 40
- Achieves state-of-the-art performance with 0.99 accuracy, 0.85 recall, 0.71 precision, and 0.77 F1-score on star-patterned fabrics

## Executive Summary
This study introduces a novel unsupervised approach for textile defect detection using a dynamic convolutional neural network architecture. The method requires only one defect-free training sample per fabric type and eliminates the need for backpropagation by using a dynamic feature selection mechanism based on input domain similarity. The approach achieves state-of-the-art performance on the Patterned Fabrics benchmark dataset, particularly excelling on star-patterned fabrics with an overall accuracy of 0.99.

## Method Summary
The method involves preprocessing fabric images through histogram equalization, normalization, and standardization. Pattern periods are extracted using auto-correlation to determine optimal patch sizes. Overlapping patches are then extracted and stored row-wise. A dynamic feature selection algorithm progressively discovers features without predefined filters or backpropagation, using dot product similarity to classify patches as supporters or new features. Anomaly detection employs Manhattan distance combined with Gaussian-weighted defect probability mapping and 2D maximum entropy segmentation to identify defective regions.

## Key Results
- Achieves 0.99 accuracy, 0.85 recall, 0.71 precision, and 0.77 F1-score on star-patterned fabrics
- Outperforms existing unsupervised methods on the Patterned Fabrics benchmark dataset
- Requires only one defect-free training sample per fabric type
- Enables fast, single-epoch training with minimal computational cost

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Dynamic feature selection based on input domain similarity replaces backpropagation
- Mechanism: Uses dot product similarity between candidate patches and previously selected features. Patches become supporters if similarity exceeds threshold, otherwise become new features
- Core assumption: Fabric motifs are repetitive and regular enough that defect-free patches will consistently match existing features while defective patches will not
- Evidence anchors:
  - [abstract] "uses a new dynamic and heuristic method for feature selection which avoids the drawbacks of initialization of the number of filters (neurons) and their weights, and those of the backpropagation mechanism"
  - [section 3.4] "We do not provide the number of filters at any point, neither in model building nor in training. Features are dynamically selected progressively based on similarity calculation"
  - [corpus] Weak - no direct corpus evidence on this specific mechanism
- Break condition: If fabric patterns are highly irregular or defect-free regions are too diverse, the similarity threshold may fail to capture all defect-free variations, leading to false positives

### Mechanism 2
- Claim: Overlapping patch extraction with Gaussian-weighted defect probability mapping improves localization
- Mechanism: Patches are extracted with overlap so each pixel belongs to multiple patches. Defect probability is weighted by a 2D Gaussian centered on each patch, accumulating across layers with increasing receptive fields
- Core assumption: Defects affect local neighborhoods, and overlapping patches provide redundancy that improves boundary precision
- Evidence anchors:
  - [section 3.3] "patches are extracted and stored in a row by row manner, using overlapping division. Patches thus share partial regions with their neighbors"
  - [section 3.5.1] "Every pixel in the defective patch... is ponderously distributed in a way that it is the highest for the central pixel and the lowest in the patch's boundaries"
  - [corpus] Weak - no corpus evidence specifically on Gaussian weighting in textile anomaly detection
- Break condition: If defects are very small relative to patch size, the Gaussian weighting may dilute the defect signal across too many pixels

### Mechanism 3
- Claim: Pattern period extraction enables optimal patch sizing for feature discovery
- Mechanism: Row-wise and column-wise averages are auto-correlated to find periodicity. Patch size is set to the maximum period plus one, ensuring patches align with the motif structure
- Core assumption: Fabric patterns have a consistent, detectable periodicity that can be algorithmically extracted
- Evidence anchors:
  - [section 3.2] "Using auto-correlation on each of the two obtained vectors allows us to extract the period along each of these directions by measuring the distances between the successive peaks"
  - [section 4.2.2] "The pattern periods for the Box-patterned and Star-patterned fabric types were found to be, respectively, 26 x 24 and 21 x 16"
  - [corpus] Weak - no corpus evidence on period-based patch sizing in textile anomaly detection
- Break condition: If fabric has irregular or multiple periods, the median-based period extraction may yield suboptimal patch sizes that fail to capture motif structure

## Foundational Learning

- Concept: Auto-correlation for periodicity detection
  - Why needed here: Determines optimal patch size for motif alignment
  - Quick check question: What does a peak in the auto-correlation vector represent?
- Concept: Gaussian kernel weighting for probability accumulation
  - Why needed here: Smooths defect probability maps while preserving spatial information
  - Quick check question: Why is the Gaussian peak centered on the patch rather than uniform weighting?
- Concept: 2D maximum entropy thresholding
  - Why needed here: Binarizes defect probability maps while considering local neighborhood information
  - Quick check question: How does 2D entropy differ from simple global thresholding?

## Architecture Onboarding

- Component map: Preprocessing -> Period extraction -> Patch extraction -> Feature selection -> Anomaly detection
- Critical path: Period extraction → Patch extraction → Feature selection → Anomaly detection
- Design tradeoffs: Single epoch training vs. multi-epoch deep networks; dynamic feature discovery vs. fixed architecture; Manhattan distance vs. learned similarity metrics
- Failure signatures:
  - Low recall: Similarity threshold too high, missing defect-free variations
  - Low precision: Anomaly threshold too low, flagging normal variations as defects
  - Poor localization: Patch size not aligned with pattern period
- First 3 experiments:
  1. Test period extraction on a simple box-pattern fabric to verify correct patch sizing
  2. Validate feature selection by checking if defect-free patches are accepted and defective patches rejected
  3. Measure anomaly detection performance on a known defective sample with ground truth mask

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the feature discovery scheme in this unsupervised CNN compare in scalability and performance to supervised methods on larger, more diverse fabric datasets?
- Basis in paper: [explicit] The authors mention that their approach achieves state-of-the-art performance on the Patterned Fabrics benchmark dataset but do not evaluate scalability to larger or more complex datasets
- Why unresolved: The current evaluation is limited to a single benchmark dataset with a fixed set of defect types and patterns, leaving questions about generalization and performance on industrial-scale datasets unanswered
- What evidence would resolve it: Testing the method on larger datasets with more fabric types, defect categories, and real-world variations would clarify its scalability and robustness

### Open Question 2
- Question: Can the automatic elimination of defective patches during training, as proposed for future work, be effectively implemented without access to labeled defect-free training samples?
- Basis in paper: [explicit] The authors propose future work to automatically eliminate defective patches based on supporter counts, but this relies on the assumption that training is done on defect-free images
- Why unresolved: The feasibility and accuracy of identifying and excluding defective patches without labeled data remain unproven, especially in the presence of subtle or ambiguous defects
- What evidence would resolve it: Developing and validating an algorithm that reliably detects and excludes defective patches using only unsupervised metrics would demonstrate the viability of this approach

### Open Question 3
- Question: What is the impact of varying the similarity threshold and anomaly threshold on the trade-off between false positives and false negatives in real-time defect detection applications?
- Basis in paper: [explicit] The authors discuss the effect of these thresholds on model performance but do not provide a systematic analysis of their impact in real-time or industrial settings
- Why unresolved: The optimal threshold settings for balancing detection accuracy and computational efficiency in practical, high-throughput environments are not established
- What evidence would resolve it: Conducting experiments that measure detection accuracy, processing speed, and error rates across a range of threshold values in real-time scenarios would clarify their practical impact

## Limitations
- Performance evaluation limited to box and star pattern fabrics only
- Dynamic feature selection threshold lacks systematic sensitivity analysis
- Manhattan distance-based anomaly detection may miss complex feature relationships
- Limited comparison to broader range of unsupervised and supervised methods

## Confidence
- Unsupervised feature discovery mechanism: Medium confidence
- State-of-the-art performance claims: Low confidence
- Single defect-free sample sufficiency: Medium confidence

## Next Checks
1. Test the pattern period extraction algorithm on fabrics with irregular or multiple periodicities to evaluate its robustness beyond the box and star patterns
2. Conduct sensitivity analysis on the similarity threshold parameter across different fabric types to determine optimal values and identify failure conditions
3. Validate the approach on an independent textile defect dataset with different pattern types and defect characteristics to assess generalization capability