---
ver: rpa2
title: Domain Generalization with Fourier Transform and Soft Thresholding
arxiv_id: '2309.09866'
source_url: https://arxiv.org/abs/2309.09866
tags:
- domain
- image
- generalization
- fourier
- spectrum
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses domain generalization in retinal fundus image
  segmentation, where models must perform well across multiple source domains and
  unseen target domains. The key contribution is introducing soft-thresholding in
  the Fourier domain to reduce background interference in amplitude spectrum-based
  augmentation.
---

# Domain Generalization with Fourier Transform and Soft Thresholding

## Quick Facts
- arXiv ID: 2309.09866
- Source URL: https://arxiv.org/abs/2309.09866
- Reference count: 0
- Primary result: FDG+ST achieves 82.88% DSC for optic cup and 92.34% DSC for optic disc segmentation, outperforming conventional FDG

## Executive Summary
This paper addresses domain generalization in retinal fundus image segmentation, where models must perform well across multiple source domains and unseen target domains. The key contribution is introducing soft-thresholding in the Fourier domain to reduce background interference in amplitude spectrum-based augmentation. By applying soft thresholding to Fourier coefficients, the method effectively filters out background-related low-magnitude frequency components while preserving higher-magnitude components that represent object features. Experiments on four retinal fundus datasets demonstrate that this approach significantly improves segmentation performance compared to conventional Fourier-based domain generalization methods.

## Method Summary
The method applies Fourier Transform to source and target images, decomposes them into amplitude and phase spectra, applies soft thresholding to the target amplitude spectrum to remove small Fourier coefficients (background noise), and combines the source amplitude with the soft-thresholded target amplitude using a mixing parameter λ. The phase spectrum from the source image is preserved throughout. The combined spectrum undergoes inverse Fourier Transform to reconstruct augmented images. These augmented images are used to train DeepLab-V3+ with MobileNet-V2 backbone using leave-one-domain-out strategy on four retinal fundus datasets.

## Key Results
- FDG+ST achieves 82.88% Dice Similarity Coefficient for optic cup segmentation and 92.34% for optic disc segmentation
- Outperforms conventional FDG (82.80% and 92.29%) and DoFE (82.61% and 92.23%) methods
- Reduces average Hausdorff distance from 25.08 to 24.95 for optic cup and from 21.19 to 19.95 for optic disc segmentation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Soft thresholding removes small Fourier coefficients that capture background noise, reducing interference in augmented images.
- Mechanism: By applying soft thresholding to the target image's amplitude spectrum before mixing with the source spectrum, small amplitude values are suppressed. This effectively filters out background-related low-magnitude frequency components while preserving higher-magnitude components that represent object features.
- Core assumption: Background noise in fundus images manifests as small Fourier coefficients in the amplitude spectrum that can be safely removed without affecting clinically relevant structures.
- Evidence anchors:
  - [abstract] "The proposed technique basically enhances fundus image augmentation by eliminating small values in the Fourier domain and providing better generalization."
  - [section] "The proposed integration of soft-thresholding function in the FDG setting separates meaningful signal components from unwanted noise or background interference significantly better than FDG-based approaches."
  - [corpus] Weak evidence - corpus papers focus on frequency domain methods but don't specifically address soft thresholding for background noise removal in medical imaging.
- Break condition: If the soft threshold parameter α is too large, the image becomes darker and important structural information may be lost.

### Mechanism 2
- Claim: The phase spectrum contains higher-level semantic information while the amplitude spectrum captures lower-level style information.
- Mechanism: By preserving the phase spectrum from the source image and only modifying the amplitude spectrum, the method maintains object structure while changing the visual style to match the target domain.
- Core assumption: The phase spectrum encodes object identity and location information that should remain consistent across domains, while the amplitude spectrum encodes domain-specific appearance variations.
- Evidence anchors:
  - [section] "The amplitude spectrum reflects the low-level distribution (e.g. style), and the phase spectrum reflects the high-level semantics (e.g. object) of the image."
  - [section] "Therefore, we can revise the style of an image by changing its amplitude and retaining its phase."
  - [corpus] Weak evidence - while Fourier-based methods are mentioned, the specific claim about phase containing semantics vs amplitude containing style is not directly supported by corpus papers.
- Break condition: If the phase spectrum contains domain-specific information, preserving it across domains may limit the effectiveness of style transfer.

### Mechanism 3
- Claim: Mixing amplitude spectra between source and target domains creates augmented data that bridges domain gaps for better generalization.
- Mechanism: The linear combination of source and soft-thresholded target amplitude spectra (controlled by λ) creates intermediate representations that capture characteristics of both domains, helping the model learn domain-invariant features.
- Core assumption: Domain generalization benefits from data augmentation that exposes the model to intermediate domain representations between source and target distributions.
- Evidence anchors:
  - [abstract] "Among many domain generalization methods, Fourier-transform-based domain generalization methods have gained popularity primarily because they exploit the power of Fourier transformation to capture essential patterns and regularities in the data, making the model more robust to domain shifts."
  - [section] "FDG-based approaches augment the images directly" and "introducing a soft-thresholding function into the FDG framework improves the fundus image augmentation performance."
  - [corpus] Weak evidence - corpus papers discuss frequency domain methods but don't specifically validate the domain mixing approach for generalization.
- Break condition: If λ is set too high, the augmented images may become dominated by target domain characteristics, reducing the diversity of the augmented dataset.

## Foundational Learning

- Concept: Discrete Fourier Transform (DFT) and its properties
  - Why needed here: The entire method relies on transforming images to the frequency domain, manipulating amplitude and phase spectra, then transforming back. Understanding DFT properties is crucial for implementing and debugging the algorithm.
  - Quick check question: What information is preserved in the phase spectrum versus the amplitude spectrum after DFT?

- Concept: Soft thresholding and its application in signal processing
  - Why needed here: The method applies soft thresholding to Fourier coefficients to reduce background interference. Understanding how this technique works and its typical applications is important for parameter selection and implementation.
  - Quick check question: How does soft thresholding differ from hard thresholding, and what are the trade-offs between them?

- Concept: Domain generalization in medical imaging
  - Why needed here: The method is applied to retinal fundus image segmentation where models must generalize across different clinical centers and imaging devices. Understanding the specific challenges in medical domain generalization is crucial for evaluating the approach.
  - Quick check question: Why is domain generalization particularly challenging in medical imaging compared to natural image tasks?

## Architecture Onboarding

- Component map: Input ROI images → Resize to 256×256 → DFT → Amplitude/Phase decomposition → Soft thresholding on target amplitude → Source amplitude + λ × soft-thresholded target amplitude → Combined spectrum + source phase → IDFT → Augmented images → DeepLab-V3+ + MobileNet-V2 training → Segmentation evaluation

- Critical path: Source image → DFT → amplitude/phase split → source amplitude + (λ × soft-thresholded target amplitude) → combined spectrum → IDFT → augmented image → model training → evaluation

- Design tradeoffs:
  - Soft threshold parameter α: Higher values remove more background but risk losing important information
  - Mixing parameter λ: Controls strength of augmentation; too high may introduce artifacts
  - ROI size: 800×800 chosen as practical balance between computational cost and maintaining relevant features
  - Backbone architecture: MobileNet-V2 chosen for efficiency but may limit performance compared to larger backbones

- Failure signatures:
  - Aliasing artifacts in augmented images indicate improper soft threshold setting
  - Darkened images suggest α is too large
  - Poor segmentation performance on test domains suggests inadequate domain coverage in augmentation
  - Model overfitting to augmented data indicates insufficient diversity in generated samples

- First 3 experiments:
  1. Implement basic FDG without soft thresholding and verify it produces similar results to Figure 2 in the paper
  2. Add soft thresholding with varying α values (0.1%, 1%, 5%, 10%, 50%) and evaluate impact on background artifacts and image quality
  3. Train segmentation models with and without soft thresholding on the same datasets and compare DSC, HD, and ASD metrics across all four test domains

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal threshold parameter α for soft-thresholding across different medical imaging domains and modalities?
- Basis in paper: [explicit] The paper states "we set α = 5%, determined by the grid search" but also notes "the optimal α is not unique because the augmented images are similar when α increases or decreases 'slightly'"
- Why unresolved: The paper only evaluated α values of 0.1%, 1%, 5%, 10%, and 50% on one specific task (fundus image segmentation). The sensitivity of α to different imaging modalities, anatomical structures, and disease types remains unexplored.
- What evidence would resolve it: Systematic experiments testing multiple α values across diverse medical imaging tasks (CT, MRI, X-ray) and anatomical regions, with quantitative analysis of the relationship between α and segmentation performance.

### Open Question 2
- Question: How does soft-thresholding in the Fourier domain compare to other frequency-domain filtering techniques for domain generalization?
- Basis in paper: [explicit] The paper introduces soft-thresholding but does not compare it to alternatives like hard thresholding, Wiener filtering, or wavelet-based methods in the frequency domain.
- Why unresolved: The paper demonstrates soft-thresholding outperforms conventional FDG but does not establish whether this improvement is due to the soft-thresholding approach specifically or would be achieved by other frequency-domain denoising methods.
- What evidence would resolve it: Head-to-head comparisons of soft-thresholding against other frequency-domain filtering techniques using identical experimental protocols and evaluation metrics.

### Open Question 3
- Question: Can the soft-thresholding approach be extended to handle multi-modal and multi-sequence medical imaging data?
- Basis in paper: [inferred] The current implementation uses separate thresholds for RGB channels, suggesting channel-specific processing, but does not address how to handle multiple imaging modalities or sequences.
- Why unresolved: The paper focuses on single-modality RGB fundus images, and it remains unclear how the method would generalize to cases where multiple imaging modalities (e.g., T1, T2, FLAIR MRI) or sequences need to be processed simultaneously.
- What evidence would resolve it: Experimental validation showing the method's effectiveness on multi-modal datasets, including appropriate modifications to handle modality-specific characteristics and inter-modality relationships.

## Limitations
- Dataset dependency and reproducibility: Method relies on specific ROI images provided by reference [9] that are not publicly available
- Limited generalization beyond tested datasets: Evaluation confined to four retinal fundus datasets with unknown effectiveness on other medical imaging modalities
- Computational efficiency: Paper doesn't report computational costs or training times important for clinical deployment

## Confidence
- High confidence: FDG+ST outperforms baseline FDG methods on tested datasets with reported metrics
- Medium confidence: Soft thresholding reduces background interference in frequency domain based on experimental results
- Low confidence: Phase spectrum contains "high-level semantics" while amplitude contains "low-level style" information claim lacks direct validation

## Next Checks
1. Systematic ablation study varying α from 1% to 50% to quantify sensitivity to this critical hyperparameter
2. Cross-modality validation applying FDG+ST to chest X-rays from multiple sources to test generalization beyond retinal fundus images
3. Visualization and analysis of frequency domain effects to empirically demonstrate which components are modified and correlation with performance improvements