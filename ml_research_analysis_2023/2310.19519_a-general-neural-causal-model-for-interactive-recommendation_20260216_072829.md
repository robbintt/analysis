---
ver: rpa2
title: A General Neural Causal Model for Interactive Recommendation
arxiv_id: '2310.19519'
source_url: https://arxiv.org/abs/2310.19519
tags:
- learning
- consistency
- offline
- causal
- recommendation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a neural causal model for mitigating survivor
  bias in recommendation systems by enabling counterfactual inference. The core idea
  is to transform the problem into estimating consistency across different recommender
  systems under the same user preference state, which can be formalized as the Probability
  of Necessity.
---

# A General Neural Causal Model for Interactive Recommendation

## Quick Facts
- arXiv ID: 2310.19519
- Source URL: https://arxiv.org/abs/2310.19519
- Reference count: 24
- Key outcome: Proposes a neural causal model for mitigating survivor bias in recommendation systems through counterfactual inference, achieving improved performance across various RL optimization procedures.

## Executive Summary
This paper introduces a neural causal model to address survivor bias in recommendation systems by enabling counterfactual inference. The approach transforms the problem into estimating consistency across different recommender systems under the same user preference state, formalized as the Probability of Necessity. The model uses neural networks to approximate causal structural functions, with Gumbel-max for structural constraints and Gumbel-Softmax for differentiable estimation. Theoretical analysis proves identifiability, and empirical studies demonstrate effectiveness across multiple reinforcement learning optimization procedures including policy-based, value-based, and actor-critic approaches.

## Method Summary
The method builds a learnable structural causal model using neural networks to approximate causal structural functions in recommendation systems. It employs Gumbel-max for structural constraints and Gumbel-Softmax for differentiable estimation, balancing theoretical integrity with practical implementation. The model is compatible with various reinforcement learning optimization procedures (policy-based, value-based, and actor-critic) and uses self-attention mechanisms for state representation with position encoding. An adversarial learning framework estimates reward functions, and the entire system is trained to improve recommendation performance while mitigating survivor bias through counterfactual consistency.

## Key Results
- The neural causal model successfully mitigates survivor bias across different RL optimization procedures (REINFORCE, TD, GAE)
- Empirical evaluation shows improved Hit Ratio (H@k) and Normalized Discounted Cumulative Gain (N@k) on offline datasets (Kaggle, RecSys15)
- Online simulator results demonstrate increased click-through rates when using the proposed method
- The model maintains theoretical identifiability while being practically estimable through differentiable optimization

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Survivor bias in recommendation systems leads to local optima, which can be mitigated by enforcing counterfactual consistency.
- Mechanism: The paper proposes transforming the problem into estimating consistency across different recommender systems under the same user preference state. This is formalized as the Probability of Necessity (PN) and is achieved by building a learnable structural causal model using neural networks.
- Core assumption: The counterfactual consistency can be identified and estimated using the proposed neural causal model, even when the ground truth Structural Causal Model (SCM) is unknown.
- Evidence anchors:
  - [abstract]: "This paper proposes a neural causal model for mitigating survivor bias in recommendation systems by enabling counterfactual inference."
  - [section]: "Causally, the survivor effect is reduced via counterfactual consistency. To identify the consistency with the ground true Structural Causal Model (SCM) unknown, we propose a general Neural Causal Model (NCM) based on the available graphical representation of the MDP..."
  - [corpus]: Weak evidence. The corpus contains related papers on counterfactual reasoning and causal inference, but none directly address the specific mechanism of survivor bias mitigation in recommendation systems.
- Break condition: If the neural causal model cannot accurately approximate the causal structural functions, or if the counterfactual consistency cannot be reliably estimated, the mitigation of survivor bias will fail.

### Mechanism 2
- Claim: The proposed neural causal model is identifiable and estimable, allowing for effective counterfactual inference.
- Mechanism: The model uses Gumbel-max for structural constraints and Gumbel-Softmax for differentiable estimation. This allows the model to balance theoretical integrity and practical implementation.
- Core assumption: The Gumbel-max and Gumbel-Softmax functions can effectively approximate the structural constraints and enable differentiable estimation, respectively.
- Evidence anchors:
  - [abstract]: "A learnable structural causal model is built using neural networks to approximate causal structural functions. The model uses Gumbel-max for structural constraints and Gumbel-Softmax for differentiable estimation."
  - [section]: "To identify the consistency, we use the Gumbel-max function as structural constrains. To estimate the consistency, we apply reinforcement optimizations, and use Gumbel-Softmax as a trade-off to get a differentiable function."
  - [corpus]: Weak evidence. The corpus contains papers on neural causal models and counterfactual inference, but none specifically discuss the use of Gumbel-max and Gumbel-Softmax for this purpose.
- Break condition: If the Gumbel-max or Gumbel-Softmax functions fail to approximate the structural constraints or enable differentiable estimation, the model will not be identifiable or estimable, and counterfactual inference will be ineffective.

### Mechanism 3
- Claim: The proposed neural causal model improves recommendation performance across various reinforcement learning optimization procedures.
- Mechanism: The model is compatible with policy-based, value-based, and actor-critic approaches, allowing it to be integrated into existing reinforcement learning frameworks.
- Core assumption: The neural causal model can be effectively optimized using different reinforcement learning procedures without losing its counterfactual consistency properties.
- Evidence anchors:
  - [abstract]: "The proposed method improves recommendation performance across various reinforcement learning optimization procedures, including policy-based, value-based, and actor-critic approaches."
  - [section]: "In a nutshell, our contributions are: We propose a neural causal model to mitigate the survivor bias via consistency, the model is identifiable and estimable. Although we implement a vanilla neural architecture in this study, advanced regularization skills can be bundled to further accelerate the performance."
  - [corpus]: Weak evidence. The corpus contains papers on reinforcement learning and recommendation systems, but none specifically discuss the integration of a neural causal model with various reinforcement learning procedures.
- Break condition: If the neural causal model cannot be effectively optimized using different reinforcement learning procedures, or if the optimization process destroys the counterfactual consistency properties, the improvement in recommendation performance will not be achieved.

## Foundational Learning

- Concept: Structural Causal Models (SCMs)
  - Why needed here: SCMs provide the theoretical foundation for causal inference and counterfactual reasoning, which are essential for mitigating survivor bias in recommendation systems.
  - Quick check question: What are the key components of a Structural Causal Model, and how do they relate to the proposed neural causal model?

- Concept: Counterfactual Inference
  - Why needed here: Counterfactual inference allows us to reason about what would have happened under different conditions, which is crucial for understanding and mitigating the effects of survivor bias.
  - Quick check question: How does counterfactual inference differ from observational inference, and why is it necessary for addressing survivor bias?

- Concept: Reinforcement Learning (RL)
  - Why needed here: RL provides the optimization framework for learning recommendation policies, and the proposed neural causal model needs to be compatible with various RL procedures to be effective.
  - Quick check question: What are the key differences between policy-based, value-based, and actor-critic RL approaches, and how might they impact the optimization of the neural causal model?

## Architecture Onboarding

- Component map: Neural Causal Model (NCM) -> Gumbel-max constraints -> Gumbel-Softmax estimation -> RL optimization procedures (policy-based, value-based, actor-critic)
- Critical path: The critical path for implementing the neural causal model involves: 1) Building the learnable structural causal model using neural networks, 2) Implementing the Gumbel-max and Gumbel-Softmax functions for structural constraints and differentiable estimation, 3) Integrating the model with the chosen RL procedure for optimization.
- Design tradeoffs: The use of Gumbel-max and Gumbel-Softmax functions introduces a tradeoff between theoretical integrity and practical implementation. While these functions enable differentiable estimation and balance exploration and exploitation, they may also introduce approximation errors.
- Failure signatures: Potential failure modes include: 1) Inaccurate approximation of causal structural functions by the neural networks, 2) Failure of Gumbel-max or Gumbel-Softmax functions to effectively constrain or enable differentiable estimation, 3) Incompatibility between the neural causal model and the chosen RL procedure.
- First 3 experiments:
  1. Verify the accuracy of the neural networks in approximating the causal structural functions on a small, synthetic dataset.
  2. Test the effectiveness of the Gumbel-max and Gumbel-Softmax functions in enforcing counterfactual consistency and enabling differentiable estimation.
  3. Integrate the neural causal model with a simple RL procedure (e.g., policy-based) and evaluate its performance on a benchmark recommendation dataset.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed neural causal model (NCM) perform in partially observable Markov Decision Processes (POMDPs)?
- Basis in paper: [inferred] The paper states "We assume observable MDP in this studies, partially-observed MDP will be explored next."
- Why unresolved: The paper only demonstrates the effectiveness of the NCM in fully observable MDPs, and does not provide any experimental results or theoretical analysis for POMDPs.
- What evidence would resolve it: Experimental results on POMDP datasets, and theoretical analysis of the NCM's performance in POMDPs.

### Open Question 2
- Question: How does the performance of the NCM vary with different levels of survivor bias in the data?
- Basis in paper: [inferred] The paper focuses on mitigating survivor bias, but does not provide a detailed analysis of how the NCM's performance changes with different levels of survivor bias.
- Why unresolved: The paper does not include experiments that systematically vary the level of survivor bias in the data.
- What evidence would resolve it: Experiments on datasets with varying levels of survivor bias, and analysis of the NCM's performance across these levels.

### Open Question 3
- Question: Can the NCM be extended to handle multiple types of user feedback beyond clicks and purchases?
- Basis in paper: [explicit] The paper mentions "extension to involve mult-type valuation can be achieved via regression upon self-attention blocks."
- Why unresolved: The paper only implements the NCM for binary feedback (clicks and purchases), and does not provide any experimental results or theoretical analysis for multiple types of feedback.
- What evidence would resolve it: Experimental results on datasets with multiple types of user feedback, and theoretical analysis of the NCM's performance with multiple feedback types.

## Limitations

- The model's performance heavily depends on the accuracy of neural network approximations for causal structural functions, which remains a significant open challenge in causal inference
- The effectiveness of Gumbel-based relaxation techniques for maintaining counterfactual consistency during optimization has not been extensively validated across diverse recommendation settings
- The theoretical identifiability proof assumes certain conditions that may not hold in practical recommendation scenarios with complex user behavior patterns

## Confidence

- High Confidence: The theoretical framework connecting survivor bias to counterfactual consistency and the formalization using Probability of Necessity (PN)
- Medium Confidence: The empirical results showing improved performance across different RL procedures, though results are based on specific datasets and simulators
- Low Confidence: The generalizability of the proposed Gumbel-based mechanisms to real-world recommendation systems with millions of users and items

## Next Checks

1. **Robustness Testing**: Evaluate the model's performance across multiple diverse recommendation datasets (beyond Kaggle and RecSys15) with varying levels of survivor bias to assess generalizability
2. **Ablation Study**: Systematically remove the causal components (Gumbel-max/Softmax mechanisms) to quantify their specific contribution to performance improvements
3. **Scalability Analysis**: Test the model's performance and training efficiency on larger-scale recommendation datasets to identify practical implementation bottlenecks and memory constraints