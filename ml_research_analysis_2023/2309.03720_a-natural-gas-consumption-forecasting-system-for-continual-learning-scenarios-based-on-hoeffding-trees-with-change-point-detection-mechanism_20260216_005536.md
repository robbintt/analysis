---
ver: rpa2
title: A Natural Gas Consumption Forecasting System for Continual Learning Scenarios
  based on Hoeffding Trees with Change Point Detection Mechanism
arxiv_id: '2309.03720'
source_url: https://arxiv.org/abs/2309.03720
tags:
- change
- forecasting
- data
- collection
- consumption
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a novel approach for natural gas consumption
  forecasting with continual learning capabilities, integrating change point detection
  and model collection selection. The methodology uses Hoeffding trees as forecasting
  models and the PELT algorithm for change point detection.
---

# A Natural Gas Consumption Forecasting System for Continual Learning Scenarios based on Hoeffding Trees with Change Point Detection Mechanism

## Quick Facts
- arXiv ID: 2309.03720
- Source URL: https://arxiv.org/abs/2309.03720
- Authors: 
- Reference count: 40
- Primary result: The proposed approach achieves SMAPE values below 13% with the Pure Change Point-Divided strategy outperforming baseline methods

## Executive Summary
This paper presents a novel natural gas consumption forecasting system designed for continual learning scenarios. The methodology integrates change point detection using the PELT algorithm with model collection selection based on Hoeffding trees. The system dynamically adapts to evolving consumption patterns by detecting abrupt changes and switching between different model collections. Three model collection selection procedures were evaluated: Pure Change Point-Divided, and Mixed Change Point-Divided with weighted averaging and switching strategies. Experiments on real-world natural gas consumption data demonstrated that the Pure Change Point-Divided approach outperformed baseline methods across all metrics (MSE, MAE, SMAPE).

## Method Summary
The proposed methodology combines Hoeffding trees with change point detection to create a continual learning system for natural gas consumption forecasting. The approach preprocesses hourly consumption data into lagged feature vectors with 72-hour windows, then applies the PELT algorithm to detect change points in consumption patterns. Based on detected change points, the system selects from multiple model collections, each containing 24 Hoeffding tree models for different forecast horizons. The Pure Change Point-Divided strategy switches collections at detected change points, while Mixed strategies use weighted averaging or switching near boundaries. The system supports incremental updates as new data arrives, enabling adaptation to evolving consumption patterns without catastrophic forgetting.

## Key Results
- The Pure Change Point-Divided approach achieved the best performance with SMAPE values below 13%
- Fewer detected change points led to lower forecasting errors across all evaluation metrics
- Simpler model collection selection procedures without forecasting error feedback proved more robust for continual learning tasks
- The approach outperformed baseline Single Model Collection Approach across all metrics (MSE, MAE, SMAPE)

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Change point detection reduces forecasting error by segmenting data into homogeneous consumption regimes.
- Mechanism: The PELT algorithm identifies abrupt shifts in consumption patterns, allowing the system to partition the time series into segments with similar statistical properties. Each segment then uses a dedicated model collection trained on data with similar characteristics, reducing model complexity and improving accuracy.
- Core assumption: Consumption patterns are piecewise stationary, with abrupt changes rather than gradual drift.
- Evidence anchors:
  - [abstract] "The change point detection integration enables selecting a different model collection for successive time frames."
  - [section] "The detected change points partition the data into segments with distinct levels or trends of gas consumption."
  - [corpus] Weak - corpus contains related forecasting work but no direct change point detection evidence.
- Break condition: If consumption patterns drift gradually over time rather than exhibiting abrupt changes, the segmentation approach loses effectiveness.

### Mechanism 2
- Claim: Hoeffding trees enable continual learning by updating incrementally without catastrophic forgetting.
- Mechanism: Hoeffding trees use statistical bounds (Hoeffding bound) to determine when sufficient evidence exists to make splits, allowing the tree structure to evolve as new data arrives. This enables online learning while maintaining performance on previously seen patterns.
- Core assumption: The Hoeffding bound provides sufficient confidence in attribute selection for incremental updates.
- Evidence anchors:
  - [section] "Standard tree-based classification or regression algorithms are not well suited for online learning... Domingos and Hulten introduced a new method that allows tree structure modification [35]."
  - [section] "The model has to support incremental learning, so models such as Hoeffding Tree or Stochastic Gradient Tree can be used for this task."
  - [corpus] Weak - corpus lacks specific Hoeffding tree evidence.
- Break condition: If data distribution changes too rapidly for the Hoeffding bound to accumulate sufficient evidence, the tree structure may not adapt quickly enough.

### Mechanism 3
- Claim: Model collection selection procedures adapt to changing conditions without requiring error feedback.
- Mechanism: Pure Change Point-Divided schema switches model collections based solely on detected change points, while Mixed Change Point-Divided uses error metrics to ensemble or switch models near change boundaries. Simpler procedures without error feedback are more robust for continual learning tasks.
- Core assumption: Change points reliably indicate when to switch model collections, making error feedback unnecessary.
- Evidence anchors:
  - [abstract] "Also, simpler model collection selection procedures omitting forecasting error feedback leads to more robust forecasting models suitable for continual learning tasks."
  - [section] "The second approach, called Mixed Change Point-Divided schema... works with a boundary of b steps... Both model collections... are used inside this boundary."
  - [section] "The results indicated that fewer change points were preferable, as shown in Table 3."
- Break condition: If change points are not reliably detected or consumption patterns change gradually, the selection procedure may switch too frequently or not frequently enough.

## Foundational Learning

- Concept: Incremental learning and catastrophic forgetting
  - Why needed here: The system must continuously update models as new consumption data arrives without losing performance on historical patterns.
  - Quick check question: What happens to a neural network's performance on old data when trained only on new data?

- Concept: Change point detection algorithms
  - Why needed here: The system uses PELT algorithm to identify when consumption patterns shift, enabling appropriate model collection switching.
  - Quick check question: How does the PELT algorithm balance between detecting too many false change points versus missing real changes?

- Concept: Streaming data processing
  - Why needed here: Natural gas consumption data arrives continuously at hourly intervals, requiring models that can update incrementally rather than batch retraining.
  - Quick check question: What is the difference between online learning and batch learning in terms of data availability?

## Architecture Onboarding

- Component map: Data Preprocessing -> Change Point Detection -> Model Collection Setup -> Model Collection Selection -> Model Training -> Forecast
- Critical path: Data → Preprocessing → Change Point Detection → Collection Selection → Training → Forecast
- Design tradeoffs: More change points improve local accuracy but increase model complexity and risk overfitting
- Failure signatures: High SMAPE values (>15%) indicate model collection switching is too frequent or change points are poorly detected
- First 3 experiments:
  1. Run SMCA baseline without change point detection to establish performance floor
  2. Implement Pure Change Point-Divided with Low PELT settings to verify improvement
  3. Test Mixed Change Point-Divided with weighted averaging near detected boundaries to compare with pure approach

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed methodology perform on datasets from other domains beyond natural gas consumption forecasting?
- Basis in paper: [inferred] The paper focuses specifically on natural gas consumption forecasting but claims the methodology is general and modular.
- Why unresolved: The experiments are limited to one real-world dataset in the energy domain, making generalizability uncertain.
- What evidence would resolve it: Testing the methodology on diverse time series datasets from other domains (finance, healthcare, transportation) while measuring forecasting accuracy.

### Open Question 2
- Question: What is the optimal strategy for determining the number of change points when using the PELT algorithm?
- Basis in paper: [explicit] The paper notes that different PELT settings (low, medium, high) significantly affect forecasting accuracy and that fewer change points generally perform better.
- Why unresolved: The paper uses predefined settings but does not provide a systematic method for selecting the optimal number of change points.
- What evidence would resolve it: Developing and validating a principled approach for selecting the appropriate number of change points based on data characteristics.

### Open Question 3
- Question: How does the forecasting accuracy change when using different base models instead of Hoeffding Trees?
- Basis in paper: [explicit] The paper specifically uses Hoeffding Trees due to their incremental learning capabilities but does not explore alternatives.
- Why unresolved: Only one type of base model was tested, limiting understanding of model sensitivity.
- What evidence would resolve it: Comparing forecasting accuracy using various incremental learning models (e.g., stochastic gradient trees, online neural networks) under the same experimental conditions.

## Limitations
- The paper relies on assumptions about piecewise stationarity in consumption patterns that may not hold for all datasets
- Specific implementation details for the weighted averaging and switching procedures near change points are not fully specified
- The optimal number of change points appears dataset-dependent, with fewer points generally preferred but the selection criteria unclear

## Confidence
- **High confidence**: The core methodology of using Hoeffding trees for incremental learning and PELT for change point detection
- **Medium confidence**: The effectiveness of the Pure Change Point-Divided approach over baseline methods, supported by experimental results
- **Low confidence**: The generalizability of findings to other consumption forecasting domains and datasets

## Next Checks
1. Test the change point detection sensitivity by varying PELT parameters (minimum segment length, penalty) and measuring impact on forecasting accuracy
2. Implement the missing implementation details for weighted averaging and switching procedures to verify reported performance
3. Validate the approach on alternative time series datasets (electricity consumption, water usage) to assess generalizability of the model collection selection framework