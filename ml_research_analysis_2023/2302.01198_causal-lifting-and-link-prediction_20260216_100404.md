---
ver: rpa2
title: Causal Lifting and Link Prediction
arxiv_id: '2302.01198'
source_url: https://arxiv.org/abs/2302.01198
tags:
- node
- causal
- embeddings
- graph
- link
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces causal lifting, a novel concept that generalizes
  probabilistic lifting to causal inference, enabling link prediction in path-dependent
  settings. The authors show that under certain causal mechanism invariances, interventional
  lifting allows identification of causal link prediction queries using limited interventional
  data.
---

# Causal Lifting and Link Prediction

## Quick Facts
- arXiv ID: 2302.01198
- Source URL: https://arxiv.org/abs/2302.01198
- Reference count: 40
- Primary result: Causal lifting enables link prediction in path-dependent settings using limited interventional data

## Executive Summary
This paper introduces causal lifting, a novel framework that generalizes probabilistic lifting to causal inference for link prediction in graphs. The key insight is that under certain causal mechanism invariances, interventional lifting allows identification of causal link prediction queries using limited interventional data. The authors demonstrate that structural pairwise embeddings, which incorporate known task invariances, exhibit lower bias and correctly represent causal structure compared to traditional node embeddings like GNNs and matrix factorization. The theoretical framework is validated across three scenarios: knowledge base completion, covariance matrix estimation, and consumer-product recommendations.

## Method Summary
The method involves learning causal link prediction models through supervised learning on probe outcomes. The framework uses graph embeddings (structural pairwise, structural node, or strictly positional) combined with link functions to minimize loss over probe outcomes. The core innovation is the identification of causal lifting conditions that enable learning from limited interventional data by exploiting symmetries in the observed graph structure.

## Key Results
- Structural pairwise embeddings consistently outperform node embedding approaches across all experiments
- Improvements of 3-20% in Hits@500 for knowledge graph completion and recommendation tasks
- Lower MSE in covariance matrix estimation compared to traditional embedding methods
- Structural embeddings correctly capture causal structure while strictly positional embeddings do not

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Causal lifting allows identification of causal link prediction queries using limited interventional data by exploiting invariances in the causal mechanisms.
- **Mechanism:** Under certain causal mechanism invariances (Assumptions 1-4), interventional lifting allows identification of causal link prediction queries using limited interventional data by finding symmetries in the observed graphG(t0).
- **Core assumption:** The causal mechanisms governing link formation exhibit specific invariances with respect to time, non-links, and node identifiers.
- **Evidence anchors:**
  - [abstract] "Under certain causal mechanism invariances, interventional lifting allows identification of causal link prediction queries using limited interventional data."
  - [section 4.3] "We now present four causal modeling assumptions over SCMs in C that will allow us to have interventional lifting in our task as in Equation (9)."
- **Break condition:** If the causal mechanisms do not exhibit the required invariances, causal lifting may not be possible.

### Mechanism 2
- **Claim:** Structural pairwise embeddings exhibit lower bias and correctly represent the task's causal structure compared to node embeddings.
- **Mechanism:** Structural pairwise embeddings achieve lower bias by encoding the joint orbit of node pairs rather than individual node properties, correctly representing the causal structure.
- **Core assumption:** The causal structure of link prediction is better represented by joint properties of node pairs rather than individual node properties.
- **Evidence anchors:**
  - [abstract] "Further, on the estimation side, we show how structural pairwise embeddings —a type of symmetry-based joint representation of node pairs in a graph— exhibit lower bias and correctly represent the causal structure of the task, as opposed to existing node embedding methods (e.g., matrix factorization and GNNs)."
  - [section 5.1] "Overall, we find that structural (joint) pairwise embeddings present lower bias than structural node embeddings and, unlike strictly positional node embeddings, correctly represents the causal structure of our task."
- **Break condition:** If the causal structure is not better represented by joint properties, structural pairwise embeddings may not provide significant advantage.

### Mechanism 3
- **Claim:** Strictly positional node embeddings incorrectly encode the causal structure for interventional lifting.
- **Mechanism:** Strictly positional node embeddings assign unique embeddings to all nodes, causing pairs in the same orbit to get different embeddings and not capture the correct causal DAG.
- **Core assumption:** Node pairs in the same orbit must be assigned the same representation to function as colliders in the causal DAG.
- **Evidence anchors:**
  - [abstract] "Finally, we show how structural pairwise embeddings —a type of symmetry-based joint representation of node pairs in a graph— exhibit lower bias and correctly represent the causal structure of the task, as opposed to existing node embeddings, e.g., GNNs and matrix factorization."
  - [section 5.3] "Overall, our theory implies that the use of strictly positional node embeddings, such as SVD and neural matrix factorization, assumes an incorrect causal structure for the causal link prediction task in Equation (2)."
- **Break condition:** If the causal structure does not require node pairs in the same orbit to be assigned the same representation, strictly positional node embeddings may not necessarily lead to incorrect encoding.

## Foundational Learning

- **Concept: Causal Inference**
  - **Why needed here:** Enables reasoning about causal effects of link interventions and predicting outcomes of such interventions
  - **Quick check question:** What is the difference between associational and causal link prediction, and why is causal link prediction more challenging?

- **Concept: Structural Causal Models (SCMs)**
  - **Why needed here:** Provide formal framework for representing causal relationships between variables in link formation
  - **Quick check question:** How do SCMs differ from traditional statistical models, and what are the key components of an SCM?

- **Concept: Graph Embeddings**
  - **Why needed here:** Represent nodes or node pairs in low-dimensional space to capture structural and causal properties
  - **Quick check question:** What are the different types of graph embeddings, and how do they differ in terms of their ability to capture structural and causal information?

## Architecture Onboarding

- **Component map:** Observed graphG(t0) -> Probe policy µ(G(t0)) -> Probe outcomes Y(M) -> Graph embeddings Γ(I,J,A(t0);WΓ) -> Counterfactual quantityP (A(t1)E(t1)(E(t1) = (U,V ))|Y (M),G (t0))

- **Critical path:**
  1. Observe the graphG(t0) at pre-trial time
  2. Perform probesY (t1), ..., Y (tM) according to policyµ(G(t0))
  3. Estimate counterfactual quantity using graph embedding method
  4. Evaluate performance on test set

- **Design tradeoffs:**
  - Model complexity vs. expressiveness: More complex models may be more expressive but harder to identify
  - Embedding type vs. bias: Structural pairwise embeddings may have lower bias but higher computational cost
  - Probe policy vs. generalization: Choice of probe policy affects generalization performance

- **Failure signatures:**
  - Poor identification if causal mechanisms don't exhibit required invariances
  - High bias if embedding method doesn't capture correct causal structure
  - Overfitting if embeddings are too complex or probe policy is not diverse

- **First 3 experiments:**
  1. **Synthetic data:** Generate synthetic graphs with known causal mechanisms to test identification and estimation procedures
  2. **Knowledge graph completion:** Evaluate performance on predicting missing relations in knowledge graph dataset
  3. **Covariance matrix estimation:** Evaluate performance on predicting outcomes of new experiments

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** How can the proposed causal lifting framework be extended to handle dynamic graphs where the link formation process changes over time?
- **Basis in paper:** [inferred] The paper focuses on static graphs and assumes time exchangeability in causal mechanisms
- **Why unresolved:** The paper does not provide a formal extension to dynamic graphs or discuss handling non-stationary link formation processes
- **What evidence would resolve it:** Formal definition of causal lifting for dynamic graphs with identification results and empirical validation

### Open Question 2
- **Question:** What are the theoretical guarantees for the proposed structural pairwise embeddings in terms of sample complexity and generalization bounds?
- **Basis in paper:** [explicit] The authors argue structural pairwise embeddings have lower bias but do not provide formal sample complexity or generalization bounds
- **Why unresolved:** While empirical performance advantages are shown, theoretical analysis of learning efficiency and generalization is lacking
- **What evidence would resolve it:** Sample complexity bounds depending on graph structure and number of probes, along with generalization bounds

### Open Question 3
- **Question:** How can the proposed causal lifting framework be adapted to handle heterogeneous graphs with multiple edge types and node attributes?
- **Basis in paper:** [explicit] The paper focuses on simple graphs without edge types or node attributes
- **Why unresolved:** The paper does not discuss extending causal lifting to heterogeneous graphs or incorporating node and edge attributes
- **What evidence would resolve it:** Formal extension to heterogeneous graphs with identification results and empirical validation

## Limitations
- Theoretical framework relies heavily on validity of causal mechanism invariances which depend on specific domain and data characteristics
- Computational complexity of structural pairwise embeddings is not explicitly discussed, potentially limiting scalability
- Results are limited to specific datasets and embedding implementations without addressing potential assumption violations

## Confidence
**High Confidence:**
- Theoretical framework for causal lifting is sound and internally consistent
- Distinction between structural pairwise and strictly positional embeddings is valid
- Experimental results showing performance improvements are reproducible

**Medium Confidence:**
- Causal mechanism invariances hold across diverse real-world datasets
- Specific embedding implementations are optimal for causal link prediction
- Probe policy is representative of practical scenarios

## Next Checks
1. **Assumption Validation:** Test causal mechanism invariances across diverse datasets to quantify how often assumptions hold and measure impact of violations
2. **Scalability Analysis:** Evaluate computational complexity and memory requirements of structural pairwise embeddings compared to node embeddings on graphs of increasing size
3. **Robustness Testing:** Design experiments where causal mechanism invariances are deliberately violated to measure how quickly and severely performance degrades