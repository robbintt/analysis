---
ver: rpa2
title: Inferring Actual Treatment Pathways from Patient Records
arxiv_id: '2309.01897'
source_url: https://arxiv.org/abs/2309.01897
tags:
- treatment
- pathway
- pathways
- other
- events
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents Defrag, a method for inferring actual treatment
  pathways from administrative health records (AHRs). Defrag uses a neural network
  to learn semantic and temporal event representations, then clusters and infers a
  pathway graph.
---

# Inferring Actual Treatment Pathways from Patient Records

## Quick Facts
- arXiv ID: 2309.01897
- Source URL: https://arxiv.org/abs/2309.01897
- Reference count: 40
- Method Defrag infers treatment pathways from AHRs using neural networks and clustering

## Executive Summary
This paper presents Defrag, a method for inferring actual treatment pathways from administrative health records (AHRs). Defrag uses a neural network to learn semantic and temporal event representations, then clusters and infers a pathway graph. Experiments on MIMIC-IV show Defrag identifies modality-specific treatment clusters matching clinical guidelines for breast cancer, lung cancer, and melanoma. Synthetic experiments demonstrate Defrag significantly outperforms baselines like HMM, LDA, and PCA in pathway inference accuracy.

## Method Summary
Defrag employs a two-step approach: first, it learns semantic-temporal representations of healthcare events using a Transformer neural network with a custom semantic-temporal learning objective (STLO); second, it clusters these representations and infers pathway graphs from the cluster transitions. The method operates on AHRs without requiring pathway-specific labels, making it suitable for real-world healthcare data.

## Key Results
- Defrag identifies modality-specific treatment clusters matching clinical guidelines for breast, lung, and melanoma cancers
- Synthetic experiments show Defrag significantly outperforms HMM, LDA, and PCA baselines in pathway inference accuracy
- The method demonstrates promise for extracting clinically relevant treatment pathways from complex healthcare data

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Defrag's semantic-temporal learning objective (STLO) enables learning of joint representations that capture both semantic meaning and temporal relationships of treatment events.
- Mechanism: STLO minimizes intra-group distances while maximizing inter-group distances between adjacent event representations in the decoder sequence.
- Core assumption: The semantic and temporal patterns in AHRs are sufficiently regular that minimizing adjacent event distances captures meaningful treatment groupings.
- Evidence anchors: Weak - corpus contains related work on health trajectory prediction but no direct evidence about STLO's effectiveness specifically.
- Break condition: If AHRs contain highly irregular temporal patterns or the semantic relationships are not proximally encoded, STLO may fail to capture meaningful groupings.

### Mechanism 2
- Claim: Defrag's Transformer architecture with windowed attention captures local temporal context while maintaining semantic relationships across longer sequences.
- Mechanism: The windowed self-attention mask in the encoder limits each event to attend to only its local neighbors, preventing information overload while preserving important temporal relationships.
- Core assumption: Local temporal patterns are sufficient for capturing meaningful treatment relationships, and longer-range dependencies can be inferred through the clustering step.
- Evidence anchors: Moderate - corpus contains work on transformer architectures for health data, supporting the general approach but not this specific windowed-attention design.
- Break condition: If treatment pathways require long-range dependencies beyond the window size, or if the relative positional encoding fails to capture necessary ordering information.

### Mechanism 3
- Claim: The two-step pathway inference process (encoding → clustering → inference) effectively extracts high-level treatment patterns from complex event sequences.
- Mechanism: First, events are encoded into semantic-temporal vectors. Second, clustering groups similar events into treatment modalities. Third, temporal relationships between clusters are inferred to construct the pathway graph.
- Core assumption: The encoded event space has structure that clustering can exploit, and temporal transitions between clusters reflect actual treatment pathways.
- Evidence anchors: Weak - corpus lacks direct evidence about this specific two-step inference approach.
- Break condition: If the encoded event space is too noisy or lacks clear cluster structure, or if temporal relationships between clusters don't reflect actual treatment pathways.

## Foundational Learning

- Concept: Semantic-temporal representation learning
  - Why needed here: Defrag must learn representations that capture both what treatment events mean (semantic) and when they occur relative to other events (temporal) to infer meaningful pathways.
  - Quick check question: Can you explain why a representation that only captures semantic meaning (like standard word embeddings) would be insufficient for pathway inference?

- Concept: Self-supervised learning with custom objectives
  - Why needed here: Since AHRs lack pathway-specific annotations, Defrag must learn useful representations without explicit labels, requiring carefully designed self-supervised objectives like STLO.
  - Quick check question: Why did standard self-supervised objectives like predict-next-token or auto-encoding fail for pathway inference in this context?

- Concept: Graph inference from clustered representations
  - Why needed here: After clustering events into treatment modalities, Defrag must infer the relationships between these clusters to construct the actual treatment pathway graph.
  - Quick check question: How does the weighting scheme in Equation 6 reflect the frequency of transitions between treatment clusters?

## Architecture Onboarding

- Component map: Input preprocessing -> Vectorization -> Transformer encoding -> STLO training -> Event encoding -> Clustering -> Graph inference
- Critical path: Input → Vectorization → Transformer encoding → STLO training → Event encoding → Clustering → Graph inference
- Design tradeoffs: Window size w balances local context vs. information efficiency; STLO inductive biases vs. flexibility; clustering granularity vs. interpretability
- Failure signatures: Poor cluster separation in UMAP visualizations; disconnected vertices in inferred graphs; high graph edit distance from ground truth
- First 3 experiments:
  1. Run on synthetic data with known ground truth to verify pathway reconstruction capability
  2. Vary window size w to observe effects on cluster granularity and pathway structure
  3. Test different clustering algorithms on the same encoded representations to find optimal method for specific dataset characteristics

## Open Questions the Paper Calls Out

- How can Defrag be adapted to identify rare but clinically significant treatment pathways that are underrepresented in the data?
- How does the choice of clustering algorithm affect Defrag's pathway inference accuracy, and can automated methods be developed to select the optimal clustering approach for different datasets?
- Can pre-trained embeddings like Med2Vec improve Defrag's performance on smaller datasets, and how does this compare to training from scratch?
- How can Defrag's inferred pathways be better aligned with clinical guidelines to close the semantic gap between computational and clinically-derived pathways?
- What is the impact of varying the window size parameter w in Defrag's Transformer encoder on the granularity and interpretability of inferred pathways?

## Limitations

- Defrag's generalizability beyond cancer cohorts remains untested
- The STLO objective's effectiveness relies on the assumption that minimizing adjacent event distances captures meaningful treatment groupings
- Direct comparison to clinical guidelines provides limited validation of inferred pathways

## Confidence

- High confidence: The neural network architecture and training methodology are well-specified and reproducible
- Medium confidence: The two-step pathway inference process effectively extracts treatment patterns from AHRs
- Medium confidence: Defrag outperforms baseline methods in synthetic experiments
- Low confidence: Direct comparison to clinical guidelines provides definitive validation of inferred pathways

## Next Checks

1. **Cross-condition validation**: Apply Defrag to non-cancer conditions (e.g., cardiovascular disease, diabetes) and evaluate pathway inference performance using the same metrics (AMI, GED, WLGK) to assess generalizability.

2. **Temporal pattern sensitivity**: Systematically vary the window size parameter w across a wider range (1-10) and measure its impact on clustering quality, pathway structure, and clinical interpretability to establish optimal settings for different conditions.

3. **Clinical expert review**: Conduct a formal validation study where clinicians review a sample of inferred pathways across multiple conditions, rating their clinical plausibility and identifying specific cases where Defrag succeeds or fails in capturing actual treatment patterns.