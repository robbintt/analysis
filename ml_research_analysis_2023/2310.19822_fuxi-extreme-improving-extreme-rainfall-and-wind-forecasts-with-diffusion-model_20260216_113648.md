---
ver: rpa2
title: 'FuXi-Extreme: Improving extreme rainfall and wind forecasts with diffusion
  model'
arxiv_id: '2310.19822'
source_url: https://arxiv.org/abs/2310.19822
tags:
- fuxi-extreme
- fuxi
- forecasts
- forecast
- hres
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of accurately forecasting extreme
  weather events, such as heavy rainfall and strong winds, using machine learning
  (ML) models. While ML models like FuXi have shown superior performance compared
  to traditional numerical weather prediction (NWP) models, they tend to produce increasingly
  smooth predictions as forecast lead times increase, leading to underestimation of
  extreme event intensity.
---

# FuXi-Extreme: Improving extreme rainfall and wind forecasts with diffusion model

## Quick Facts
- arXiv ID: 2310.19822
- Source URL: https://arxiv.org/abs/2310.19822
- Reference count: 40
- Key outcome: FuXi-Extreme outperforms both FuXi and HRES in predicting extreme total precipitation, 10-meter wind speed, and 2-meter temperature using a denoising diffusion model.

## Executive Summary
FuXi-Extreme addresses the challenge of forecasting extreme weather events by enhancing the FuXi machine learning model's predictions with a denoising diffusion probabilistic model (DDPM). The model restores finer-scale details in 5-day forecasts that FuXi tends to smooth out, leading to better detection and association of extreme events. Evaluation shows FuXi-Extreme surpasses both the original FuXi model and the high-resolution forecasts of ECMWF's HRES system in predicting extreme precipitation, wind speed, and temperature, with notable improvements in tropical cyclone track forecasts.

## Method Summary
FuXi-Extreme combines the FuXi model with a DDPM that conditions on FuXi-generated surface variables and forecast time step. The DDPM denoises predictions using mean-squared-error loss, restoring high-frequency details lost in longer forecasts. Training uses ERA5 data (2012-2017) with frozen FuXi weights, focusing only on updating DDPM parameters. The model is trained on 8 A100 GPUs for approximately 24 hours using AdamW optimization.

## Key Results
- Outperforms FuXi and HRES in extreme total precipitation, 10-meter wind speed, and 2-meter temperature forecasts.
- Superior tropical cyclone track forecast accuracy compared to HRES.
- Restores finer-scale details in 5-day forecasts that FuXi smooths out.

## Why This Works (Mechanism)

### Mechanism 1
FuXi-Extreme restores high-frequency details in 5-day forecasts that FuXi smooths out, improving extreme event prediction. The DDPM model conditions on FuXi-generated surface variables and time step, denoising progressively via noise prediction and direct target reconstruction using a mean-squared-error loss. Core assumption: The forward diffusion process can be approximated in reverse using a learned Gaussian posterior, enabling detail recovery without retraining the entire FuXi pipeline.

### Mechanism 2
Conditioning on forecast time step (k) allows DDPM to adapt its denoising strategy to the degradation level in longer forecasts. Time step k is concatenated with the noisy input and surface variable conditions, enabling DDPM to predict how much noise to remove based on forecast horizon. Core assumption: Longer forecasts systematically accumulate larger deviations from ground truth, so conditioning on k provides the necessary scale for effective denoising.

### Mechanism 3
Training DDPM with fixed FuXi weights ensures stable input quality while focusing learning on detail restoration. Only DDPM parameters are updated during training; FuXi parameters are frozen, preventing drift in the underlying forecast while allowing DDPM to specialize in fine-scale correction. Core assumption: The FuXi base model produces consistent, reliable coarse predictions across forecast horizons, so retraining is unnecessary and potentially harmful.

## Foundational Learning

- **Concept**: Diffusion probabilistic models (DDPM)
  - Why needed here: Understanding the forward and reverse diffusion processes is essential to grasp how FuXi-Extreme recovers lost detail in smoothed forecasts.
  - Quick check question: What role does the variance schedule Î²_t play in ensuring the forward diffusion approximates a Gaussian distribution?

- **Concept**: Conditioning in generative models
  - Why needed here: Knowing how conditioning on auxiliary inputs (e.g., time step, FuXi outputs) affects the learned posterior is key to understanding DDPM's adaptation to forecast lead time.
  - Quick check question: How does adding a conditioning variable change the parameterization of the reverse Gaussian in DDPM?

- **Concept**: Extreme event evaluation metrics (CSI, SEDI)
  - Why needed here: These metrics determine how forecast performance is judged for rare, high-impact events, which is the central goal of FuXi-Extreme.
  - Quick check question: Why does SEDI remain meaningful for extreme events where CSI tends toward zero?

## Architecture Onboarding

- **Component map**: ERA5 data -> FuXi (frozen) -> FuXi surface outputs + time step k -> DDPM -> Enhanced surface forecasts
- **Critical path**: 1) Feed ERA5 data into FuXi (frozen), 2) Capture FuXi surface variable outputs, 3) Pass FuXi outputs + time step into DDPM, 4) Apply reverse diffusion to restore details, 5) Output enhanced forecasts for evaluation
- **Design tradeoffs**: Fixed FuXi weights (stable coarse predictions vs. inability to correct base errors), MSE loss in DDPM (simple optimization vs. potential blurring of sharp extremes), Time-step conditioning (adaptive denoising vs. added complexity in training)
- **Failure signatures**: Over-smoothed DDPM output (MSE loss too dominant, missing extreme peaks), Unstable DDPM training (learning rate or batch size mismatch with large input tensors), Degraded track forecasts (DDPM overfits surface variables, losing coherence with upper-air dynamics)
- **First 3 experiments**: 1) Compare DDPM output against ERA5 for a single extreme event to confirm detail restoration, 2) Run ablation: train DDPM with and without time-step conditioning to quantify k's impact, 3) Evaluate CSI/SEDI separately for low vs. high percentile thresholds to confirm extreme-event focus

## Open Questions the Paper Calls Out
The paper does not explicitly call out open questions but acknowledges the need for interpretability in ML models for extreme weather forecasting and the importance of verifying whether model reasoning aligns with physical understanding of weather systems.

## Limitations
- No ablation studies isolating DDPM's contribution versus FuXi's base performance.
- Does not explore whether simpler post-processing methods could achieve similar extreme event restoration.
- MSE loss may not be optimal for preserving sharp extreme event features.

## Confidence
- DDPM effectiveness for extreme detail restoration: High
- Time-step conditioning benefits: Medium
- TC track forecast improvements: Medium

## Next Checks
1. **Ablation study**: Train FuXi-Extreme without time-step conditioning to quantify k's specific contribution to extreme event recovery.
2. **Loss function comparison**: Replace MSE with a loss emphasizing sharp transitions (e.g., Huber or adversarial loss) to assess impact on extreme event fidelity.
3. **Cross-dataset evaluation**: Test FuXi-Extreme on an independent extreme weather dataset (e.g., from a different year or region) to verify robustness beyond the 2018 evaluation period.