---
ver: rpa2
title: 'Spectrum Breathing: Protecting Over-the-Air Federated Learning Against Interference'
arxiv_id: '2305.05933'
source_url: https://arxiv.org/abs/2305.05933
tags:
- interference
- breathing
- gradient
- spectrum
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes Spectrum Breathing, a novel technique for protecting
  Over-the-Air Federated Learning (AirFL) against interference without requiring multi-cell
  cooperation or interference channel state information. The key idea is to cascade
  stochastic-gradient pruning and spread spectrum, controlled by a single parameter
  called Breathing Depth, to suppress interference without bandwidth expansion.
---

# Spectrum Breathing: Protecting Over-the-Air Federated Learning Against Interference

## Quick Facts
- arXiv ID: 2305.05933
- Source URL: https://arxiv.org/abs/2305.05933
- Reference count: 40
- Primary result: Novel Spectrum Breathing technique protects AirFL against interference without multi-cell cooperation or interference CSI, using a single parameter to cascade gradient pruning and spread spectrum.

## Executive Summary
This paper introduces Spectrum Breathing, a technique to protect Over-the-Air Federated Learning (AirFL) against interference without requiring multi-cell cooperation or interference channel state information. The method cascades stochastic-gradient pruning and spread spectrum, controlled by a single parameter called Breathing Depth, to suppress interference without bandwidth expansion. The authors develop a martingale-based convergence analysis that reveals a tradeoff between gradient-pruning and interference-induced error, then optimize breathing depth to maximize performance gain. Experiments show AirBreathing FL with either fixed or adaptive breathing depth can ensure convergence even under strong interference where traditional AirFL fails, with the adaptive scheme achieving close-to-ideal performance.

## Method Summary
The Spectrum Breathing technique protects AirFL by cascading gradient pruning and spread spectrum under a single breathing depth parameter. For each round, devices prune their gradients according to a pattern broadcasted by the server, then spread the pruned gradients using PN sequences. The server receives the superposition, despreads, and aggregates. Two schemes are proposed: fixed breathing depth using a closed-form solution based on expected receive SIR, and adaptive breathing depth that adjusts based on estimated gradient norm and variance. The method ensures convergence by bounding AirComp error through a tradeoff between pruning-induced reconstruction error and interference suppression via processing gain.

## Key Results
- AirBreathing FL with fixed breathing depth converges under strong interference where traditional AirFL fails
- Adaptive breathing depth with CSI/GSI feedback achieves near-optimal performance
- Single-parameter control maintains constant spectral occupancy while suppressing interference power by processing gain factor
- Closed-form breathing depth optimization provides simple, feedback-free protection against interference

## Why This Works (Mechanism)

### Mechanism 1
Cascading gradient pruning and spread spectrum under a single "breathing depth" parameter allows interference suppression without bandwidth expansion. The breathing depth parameter controls both the fraction of gradient coefficients retained (pruning ratio γ) and the processing gain of spread spectrum (G = 1/γ). By ensuring γ·G = 1, the total spectral occupancy remains constant, but interference power is reduced by factor G through despreading. Core assumption: Pruning is statistically equivalent to adding zero-mean noise with bounded variance; spread spectrum despreading reduces interference power by processing gain while preserving the signal. Break condition: If gradient elements are not i.i.d. or pruning is magnitude-based, the statistical assumptions fail and despreading no longer yields the expected interference suppression.

### Mechanism 2
The AirComp error can be decomposed into gradient-pruning error and interference-induced error, each governed by breathing depth. Pruning reduces the number of elements transmitted, introducing a reconstruction error proportional to (1−γ) times gradient energy. Spread spectrum increases the processing gain, reducing interference-induced error proportionally to 1/G². The breathing depth trades these two effects. Core assumption: Channel inversion and AirComp correctly align signal magnitudes; interference remains Gaussian and uncorrelated with signal. Break condition: If interference is non-Gaussian or correlated, or if channel inversion fails due to deep fading, the error decomposition no longer holds.

### Mechanism 3
Optimizing breathing depth to minimize an upper bound on total AirComp error yields either a fixed or adaptive depth policy. Without CSI/GSI, the depth is fixed at G* = ⌊x*⌋βF(G), inversely related to receive SIR. With CSI/GSI, depth adapts per round based on estimated gradient norm and variance. Core assumption: GSI and CSI can be estimated at the server with negligible overhead; the upper bound is tight enough to guide practical design. Break condition: If gradient statistics change too rapidly for estimation or CSI feedback is delayed, the adaptive policy may become unstable or sub-optimal.

## Foundational Learning

- Martingale-based convergence analysis for stochastic optimization
  - Why needed here: Provides a principled way to bound the probability of failing to converge in the presence of AirComp errors and fading
  - Quick check question: What is the key difference between a supermartingale and a regular martingale in this context?

- Over-the-Air computation (AirComp) and channel inversion
  - Why needed here: Enables simultaneous gradient aggregation across devices; channel inversion aligns received signal magnitudes despite fading
  - Quick check question: How does truncated channel inversion avoid deep fading while still enabling amplitude alignment?

- Spread spectrum and processing gain
  - Why needed here: Suppresses interference power by factor G through despreading, trading bandwidth for interference resilience
  - Quick check question: Why does a larger processing gain require a smaller pruning ratio under the fixed product constraint?

## Architecture Onboarding

- Component map: Devices compute gradients → apply pruning (Ψ) → channel inversion → spectrum spreading (PN sequence) → transmit → Server receives superposition → despreads (Cs⁻¹) → de-normalizes → zero-pads (Ψ⁻¹) → aggregates → broadcasts updated model

- Critical path:
  1. Device computes local gradient
  2. Applies pruning according to ψ broadcasted by server
  3. Spreads pruned gradient with PN sequence
  4. Server receives superposition, despreads, and aggregates
  5. Server updates global model and broadcasts back

- Design tradeoffs:
  - Fixed vs adaptive breathing depth: simplicity and no feedback vs better performance at cost of GSI/CSI estimation
  - Processing gain vs pruning ratio: more interference suppression vs slower convergence
  - Power control vs breathing depth: traditional power control ineffective against strong interference; breathing depth suppresses interference without increasing transmit power

- Failure signatures:
  - Divergence or oscillation in validation accuracy → interference too strong for current depth
  - Very slow convergence → pruning ratio too aggressive (small G)
  - Erratic accuracy → GSI/CSI estimation errors or outdated feedback

- First 3 experiments:
  1. Run with Gn=1 (no breathing) under strong interference; observe failure to converge
  2. Fix Gn at optimal closed-form value; verify convergence improves over Gn=1
  3. Enable adaptive depth with GSI/CSI feedback; compare convergence speed and final accuracy against fixed depth

## Open Questions the Paper Calls Out
- Multi-cell systems: The paper mentions potential generalization to multi-cell or distributed AirFL systems but does not provide experimental results for such scenarios. This remains unresolved due to limited experimental evaluation to single-cell setup.
- Synchronization errors: The analysis assumes perfect synchronization but acknowledges that synchronization errors are a practical issue warranting further investigation.
- Security against malicious attacks: The paper mentions security as a practical issue warranting further investigation but does not address it in the current work.

## Limitations
- Statistical assumptions may break down if gradient elements are not i.i.d. or if interference is non-Gaussian
- Adaptive breathing depth performance depends critically on accurate CSI and GSI estimation with minimal delay
- Experimental validation limited to single-cell setup with 10 devices and MNIST dataset

## Confidence
- Convergence analysis: Medium - martingale bound is tight only if AirComp error is bounded and interference remains Gaussian
- Fixed depth scheme: Medium-High - simpler, more robust to estimation errors
- Adaptive depth scheme: Medium - gains depend on feedback quality and may be affected by delays

## Next Checks
1. Test sensitivity of adaptive breathing depth to delayed or noisy CSI/GSI feedback by introducing synthetic feedback errors in simulation
2. Validate the AirComp error decomposition empirically by measuring gradient-pruning and interference-induced errors separately under varying breathing depths
3. Evaluate robustness to non-Gaussian interference (e.g., impulsive noise) by replacing the Rayleigh fading model with a mixture distribution