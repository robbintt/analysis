---
ver: rpa2
title: Physics-Informed Deep Learning to Reduce the Bias in Joint Prediction of Nitrogen
  Oxides
arxiv_id: '2308.07441'
source_url: https://arxiv.org/abs/2308.07441
tags:
- data
- used
- testing
- were
- samples
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The study develops a physics-informed deep learning framework to
  predict nitrogen oxides (NOx) concentrations at ground level. The framework incorporates
  atmospheric advection-diffusion mechanisms and fluid dynamics constraints to reduce
  estimation bias compared to purely data-driven machine learning methods.
---

# Physics-Informed Deep Learning to Reduce the Bias in Joint Prediction of Nitrogen Oxides

## Quick Facts
- arXiv ID: 2308.07441
- Source URL: https://arxiv.org/abs/2308.07441
- Authors: 
- Reference count: 40
- Primary result: Physics-informed deep learning framework achieves R² of 0.95-0.96 and RMSE of 1.54 ppb (NO2) and 3.25 ppb (NOx) in site-based independent testing, substantially outperforming baseline methods.

## Executive Summary
This study develops a physics-informed deep learning framework to predict ground-level nitrogen oxides (NOx) concentrations by incorporating atmospheric advection-diffusion mechanisms and fluid dynamics constraints. The approach reduces estimation bias compared to purely data-driven machine learning methods by enforcing physical laws through partial differential equation residuals in the training process. The framework jointly predicts NO2 and NOx concentrations, achieving robust spatial extrapolation and uncertainty quantification.

## Method Summary
The method uses a 2D terrain-following Eulerian system with advection-diffusion PDEs encoded via residuals in a joint physics-informed neural network (PINN) architecture. The model incorporates meteorological data, traffic proxies, land use, elevation, and temporal features as inputs. A 14-parameter network estimates velocity, diffusion coefficients, and density parameters, while a concentration network predicts NO2 and NOx with shared weights. Training combines MSE residuals for observed concentrations with physics residuals enforcing continuity equations and threshold constraints, optimized using Adam with gradient clipping.

## Key Results
- Achieves mean R² of 0.95-0.96 and RMSE of 1.54 ppb (NO2) and 3.25 ppb (NOx) in site-based independent testing
- Reduces estimation bias by 21-42% compared to baseline methods like XGBoost and random forest
- Captures fine-scale pollutant transport and provides robust spatial extrapolation beyond training regions

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Physics-informed neural networks reduce NOx prediction bias by enforcing conservation of mass and continuity in the model training process.
- Mechanism: The model encodes partial differential equations (PDEs) representing advection-diffusion processes into the loss function, penalizing predictions that violate physical laws.
- Core assumption: NOx concentrations evolve according to atmospheric fluid dynamics, and observed concentration data contain sufficient information to approximate otherwise unmeasurable parameters like velocity and diffusion coefficients.

### Mechanism 2
- Claim: Joint modeling of NO2 and NOx concentrations captures their chemical interactions and physical relationships, improving prediction accuracy over separate models.
- Mechanism: The network architecture shares parameters between NO2 and NOx predictions and explicitly encodes their relationship (NO2 ≤ NOx) and threshold constraints in the loss function.
- Core assumption: NO2 and NOx concentrations are physically linked through atmospheric chemical reactions and transport processes, and this relationship is consistent across the prediction domain.

### Mechanism 3
- Claim: Using elevation and terrain-following coordinates in the PDE formulation accounts for vertical mixing effects on ground-level NOx concentrations despite lacking direct vertical measurements.
- Mechanism: The model includes elevation as a spatial dimension in the PDE and incorporates vertical meteorological variables (temperature, wind speed at different altitudes) to simulate how terrain affects pollutant dispersion.
- Core assumption: Vertical atmospheric processes significantly influence ground-level NOx concentrations, and reanalysis data can adequately represent these processes at the spatial scale of the model.

## Foundational Learning

- Concept: Partial Differential Equations (PDEs) for atmospheric transport
  - Why needed here: The model uses PDEs to represent advection-diffusion processes that govern NOx movement and transformation in the atmosphere
  - Quick check question: What are the three main terms in the continuity equation for atmospheric pollutants, and what physical processes do they represent?

- Concept: Physics-informed neural networks (PINNs)
  - Why needed here: PINNs allow embedding physical laws directly into deep learning models by incorporating PDE residuals into the loss function
  - Quick check question: How do PINNs differ from traditional neural networks in terms of training objectives and constraints?

- Concept: Automatic differentiation
  - Why needed here: Tensorflow's automatic differentiation computes gradients of the PDE residuals with respect to model parameters, enabling efficient training
  - Quick check question: What role does automatic differentiation play in solving PDE-constrained optimization problems in PINNs?

## Architecture Onboarding

- Component map: Input layer -> Parameter estimation network (14 parameters) -> PDE residual computation (e1, e2) -> Concentration estimation network -> Constraint residuals (e3-e5) -> MSE residuals (e6, e7) -> Combined loss function -> Adam optimizer

- Critical path: Data preprocessing → Parameter network forward pass → PDE residual computation → Concentration network forward pass → Constraint and MSE residual computation → Total loss calculation → Backpropagation → Parameter update

- Design tradeoffs:
  - Joint vs. separate modeling: Joint modeling captures NO2-NOx interactions but increases complexity; separate modeling is simpler but may miss important relationships
  - Physics constraints vs. pure data-driven: Physics constraints reduce bias but may limit flexibility; pure ML is more flexible but prone to bias
  - Elevation inclusion vs. exclusion: Including elevation improves terrain effects modeling but adds computational complexity; excluding it simplifies the model but may reduce accuracy

- Failure signatures:
  - High PDE residuals after training: Physics constraints are not being satisfied, indicating poor model fit to physical laws
  - Large gap between training and site-based testing performance: Model is overfitting to training data and failing to generalize spatially
  - Negative NO2 predictions: Threshold constraints are not working properly or model is producing physically impossible results
  - Slow convergence: Network architecture or learning rate may need adjustment; physics constraints may be too restrictive

- First 3 experiments:
  1. Train the model without physics constraints (only MSE loss) and compare performance metrics to identify the contribution of physics constraints
  2. Train separate PINNs for NO2 and NOx (no parameter sharing) and compare to joint model to quantify benefits of joint modeling
  3. Train the model without elevation in the PDE (2D horizontal only) and compare to full 2D terrain-following model to assess elevation's contribution

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do the physics-informed neural networks handle vertical transport processes for NOx, given that ground-level measurements are used but vertical advection-diffusion processes are significant?
- Basis in paper: The paper mentions that vertical measurements of NOx concentrations are unavailable and that vertical advection cannot be considered, though vertical meteorological data is included.
- Why unresolved: The study does not provide validation or assessment of how accurately the model captures vertical transport processes using only ground-level data and vertical meteorological parameters.
- What evidence would resolve it: Additional validation studies using vertical NOx concentration measurements from tall towers or aircraft measurements to evaluate model performance in capturing vertical transport processes.

### Open Question 2
- Question: What is the optimal balance between physical constraints and data-driven learning in the physics-informed neural network framework, and how does this balance affect prediction accuracy and bias?
- Basis in paper: The paper discusses encoding physical constraints (e1-e5) but doesn't systematically explore how varying the weights of these constraints affects model performance.
- Why unresolved: The study uses fixed weights for physical residuals without exploring sensitivity to different weighting schemes or comparing performance with varying constraint strengths.
- What evidence would resolve it: Systematic experiments varying the weights of physical residuals and measuring corresponding changes in prediction accuracy, bias, and uncertainty estimates.

### Open Question 3
- Question: How well do the physics-informed models generalize to regions with different emission characteristics, topography, or meteorological conditions compared to the California test case?
- Basis in paper: The paper validates the approach specifically for California and mentions the method's potential for other pollutants and regions, but doesn't demonstrate performance in other contexts.
- Why unresolved: The study is limited to one geographic region with specific emission patterns, terrain, and climate, leaving uncertainty about model transferability.
- What evidence would resolve it: Application and validation of the framework in diverse geographic regions with different emission sources, terrain features, and climate conditions, comparing performance across contexts.

## Limitations
- Model generalizability to regions with different atmospheric conditions or chemical regimes remains uncertain
- The 2D terrain-following approach may not fully capture complex vertical mixing effects without direct vertical concentration measurements
- Accuracy depends heavily on the quality and representativeness of the 14-parameter network estimates for unmeasurable physical parameters

## Confidence
- Confidence: High in improved bias reduction compared to baseline ML methods within the study domain
- Confidence: Medium in the assumption that 2D terrain-following coordinates adequately capture vertical mixing effects
- Confidence: Medium in the robustness of the parameter estimation network
- Confidence: Low on the generalizability of the physics-informed approach to regions with different atmospheric conditions

## Next Checks
1. Cross-regional validation: Test the model on NOx concentration data from regions with substantially different terrain and emission sources to assess generalizability limits
2. Vertical profile validation: Compare model predictions against available vertical NOx concentration profiles from aircraft measurements or tall towers to verify the accuracy of the terrain-following PDE formulation
3. Ablation study on physics constraints: Systematically remove individual physics constraints to quantify their specific contributions to bias reduction and identify which constraints are most critical for performance