---
ver: rpa2
title: 'PINN surrogate of Li-ion battery models for parameter inference. Part I: Implementation
  and multi-fidelity hierarchies for the single-particle model'
arxiv_id: '2312.17329'
source_url: https://arxiv.org/abs/2312.17329
tags:
- pinn
- training
- battery
- neural
- surrogate
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work develops a physics-informed neural network (PINN) surrogate
  model for the single-particle model (SPM) of Li-ion batteries, aiming to significantly
  accelerate parameter inference for state-of-health diagnostics. The study introduces
  a multi-fidelity hierarchical training strategy that trains multiple PINNs with
  increasing levels of model fidelity, which notably improves surrogate accuracy when
  training solely on governing equation residuals.
---

# PINN surrogate of Li-ion battery models for parameter inference. Part I: Implementation and multi-fidelity hierarchies for the single-particle model

## Quick Facts
- arXiv ID: 2312.17329
- Source URL: https://arxiv.org/abs/2312.17329
- Reference count: 40
- Primary result: Physics-informed neural network (PINN) surrogate model for single-particle model (SPM) of Li-ion batteries with multi-fidelity hierarchical training that achieves accuracy comparable to finite-difference PDE solutions while offering orders-of-magnitude faster computation.

## Executive Summary
This work develops a physics-informed neural network (PINN) surrogate model for the single-particle model (SPM) of Li-ion batteries, aiming to significantly accelerate parameter inference for state-of-health diagnostics. The study introduces a multi-fidelity hierarchical training strategy that trains multiple PINNs with increasing levels of model fidelity, which notably improves surrogate accuracy when training solely on governing equation residuals. Key innovations include strict enforcement of initial and boundary conditions via distance functions, architectural designs that enforce spatiotemporal dependencies, and optimized weighting of physics loss terms. The PINN surrogate achieves accuracy comparable to finite-difference PDE solutions while offering orders-of-magnitude faster computation. This enables efficient high-throughput Bayesian calibration for internal parameter estimation from voltage responses, making it a valuable tool for rapid and non-destructive battery diagnostics.

## Method Summary
The method employs a merged neural network architecture with gradient pathology blocks to approximate the SPM's state variables (solid-phase concentrations and electric potentials). Initial conditions are strictly enforced using exponential distance functions rather than loss terms, ensuring exact satisfaction at t=0. Physics loss terms are weighted based on expected magnitudes and optimized via hyperparameter tuning. The multi-fidelity hierarchical training trains PINNs sequentially from linearized to full non-linear Butler-Volmer kinetics, using each level to refine the previous solution. Training uses ADAM for initial optimization followed by L-BFGS for fine-tuning.

## Key Results
- Multi-fidelity hierarchical training significantly improves surrogate accuracy when training solely on governing equation residuals
- Strict enforcement of initial and boundary conditions via distance functions ensures exact satisfaction of physical constraints
- Physics loss terms weighted by optimized coefficients improve convergence and accuracy
- PINN surrogate achieves accuracy comparable to finite-difference PDE solutions with orders-of-magnitude faster computation
- Optimized architecture with gradient pathology blocks improves solution accuracy for both linear and non-linear formulations

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Multi-fidelity hierarchical training improves surrogate accuracy by progressively increasing model complexity.
- Mechanism: A sequence of neural networks is trained, starting with a simplified model (linearized Butler-Volmer) and iteratively refining the solution using more complex models. Each level corrects the previous one, reducing error accumulation.
- Core assumption: Lower-fidelity models provide reasonable initial approximations that can be refined by higher-fidelity corrections.
- Evidence anchors:
  - [abstract] "A multi-fidelity hierarchical training, where several neural nets are trained with multiple physics-loss fidelities is shown to significantly improve the surrogate accuracy when only training on the governing equation residuals."
  - [section] "The primary purpose of developing PINNs for Li-ion batteries is to drastically decrease the computational time required to solve these physics-based models."
- Break condition: If lower-fidelity models are too far from the target solution, corrections may not be easier than direct high-fidelity learning.

### Mechanism 2
- Claim: Strict enforcement of initial and boundary conditions via distance functions ensures exact satisfaction of physical constraints.
- Mechanism: Instead of penalizing violations through loss terms, initial conditions are embedded in the network output using exponential distance functions that guarantee exact matching at t=0.
- Core assumption: The initial condition is known and can be expressed as a function of time.
- Evidence anchors:
  - [section] "Following Ref. [46, 47], the initial conditions are not enforced via a loss term, but via distance functions, which guarantees that the PINN exactly matches the prescribed initial conditions."
  - [section] "This approach ensures that at t = 0 s the predicted solution exactly matches the prescribed initial condition (i.e., ξ(0) = ξ0)."
- Break condition: If initial conditions are unknown or poorly characterized, this approach cannot be applied.

### Mechanism 3
- Claim: Weighting physics loss terms based on expected magnitudes and sensitivity analysis improves convergence and accuracy.
- Mechanism: Residual equations are rescaled by coefficients optimized via hyperparameter tuning to balance their contributions to the total loss.
- Core assumption: The relative importance of different physics terms can be estimated a priori or through sensitivity analysis.
- Evidence anchors:
  - [section] "To regularize the residual magnitudes, all residual equations are rescaled by an a priori estimate of the right-hand side magnitude so that the residual equation magnitude is close to a percentage residual error."
  - [section] "In total, 150 runs were simulated with random sampling of the physics loss weights spanning the range of [0.1, 1000]."
- Break condition: If the scaling assumptions are incorrect, the optimization may become unstable or converge to poor solutions.

## Foundational Learning

- Concept: Physics-informed neural networks (PINNs)
  - Why needed here: PINNs leverage governing equations to train models where data is scarce, crucial for battery parameter inference.
  - Quick check question: How does a PINN differ from a traditional supervised neural network?

- Concept: Single-particle model (SPM) of Li-ion batteries
  - Why needed here: The SPM is the simplified physics model being surrogated by the PINN for rapid parameter inference.
  - Quick check question: What are the key assumptions of the SPM that make it computationally efficient?

- Concept: Bayesian calibration and Markov-Chain Monte-Carlo (MCMC)
  - Why needed here: These techniques require many model evaluations, making the speed-up from PINN surrogates essential for practical parameter inference.
  - Quick check question: Why is computational speed critical for Bayesian calibration in battery parameter inference?

## Architecture Onboarding

- Component map:
  - Input layer: Spatiotemporal variables (time t, radius r)
  - Hidden layers: Residual blocks or gradient pathology blocks for improved accuracy
  - Output branches: Separate branches for cs,an, cs,ca, ϕe, and ϕs,ca
  - Distance functions: Enforce initial conditions
  - Activation functions: Enforce boundedness and monotonicity of concentrations

- Critical path:
  1. Rescale input variables to [0,1]
  2. Pass through hidden layers with residual/gradient pathology blocks
  3. Split into output branches for each state variable
  4. Apply distance functions and activation functions to enforce constraints
  5. Compute physics loss with weighted residuals
  6. Train using ADAM followed by L-BFGS

- Design tradeoffs:
  - Split vs. merged architecture: Split allows specialization but may miss couplings; merged enforces coupling but requires more complex latent space
  - Linearized vs. non-linear Butler-Volmer: Linearized is more stable but less accurate; non-linear is accurate but prone to training instabilities
  - Precision: Double precision improves accuracy but increases computational cost

- Failure signatures:
  - Trivial solution (no time variation): Indicates boundary conditions are not weighted sufficiently
  - Large training variability: Suggests weight initialization or architecture issues
  - Catastrophic failure with non-linear Butler-Volmer: Indicates instability in handling exponential terms

- First 3 experiments:
  1. Implement basic PINN with split architecture and residual blocks, train on SPM with linearized Butler-Volmer, compare to finite-difference solution
  2. Experiment with different weightings of physics loss terms, measure impact on accuracy and convergence
  3. Implement hierarchical training with two levels (linearized then non-linear Butler-Volmer), compare accuracy to single-level training

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the accuracy of the PINN surrogate model change when extending from the SPM to more complex battery models like the P2D model, particularly in terms of handling nonlinearities and computational efficiency?
- Basis in paper: [explicit] The authors mention extending techniques to the P2D model in Part II and discuss challenges with nonlinearities in the Butler-Volmer formulation.
- Why unresolved: The paper focuses on the SPM model, and while the authors plan to extend their work to the P2D model, specific results and comparisons are not provided.
- What evidence would resolve it: Detailed accuracy and efficiency comparisons between PINN surrogates for SPM and P2D models, including handling of nonlinearities and computational costs.

### Open Question 2
- Question: What is the optimal balance between data-driven training and physics-informed constraints in PINN models for battery state estimation, especially in scenarios with limited observational data?
- Basis in paper: [explicit] The authors discuss using both data and governing equations in PINN training, highlighting the need for data efficiency.
- Why unresolved: The paper primarily focuses on scenarios with limited data, but does not provide a comprehensive analysis of how to balance data-driven and physics-informed approaches.
- What evidence would resolve it: Empirical studies comparing different ratios of data-driven to physics-informed training in various battery modeling scenarios.

### Open Question 3
- Question: How do different neural network architectures and training strategies impact the generalizability and robustness of PINN models across diverse battery chemistries and operating conditions?
- Basis in paper: [explicit] The authors explore various architectures and training strategies, noting their impact on model performance.
- Why unresolved: The paper does not extensively test the models across diverse battery chemistries and conditions, focusing instead on a specific SPM model.
- What evidence would resolve it: Comparative studies of PINN models using different architectures and training strategies across multiple battery chemistries and operating conditions.

## Limitations
- Current work focuses on the simplified single-particle model (SPM), which may not capture all complexities of real battery systems, particularly at high C-rates or degraded states
- Performance of multi-fidelity approach demonstrated for SPM but requires validation on more complex models (addressed in Part II)
- Study relies on accurate knowledge of initial conditions and material parameters, which may not always be available in practical applications

## Confidence
- Multi-fidelity hierarchical training mechanism: High
- Generalizability of strict boundary condition enforcement: Medium
- Optimized physics loss weighting strategy: Medium

## Next Checks
1. Test the multi-fidelity approach on the more complex pseudo-2D (P2D) model in Part II to assess scalability and robustness
2. Perform sensitivity analysis on the impact of initial condition accuracy on PINN performance and diagnostic reliability
3. Compare the computational efficiency and accuracy of the PINN surrogate against other accelerated battery modeling approaches in the literature