---
ver: rpa2
title: 'Improving TTS for Shanghainese: Addressing Tone Sandhi via Word Segmentation'
arxiv_id: '2307.16199'
source_url: https://arxiv.org/abs/2307.16199
tags:
- shanghainese
- fitted
- which
- tone
- word
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a TTS system for Shanghainese that improves
  tone sandhi production through word segmentation during preprocessing. The key idea
  is to annotate lexical word boundaries to indicate prosodic domains for left-dominant
  (LD) tone sandhi, which is crucial for natural-sounding Shanghainese speech.
---

# Improving TTS for Shanghainese: Addressing Tone Sandhi via Word Segmentation

## Quick Facts
- arXiv ID: 2307.16199
- Source URL: https://arxiv.org/abs/2307.16199
- Reference count: 10
- One-line primary result: A Shanghainese TTS system using word segmentation achieves comparable comprehensibility, naturalness, accuracy, and intelligibility to Apple's VoiceOver while correctly handling LD tone sandhi cases where VoiceOver fails

## Executive Summary
This paper presents a novel approach to improving Shanghainese text-to-speech synthesis by addressing the challenge of tone sandhi, specifically left-dominant (LD) tone sandhi. The key innovation is using word segmentation during preprocessing to annotate lexical word boundaries as prosodic domain indicators, which guide the VITS model in applying correct tonal patterns. The system uses a Mandarin-trained Jieba segmenter with Shanghainese weights, converts segmented text to IPA phonemization, and trains a VITS end-to-end TTS model on 2,012 audio files. In subjective human evaluation with native speakers, the system achieved comparable scores to Apple's VoiceOver across four metrics while correctly handling LD tone sandhi in test cases where VoiceOver failed.

## Method Summary
The method uses Jieba word segmentation (trained on Mandarin) to identify lexical word boundaries in Shanghainese text, then converts these to phonemic IPA transcriptions using a Shanghainese lexicon and Yahwe Wu romanization system. This segmented and phonemized text is fed into a VITS end-to-end TTS model, which learns to apply LD tone sandhi based on the prosodic domain information provided by word boundaries. The VITS model's stochastic duration predictor and variational autoencoder architecture allow it to learn the one-to-many relationship between text and pitch contours when given prosodic structure information.

## Key Results
- The system achieved comparable comprehensibility, naturalness, accuracy, and intelligibility scores to Apple's VoiceOver in subjective human evaluation (n=11 native speakers)
- The system correctly handled LD tone sandhi in test cases where Apple's VoiceOver failed
- VITS successfully learned to apply different pitch contours to identical text strings depending on prosodic context (with vs. without tone sandhi)

## Why This Works (Mechanism)

### Mechanism 1
Word segmentation boundaries serve as effective proxies for prosodic domain boundaries in Shanghainese tone sandhi. Lexical word boundaries in Shanghainese align closely with prosodic domains for LD tone sandhi because lexical words strongly correlate with prosodic structure in Shanghainese, where tone sandhi applies across multi-syllabic words.

### Mechanism 2
The VITS model can learn the one-to-many relationship between text and pitch contours when provided with prosodic domain information. VITS uses a variational autoencoder with a stochastic duration predictor, allowing it to learn that identical text strings may have different pitch contours depending on prosodic context.

### Mechanism 3
Phonetic romanization with tone numbers provides sufficient phonological information for VITS to produce correct tone sandhi. The phonemization process converts segmented words to IPA transcriptions with tone numbers using a Shanghainese lexicon, capturing essential phonological contrasts needed for VITS to learn tone sandhi patterns.

## Foundational Learning

- Concept: Tone sandhi and left-dominant (LD) sandhi in Shanghainese
  - Why needed here: Understanding that tone sandhi applies to multi-syllabic words and that LD sandhi involves spreading the left syllable's contour to the right syllable is fundamental to why word segmentation works as a prosodic proxy
  - Quick check question: In Shanghainese, what happens tonally when you have a word like [zɑ̃²³.he³³⁴] under LD sandhi?

- Concept: Prosodic domains and their relationship to lexical structure
  - Why needed here: The core insight that lexical words correlate with prosodic domains for tone sandhi requires understanding how prosody organizes speech beyond individual phonemes
  - Quick check question: Why would lexical word boundaries be good indicators of where tone sandhi should apply?

- Concept: Variational autoencoders and stochastic duration prediction in TTS
  - Why needed here: VITS's architecture is crucial to why it can learn the one-to-many relationship between text and pitch contours when given prosodic information
  - Quick check question: How does VITS's stochastic duration predictor differ from deterministic approaches in handling multiple possible pronunciations of the same text?

## Architecture Onboarding

- Component map: Input text → Jieba word segmentation → IPA phonemization with tone numbers → VITS model → Audio output
- Critical path: Word segmentation accuracy → Phonemization quality → VITS model training convergence → Subjective evaluation with native speakers
- Design tradeoffs: Using Mandarin-trained jieba vs. training a Shanghainese-specific segmenter (resource constraints vs. accuracy), broad vs. narrow phonetic transcription (simplicity vs. phonetic detail), VITS vs. other TTS architectures (end-to-end learning vs. modular control)
- Failure signatures: Incorrect tone sandhi (likely segmentation or phonemization issues), poor naturalness or timing (likely VITS model limitations), comprehension problems (likely lexicon or transcription issues)
- First 3 experiments: Test jieba segmentation on Shanghainese test sentences and compare against gold-standard segmentation, evaluate IPA transcription accuracy by having native speakers verify romanized forms, train VITS on a small subset of data and evaluate whether it learns basic tone sandhi patterns from segmented input

## Open Questions the Paper Calls Out

1. Would training a dedicated prosodic annotation model specifically for Shanghainese tone sandhi domains outperform the word segmentation approach?

2. How does the VITS model's handling of glottal stop codas (/ʔ/) in Shanghainese compare to native speaker timing patterns?

3. Would developing Shanghainese-specific word segmentation models outperform the patched Mandarin jieba model?

4. How would the TTS system perform with multi-speaker training data rather than a single speaker?

## Limitations
- Small evaluation sample size with only 11 native speakers limits statistical power
- Resource constraints requiring use of Mandarin-trained Jieba for Shanghainese text segmentation
- Relatively small dataset (2,012 audio files, 5,607 seconds) for robust TTS training
- Evaluation focuses on subjective perceptual metrics rather than objective acoustic measurements

## Confidence
- **High confidence**: The core finding that word segmentation improves tone sandhi handling in Shanghainese TTS is supported by evaluation results
- **Medium confidence**: The mechanism by which word segmentation boundaries serve as prosodic domain indicators is theoretically sound but not empirically validated
- **Medium confidence**: The claim that VITS can effectively learn the one-to-many relationship when given prosodic information is supported by architecture description but not directly tested

## Next Checks
1. Expand subjective evaluation to include 50+ native Shanghainese speakers rating a more diverse set of sentences with controlled test cases for different tone sandhi patterns

2. Perform objective acoustic measurements comparing pitch contours, duration patterns, and formant trajectories between proposed system and baseline TTS systems on sentences containing known tone sandhi environments

3. Create gold-standard segmentation of Shanghainese test sentences and measure Jieba's segmentation accuracy specifically for Shanghainese, identifying systematic errors and their impact on tone sandhi production