---
ver: rpa2
title: 'FairMobi-Net: A Fairness-aware Deep Learning Model for Urban Mobility Flow
  Generation'
arxiv_id: '2307.11214'
source_url: https://arxiv.org/abs/2307.11214
tags:
- human
- mobility
- flow
- prediction
- fairness
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces FairMobi-Net, a novel fairness-aware deep
  learning model designed for accurate and equitable human flow prediction across
  urban regions. Unlike existing models that neglect fairness, FairMobi-Net incorporates
  fairness loss into its loss function and employs a hybrid approach combining binary
  classification and numerical regression.
---

# FairMobi-Net: A Fairness-aware Deep Learning Model for Urban Mobility Flow Generation

## Quick Facts
- **arXiv ID**: 2307.11214
- **Source URL**: https://arxiv.org/abs/2307.11214
- **Reference count**: 40
- **Primary result**: Introduces FairMobi-Net, achieving 25.5% lower NRMSE and 79.3% lower PDP than DeepGravity in Atlanta while maintaining fairness across socioeconomic groups

## Executive Summary
This study introduces FairMobi-Net, a novel fairness-aware deep learning model designed for accurate and equitable human flow prediction across urban regions. Unlike existing models that neglect fairness, FairMobi-Net incorporates fairness loss into its loss function and employs a hybrid approach combining binary classification and numerical regression. The model is validated using comprehensive mobility datasets from four U.S. cities at the census-tract level. Results show FairMobi-Net significantly outperforms state-of-the-art models, such as DeepGravity, in both accuracy and fairness metrics. For instance, in Atlanta, FairMobi-Net achieved a 25.5% lower NRMSE and a 79.3% lower PDP compared to DeepGravity, demonstrating superior prediction accuracy and equitable performance across diverse communities. Feature importance analysis highlights the critical role of distance and road network structures in shaping human mobility flows.

## Method Summary
FairMobi-Net employs a hybrid modeling approach that combines binary classification and regression to handle zero-inflated mobility data. The model features a source-oriented layer structure that processes origin, destination, and shared features separately before combining them. A fairness loss term based on Proportional Demographic Parity (PDP) is incorporated into the loss function to ensure equitable predictions across socioeconomic groups. The model is trained using mobility datasets from four U.S. cities, with features including POI counts, land-use area, road network metrics, census statistics, and pairwise distance. Training involves grid search for optimal Lagrange multiplier ζ to balance accuracy and fairness objectives.

## Key Results
- Achieved 25.5% lower NRMSE and 79.3% lower PDP than DeepGravity in Atlanta
- Consistently outperformed state-of-the-art models across all four studied cities
- Demonstrated superior fairness metrics while maintaining high prediction accuracy
- Identified distance and road network structures as critical features for mobility prediction

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Introducing a fairness loss term into the loss function improves model equity without sacrificing accuracy.
- Mechanism: The fairness loss term, based on Proportional Demographic Parity (PDP), penalizes prediction accuracy disparities across predefined socioeconomic groups, forcing the model to learn equitable patterns.
- Core assumption: Prediction errors across groups can be quantified and minimized while still optimizing for overall accuracy.
- Evidence anchors:
  - [abstract] "The FairMobi-Net model uniquely incorporates fairness loss into the loss function and employs a hybrid approach, merging binary classification and numerical regression techniques for human flow prediction."
  - [section] "Consequently, we introduce the concept of Fairness Loss into the loss function of our model: Ltot = ¯l + ζ · Lf airness"
  - [corpus] Weak evidence from similar papers; most focus on accuracy rather than fairness.
- Break condition: If PDP does not decrease or NRMSE increases significantly with fairness loss weight.

### Mechanism 2
- Claim: Hybrid modeling (binary classification + regression) effectively handles zero-inflated mobility data.
- Mechanism: Stage One separates flow/non-flow cases (binary classification) to address data imbalance, while Stage Two predicts actual flow magnitudes (regression) only when flow is expected.
- Core assumption: Zero-flow and non-zero flow patterns have sufficiently distinct feature distributions to be learned separately.
- Evidence anchors:
  - [section] "In reality, the majority of the census tracts have no flow with other tracts, resulting in predominance of zero value in the training dataset."
  - [section] "In this stage, our model is formulated as a binary classifier: Bij = M1(Xi, Xj, Xi,j)"
  - [corpus] Moderate evidence from similar works using multi-stage approaches for imbalanced data.
- Break condition: If classification stage accuracy drops below 80% or regression stage becomes unstable.

### Mechanism 3
- Claim: Source-oriented layer structure improves feature learning for spatial prediction tasks.
- Mechanism: Separate layer blocks process origin, destination, and shared features before combining, allowing the model to capture asymmetric spatial relationships.
- Core assumption: Origin and destination features have different predictive importance and should be processed differently.
- Evidence anchors:
  - [section] "The input layer of our model is divided into three individual layer blocks. These blocks start with the local features Xi from origin census tract i, the local features Xj from destination census tract j and the communal features Xi,j between the census tracts respectively"
  - [section] "Compared to the previous models, our model is designed for gravity-like patterns in the flow data and is more task-oriented and places greater emphasis on zero-inflated discrete distribution."
  - [corpus] Weak evidence; no direct comparison to models without source-oriented layers.
- Break condition: If combining features via addition yields worse results than concatenation.

## Foundational Learning

- Concept: Multi-modal feature construction
  - Why needed here: Human mobility prediction requires integrating spatial, socioeconomic, and network features to capture complex movement patterns.
  - Quick check question: What are the three main categories of features used in FairMobi-Net?

- Concept: Loss function design with regularization
  - Why needed here: Balancing accuracy and fairness requires careful weight tuning between traditional loss and fairness loss terms.
  - Quick check question: What is the purpose of the Lagrangian multiplier ζ in the loss function?

- Concept: Group-based fairness metrics
  - Why needed here: Measuring fairness across different income-based groups requires specialized metrics like Proportional Demographic Parity.
  - Quick check question: How does PDP measure fairness in the context of human mobility prediction?

## Architecture Onboarding

- Component map: Input layer (three parallel blocks for origin, destination, shared features) -> Fully connected layers with GELU activation, batch norm, dropout -> Stage One (binary classification) -> Stage Two (regression) -> Final prediction (combining binary and regression outputs) -> Loss calculation (combined accuracy and fairness loss) -> Backpropagation
- Critical path: Feature extraction → binary classification → regression → final prediction → loss calculation → backpropagation
- Design tradeoffs: Complexity vs. interpretability; accuracy vs. fairness; computational cost vs. performance
- Failure signatures: High variance in MAE across groups indicates fairness issues; plateaued NRMSE suggests accuracy limitations
- First 3 experiments:
  1. Train without fairness loss (ζ=0) to establish baseline performance
  2. Train with fairness loss (ζ>0) and grid search for optimal weight
  3. Compare performance across all four study regions to assess generalizability

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do fairness-aware mobility prediction models perform in cities with vastly different socioeconomic structures compared to the U.S. metropolitan areas studied?
- Basis in paper: [inferred] The study validates FairMobi-Net on four U.S. cities and shows consistent performance, but generalizability to cities with different socioeconomic contexts is not explicitly tested.
- Why unresolved: The study does not include cities with significantly different socioeconomic structures, such as those in developing countries or cities with extreme income inequality, limiting the understanding of model robustness across diverse urban environments.
- What evidence would resolve it: Testing FairMobi-Net on mobility datasets from cities in developing countries or cities with high income inequality, and comparing fairness and accuracy metrics to those observed in U.S. cities.

### Open Question 2
- Question: What is the impact of incorporating additional demographic factors (e.g., age, gender, occupation) as sensitive attributes on the fairness and accuracy of mobility predictions?
- Basis in paper: [inferred] The paper uses income difference as the primary sensitive attribute but suggests exploring other demographic factors in future research.
- Why unresolved: The study does not experiment with other demographic factors beyond income, leaving uncertainty about how these factors might influence model fairness and accuracy.
- What evidence would resolve it: Conducting experiments where age, gender, or occupation are used as sensitive attributes in FairMobi-Net and analyzing changes in fairness metrics (e.g., PDP) and prediction accuracy.

### Open Question 3
- Question: How does the inclusion of real-time or dynamic urban features (e.g., weather, traffic conditions) affect the fairness and accuracy of mobility predictions?
- Basis in paper: [inferred] The study uses static features like land use, road networks, and socioeconomic variables but does not explore dynamic features that could influence mobility patterns.
- Why unresolved: The absence of real-time or dynamic features in the model leaves questions about its adaptability to rapidly changing urban conditions and its impact on fairness.
- What evidence would resolve it: Integrating real-time data (e.g., weather, traffic) into FairMobi-Net and evaluating changes in fairness and accuracy metrics during different conditions (e.g., rush hour vs. non-peak times).

## Limitations
- Relies on proprietary Spectus mobility data, making independent validation challenging
- Fairness assessment limited to income-based groups, potentially overlooking other important demographic dimensions
- Source-oriented architecture's superiority over alternative feature fusion methods not empirically validated through ablation studies
- Computational complexity may limit scalability to larger urban areas or finer spatial resolutions

## Confidence
- **High confidence**: Model architecture design, implementation details, and quantitative performance improvements (NRMSE, MAE reductions)
- **Medium confidence**: Fairness mechanism effectiveness and PDP improvements, due to limited external validation
- **Medium confidence**: Feature importance analysis, as the methodology follows standard practices but results are dataset-specific

## Next Checks
1. **Ablation Study**: Systematically remove the source-oriented layer structure and fairness loss components to quantify their individual contributions to overall performance improvements.

2. **Cross-City Validation**: Apply the trained FairMobi-Net models to an entirely new city not included in the original study to test generalizability across different urban contexts.

3. **Alternative Fairness Metrics**: Evaluate model performance using multiple fairness metrics (e.g., equalized odds, demographic parity difference) to ensure robustness of fairness claims beyond PDP.