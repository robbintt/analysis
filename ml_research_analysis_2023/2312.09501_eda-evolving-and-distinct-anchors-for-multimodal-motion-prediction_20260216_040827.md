---
ver: rpa2
title: 'EDA: Evolving and Distinct Anchors for Multimodal Motion Prediction'
arxiv_id: '2312.09501'
source_url: https://arxiv.org/abs/2312.09501
tags:
- anchors
- distinct
- matching
- motion
- evolving
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses multimodal motion prediction in autonomous
  driving by proposing Evolving and Distinct Anchors (EDA), a novel paradigm that
  combines evolving anchors and distinct anchors to improve both regression and scoring
  performance. EDA allows anchors to evolve through multiple decoder layers for better
  regression, and uses non-maximum suppression to select distinct anchors, reducing
  ambiguity in classification.
---

# EDA: Evolving and Distinct Anchors for Multimodal Motion Prediction

## Quick Facts
- arXiv ID: 2312.09501
- Source URL: https://arxiv.org/abs/2312.09501
- Reference count: 31
- Primary result: 13.5% relative reduction in Miss Rate on Waymo Open Motion Dataset

## Executive Summary
This paper addresses multimodal motion prediction in autonomous driving by proposing Evolving and Distinct Anchors (EDA), a novel paradigm that combines evolving anchors and distinct anchors to improve both regression and scoring performance. EDA allows anchors to evolve through multiple decoder layers for better regression, and uses non-maximum suppression to select distinct anchors, reducing ambiguity in classification. Experiments on the Waymo Open Motion Dataset show that EDA significantly improves all metrics compared to the baseline MTR, achieving a 13.5% relative reduction in Miss Rate and state-of-the-art performance. The method is also validated on the Argoverse 2 dataset with consistent improvements.

## Method Summary
EDA is a multimodal motion prediction framework that enhances the MTR (Motion TRansformer) baseline through two key innovations: evolving anchors and distinct anchors. The evolving anchors mechanism updates predefined anchor trajectories at intermediate decoder layers using the predicted trajectories from those layers, allowing anchors to redistribute themselves under specific scenes and improving regression capability. The distinct anchors mechanism applies non-maximum suppression (NMS) to anchor endpoints before matching them with the ground truth during training, which reduces ambiguity in classification by preventing similar anchors from being labeled as opposite behaviors. The framework uses a transformer-based architecture with local self-attention encoder and a 6-layer decoder with learnable intention queries, trained with mixture model loss combining regression and binary cross-entropy classification objectives.

## Key Results
- Achieves 13.5% relative reduction in Miss Rate compared to baseline MTR on Waymo Open Motion Dataset
- Shows consistent improvements across all metrics including minADE, minFDE, mAP, and Soft mAP
- Demonstrates state-of-the-art performance validated on both Waymo Open Motion Dataset and Argoverse 2

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Evolving Anchors allows regression capability to improve by redistributing anchors based on intermediate outputs.
- Mechanism: Predefined anchors are updated at intermediate decoder layers using the predicted trajectories from those layers. This redistribution lets anchors move toward likely future positions, expanding the model's ability to regress toward ground truth beyond the initial sparse anchor distribution.
- Core assumption: The intermediate predictions are sufficiently accurate to guide meaningful anchor redistribution without collapsing to trivial updates.
- Evidence anchors:
  - "The evolving anchors are initially predefined and later adjusted by the intermediate outputs from decoder layers, which means the anchors are allowed to redistribute themselves under specific scenes."
  - "making significant changes to the anchor that hits the ground truth would result in a considerable regression loss, while the refinements to unlikely ones are not encouraged."
- Break condition: If intermediate predictions are poor or unstable, anchor updates may either diverge or fail to improve coverage, negating regression gains.

### Mechanism 2
- Claim: Distinct Anchors via NMS reduces ambiguity in classification caused by prediction clustering.
- Mechanism: NMS is applied to anchor endpoints before matching them with the ground truth. This removes nearby anchors with lower scores, forcing the model to prioritize the most probable trajectory among similar ones and reducing conflicting label assignments.
- Core assumption: NMS can reliably select the most representative anchors without removing true positive matches.
- Evidence anchors:
  - "we apply non-maximum suppression (NMS) to the anchors for each decoder layer prior to matching them with the ground truth during training"
  - "we prevent the labeling of similar anchors as opposite, which significantly reduces the optimization difficulty for the classification task."
- Break condition: Over-aggressive NMS may discard true positives, leading to higher miss rates; under-aggressive NMS fails to resolve clustering ambiguity.

### Mechanism 3
- Claim: Combining evolving and distinct anchors leverages benefits of both anchor-based and prediction-based matching.
- Mechanism: Evolving anchors improve regression by allowing spatial adaptation; distinct anchors resolve scoring ambiguity from clustering. Together, they enable better coverage of possible futures while maintaining accurate trajectory scoring.
- Core assumption: The improvements from regression and classification can be combined without one undermining the other.
- Evidence anchors:
  - "EDA allows anchors to evolve through multiple decoder layers for better regression, and uses non-maximum suppression to select distinct anchors, reducing ambiguity in classification."
  - "the adoption of distinct anchors does facilitate the selection for the representative behaviors as well as the scoring performance, which is hindered by the prediction clustering phenomenon."
- Break condition: If anchor evolution introduces too much clustering, even distinct anchors may be insufficient to restore scoring quality.

## Foundational Learning

- Concept: Mixture model loss with winner-takes-all strategy
  - Why needed here: To train multimodal trajectory predictions where each component corresponds to a possible future path.
  - Quick check question: How does the winner-takes-all loss determine which component is treated as positive during training?

- Concept: Non-maximum suppression (NMS) in detection and its adaptation here
  - Why needed here: To select distinct anchors by suppressing nearby ones with lower scores, analogous to object detection but applied to trajectory endpoints.
  - Quick check question: What distance threshold is used for NMS, and how does it relate to trajectory length?

- Concept: Transformer decoder with learnable queries
  - Why needed here: The decoder generates multimodal predictions by refining learnable intention queries through multiple layers.
  - Quick check question: How many learnable queries (components) are used, and how are they initialized?

## Architecture Onboarding

- Component map:
  - Encoder: local self-attention on vectorized map and agent polylines
  - Dense future predictor: auxiliary trajectory predictions for context
  - Multi-layer decoder: learnable intention queries refined through cross-attention
  - Evolving anchors: anchor trajectories updated at specified decoder layers
  - Distinct anchors: NMS filtering before loss computation
  - Mixture model loss: regression + BCE classification

- Critical path:
  1. Encode scene context → 2. Generate initial predictions → 3. Update anchors at intermediate layers → 4. Apply NMS → 5. Compute loss with evolving, distinct anchors

- Design tradeoffs:
  - More anchor updates → better regression but increased clustering → more reliance on distinct anchors
  - More NMS suppression → cleaner classification but risk of removing true positives
  - BCE vs CE loss → BCE handles variable numbers of anchors but may slightly degrade mAP

- Failure signatures:
  - Degraded regression metrics → insufficient anchor evolution or poor intermediate predictions
  - Higher miss rate → over-aggressive NMS or unstable anchor evolution
  - Lower mAP → poor anchor selection or classification ambiguity

- First 3 experiments:
  1. Baseline anchor-based matching → establish reference regression and scoring
  2. Single anchor update → test incremental regression gain
  3. Two anchor updates + NMS → validate combined effect on both regression and classification

## Open Questions the Paper Calls Out
None explicitly stated in the provided content.

## Limitations
- Performance generalization beyond Waymo and Argoverse datasets is not demonstrated, particularly for different urban layouts and traffic densities
- No sensitivity analysis provided for anchor evolution frequency or NMS threshold tuning, leaving optimal hyperparameters unclear
- Computational overhead on edge devices with limited resources is not evaluated, despite claims of no inference latency increase on high-end GPUs

## Confidence
- Confidence is **Medium** for the claimed improvements in both regression and classification, primarily because the paper does not provide ablation studies isolating the effects of anchor evolution depth and NMS threshold tuning.
- Confidence is **High** for the methodological novelty of combining evolving and distinct anchors within a single framework, as this represents a clear architectural departure from standard anchor-based matching.
- Confidence is **Medium** for the generalization of results, as experiments are conducted only on Waymo Open Motion Dataset and Argoverse 2.

## Next Checks
1. **Anchor Evolution Sensitivity**: Conduct ablation studies varying the number and positions of anchor update layers (e.g., only layer 3, layers 2-4, layers 4-6) to determine optimal evolution frequency and identify whether the current choices are near-optimal or could be improved.

2. **NMS Threshold Analysis**: Systematically sweep the NMS IoU threshold (currently 2.5-3.5m scaled by trajectory length) to quantify the tradeoff between retained anchors and classification accuracy, reporting anchor retention rates and miss rate sensitivity to identify potential over-suppression.

3. **Cross-Dataset Generalization**: Evaluate EDA on additional motion forecasting benchmarks with different characteristics (e.g., nuScenes, INTERACTION) to validate that the combined benefits of evolving and distinct anchors transfer beyond the Waymo domain, particularly testing performance in mixed urban-suburban environments.