---
ver: rpa2
title: Clustering of illustrations by atmosphere using a combination of supervised
  and unsupervised learning
arxiv_id: '2307.15099'
source_url: https://arxiv.org/abs/2307.15099
tags:
- clustering
- atmosphere
- images
- data
- illustrations
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper addresses the challenge of clustering illustrations\
  \ by their atmosphere\u2014a vague, user-preference-related concept\u2014using a\
  \ combination of supervised and unsupervised learning. The proposed method assigns\
  \ multiple pseudo-labels indirectly related to atmosphere, trains a CNN to predict\
  \ these labels, and uses the resulting feature vectors for k-means clustering."
---

# Clustering of illustrations by atmosphere using a combination of supervised and unsupervised learning

## Quick Facts
- **arXiv ID**: 2307.15099
- **Source URL**: https://arxiv.org/abs/2307.15099
- **Reference count**: 17
- **Primary result**: A combined supervised-unsupervised method outperforms BoVW-based clustering for grouping illustrations by atmosphere, achieving higher silhouette coefficient and lower entropy relative to human classification.

## Executive Summary
This paper addresses the challenge of clustering illustrations by atmosphere—a subjective concept related to user preferences—using a novel combination of supervised and unsupervised learning. The method assigns multiple pseudo-labels indirectly related to atmosphere, trains a CNN to predict these labels, and uses the resulting feature vectors for k-means clustering. Experiments on Twitter and Danbooru datasets demonstrate that this approach produces clusters more aligned with human perception of atmosphere than conventional methods like BoVW-based clustering.

## Method Summary
The proposed method combines supervised and unsupervised learning to cluster illustrations by atmosphere without relying on explicit textual labels. Multiple pseudo-labels (e.g., "cute", "gloomy", "for woman") are assigned to each illustration, representing different facets of atmosphere. A pre-trained VGG16 CNN is fine-tuned to predict these pseudo-labels, and the multi-label output vector serves as a feature representation. K-means clustering is then applied to these feature vectors, grouping illustrations with similar atmospheric characteristics. The method is evaluated using silhouette coefficient for clustering quality and entropy to measure similarity to human-classified ground truth.

## Key Results
- The proposed method achieves higher silhouette coefficients than BoVW-based clustering on both Twitter and Danbooru datasets.
- Entropy measurements show the proposed method produces clusters closer to human perception of atmosphere than conventional approaches.
- The method demonstrates scalability and effectiveness across different datasets with varying numbers of pseudo-labels (13 for Twitter, 18 for Danbooru).

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Pseudo-labels indirectly related to atmosphere allow supervised learning to capture non-visual semantic aspects of images.
- Mechanism: Multiple pseudo-labels are assigned to each illustration to represent different facets of atmosphere. A CNN is trained to predict these labels, and the resulting feature vectors encode atmospheric qualities that low-level features miss.
- Core assumption: Atmosphere-related information is not fully captured by traditional visual features but can be indirectly represented through combinations of other descriptive labels.
- Evidence anchors: [abstract] "pseudo-labels that indirectly contribute to an ambiguous atmosphere"; [section] "instead of directly assigning labels to images, we assign the pseudo-labels that may affect the atmosphere of images"
- Break condition: If pseudo-labels are poorly chosen and don't capture atmosphere-relevant information, the feature vectors won't encode meaningful atmospheric differences.

### Mechanism 2
- Claim: K-means clustering on pseudo-label prediction outputs groups images with similar atmospheres more effectively than clustering on raw visual features.
- Mechanism: The CNN outputs multiple label intensities as a feature vector. K-means then clusters based on distances between these vectors, grouping illustrations with similar atmospheric characteristics.
- Core assumption: The distance between pseudo-label prediction vectors correlates with atmospheric similarity between illustrations.
- Evidence anchors: [abstract] "clustering is performed based on these feature vectors"; [section] "the images are clustered using the k-means method... the difference in feature vectors directly represents the difference in atmosphere"
- Break condition: If the feature space doesn't align with human perception of atmosphere, k-means will group images incorrectly regardless of algorithm choice.

### Mechanism 3
- Claim: Entropy-based evaluation shows the proposed method produces clusters closer to human perception of atmosphere than conventional methods.
- Mechanism: Entropy measures how well the clustering results match human-classified correct data. Lower entropy indicates better alignment with human perception.
- Core assumption: Human perception of atmospheric similarity can be approximated through entropy comparison with manual classifications.
- Evidence anchors: [abstract] "evaluated by measuring, using entropy, the similarity of the clustering results and the human-perceived atmosphere-based clustering"; [section] "entropy measured the degree of variability in clustering results relative to the correct data"
- Break condition: If human classification of atmosphere is inconsistent or subjective, entropy may not reliably indicate method performance.

## Foundational Learning

- Concept: Supervised learning with pseudo-labels
  - Why needed here: Direct atmosphere labeling is impractical due to its subjective and vague nature, so indirect labeling through related attributes enables supervised feature learning
  - Quick check question: How does training with pseudo-labels differ from training with direct atmosphere labels, and why is this approach necessary?

- Concept: Feature extraction using pre-trained CNNs
  - Why needed here: Pre-trained models like VGG16 provide strong visual feature representations that can be fine-tuned for specific tasks, reducing training data requirements
  - Quick check question: Why use a pre-trained model instead of training from scratch, and what are the advantages of fine-tuning for this application?

- Concept: K-means clustering on high-dimensional feature vectors
  - Why needed here: After supervised feature learning, unsupervised clustering groups similar images based on learned representations rather than requiring labeled training data
  - Quick check question: How does k-means handle the multi-dimensional output from CNN pseudo-label predictions, and what assumptions does it make about the data distribution?

## Architecture Onboarding

- Component map: Data collection → Pseudo-label assignment → CNN training (VGG16 fine-tuning) → Feature extraction → K-means clustering → Evaluation (silhouette coefficient, entropy)
- Critical path: Pseudo-label assignment → CNN training → K-means clustering
- Design tradeoffs: Using pseudo-labels enables supervised learning without direct atmosphere labels but requires careful label selection; k-means is simple but requires pre-specifying cluster count
- Failure signatures: Poor silhouette coefficients indicate ineffective clustering; high entropy relative to human classification indicates poor alignment with atmosphere perception
- First 3 experiments:
  1. Baseline comparison: Apply k-means directly to VGG16 features from ImageNet without fine-tuning to establish performance floor
  2. Pseudo-label ablation: Test with single pseudo-label vs. multiple pseudo-labels to quantify benefit of multi-label approach
  3. Cluster count sensitivity: Vary k (number of clusters) and measure silhouette coefficient and entropy to find optimal clustering granularity

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed method perform on datasets with a larger number of illustrations and a wider variety of atmospheres compared to the current datasets?
- Basis in paper: [inferred] The paper mentions the use of two datasets (Twitter and Danbooru) with a relatively small number of illustrations (673 and 966 respectively). It also suggests extending the dataset in the future to suggest illustrations closer to the desired atmosphere.
- Why unresolved: The paper does not provide experimental results or analysis on larger and more diverse datasets, leaving the method's scalability and robustness unverified.
- What evidence would resolve it: Conducting experiments on larger datasets with more diverse atmospheres and comparing the performance metrics (silhouette coefficient, entropy) with the current results would provide evidence.

### Open Question 2
- Question: How does the performance of the proposed method compare to other state-of-the-art clustering methods for image classification based on atmosphere?
- Basis in paper: [inferred] The paper compares the proposed method with a BoVW-based clustering method and a method using correct labels directly as features. However, it does not compare with other advanced clustering methods like deep clustering or contrastive learning-based methods.
- Why unresolved: The paper does not provide a comprehensive comparison with other state-of-the-art methods, making it unclear how the proposed method stands against the latest advancements in the field.
- What evidence would resolve it: Conducting experiments comparing the proposed method with other state-of-the-art clustering methods and analyzing the performance differences would provide evidence.

### Open Question 3
- Question: How sensitive is the proposed method to the choice of pseudo-labels and the number of pseudo-labels assigned to each illustration?
- Basis in paper: [explicit] The paper mentions the use of multiple pseudo-labels to represent the atmosphere of illustrations and discusses the assignment of these labels. However, it does not provide an in-depth analysis of how different choices of pseudo-labels or varying the number of labels per illustration affect the clustering performance.
- Why unresolved: The paper does not explore the impact of different pseudo-label configurations on the method's performance, leaving the robustness of the method to label selection unverified.
- What evidence would resolve it: Conducting experiments with different sets of pseudo-labels and varying the number of labels per illustration, then analyzing the clustering performance metrics, would provide evidence.

## Limitations
- The method's effectiveness relies heavily on the quality and relevance of pseudo-labels; poor pseudo-label selection could result in feature vectors that don't capture meaningful atmospheric differences.
- Atmosphere is inherently subjective, and the entropy metric assumes consistent human classification, which may not reflect the true variability in how people perceive atmospheric qualities.
- The approach was validated on Twitter and Danbooru datasets with specific pseudo-labels; performance may vary significantly with different datasets or label sets.

## Confidence

- **High confidence**: The general two-stage approach of supervised feature learning followed by unsupervised clustering is well-established and the experimental methodology is sound.
- **Medium confidence**: The effectiveness of pseudo-labels for capturing atmosphere is plausible but requires validation across different datasets and label sets.
- **Low confidence**: The entropy metric as a measure of human-like clustering requires further validation, as human perception of atmosphere is highly subjective and variable.

## Next Checks

1. **Pseudo-label sensitivity analysis**: Systematically vary the number and type of pseudo-labels to determine which combinations best capture atmospheric qualities and test on multiple datasets.
2. **Human evaluation study**: Conduct direct human evaluation of clustering results beyond entropy calculation, having multiple annotators rate atmospheric similarity within clusters.
3. **Alternative model comparison**: Test the approach with more modern architectures (e.g., ResNet, Vision Transformer) to assess whether the method's effectiveness depends on the specific CNN architecture used.