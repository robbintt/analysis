---
ver: rpa2
title: Evaluating unsupervised disentangled representation learning for genomic discovery
  and disease risk prediction
arxiv_id: '2307.08893'
source_url: https://arxiv.org/abs/2307.08893
tags:
- learning
- size
- factorv
- disentangled
- function
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper evaluates several variational autoencoder (VAE) variants
  for unsupervised disentangled representation learning in genomic discovery and disease
  risk prediction using high-dimensional clinical data. The authors compare standard
  VAEs, beta-VAEs, FactorVAEs, and non-variational autoencoders using spirograms from
  UK Biobank.
---

# Evaluating unsupervised disentangled representation learning for genomic discovery and disease risk prediction

## Quick Facts
- arXiv ID: 2307.08893
- Source URL: https://arxiv.org/abs/2307.08893
- Reference count: 13
- Standard VAEs produce less disentangled representations than FactorVAEs for genomic applications

## Executive Summary
This paper evaluates several variational autoencoder variants for unsupervised disentangled representation learning in genomic discovery and disease risk prediction using high-dimensional clinical data. The authors compare standard VAEs, beta-VAEs, FactorVAEs, and non-variational autoencoders using spirograms from UK Biobank. They find that FactorVAEs consistently produce more disentangled representations with higher heritability and discover more genome-wide significant loci for asthma and COPD compared to standard VAEs. FactorVAEs also perform well across different hyperparameter values, while beta-VAEs are more sensitive to hyperparameter choices. Additionally, polygenic risk scores based on FactorVAE representations outperform those from other methods.

## Method Summary
The study evaluates four model variants (autoencoder, VAE, beta-VAE, FactorVAE) with identical architecture (5-dimensional latent space) on UK Biobank spirogram data. Models are trained for 100 epochs with Adam optimizer (lr=0.0001, batch=32), varying beta values for beta-VAE and gamma values for FactorVAE. The evaluation includes reconstruction error, latent coordinate correlations, GWAS using BOLT-LMM, heritability estimation with LDSC, and PRS performance using the REGLE framework. Data preprocessing follows (Yun et al., 2023; Cosentino et al., 2023) with train/validation/PRS evaluation splits.

## Key Results
- FactorVAEs produce more disentangled representations with higher heritability (h²g up to 27%) than standard VAEs
- FactorVAE-based GWAS discovers more genome-wide significant loci for asthma and COPD
- Polygenic risk scores based on FactorVAE representations outperform those from other methods
- FactorVAEs perform effectively across multiple hyperparameter values, while beta-VAEs are more sensitive to hyperparameter choices

## Why This Works (Mechanism)

### Mechanism 1
- Claim: FactorVAEs produce more disentangled representations than standard VAEs when used for genomic discovery
- Mechanism: FactorVAEs explicitly penalize total correlation between latent dimensions through an additional discriminator network, while standard VAEs only encourage independence implicitly through KL divergence
- Core assumption: Total correlation is a more effective measure of dependence for promoting disentanglement than KL divergence alone
- Evidence anchors:
  - [abstract] "FactorVAEs consistently produce more disentangled representations with higher heritability and discover more genome-wide significant loci"
  - [section] "FactorVAEs adds an additional loss term to explicitly penalize the total correlation (TC; a measure of dependence for multiple random variables) of the latent coordinates"
  - [corpus] No direct evidence in corpus - corpus lacks papers specifically discussing FactorVAE's TC penalty mechanism
- Break condition: If total correlation is not a meaningful measure of biological independence in genomic data, or if the additional discriminator introduces instability that outweighs benefits

### Mechanism 2
- Claim: Disentangled representations improve heritability estimates and GWAS discovery power
- Mechanism: When latent dimensions are disentangled, each coordinate captures a distinct biological factor, reducing confounding between dimensions and allowing LDSC to more accurately estimate genetic contribution to each coordinate
- Core assumption: Disentangled coordinates correspond to independent biological mechanisms that have distinct genetic architectures
- Evidence anchors:
  - [abstract] "FactorVAEs consistently produce more disentangled representations with higher heritability and discover more genome-wide significant loci"
  - [section] "Using the stratified linkage disequilibrium score regression (LDSC)... we observed high heritability (h2g up to 27%) of learned coordinates, especially from FactorVAEs"
  - [corpus] Weak evidence - corpus contains papers on genomic sequencing and variant detection but none specifically linking disentanglement to heritability improvements
- Break condition: If biological factors are inherently correlated in ways that cannot be disentangled, or if the assumed independence does not hold in the biological system

### Mechanism 3
- Claim: Beta-VAEs are more sensitive to hyperparameter choices than FactorVAEs
- Mechanism: Beta-VAEs rely solely on adjusting the KL divergence weight (β), which affects both reconstruction quality and disentanglement in a coupled way, while FactorVAEs have separate mechanisms for reconstruction (standard VAE loss) and disentanglement (TC loss), allowing more independent control
- Core assumption: Having separate mechanisms for reconstruction and disentanglement provides more robust control over the learned representation
- Evidence anchors:
  - [abstract] "FactorVAEs performed effectively across multiple values of the regularization hyperparameter, while beta-VAEs were much more sensitive to the hyperparameter values"
  - [section] "Notably, the pairwise correlation metric also increased with very high values of β or γ... For all remaining genetic analysis, we chose the trained model with the median reconstruction error"
  - [corpus] No direct evidence in corpus - corpus lacks papers discussing hyperparameter sensitivity differences between VAE variants
- Break condition: If the coupling between reconstruction and disentanglement in beta-VAEs turns out to be beneficial for certain genomic applications, or if FactorVAEs' separate mechanisms introduce their own stability issues

## Foundational Learning

- Concept: KL divergence and its role in VAEs
  - Why needed here: Understanding how KL divergence encourages independence in latent representations is crucial for grasping why different VAE variants work differently
  - Quick check question: How does the KL divergence term in the VAE loss function encourage the learned posterior distribution to have independent coordinates?

- Concept: Total correlation as a measure of dependence
  - Why needed here: FactorVAEs use total correlation to explicitly measure and penalize dependence between latent dimensions, so understanding this concept is essential
  - Quick check question: What is total correlation and how does it differ from pairwise correlations between variables?

- Concept: Polygenic risk scores and their construction
  - Why needed here: The paper evaluates PRS performance using representations learned by different VAE variants, so understanding how PRSs work is important
  - Quick check question: How are polygenic risk scores typically constructed and what role do they play in disease prediction?

## Architecture Onboarding

- Component map: Input spirogram → Encoder CNN layers → Latent representation → Decoder CNN layers → Reconstructed spirogram; for FactorVAE, add Latent representation → Discriminator CNN layers → TC loss
- Critical path: Input spirogram → Encoder CNN layers → Latent representation → Decoder CNN layers → Reconstructed spirogram; for FactorVAE, add discriminator path: Latent representation → Discriminator CNN layers → TC loss
- Design tradeoffs: Higher β or γ values improve disentanglement but may degrade reconstruction quality; FactorVAE adds computational complexity through the discriminator but provides more stable disentanglement control
- Failure signatures: High pairwise correlations between latent coordinates indicate poor disentanglement; low heritability estimates suggest the representation doesn't capture genetic variation well; poor PRS performance indicates the representation isn't predictive of disease
- First 3 experiments:
  1. Train standard VAE and FactorVAE on spirogram data, compare reconstruction error and pairwise correlations
  2. Perform GWAS on learned representations, compare number of significant loci and heritability estimates
  3. Train PRS models using different representations, compare AUC-ROC for asthma and COPD prediction

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do the different disentanglement methods (β-VAE, FactorVAE) compare in terms of computational efficiency and training stability across different dataset sizes?
- Basis in paper: [explicit] The paper compares reconstruction error and correlation metrics across different hyperparameter values, but doesn't systematically evaluate computational efficiency or stability across varying dataset sizes.
- Why unresolved: The paper focuses on one dataset (UK Biobank spirograms) and doesn't explore how performance scales with dataset size or training time.
- What evidence would resolve it: Systematic comparison of training time, memory usage, and convergence stability across datasets of varying sizes and complexity.

### Open Question 2
- Question: What is the optimal latent dimension size for genomic discovery applications using disentangled representations?
- Basis in paper: [explicit] The paper fixes the latent dimension to 5 for direct comparison with prior work, but notes that "the optimal latent dimension size could be dataset-dependent."
- Why unresolved: The paper uses a fixed latent dimension without exploring whether different dimensions might yield better results for different traits or diseases.
- What evidence would resolve it: Systematic exploration of latent dimensions across multiple genomic traits and diseases, comparing discovery rates and heritability estimates.

### Open Question 3
- Question: How well do the discovered genetic loci generalize across different populations and ancestries?
- Basis in paper: [inferred] The paper uses UK Biobank data but doesn't address potential population stratification effects or cross-population generalizability.
- Why unresolved: The paper doesn't discuss population stratification or test the methods on multi-ethnic datasets.
- What evidence would resolve it: Validation of discovered loci in independent cohorts with different ancestries, and analysis of population-specific vs. universal genetic associations.

## Limitations
- Focuses on single data type (spirometry) and two diseases, limiting generalizability
- Uses fixed latent dimension without exploring optimal dimensionality for different applications
- Does not address population stratification or cross-population generalizability of discovered loci

## Confidence
- Comparative performance findings: High
- Mechanistic claims about why FactorVAEs work better: Medium
- Long-term stability of representations and potential batch effects: Low

## Next Checks
1. Validate the heritability estimates across multiple tissue types to assess whether the observed genetic signal is consistent or tissue-specific
2. Test the models on additional complex diseases beyond asthma and COPD to evaluate generalizability of the findings
3. Conduct ablation studies removing the TC penalty from FactorVAEs to quantify its specific contribution to improved performance