---
ver: rpa2
title: 'Realising Synthetic Active Inference Agents, Part I: Epistemic Objectives
  and Graphical Specification Language'
arxiv_id: '2306.08014'
source_url: https://arxiv.org/abs/2306.08014
tags:
- cffg
- node
- constraints
- free
- energy
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a synthetic approach to Active Inference
  (SAIF) that addresses the computational scalability issues of traditional methods.
  SAIF uses a local version of the Generalized Free Energy (GFE) functional constructed
  via constrained Bethe Free Energy optimization on factor graphs, which induces epistemic
  behavior while avoiding the need for exhaustive policy search trees.
---

# Realising Synthetic Active Inference Agents, Part I: Epistemic Objectives and Graphical Specification Language

## Quick Facts
- arXiv ID: 2306.08014
- Source URL: https://arxiv.org/abs/2306.08014
- Authors: 
- Reference count: 40
- Key outcome: This paper introduces a synthetic approach to Active Inference (SAIF) that addresses the computational scalability issues of traditional methods. SAIF uses a local version of the Generalized Free Energy (GFE) functional constructed via constrained Bethe Free Energy optimization on factor graphs, which induces epistemic behavior while avoiding the need for exhaustive policy search trees. The authors develop Constrained Forney-style Factor Graph (CFFG) notation to explicitly specify variational objectives and constraints, enabling accurate reconstruction of prior AIF algorithms and derivation of new ones. SAIF allows direct policy inference with linear scaling in planning horizon, demonstrated on a T-maze task where it reproduces the hallmark information-seeking behavior of AIF agents. The approach is modular, applicable to arbitrary graph structures, and unifies inference for perception, learning, and actions into a single procedure.

## Executive Summary
This paper introduces a synthetic approach to Active Inference (SAIF) that addresses the computational scalability issues of traditional methods. SAIF uses a local version of the Generalized Free Energy (GFE) functional constructed via constrained Bethe Free Energy optimization on factor graphs, which induces epistemic behavior while avoiding the need for exhaustive policy search trees. The authors develop Constrained Forney-style Factor Graph (CFFG) notation to explicitly specify variational objectives and constraints, enabling accurate reconstruction of prior AIF algorithms and derivation of new ones. SAIF allows direct policy inference with linear scaling in planning horizon, demonstrated on a T-maze task where it reproduces the hallmark information-seeking behavior of AIF agents. The approach is modular, applicable to arbitrary graph structures, and unifies inference for perception, learning, and actions into a single procedure.

## Method Summary
The method introduces a synthetic approach to Active Inference (SAIF) that replaces traditional exhaustive policy search with local Generalized Free Energy (GFE) optimization on factor graphs. The core innovation is the development of Constrained Forney-style Factor Graph (CFFG) notation, which extends traditional factor graph representations by adding circular beads to explicitly specify variational marginals and optimization constraints. This graphical framework enables the construction of a P-substituted GFE functional that incorporates epistemic objectives through mutual information maximization between internal states and observations. The resulting message passing algorithm directly infers policies with linear scaling in planning horizon, demonstrated through a T-maze task where the agent exhibits information-seeking behavior by first visiting an informative state before pursuing rewards.

## Key Results
- SAIF achieves linear scaling in planning horizon by replacing exhaustive policy search with local GFE optimization
- CFFG notation successfully reconstructs prior AIF algorithms and enables derivation of new ones
- T-maze experiment demonstrates information-seeking behavior characteristic of AIF agents
- The approach unifies inference for perception, learning, and actions into a single message passing procedure

## Why This Works (Mechanism)

### Mechanism 1
- Claim: SAIF replaces exhaustive policy search with local Generalized Free Energy (GFE) optimization, achieving linear scaling in planning horizon.
- Mechanism: By constructing a local GFE functional on factor graphs using P-substitution, SAIF enables direct policy inference without evaluating large search trees.
- Core assumption: The P-substitution operation correctly transforms the variational objective to include epistemic terms while maintaining tractable optimization.
- Evidence anchors:
  - [abstract] "SAIF allows direct policy inference with linear scaling in planning horizon"
  - [section 4] "Using variational calculus we then derive a custom message passing algorithm that can directly solve for fixed points of local GFE terms, removing the need for a search tree"
  - [corpus] Weak - no direct corpus support for this specific scaling claim
- Break condition: If the P-substitution introduces optimization instabilities or the resulting message passing algorithm fails to converge for larger graphs.

### Mechanism 2
- Claim: Constrained Forney-style Factor Graph (CFFG) notation enables explicit specification of both generative models and variational optimization constraints.
- Mechanism: CFFG extends traditional FFG notation by adding circular beads to represent variational marginals and constraints, making the full optimization problem visually explicit.
- Core assumption: The graphical representation accurately captures the mathematical relationships between constraints and the objective function.
- Evidence anchors:
  - [section 5] "We develop Constrained Forney-style Factor Graph (CFFG) notation which permits a fully graphical description of variational inference objectives"
  - [section 5.1] Detailed explanation of how beads represent factorisation constraints
  - [corpus] Weak - no direct corpus support for CFFG notation as described
- Break condition: If the CFFG notation becomes too complex for practical use or fails to capture certain constraint types.

### Mechanism 3
- Claim: The epistemic drive in SAIF emerges from maximizing mutual information (MI) between internal states and observations through the GFE formulation.
- Mechanism: The GFE functional incorporates a negative MI term that biases agents toward information-seeking behavior by reducing uncertainty in internal states.
- Core assumption: Maximizing MI through the GFE formulation reliably produces systematic exploration behavior in agents.
- Evidence anchors:
  - [section 3.1] "Eq. (10) shows that MI decomposes as the difference between the marginal entropy z and the expected entropy of z conditional on x"
  - [section 7] Demonstration on T-maze task where agent learns to visit informative state before reward
  - [corpus] Weak - no direct corpus support for this specific MI-based epistemic mechanism
- Break condition: If the MI term dominates other objectives excessively or fails to produce exploration in different environments.

## Foundational Learning

- Concept: Factor Graphs and Message Passing
  - Why needed here: SAIF is built on message passing algorithms over factor graphs, and understanding this foundation is critical for implementing the proposed algorithms.
  - Quick check question: How do messages flow in a factor graph during belief propagation, and what determines their direction?

- Concept: Variational Inference and Free Energy
  - Why needed here: SAIF minimizes a Generalized Free Energy functional, which is a variational inference objective, so understanding variational inference principles is essential.
  - Quick check question: What is the relationship between variational free energy and the negative log evidence, and how does this relate to inference?

- Concept: Active Inference Framework
  - Why needed here: SAIF is a synthetic version of Active Inference, so understanding the original AIF framework, including epistemic objectives and expected free energy, is crucial.
  - Quick check question: How does the Expected Free Energy (EFE) in classical AIF differ from standard variational free energy, and why is this distinction important for information-seeking behavior?

## Architecture Onboarding

- Component map:
  - CFFG specification layer: Defines the generative model, variational distributions, and constraints
  - Lagrangian construction: Combines node-local GFE terms with constraint terms
  - Message passing engine: Implements the derived update rules for inference
  - Policy evaluation module: Compares policies based on their GFE values
  - P-substitution handler: Manages the transformation of node marginals for epistemic objectives

- Critical path:
  1. Specify the generative model as an FFG
  2. Add CFFG beads to represent variational marginals and constraints
  3. Construct the Lagrangian using GFE and constraint terms
  4. Derive message passing updates from the Lagrangian
  5. Implement the message passing schedule
  6. Perform inference to obtain policy posterior

- Design tradeoffs:
  - Joint vs. factorized variational distributions: Joint distributions are more expressive but computationally expensive; factorized approximations are faster but may miss dependencies
  - P-substitution scope: Applying P-substitution to more nodes increases epistemic drive but also computational complexity
  - Message passing schedule: Synchronous updates are simpler but may converge slower than asynchronous schedules

- Failure signatures:
  - Non-convergence of message passing: Indicates poor initialization, inappropriate constraints, or numerical instability
  - Policy posterior dominated by priors: Suggests insufficient epistemic drive or overly strong goal priors
  - Oscillating message values: Points to improper scheduling or conflicting constraints

- First 3 experiments:
  1. Implement a simple CFFG with a single node and verify that the message passing algorithm converges to known analytical solutions
  2. Extend to a chain-structured model and test P-substitution on different nodes to observe changes in the resulting posteriors
  3. Implement the T-maze experiment and verify that the agent exhibits the expected information-seeking behavior by comparing policies with and without pointmass constraints on controls

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can we develop efficient sampling procedures for computing expectations under non-standard distributions like the transition mixture node's outgoing messages?
- Basis in paper: [explicit] The paper mentions using sampling procedures to estimate expectations for the message Âµ3(A) which doesn't follow a standard exponential family distribution, but doesn't provide specific algorithms.
- Why unresolved: The paper states this is a practical challenge but defers the solution to future work, leaving the implementation details unspecified.
- What evidence would resolve it: Concrete algorithms or empirical results showing efficient sampling methods that work well in practice for these non-standard distributions in active inference contexts.

### Open Question 2
- Question: What is the optimal message passing schedule for different graph structures in SAIF, and how does schedule choice affect convergence and performance?
- Basis in paper: [explicit] The paper notes that SAIF is an iterative message passing algorithm that might be sensitive to scheduling, but doesn't provide systematic analysis of schedule effects across different problem types.
- Why unresolved: While the paper demonstrates that specific schedules work for particular examples (classical AIF, GFE method, T-maze), it doesn't establish general principles for schedule selection.
- What evidence would resolve it: Empirical studies comparing different schedules across diverse graph topologies, or theoretical analysis establishing conditions under which particular schedules are optimal.

### Open Question 3
- Question: How can we extend SAIF to handle continuous state spaces while maintaining computational efficiency?
- Basis in paper: [inferred] The paper focuses on discrete implementations but mentions the goal of extending to more node constructions, suggesting continuous spaces as a natural direction, and SAIF's local nature could be advantageous here.
- Why unresolved: The paper only demonstrates discrete examples and doesn't address how to handle the additional challenges of continuous spaces (e.g., discretization, kernel methods, or alternative message representations).
- What evidence would resolve it: Concrete algorithms that extend SAIF's P-substitution and message passing to continuous variables, with demonstrations on benchmark continuous control tasks.

## Limitations

- The paper's claims about linear scaling and computational efficiency remain largely theoretical, with empirical validation limited to a single discrete T-maze task.
- While the CFFG notation provides an elegant graphical framework, its practical advantages over existing factor graph notations need systematic evaluation.
- The P-substitution mechanism, though mathematically sound, may face scalability challenges in continuous domains or with more complex state spaces.

## Confidence

- High confidence: The mathematical derivation of the GFE functional and its relationship to epistemic objectives
- Medium confidence: The claim of linear scaling in planning horizon, supported by theoretical arguments but lacking extensive empirical validation
- Medium confidence: The effectiveness of CFFG notation for specifying variational objectives, based on successful reconstruction of prior algorithms

## Next Checks

1. Test SAIF on continuous control tasks to evaluate scalability beyond discrete domains
2. Compare CFFG implementation complexity against traditional message passing frameworks for models of similar complexity
3. Systematically vary P-substitution scope to quantify the tradeoff between epistemic drive and computational cost