---
ver: rpa2
title: An unsupervised machine-learning-based shock sensor for high-order supersonic
  flow solvers
arxiv_id: '2308.00086'
source_url: https://arxiv.org/abs/2308.00086
tags:
- sensor
- shock
- learning
- high-order
- machine
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces an unsupervised machine learning sensor based
  on Gaussian Mixture Models (GMMs) for detecting shock waves in high-order compressible
  flow solvers. The proposed GMM sensor demonstrates high accuracy and robustness
  across diverse test cases without requiring parameter tuning, unlike state-of-the-art
  alternatives.
---

# An unsupervised machine-learning-based shock sensor for high-order supersonic flow solvers

## Quick Facts
- arXiv ID: 2308.00086
- Source URL: https://arxiv.org/abs/2308.00086
- Authors: 
- Reference count: 40
- Introduces an unsupervised GMM-based sensor for shock detection in high-order compressible flow solvers that requires no parameter tuning

## Executive Summary
This paper presents an unsupervised machine learning sensor based on Gaussian Mixture Models (GMMs) for detecting shock waves in high-order compressible flow solvers. The proposed approach automatically clusters the feature space to identify shock regions without requiring manual parameter tuning, unlike traditional state-of-the-art sensors. The sensor was integrated into a high-order discontinuous Galerkin solver and coupled with artificial viscosity for shock regularization, demonstrating high accuracy and robustness across diverse test cases including high Reynolds number flows.

## Method Summary
The GMM-based shock sensor operates by clustering nodal flow data into regions representing smooth flow and discontinuities. The algorithm extracts features from the flow field, including pressure gradients and velocity divergence, which are fed into the GMM. Using the Expectation-Maximization algorithm, the GMM automatically identifies clusters corresponding to shock regions. The sensor operates on a node-wise basis, enabling sub-cell shock capturing, and generates element-wise classifications for artificial viscosity application. Unlike supervised approaches, this unsupervised method requires no training datasets and adapts dynamically to varying flow conditions.

## Key Results
- The GMM sensor achieves accurate shock detection across diverse test cases without parameter tuning
- It demonstrates robustness in high Reynolds number supersonic flows
- The sensor performs as effectively as fine-tuned traditional sensors while offering adaptive behavior

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The GMM-based sensor can accurately detect shock waves without manual parameter tuning.
- Mechanism: The GMM automatically clusters the feature space into regions representing smooth flow and discontinuities by analyzing high-gradient features such as pressure gradients and velocity divergence.
- Core assumption: Shock waves create distinct high-gradient patterns in the chosen feature space that are sufficiently separable from smooth flow or turbulence.
- Evidence anchors:
  - [abstract]: "The proposed GMM sensor demonstrates remarkable accuracy in detecting shocks and is robust across diverse test cases without the need for parameter tuning."
  - [section]: "The sensor devised in this research demonstrates high accuracy by effectively identifying shocks, while other features such as turbulence or unresolved regions remain undetected."
- Break condition: If the flow contains regions with high gradients that are not shocks (e.g., boundary layers or turbulence), the GMM may incorrectly classify them as shocks unless the feature space is carefully chosen.

### Mechanism 2
- Claim: The sensor adapts dynamically to varying flow conditions without retraining.
- Mechanism: Since the GMM is unsupervised, it does not require labeled training data and adapts to the data distribution at each time step, automatically adjusting cluster assignments based on the current flow field.
- Core assumption: The underlying physics of shocks (sharp gradients in pressure and velocity divergence) remain consistent across different flow conditions, allowing the GMM to recognize them without retraining.
- Evidence anchors:
  - [abstract]: "The adaptive nature and ability to function without extensive training datasets make this GMM-based sensor suitable for complex geometries and varied flow configurations."
  - [section]: "The automatic clustering capability of the GMM enables it to adapt to the feature space effectively."
- Break condition: If the flow conditions change drastically (e.g., transition from subsonic to hypersonic), the feature space may no longer capture the shock characteristics effectively.

### Mechanism 3
- Claim: The node-wise nature of the GMM sensor enables sub-cell shock capturing.
- Mechanism: By operating on nodal values rather than element-averaged values, the GMM can assign different classifications to nodes within the same element, allowing for finer shock detection and more precise artificial viscosity application.
- Core assumption: The solution representation within each element is sufficiently smooth between nodes to allow meaningful differentiation at the nodal level.
- Evidence anchors:
  - [section]: "By feeding the GMM with nodal values, the clusters that we obtain are also node-wise... our GMM sensor can offer more specific information, enabling the use of sub-cell stabilization methods."
- Break condition: If the mesh is too coarse or the polynomial order too low, nodal differences may not be meaningful, reducing the benefit of sub-cell detection.

## Foundational Learning

- Concept: Gaussian Mixture Models (GMMs) and Expectation-Maximization (EM) algorithm
  - Why needed here: The sensor relies on GMM to automatically identify shock regions based on feature space clustering.
  - Quick check question: What are the two main steps in the EM algorithm used to fit a GMM to data?

- Concept: Feature space selection for shock detection
  - Why needed here: The effectiveness of the GMM sensor depends on choosing features that distinguish shocks from other flow features like turbulence or boundary layers.
  - Quick check question: Why might pressure gradients alone be insufficient for shock detection in viscous flows?

- Concept: Discontinuous Galerkin Spectral Element Methods (DGSEM)
  - Why needed here: The sensor is integrated into a DGSEM solver, and understanding the discretization is crucial for interpreting sensor performance.
  - Quick check question: How does the choice of polynomial order P affect the number of degrees of freedom in a DGSEM discretization?

## Architecture Onboarding

- Component map:
  Input: Nodal flow variables (density, pressure, velocity) -> Feature extraction: Computes gradients and divergence metrics -> GMM clustering: Groups nodes into smooth/discontinuous regions -> Sensor output: Element-wise classification for artificial viscosity -> Coupling: Artificial viscosity terms added to Navier-Stokes equations

- Critical path:
  1. Extract feature space from nodal values
  2. Apply GMM clustering to identify shock regions
  3. Generate element-wise sensor values
  4. Modulate artificial viscosity based on sensor output
  5. Update solution using DGSEM with stabilization

- Design tradeoffs:
  - More clusters → smoother transitions but higher computational cost
  - Finer feature space → better shock detection but potential overfitting
  - Nodal vs. element-based classification → higher accuracy vs. simplicity

- Failure signatures:
  - Excessive dissipation in smooth regions → sensor over-detecting shocks
  - Oscillations persisting → sensor under-detecting shocks
  - Simulation crash → incorrect parameter initialization or feature space selection

- First 3 experiments:
  1. Run inviscid cylinder case with default 6 clusters and verify shock detection accuracy
  2. Test sensitivity by varying cluster count from 2 to 10 and observe artificial viscosity distribution
  3. Compare sensor performance against modal and integral sensors on viscous cylinder case

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the number of clusters in the GMM sensor affect its performance in detecting shocks across different flow regimes?
- Basis in paper: [explicit] Section VI C discusses the impact of cluster number on the Bayesian Information Criterion and sensor performance.
- Why unresolved: While the paper suggests two clusters are sufficient, it doesn't explore the optimal number of clusters for varying flow complexities or geometries.
- What evidence would resolve it: Systematic testing of GMM sensor performance with varying cluster numbers across a range of flow cases, including turbulent and complex geometries.

### Open Question 2
- Question: Can the GMM sensor be extended to detect other flow features beyond shocks, such as vortices or boundary layers?
- Basis in paper: [inferred] The paper mentions the sensor's ability to detect shocks but doesn't explore its potential for identifying other flow features.
- Why unresolved: The feature space used in the GMM sensor is tailored for shock detection, and its effectiveness for other flow features is unknown.
- What evidence would resolve it: Testing the GMM sensor with different feature spaces designed to capture various flow features, and evaluating its performance against established methods.

### Open Question 3
- Question: How does the computational cost of the GMM sensor scale with increasing mesh size and polynomial order?
- Basis in paper: [explicit] Section VI D discusses the performance scaling of the GMM sensor, but focuses on parallelization strategies rather than mesh size and polynomial order.
- Why unresolved: The paper provides insights into parallelization, but doesn't address how the sensor's cost changes with problem size.
- What evidence would resolve it: Systematic analysis of the GMM sensor's computational cost for varying mesh sizes and polynomial orders, and comparison with traditional sensors.

## Limitations
- Limited comparison with traditional shock sensors across diverse flow regimes beyond tested supersonic cases
- Computational overhead of GMM clustering algorithm not quantified for large-scale simulations
- Performance in highly turbulent or transitional flows not verified

## Confidence

- High confidence: The mechanism of GMM-based clustering for shock detection is well-founded and supported by the presented results.
- Medium confidence: The claim of no parameter tuning requirement, while demonstrated, may be flow-case dependent and not universally applicable.
- Low confidence: The generalizability of the sensor to other high-order methods beyond DGSEM and to different physics (e.g., reactive flows) is not established.

## Next Checks

1. Test the sensor on subsonic-to-supersonic transition cases to evaluate its ability to handle gradual flow changes and avoid false positives in boundary layers.
2. Conduct a comprehensive performance comparison with modal and integral sensors across a broader range of Mach numbers and Reynolds numbers, including turbulent cases.
3. Measure and report the computational overhead introduced by the GMM clustering at each time step to assess scalability for industrial applications.