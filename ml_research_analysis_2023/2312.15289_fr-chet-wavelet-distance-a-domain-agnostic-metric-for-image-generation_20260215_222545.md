---
ver: rpa2
title: "Fr\xE9chet Wavelet Distance: A Domain-Agnostic Metric for Image Generation"
arxiv_id: '2312.15289'
source_url: https://arxiv.org/abs/2312.15289
tags:
- wavelet
- images
- image
- figure
- packet
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "The paper proposes the Fr\xE9chet Wavelet Distance (FWD) as a\
  \ domain-agnostic metric for evaluating image generation quality. FWD addresses\
  \ shortcomings of existing metrics like FID by using Wavelet Packet Transform to\
  \ capture both spatial and frequency information without relying on pre-trained\
  \ networks."
---

# Fréchet Wavelet Distance: A Domain-Agnostic Metric for Image Generation

## Quick Facts
- arXiv ID: 2312.15289
- Source URL: https://arxiv.org/abs/2312.15289
- Reference count: 40
- Primary result: FWD outperforms FID on face datasets and provides better generalization across domains

## Executive Summary
The paper introduces Fréchet Wavelet Distance (FWD) as a novel metric for evaluating image generation quality that addresses limitations of existing metrics like FID. FWD uses Wavelet Packet Transform to capture both spatial and frequency information without relying on pre-trained networks, making it truly domain-agnostic. The metric computes normalized wavelet power spectra of generated and real images, then measures their similarity using Kullback-Leibler divergence. Experimental results demonstrate that FWD generalizes better across different datasets and generator architectures, shows better correlation with human perception, and is more robust to input perturbations than FID.

## Method Summary
FWD computes image similarity by first applying Wavelet Packet Transform to decompose images into multi-resolution frequency bands while preserving spatial information. The method calculates normalized wavelet power spectra for both generated and real image sets, then computes symmetric Kullback-Leibler divergence between these distributions. The final score aggregates packet-wise distances across all frequency bands. This approach eliminates the need for pre-trained networks and their associated dataset biases, providing a truly domain-agnostic evaluation metric.

## Key Results
- FWD outperforms FID on face datasets where FID traditionally performs poorly
- FWD shows better generalization across different datasets and generator architectures
- FWD is more robust to input perturbations like noise and rotation compared to FID
- User study confirms FWD's alignment with human preferences for image quality

## Why This Works (Mechanism)

### Mechanism 1
- Claim: FWD avoids ImageNet dataset bias by not using pre-trained networks
- Mechanism: FWD computes similarity directly in wavelet coefficient space using normalized wavelet power spectra, eliminating reliance on feature activations from ImageNet-trained models like InceptionV3
- Core assumption: Wavelet packet transform captures sufficient image information for quality assessment without needing learned features
- Evidence anchors:
  - [abstract]: "FWD provides a sight across a broad spectrum of frequencies in images with a high resolution, preserving both spatial and textural aspects"
  - [section]: "In order to design a new quality metric... one needs to be careful regarding the domain. Using feature spaces of trained networks is not an option as it introduces an unnecessary bias"
  - [corpus]: Weak - corpus neighbors focus on different metrics and applications, not on FWD's dataset-agnostic approach
- Break condition: If wavelet representation fails to capture semantic information that ImageNet-trained networks would capture

### Mechanism 2
- Claim: FWD captures both spatial and frequency information through wavelet packet transform
- Mechanism: The WPT recursively filters images to create a multi-resolution representation that preserves spatial localization while decomposing into frequency bands, unlike Fourier transforms which lose spatial information
- Core assumption: The combination of spatial and frequency information in wavelets provides a more complete image representation than frequency-only approaches
- Evidence anchors:
  - [abstract]: "WPT to project generated and real images to the packet coefficient space" and "preserving both spatial and textural aspects"
  - [section]: "Wavelets are thus an ideal representation for a metric comparing generative approaches for image synthesis"
  - [corpus]: Weak - corpus papers mention wavelets but focus on different applications (forecasting, GAN manipulation) rather than metric development
- Break condition: If spatial information becomes irrelevant for the specific image generation task being evaluated

### Mechanism 3
- Claim: FWD provides more stable and reproducible measurements than FID
- Mechanism: FWD uses normalized wavelet power spectra and symmetric KL divergence, making it less sensitive to minor numerical perturbations like rounding or resizing compared to FID's covariance calculations
- Core assumption: Normalized distributions and symmetric divergence measures are inherently more stable than covariance-based distance metrics
- Evidence anchors:
  - [abstract]: "FWD can generalize and improve robustness to domain shifts and various corruptions compared to other metrics"
  - [section]: "Very small variations in the pixel values, which are not perceived by humans, can lead to different FID scores" and "FID is highly sensitive to resizing and compression"
  - [corpus]: Weak - corpus neighbors don't address stability/robustness issues in image generation metrics
- Break condition: If wavelet coefficient distributions become highly non-normal or if the normalization process introduces instability

## Foundational Learning

- Wavelet Packet Transform
  - Why needed here: Provides the multi-resolution frequency-spatial decomposition that forms the basis of FWD's evaluation capability
  - Quick check question: How does the WPT differ from standard wavelet transform in terms of tree expansion?

- Kullback-Leibler Divergence
  - Why needed here: Measures the distributional difference between wavelet coefficients of real and generated images
  - Quick check question: Why is the symmetric version of KL divergence used instead of the standard asymmetric form?

- Covariance Matrix Stability
  - Why needed here: Understanding why FID's covariance-based approach is problematic helps justify FWD's alternative approach
  - Quick check question: What makes covariance matrices sensitive to small numerical perturbations in image data?

## Architecture Onboarding

- Component map: Image preprocessing -> WPT decomposition -> Normalized power spectrum calculation -> Symmetric KL divergence computation -> Mean packet-wise distance aggregation -> Final FWD score

- Critical path:
  1. Apply WPT to real and generated image sets
  2. Compute normalized wavelet power spectra for both sets
  3. Calculate KL divergence in both directions
  4. Average the two divergences for final score

- Design tradeoffs:
  - WPT depth vs. computational cost (4 levels chosen for 256x256 images)
  - Wavelet type selection (sym5 chosen for balanced filter weights)
  - Symmetric vs. asymmetric divergence (symmetric chosen for stability)

- Failure signatures:
  - Extremely high FWD scores across all comparisons suggest normalization issues
  - Inconsistent scores with image resizing indicate WPT implementation problems
  - Scores that don't align with human perception suggest insufficient frequency resolution

- First 3 experiments:
  1. Compute FWD on a simple dataset (CIFAR-10) using a known good generator vs. random noise
  2. Compare FWD scores for identical images with different numerical precision to test stability
  3. Evaluate FWD on a dataset with known frequency biases (faces vs. random objects) to validate dataset-agnostic properties

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the choice of wavelet type and degree affect the stability and sensitivity of the Wavelet Packet Power Spectrum Kullback–Leibler Divergence (DW) metric?
- Basis in paper: [explicit] The paper mentions that the choice of wavelet affects the DW metric, with Daubechies wavelets showing a decreasing trend in DW value as the degree increases, while Symlets show only a minor reduction.
- Why unresolved: The paper does not provide a comprehensive analysis of how different wavelet types and degrees impact the metric's stability and sensitivity. It only mentions the trend for Daubechies and Symlets without exploring other wavelet families or degrees in detail.
- What evidence would resolve it: A detailed study comparing the performance of various wavelet types and degrees on multiple datasets, analyzing the stability and sensitivity of the DW metric under different conditions.

### Open Question 2
- Question: What is the optimal level of wavelet decomposition for different image resolutions and datasets to balance computational efficiency and metric accuracy?
- Basis in paper: [inferred] The paper discusses using different levels of wavelet decomposition (level 4 for 256x256 images, level 2 for 64x64 images, and level 1 for 32x32 images) but does not explore the optimal level for each resolution or dataset.
- Why unresolved: The paper does not provide a systematic analysis of how the wavelet decomposition level affects the metric's performance across various image resolutions and datasets. It only mentions the levels used for specific datasets without exploring the trade-offs involved.
- What evidence would resolve it: An empirical study examining the impact of wavelet decomposition levels on the DW metric's performance across a range of image resolutions and datasets, identifying the optimal balance between computational efficiency and accuracy.

### Open Question 3
- Question: How does the Wavelet Packet Power Spectrum Kullback–Leibler Divergence (DW) metric compare to other frequency-based metrics in terms of capturing perceptually relevant differences in generated images?
- Basis in paper: [explicit] The paper compares DW to the Fourier Power Spectrum Kullback–Leibler Divergence (DF) and shows that DW is more effective in capturing spatial information, but it does not compare DW to other frequency-based metrics.
- Why unresolved: The paper focuses on comparing DW to DF but does not explore how it performs against other frequency-based metrics that might capture different aspects of image quality.
- What evidence would resolve it: A comparative study evaluating DW against other frequency-based metrics (e.g., spectral distance, wavelet-based perceptual metrics) using human perception studies and objective quality assessments to determine which metric best captures perceptually relevant differences.

## Limitations
- Limited dataset diversity with focus on five image datasets without broader cross-domain testing
- Absence of quantitative human studies for direct validation of human perception correlation claims
- Computational costs not adequately addressed for large-scale image generation tasks

## Confidence
- Medium confidence in FWD's dataset-agnostic properties (limited cross-domain validation)
- Medium confidence in FWD's robustness claims (perturbation tests cover limited conditions)
- High confidence in FWD's technical implementation correctness (follows established wavelet principles)

## Next Checks
1. Conduct comprehensive human perception studies across all tested datasets to directly validate FWD's correlation with human judgment
2. Test FWD's performance on additional diverse datasets including medical imaging, satellite imagery, and artistic domains to verify true dataset-agnostic properties
3. Perform computational efficiency benchmarking comparing FWD to FID and other metrics across varying image resolutions and batch sizes to establish practical utility