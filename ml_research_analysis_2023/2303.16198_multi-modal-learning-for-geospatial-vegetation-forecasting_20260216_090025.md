---
ver: rpa2
title: Multi-modal learning for geospatial vegetation forecasting
arxiv_id: '2303.16198'
source_url: https://arxiv.org/abs/2303.16198
tags:
- weather
- vegetation
- prediction
- learning
- spatial
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: We present the first high-resolution vegetation modeling approach
  at continental scale. Using a novel GreenEarthNet dataset and Contextformer deep
  learning model, we achieve superior vegetation greenness predictions in Europe from
  Sentinel-2 imagery and meteorological data.
---

# Multi-modal learning for geospatial vegetation forecasting

## Quick Facts
- arXiv ID: 2303.16198
- Source URL: https://arxiv.org/abs/2303.16198
- Reference count: 40
- Primary result: First high-resolution continental-scale vegetation modeling approach achieving superior predictions over strong baselines

## Executive Summary
This paper presents the first high-resolution vegetation modeling approach at continental scale, using the GreenEarthNet dataset and Contextformer deep learning model to predict vegetation greenness across Europe. The method combines Sentinel-2 imagery with meteorological data through multi-modal learning, achieving superior predictions compared to strong baselines including climatology and top EarthNet2021 challenge methods. The approach demonstrates significant skill gains across all metrics and enables accurate vegetation forecasting beyond seasonal cycles, with applications to carbon monitoring and climate response prediction.

## Method Summary
The approach uses four deep learning models (ConvLSTM-meteo, PredRNN-meteo, SimVP-meteo, Earthformer-meteo) that incorporate weather conditioning through feature-wise linear modulation (FiLM) or cross-attention. Models process satellite imagery through vision backbones while simultaneously incorporating meteorological time series, allowing them to learn complex relationships between visual vegetation patterns and environmental conditions. Training uses the GreenEarthNet dataset with cloud masking improvements, optimizing for RMSE, R2, NSE, and absolute bias metrics across 100 epochs.

## Key Results
- Outperforms climatology baseline with Outperformance scores ranging from 2.2 to 20.1
- Achieves R2 scores between 0.44-0.54 and RMSE of 0.09-0.12 across different models
- Demonstrates strong spatial extrapolation capabilities with SimVP-meteo achieving best performance on out-of-distribution tests

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Weather conditioning significantly improves vegetation forecasting performance by providing direct meteorological inputs that capture environmental drivers of vegetation change.
- Mechanism: The models incorporate future weather data through feature-wise linear modulation (FiLM) or cross-attention, allowing them to anticipate vegetation responses to upcoming weather conditions rather than just relying on historical patterns.
- Core assumption: Future weather conditions are strong predictors of vegetation state changes and can be effectively integrated into deep learning models for improved forecasting.
- Evidence anchors:
  - [abstract]: "Our multi-modal transformer model Contextformer leverages spatial context through a vision backbone and predicts the temporal dynamics on local context patches incorporating meteorological time series in a parameter-efficient manner."
  - [section]: "Fig. 4 compares each one of the four models (blue) against a variant without weather conditioning (orange). For all metrics (except Earthformer-meteo R2), using weather outperforms not using it."
- Break condition: If weather data quality degrades significantly or if vegetation responses become dominated by non-meteorological factors (e.g., disease outbreaks, human interventions), the weather conditioning benefit may diminish.

### Mechanism 2
- Claim: Spatial interactions are crucial for accurate vegetation forecasting, as local terrain features and spatial context significantly influence how vegetation responds to weather conditions.
- Mechanism: The models capture spatial dependencies through convolutional operations and attention mechanisms, allowing them to account for local terrain effects (e.g., proximity to water, slope orientation) that influence vegetation response to weather.
- Core assumption: Vegetation response to weather varies spatially based on local terrain features, and these spatial patterns can be effectively learned by deep learning models.
- Evidence anchors:
  - [section]: "We assess the performance at spatio-(temporal) extrapolation of all four meteo-guided models on the OOD-s and OOD-st test sets and report in tab. 4. The SimVP and the PredRNN can extrapolate in space and time."
  - [section]: "Fig. 6b shows densities of RMSE of the ConvLSTM-meteo for different geomorphons from the Geomorpho90m map [1]. Generally, the model performs well across all classes."
- Break condition: If vegetation patterns become dominated by uniform responses across large areas (e.g., widespread climate change effects), the importance of local spatial interactions may decrease.

### Mechanism 3
- Claim: Multi-modal learning combining satellite imagery and meteorological data enables superior vegetation forecasting compared to single-modal approaches by capturing both visual vegetation state and environmental drivers.
- Mechanism: The models process satellite imagery through vision backbones while simultaneously incorporating meteorological time series, allowing them to learn complex relationships between visual vegetation patterns and environmental conditions.
- Core assumption: Satellite imagery alone contains insufficient information to accurately forecast future vegetation states, and meteorological data provides complementary predictive power.
- Evidence anchors:
  - [abstract]: "Our multi-modal transformer model Contextformer leverages spatial context through a vision backbone and predicts the temporal dynamics on local context patches incorporating meteorological time series in a parameter-efficient manner."
  - [section]: "Our extensive qualitative and quantitative analyses reveal that our methods outperform a broad range of baseline techniques."
- Break condition: If meteorological data becomes unavailable or if satellite imagery quality degrades significantly, the multi-modal advantage may diminish.

## Foundational Learning

- Concept: Time series forecasting with external covariates
  - Why needed here: Vegetation dynamics depend on both historical patterns and future weather conditions, requiring models that can incorporate external variables (weather) into temporal predictions.
  - Quick check question: How would you modify a basic time series model to incorporate future weather forecasts as predictors?

- Concept: Spatial attention and local context modeling
  - Why needed here: Vegetation response to weather varies based on local terrain features and spatial relationships, requiring models that can capture spatial dependencies.
  - Quick check question: What spatial features would be most important for predicting how a grassland responds to drought conditions?

- Concept: Cloud masking and data quality in satellite imagery
  - Why needed here: Accurate vegetation forecasting requires clean, cloud-free satellite observations, making cloud detection and masking critical preprocessing steps.
  - Quick check question: What are the main challenges in automatically detecting clouds and cloud shadows in Sentinel-2 imagery?

## Architecture Onboarding

- Component map: Vision backbone (for processing satellite imagery) -> Weather conditioning layer (FiLM or cross-attention) -> Spatiotemporal processor (ConvLSTM, PredRNN, SimVP, or Earthformer) -> Decoder (for generating predictions)
- Critical path: Input preprocessing (cloud masking, land cover selection) -> Feature extraction (vision backbone) -> Weather integration (conditioning layer) -> Temporal modeling (processor) -> Output generation (decoder)
- Design tradeoffs: Balance between model complexity and computational efficiency, spatial vs. temporal resolution, and weather data granularity vs. prediction horizon
- Failure signatures: High RMSE in areas with complex terrain, poor performance during extreme weather events, overfitting to specific weather patterns
- First 3 experiments:
  1. Compare model performance with and without weather conditioning to validate the importance of meteorological inputs
  2. Test different weather conditioning methods (FiLM vs. cross-attention) to identify optimal integration approach
  3. Evaluate spatial vs. temporal modeling importance by comparing models with different receptive field sizes

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What specific vegetation response patterns to extreme weather events (beyond seasonal cycles) can the model capture at continental scale?
- Basis in paper: [explicit] The paper states the model can "capture anomalies beyond the seasonal cycle" and mentions applications for predicting vegetation behavior in response to climate variability and extremes.
- Why unresolved: The paper demonstrates general skill improvements over baselines but doesn't provide detailed analysis of model performance specifically during extreme weather events like droughts, heat waves, or floods.
- What evidence would resolve it: Case studies showing model predictions vs. actual vegetation responses during documented extreme weather events, with quantitative metrics for prediction accuracy during these specific periods.

### Open Question 2
- Question: How does model performance vary across different elevation ranges and terrain complexities in Europe?
- Basis in paper: [inferred] The paper mentions using elevation data from multiple sources and evaluating performance across geomorphons, but doesn't provide detailed performance breakdowns by elevation bands.
- Why unresolved: While the paper shows some terrain-based analysis, it doesn't systematically evaluate how model skill changes across different elevation ranges or in mountainous vs. flat regions.
- What evidence would resolve it: Detailed performance metrics (R2, RMSE, NSE) broken down by elevation bands (e.g., <500m, 500-1000m, 1000-2000m, >2000m) and specific analysis of model behavior in complex terrain.

### Open Question 3
- Question: What is the optimal trade-off between model complexity and real-time applicability for continental-scale vegetation forecasting?
- Basis in paper: [inferred] The paper compares models with varying parameter counts (from 1M to 60.6M) and discusses applicability to carbon monitoring, but doesn't explicitly address real-time deployment constraints.
- Why unresolved: The paper focuses on model performance but doesn't investigate the practical constraints of deploying these models at scale for real-time forecasting, including computational requirements and latency.
- What evidence would resolve it: Benchmarking of inference speed, memory usage, and computational cost across different models, with analysis of how these trade-offs affect forecast lead time and practical deployment scenarios.

## Limitations

- Geographic constraint: GreenEarthNet dataset covers only Europe (36-72째N, 11째W-32째E), limiting generalizability to other continents
- Weather dependency: Performance degrades if weather forecast accuracy decreases or vegetation responses decouple from traditional meteorological drivers
- Temporal generalization: Training on 2017-2019 data with evaluation on 2020-2021 doesn't validate long-term climate change scenario performance

## Confidence

- High Confidence: The multi-modal learning framework's effectiveness (combining satellite imagery and meteorological data) is well-supported by quantitative results showing consistent improvement across all metrics when weather conditioning is included.
- Medium Confidence: Spatial interaction modeling importance is supported by qualitative results but could benefit from more systematic ablation studies isolating spatial vs. temporal contributions.
- Medium Confidence: The superior performance over EarthNet2021 baselines is demonstrated, but the comparison is limited to a specific challenge timeframe and evaluation criteria.

## Next Checks

1. **Cross-Continental Validation**: Test model performance on satellite and weather data from North America, Asia, and Africa to assess geographic generalization. Focus on regions with different vegetation types (tropical forests, boreal forests, deserts).

2. **Extreme Event Stress Test**: Evaluate model performance during documented extreme weather events (droughts, heatwaves, floods) not present in training data. Compare prediction accuracy during normal vs. extreme conditions.

3. **Weather Forecast Quality Sensitivity**: Systematically degrade input weather forecast quality (e.g., increase temperature prediction error by 2-5째C) and measure impact on vegetation prediction accuracy to quantify the model's dependency on weather forecast accuracy.