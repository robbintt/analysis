---
ver: rpa2
title: Optimal Transport with Cyclic Symmetry
arxiv_id: '2311.13147'
source_url: https://arxiv.org/abs/2311.13147
tags:
- algorithm
- cyclic
- symmetry
- sinkhorn
- optimal
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces the concept of symmetry into the optimal
  transport (OT) research field for the first time by utilizing cyclic symmetry of
  input data. The proposed algorithms reduce the original OT problem to a significantly
  smaller optimization problem by leveraging cyclic symmetry, enabling faster computation.
---

# Optimal Transport with Cyclic Symmetry

## Quick Facts
- arXiv ID: 2311.13147
- Source URL: https://arxiv.org/abs/2311.13147
- Reference count: 10
- This paper introduces symmetry into optimal transport research by utilizing cyclic symmetry of input data to significantly reduce computational complexity.

## Executive Summary
This paper presents a novel approach to optimal transport (OT) by incorporating cyclic symmetry into the problem formulation. The authors demonstrate that when input data exhibits cyclic symmetry, the OT problem can be dramatically reduced in size by exploiting the block-circulant structure of both the cost matrix and optimal solution. The key insight is that cyclic symmetry allows reformulating the problem as a significantly smaller optimization problem, leading to substantial computational speedups while maintaining the same optimal solution and objective value.

## Method Summary
The method reduces OT problems with cyclic symmetry to smaller optimization problems by exploiting the block-circulant structure. For linear OT (LOT), the algorithm reduces the problem from d² to m² variables by reformulating it as a small LOT problem. For strongly convex-regularized OT (SROT), including entropy-regularized OT (EROT), the approach uses Fenchel duality to reduce the dual problem from 2d to 2m variables. For EROT specifically, a cyclic Sinkhorn algorithm is developed that operates on the reduced problem structure, achieving O(m²) complexity per iteration instead of O(d²).

## Key Results
- Reduces linear OT from d² to m² variables, achieving O(m³ log m log(m∥C∥∞) + d²) time complexity
- For strongly convex-regularized OT, reduces dual problem from 2d to 2m variables
- Cyclic Sinkhorn algorithm achieves O(m²) per iteration complexity for entropy-regularized OT
- Maintains same optimal solution and objective value as original OT algorithms
- Demonstrates faster computation on both synthetic and real-world data with cyclic symmetry

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Cyclic symmetry allows reducing the OT problem from d² variables to m² variables by exploiting the block-circulant structure of both the cost matrix and optimal solution.
- Mechanism: The algorithm identifies that under cyclic symmetry, the optimal transport matrix T has the same block-circulant structure as the cost matrix C. This allows reformulating the problem as a small LOT with m² variables instead of d², where d = nm.
- Core assumption: The input data exhibits strict n-order cyclic symmetry as defined in Assumption 1 (probability vectors are concatenations of n copies of an m-dimensional vector, and the cost matrix is block-circulant).
- Evidence anchors:
  - [abstract] "Our main idea is to reduce OT to a small optimization problem that has significantly fewer variables by utilizing cyclic symmetry and various optimization techniques."
  - [section] "Our main idea is to reduce C-LOT, which has d² variables, to a small LOT, which has only m² variables, by utilizing cyclic symmetry."
  - [corpus] Weak - corpus does not mention this specific mechanism, though it contains related work on symmetry-aware OT.
- Break condition: The reduction fails if the input data does not satisfy the strict cyclic symmetry assumption, or if the cost matrix is not perfectly block-circulant.

### Mechanism 2
- Claim: For strongly convex-regularized OT (SROT), cyclic symmetry reduces the dual problem from 2d variables to 2m variables, enabling faster computation through alternating minimization.
- Mechanism: By applying Fenchel duality and exploiting cyclic symmetry, the dual problem of C-SROT has only 2m variables instead of 2d. The alternating minimization algorithm can then be applied efficiently to this smaller problem.
- Core assumption: The regularizer is strongly convex, and the input data satisfies the cyclic symmetry assumption.
- Evidence anchors:
  - [abstract] "we cannot reduce C-SROT to a small SROT due to the regularizer. To overcome this issue, we consider the Fenchel dual of C-SROT. By utilizing cyclic symmetry, we show that the Fenchel dual problem has only 2m variables..."
  - [section] "we show that the Fenchel dual problem has only 2m variables, which is significantly fewer than the 2d variables in the naive dual of C-SROT."
  - [corpus] Weak - corpus contains related work on fast OT computation but not this specific dual reduction mechanism.
- Break condition: The reduction fails if the regularizer is not strongly convex (e.g., for LOT) or if the cyclic symmetry assumption is violated.

### Mechanism 3
- Claim: For entropy-regularized OT (EROT) with cyclic symmetry, the cyclic Sinkhorn algorithm computes the solution in O(m²) time per iteration instead of O(d²), by exploiting the structure of the Gibbs kernel.
- Mechanism: The cyclic Sinkhorn algorithm updates dual variables using matrix-vector products that exploit the block-circulant structure, reducing the per-iteration complexity from O(d²) to O(m²).
- Core assumption: The input data satisfies the cyclic symmetry assumption, and the regularizer is entropy regularization.
- Evidence anchors:
  - [abstract] "This algorithm for EROT with cyclic symmetry (C-EROT)... becomes a Sinkhorn-like algorithm. We call it cyclic Sinkhorn algorithm. The interesting point is that the Gibbs kernel in the cyclic Sinkhorn algorithm differs from that in the original Sinkhorn algorithm and is designed by considering cyclic symmetry."
  - [section] "the time complexity of each iteration is O(m²); thus, our algorithm solves C-EROT significantly faster than the original Sinkhorn algorithm."
  - [corpus] Weak - corpus does not mention this specific algorithm, though it contains related work on fast OT computation.
- Break condition: The reduction fails if the input data does not satisfy the cyclic symmetry assumption, or if the regularizer is not entropy regularization.

## Foundational Learning

- Concept: Optimal Transport (OT) problem formulation and its various variants (LOT, SROT, EROT)
  - Why needed here: Understanding the base OT problem and its variants is crucial for comprehending how cyclic symmetry can be exploited to reduce computational complexity
  - Quick check question: What is the key difference between linear OT (LOT) and entropy-regularized OT (EROT) in terms of their formulations?

- Concept: Fenchel duality and its application to convex optimization problems
  - Why needed here: The reduction for SROT relies on converting the primal problem to its dual form using Fenchel duality, which is then simplified using cyclic symmetry
  - Quick check question: How does Fenchel duality help in reducing the number of variables in the SROT problem with cyclic symmetry?

- Concept: Block-circulant matrices and their properties
  - Why needed here: The cyclic symmetry assumption implies that both the cost matrix and optimal solution have block-circulant structure, which is key to the variable reduction
  - Quick check question: What property of block-circulant matrices makes them suitable for exploiting cyclic symmetry in OT problems?

## Architecture Onboarding

- Component map:
  - Input data validation -> Problem reduction -> Solver -> Solution reconstruction -> Output

- Critical path:
  1. Validate input data for cyclic symmetry
  2. Reduce problem size using symmetry properties
  3. Solve reduced problem using specialized algorithm
  4. Reconstruct solution to original problem space
  5. Return results

- Design tradeoffs:
  - Strict vs. approximate symmetry: Algorithms assume strict symmetry, but real data may only exhibit approximate symmetry
  - Computational vs. storage complexity: Reducing variables improves computation time but may require additional storage for intermediate structures
  - Algorithm choice: Different algorithms (network simplex, alternating minimization, Sinkhorn) have different performance characteristics depending on problem size and structure

- Failure signatures:
  - Input data validation failure: Data does not satisfy cyclic symmetry assumption
  - Solver divergence: Reduced problem cannot be solved or solution reconstruction fails
  - Numerical instability: Large condition numbers in reduced problem matrices
  - Performance degradation: Reduced problem is not significantly smaller than original

- First 3 experiments:
  1. Test with synthetic data of varying sizes and symmetry orders to validate variable reduction and performance improvement
  2. Test with real-world data exhibiting approximate symmetry to evaluate the two-stage algorithm's effectiveness
  3. Compare against baseline algorithms (network simplex, standard Sinkhorn) on identical problems to measure speedup

## Open Questions the Paper Calls Out
- Can the algorithms be extended to handle dihedral symmetry (combining rotation and reflection) in optimal transport?
- How can the algorithms be adapted for cases where the cyclic order n is unknown a priori?
- What is the theoretical time complexity of the two-stage Sinkhorn algorithm for C-EROT with approximate cyclic symmetry?

## Limitations
- Relies heavily on strict cyclic symmetry assumption which may not hold in practical applications
- Two-stage algorithm for approximate symmetry lacks proven performance bounds and convergence properties
- Numerical stability of the cyclic Sinkhorn algorithm with modified Gibbs kernel requires further investigation

## Confidence
- **High confidence**: Variable reduction from d² to m² for LOT (supported by clear structural arguments and block-circulant matrix properties)
- **Medium confidence**: Dual reduction for SROT from 2d to 2m variables (depends on Fenchel duality application, which is theoretically sound but requires careful implementation)
- **Medium confidence**: Cyclic Sinkhorn algorithm O(m²) complexity (relies on specific Gibbs kernel properties that need experimental validation)

## Next Checks
1. Benchmark the cyclic Sinkhorn algorithm against standard Sinkhorn on synthetic datasets with varying degrees of symmetry to quantify the actual speedup
2. Test the two-stage algorithm on real-world datasets with approximate cyclic symmetry to evaluate its practical effectiveness
3. Analyze the numerical stability of the reduced dual problem for SROT under different regularization strengths