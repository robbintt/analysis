---
ver: rpa2
title: Curriculum Learning and Imitation Learning for Model-free Control on Financial
  Time-series
arxiv_id: '2311.13326'
source_url: https://arxiv.org/abs/2311.13326
tags:
- data
- learning
- noise
- training
- control
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper explores the application of curriculum learning (CL)
  and imitation learning (IL) to improve control-task performance over complex financial
  time-series data. The authors propose using CL via data augmentation with exponential
  moving averages (EMA) and rounding, while IL is implemented via policy distillation
  from an oracle.
---

# Curriculum Learning and Imitation Learning for Model-free Control on Financial Time-series

## Quick Facts
- arXiv ID: 2311.13326
- Source URL: https://arxiv.org/abs/2311.13326
- Reference count: 40
- Primary result: EMA-based curriculum learning approaches outperform baselines with statistical significance across all six empirical environments

## Executive Summary
This paper investigates the application of curriculum learning (CL) and imitation learning (IL) to improve model-free control performance on complex financial time-series data. The authors propose using CL via data augmentation with exponential moving averages (EMA) and rounding, while IL is implemented through policy distillation from an oracle. Extensive out-of-sample empirical results demonstrate that EMA-based CL approaches significantly outperform baseline methods, while IL approaches perform poorly due to the deterministic transformation of stochastic label spaces, resulting in substantial signal loss.

## Method Summary
The authors implement three underlying RL algorithms (TRPO, PPO, A2C) and compare them against curriculum learning methods (EMA5, IS8, TIS) and imitation learning methods (DPD, DPD-LGN). The curriculum learning approaches use exponential moving average smoothing to reduce noise more than signal in financial time-series data, while imitation learning attempts to distill policies from an oracle with perfect information. The evaluation uses two datasets (Macro ETFs and Commodity Futures) with 50 random seeds per experiment, and statistical significance is assessed via one-sided T-tests. The state representation and exact oracle policy implementation are referenced but not fully specified in the main text.

## Key Results
- EMA-based CL approaches outperform baselines and achieve statistical significance in all six empirical environments
- The best-performing methods are EMA5, IS8, and TIS
- IL approaches perform poorly due to the complete removal of noise in the label space, transforming it from stochastic to deterministic and losing most of the signal

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Curriculum learning via EMA smoothing reduces noise more than signal in financial time-series data, improving generalization performance.
- Mechanism: EMA smoothing averages out short-term fluctuations while preserving longer-term trends, effectively reducing ∆noise in both input and label spaces more than ∆signal.
- Core assumption: The decomposition of financial movements into signal and noise is approximately stable during the training period.
- Evidence anchors:
  - [abstract] "Extensive out-sample empirical results show that EMA-based CL approaches outperform baselines and achieve statistical significance in all six empirical environments."
  - [section] "The intuition is visualized in Figures 1 and 2."
- Break condition: If the signal-to-noise ratio varies dramatically over time, or if the EMA window is poorly chosen, the smoothing may remove too much signal relative to noise.

### Mechanism 2
- Claim: Imitation learning via policy distillation from an oracle reduces label noise but at the cost of signal loss, leading to poor performance in high-noise environments.
- Mechanism: The oracle has access to future data, allowing it to compute theoretically optimal actions without noise. When the student learns from these deterministic labels, it loses the stochastic nature of the environment.
- Core assumption: The oracle can compute optimal actions given perfect information, and this optimal policy is meaningfully different from the stochastic environment.
- Evidence anchors:
  - [abstract] "IL approaches perform poorly, with the complete removal of noise in the label space transforming it from stochastic to deterministic, losing most of the signal."
  - [section] "The ||δ||2 too is a deterministic mapping. Concretely, it would only be possible to retrieve a reliable stochastic πϕ if we could simulate parallel worlds—which we know is intractable."
- Break condition: If the environment is deterministic or if the oracle's policy is very similar to the stochastic environment's optimal policy, this mechanism would not cause performance degradation.

### Mechanism 3
- Claim: The non-stationary nature of the signal-noise decomposition requires dynamic adaptation of smoothing hyperparameters for robust curriculum learning.
- Mechanism: As market conditions change over time, the optimal degree of smoothing may also change. Fixed smoothing hyperparameters may become suboptimal as the signal-noise ratio shifts.
- Core assumption: The financial time-series exhibits non-stationary behavior where the signal-to-noise ratio changes over time.
- Evidence anchors:
  - [abstract] "The results suggest that CL should be considered a novel direction for improving control-task performance over complex time-series."
  - [section] "We observe this empirically, as TIS does not always lead to the best performance."
- Break condition: If the financial time-series is stationary or if the signal-to-noise ratio remains relatively constant over time, dynamic adaptation would not provide additional benefits.

## Foundational Learning

- Concept: Markov Decision Process (MDP) formulation for financial control tasks
  - Why needed here: Provides the mathematical framework for modeling sequential decision-making in financial markets with states, actions, rewards, and transitions.
  - Quick check question: What are the key components of an MDP, and how do they map to the financial control problem described in the paper?

- Concept: Signal and noise decomposition in stochastic time-series
  - Why needed here: Understanding how to separate meaningful market movements from random fluctuations is crucial for both curriculum and imitation learning approaches.
  - Quick check question: How does the paper theoretically decompose market movements into signal and noise components, and why is this decomposition important for the proposed methods?

- Concept: Policy distillation and the difference between student and teacher learning
  - Why needed here: The paper uses imitation learning where a student learns from an oracle teacher, requiring understanding of how this transfer of knowledge works.
  - Quick check question: What is the key difference between what the oracle teacher learns versus what the student learner focuses on in the imitation learning approach?

## Architecture Onboarding

- Component map: Data → Preprocessing → State Representation → RL Training (with curriculum/imitation) → Evaluation → Statistical Testing
- Critical path: Data → Preprocessing → State Representation → RL Training (with curriculum/imitation) → Evaluation → Statistical Testing
- Design tradeoffs: The choice between MLP and LSTM architectures (MLP was chosen for faster training), the selection of smoothing techniques (EMA vs rounding), and the decision to use deterministic policy distillation versus stochastic approaches.
- Failure signatures: Poor performance on test data despite good training results (overfitting), dramatic performance differences between data sets (non-generalization), and statistical insignificance of improvements over baselines.
- First 3 experiments:
  1. Implement the basic MLP-based TRPO algorithm on the Macro ETFs dataset to establish a baseline performance.
  2. Add EMA5 smoothing to the training data and compare performance against the baseline.
  3. Implement the oracle policy distillation approach and compare its performance against both the baseline and EMA5 approaches.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the non-stationary nature of the signal and noise decomposition affect the long-term performance of curriculum learning approaches in financial control tasks?
- Basis in paper: [explicit] The paper discusses the non-stationary nature of the signal and noise decomposition and its implications on the effectiveness of curriculum learning approaches.
- Why unresolved: The paper mentions that the decomposition of signal and noise is likely non-stationary, which can lead to instability in the model's ability to generalize when employing tuned hyperparameters. However, the extent and impact of this non-stationarity on long-term performance are not fully explored.
- What evidence would resolve it: Empirical studies showing the performance of curriculum learning approaches over extended periods with varying levels of smoothing, and analysis of how the non-stationary nature of the signal and noise decomposition affects these results.

### Open Question 2
- Question: What are the theoretical reasons behind the effectiveness of specific smoothing techniques in reducing noise more than signal in financial time-series data?
- Basis in paper: [inferred] The paper suggests that certain smoothing techniques, like exponential moving averages, can reduce noise more than signal, but it does not provide a detailed theoretical explanation for why this is the case.
- Why unresolved: While the paper presents empirical evidence supporting the effectiveness of smoothing techniques, it lacks a comprehensive theoretical framework explaining the mechanisms behind the reduction of noise relative to signal.
- What evidence would resolve it: A theoretical analysis that explains the properties of different smoothing techniques and their impact on the signal-to-noise ratio in financial time-series data, supported by mathematical proofs or simulations.

### Open Question 3
- Question: How does the transformation of the label space from stochastic to deterministic in imitation learning affect the learning process and the ability to capture complex patterns in financial markets?
- Basis in paper: [explicit] The paper discusses how imitation learning transforms the label space from stochastic to deterministic, leading to a loss of signal and poor performance in highly stochastic environments.
- Why unresolved: The paper highlights the negative impact of this transformation but does not explore alternative methods to retain some level of stochasticity in the label space or how to better balance noise reduction and signal preservation.
- What evidence would resolve it: Comparative studies of imitation learning approaches that retain stochastic elements in the label space versus those that do not, and analysis of their performance in capturing complex patterns in financial markets.

## Limitations
- Unknown implementation details: The exact state representation fed into the neural network and the specific implementation of the oracle policy are referenced but not fully specified in the main text.
- Non-stationary decomposition: The paper doesn't fully address how the non-stationary nature of signal-noise decomposition over longer time horizons might affect the generalizability of findings.
- Statistical power considerations: While 50 random seeds provide reasonable statistical power, rare edge cases in financial markets may not be adequately captured.

## Confidence
- EMA smoothing effectiveness: High confidence based on statistically significant results across six environments
- IL signal loss explanation: Medium confidence supported by empirical results but lacking deeper theoretical analysis
- Oracle policy implementation: Low confidence due to unspecified details in the main text

## Next Checks
1. **Ablation study on smoothing window sizes**: Systematically vary EMA window sizes beyond the tested 5-period window to determine the optimal smoothing duration and verify the claimed relationship between window size and signal preservation.

2. **Oracle policy robustness analysis**: Compare the performance of the oracle policy when trained with different underlying RL algorithms (TRPO vs PPO vs A2C) to determine if the poor IL performance is due to the oracle's methodology or the imitation learning framework itself.

3. **Non-stationary stress test**: Design experiments where the signal-to-noise ratio shifts during training to validate the paper's implicit assumption about stable signal-noise decomposition and test the robustness of the EMA-based curriculum approach.