---
ver: rpa2
title: 'Provable Adversarial Robustness for Group Equivariant Tasks: Graphs, Point
  Clouds, Molecules, and More'
arxiv_id: '2312.02708'
source_url: https://arxiv.org/abs/2312.02708
tags:
- robustness
- smoothing
- distance
- graph
- group
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of defining adversarial robustness
  for group equivariant tasks, such as molecular property prediction and point cloud
  segmentation. The authors propose a novel definition of robustness that accounts
  for the task's equivariances by using action-induced distances and jointly considering
  transformations of the input and output space.
---

# Provable Adversarial Robustness for Group Equivariant Tasks: Graphs, Point Clouds, Molecules, and More

## Quick Facts
- arXiv ID: 2312.02708
- Source URL: https://arxiv.org/abs/2312.02708
- Reference count: 40
- Key outcome: This paper proposes a novel definition of adversarial robustness for group equivariant tasks, enabling provable robustness through equivariant models and equivariance-preserving randomized smoothing.

## Executive Summary
This paper addresses the challenge of defining adversarial robustness for tasks with inherent symmetries, such as molecular property prediction and point cloud segmentation. The authors introduce a new notion of robustness that accounts for these symmetries by using action-induced distances and jointly considering transformations of both input and output spaces. They demonstrate that provable robustness can be achieved by choosing models that match the task's equivariances and applying traditional adversarial robustness certification. To handle continuous equivariances, they develop the framework of equivariance-preserving randomized smoothing, which enables architecture-agnostic certification.

## Method Summary
The authors propose a sound notion of adversarial robustness that accounts for task equivariance by using action-induced distances and jointly considering transformations of input and output spaces. They show that provable robustness can be achieved by choosing a model that matches the task's equivariances and certifying traditional adversarial robustness. For models with continuous equivariances, they develop the framework of equivariance-preserving randomized smoothing, which enables architecture-agnostic certification. They also derive the first architecture-specific graph edit distance certificates for isomorphism equivariant tasks like node classification.

## Key Results
- Proposed a novel definition of adversarial robustness for group equivariant tasks
- Demonstrated that provable robustness can be achieved through equivariant models
- Developed equivariance-preserving randomized smoothing for architecture-agnostic certification
- Derived the first graph edit distance certificates for isomorphism equivariant tasks

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The proposed notion of robustness uses action-induced distances to properly account for task equivariance, avoiding the pitfall of treating isomorphic graphs as dissimilar.
- Mechanism: By defining ˆdin(x, x′) = min_g din(x, g • x′), the distance between two inputs is measured after optimal alignment via group actions. This ensures that semantically equivalent inputs (e.g., isomorphic graphs) are considered close.
- Core assumption: The group action is isometric on the input space, meaning din(g • x, g • x′) = din(x, x′).
- Evidence anchors:
  - [abstract] "we propose a sound notion of adversarial robustness that accounts for task equivariance"
  - [section 4.1] "A function ˆdin : X × X → R+ that fulfills all three desiderata for any original distance function din : X × X → R+ exists and is uniquely defined: ˆdin(x, x′) = ming∈G din(x, g • x′)"
  - [corpus] Weak - no direct match in neighbors; only general symmetry/robustness overlap.
- Break condition: If the group action is not isometric, the action-induced distance may not preserve the original distance ordering, violating Desideratum 3.

### Mechanism 2
- Claim: Using models that match the task's equivariances simplifies proving robustness, as it reduces to traditional adversarial robustness.
- Mechanism: If the model f is equivariant with respect to the same group G as the task y, then max_g dout(f(x), g⁻¹ • f(g • x′)) = dout(f(x), f(x′)), collapsing the problem to standard robustness.
- Core assumption: The model f is equivariant to the same group G as the task y.
- Evidence anchors:
  - [abstract] "We then demonstrate that provable robustness can be achieved by (1) choosing a model that matches the task's equivariances"
  - [section 5] "Proposition 2. Consider a model f : X → Y that is equivariant with respect to the action of group G. Any prediction f(x) is (G, din, dout, ϵ, δ)-equivariant-robust if and only if it is ({e}, din, dout, ϵ, δ)-equivariant-robust"
  - [corpus] Weak - no direct mention of matching model-task equivariances.
- Break condition: If the model's equivariances do not match the task's, the simplification fails and the full optimization must be considered.

### Mechanism 3
- Claim: Equivariance-preserving randomized smoothing enables architecture-agnostic certification for tasks with continuous equivariances.
- Mechanism: By ensuring the smoothing scheme ξ, the family of measures (µx), and the base model h are all equivariant, the smoothed model f(x) = ξ(µx ◦ h⁻¹) inherits the equivariance, allowing use of Proposition 2.
- Core assumption: The smoothing scheme, measures, and base model all preserve the group action.
- Evidence anchors:
  - [abstract] "We close this gap by developing the framework of equivariance-preserving randomized smoothing"
  - [section 5.1] "Proposition 3. Assume two measurable spaces (X, D), (V, F), an output space Y and a measurable base model h : X → V that is equivariant with respect to the action of group G. ... Then, the smoothed model f(x) = ξ(µx ◦ h⁻¹) is equivariant with respect to the action of group G if both"
  - [corpus] Weak - no direct match; only general smoothing/robustness overlap.
- Break condition: If any component (scheme, measures, or base model) is not equivariant, the smoothed model may lose the desired equivariance.

## Foundational Learning

- Concept: Group theory and group actions
  - Why needed here: The paper relies on group actions to formalize task symmetries (e.g., rotations, permutations) and define equivariance.
  - Quick check question: What is the difference between a left group action and a right group action?
- Concept: Action-induced distances
  - Why needed here: This distance function properly measures similarity in equivariant tasks by aligning inputs via group actions.
  - Quick check question: How does the action-induced distance differ from the original distance function din?
- Concept: Randomized smoothing
  - Why needed here: This technique is adapted to preserve equivariance, enabling certification for models with continuous symmetries.
  - Quick check question: What are the three conditions required for equivariance-preserving randomized smoothing?

## Architecture Onboarding

- Component map: The core architecture consists of a base model h, a smoothing scheme ξ, and a family of smoothing measures (µx). These components must be composed such that the overall smoothed model f(x) = ξ(µx ◦ h⁻¹) preserves the task's equivariances.
- Critical path: 1) Define the task's equivariances and appropriate input/output distances. 2) Choose or design a base model h that is equivariant to the task's group G. 3) Select or construct a smoothing scheme ξ and measures (µx) that are equivariant. 4) Prove that the composition f(x) = ξ(µx ◦ h⁻¹) is equivariant. 5) Use existing certification methods for traditional robustness on f.
- Design tradeoffs: Using an equivariant base model simplifies certification but may limit model choice. Equivariance-preserving smoothing is more general but requires careful selection of schemes and measures.
- Failure signatures: If the model is not truly equivariant, the simplification to traditional robustness fails. If the smoothing components are not equivariant, the smoothed model may not preserve the desired symmetries.
- First 3 experiments:
  1. Apply the proposed robustness definition to a simple equivariant task (e.g., rotation-invariant image classification) and verify that isomorphic inputs are considered similar.
  2. Train an equivariant model (e.g., a graph neural network) and use randomized smoothing to certify robustness to graph edit distance perturbations.
  3. Compare the provable robustness of an equivariant model versus a non-equivariant model on a task with continuous symmetries (e.g., molecular force prediction).

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the proposed notion of adversarial robustness be extended to tasks with non-compact optimization domains or non-isometric group actions?
- Basis in paper: [explicit] The paper discusses these limitations in Appendices H and I, stating that the action-induced distance needs to be redefined as the infimum over group actions for non-compact sets, and suggesting alternative definitions for non-isometric actions.
- Why unresolved: The paper only provides preliminary discussions on how to handle these cases, without providing concrete solutions or experimental evaluations.
- What evidence would resolve it: Developing and experimentally validating specific extensions of the proposed robustness notion for non-compact sets and non-isometric group actions, demonstrating their effectiveness on relevant tasks.

### Open Question 2
- Question: Can the framework of equivariance-preserving randomized smoothing be applied to tasks with continuous group actions, such as scaling or shearing, and what are the specific smoothing schemes and measures that preserve these equivariances?
- Basis in paper: [inferred] The paper mentions that existing certification procedures are unavailable for models with continuous equivariances, and proposes equivariance-preserving randomized smoothing as a general framework. However, it does not provide specific examples or experimental results for continuous group actions.
- Why unresolved: The paper focuses on discrete group actions (e.g., permutations, rotations) and does not explore the application of the proposed framework to continuous group actions.
- What evidence would resolve it: Identifying specific continuous group actions relevant to real-world tasks, developing smoothing schemes and measures that preserve these equivariances, and demonstrating their effectiveness in certifying robustness for models with continuous group actions.

### Open Question 3
- Question: How can the proposed notion of adversarial robustness be used to develop more effective adversarial attacks and defenses that explicitly account for the task's equivariances?
- Basis in paper: [explicit] The paper mentions that any traditional adversarial attack is a valid attack under the proposed notion of robustness, and suggests that knowledge about model equivariances could be used to reduce the search space for attacks or derive stronger randomized smoothing guarantees.
- Why unresolved: The paper does not provide specific examples or experimental results on how to leverage the proposed robustness notion for attack and defense strategies.
- What evidence would resolve it: Designing and evaluating adversarial attack algorithms that explicitly consider the task's equivariances, and developing defense mechanisms that are robust to such equivariance-aware attacks.

## Limitations
- The theoretical framework, while sound, may face computational challenges when applied to complex models like DimeNet++ for molecular force prediction.
- Empirical results are limited in scope and would benefit from broader experimental validation on larger, more diverse graph datasets.
- The proposed graph edit distance certificates, while promising, require further investigation to assess their practical utility beyond the limited examples provided.

## Confidence

**High confidence**: The theoretical foundations of action-induced distances and the reduction of equivariant robustness to traditional robustness for matching models are well-established and rigorously proven.

**Medium confidence**: The framework of equivariance-preserving randomized smoothing is theoretically sound, but practical implementation details and computational efficiency require further investigation.

**Low confidence**: The empirical results, particularly for molecular force prediction and generalized graph edit distance certificates, are limited in scope and would benefit from broader experimental validation.

## Next Checks

1. **Reproduce the action-induced distance implementation** for point clouds and graphs to verify the theoretical claims about measuring similarity under group actions.
2. **Implement and benchmark the equivariance-preserving randomized smoothing** on a simple equivariant task (e.g., rotation-invariant image classification) to assess computational feasibility.
3. **Validate the generalized graph edit distance certificates** on a larger, more diverse set of graph datasets to confirm their practical utility beyond the limited examples provided.