---
ver: rpa2
title: Of Spiky SVDs and Music Recommendation
arxiv_id: '2307.01212'
source_url: https://arxiv.org/abs/2307.01212
tags:
- music
- recommendation
- embeddings
- spikes
- communities
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper investigates a geometric phenomenon in SVD-based music
  embeddings: vectors naturally self-organize into spike-like formations aligned through
  the origin. A novel metric (Spk) quantifies this effect, showing that half the embeddings
  can be captured by <1% of spike peaks.'
---

# Of Spiky SVDs and Music Recommendation

## Quick Facts
- arXiv ID: 2307.01212
- Source URL: https://arxiv.org/abs/2307.01212
- Reference count: 40
- Key outcome: Proves spikes in SVD embeddings arise from degree-varying communities in DCBM, enabling degree estimation and informed similarity choice

## Executive Summary
This paper investigates a geometric phenomenon in SVD-based music embeddings where vectors self-organize into spike-like formations aligned through the origin. The authors introduce a novel metric (Spk) to quantify this effect and prove mathematically that spikes correspond to degree-varying communities in a Degree-Corrected Stochastic Block Model. This insight enables practical applications including degree estimation without explicit graph construction, informed choice between cosine similarity and dot product, and SVD truncation selection. Applied to 12 months of industrial embeddings, the analysis reveals that high-norm vectors maintain >80% stability over time, while low-norm ones degrade rapidly.

## Method Summary
The method computes truncated SVD (f=128) on symmetrized and PPMI-normalized matrices after filtering top-k highest interactions per item. Spike detection identifies high-norm vectors as peaks and measures collinearity of other points to these peaks using cosine similarity threshold. The Spk metric quantifies the ratio of peak points needed to capture 50% of the distribution. Stability analysis tracks embedding changes over time using Jaccard index.

## Key Results
- Half the embeddings can be captured by <1% of spike peaks (cos(θ)=0.9)
- High-norm vectors maintain >80% stability over time; low-norm vectors degrade rapidly
- Spk values grow linearly with noise, suggesting f=64 for Spotify and f=128 for Deezer
- Mathematical proof linking spikes to degree-varying communities in DCBM

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Spiky SVD embeddings arise from rank-1 approximation of degree-varying communities in a DCBM
- Mechanism: SVD prioritizes rank-1 approximations of communities, creating spike formations where high-norm vectors act as "peaks" with many collinear lower-norm vectors
- Core assumption: Underlying data contains assortative communities with varying internal popularity
- Evidence anchors:
  - [abstract] "mathematically prove its origin tied to underlying communities of items of varying internal popularity"
  - [section] "Theorem 3.4... embedding vectors belong to a spike... the submatrix follows a structure in communities given by a DCBM"
- Break condition: If communities lack internal popularity variation or are not assortative, spikes won't form

### Mechanism 2
- Claim: Spikiness metric Spk effectively estimates community structure without explicit graph construction
- Mechanism: Identifies high-norm vectors as spike peaks and counts how many lower-norm vectors align with them
- Core assumption: Noise dominates in lower-norm vectors, making them align with high-norm community representatives
- Evidence anchors:
  - [abstract] "A novel metric (Spk) quantifies this effect, showing that half the embeddings can be captured by <1% of spike peaks"
  - [section] "The obtained number of spikes is divided by n... We have 0 < Spk ≤ ρ"
- Break condition: If noise isn't correlated with norm, the heuristic fails

### Mechanism 3
- Claim: Embedding norm stability correlates with degree centrality in the underlying graph
- Mechanism: High-norm vectors represent high-degree nodes, which are more robust to graph changes
- Core assumption: Degree centrality predicts node robustness in dynamic graphs
- Evidence anchors:
  - [abstract] "high-norm vectors maintain >80% stability over time, while low-norm ones degrade rapidly"
  - [section] "estimated degree is considered a good predictor of the robustness of a node"
- Break condition: If graph evolution doesn't follow degree-based robustness patterns

## Foundational Learning

- Concept: Stochastic Block Model (SBM)
  - Why needed here: Forms theoretical foundation for understanding community structure in sparse matrices
  - Quick check question: What distinguishes SBM from random graph models in terms of edge probabilities between communities?

- Concept: Degree-Corrected Stochastic Block Model (DCBM)
  - Why needed here: Extends SBM to account for varying node degrees within communities
  - Quick check question: How does DCBM modify the edge probability compared to SBM to allow degree heterogeneity?

- Concept: Truncated Singular Value Decomposition (SVD)
  - Why needed here: Primary matrix factorization technique being analyzed for geometric properties
  - Quick check question: What is the optimal low-rank approximation property guaranteed by Eckart-Young-Mirsky theorem?

## Architecture Onboarding

- Component map: Data preprocessing → SVD computation → Spike detection → Community interpretation → Application insights
- Critical path: Matrix construction → SVD → Spike quantification → Community interpretation → Application insights
- Design tradeoffs:
  - Top-k filtering vs. complete matrix: Filtering reduces noise but may lose rare interactions
  - PMI normalization vs. raw counts: PMI handles popularity bias but adds preprocessing complexity
  - Cosine vs. dot product: Cosine removes popularity effects, dot product preserves them
- Failure signatures:
  - Uniform Spk values across all dimensions suggest no community structure
  - Rapidly increasing Spk at higher dimensions indicates noise dominance
  - Low temporal stability across all norm ranges suggests fundamental embedding issues
- First 3 experiments:
  1. Compute Spk on synthetic DCBM matrix to verify theoretical predictions
  2. Compare Spk values for cosine-normalized vs. unnormalized embeddings
  3. Track embedding stability over time for different norm ranges on industrial data

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does Spk metric behave when truncation parameter f exceeds true number of communities K?
- Basis in paper: [explicit] Discusses Spk grows linearly with noise, suggesting specific f values for datasets
- Why unresolved: Only provides empirical observations without general theoretical relationship
- What evidence would resolve it: Systematic experiments varying f across datasets with known community structures

### Open Question 2
- Question: How does presence of negative values in SVD approximation affect DCBM equivalence and practical applications?
- Basis in paper: [explicit] Notes negative values may arise from approximation artifacts, suggests dropping absolute values
- Why unresolved: Paper assumes non-negativity for simplicity but acknowledges this may not always hold
- What evidence would resolve it: Analysis of SVDs with significant negative values showing impact on DCBM equivalence

### Open Question 3
- Question: Can spike detection framework be extended to handle rank-1 approximations beyond current community-based interpretation?
- Basis in paper: [explicit] Mentions future work includes analyzing rank > 1 approximation effects
- Why unresolved: Focuses on rank-1 approximations without exploring more complex structures
- What evidence would resolve it: Experiments showing how spikes behave under rank-2 or higher approximations

## Limitations
- Theoretical proof relies on specific assumptions about community structure that may not generalize
- Reliance on top-k filtering and PMI normalization may limit applicability to other domains
- Geometric phenomenon observed primarily in music recommendation may not persist in other recommendation domains

## Confidence

High confidence in geometric phenomenon itself (directly observable)
Medium confidence in theoretical connection between spikes and DCBM communities (proof relies on specific assumptions)
Medium confidence in practical implications for recommender systems (depends on impact beyond existing metrics)

## Next Checks

1. Test Spk metric sensitivity by varying cos(θ) threshold and peak identification criteria across multiple datasets to establish robustness bounds

2. Compare spike formations and stability patterns between SVD and alternative factorization methods (e.g., NMF, autoencoders) on identical datasets

3. Conduct A/B testing to measure whether incorporating spike-aware ranking improves recommendation relevance metrics compared to standard cosine/dot product approaches