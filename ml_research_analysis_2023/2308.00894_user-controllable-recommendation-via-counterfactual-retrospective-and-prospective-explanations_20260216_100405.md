---
ver: rpa2
title: User-Controllable Recommendation via Counterfactual Retrospective and Prospective
  Explanations
arxiv_id: '2308.00894'
source_url: https://arxiv.org/abs/2308.00894
tags:
- recommendation
- users
- user
- controllability
- item
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper introduces a user-controllable recommendation framework
  that integrates explainability and controllability through counterfactual reasoning.
  The authors propose two types of counterfactual explanations: retrospective (explaining
  past behavior influence) and prospective (predicting future recommendation changes).'
---

# User-Controllable Recommendation via Counterfactual Retrospective and Prospective Explanations

## Quick Facts
- arXiv ID: 2308.00894
- Source URL: https://arxiv.org/abs/2308.00894
- Reference count: 38
- Key outcome: This paper introduces a user-controllable recommendation framework that integrates explainability and controllability through counterfactual reasoning. The authors propose two types of counterfactual explanations: retrospective (explaining past behavior influence) and prospective (predicting future recommendation changes). They formulate controllability using two metrics: complexity (proportion of behaviors to change) and accuracy (Jaccard similarity between desired and actual changes). Experiments on MovieLens and Yelp datasets show their method outperforms baselines in controllability, achieving up to 76.79% accuracy with 4.58% complexity on MovieLens using greedy search. They also demonstrate that prospective controllability can improve recommendation accuracy by selectively removing "harmful" interactions, increasing NDCG@10 from 0.1078 to 0.1118 on MovieLens. The framework is model-agnostic and addresses the opacity problem in recommendation systems.

## Executive Summary
This paper presents a user-controllable recommendation framework that addresses the opacity problem in recommendation systems by integrating explainability and controllability through counterfactual reasoning. The framework generates two types of counterfactual explanations—retrospective and prospective—that enable users to understand how their past behaviors influence current recommendations and how future recommendations will change based on current interactions. By formulating controllability through complexity (proportion of behaviors to change) and accuracy (Jaccard similarity between desired and actual changes) metrics, the authors demonstrate that their method outperforms baselines on MovieLens and Yelp datasets, with prospective controllability showing potential to improve recommendation accuracy by selectively removing harmful interactions.

## Method Summary
The framework builds on sequential recommendation models (SASRec and GRU4Rec) and introduces counterfactual retrospective explanations to identify which past interactions influence current recommendations, and prospective explanations to predict future recommendation changes. For retrospective explanations, the authors implement two approaches: greedy search with a heuristic function and continuous relaxation. The framework formulates controllability as an optimization problem that balances the trade-off between complexity (cost of control) and accuracy (effectiveness of control). The model-agnostic approach allows application to any recommendation model that relies on user behaviors, and experiments validate the framework's effectiveness on MovieLens-1M and Yelp datasets using standard recommendation metrics alongside the proposed controllability metrics.

## Key Results
- Achieved 76.79% accuracy with 4.58% complexity on MovieLens using greedy search approach
- Improved NDCG@10 from 0.1078 to 0.1118 by selectively removing harmful interactions through prospective controllability
- Greedy search approach is 5-8 times faster than continuous relaxation while maintaining comparable accuracy
- Framework demonstrates model-agnostic capability by outperforming baselines on both GRU4Rec and SASRec models

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Counterfactual reasoning enables user control by simulating the effects of removing past behaviors.
- Mechanism: The framework uses counterfactual retrospective explanations to identify which past interactions influence current recommendations. By removing these interactions, users can see how recommendations change, enabling informed control decisions.
- Core assumption: Removing past behaviors and observing recommendation changes accurately reveals causal relationships between user actions and recommendations.
- Evidence anchors:
  - [abstract]: "Providing counterfactual retrospective and prospective explanations empowers users with a comprehensive understanding of the consequences of their past and current behaviors, allowing them to selectively exclude such behaviors when necessary."
  - [section 4.1]: "The objective of the algorithm is to generate effective counterfactual retrospective explanations, ensuring that by revoking the past behaviors, the undesired items are removed from the recommendation list."
  - [corpus]: Weak evidence - related papers discuss counterfactual exploration but don't provide direct experimental validation of this mechanism.
- Break condition: If the recommendation model doesn't accurately reflect user preferences in the first place, removing behaviors won't lead to better recommendations.

### Mechanism 2
- Claim: Prospective controllability improves recommendation accuracy by eliminating harmful interactions.
- Mechanism: The framework predicts how future recommendations will change if users interact with current items, allowing users to revoke interactions that would negatively impact future recommendations.
- Core assumption: Users can accurately identify harmful future interactions through prospective explanations, and removing these interactions improves recommendation quality.
- Evidence anchors:
  - [abstract]: "Experiments demonstrate that offering users control options can potentially enhance recommendation accuracy in the future."
  - [section 5.5]: "We observe that removing the next interacted items for the users selected by the simulation process actually improves the overall ranking accuracy."
  - [corpus]: Moderate evidence - related papers discuss counterfactual exploration but lack experimental validation of prospective controllability's impact on accuracy.
- Break condition: If users cannot accurately identify harmful interactions, or if the model's predictions are unreliable, prospective control may degrade recommendation quality.

### Mechanism 3
- Claim: The two controllability metrics (complexity and accuracy) provide effective evaluation of user control quality.
- Mechanism: Complexity measures the proportion of behaviors that need to be changed, while accuracy measures how well control options remove only undesired items without affecting desired ones.
- Core assumption: These metrics accurately capture the trade-off between control effort and effectiveness.
- Evidence anchors:
  - [section 3.4]: "The first property is the complexity of controllability, which measures the cost for the user to control the recommendation results."
  - [section 3.4]: "The second property is the accuracy of controllability. The control options offered by the system should accurately eliminate the undesired items from the recommendation list without inadvertently removing other relevant items."
  - [corpus]: Weak evidence - related papers discuss explainable recommendation but don't provide evaluation metrics for controllability.
- Break condition: If the metrics don't align with actual user satisfaction or if they're computationally expensive to calculate.

## Foundational Learning

- Concept: Counterfactual reasoning
  - Why needed here: Enables the framework to simulate "what-if" scenarios by removing past behaviors or predicting future changes, which is essential for both retrospective and prospective explanations.
  - Quick check question: How does counterfactual reasoning differ from traditional explanation methods in recommendation systems?

- Concept: Sequential recommendation models
  - Why needed here: The framework is built on sequential recommendation models (SASRec, GRU4Rec) that use user interaction history to make predictions, making it compatible with the controllability approach.
  - Quick check question: What are the key differences between SASRec and GRU4Rec in terms of how they model user sequences?

- Concept: Optimization with constraints
  - Why needed here: The framework uses constrained optimization to generate explanations that both remove target items and maintain recommendation quality for other items.
  - Quick check question: How does the constrained optimization problem in section 4.1 balance the trade-off between complexity and accuracy?

## Architecture Onboarding

- Component map:
  - Base recommendation model (SASRec/GRU4Rec)
  - Counterfactual explanation generator (retrospective and prospective)
  - Optimization engine (greedy search and continuous relaxation)
  - Evaluation metrics (complexity and accuracy)
  - User interface (for presenting explanations and control options)

- Critical path: User interaction → Base model prediction → Explanation generation → User control decision → Updated recommendations

- Design tradeoffs:
  - Greedy search vs. continuous relaxation: Greedy search is faster and more scalable but may miss optimal solutions; continuous relaxation is more thorough but computationally expensive.
  - Complexity vs. accuracy: Higher accuracy often requires more complex explanations, which may reduce user comprehension.

- Failure signatures:
  - Low fidelity in explanation generation (continuous relaxation method)
  - High complexity leading to user confusion
  - Poor accuracy resulting in unwanted items remaining in recommendations

- First 3 experiments:
  1. Compare greedy search vs. continuous relaxation on a small dataset to measure trade-offs in quality vs. computation time
  2. Test the impact of different γ1, λ, and γ2 parameters on explanation quality and user comprehension
  3. Validate the prospective controllability hypothesis by simulating user interactions and measuring recommendation accuracy improvements

## Open Questions the Paper Calls Out
The paper does not explicitly call out specific open questions, but it identifies several areas requiring further investigation. The authors acknowledge that their experiments focus on sequential recommendation models and that the framework's applicability to other recommendation architectures remains to be explored. They also note that while prospective controllability shows promise in simulations, real-world user studies are needed to validate its effectiveness in improving user satisfaction and trust beyond recommendation accuracy improvements.

## Limitations
- Claims about improved recommendation accuracy through prospective controllability are based on simulations rather than actual user studies
- Greedy search approach may get stuck in local optima, potentially limiting explanation quality
- Continuous relaxation method shows fidelity issues where it fails to generate explanations for all items
- The framework's effectiveness beyond sequential recommendation models remains untested

## Confidence
- High confidence: The framework's ability to generate counterfactual retrospective explanations and calculate controllability metrics (complexity and accuracy)
- Medium confidence: The prospective controllability mechanism's impact on recommendation accuracy improvements
- Medium confidence: The greedy search approach's scalability and effectiveness compared to continuous relaxation

## Next Checks
1. Conduct A/B testing with real users to validate whether prospective controllability actually improves recommendation satisfaction beyond simulated improvements
2. Test the greedy search algorithm on larger datasets to verify its scalability claims and measure performance degradation compared to continuous relaxation
3. Implement cross-validation across different recommendation domains (e.g., news, music) to assess the framework's generalizability beyond MovieLens and Yelp