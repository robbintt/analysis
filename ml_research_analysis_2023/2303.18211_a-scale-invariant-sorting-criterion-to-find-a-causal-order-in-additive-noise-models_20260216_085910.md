---
ver: rpa2
title: A Scale-Invariant Sorting Criterion to Find a Causal Order in Additive Noise
  Models
arxiv_id: '2303.18211'
source_url: https://arxiv.org/abs/2303.18211
tags:
- causal
- var-sortability
- sortability
- data
- algorithms
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a scale-invariant sorting criterion called
  R2-sortability for causal discovery in additive noise models (ANMs). The key insight
  is that the fraction of variance explained by other variables (captured by R2) tends
  to increase along the causal order in common ANM simulations.
---

# A Scale-Invariant Sorting Criterion to Find a Causal Order in Additive Noise Models

## Quick Facts
- arXiv ID: 2303.18211
- Source URL: https://arxiv.org/abs/2303.18211
- Authors: 
- Reference count: 40
- Key outcome: Introduces R2-sortability, a scale-invariant sorting criterion for causal discovery in ANMs that exploits the pattern of increasing R2 along causal chains

## Executive Summary
This paper introduces R2-sortability, a scale-invariant sorting criterion for causal discovery in additive noise models (ANMs). The key insight is that the fraction of variance explained by parent variables (captured by R2) tends to increase along the causal order in common ANM simulations. The authors propose two algorithms - R2-SortnRegress and R2-GDS - that exploit this pattern to match or exceed the performance of established causal discovery methods. They show analytically that sufficiently high edge weights lead to decreasing noise contributions along causal chains, resulting in high R2-sortability.

## Method Summary
The authors propose a scale-invariant sorting criterion called R2-sortability that exploits the pattern of increasing coefficient of determination (R2) along causal chains in ANMs. They develop two algorithms: R2-SortnRegress, which orders variables by increasing R2 and performs sparse regressions on predecessors, and R2-GDS, which uses greedy DAG search with R2-sortability. The approach is validated through extensive synthetic data experiments showing that R2-sortability values are high in common ANM settings and that the algorithms achieve state-of-the-art performance while being invariant to data rescaling.

## Key Results
- R2-sortability is high in common ANM simulation settings with sufficiently large edge weights relative to noise levels
- R2-SortnRegress achieves state-of-the-art performance matching established methods like PC and FGES
- The R2-sortability criterion remains unchanged under data rescaling, unlike variance-based approaches
- R2-sortability values correlate positively with causal discovery performance across different simulation parameters

## Why This Works (Mechanism)

### Mechanism 1
- Claim: R2-sortability works because additive noise contributions accumulate along causal chains, causing the fraction of variance explained by parent variables to increase monotonically in the causal order.
- Mechanism: In linear ANMs, each variable is a linear function of its parents plus additive noise. When edge weights are sufficiently large, the variance contributed by noise becomes progressively smaller relative to the variance explained by parent variables as you move downstream in the causal chain. This creates a pattern where R2 increases along the causal order.
- Core assumption: Edge weights are sufficiently large relative to noise levels such that the noise contribution becomes relatively negligible for downstream variables.
- Evidence anchors:
  - [abstract] "We show analytically that sufficiently high edge weights lead to a relative decrease of the noise contributions along causal chains, resulting in increasingly deterministic relationships and high R2."
  - [section] "If the marginal variances of variables...increase along the causal order and the noise standard deviations are sampled iid, then Var[Wi:tPa(Xt)] and in turn the cause-explained variance fractions...are likely to also increase along the causal order."
  - [corpus] Found 25 related papers with average neighbor FMR=0.394, suggesting this is an active research area but specific empirical validation of this mechanism in real-world data is limited.

### Mechanism 2
- Claim: R2-sortability is scale-invariant, making it more robust than variance-based approaches for causal discovery.
- Mechanism: The coefficient of determination R2 is defined as the ratio of explained variance to total variance. When all variables are multiplied by a constant factor (data rescaling), both the numerator and denominator scale equally, leaving R2 unchanged. This property allows algorithms exploiting R2-sortability to work equally well on raw, standardized, or otherwise rescaled data.
- Core assumption: The underlying causal relationships remain unchanged under linear rescaling of the data.
- Evidence anchors:
  - [abstract] "In contrast to var-sortability, ð‘…2-sortability is invariant under data rescaling, so the presented algorithms recover the causal structure equally well from raw, rescaled, and standardized data."
  - [section] "ð‘…2-sortability, the ð‘…2-SortnRegress algorithm, and ANM simulation procedures in our library CausalDisco."
  - [corpus] The corpus contains papers on causal discovery with score matching and heteroscedastic noise, suggesting alternative approaches exist but the scale-invariance property is unique to R2-based methods.

### Mechanism 3
- Claim: R2-sortability provides a computationally efficient baseline for causal discovery that can match or exceed established methods.
- Mechanism: By ordering variables by increasing R2 and then performing sparse regression of each variable on its predecessors, the algorithm exploits the natural accumulation of explained variance along causal chains. This approach is computationally simpler than many established methods while achieving comparable performance.
- Core assumption: The causal graph has a relatively clear ordering structure where R2 increases monotonically along causal paths.
- Evidence anchors:
  - [abstract] "We propose an efficient baseline algorithm termed R2-SortnRegress that exploits high R2-sortability and that can match and exceed the performance of established causal discovery algorithms."
  - [section] "SortnRegress is a simple algorithm that obtains state-of-the-art performance in common causal discovery benchmarks, typically ANMs with high var-sortability."
  - [corpus] The corpus includes papers on hybrid top-down causal discovery and generalized criteria for identifiability, suggesting this is a competitive approach within a broader landscape of causal discovery methods.

## Foundational Learning

- Concept: Linear additive noise models (ANMs)
  - Why needed here: The entire approach relies on the assumption that each variable is a linear function of its parents plus additive noise, which creates the variance accumulation pattern exploited by R2-sortability.
  - Quick check question: In an ANM, if X1 â†’ X2 â†’ X3 with weights 2 and 3 respectively, and noise variances 1 for each variable, what is the R2 of X3 when regressed on X1 and X2?

- Concept: Coefficient of determination (R2)
  - Why needed here: R2 is the core metric used to quantify the fraction of variance explained by other variables, which forms the basis of the sorting criterion.
  - Quick check question: If variable X has variance 10 and can be perfectly predicted by other variables, what is its R2 value?

- Concept: Structural causal models and DAGs
  - Why needed here: The causal discovery task requires understanding how variables are related through a directed acyclic graph structure, which determines the parent-child relationships used in regression.
  - Quick check question: In a DAG with variables X1, X2, X3 where X1 â†’ X2 and X2 â†’ X3, what are the parents of X3?

## Architecture Onboarding

- Component map: Data generation (ANM simulation) -> R2 computation (regression-based) -> Sorting (by increasing R2) -> Structure recovery (sparse regression on sorted variables)
- Critical path: Generate ANM data â†’ Compute R2 values for each variable â†’ Sort variables by increasing R2 â†’ For each variable in order, regress on predecessors to determine parents â†’ Output estimated causal graph
- Design tradeoffs: The approach trades off computational efficiency for potential sensitivity to specific parameter choices in ANM simulations. It's simpler than many established methods but may not work as well on data that doesn't exhibit the R2 pattern.
- Failure signatures: Poor performance when R2-sortability is low (close to 0.5), when edge weights are small relative to noise, when the graph has many short paths with low cumulative weights, or when non-linear relationships dominate.
- First 3 experiments:
  1. Generate synthetic ANM data with high edge weights and known causal structure, compute R2-sortability, and verify that R2 increases along the causal order.
  2. Run R2-SortnRegress on standardized and raw versions of the same data to confirm scale-invariance of the results.
  3. Compare R2-SortnRegress performance against PC and FGES algorithms on data with varying levels of R2-sortability to characterize when the approach succeeds or fails.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do R2-sortability and var-sortability behave in real-world data compared to synthetic ANM data?
- Basis in paper: [explicit] The paper states "An open and challenging problem is to determine what R2-sortabilities can be expected in real-world data" and notes that "The prevalence of R2-sortability in real-world data is unknown"
- Why unresolved: The paper focuses entirely on synthetic data generation and analysis, acknowledging that real-world data with known underlying ANMs is scarce
- What evidence would resolve it: Empirical studies applying R2-sortability to real-world datasets with known causal structures, or at least datasets where causal relationships can be reasonably inferred from domain knowledge

### Open Question 2
- Question: Can the weight distribution P_W be intentionally designed to achieve specific target R2-sortability values in causal discovery?
- Basis in paper: [explicit] The paper shows that "All ANM simulation parameters need to be chosen deliberately" and demonstrates that "Low edge weights, low graph density, and an unbounded noise standard deviation distribution can lead to lower R2-sortability"
- Why unresolved: While the paper characterizes how P_W affects R2-sortability, it doesn't provide a methodology for inversely designing P_W to achieve specific R2-sortability targets
- What evidence would resolve it: A mathematical framework or algorithm that takes a desired R2-sortability value as input and outputs the corresponding weight distribution P_W

### Open Question 3
- Question: How well do R2-sortability-based algorithms perform on nonlinear ANMs compared to linear ANMs?
- Basis in paper: [explicit] The paper states "Since var-sortability is high in many nonlinear ANMs, R2-sortability may also be high and thus useful for finding the causal structure in nonlinear ANMs"
- Why unresolved: The paper only evaluates algorithms on linear ANMs, and the hypothesis about nonlinear ANMs remains untested
- What evidence would resolve it: Empirical comparison of R2-sortability-based algorithms on both linear and nonlinear ANM datasets, measuring performance differences across the two model classes

## Limitations
- Performance depends heavily on edge weights being sufficiently large relative to noise levels, which may not hold in many real-world datasets
- The approach may not generalize well to non-linear causal relationships or data with strong multiplicative interactions
- Assumes relatively clear causal ordering structures, potentially limiting effectiveness on complex graphs with many short paths or bidirectional dependencies

## Confidence
- Core mechanism (R2 accumulation along causal chains): High
- Scale-invariance property: High
- Practical performance across diverse datasets: Medium

## Next Checks
1. Test R2-SortnRegress on real-world datasets from benchmark repositories (e.g., TÃ¼bingen cause-effect pairs) to assess generalization beyond synthetic ANMs
2. Systematically vary edge weight distributions in ANM simulations to identify the threshold below which R2-sortability degrades and recovery performance drops
3. Compare R2-sortability values and causal recovery performance on linear vs. non-linear ANMs to quantify the method's limitations with non-linear relationships