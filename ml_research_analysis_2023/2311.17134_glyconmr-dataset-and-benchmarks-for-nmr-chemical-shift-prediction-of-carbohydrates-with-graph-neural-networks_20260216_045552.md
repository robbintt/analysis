---
ver: rpa2
title: 'GlycoNMR: Dataset and benchmarks for NMR chemical shift prediction of carbohydrates
  with graph neural networks'
arxiv_id: '2311.17134'
source_url: https://arxiv.org/abs/2311.17134
tags:
- data
- glyconmr
- carbohydrate
- chemical
- atom
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: GlycoNMR introduces the first large-scale, machine learning-ready
  dataset for carbohydrate NMR chemical shift prediction, addressing a critical gap
  in glycoscience data resources. The dataset comprises 2,609 carbohydrate structures
  with 211,543 curated atomic NMR chemical shifts from both experimental (GlycoNMR.Exp)
  and simulated (GlycoNMR.Sim) sources.
---

# GlycoNMR: Dataset and benchmarks for NMR chemical shift prediction of carbohydrates with graph neural networks

## Quick Facts
- **arXiv ID**: 2311.17134
- **Source URL**: https://arxiv.org/abs/2311.17134
- **Reference count**: 29
- **Primary result**: Introduced first large-scale ML-ready dataset for carbohydrate NMR chemical shift prediction

## Executive Summary
GlycoNMR introduces the first large-scale, machine learning-ready dataset for carbohydrate NMR chemical shift prediction, addressing a critical gap in glycoscience data resources. The dataset comprises 2,609 carbohydrate structures with 211,543 curated atomic NMR chemical shifts from both experimental (GlycoNMR.Exp) and simulated (GlycoNMR.Sim) sources. To tackle the unique structural complexity of carbohydrates, the authors developed carbohydrate-specific features and adapted multiple 3D graph neural network models for atomic-level chemical shift prediction. The SphereNet model achieved the lowest prediction error on the simulated dataset (RMSE: 1.353 ppm for 13C, 0.110 ppm for 1H), while SchNet performed best on experimental data (RMSE: 2.492 ppm for 13C, 0.140 ppm for 1H). These results demonstrate the feasibility of applying graph neural networks to carbohydrate NMR analysis and establish a foundation for advancing glycoscience and glycomaterials research through machine learning.

## Method Summary
The authors formulated NMR chemical shift prediction as a node regression task in graph neural networks, training models to predict atomic chemical shifts from carbohydrate molecular graphs. They created the GlycoNMR dataset by curating 2,609 carbohydrate structures from the PDB, annotating 211,543 atomic NMR chemical shifts from BMRB and simulated data. The method involved parsing PDB files to extract 2D and 3D molecular representations, engineering carbohydrate-specific features (monosaccharide type, configuration, ring size, position, anomeric configuration, and modification groups), and training adapted GNN models (SchNet, SphereNet, ComENet, DimeNet++) on these graph representations to predict 13C and 1H NMR chemical shifts.

## Key Results
- SphereNet achieved lowest RMSE on simulated dataset: 1.353 ppm (13C) and 0.110 ppm (1H)
- SchNet performed best on experimental dataset: 2.492 ppm (13C) and 0.140 ppm (1H)
- 3D-based MRL models consistently outperformed 2D models across both datasets
- Performance gap between simulated (RMSE ~1.4 ppm for 13C) and experimental data (RMSE ~2.5 ppm for 13C) suggests domain adaptation challenges

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Graph neural networks can accurately predict carbohydrate NMR chemical shifts by learning atomic-level structural features.
- **Mechanism**: GNNs encode molecular graphs with atoms as nodes and bonds as edges, allowing message passing to aggregate local chemical environment information into node embeddings, which are then mapped to chemical shift values.
- **Core assumption**: The local chemical environment of an atom, including its connectivity and neighboring atoms, is the primary determinant of its NMR chemical shift.
- **Evidence anchors**:
  - [abstract] "SphereNet model achieved the lowest prediction error on the simulated dataset (RMSE: 1.353 ppm for 13C, 0.110 ppm for 1H)"
  - [section] "We formulated the structure-related chemical shift prediction problem as a node regression task, and trained GNNs to predict the chemical shifts of primary monosaccharide ring carbons and hydrogen atoms."
  - [corpus] Found 25 related papers (using 8). Average neighbor FMR=0.368, average citations=0.0.
- **Break condition**: If NMR shifts are significantly influenced by long-range electronic effects not captured by local graph neighborhoods, or if the dataset lacks sufficient diversity in chemical environments.

### Mechanism 2
- **Claim**: Incorporating carbohydrate-specific features (monosaccharide type, configuration, ring size, etc.) improves NMR shift prediction accuracy.
- **Mechanism**: These features encode stereochemical properties and structural dynamics that are critical for carbohydrates but not captured by standard molecular graphs, providing additional chemical context to the model.
- **Core assumption**: The stereochemistry and structural context of monosaccharides are significant determinants of NMR chemical shifts in carbohydrates.
- **Evidence anchors**:
  - [abstract] "We tailored carbohydrate-specific features and adapted existing MRL models to tackle this problem effectively."
  - [section] "We designed a set of chemically informed features tailored specifically for carbohydrates... We observed that the model performance dropped drastically after removing the ring position feature."
  - [corpus] Weak evidence - no direct citation to feature engineering studies in related papers.
- **Break condition**: If the carbohydrate-specific features are not well-correlated with chemical shifts, or if the feature engineering process introduces noise or inconsistencies.

### Mechanism 3
- **Claim**: Using both 2D and 3D graph representations captures complementary information for NMR shift prediction.
- **Mechanism**: 2D graphs encode bond connectivity, while 3D graphs incorporate atomic distances and spatial arrangements, together providing a more complete representation of molecular structure relevant to NMR.
- **Core assumption**: Both connectivity patterns and 3D spatial arrangements contribute to NMR chemical shifts, and neither alone is sufficient.
- **Evidence anchors**:
  - [abstract] "We tailored carbohydrate-specific features and adapted existing MRL models to tackle this problem effectively. For illustration, we benchmark four modified MRL models on our new datasets."
  - [section] "We chose GNN-based MRL models as the baseline due to their strong expressive power... We formulated the structure-related chemical shift prediction problem as a node regression task, and trained GNNs to predict the chemical shifts of primary monosaccharide ring carbons and hydrogen atoms."
  - [corpus] Weak evidence - limited discussion of 2D vs 3D representations in related NMR prediction papers.
- **Break condition**: If 3D information adds minimal value beyond 2D connectivity, or if computational complexity of 3D models outweighs their benefits.

## Foundational Learning

- **Graph Neural Networks**: Neural networks designed to operate on graph-structured data, using message passing to aggregate information from neighboring nodes.
  - Why needed here: Carbohydrates have complex structural relationships that are naturally represented as graphs, making GNNs well-suited for learning their properties.
  - Quick check question: How does a GNN aggregate information from neighboring nodes during message passing?

- **Molecular Representation Learning**: Converting molecules into numerical representations that preserve their chemical features for downstream tasks.
  - Why needed here: To bridge the gap between raw carbohydrate structures and NMR chemical shift predictions, enabling ML methods to analyze carbohydrate data.
  - Quick check question: What are the key differences between 2D and 3D molecular representations in MRL?

- **NMR Chemical Shifts**: The resonance frequency of a nucleus relative to a standard, providing information about the electronic environment around that nucleus.
  - Why needed here: The target variable for prediction - understanding what NMR shifts represent is crucial for interpreting model outputs and feature engineering.
  - Quick check question: Why are 1D 13C and 1H NMR chemical shifts particularly useful for carbohydrate structure determination?

## Architecture Onboarding

- **Component map**: Data preprocessing pipeline -> Graph construction -> GNN layers -> Output layer -> Evaluation
- **Critical path**: Data → Feature Engineering → Graph Construction → GNN Training → Chemical Shift Prediction → RMSE Evaluation
- **Design tradeoffs**: 2D vs 3D representations (computational cost vs. accuracy), feature complexity (rich information vs. overfitting), model architecture (expressiveness vs. interpretability)
- **Failure signatures**: High RMSE indicating poor prediction, feature mismatch errors during data annotation, overfitting on small datasets, computational bottlenecks with large molecules
- **First 3 experiments**:
  1. Train baseline 2D GNN on GlycoNMR.Sim with only atom-level features, evaluate RMSE
  2. Add carbohydrate-specific features (monosaccharide type, configuration) to 2D model, compare performance
  3. Switch to 3D GNN (SchNet) with distance-based edges, evaluate if 3D information improves accuracy

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the inclusion of modification groups impact NMR chemical shift prediction accuracy for carbohydrates, and what are the optimal methods for encoding modification information in graph neural networks?
- Basis in paper: [explicit] The authors note that modification group features were included in GlycoNMR.Sim but omitted from GlycoNMR.Exp due to annotation challenges, suggesting this is a key unresolved issue.
- Why unresolved: The paper acknowledges that modification group annotation in experimental data is challenging due to inconsistent PDB file formatting, but does not provide solutions or quantify the impact of this omission on model performance.
- What evidence would resolve it: A systematic comparison of model performance with and without modification features on a consistently annotated dataset, along with evaluation of different encoding strategies for modification information.

### Open Question 2
- Question: What is the optimal balance between model complexity and generalization when predicting carbohydrate NMR chemical shifts across diverse structural contexts?
- Basis in paper: [inferred] The authors observe that 3D-based MRL models outperform 2D models but also note challenges with overfitting on the smaller experimental dataset, suggesting a trade-off between model capacity and generalization.
- Why unresolved: The paper provides benchmark results for several 3D models but does not systematically explore how model architecture choices (depth, width, attention mechanisms) affect performance across different carbohydrate sizes and structural complexities.
- What evidence would resolve it: Ablation studies varying model complexity parameters and evaluating performance across carbohydrate size distributions and structural feature diversity.

### Open Question 3
- Question: How can hierarchical graph representations that explicitly model monosaccharide-to-carbohydrate relationships improve NMR chemical shift prediction compared to atom-level approaches?
- Basis in paper: [explicit] The authors discuss that current models incorporate monosaccharide features at the atom level but may miss spatial information between monosaccharides, suggesting this as a direction for improvement.
- Why unresolved: The paper uses standard GNN architectures that treat carbohydrates as atom-level graphs without explicitly modeling the hierarchical monosaccharide-to-carbohydrate relationships, leaving the potential benefits of hierarchical approaches unexplored.
- What evidence would resolve it: Development and comparison of hierarchical GNN architectures that explicitly model monosaccharide nodes and their relationships, benchmarked against atom-level approaches on the same dataset.

## Limitations

- Limited size of experimental dataset (299 structures) compared to simulated data (2,310 structures) raises generalizability concerns
- Performance gap between simulated (RMSE ~1.4 ppm for 13C) and experimental data (RMSE ~2.5 ppm for 13C) suggests domain adaptation challenges
- Reliance on PDB-derived structures may introduce artifacts not representative of solution-state NMR conditions

## Confidence

**High confidence**: Dataset creation methodology and basic feasibility of GNN-based chemical shift prediction
**Medium confidence**: Generalizability of model performance to new, unseen carbohydrate structures
**Low confidence**: Robustness of results to different preprocessing choices and hyperparameter settings

## Next Checks

1. **Cross-dataset validation**: Test model performance on independent experimental NMR datasets not included in GlycoNMR.Exp to assess generalizability
2. **Feature ablation study**: Systematically remove individual carbohydrate-specific features to quantify their contribution to prediction accuracy
3. **Real-world benchmarking**: Apply trained models to predict NMR shifts for carbohydrates with known structures but unassigned shifts, then validate predictions experimentally