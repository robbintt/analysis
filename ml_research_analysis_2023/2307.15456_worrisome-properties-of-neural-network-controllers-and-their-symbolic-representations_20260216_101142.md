---
ver: rpa2
title: Worrisome Properties of Neural Network Controllers and Their Symbolic Representations
arxiv_id: '2307.15456'
source_url: https://arxiv.org/abs/2307.15456
tags:
- semi-implicit
- explicit
- controller
- symb
- persistent
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper raises concerns about the robustness of neural network
  (NN) controllers and their symbolic representations in simple reinforcement learning
  benchmark problems. The authors systematically find and prove the existence of persistent
  low-return solutions, which are highly undesirable and easily exploitable by adversaries.
---

# Worrisome Properties of Neural Network Controllers and Their Symbolic Representations

## Quick Facts
- arXiv ID: 2307.15456
- Source URL: https://arxiv.org/abs/2307.15456
- Authors: 
- Reference count: 40
- One-line primary result: Simpler controllers (symbolic) admit more persistent bad solutions compared to deep NN controllers, suggesting robustness is inversely proportional to number of parameters.

## Executive Summary
This paper systematically investigates the robustness of neural network controllers and their symbolic representations in reinforcement learning benchmark problems. The authors demonstrate that simpler controllers, particularly symbolic controllers, are more susceptible to persistent low-return solutions that can be easily exploited by adversaries. Through computer-assisted proofs using interval arithmetic, they rigorously verify the existence of these persistent solutions and periodic orbits. The primary finding reveals a stark contrast to common beliefs: controller robustness appears to be inversely proportional to the number of parameters, with deep neural networks showing significantly better robustness than their symbolic counterparts.

## Method Summary
The study employs a three-step algorithm to construct and evaluate controllers. First, deep neural network controllers are trained using the TD3 algorithm on pendulum and cartpole swing-up environments. Second, symbolic and small neural network controllers are constructed through symbolic regression and distillation from the trained deep networks. Third, controllers are fine-tuned using CMA-ES or gradient-based optimization. The robustness study involves evaluating controllers under different numerical schemes and time steps, searching for persistent solutions using evolutionary search with a penalty function, and verifying existence through computer-assisted proofs with interval arithmetic. The methodology combines reinforcement learning, symbolic regression, distillation, evolutionary optimization, and rigorous mathematical verification.

## Key Results
- Deep NN controllers exhibit significantly better robustness than symbolic controllers, with robustness inversely proportional to parameter count
- All controllers, including deep NNs, contain persistent low-return solutions that accumulate large penalties over time
- Computer-assisted proofs successfully verify the existence of persistent solutions and periodic orbits in benchmark problems

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: The robustness of neural network controllers is inversely proportional to the number of parameters.
- **Mechanism**: Simpler symbolic controllers with fewer parameters admit more persistent bad solutions (periodic orbits) that lead to poor performance. As the number of parameters increases (e.g., moving from symbolic to small neural nets to deep neural nets), the prevalence of these bad solutions decreases.
- **Core assumption**: The relationship between parametric complexity and robustness holds across different numerical schemes and step sizes.
- **Evidence anchors**:
  - [abstract]: "We find that the simpler controllers admit more persistent bad solutions" and "the robustness is inversely proportional to the number of parameters."
  - [section 6.2]: "Deep NN controller performance does not deteriorate as much as for the symbolic controller, whereas the small net is located between the two extremes."
  - [corpus]: Weak evidence; no directly relevant papers found in the corpus.
- **Break condition**: If counterexamples are found where increased parametric complexity does not improve robustness, or if certain symbolic controllers with few parameters are highly robust.

### Mechanism 2
- **Claim**: Computer-assisted proofs using interval arithmetic can rigorously verify the existence of persistent solutions and periodic orbits in controlled dynamical systems.
- **Mechanism**: By constructing a nonlinear map encoding the dynamics and using interval arithmetic to rigorously compute bounds, one can prove the existence of periodic orbits (zeroes of the map) and persistent solutions (trajectories that stay away from equilibrium). This provides mathematical certainty beyond numerical simulation.
- **Core assumption**: The system can be modeled in a form suitable for interval arithmetic verification, and the rounding errors can be bounded.
- **Evidence anchors**:
  - [abstract]: "We provide an algorithm for a systematic robustness study and prove existence of persistent solutions and, in some cases, periodic orbits, using a computer-assisted proof methodology."
  - [section 5]: Detailed description of the computer-assisted proof methodology using interval arithmetic and Theorem 1.
  - [corpus]: Weak evidence; no directly relevant papers found in the corpus.
- **Break condition**: If the system involves discontinuities or non-smooth functions that interval arithmetic cannot handle, or if the wrapping effect becomes too severe for long trajectories.

### Mechanism 3
- **Claim**: The average return metric is deceptive and does not correlate well with controller robustness; persistent solutions with poor returns can exist even in high-performing controllers.
- **Mechanism**: Controllers may achieve high mean returns over many episodes but still contain specific initial conditions that lead to persistent bad solutions. These solutions accumulate large negative returns and can be exploited by adversaries. A more thorough robustness study requires searching for and characterizing these persistent solutions.
- **Core assumption**: The existence of persistent solutions is a meaningful threat to controller robustness, even if they are rare.
- **Evidence anchors**:
  - [abstract]: "A typical controller reaching high mean return values still generates an abundance of persistent low-return solutions, which is a highly undesirable property."
  - [section 6]: Discussion of how symbolic controllers have abundant persistent solutions despite good average returns, and how deep NN controllers are more robust but still admit some bad solutions.
  - [corpus]: Weak evidence; no directly relevant papers found in the corpus.
- **Break condition**: If persistent solutions are shown to be practically irrelevant (e.g., extremely rare or easily avoidable), or if alternative metrics are developed that better capture robustness.

## Foundational Learning

- **Concept**: Reinforcement Learning (RL) and Markov Decision Processes (MDPs)
  - Why needed here: The paper studies controller robustness in RL benchmark problems. Understanding MDPs, policies, rewards, and the training/testing process is essential.
  - Quick check question: In an MDP, what is the difference between the transition function used for training (Ftrain) and testing (Ftest), and why is this distinction important for robustness studies?

- **Concept**: Computer-Assisted Proofs (CAP) and Interval Arithmetic
  - Why needed here: The paper uses CAPs to rigorously prove the existence of persistent solutions and periodic orbits. Interval arithmetic is used to bound rounding errors in numerical computations.
  - Quick check question: How does interval arithmetic differ from standard floating-point arithmetic, and why is it necessary for computer-assisted proofs in this context?

- **Concept**: Numerical Integration Schemes for ODEs
  - Why needed here: The paper studies robustness w.r.t. the numerical scheme used to discretize continuous dynamical systems (e.g., explicit Euler, semi-implicit Euler). Understanding these schemes and their properties is crucial.
  - Quick check question: What are the key differences between explicit Euler and semi-implicit Euler schemes, and how might these differences affect the behavior of controlled dynamical systems?

## Architecture Onboarding

- **Component map**: RL Training (Deep NN Policy) -> Symbolic Regression -> Small NN Distillation -> Fine-tuning -> Robustness Study -> Computer-Assisted Proofs
- **Critical path**: The critical path for controller construction is: RL Training -> Symbolic Regression -> Fine-tuning -> Robustness Study. For proving persistent solutions, the critical path is: Find candidate solutions -> Verify with CAP -> If successful, output proof certificate.
- **Design tradeoffs**:
  - Symbolic vs. Neural Net Controllers: Symbolic controllers are more interpretable but less robust. Neural net controllers are less interpretable but more robust.
  - Proof vs. Simulation: Proofs provide mathematical certainty but are limited to specific cases. Simulations can explore more cases but lack rigorous guarantees.
  - Complexity vs. Performance: More complex controllers (more parameters) tend to be more robust but may be harder to interpret and deploy.
- **Failure signatures**:
  - Symbolic controllers: Large discrepancy in mean returns when changing numerical scheme or step size; presence of many persistent bad solutions.
  - Deep NN controllers: Some persistent bad solutions still exist, but much less prevalent than in symbolic controllers.
  - CAP system: Wrapping effect in interval arithmetic for long trajectories; inability to handle discontinuities or non-smooth functions.
- **First 3 experiments**:
  1. Reproduce the mean return results for pendulum and cartpole with different controllers (symbolic, small NN, deep NN) under various Ftest conditions.
  2. Implement the evolutionary search algorithm to find persistent solutions for a symbolic controller and verify with simulation.
  3. Set up the interval arithmetic proof system and verify a simple persistent solution (e.g., a known periodic orbit) to ensure the CAP framework is working correctly.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the robustness of neural network controllers scale with the number of parameters in different domains beyond the pendulum and cartpole swing-up problems studied in the paper?
- Basis in paper: The paper explicitly states that "the robustness is inversely proportional to the number of parameters" and that this is "starkly contrasting with common beliefs and examples in other domains."
- Why unresolved: The study is limited to simple benchmark problems with relatively small dimensions, and the authors suggest that future work should apply their methods to higher-dimensional problems.
- What evidence would resolve it: A comprehensive study of neural network controller robustness across a diverse set of problems with varying dimensions and complexities, controlling for the number of parameters.

### Open Question 2
- Question: Can the methods developed in this paper for identifying and proving persistent solutions be extended to other types of control systems beyond those governed by ordinary differential equations?
- Basis in paper: The paper focuses on continuous dynamical systems described by ordinary differential equations and their discretizations. The authors mention that their CAP methodology "works for almost all practical applications" but do not explicitly discuss its applicability to other types of control systems.
- Why unresolved: The paper does not explore the limitations or potential extensions of their methods to other types of control systems, such as those governed by partial differential equations or hybrid systems.
- What evidence would resolve it: A demonstration of the successful application of the methods to other types of control systems, or a rigorous analysis of the conditions under which the methods can be extended.

### Open Question 3
- Question: What is the impact of different numerical schemes and time-step sizes on the robustness of neural network controllers, and how can this be quantified?
- Basis in paper: The paper studies the impact of changing the simulator configuration (scheme/time-step) on the robustness of controllers, but does not provide a comprehensive analysis of the impact of different numerical schemes and time-step sizes.
- Why unresolved: The paper focuses on a few specific numerical schemes and time-step sizes, and does not explore the full range of possibilities or provide a systematic way to quantify the impact on robustness.
- What evidence would resolve it: A systematic study of the impact of different numerical schemes and time-step sizes on the robustness of neural network controllers, using a metric such as the average return discrepancy between different schemes/time-step sizes.

## Limitations
- Findings are based on simple benchmark problems (pendulum and cartpole) which may not generalize to complex real-world scenarios
- Computer-assisted proofs are computationally intensive and limited by wrapping effect in interval arithmetic for deep NN controllers with long episodes
- Study focuses on specific numerical integration schemes, results might differ with other discretization methods
- Relationship between parametric complexity and robustness requires further validation on broader range of architectures and problems

## Confidence
- High confidence in the methodology for finding and proving persistent solutions using computer-assisted proofs
- Medium confidence in the inverse relationship between parametric complexity and robustness across different controllers
- Medium confidence in the claim that average return metrics are deceptive indicators of true robustness

## Next Checks
1. Test the parametric complexity-robustness relationship on additional benchmark problems (e.g., LunarLander, BipedalWalker) and more complex neural network architectures (e.g., recurrent networks)
2. Validate the findings with alternative numerical integration schemes (e.g., Runge-Kutta methods) to assess scheme-dependence of persistent solutions
3. Conduct a scalability analysis of the computer-assisted proof methodology to determine practical limits for larger, more complex controllers and longer time horizons