---
ver: rpa2
title: 'Trainable Noise Model as an XAI evaluation method: application on Sobol for
  remote sensing image segmentation'
arxiv_id: '2310.01828'
source_url: https://arxiv.org/abs/2310.01828
tags:
- noise
- image
- segmentation
- methods
- evaluation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work proposes a trainable noise model-based evaluation method
  for XAI techniques applied to semantic segmentation. The approach adapts the Sobol
  method from classification to segmentation by calculating Sobol indices with respect
  to segmentation output masks.
---

# Trainable Noise Model as an XAI evaluation method: application on Sobol for remote sensing image segmentation

## Quick Facts
- arXiv ID: 2310.01828
- Source URL: https://arxiv.org/abs/2310.01828
- Authors: 
- Reference count: 7
- Key outcome: Proposes U-Noise-based evaluation of XAI methods for segmentation, showing Seg-Sobol performs comparably to gradient-based methods on WHU rooftop dataset.

## Executive Summary
This work proposes a trainable noise model-based evaluation method for XAI techniques applied to semantic segmentation. The approach adapts the Sobol method from classification to segmentation by calculating Sobol indices with respect to segmentation output masks. Evaluation is performed by combining XAI saliency maps with input images and measuring noise added by a U-Noise model. The method is benchmarked against Seg-Grad-CAM and Seg-Grad-CAM++ using the WHU dataset for rooftop segmentation. Results show that Seg-Sobol performs comparably to gradient-based methods across different threshold values, demonstrating its effectiveness as an XAI method for segmentation tasks.

## Method Summary
The paper introduces a trainable noise model (U-Noise) as an evaluation metric for XAI methods in semantic segmentation. The approach combines XAI saliency maps with input images using various methods (multiplication, addition, or sampling) and feeds them to a pre-trained U-Noise model that injects noise into unimportant regions. The amount of noise added inversely reflects XAI method quality - lower noise indicates higher fidelity. The Sobol method is adapted from classification to segmentation by computing Sobol indices with respect to the sum of target-class pixels in the segmentation mask. The method is evaluated on the WHU rooftop segmentation dataset using ANA and SRM metrics across different threshold values.

## Key Results
- Seg-Sobol performs comparably to gradient-based methods (Seg-Grad-CAM, Seg-Grad-CAM++) on WHU rooftop segmentation dataset
- Lower ANA and SRM scores indicate better XAI method performance
- Thresholding of noise masks improves evaluation reliability by removing gray regions
- Different explanation map generation methods (mul, add, nsa, nsm) yield varying evaluation results

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: The U-Noise model acts as a noise injector to measure the fidelity of XAI saliency maps by adding noise to the explanation map and quantifying the added noise.
- **Mechanism**: The XAI-generated saliency map is combined with the input image (via multiplication, addition, or sampling), then passed to a pre-trained U-Noise model. The model injects noise into regions it deems unimportant. The amount of noise added inversely reflects the quality of the XAI method—lower noise implies higher fidelity of the saliency map.
- **Core assumption**: Salient pixels highlighted by a good XAI method are genuinely important to the model's prediction, and thus should be preserved (i.e., receive low noise) by the U-Noise model.
- **Evidence anchors**:
  - [abstract] "The main objective of this model is to induce noise on the explanation maps, where higher induced noise signifies low accuracy and vice versa."
  - [section] "A better XAI method would receive less added noise, as it retains the correct important pixels contributing to the model decision."
  - [corpus] No direct evidence in corpus; mechanism inferred from paper's description.
- **Break condition**: If the U-Noise model is poorly trained or overfits, it may inject noise indiscriminately, invalidating the evaluation.

### Mechanism 2
- **Claim**: Adapting Sobol indices from classification to segmentation allows for gradient-free evaluation of feature importance in segmentation masks.
- **Mechanism**: In classification, Sobol indices measure the impact of input perturbations on a single output class. For segmentation, Sobol indices are computed with respect to the sum of target-class pixels in the output mask across multiple perturbations, capturing feature importance across the entire segmentation map.
- **Core assumption**: The sum of target-class pixels in the segmentation mask is a valid scalar proxy for segmentation performance in the Sobol framework.
- **Evidence anchors**:
  - [section] "Rather than calculating the Sobol indices for a single classification output... we calculate the Seg-Sobol indices with respect to multiple values of the segmentation output mask considering a specific target class."
  - [corpus] No direct evidence in corpus; mechanism inferred from paper's description.
- **Break condition**: If the segmentation model outputs probabilities with significant variance or multi-class overlap, summing target-class pixels may not capture nuanced importance.

### Mechanism 3
- **Claim**: Thresholding the noise mask before metric calculation removes ambiguous gray regions, improving the reliability of evaluation metrics.
- **Mechanism**: Explanation maps often contain intermediate intensity values (gray regions). Applying a threshold (e.g., 0.1) binarizes the map, focusing metric computation on confidently important or unimportant pixels, thereby reducing noise in evaluation.
- **Core assumption**: Gray regions in explanation maps are less reliable indicators of importance and should be excluded from metric computation.
- **Evidence anchors**:
  - [section] "To efficiently evaluate the benchmarked XAI methods, a thresholding operation should be applied to the generated noise mask. This is due to the presence of gray regions within the explanation map..."
  - [corpus] No direct evidence in corpus; mechanism inferred from paper's description.
- **Break condition**: If thresholding is too aggressive, it may discard genuinely important pixels, biasing the evaluation.

## Foundational Learning

- **Concept**: Sobol sensitivity indices and variance-based feature importance
  - **Why needed here**: Seg-Sobol relies on Sobol indices to quantify the contribution of input features to segmentation output; understanding this concept is essential to adapt the method from classification to segmentation.
  - **Quick check question**: What does a high Sobol index for an input feature indicate about its effect on model output?

- **Concept**: Gradient-based vs. perturbation-based XAI methods
  - **Why needed here**: The paper contrasts gradient-based methods (Seg-Grad-CAM, Seg-Grad-CAM++) with the perturbation-based Sobol method; knowing their differences helps in understanding the evaluation setup.
  - **Quick check question**: Why might a perturbation-based method like Sobol be preferred when internal model access is restricted?

- **Concept**: Semantic segmentation and output mask structure
  - **Why needed here**: Adapting Sobol to segmentation requires understanding how segmentation outputs are structured as masks with class probabilities per pixel.
  - **Quick check question**: How does the output of a segmentation model differ from that of a classification model in terms of dimensionality and interpretation?

## Architecture Onboarding

- **Component map**: Input image -> Segmentation model -> Output mask -> XAI method -> Saliency map -> Explanation map generator -> Explanation map -> U-Noise model -> Noise mask -> Thresholding (optional) -> Evaluation metrics calculator -> ANA/SRM scores

- **Critical path**:
  1. Input image → segmentation model → output mask
  2. Output mask + input image → XAI method → saliency map
  3. Saliency map + input image → explanation map generator → explanation map
  4. Explanation map → U-Noise model → noise mask
  5. Noise mask → thresholding (optional) → evaluation metrics

- **Design tradeoffs**:
  - Choice of explanation map generation method (mul, add, nsa, nsm) affects interpretability and noise model performance.
  - Thresholding improves metric reliability but may discard useful information if set too high.
  - Using a learnable noise model adds flexibility but requires careful training to avoid overfitting.

- **Failure signatures**:
  - High ANA and SRM across all XAI methods may indicate a poorly trained U-Noise model.
  - Seg-Sobol performing worse than gradient-based methods across all thresholds may suggest the Sobol adaptation is not capturing segmentation-specific importance.
  - Inconsistent results across different explanation map generation methods may indicate sensitivity to input preprocessing.

- **First 3 experiments**:
  1. **Sanity check**: Run all three XAI methods on a simple synthetic dataset with known ground truth importance; verify that lower ANA/SRM aligns with ground truth.
  2. **Threshold sweep**: Evaluate each XAI method across a range of threshold values; identify the threshold that best separates methods by performance.
  3. **Explanation map ablation**: Compare ANA/SRM results using each of the four explanation map generation methods; determine which yields the most discriminative evaluation.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the U-Noise model evaluation method compare to other XAI evaluation metrics like deletion/insertion scores or faithfulness metrics?
- Basis in paper: [inferred] The paper proposes a new U-Noise-based evaluation method but doesn't compare it to existing XAI evaluation metrics.
- Why unresolved: The authors only benchmark their method against other XAI techniques (Seg-Grad-CAM, Seg-Grad-CAM++), not against other evaluation metrics.
- What evidence would resolve it: A comprehensive study comparing U-Noise evaluation results with established XAI metrics across multiple datasets and segmentation tasks.

### Open Question 2
- Question: How does the choice of grid size affect the accuracy and computational efficiency of the Seg-Sobol method?
- Basis in paper: [explicit] The paper mentions "Figure 5. Seg-Sobol results with grid size = 11" but doesn't explore how different grid sizes impact performance.
- Why unresolved: The authors only demonstrate results with one grid size, without analyzing the sensitivity to this parameter.
- What evidence would resolve it: Systematic experiments varying grid sizes and analyzing trade-offs between accuracy and computational cost.

### Open Question 3
- Question: How well does the U-Noise evaluation method generalize to other segmentation tasks beyond building footprint detection?
- Basis in paper: [inferred] The evaluation is only performed on a single dataset (WHU dataset for rooftop buildings segmentation).
- Why unresolved: The paper doesn't test the method on diverse segmentation tasks or datasets.
- What evidence would resolve it: Experiments on multiple segmentation datasets covering different object categories (e.g., medical imaging, road segmentation, object detection) with consistent results.

## Limitations
- Limited generalizability beyond WHU rooftop segmentation dataset to other segmentation tasks
- Scalar aggregation of pixel information in Seg-Sobol may oversimplify complex segmentation outputs
- Sensitivity to explanation map generation method choice not thoroughly explored

## Confidence

- **High confidence**: The U-Noise model's ability to inject noise based on explanation maps and provide quantitative evaluation through ANA and SRM metrics is well-supported by the experimental results on the WHU dataset.
- **Medium confidence**: The adaptation of Sobol indices to segmentation tasks is theoretically sound, but the scalar aggregation of pixel information may oversimplify complex segmentation outputs.
- **Low confidence**: The generalizability of the proposed evaluation framework to other remote sensing segmentation tasks and non-satellite imagery domains remains unverified.

## Next Checks
1. **Cross-dataset validation**: Evaluate the U-Noise model and Sobol adaptation on at least two additional remote sensing segmentation datasets (e.g., Inria Aerial Image Labeling, DeepGlobe) to test generalizability.
2. **Ground truth comparison**: On synthetic or controlled datasets where ground truth important regions are known, verify that Seg-Sobol correctly identifies these regions and receives lower ANA/SRM scores compared to gradient-based methods.
3. **Method ablation study**: Systematically evaluate each explanation map generation method (mul, add, nsa, nsm) across different segmentation tasks to determine which yields the most reliable evaluation and whether certain methods are task-dependent.