---
ver: rpa2
title: Cross-domain feature disentanglement for interpretable modeling of tumor microenvironment
  impact on drug response
arxiv_id: '2311.09264'
source_url: https://arxiv.org/abs/2311.09264
tags:
- drug
- domain
- response
- tumor
- cell
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study introduces Drug2TME, a deep learning framework designed
  to model the impact of the tumor microenvironment (TME) on clinical drug response.
  The method uses domain adaptation and feature disentanglement to separate tumor
  features into cancer cells and TME, allowing for independent quantification of their
  influence on drug efficacy.
---

# Cross-domain feature disentanglement for interpretable modeling of tumor microenvironment impact on drug response

## Quick Facts
- arXiv ID: 2311.09264
- Source URL: https://arxiv.org/abs/2311.09264
- Reference count: 17
- Primary result: Drug2TME achieves AUROC of 0.81 on PDTC data and 0.72 on TCGA patient data, outperforming baseline methods by modeling TME impact on drug response

## Executive Summary
Drug2TME is a deep learning framework that models how the tumor microenvironment (TME) affects clinical drug response by separating tumor features into cancer cell and TME components. The method uses domain adaptation to transfer knowledge from cell line data to patient tumors while maintaining feature disentanglement through orthogonality constraints. Two denoising autoencoders extract features from cell lines and tumors, with partial domain alignment and feature decoupling. A graph attention network learns drug representations to enable generalization to novel drugs. Evaluated on both patient-derived tumor xenograft cell (PDTC) and tumor patient drug responses, Drug2TME demonstrates superior performance compared to baseline methods.

## Method Summary
Drug2TME uses a two-stage training approach with domain separation and feature disentanglement. First, two denoising autoencoders extract features from cell lines (source domain) and tumors (target domain). The domain separation network employs a common encoder and a private encoder to decouple tumor features into cancer cell components (aligned to cell line features via MMD or adversarial loss) and TME components (kept domain-specific). A graph attention network encodes drug molecular structures into the same latent space as gene expression features. The model assumes linear additivity of cancer cell and TME contributions to drug response. Training proceeds in two stages: first optimizing the autoencoders and domain alignment, then training the TME predictor on patient drug response data.

## Key Results
- Drug2TME achieves AUROC of 0.81 on PDTC data and 0.72 on TCGA patient data
- Model significantly outperforms baseline domain adaptation methods without TME modeling
- Feature disentanglement enables independent quantification of cancer cell vs TME contributions to drug response
- GAT-based drug encoding allows generalization to novel drugs not seen during training

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Domain separation network effectively decouples tumor transcriptomic features into cancer cell and TME components by enforcing orthogonality
- Mechanism: The model uses two encoders (common and private) to extract features z(tc) and z(ts) from tumor data, with a loss function (Eq. 2) that penalizes their dot product, ensuring orthogonality
- Core assumption: The orthogonality constraint sufficiently enforces feature disentanglement such that z(ts) captures only TME information
- Evidence anchors:
  - [abstract] "we employed a domain separation network to decouple the tumor feature into two parts: cancer cells and TME"
  - [section] "For feature disentanglement, we required z(tc)i and z(ts)i were orthogonal to each other so that each embedding did not contain any information about each other"
  - [corpus] Weak evidence - no direct corpus support for orthogonality-based disentanglement in drug response prediction
- Break condition: If orthogonality alone is insufficient for true feature separation, residual cancer cell information may leak into TME features

### Mechanism 2
- Claim: Partial domain adaptation aligns cancer cell features to cell line features while preserving TME specificity
- Mechanism: The common encoder's output z(tc) is aligned to cell line features via MMD or adversarial loss, while the private encoder's TME feature z(ts) remains domain-specific
- Core assumption: Domain-invariant cancer cell features can be reliably aligned across in vitro and in vivo domains while TME features remain domain-specific
- Evidence anchors:
  - [abstract] "Two denoising autoencoders were separately used to extract features from cell lines (source domain) and tumors (target domain) for partial domain alignment and feature decoupling"
  - [section] "the embedding z(tc)i extracted from tumor expression profile was aligned to the cell line embedding z(c)i, such that the common encoder Ec was enforced to extract the common feature between tumor and cell line"
  - [corpus] No direct evidence - corpus lacks similar partial domain adaptation approaches for drug response
- Break condition: If domain shift between cell lines and tumors is too large, alignment may fail and TME information may contaminate cancer cell features

### Mechanism 3
- Claim: Graph attention network enables generalization to novel drugs by learning transferable drug representations
- Mechanism: Drug molecules are converted to graphs and processed through a pre-trained GAT to obtain embeddings in the same latent space as gene expression features
- Core assumption: Drug structural information encoded as graphs contains sufficient information to predict drug effects on cellular state
- Evidence anchors:
  - [abstract] "we applied a graph attention network to learn the latent representation of drugs, allowing us to linearly model the drug perturbation on cellular state in latent space"
  - [section] "the SMILE of the drug was converted into a graph, which was fed into a graph attention network (GAT) to obtain the drug feature"
  - [corpus] Weak evidence - corpus lacks specific examples of GAT for drug response prediction, though similar approaches exist in molecular property prediction
- Break condition: If drug effects depend on context beyond structural features, the GAT representation may be insufficient for accurate prediction

## Foundational Learning

- Domain adaptation
  - Why needed here: Cell lines and tumors have different data distributions, requiring knowledge transfer from source (cell lines) to target (tumors)
  - Quick check question: What would happen if we trained directly on tumor data without adaptation from cell lines?

- Feature disentanglement
  - Why needed here: Tumor bulk RNA contains mixed signals from cancer cells and TME, requiring separation to model their independent effects
  - Quick check question: How would the model perform if we treated the tumor as a single feature space without decomposition?

- Graph neural networks
  - Why needed here: Drug molecules need to be represented in the same latent space as gene expression for linear modeling of drug effects
  - Quick check question: What alternative representations could we use for drugs if we couldn't use graph structures?

## Architecture Onboarding

- Component map: Cell line autoencoder → Drug GAT encoder → Domain separation network (common+private encoders) → Predictors (Fc+Ft) → Drug response output
- Critical path: Gene expression → Domain separation → Cancer cell alignment → Drug perturbation → Response prediction
- Design tradeoffs: Two-stage training increases complexity but allows separate optimization of cancer cell and TME contributions
- Failure signatures: Poor performance on novel drugs indicates GAT generalization failure; poor tumor prediction indicates domain alignment issues
- First 3 experiments:
  1. Test baseline domain adaptation without feature disentanglement on PDTC data
  2. Validate orthogonality loss is actually enforcing feature separation
  3. Evaluate GAT drug representations on a held-out set of novel drugs

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the performance of Drug2TME compare to other domain adaptation methods that do not explicitly model the tumor microenvironment (TME)?
- Basis in paper: [explicit] The paper states that Drug2TME significantly outperforms baseline methods, but does not directly compare to other domain adaptation methods without TME modeling.
- Why unresolved: While the paper demonstrates the superiority of Drug2TME over baseline methods, it does not provide a direct comparison to other domain adaptation methods that do not explicitly model the TME.
- What evidence would resolve it: A head-to-head comparison of Drug2TME with other state-of-the-art domain adaptation methods, such as those mentioned in the related works section, would help determine the relative performance of Drug2TME.

### Open Question 2
- Question: How robust is Drug2TME to variations in the quality and quantity of the training data from both cell lines and tumor samples?
- Basis in paper: [inferred] The paper mentions the use of a benchmark dataset and the incremental increase in the percentage of patient samples used to train the TME predictor, but does not explicitly discuss the robustness of the model to variations in data quality and quantity.
- Why unresolved: The paper does not provide a comprehensive analysis of how Drug2TME performs when trained on datasets with varying quality and quantity of cell line and tumor samples.
- What evidence would resolve it: A systematic study evaluating Drug2TME's performance on datasets with different levels of noise, missing data, and sample sizes would help assess its robustness.

### Open Question 3
- Question: Can Drug2TME be extended to model the impact of other factors in the tumor microenvironment, such as immune cells and stromal cells, on drug response?
- Basis in paper: [explicit] The paper focuses on separating representations of cancer cells and the tumor microenvironment (TME) but does not discuss the possibility of modeling other factors within the TME.
- Why unresolved: While Drug2TME effectively models the impact of the TME on drug response, it does not explicitly consider other components of the TME, such as immune cells and stromal cells, which may also play a significant role in drug efficacy.
- What evidence would resolve it: Extending Drug2TME to incorporate additional components of the TME, such as immune cells and stromal cells, and evaluating its performance on drug response prediction would help determine the potential benefits of modeling these factors.

## Limitations
- The orthogonality constraint for feature disentanglement lacks direct validation that it truly separates cancer and TME information
- Partial domain alignment assumes TME features remain domain-specific while cancer features align, but this assumption isn't empirically verified across cancer types
- GAT-based drug encoding may not capture all drug-specific mechanisms beyond structural features

## Confidence
- High: AUROC performance metrics and baseline comparisons are reliable and well-documented
- Medium: Domain alignment and feature disentanglement mechanisms work as described but lack independent validation
- Low: The interpretability claims about quantifying TME vs cancer cell contributions need further experimental verification

## Next Checks
1. Perform ablation studies testing orthogonality loss importance by comparing with and without the orthogonality constraint
2. Validate domain alignment quality using UMAP visualization of feature distributions across cell lines and tumors
3. Test model generalization on held-out drugs not seen during training to assess GAT representation quality