---
ver: rpa2
title: 'Optimal transport distances for directed, weighted graphs: a case study with
  cell-cell communication networks'
arxiv_id: '2309.07030'
source_url: https://arxiv.org/abs/2309.07030
tags:
- graphs
- distance
- graph
- directed
- distances
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'The paper addresses the problem of comparing directed, weighted
  graphs using optimal transport distances, a task that has been challenging due to
  the lack of symmetry in directed graphs. The authors propose two distance measures:
  a Wasserstein (Earth Mover) distance and a Gromov-Wasserstein distance.'
---

# Optimal transport distances for directed, weighted graphs: a case study with cell-cell communication networks

## Quick Facts
- arXiv ID: 2309.07030
- Source URL: https://arxiv.org/abs/2309.07030
- Authors: 
- Reference count: 0
- One-line primary result: Optimal transport distances based on node-to-node metrics (GRD and HTD) effectively compare directed, weighted graphs, with Wasserstein formulation outperforming other methods on cell-cell communication networks

## Executive Summary
This paper addresses the challenge of comparing directed, weighted graphs using optimal transport distances. The authors propose two distance measures - a Wasserstein (Earth Mover) distance and a Gromov-Wasserstein distance - based on node-to-node distance metrics specifically designed for directed graphs. These metrics, namely the Generalized Effective Resistance (GRD) and Markov Chain Hitting Time (HTD) distance, enable the application of optimal transport to directed structures by providing valid symmetric, non-negative distance measures between nodes.

The performance of these methods is evaluated using both simulated graph data and real-world directed cell-cell communication networks inferred from single-cell RNA-seq data. In synthetic experiments, the methods successfully capture differences in graph structures that standard undirected methods miss. In the real-world case study, the Wasserstein formulation outperformed other approaches, including baselines like PCA and correlation-based methods, with Adjusted Rand Index (ARI) scores up to 0.884777 in disease classification tasks.

## Method Summary
The authors propose two distance measures to compare directed graphs using optimal transport: a Wasserstein distance and a Gromov-Wasserstein distance. The method computes node-to-node distance metrics (GRD or HTD) for each directed graph, then uses these distance matrices in either a Gromov-Wasserstein formulation (aligning graph geometries) or a Wasserstein formulation (transporting edge weight distributions). For the Wasserstein approach, a line graph construction is used where vertices represent directed edges and edges represent co-occurrence across graphs. The methods are evaluated by clustering graphs using k-means on the resulting distance matrix and computing Adjusted Rand Index against ground truth labels.

## Key Results
- Proposed optimal transport distances successfully capture structural differences in directed graphs that standard undirected methods miss
- Wasserstein formulation outperformed Gromov-Wasserstein and baseline methods on real cell-cell communication networks with ARI up to 0.884777
- Methods are particularly effective for sparse and noisy directed weighted graphs derived from single-cell RNA-seq data

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The generalized effective resistance (GRD) and hitting time distance (HTD) provide valid node-to-node metrics for directed graphs, enabling optimal transport formulations.
- Mechanism: These metrics define a symmetric, non-negative distance between nodes in a directed graph, overcoming the asymmetry issue that normally prevents direct application of optimal transport to directed structures. GRD uses a grounded Laplacian approach while HTD uses Markov chain hitting probabilities.
- Core assumption: The directed graph is strongly connected (or can be made so via low-rank regularization), ensuring the metrics are well-defined.
- Evidence anchors:
  - [abstract] "We propose two distance measures to compare directed graphs based on variants of optimal transport: (i) an earth movers distance (Wasserstein) and (ii) a Gromov-Wasserstein (GW) distance."
  - [section 3.1.1] "Young et al. [17] extended the notion of resistance distance by using an alternative characterization of the inverse eL−1 that appears in the definition of the effective resistance."
  - [section 3.1.2] "A second type of node-to-node distance metric for directed graphs is the class of hitting time metrics developed by Boyd et al. [7]."

### Mechanism 2
- Claim: The Gromov-Wasserstein (GW) distance formulation transports node-to-node geometries rather than edge weights, making it suitable for comparing structural patterns across directed graphs.
- Mechanism: GW minimizes the distortion between distance matrices (Ck, Cl) induced by GRD or HTD, finding a transport plan that aligns the internal geometries of two graphs. This captures structural similarity even when node labels differ.
- Core assumption: The distance matrices Ck and Cl provide meaningful representations of graph structure that can be meaningfully aligned.

### Mechanism 3
- Claim: The Wasserstein formulation using a line graph construction captures differences in edge weight distributions across the same underlying edge set, making it effective for noisy biological networks.
- Mechanism: By constructing a line graph where vertices represent directed edges, and edges represent co-occurrence across graphs, the Wasserstein distance transports edge weight distributions while respecting the directionality captured by the line graph structure.
- Core assumption: The edge set is consistent across graphs or can be meaningfully aligned through the line graph construction.

## Foundational Learning

- Concept: Directed graph theory and connectivity
  - Why needed here: Understanding strongly connected components, edge directionality, and reachability is essential for applying GRD and HTD metrics, which assume certain connectivity properties.
  - Quick check question: What happens to the hitting time distance between nodes in different strongly connected components of a directed graph?

- Concept: Optimal transport fundamentals
  - Why needed here: The paper applies Wasserstein and Gromov-Wasserstein distances, which require understanding transport plans, marginal constraints, and cost minimization.
  - Quick check question: In the Wasserstein formulation, what constraints must a transport plan Γ satisfy to ensure valid probability distributions over nodes/edges?

- Concept: Graph Laplacians and their generalizations
  - Why needed here: GRD relies on grounded Laplacian matrices, requiring understanding of how Laplacians extend from undirected to directed graphs.
  - Quick check question: How does the grounded Laplacian eL differ from the standard graph Laplacian L for a directed graph?

## Architecture Onboarding

- Component map: Input graphs -> Node-to-node distance computation (GRD/HTD) -> Optimal transport formulation (GW/Wasserstein) -> Distance matrix + transport plan
- Critical path: 1. Compute node-to-node distance matrix (C) using GRD or HTD, 2. Choose formulation (GW or W), 3. Solve optimal transport optimization problem, 4. Extract distance and transport plan
- Design tradeoffs:
  - GRD vs HTD: GRD captures electrical network analogies while HTD captures random walk dynamics; choice depends on domain interpretation
  - GW vs Wasserstein: GW aligns internal geometries (better for structural comparison) while Wasserstein aligns edge weight distributions (better for signal comparison)
  - Computational complexity: GW requires O(N^4) operations for N-node graphs, while Wasserstein with line graph is more scalable
- Failure signatures:
  - Distance matrix contains NaNs or infinities: Likely indicates non-strongly-connected graph without proper regularization
  - All distances are zero: May indicate identical distance matrices (possibly due to disconnected components)
  - Transport plan is degenerate: May indicate numerical instability or ill-conditioned distance matrices
- First 3 experiments:
  1. Verify node-to-node distance computation on a simple directed cycle (should be symmetric and consistent)
  2. Compare GW and Wasserstein distances on a pair of directed graphs with known structural differences
  3. Test regularization effects on a directed graph with disconnected components to ensure metric well-definition

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the performance of the Wasserstein formulation compare to Gromov-Wasserstein for more diverse types of directed weighted graphs beyond the specific cell-cell communication networks studied?
- Basis in paper: [explicit] The paper notes that the Wasserstein formulation outperformed Gromov-Wasserstein for the specific task of clustering cell-cell communication networks, suggesting it may be better suited for sparse and noisy directed weighted graphs.
- Why unresolved: The comparison was only done for one specific type of directed weighted graph (cell-cell communication networks). It's unclear if this performance difference would hold for other types of directed weighted graphs.
- What evidence would resolve it: Systematic experiments comparing the performance of both formulations across a diverse set of directed weighted graph datasets, including different types of networks (e.g., social networks, biological networks, etc.) and varying levels of sparsity and noise.

### Open Question 2
- Question: What are the specific mechanisms by which noise and sparsity affect the performance of the proposed optimal transport-based distance measures for directed graphs?
- Basis in paper: [inferred] The paper mentions that the Wasserstein formulation might be better suited for sparse and noisy directed weighted graphs, but does not provide a detailed analysis of how noise and sparsity specifically impact the performance.
- Why unresolved: While the paper suggests a potential advantage of the Wasserstein formulation in the presence of noise and sparsity, it does not provide a detailed analysis of the underlying mechanisms or how different levels of noise and sparsity affect the performance of the distance measures.
- What evidence would resolve it: Controlled experiments systematically varying the levels of noise and sparsity in the directed weighted graphs, and analyzing how these factors impact the performance of both the Wasserstein and Gromov-Wasserstein formulations, as well as the different node-to-node distance metrics (GRD and HTD).

### Open Question 3
- Question: Can the proposed optimal transport-based distance measures be extended to handle dynamic directed weighted graphs that change over time?
- Basis in paper: [inferred] The paper focuses on comparing static directed weighted graphs, but many real-world applications involve dynamic networks that evolve over time. The methods presented could potentially be extended to handle such dynamic scenarios.
- Why unresolved: The paper does not discuss or explore the potential extension of the methods to dynamic graphs. It is unclear how the distance measures would need to be modified to capture the temporal evolution of directed weighted graphs.
- What evidence would resolve it: Development and evaluation of modified versions of the Wasserstein and Gromov-Wasserstein formulations that can handle dynamic directed weighted graphs, potentially by incorporating temporal information into the node-to-node distance metrics or the optimal transport problem formulation.

## Limitations
- Claims about method superiority are based on a single real-world dataset (cell-cell communication networks), limiting generalizability
- The comparison between GRD and HTD metrics lacks systematic analysis across diverse graph types
- Computational complexity of GW for large graphs is not thoroughly discussed

## Confidence
- High: The mathematical foundations of GRD and HTD as valid metrics for directed graphs
- Medium: The effectiveness of the proposed methods on the specific cell-cell communication dataset
- Low: Claims about method superiority over all existing approaches without broader empirical validation

## Next Checks
1. Test the proposed methods on multiple directed graph datasets (e.g., citation networks, biological pathways) to assess generalizability
2. Perform ablation studies comparing GRD vs HTD metrics across different graph families to determine when each is most effective
3. Evaluate computational scalability by benchmarking on increasingly large directed graphs and analyzing solver convergence patterns