---
ver: rpa2
title: Predicting Drug-Drug Interactions Using Knowledge Graphs
arxiv_id: '2308.04172'
source_url: https://arxiv.org/abs/2308.04172
tags:
- drug
- graph
- ddis
- drugs
- knowledge
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces medicX, a framework that leverages Knowledge
  Graphs (KGs) to predict drug-drug interactions (DDIs) more accurately than previous
  methods. The framework integrates drug data from multiple sources into a comprehensive
  KG and uses various Knowledge Graph Embedding (KGE) methods, including translation,
  factorization, and Graph Neural Networks (GNNs), to generate high-quality drug feature
  representations.
---

# Predicting Drug-Drug Interactions Using Knowledge Graphs

## Quick Facts
- arXiv ID: 2308.04172
- Source URL: https://arxiv.org/abs/2308.04172
- Reference count: 0
- Primary result: ComplEx embeddings + LSTM achieved F1-score of 95.19%, outperforming DeepDDI by 5.61%

## Executive Summary
This paper introduces medicX, a framework that leverages Knowledge Graphs (KGs) to predict drug-drug interactions (DDIs) with significantly higher accuracy than previous methods. By integrating drug data from multiple sources into a comprehensive KG and applying various Knowledge Graph Embedding (KGE) methods, medicX generates high-quality drug feature representations that capture complex relationships between drugs, diseases, targets, and side effects. The best-performing model combines ComplEx embeddings with an LSTM network, achieving an F1-score of 95.19%, while a graph auto-encoder using GNNs achieved 91.94%, demonstrating the effectiveness of different approaches to mining underlying semantics from KGs.

## Method Summary
The medicX framework builds a comprehensive KG by integrating drug data from DrugBank, SIDER, KEGG, and PharmGKB into RDF format, then applies KGE methods including translation models (TransE, TransR), factorization models (RESCAL, DistMult, ComplEx), and GNNs (R-GCN) to generate drug embeddings. These embeddings are concatenated for drug pairs and fed into machine learning classifiers including Random Forest, MLP, and LSTM to predict DDIs. The framework uses 70% of known DDIs for training, 10% for validation, and 30% for evaluation, with equivalent negative samples to maintain class balance.

## Key Results
- ComplEx embeddings combined with LSTM network achieved F1-score of 95.19%, outperforming state-of-the-art DeepDDI by 5.61%
- Graph auto-encoder using R-GCN achieved F1-score of 91.94%, demonstrating GNNs' ability to capture deeper semantic information
- medicX's approach significantly outperformed models using single drug properties like SMILES notation
- The framework provides interpretability through KG structure while maintaining high predictive accuracy

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Knowledge Graphs provide superior drug representations compared to single drug properties for DDI prediction
- Mechanism: KGs capture multi-relational data among drugs, diseases, targets, and side effects, creating a richer feature space than using a single property like SMILES notation
- Core assumption: The relationships and interconnections between drugs in a KG provide meaningful semantic context that improves prediction accuracy
- Evidence anchors: [abstract] "KGs since they are able to capture the relationships among entities providing better drug representations than using a single drug property"; [section 1.1] "Although there are already other available biomedical KGs, such as Bio2RDF [11], the data has not been updated since 2014"

### Mechanism 2
- Claim: ComplEx KGE model combined with LSTM network achieves superior DDI prediction performance
- Mechanism: ComplEx handles complex and diverse relations in KGs, while LSTM processes sequential patterns in the concatenated drug embeddings, leading to better classification accuracy
- Core assumption: The combination of a sophisticated KGE model (ComplEx) with a powerful sequence learning model (LSTM) can capture both structural and temporal patterns in drug interactions
- Evidence anchors: [abstract] "the best performing combination was the ComplEx embedding method with a Long Short-Term Memory (LSTM) network, which obtained an F1-score of 95.19%"; [section 4.2] "we found that a larger sample size performs better in our case" and "we generated a ComplEx-LSTM model that obtained an F1-score of 95.19%"

### Mechanism 3
- Claim: Graph Neural Networks can extract deeper semantic information from KGs compared to traditional KGE methods
- Mechanism: GNNs like R-GCN consider the type of entity and relation, path information, and underlying structure information during embedding, capturing more complex relationships
- Core assumption: The neighborhood aggregation and relational convolutions in GNNs can capture semantic information that factorisation-based methods miss
- Evidence anchors: [abstract] "GNNs have demonstrated a stronger ability to mine the underlying semantics of the KG than the ComplEx model"; [section 4.2] "we concluded that using a feature learning and extraction model such as R-GCN can generate better embeddings compared to translation and factorisation-based models"

## Foundational Learning

- Concept: Knowledge Graph Embeddings (KGE)
  - Why needed here: KGE methods convert nodes and relations in the KG into dense vector representations that capture semantic relationships, which are then used as features for DDI prediction
  - Quick check question: What is the key difference between translation-based and factorisation-based KGE models?

- Concept: Graph Neural Networks (GNNs)
  - Why needed here: GNNs can learn embeddings by aggregating information from a node's neighborhood, considering the type of relations, which is crucial for capturing complex drug interactions in the KG
  - Quick check question: How does a Relational-GCN (R-GCN) differ from a standard GCN in handling multi-relational graphs?

- Concept: Machine Learning Classifiers
  - Why needed here: After obtaining drug embeddings, ML classifiers like LSTM, RF, or MLP are used to distinguish between interacting and non-interacting drug pairs
  - Quick check question: Why might an LSTM perform better than a Random Forest for this DDI prediction task?

## Architecture Onboarding

- Component map: Data Collection -> KG Construction -> Storage -> KGE Training -> Feature Extraction -> Classification -> Evaluation
- Critical path: Data collection and KG construction → KGE model training and embedding generation → ML classifier training and evaluation
- Design tradeoffs: Translation models are simpler but less expressive; factorization models like ComplEx handle complex relations better; GNNs capture deeper semantics but are computationally expensive; higher embedding dimensions capture more information but increase computational cost and risk overfitting
- Failure signatures: Low F1-score could indicate poor quality embeddings, imbalanced dataset, or inappropriate classifier choice; memory errors during GNN training likely due to high embedding dimensions or insufficient computational resources; slow training times may be caused by large KG size, high embedding dimensions, or complex model architectures
- First 3 experiments: 1) Train and evaluate a simple TransE KGE model with an RF classifier to establish a baseline; 2) Train and evaluate a ComplEx KGE model with an LSTM classifier to test the best-performing combination; 3) Implement and evaluate a graph auto-encoder using R-GCN to compare with KGE-based approaches

## Open Questions the Paper Calls Out

- How would medicX's performance compare on datasets containing only true negative drug pairs?
  - Basis in paper: [explicit] The paper mentions that their negative set consists of drug pairs for which evidence of interaction hasn't been found yet, potentially leading to discrepancies in their dataset
  - Why unresolved: The authors note this limitation but haven't tested medicX on a dataset with only verified true negatives, which could provide a more accurate evaluation
  - What evidence would resolve it: Testing medicX on a dataset containing only true negative drug pairs and comparing its performance metrics (F1-score, precision, recall) with current results

- How would increasing the embedding dimensions in the Graph Neural Network-based approach affect medicX's performance?
  - Basis in paper: [explicit] The authors state that GNNs demonstrated stronger ability to mine underlying semantics of the KG, but memory restrictions limited their embedding size compared to the ComplEx model
  - Why unresolved: The authors couldn't test higher dimension embeddings due to computational limitations, leaving the full potential of GNNs unexplored
  - What evidence would resolve it: Running medicX with increased embedding dimensions in the GNN approach and measuring the resulting performance improvements

- How would incorporating unstructured data from sources like PubMed affect medicX's predictive accuracy?
  - Basis in paper: [explicit] The authors mention plans to enrich the KG with unstructured data from medical sources including PubMed to improve performance
  - Why unresolved: This is a planned future work that hasn't been implemented or tested yet
  - What evidence would resolve it: Implementing the KG enrichment with PubMed data and measuring the change in DDI prediction accuracy compared to the current version

## Limitations

- The exact SPARQL queries for Competency Questions are not provided, limiting reproducibility of the KG construction process
- Specific bio2rdf-scripts used for data conversion are not detailed, potentially affecting KG consistency
- Class imbalance effects are not thoroughly analyzed despite negative sampling, which may impact real-world applicability

## Confidence

- High confidence in the ComplEx + LSTM combination achieving 95.19% F1-score, as this is directly reported with specific methodology
- Medium confidence in GNN superiority claims, as the comparison is based on a single R-GCN implementation with specific parameters
- Low confidence in generalizability across different KG structures and drug interaction patterns without additional validation

## Next Checks

1. Reproduce the ComplEx embeddings with a different drug interaction dataset to verify the 95.19% F1-score is not dataset-specific
2. Implement and compare multiple GNN architectures (GCN, GraphSAGE, GAT) to validate the claimed superiority of R-GCN
3. Conduct ablation studies removing different relation types from the KG to assess which relationships are most critical for prediction accuracy