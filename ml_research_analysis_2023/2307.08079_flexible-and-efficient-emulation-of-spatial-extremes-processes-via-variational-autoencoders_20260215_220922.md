---
ver: rpa2
title: Flexible and efficient emulation of spatial extremes processes via variational
  autoencoders
arxiv_id: '2307.08079'
source_url: https://arxiv.org/abs/2307.08079
tags:
- dependence
- spatial
- which
- data
- process
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a novel spatial extremes model that integrates
  a max-infinitely divisible (max-id) process within a variational autoencoder (VAE),
  called the extVAE. The max-id process has flexible, non-stationary dependence properties,
  allowing for local asymptotic dependence and independence.
---

# Flexible and efficient emulation of spatial extremes processes via variational autoencoders

## Quick Facts
- **arXiv ID:** 2307.08079
- **Source URL:** https://arxiv.org/abs/2307.08079
- **Reference count:** 40
- **One-line primary result:** A novel spatial extremes model integrating max-infinitely divisible processes within a variational autoencoder enables flexible, efficient emulation of non-stationary dependence structures.

## Executive Summary
This paper introduces the extVAE, a novel framework that combines spatial extremes modeling with variational autoencoders (VAEs) to efficiently emulate spatial observations with complex, non-stationary dependence structures. The model embeds a max-infinitely divisible (max-id) process within the decoder of a VAE, allowing it to capture heavy-tailed behavior and flexible local dependence patterns. The extVAE is demonstrated to outperform traditional Gaussian process approaches and standard Bayesian inference in terms of computational efficiency while maintaining accuracy, particularly in modeling extreme events.

## Method Summary
The extVAE framework integrates a max-infinitely divisible spatial extremes model within a variational autoencoder structure. The encoder compresses high-dimensional spatial data into a low-dimensional latent space, while the decoder reconstructs the data using a max-id process that generates latent variables with flexible dependence structures. The model is trained using stochastic gradient descent to optimize the evidence lower bound (ELBO) loss function. The extVAE is evaluated through extensive simulations and applied to a high-resolution satellite-derived sea surface temperature dataset from the Red Sea, demonstrating its ability to identify regions susceptible to marine heatwaves under climate change scenarios.

## Key Results
- The extVAE efficiently emulates spatial observations while accurately capturing tail dependence, outperforming Gaussian process approaches in computational speed and accuracy for extreme events.
- The model successfully identifies regions in the Red Sea susceptible to marine heatwaves and captures temporal changes in extremal dependence structure.
- Simulation studies demonstrate the extVAE's superior performance in estimating extremal dependence measures and producing realistic spatial fields compared to traditional spatial extremes models.

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** The extVAE uses a max-infinitely divisible (max-id) process within its decoder to explicitly model heavy-tailed spatial extremes, overcoming the limitations of Gaussian processes that underestimate tail dependence.
- **Mechanism:** The max-id process generates latent exponentially tilted positive-stable (PS) variables that induce flexible, non-stationary dependence. This allows the model to capture both local asymptotic dependence and independence, adapting to varying spatial structures.
- **Core assumption:** The spatial process of interest has marginal distributions that are heavy-tailed and exhibits complex, non-stationary extremal dependence.
- **Evidence anchors:** [abstract] "integrate a new spatial extremes model that has flexible and non-stationary dependence properties in the encoding-decoding structure of a variational autoencoder called the XVAE." [section] "We first propose a flexible spatial extremes model that can easily be integrated in a VAE and that has space-scale aware and non-stationary dependence properties."
- **Break condition:** If the spatial process does not exhibit heavy tails or if the dependence structure is stationary and simple, the added complexity of the max-id process may not be necessary and could lead to overfitting.

### Mechanism 2
- **Claim:** The extVAE framework allows for efficient emulation and uncertainty quantification by embedding the spatial extremes model within a variational autoencoder, enabling fast inference and generation of numerous samples.
- **Mechanism:** The VAE structure uses an encoder to compress high-dimensional spatial data into a low-dimensional latent space and a decoder to reconstruct the data, with the max-id process governing the decoder's output distribution. This allows for efficient sampling from the learned distribution to generate new spatial fields with the same statistical properties as the input data.
- **Core assumption:** The spatial extremes model can be adequately represented in a low-dimensional latent space without significant loss of information about the dependence structure.
- **Evidence anchors:** [abstract] "The XVAE can be used as a spatio-temporal emulator that characterizes the distribution of potential mechanistic model output states and produces outputs that have the same properties as the inputs, especially in the tail." [section] "We then embed this flexible spatial extremes model within a variational autoencoder (Kingma and Welling, 2013, VAE) engine for enabling fast and efficient model calibration and data emulation with uncertainty quantification."
- **Break condition:** If the spatial data is very high-dimensional or the dependence structure is too complex to be captured in the latent space, the VAE may not be able to efficiently emulate the data.

### Mechanism 3
- **Claim:** The extVAE allows for flexible and non-stationary modeling of extremal dependence by allowing the tilting parameters θ to vary over time, capturing temporal changes in dependence structure.
- **Mechanism:** The decoder in the extVAE is parameterized to output different sets of tilting parameters θt for each time point, allowing the dependence structure to evolve over time. This is particularly useful for modeling processes where the strength of extremal dependence changes, such as under climate change scenarios.
- **Core assumption:** The extremal dependence structure of the spatial process varies over time and this variation can be captured by changes in the tilting parameters.
- **Evidence anchors:** [section] "The main advantage of our extVAE introduce in Section 3 is that it permits different θt = {θkt : k = 1, . . . , K} at different time t, t = 1, . . . , nt, which automatically gives us a temporally non-stationary spatial extremes model." [section] "Another promising direction of future work is to implement a conditional VAE (Sohn et al., 2015, CVAE) with the max-id model — we allow changes to the parameters for both the encoder and decoder (denoted by Θ) conditioning on different climate scenarios (radiative forcings, seasons, soil conditions, etc.)."
- **Break condition:** If the temporal changes in extremal dependence are not primarily captured by changes in the tilting parameters, or if the temporal resolution is too coarse, this mechanism may not accurately model the dependence structure.

## Foundational Learning

- **Concept: Variational Autoencoders (VAEs)**
  - Why needed here: VAEs provide the framework for efficient encoding of high-dimensional spatial data into a low-dimensional latent space and decoding to generate new samples, enabling fast emulation and uncertainty quantification.
  - Quick check question: What is the key difference between a standard autoencoder and a variational autoencoder?

- **Concept: Max-Stable and Max-Infinitely Divisible Processes**
  - Why needed here: These processes provide the theoretical foundation for modeling spatial extremes, capturing the joint tail behavior of extreme events.
  - Quick check question: What is the key difference between a max-stable process and a max-infinitely divisible process in terms of their extremal dependence properties?

- **Concept: Spatial Statistics and Dependence Measures**
  - Why needed here: Understanding spatial dependence measures like the extremal coefficient and the bivariate measure χ is crucial for characterizing and validating the model's ability to capture complex spatial dependence structures.
  - Quick check question: How does the extremal coefficient V(1,...,1) differ for a max-stable process compared to a max-infinitely divisible process?

## Architecture Onboarding

- **Component map:** Encoder (MLP) -> Latent Space (max-id process) -> Decoder (MLP with max-id process) -> Spatial Domain
- **Critical path:**
  1. Encode spatial data to latent space using the encoder.
  2. Sample from the latent distribution using the reparameterization trick.
  3. Decode latent variables to spatial domain using the decoder with the max-id process.
  4. Calculate the ELBO and update model parameters using stochastic gradient descent.
- **Design tradeoffs:**
  - Choice of K (number of knots/latent dimensions): Higher K allows for more complex dependence structures but increases computational cost and risk of overfitting.
  - Choice of basis functions: Compactly supported Wendland basis functions induce local dependence and long-range independence, while non-compactly supported functions (e.g., Gaussian) lead to different dependence properties.
  - Time-varying vs. time-invariant parameters: Time-varying parameters allow for more flexible modeling of temporal changes but increase model complexity.
- **Failure signatures:**
  - Poor reconstruction of spatial fields: May indicate insufficient model capacity or inappropriate choice of basis functions.
  - Underestimation of tail dependence: May indicate that the max-id process is not capturing the heavy-tailed nature of the data.
  - Unstable training: May indicate issues with the optimization algorithm or choice of hyperparameters.
- **First 3 experiments:**
  1. Simulate data from a known max-stable process and train the extVAE to assess its ability to recover the true dependence structure.
  2. Vary the number of knots K and evaluate the impact on model performance and computational cost.
  3. Compare the extVAE's performance to a Gaussian process emulator on a dataset with known non-stationary extremal dependence.

## Open Questions the Paper Calls Out
- [inferred] How does the performance of the extVAE compare to other state-of-the-art spatial extremes models, such as the hierarchical transformed scale mixture model (HTSM) or the single-station conditional model (SSCM), when applied to the Red Sea surface temperature dataset?
- [explicit] How sensitive is the extVAE's performance to the choice of the number of knots (K) and the radius of the Wendland basis functions (r)?
- [explicit] How well does the extVAE capture the non-stationarity in the extremal dependence structure over time, and can it be used to make accurate predictions of future extreme events?

## Limitations
- Performance primarily evaluated on simulated data and one real-world dataset (Red Sea SST), limiting generalizability to other spatial extremes applications.
- Computational complexity with increasing dimensionality and knot number not fully explored, potentially limiting scalability.
- Hyperparameter choices (e.g., number of latent dimensions, neural network architecture) significantly impact performance but are not extensively discussed or optimized.

## Confidence
- **High Confidence:** The extVAE framework's ability to efficiently emulate spatial extremes data and capture non-stationary dependence structures is well-supported by simulation results and application to the Red Sea SST dataset.
- **Medium Confidence:** The model's performance compared to traditional Bayesian inference and spatial extremes models with stationary dependence structures is demonstrated, but further validation on diverse datasets is needed.
- **Low Confidence:** The generalizability of the extVAE to different types of spatial extremes data, such as precipitation or wind speed, and its performance in handling missing data or varying spatial resolutions are not fully explored.

## Next Checks
1. Evaluate the extVAE's performance on multiple real-world datasets with varying spatial resolutions, missing data patterns, and types of spatial extremes (e.g., precipitation, wind speed).
2. Conduct a sensitivity analysis to assess the impact of hyperparameter choices (e.g., K, neural network architecture) on the model's performance and computational cost.
3. Compare the extVAE's performance to state-of-the-art spatial extremes models in terms of accuracy, computational efficiency, and ability to capture complex dependence structures on a benchmark dataset.