---
ver: rpa2
title: 'Deep learning in computed tomography pulmonary angiography imaging: a dual-pronged
  approach for pulmonary embolism detection'
arxiv_id: '2311.05197'
source_url: https://arxiv.org/abs/2311.05197
tags:
- detection
- branch
- image
- pulmonary
- classification
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study presents a dual-pronged approach for automated pulmonary
  embolism (PE) detection using deep learning techniques on computed tomography pulmonary
  angiography (CTPA) images. The proposed method combines an attention-guided convolutional
  neural network (AG-CNN) for classification with state-of-the-art object detection
  models for localization, enhanced by ensemble techniques.
---

# Deep learning in computed tomography pulmonary angiography imaging: a dual-pronged approach for pulmonary embolism detection

## Quick Facts
- arXiv ID: 2311.05197
- Source URL: https://arxiv.org/abs/2311.05197
- Reference count: 0
- Primary result: Dual-pronged deep learning approach achieving AUROC of 0.927 for classification and mAP of 0.846 for detection of pulmonary embolism

## Executive Summary
This study presents a comprehensive deep learning framework for automated pulmonary embolism detection in CTPA imaging. The proposed dual-pronged approach combines an attention-guided convolutional neural network (AG-CNN) for image-level classification with state-of-the-art object detection models for precise localization. The method employs ensemble techniques and a classifier-guided detection framework to reduce false positives while maintaining high sensitivity. The system demonstrates significant improvements over existing approaches, particularly in detecting small embolisms in peripheral arteries, with strong performance metrics across both classification and detection tasks.

## Method Summary
The method employs a dual-pronged approach combining classification and detection frameworks. For classification, an attention-guided CNN (AG-CNN) with global, local, and fusion branches uses an Inception-v3 backbone to achieve image-level PE detection. For localization, three state-of-the-art models (EfficientDet-D0, YOLOv8l, and Faster R-CNN) are combined using ensemble techniques including weighted bounding box fusion, non-maximum suppression, and normalized model weights. A classifier-guided detection approach gates the ensemble output based on the AG-CNN's probability score, retaining only high-confidence detections when the image-level classifier indicates likely PE presence. The system was trained and evaluated on the FUMPE dataset containing 8792 slices from 35 patients.

## Key Results
- AG-CNN classification achieved AUROC of 0.927, sensitivity of 0.862, specificity of 0.879, and F1-score of 0.805 on the FUMPE dataset
- Ensemble detection models attained mean average precision (mAP) of 0.846, sensitivity of 0.901, and F1-score of 0.779
- Classifier-guided detection approach improved precision by reducing false positives through probability-based gating
- The system significantly outperformed existing approaches, particularly for detecting small embolisms in peripheral arteries (67% of PE lesions in the dataset)

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Classifier-guided detection improves precision without sacrificing sensitivity
- Mechanism: The AG-CNN classifier output probabilistically gates the detection ensemble, allowing high-confidence detections only when the image-level classifier indicates likely PE presence. This reduces false positives from the sensitive but imprecise detection models.
- Core assumption: The image-level classifier has higher specificity than the detection models, making it a good filter for reducing false positives.
- Evidence anchors:
  - [abstract] "A classifier-guided detection approach further refined the results by reducing false positives, leading to improved precision."
  - [section] "If an image I has a prediction ğ‘ğ‘ğ‘ ğ‘“ğ‘“(ğ‘’ğ‘’ğ‘’ğ‘’ğ‘ğ‘ğ‘™ğ‘™ğ‘™ğ‘™ğ‘’ğ‘’ğ‘ ğ‘ ğ‘’ğ‘’|ğ¼ğ¼) â‰¥ Î¸, where Î¸ represents the threshold for binary classification, we keep all detected embolisms. However, if ğ‘ğ‘ğ‘ ğ‘“ğ‘“(ğ‘’ğ‘’ğ‘’ğ‘’ğ‘ğ‘ğ‘™ğ‘™ğ‘™ğ‘™ğ‘’ğ‘’ğ‘ ğ‘ ğ‘’ğ‘’|ğ¼ğ¼) < Î¸, only bounding boxes with a confidence score above 0.018 are considered."
  - [corpus] Weak corpus alignment - no direct mention of classifier-guided approaches in nearby papers.
- Break condition: If the classifier's specificity drops below the detection models' specificity, this gating approach would increase false negatives and reduce overall accuracy.

### Mechanism 2
- Claim: Attention-guided architecture improves classification by focusing on both global context and local lesion regions
- Mechanism: The AG-CNN uses a three-branch architecture where the local branch crops and analyzes lesion regions identified by an attention mask, while the global branch processes the entire image. The fusion branch combines these complementary views to make more accurate decisions than either branch alone.
- Core assumption: PE lesions contain distinctive local features that are not fully captured by global image analysis alone, and these features are important for accurate classification.
- Evidence anchors:
  - [abstract] "Our classification system includes an Attention-Guided Convolutional Neural Network (AG-CNN) that uses local context by employing an attention mechanism."
  - [section] "The local branch focuses on the lesion area, which is expected to alleviate the drawbacks of only using the global image. The local branch uses the same network architecture as the global branch, but their weights are not shared due to their different roles in the model."
  - [corpus] Weak evidence - while corpus papers discuss PE detection, none specifically mention attention-guided architectures or the global-local fusion approach.
- Break condition: If PE lesions do not have distinctive local features that differ from normal tissue, or if the attention mechanism fails to identify the correct lesion regions, the local branch would add noise rather than useful information.

### Mechanism 3
- Claim: Ensemble of diverse detection models improves detection accuracy, especially for small peripheral embolisms
- Mechanism: Combining predictions from EfficientDet, YOLOv8, and Faster R-CNN through weighted box fusion leverages each model's strengths - EfficientDet's sensitivity, YOLOv8's speed, and Faster R-CNN's precision - resulting in better overall detection performance than any single model.
- Core assumption: The three detection models make different types of errors, and their errors are complementary rather than redundant.
- Evidence anchors:
  - [abstract] "For detection, state-of-the-art models are employed to pinpoint potential PE regions. Different ensembling techniques further improve detection accuracy by combining predictions from different models."
  - [section] "The purpose of selecting these three diverse models is to ensure that their performances complement each other, leading to more robust and improved results when combined in an ensemble."
  - [corpus] Moderate evidence - corpus papers discuss various detection approaches but don't specifically mention ensemble methods for PE detection.
- Break condition: If the detection models make similar errors (e.g., all miss small peripheral embolisms or all produce false positives in similar regions), ensembling would not provide significant improvement and could even amplify errors.

## Foundational Learning

- Concept: Pulmonary Embolism pathology and CTPA imaging fundamentals
  - Why needed here: Understanding PE as a vascular obstruction condition and CTPA as the imaging modality is essential for interpreting the problem domain and evaluation metrics
  - Quick check question: What distinguishes a PE filling defect from other causes of contrast opacification in pulmonary arteries?

- Concept: Deep learning classification vs detection paradigms
  - Why needed here: The paper employs both classification (image-level PE presence) and detection (lesion localization) approaches, requiring understanding of when to use each and how they complement each other
  - Quick check question: Why would you use a classification model before a detection model in a clinical workflow?

- Concept: Ensemble methods and model fusion techniques
  - Why needed here: The detection performance improvement comes from combining multiple model outputs using WBF, NMS, and NMW techniques, which require understanding of how different fusion strategies affect precision and recall
  - Quick check question: How does Weighted Bounding Box Fusion differ from traditional Non-Maximum Suppression in handling overlapping detections?

## Architecture Onboarding

- Component map: CTPA image â†’ windowing (40/400 HU) â†’ patient-wise splitting â†’ augmentation â†’ AG-CNN (global branch + local branch + fusion branch) â†’ binary PE prediction â†’ detection ensemble (EfficientDet-D0 + YOLOv8l + Faster R-CNN) â†’ WBF/NMS/NMW â†’ classifier-guided filtering â†’ final output
- Critical path: CTPA image â†’ AG-CNN classification â†’ detection ensemble â†’ classifier-guided filtering â†’ final output
- Design tradeoffs: Higher sensitivity in detection models leads to more false positives, requiring classifier gating; attention mechanism adds complexity but improves performance; ensemble improves accuracy but increases computational cost
- Failure signatures: Poor classifier specificity leads to excessive false positives; attention mask fails to identify lesions; ensemble doesn't improve over individual models; classifier-guided approach removes true positives
- First 3 experiments:
  1. Test AG-CNN with only global branch vs only local branch to quantify attention benefit
  2. Evaluate each detection model individually to identify strengths/weaknesses before ensembling
  3. Test classifier-guided detection with different probability thresholds to find optimal precision-sensitivity balance

## Open Questions the Paper Calls Out
- [inferred] The paper mentions that the model may confuse PE with other pathologies and would benefit from being tested on datasets containing various lung pathologies to evaluate generalizability and ability to differentiate PE from other conditions.
- [inferred] The paper notes that models don't utilize information from preceding or subsequent image slices when identifying PE, which occasionally leads to missed embolisms in certain slices, suggesting that incorporating contextual information from adjacent CT slices could affect detection accuracy of small peripheral embolisms.
- [explicit] The paper employed three ensembling techniques with specific weight distributions based on individual model mAP scores, but this was heuristic rather than optimized, indicating that systematic optimization of ensemble method and model weight distribution for clinical performance would be valuable.

## Limitations
- The FUMPE dataset used is not publicly available, limiting reproducibility and independent validation of the results
- The study used a dataset providing patient data regarding only the PE condition in the lungs, and the model may confuse PE with other pathologies due to lack of diverse pathological conditions in the training data
- The small patient cohort (35 patients) relative to the complex model architectures employed raises concerns about potential overfitting and generalizability to broader clinical populations

## Confidence
- **High confidence**: The dual-pronged approach concept (combining classification with detection) and the general framework architecture are well-established and logically sound
- **Medium confidence**: The specific performance metrics (AUROC 0.927, mAP 0.846) are plausible given the methodology but may be dataset-specific and not generalizable
- **Low confidence**: The attention mechanism implementation details and ensemble method hyperparameters are insufficiently specified for exact replication

## Next Checks
1. **Dataset generalizability test**: Evaluate the trained models on an independent PE-CTPA dataset to assess whether the reported performance metrics hold across different institutions and acquisition protocols
2. **Ablation study**: Systematically remove the attention mechanism and classifier-guided detection to quantify their individual contributions to overall performance improvements
3. **Clinical workflow simulation**: Test the complete pipeline on realistic clinical scenarios with varying PE prevalence rates to assess real-world sensitivity and specificity trade-offs