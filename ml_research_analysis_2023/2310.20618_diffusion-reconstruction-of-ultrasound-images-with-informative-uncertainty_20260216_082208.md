---
ver: rpa2
title: Diffusion Reconstruction of Ultrasound Images with Informative Uncertainty
arxiv_id: '2310.20618'
source_url: https://arxiv.org/abs/2310.20618
tags:
- ultrasound
- image
- images
- diffusion
- drus
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a novel approach for ultrasound image reconstruction
  using denoising diffusion restoration models (DDRMs). The authors adapt DDRMs to
  the specific challenges of ultrasound imaging by incorporating a linear direct model
  and fine-tuning the diffusion model on ultrasound data.
---

# Diffusion Reconstruction of Ultrasound Images with Informative Uncertainty

## Quick Facts
- arXiv ID: 2310.20618
- Source URL: https://arxiv.org/abs/2310.20618
- Reference count: 37
- Key outcome: Proposes DDRM-based ultrasound reconstruction achieving high-quality images from single plane wave inputs, with variance-based uncertainty quantification improving contrast and SNR.

## Executive Summary
This paper presents a novel approach for ultrasound image reconstruction using denoising diffusion restoration models (DDRMs). The authors adapt DDRMs to ultrasound imaging by incorporating a linear direct model and fine-tuning the diffusion model on ultrasound data. Their method, DRUS, demonstrates high-quality reconstructions from single plane wave inputs and introduces a variance-based uncertainty measure that enhances contrast and SNR while preserving resolution. The approach is validated on simulated, in-vitro, and in-vivo datasets with promising results.

## Method Summary
The method constructs a linear forward model H from acquisition parameters and applies beamforming projection B to measurements. An SVD of BH is computed to transform the reconstruction into a denoising problem. A pre-trained diffusion model is fine-tuned on a small dataset of high-quality ultrasound images. DDRM sampling (using DDIM) generates multiple stochastic reconstructions, whose mean and variance are computed to produce final images with uncertainty quantification.

## Key Results
- DRUS achieves high-quality reconstructions from single plane wave inputs, outperforming conventional methods
- Variance of multiple DRUS samples enhances contrast and SNR by reducing speckle noise
- Fine-tuning pre-trained diffusion models on small ultrasound datasets effectively adapts the model to ultrasound imaging characteristics

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Diffusion restoration models convert ultrasound reconstruction into a denoising problem via SVD of the forward model.
- Mechanism: The linear ultrasound forward model H is factored via SVD (H = U S Vᵀ). The measurements are projected onto the orthogonal basis, yielding a transformed problem equivalent to denoising with additive Gaussian noise.
- Core assumption: The forward model can be approximated as a linear, time-invariant system with white Gaussian noise after beamforming projection.
- Evidence anchors:
  - [section II-C]: "Different from DDPMs, the Markov chain in DDRM is defined in the spectral space of the degradation operator Hd. To this end, DDRM leverages the Singular Value Decomposition (SVD): Hd = UdSdVTd..."
  - [abstract]: "...adapt Denoising Diffusion Restoration Models (DDRM) to incorporate ultrasound physics through a linear direct model..."
- Break condition: If the projection matrix B does not adequately approximate the forward model, the transformed noise will not be white Gaussian, violating the denoising assumption.

### Mechanism 2
- Claim: Variance of multiple DRUS samples enhances contrast and SNR by reducing speckle noise.
- Mechanism: Multiple stochastic reconstructions from DRUS yield samples whose variance is inversely related to the true reflectivity o. Taking the empirical variance image suppresses speckle patterns while preserving structural edges, effectively acting as a despeckling filter.
- Core assumption: The generative uncertainty of DRUS samples follows a normal distribution with variance proportional to the square of the underlying reflectivity.
- Evidence anchors:
  - [section IV-A.2]: "The variance of the histograms exhibit interesting patterns: within the hyperechoic regions...the histogram's mean rapidly goes up at the scatterer, accompanied by a significant increase in variance."
  - [section V]: "DRUSVar exibhits good performance both in terms of resolution and contrast, but the absence of speckle texture may be a drawback..."
- Break condition: If the diffusion model's sampling is not sufficiently stochastic or if the forward model error is large, the variance will not correlate with speckle noise, breaking the enhancement effect.

### Mechanism 3
- Claim: Fine-tuning a pre-trained diffusion model on small ultrasound datasets mitigates the domain gap while avoiding the need for large paired datasets.
- Mechanism: A diffusion model pre-trained on ImageNet captures generic image structures. Fine-tuning on a small set of high-quality ultrasound images adapts the model to the ultrasound speckle and contrast patterns without requiring paired low-high quality data.
- Core assumption: Features learned from natural images transfer to medical ultrasound images after modest fine-tuning.
- Evidence anchors:
  - [section III-A]: "Our experiments are based on three unconditional diffusion models...both fine-tuned from the same checkpoint...The sole distinction between these models lies in their respective fine-tuning datasets."
  - [corpus]: No direct corpus evidence; the claim is based on the authors' experimental setup and assumption about transfer learning.
- Break condition: If the ultrasound image statistics differ too greatly from natural images, fine-tuning will not sufficiently close the domain gap, leading to poor reconstructions.

## Foundational Learning

- Concept: SVD-based dimensionality reduction in linear inverse problems
  - Why needed here: To transform the ultrasound reconstruction into a denoising problem amenable to DDRM.
  - Quick check question: How does projecting measurements via the beamforming matrix B reduce the problem size before SVD?

- Concept: Stochastic sampling in diffusion models
  - Why needed here: To generate multiple samples whose variance can be used for despeckling and uncertainty quantification.
  - Quick check question: What property of the diffusion sampling process ensures that multiple samples capture the generative uncertainty?

- Concept: Ultrasound physics: linear propagation and speckle formation
  - Why needed here: To justify the linear forward model and interpret the variance-based despeckling.
  - Quick check question: Why is speckle in ultrasound considered multiplicative noise, and how does this relate to the variance of DRUS samples?

## Architecture Onboarding

- Component map:
  - Forward model construction (H, B matrices) -> SVD projection and transformed measurements -> Pre-trained diffusion model (fine-tuned on ultrasound) -> DDRM sampling loop (DDIM-based) -> Post-processing (mean/variance aggregation)

- Critical path:
  1. Build H from acquisition parameters.
  2. Apply beamforming projection B to form By.
  3. Compute SVD of BH → S, U, V.
  4. Transform data: y = S†UTBy.
  5. Sample DRUS (multiple times if variance desired).
  6. Invert transform: o = VTo.

- Design tradeoffs:
  - SVD computation vs. storage: Full SVD is expensive; approximated via projection.
  - Sampling iterations: More iterations → better quality but higher compute.
  - Sample count: More samples → better variance estimate but higher runtime.

- Failure signatures:
  - Low CNR or SNR improvement: Possible SVD approximation error or poor diffusion model fine-tuning.
  - Loss of resolution in variance images: Too few samples or incorrect variance scaling.
  - Artifacts in reconstructions: Incorrect forward model or mismatched noise assumptions.

- First 3 experiments:
  1. Reconstruct a single plane-wave image using DRUS with 50 iterations; compare to DAS.
  2. Generate 10 DRUS samples for the same input; compute mean and variance; compare metrics.
  3. Vary the number of sampling iterations (e.g., 20, 50, 100) and observe convergence of metrics.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the statistical model relating DRUSVar to the echogenicity map be refined to better account for the observed discrepancies in low reflectivity regions?
- Basis in paper: [explicit] The paper proposes an empirical model (Eq. 11) to characterize the statistical behavior of DRUS, showing that DRUSVar approximates the echogenicity map. However, it notes that DRUSVar struggles to capture low reflectivity values in certain regions.
- Why unresolved: The current model uses a fixed empirical parameter (β = 0.5) and does not fully account for variations in image content or acquisition parameters.
- What evidence would resolve it: Developing and validating an improved statistical model with adaptive parameters, tested across diverse ultrasound datasets and imaging scenarios.

### Open Question 2
- Question: How can the computational efficiency of DRUS be improved to enable real-time ultrasound imaging applications?
- Basis in paper: [explicit] The paper notes that DRUS is slower than several other techniques and that the current implementation requires multiple multiplications with the singular vector matrix, hindering real-time performance.
- Why unresolved: The paper does not explore optimization strategies for the SVD decomposition or alternative sampling methods that could reduce computational complexity.
- What evidence would resolve it: Demonstrating a real-time implementation of DRUS with significantly reduced computational time, validated through clinical or experimental benchmarks.

### Open Question 3
- Question: What is the optimal number of samples for DRUSVar to achieve the best balance between despeckling, contrast enhancement, and resolution preservation?
- Basis in paper: [inferred] The paper shows that DRUSVar improves SNR and contrast but notes that the optimal sampling count may vary depending on the dataset and imaging task.
- Why unresolved: The experiments use a fixed number of samples (10) for DRUSVar, but the paper does not systematically explore how this parameter affects image quality across different scenarios.
- What evidence would resolve it: A comprehensive study evaluating the impact of sampling count on DRUSVar performance across diverse ultrasound datasets, identifying an optimal trade-off for different applications.

## Limitations

- The linear forward model assumption may not fully capture complex ultrasound physics
- Fine-tuning effectiveness on small datasets is assumed but not extensively validated
- Computational efficiency is limited, hindering real-time applications

## Confidence

High: SVD-based dimensionality reduction and variance-based despeckling mechanisms
Medium: Fine-tuning pre-trained models on small ultrasound datasets
Low: Transferability of natural image features to ultrasound imaging

## Next Checks

1. Test the SVD approximation error: Compute the reconstruction error when using approximated vs. full SVD on synthetic data with known ground truth, and quantify the impact on image quality metrics.

2. Validate the diffusion model fine-tuning: Compare reconstructions using models fine-tuned on small ultrasound datasets against those trained from scratch on larger datasets, measuring both image quality and computational efficiency.

3. Analyze the variance-despeckling relationship: Conduct controlled experiments varying the number of samples and speckle levels, and verify whether the empirical variance consistently correlates with true reflectivity across different tissue types and imaging conditions.