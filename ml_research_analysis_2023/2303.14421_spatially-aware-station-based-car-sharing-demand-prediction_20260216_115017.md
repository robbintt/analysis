---
ver: rpa2
title: Spatially-aware station based car-sharing demand prediction
arxiv_id: '2303.14421'
source_url: https://arxiv.org/abs/2303.14421
tags:
- car-sharing
- demand
- spatial
- prediction
- station
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study addresses long-term car-sharing demand prediction using
  spatially-aware machine learning models. The research analyzes average monthly demand
  at 1,641 car-sharing stations in Switzerland, incorporating socio-demographic, geographic,
  and car-sharing-specific features from multiple data sources.
---

# Spatially-aware station based car-sharing demand prediction

## Quick Facts
- arXiv ID: 2303.14421
- Source URL: https://arxiv.org/abs/2303.14421
- Reference count: 22
- Best model achieves R² = 0.87 for monthly car-sharing demand prediction

## Executive Summary
This study addresses long-term car-sharing demand prediction using spatially-aware machine learning models. The research analyzes average monthly demand at 1,641 car-sharing stations in Switzerland, incorporating socio-demographic, geographic, and car-sharing-specific features from multiple data sources. The global Random Forest model with geographic coordinates achieves the highest predictive performance with an R-squared score of 0.87, while Geographically Weighted Regression performs almost on par at 0.87. Local models like GWR and MGWR provide valuable spatial insights into demand patterns, revealing that factors such as population density, public transport accessibility, and surrounding points of interest significantly influence car-sharing behavior. The models successfully predict demand for new station locations and can guide station planning decisions.

## Method Summary
The study compared global (OLS, RF) and local (GWR, MGWR, GRF) regression models for predicting monthly car-sharing demand across 1,641 Swiss stations. Data preprocessing involved spatial joins, Voronoi tessellation, and feature aggregation with 750m radii. Feature selection used LASSO regression and manual selection to address multicollinearity issues. Models were evaluated using 10-fold cross-validation with R-squared, RMSE, and AICc as metrics. The global Random Forest with geographic coordinates as input features achieved the best performance (R² = 0.87), while GWR and MGWR provided interpretable spatial insights despite slightly lower predictive accuracy.

## Key Results
- Global Random Forest with geographic coordinates achieves highest R² = 0.87
- GWR and MGWR perform almost on par with R² ≈ 0.87 while providing spatial insights
- Local models reveal spatially varying importance of factors like population density and public transport accessibility
- Models successfully predict demand for new station locations

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Spatial heterogeneity in car-sharing demand is effectively captured by local regression models like GWR.
- Mechanism: GWR fits separate regression models at each station using weighted least squares, where weights decrease with distance from the target station, allowing coefficients to vary spatially.
- Core assumption: Spatial autocorrelation exists such that nearby stations have similar demand patterns but with location-specific deviations.
- Evidence anchors:
  - [abstract]: "local methods such as Geographically Weighted Regression perform almost on par and additionally yield exciting insights into the heterogeneous spatial distributions of factors influencing car-sharing behaviour"
  - [section 4.1.2]: "Compared to global models, the GWR model allows parameters to vary spatially. For each station, a local regression model is fitted."
  - [corpus]: "The paper addresses the Vehicle Relocation Problem in free-floating car-sharing services by presenting a solution focused on strategies for repositioning vehicles and transferring personnel with the use of scooters. Our method begins by dividing the service area into zones that group regions with similar temporal pa..." (weak evidence - related to spatial zoning)
- Break condition: If spatial autocorrelation is weak or non-existent, GWR's performance advantage over global models would disappear.

### Mechanism 2
- Claim: Random Forest with geographic coordinates as features achieves high predictive performance by implicitly modeling spatial heterogeneity.
- Mechanism: The Random Forest algorithm creates decision trees that can partition the feature space in complex ways, including using geographic coordinates to create spatial splits that capture regional demand patterns.
- Core assumption: Non-linear relationships between geographic location and demand exist that can be captured through tree-based partitioning.
- Evidence anchors:
  - [abstract]: "global Random Forest model with geo-coordinates as part of input features achieves the highest predictive performance with an R-squared score of 0.87"
  - [section 4.1.4]: "we distinguish a special type of RF where the geographic coordinates are used as input features, such as the example in [Hengge et al., 2018]. This is motivated by the hypothesis that the random forest can capture spatial effects from the geographic coordinates."
  - [corpus]: "Efficient use of urban micromobility resources such as bike sharing is challenging due to the unbalanced station-level demand and supply, which causes the maintenance of the bike sharing systems painstaking." (weak evidence - related to spatial demand patterns)
- Break condition: If the geographic coordinate information is noisy or irrelevant, adding it to Random Forest would degrade rather than improve performance.

### Mechanism 3
- Claim: Feature selection through LASSO regularization prevents multicollinearity issues in local regression models.
- Mechanism: LASSO regression applies L1 regularization that shrinks coefficients toward zero, effectively performing feature selection by setting some coefficients exactly to zero, which is crucial for GWR where collinearity can be amplified locally.
- Core assumption: The original feature set contains correlated predictors that could cause instability in local regression coefficient estimates.
- Evidence anchors:
  - [section 4.2]: "To ensure reliable estimates of coefficients in the linear models (i.e., OLS regression, GWR, and MGWR), collinearity issues should be regarded [Wheeler and Tiefelsdorf, 2005]. Thus we used LASSO regression to select a subset of features."
  - [section 5.2.2]: "Table 2 refers to coefficient estimates of the essential features from the GWR model" (showing that meaningful coefficients were obtained)
  - [corpus]: No direct evidence in corpus - this is a standard statistical technique
- Break condition: If the feature set is already well-conditioned with low correlation, LASSO may unnecessarily reduce model complexity and predictive power.

## Foundational Learning

- Concept: Spatial autocorrelation and Tobler's first law of geography
  - Why needed here: Understanding that nearby locations tend to have similar characteristics is fundamental to why spatially-aware models work better for car-sharing demand
  - Quick check question: What does Tobler's first law state, and how does it justify using geographically weighted models?

- Concept: Random Forest algorithm and ensemble learning
  - Why needed here: Random Forest's ability to capture non-linear relationships and interactions makes it effective for demand prediction with mixed feature types
  - Quick check question: How does bootstrapping in Random Forest reduce overfitting compared to a single decision tree?

- Concept: Geographically Weighted Regression (GWR) mechanics
  - Why needed here: Understanding how GWR adapts regression coefficients spatially is crucial for interpreting results and diagnosing model performance
  - Quick check question: What is the role of the bandwidth parameter in GWR, and how does it affect the spatial scale of analysis?

## Architecture Onboarding

- Component map: Data preprocessing pipeline (Voronoi tessellation, spatial joins, feature aggregation) -> Model training framework (cross-validation, hyperparameter tuning) -> Model comparison metrics (R-squared, RMSE, AICc) -> Interpretability tools (SHAP values, coefficient visualization)
- Critical path: Data preprocessing → Feature selection → Model training → Cross-validation → Model comparison → Interpretation
- Design tradeoffs:
  - Global vs. local models: Global models (Random Forest) offer better predictive performance but less spatial interpretability; local models (GWR) provide spatial insights but may overfit
  - Feature aggregation scale: Smaller aggregation radii capture local variation but may increase noise; larger radii provide stability but may miss important local patterns
  - Model complexity vs. interpretability: More complex models (MGWR, Random Forest) may capture more patterns but are harder to interpret
- Failure signatures:
  - Poor cross-validation performance despite good training performance: likely overfitting, especially in local models
  - Extremely high variance in coefficient estimates across folds: indicates instability, possibly due to collinearity or insufficient local data
  - Unexpected coefficient signs or magnitudes: may indicate model misspecification or omitted variable bias
- First 3 experiments:
  1. Test the importance of geographic coordinates by comparing Random Forest with and without coordinates as features
  2. Vary the bandwidth parameter in GWR to observe its effect on R-squared and coefficient stability
  3. Test different kernel functions (Gaussian, Exponential, Bisquare) in GWR to identify which best captures the spatial structure of car-sharing demand

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal bandwidth selection technique for MGWR in demand prediction tasks, and how does it compare to AICc or cross-validation?
- Basis in paper: [explicit] The paper states "The model bandwidths were selected by minimizing the model AICc score, as recommended in literature" but also notes "Other bandwidth selection techniques, like cross-validation or the choice of other information criteria, were not tested due to missing software support."
- Why unresolved: Different bandwidth selection methods may significantly impact MGWR performance and predictive accuracy, yet the paper only tested AICc-based selection.
- What evidence would resolve it: Empirical comparison of MGWR performance using AICc, cross-validation, and other information criteria on the same dataset.

### Open Question 2
- Question: How do non-return trips affect the spatial distribution and prediction accuracy of car-sharing demand models?
- Basis in paper: [inferred] The paper filtered out non-return trips (over 99.3% were return trips) and focused on return-trip data, but acknowledges that "the user demand in a one-way car-sharing system may differ significantly."
- Why unresolved: The study's models were trained exclusively on return-trip data, potentially limiting their applicability to one-way systems where spatial patterns may differ substantially.
- What evidence would resolve it: Comparison of spatial patterns and prediction accuracy between models trained on return-trip data versus one-way trip data.

### Open Question 3
- Question: What is the optimal number and spatial distribution of car-sharing stations to maximize system efficiency while minimizing internal competition?
- Basis in paper: [explicit] The paper analyzes "the number of competing cars" as a feature and shows spatial variations in GWR coefficients, but does not optimize station placement.
- Why unresolved: While the paper identifies competition as an important factor, it does not determine optimal station density or placement strategies.
- What evidence would resolve it: Optimization framework that incorporates demand predictions, competition effects, and infrastructure constraints to determine optimal station locations.

## Limitations
- Proprietary dataset limits independent validation and generalizability to other contexts
- Temporal scope (monthly averages) excludes short-term demand fluctuations and seasonality
- Feature selection through LASSO may have excluded relevant variables due to correlation
- Geographic focus on Switzerland may not transfer to cities with different spatial patterns

## Confidence
- High confidence: The comparative performance ranking of models (Random Forest with coordinates > GWR ≈ MGWR > OLS) is well-supported by cross-validation results and consistent with the spatial autocorrelation mechanism.
- Medium confidence: The spatial insights from GWR coefficient patterns are valid but may be sensitive to bandwidth selection and kernel choice, which weren't fully explored.
- Low confidence: The generalization of findings to different geographic contexts or car-sharing systems with different operational characteristics remains uncertain.

## Next Checks
1. **Geographic transfer test**: Apply the best-performing models to car-sharing data from a different country/region to assess generalizability and identify which features transfer across contexts.
2. **Temporal robustness check**: Re-run the analysis using weekly or daily aggregated demand to determine if the spatial patterns hold at different temporal resolutions.
3. **Spatial sensitivity analysis**: Systematically vary the bandwidth parameter in GWR and MGWR across a wider range to identify optimal values and assess stability of coefficient estimates.