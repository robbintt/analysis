---
ver: rpa2
title: Learning Spatially-Continuous Fiber Orientation Functions
arxiv_id: '2312.05721'
source_url: https://arxiv.org/abs/2312.05721
tags:
- fenri
- tractography
- fixed-net
- data
- dwis
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces FENRI, a deep learning model that learns
  spatially-continuous fiber orientation density functions from low-resolution diffusion-weighted
  images. FENRI addresses the challenge of reconstructing detailed neural pathways
  in tractography, which is typically limited by the resolution and quality of diffusion
  MRI data.
---

# Learning Spatially-Continuous Fiber Orientation Functions

## Quick Facts
- arXiv ID: 2312.05721
- Source URL: https://arxiv.org/abs/2312.05721
- Reference count: 0
- Primary result: FENRI, a deep learning model that learns spatially-continuous fiber orientation density functions from low-resolution diffusion-weighted images, outperforms existing super-resolution methods in reconstructing fiber orientations and improves tractography results.

## Executive Summary
This paper introduces FENRI, a deep learning model designed to learn spatially-continuous fiber orientation density functions (fODFs) from low-resolution diffusion-weighted images (DWIs). FENRI addresses the challenge of reconstructing detailed neural pathways in tractography, which is typically limited by the resolution and quality of diffusion MRI data. By using an explicit neural representation to predict fiber orientations at arbitrary spatial coordinates, FENRI allows for continuous sampling, improving tractography results over discrete grid methods. Experiments demonstrate that FENRI outperforms existing super-resolution methods in reconstructing fiber orientations from degraded HCP data and achieves improved tractography results compared to trilinear interpolation, particularly in smaller white matter bundles.

## Method Summary
FENRI uses a Cascading Residual Network (CARN) encoder to compress input DWIs, followed by a continuous decoder (fully connected network with Fourier positional encoding) that predicts SH coefficients at arbitrary spatial coordinates using local ensemble sampling from 2x2x2 nearest neighbors. The model is trained on degraded HCP data with weighted mean-squared error (WMSE) loss for 100-200 epochs, validating on a validation set. The primary objective is to super-resolve low-resolution DWIs to reconstruct continuous fODFs for improved tractography.

## Key Results
- FENRI better reconstructs high-degree SH coefficients and produces more accurate ODFs compared to ESPCN-based Fixed-Net.
- FENRI improves tractography results over trilinear interpolation, particularly in smaller white matter bundles.
- The expanded simulated dataset introduced for evaluation demonstrates the model's effectiveness across diverse scenarios.

## Why This Works (Mechanism)

### Mechanism 1
- Claim: FENRI enables continuous sampling of fiber orientations, improving tractography over discrete grid methods.
- Mechanism: FENRI uses an explicit neural representation (INR-like) to predict SH coefficients at arbitrary spatial coordinates, allowing smooth interpolation between discrete DWI samples.
- Core assumption: The continuous function Gθ(S, P, q) = dq accurately represents the underlying fiber orientation field across the continuous space Ω.
- Evidence anchors:
  - [abstract] "Recent deep learning methods in super-resolving diffusion MRIs have focused on upsampling to a fixed spatial grid, but this does not satisfy tractography's need for a continuous field."
  - [section] "The decoder predicts SH coefficients at any given query point q ∈ Ω based on encoded features and the query coordinate itself..."
  - [corpus] Weak - no direct comparison to FENRI's continuous sampling approach in neighbors.
- Break condition: If the underlying fiber field has discontinuities too fine for the neural representation to capture, continuous sampling will introduce artifacts.

### Mechanism 2
- Claim: Local ensemble decoding with trilinear weighting smooths predictions when crossing discrete points.
- Mechanism: The decoder uses 8 nearest-neighbor features from the latent space, each passed through the same network, then trilinearly weighted for the final output.
- Core assumption: The 8 nearest-neighbor features adequately capture local variations in fiber orientation density.
- Evidence anchors:
  - [section] "As mentioned in Chen et. al., 2021 as the 'local ensemble', the features in L given to the decoder correspond to the 2 × 2 × 2 spatially nearest-neighbors to q..."
  - [abstract] "...the i'th input vector local to q, and its input coordinate pi."
  - [corpus] Weak - no direct mention of ensemble decoding in neighbors.
- Break condition: If fiber orientations change rapidly between grid points, 8 neighbors may be insufficient for accurate reconstruction.

### Mechanism 3
- Claim: FENRI outperforms fixed-grid upsampling methods in SH coefficient reconstruction quality.
- Mechanism: FENRI's continuous prediction captures high-frequency spatial and angular details better than discrete upsampling methods like ESPCN-based Fixed-Net.
- Core assumption: The continuous representation can model higher-degree SH coefficients more accurately than fixed-grid methods.
- Evidence anchors:
  - [section] "As shown in Figure 1A, FENRI gives high-quality predictions that preserve high frequency details, both in the spatial and angular sense."
  - [abstract] "Against Fixed-Net, FENRI better reconstructs the high degree SH coefficients and produces an overall more accurate OFD..."
  - [corpus] Weak - no direct comparison of FENRI vs. fixed-grid methods in neighbors.
- Break condition: If the training data lacks sufficient variability, FENRI may overfit to specific patterns and underperform on novel data.

## Foundational Learning

- Concept: Fiber Orientation Density Functions (fODFs) and Spherical Harmonics representation
  - Why needed here: FENRI predicts fODFs represented as SH coefficients, which are the standard for diffusion MRI tractography.
  - Quick check question: What do the degree l and order m parameters represent in spherical harmonics?

- Concept: Diffusion-weighted MRI (DWI) acquisition and preprocessing
  - Why needed here: FENRI takes low-resolution DWIs as input and must handle noise, motion artifacts, and gradient direction sampling.
  - Quick check question: How does angular undersampling (fewer gradient directions) affect fiber orientation estimation?

- Concept: Tractography algorithms and streamline tracking
  - Why needed here: FENRI's output is used for tractography, so understanding tracking methods and termination criteria is essential.
  - Quick check question: What is the difference between deterministic and probabilistic tractography?

## Architecture Onboarding

- Component map: DWI -> Encoder (CARN) -> Latent space features -> Decoder (local ensemble with Fourier positional encoding) -> SH coefficients -> Tractography
- Critical path: DWI → Encoder → Latent space features → Decoder (local ensemble) → SH coefficients → Tractography
- Design tradeoffs:
  - Continuous vs. fixed-grid prediction: Continuous allows arbitrary sampling but may be computationally heavier
  - Local ensemble size: More neighbors improve smoothness but increase computation
  - Encoder architecture: CARN chosen for SISR performance but may not be optimal for DWI features
- Failure signatures:
  - Checkerboard artifacts in predictions: May indicate issues with encoder upsampling layers
  - Poor tractography results: Could suggest decoder not capturing local fiber orientation variations
  - Overfitting on training data: May show as good reconstruction on training set but poor generalization
- First 3 experiments:
  1. Reconstruct SH coefficients on a single HCP subject with known ground truth, compare to trilinear interpolation
  2. Perform tractography on reconstructed data, visualize streamlines for qualitative assessment
  3. Evaluate on synthetic ISMRM-sim data with ground truth bundles for quantitative tractography metrics

## Open Questions the Paper Calls Out
None explicitly mentioned in the provided text.

## Limitations
- Architecture specifications for the CARN encoder and continuous decoder are not fully detailed, potentially affecting reproducibility.
- Training hyperparameters such as learning rate, batch size, and number of epochs are not provided, making exact replication challenging.
- Limited evaluation on diverse real-world datasets raises questions about the model's generalizability across different populations and imaging protocols.

## Confidence
- High Confidence: FENRI's ability to provide continuous sampling of fiber orientations.
- Medium Confidence: FENRI outperforms fixed-grid upsampling methods in SH coefficient reconstruction quality.
- Low Confidence: FENRI significantly improves tractography results compared to trilinear interpolation, particularly in smaller white matter bundles.

## Next Checks
1. Implement FENRI with detailed architectural specifications and compare its performance against the paper's results on a small test set.
2. Conduct experiments varying key training hyperparameters (e.g., learning rate, batch size) to determine their impact on model performance.
3. Evaluate FENRI's performance on an independent diffusion MRI dataset not used in the original training or validation.