---
ver: rpa2
title: Capturing Local Temperature Evolution during Additive Manufacturing through
  Fourier Neural Operators
arxiv_id: '2307.01804'
source_url: https://arxiv.org/abs/2307.01804
tags:
- temperature
- process
- neural
- additive
- manufacturing
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The authors develop a mesh-independent ML framework for predicting
  local temperature evolution during additive manufacturing. The model uses Fourier
  Neural Operator to focus on heat-affected zones near recent depositions, addressing
  the limitation of current models that achieve low mean squared error across the
  entire domain but may fail to accurately capture temperature changes in critical
  heat-affected zones.
---

# Capturing Local Temperature Evolution during Additive Manufacturing through Fourier Neural Operators

## Quick Facts
- arXiv ID: 2307.01804
- Source URL: https://arxiv.org/abs/2307.01804
- Reference count: 40
- Primary result: Mesh-independent ML framework using Fourier Neural Operators to predict local temperature evolution in heat-affected zones during additive manufacturing

## Executive Summary
This paper presents a data-driven approach to predict local temperature evolution during additive manufacturing using Fourier Neural Operators (FNOs). The model focuses on heat-affected zones (HAZs) near recent depositions, addressing the limitation of current models that achieve low mean squared error across entire domains but may fail to accurately capture temperature changes in critical HAZs. By incorporating heat source locations and local distances to cooling surfaces as input variables, and proposing an R-squared metric for evaluation, the authors demonstrate high-fidelity predictions that generalize to geometries not included in the training process.

## Method Summary
The authors develop a mesh-independent ML framework using Fourier Neural Operators to predict local temperature evolution during additive manufacturing. The method focuses on heat-affected windows around recent depositions, incorporating input variables such as current temperature, heat source locations, local distances to cooling surfaces, activation indicators, heat influx conditions, and boundary impact factors. The model is trained on numerical simulations for the Direct Energy Deposition process using a dataset generated through an automatic pipeline that creates geometric models with an autoregressive generative model, meshes them, and generates toolpaths. The FNO architecture operates on 11×11×11 voxel windows and is evaluated using a proposed R-squared metric that measures relative performance compared to using mean temperature as a prediction baseline.

## Key Results
- The model achieves R-squared values above 0.99 on held-out geometries, demonstrating high fidelity in capturing extreme local temperature variance
- The mesh-independent nature of FNOs allows the model to generalize to geometries not included in the training process
- The proposed R-squared metric provides a more accurate assessment of model performance for additive manufacturing temperature prediction than traditional MSE or NRMSE metrics

## Why This Works (Mechanism)

### Mechanism 1
Fourier Neural Operators enable mesh-independent temperature predictions by learning a mapping between function spaces rather than operating on discretized meshes. This allows the model to generalize across different resolutions and geometries without retraining, which is crucial for handling the varying resolutions and complex geometries common in additive manufacturing.

### Mechanism 2
Focusing on heat-affected windows rather than the entire domain improves model accuracy by prioritizing learning the dramatic temperature changes in these zones while ignoring stable, low-temperature areas. This reduces the effective parameter count and training data requirements while maintaining focus on the most critical temperature variations.

### Mechanism 3
The R-squared metric provides a more accurate assessment of model performance by measuring the proportion of variance in the ground truth explained by the model's predictions. This makes it more sensitive to the model's ability to capture temperature changes in heat-affected zones rather than just achieving low error in stable regions.

## Foundational Learning

- Concept: Fourier Neural Operators (FNOs)
  - Why needed here: Enable mesh-independent predictions crucial for handling varying resolutions and complex geometries in additive manufacturing
  - Quick check question: How does the computational complexity of FNOs compare to traditional mesh-based methods, and why is this important for real-time applications?

- Concept: Heat transfer in additive manufacturing
  - Why needed here: Understanding thermal physics is essential for designing appropriate input features and evaluating model performance
  - Quick check question: What physical factors determine the size of the heat-affected zone, and how do these relate to the characteristic radius formula used in the paper?

- Concept: Partial Differential Equations (PDEs) and their solutions
  - Why needed here: Temperature evolution is governed by PDEs, and understanding their properties helps in selecting appropriate numerical methods and machine learning approaches
  - Quick check question: How do boundary conditions affect the solution of heat transfer PDEs in additive manufacturing?

## Architecture Onboarding

- Component map: Input layer (heat-affected windows) -> Fourier transform module -> Linear transformation layers -> GELU activation -> Inverse Fourier transform -> Output layer (predicted temperature field) -> Evaluation (R² metric)

- Critical path: 1. Generate geometric models using SkexGen 2. Create hexahedral meshes and toolpaths 3. Run DGFEM simulations for ground truth 4. Preprocess data into heat-affected windows 5. Train FNO model 6. Validate on held-out geometries 7. Evaluate using R² metric

- Design tradeoffs:
  - Window size vs. computational efficiency: Larger windows capture more context but increase computation and data requirements
  - Spectral representation vs. spatial representation: FNOs offer mesh-independence but may struggle with very localized features
  - R² vs. MSE/NRMSE: R² focuses on capturing variance but may undervalue models with good overall accuracy

- Failure signatures:
  - Low R² values indicating failure to capture temperature variance in HAZs
  - High MSE on validation geometries suggesting overfitting to training data
  - Inconsistent predictions across similar geometries indicating lack of generalizability

- First 3 experiments:
  1. Train on a single geometry with varying window sizes to find optimal balance between context and efficiency
  2. Compare R² and MSE performance on validation geometries to understand the tradeoff between capturing variance and achieving low absolute error
  3. Test the model on geometries with extreme features (e.g., very thin walls or large overhangs) not present in the training set to assess generalizability limits

## Open Questions the Paper Calls Out

### Open Question 1
How does the model performance scale with the size and diversity of the training dataset? The paper notes potential overfitting when representative geometries are not included, but does not explore performance changes with larger or more diverse datasets due to computational constraints.

### Open Question 2
How does the inclusion of different toolpaths, power settings, and tool speeds affect the model's performance? The current method uses only one type of toolpath and consistent tool moving speed, while the authors acknowledge that including various toolpaths, power, and tool speeds is critical to improve model performance.

### Open Question 3
How does the proposed R² metric compare to other evaluation metrics in terms of capturing the model's ability to predict temperature changes in heat-affected zones? While the paper argues R² better captures HAZ performance, it does not provide a direct comparison with MSE and NRMSE in terms of their ability to measure this specific aspect.

## Limitations

- The model's performance evaluation relies on numerical simulations rather than experimental validation
- The heat-affected window approach may miss temperature interactions occurring outside the 11×11×11 voxel window
- The model has only been tested on Direct Energy Deposition process and may not generalize to other additive manufacturing processes

## Confidence

**High Confidence**: The FNO architecture's ability to provide mesh-independent predictions and the superiority of the R² metric for evaluating HAZ-specific performance are well-supported by the theoretical framework and experimental results within the simulation environment.

**Medium Confidence**: The generalizability of the model to real-world additive manufacturing scenarios is supported by testing on multiple geometries from the same generative model, but the absence of experimental validation limits the strength of this claim.

**Low Confidence**: The scalability of the heat-affected window approach to different additive manufacturing processes and its performance under varying material properties and process parameters are not thoroughly explored.

## Next Checks

1. Conduct physical experiments using the same geometries and process parameters to compare FNO predictions against actual temperature measurements from thermal cameras or embedded thermocouples.

2. Evaluate the model on a diverse set of industry-standard geometries (e.g., from the NIST AMBench dataset) that were not generated by the SkexGen model to assess true generalizability.

3. Test the model's performance when process parameters (deposition speed, power, etc.) are varied significantly from the training conditions to identify the limits of the model's applicability.