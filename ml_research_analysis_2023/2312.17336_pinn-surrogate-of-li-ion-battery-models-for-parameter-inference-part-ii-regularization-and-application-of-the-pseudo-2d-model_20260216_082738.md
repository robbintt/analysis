---
ver: rpa2
title: 'PINN surrogate of Li-ion battery models for parameter inference. Part II:
  Regularization and application of the pseudo-2D model'
arxiv_id: '2312.17336'
source_url: https://arxiv.org/abs/2312.17336
tags:
- pinn
- parameter
- data
- battery
- surrogate
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: A physics-informed neural network (PINN) was developed as a surrogate
  model for the pseudo-2D (P2D) Li-ion battery model to accelerate Bayesian parameter
  inference. Additional regularization was needed for the P2D surrogate compared to
  the single-particle model (SPM) developed in Part I, including secondary conservation
  constraints and multi-fidelity hierarchical training.
---

# PINN surrogate of Li-ion battery models for parameter inference. Part II: Regularization and application of the pseudo-2D model

## Quick Facts
- arXiv ID: 2312.17336
- Source URL: https://arxiv.org/abs/2312.17336
- Reference count: 40
- Key outcome: PINN P2D surrogate achieved 2250x speedup for Bayesian parameter inference, with 10mV error in low-data scenarios

## Executive Summary
This paper extends a previous study on using physics-informed neural networks (PINNs) as surrogates for Li-ion battery models by developing a PINN surrogate for the more complex pseudo-2D (P2D) model. The P2D surrogate incorporates additional regularization through secondary conservation constraints and employs multi-fidelity hierarchical training using a single-particle model (SPM) as the lower level. The resulting surrogate achieves significant computational speedup (2250x) compared to traditional numerical solvers while maintaining acceptable accuracy for parameter inference tasks.

## Method Summary
The authors developed a PINN surrogate for the P2D Li-ion battery model by encoding the governing electrochemical equations directly into the loss function. To address training challenges specific to the P2D model, they implemented secondary conservation constraints (charge and species conservation) as additional regularization terms and employed a multi-fidelity hierarchical training approach using the previously developed SPM surrogate as the first level. The PINN architecture was designed with gradient pathology blocks and strict initial condition enforcement, with inputs including time, spatial coordinates, and battery parameters, and outputs representing the state variables of the battery model.

## Key Results
- PINN P2D surrogate achieved 2250x computational speedup compared to traditional integrating methods
- Testing error was estimated at 2mV for SPM surrogate and 10mV for P2D surrogate in low-data availability scenarios
- Trained surrogates successfully identified internal battery parameters from voltage responses during discharge
- Secondary conservation constraints and hierarchical training were essential for P2D surrogate training success

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Physics-informed neural networks (PINNs) can serve as computationally efficient surrogates for complex Li-ion battery models, enabling faster Bayesian parameter inference.
- Mechanism: PINNs encode the governing equations of the P2D model directly into the loss function, ensuring the learned surrogate respects the underlying physics while being trained on sparse data. This allows rapid evaluation of the likelihood function needed for MCMC-based Bayesian calibration.
- Core assumption: The physics-informed loss can adequately constrain the neural network even when data is sparse, preventing trivial solutions.
- Evidence anchors:
  - [abstract] "A physics-informed neural network (PINN) is developed as a surrogate for the pseudo-2D (P2D) battery model calibration."
  - [section] "Using surrogates of higher fidelity models is critical to mitigate modeling error and better capture the effect of additional aging properties."
- Break condition: If the physics-informed loss is insufficient to prevent the PINN from converging to trivial solutions (e.g., near-zero gradients), the surrogate will fail to represent the true model dynamics.

### Mechanism 2
- Claim: Secondary conservation constraints are necessary to prevent training failure in PINNs for P2D models, which was not required for SPM models.
- Mechanism: Additional physics-based regularization terms enforce conservation of charge and species in the P2D model, guiding the PINN away from trivial solutions that satisfy the basic governing equations but not their physical consequences.
- Core assumption: The trivial failure mode in P2D PINNs arises from the inability to predict non-zero current densities, which can be corrected by enforcing secondary conservation laws.
- Evidence anchors:
  - [section] "To address the PINN P2D surrogate trivial failure mode, it is proposed here to use secondary conservation constraint equations."
  - [section] "Figure 2a illustrates the Base case error ε... the error observed is about 20 times higher as compared to errors from the SPM."
- Break condition: If the secondary conservation constraints are not properly weighted or formulated, the PINN may still converge to a trivial solution or become unstable during training.

### Mechanism 3
- Claim: Multi-fidelity hierarchical training significantly improves PINN accuracy for P2D models by leveraging lower-fidelity models as starting points.
- Mechanism: The SPM solution (a simpler model) is used as the first level in a hierarchy, with subsequent levels correcting and refining the solution to match the more complex P2D dynamics. This approach reduces the effective dimensionality of the training problem.
- Core assumption: The lower-fidelity model captures the essential spatiotemporal features needed to bootstrap the higher-fidelity model, reducing the complexity of the training problem.
- Evidence anchors:
  - [section] "The multi-fidelity hierarchical training proposed here uses the SPM surrogate trained with a linear Butler–V olmer formulation as the first level of the hierarchy."
  - [section] "Figure 3 shows that the best of the Base models did not outperform any of the HNN SPM Sec. Cons. models."
- Break condition: If the lower-fidelity model is too dissimilar from the higher-fidelity model, the hierarchical approach may not provide significant benefits or could even degrade performance.

## Foundational Learning

- Concept: Physics-informed neural networks (PINNs)
  - Why needed here: PINNs are the core surrogate model that replaces computationally expensive PDE solvers for Li-ion battery models, enabling rapid Bayesian parameter inference.
  - Quick check question: What is the primary advantage of using a PINN over a traditional numerical solver for parameter inference in Li-ion batteries?

- Concept: Bayesian parameter inference
  - Why needed here: The goal is to identify internal battery parameters from voltage responses, which requires exploring a high-dimensional parameter space using MCMC methods that benefit greatly from fast surrogate models.
  - Quick check question: Why is Bayesian calibration preferred over point-estimate methods when inferring battery parameters from voltage data?

- Concept: Hierarchical and multi-fidelity training
  - Why needed here: These techniques improve PINN training efficiency and accuracy by leveraging simpler models as starting points, which is critical given the complexity of P2D models and the sparsity of available data.
  - Quick check question: How does using a lower-fidelity model (like SPM) as the first level in a hierarchy help train a higher-fidelity PINN (like P2D)?

## Architecture Onboarding

- Component map: Input (time, spatial coordinates, parameters) -> PINN architecture with gradient pathology blocks -> Output (concentrations, potentials, currents) -> Physics-informed loss + data loss + secondary conservation regularization

- Critical path:
  1. Define P2D governing equations and secondary conservation constraints.
  2. Design PINN architecture with appropriate input/output structure.
  3. Implement physics-informed loss function with regularization.
  4. Generate training data (PDE solutions at key parameter points).
  5. Train PINN using hierarchical multi-fidelity approach.
  6. Validate PINN accuracy against PDE solutions.
  7. Deploy PINN for Bayesian parameter inference.

- Design tradeoffs:
  - Physics loss vs. data loss: Physics loss ensures physical consistency but may require more training data; data loss improves accuracy where data is available but may not generalize well.
  - Hierarchical vs. flat training: Hierarchical training can improve accuracy but adds complexity; flat training is simpler but may require more epochs.
  - Collocation points vs. computational cost: More collocation points improve accuracy but increase training time; fewer points reduce cost but may degrade performance.

- Failure signatures:
  - Trivial solutions: PINN predicts near-zero gradients and flat profiles, indicating insufficient physics regularization.
  - Overfitting: PINN performs well on training data but poorly on test data, suggesting too much emphasis on data loss.
  - Gradient pathologies: Training becomes unstable or slow, indicating issues with the neural network architecture or loss function formulation.

- First 3 experiments:
  1. Train a basic PINN for P2D without secondary conservation constraints to observe the trivial failure mode.
  2. Add secondary conservation constraints and compare training performance and accuracy.
  3. Implement hierarchical training with SPM as the first level and evaluate improvements in accuracy and training efficiency.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What specific regularization strategies would be most effective for training PINNs to accurately model P2D Li-ion battery dynamics in higher-dimensional parameter spaces?
- Basis in paper: [explicit] The paper discusses using secondary conservation constraints and hierarchical training for the P2D model, but notes that these approaches become more challenging as the number of parameters increases. The authors mention that tensor expansion of the parameter space and operator learning methods could potentially help.
- Why unresolved: The paper only demonstrates these methods for a 2D parameter space. Scaling to higher dimensions requires more sophisticated regularization techniques that are not yet fully developed or tested.
- What evidence would resolve it: Empirical studies comparing different regularization approaches (e.g., physics loss weighting, data augmentation, hierarchical training schemes) on PINNs trained to model P2D dynamics across parameter spaces of varying dimensions, with quantitative comparisons of accuracy and computational cost.

### Open Question 2
- Question: How can the accuracy of PINN surrogates for P2D Li-ion battery models be improved to reduce the model uncertainty in parameter inference?
- Basis in paper: [explicit] The paper notes that the P2D surrogate has higher model errors than the SPM surrogate, leading to higher uncertainty in parameter inference. The authors suggest that additional PDE data could help train a more accurate P2D surrogate.
- Why unresolved: The paper does not explore alternative training strategies or model architectures that could potentially reduce the error in the P2D surrogate. It also does not quantify the relationship between the amount of training data and the accuracy of the surrogate.
- What evidence would resolve it: Comparative studies of PINN architectures (e.g., different network depths, activation functions, regularization techniques) and training data strategies (e.g., adaptive sampling, multi-fidelity data) for the P2D model, with metrics on surrogate accuracy and parameter inference uncertainty.

### Open Question 3
- Question: What are the practical limitations and potential applications of using PINN surrogates for real-time battery diagnostics and control?
- Basis in paper: [explicit] The paper demonstrates that PINN surrogates can significantly accelerate Bayesian parameter inference, making it computationally feasible for real-time applications. However, it does not discuss the limitations of this approach or specific use cases.
- Why unresolved: The paper focuses on the technical aspects of training PINN surrogates and does not explore the practical implications of using them in real-world battery systems. Factors such as the impact of model uncertainty on control decisions, the computational requirements for online inference, and the generalizability of the surrogate to different battery chemistries and operating conditions are not addressed.
- What evidence would resolve it: Case studies of PINN surrogates being used for real-time battery diagnostics and control in various applications (e.g., electric vehicles, grid storage), with quantitative assessments of the benefits and limitations of this approach compared to traditional methods.

## Limitations
- The testing error of 10mV for the P2D surrogate in low-data scenarios may be insufficient for high-precision battery management systems
- The approach's generalizability to other battery chemistries and operating conditions beyond tested scenarios is uncertain
- The computational speedup (2250x) was achieved under specific conditions and may vary with different model complexities

## Confidence

- High confidence: The computational speedup achieved (2250x) and the basic feasibility of using PINNs for battery parameter inference
- Medium confidence: The effectiveness of secondary conservation constraints and hierarchical training for improving P2D surrogate accuracy
- Low confidence: Generalization to other battery chemistries and operating conditions not tested in this study

## Next Checks

1. Validate the P2D surrogate's accuracy across a wider range of C-rates and battery aging conditions to assess its generalizability beyond the tested scenarios.

2. Apply the developed methodology to different battery chemistries (e.g., LFP, NMC) to evaluate the framework's adaptability to varying electrochemical behaviors.

3. Test the surrogate's performance using experimental voltage data from physical battery cells, including noise and measurement uncertainties typical of real-world conditions.