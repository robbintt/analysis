---
ver: rpa2
title: Online Learning and Solving Infinite Games with an ERM Oracle
arxiv_id: '2307.01689'
source_url: https://arxiv.org/abs/2307.01689
tags:
- game
- algorithm
- player
- lemma
- where
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of designing computationally
  efficient learning algorithms for online learning and game solving with infinite
  hypothesis classes or action spaces. The authors propose using Empirical Risk Minimization
  (ERM) oracles, which are standard in stochastic learning, to develop algorithms
  that achieve finite or sublinear regret in the online classification setting, and
  converge to approximate equilibria in infinite games.
---

# Online Learning and Solving Infinite Games with an ERM Oracle

## Quick Facts
- **arXiv ID:** 2307.01689
- **Source URL:** https://arxiv.org/abs/2307.01689
- **Reference count:** 40
- **Primary result:** Proposes ERM oracle-based algorithms for online learning and infinite games with finite/sublinear regret and convergence to approximate equilibria.

## Executive Summary
This paper addresses the challenge of designing computationally efficient learning algorithms for online learning and game solving with infinite hypothesis classes or action spaces. The authors propose using Empirical Risk Minimization (ERM) oracles to develop algorithms that achieve finite or sublinear regret in the online classification setting, and converge to approximate equilibria in infinite games. The key insight is that ERM oracles can replace more computationally expensive Standard Optimal Algorithms (SOA) while still providing theoretical guarantees, provided the underlying concept class or game has bounded complexity dimensions.

## Method Summary
The paper presents algorithms that incrementally build a pool of hypotheses by querying the ERM oracle for a hypothesis consistent with all past observations. For online learning, it uses a "lazy multiplicative weights" update strategy, only updating the distribution over hypotheses when the current distribution makes an $\epsilon$-mistake on a new example. For games, it iteratively expands each player's action set by adding the support of an approximate equilibrium in the current finite subgame, using a variant of the double oracle algorithm. The algorithms rely on the assumption that the concept class or game has bounded Littlestone, threshold, or fat-threshold dimensions.

## Key Results
- Algorithms achieve finite regret in the realizable online learning setting and sublinear regret in the agnostic setting, with bounds in terms of the Littlestone and threshold dimensions.
- The same framework extends to computing approximate Nash equilibria in two-player zero-sum games and coarse correlated equilibria in multi-player general-sum games, using only best-response oracles.
- These results provide theoretical justification for the wide use of double oracle and multiple oracle algorithms in practice for solving large games.

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Using an ERM oracle instead of the Standard Optimal Algorithm (SOA) allows for computationally efficient online learning with finite or sublinear regret.
- **Mechanism:** The algorithm incrementally builds a pool of hypotheses by querying the ERM oracle for a hypothesis consistent with all past observations. It uses a "lazy multiplicative weights" update strategy, only updating the distribution over hypotheses when the current distribution makes an $\epsilon$-mistake on a new example.
- **Core assumption:** The concept class has finite Littlestone or threshold dimension, which bounds the number of hypotheses needed to cover all possible mistake patterns.
- **Break condition:** If the Littlestone or threshold dimension is infinite or too large, the number of ERM oracle calls grows exponentially, making the algorithm impractical.

### Mechanism 2
- **Claim:** The same ERM oracle framework extends to computing approximate equilibria in infinite games.
- **Mechanism:** Each player's utility function is treated as a concept class, and the ERM oracle becomes a best-response oracle. The algorithm iteratively expands each player's action set by adding the support of an approximate equilibrium in the current finite subgame, using a variant of the double oracle algorithm.
- **Core assumption:** The game has bounded fat-threshold dimension, ensuring that the iterative expansion of action sets converges in finite time.
- **Break condition:** If the fat-threshold dimension is infinite, the algorithm may not converge, as there could be no approximate equilibrium.

### Mechanism 3
- **Claim:** The ERM oracle framework unifies online learning and game solving, justifying the use of double oracle algorithms in practice.
- **Mechanism:** By casting both settings as ERM problems, the same algorithmic template (incremental hypothesis/action set expansion with oracle queries) applies. This reduces the gap between theory and practice by using realistic oracles.
- **Core assumption:** The computational efficiency of ERM oracles in practice matches their theoretical guarantees.
- **Break condition:** If ERM oracle calls are much more expensive than theory suggests, the practical advantage diminishes.

## Foundational Learning

- **Concept: Littlestone dimension**
  - Why needed here: It characterizes the optimal regret achievable by improper learners in online binary classification and bounds the number of hypotheses needed in the ERM oracle algorithm.
  - Quick check question: What is the Littlestone dimension of the class of thresholds on the real line? (Answer: Infinite)

- **Concept: Threshold dimension**
  - Why needed here: It is a related complexity measure that often gives tighter bounds than Littlestone dimension and is used to bound the regret of proper learners.
  - Quick check question: How does the threshold dimension relate to the VC dimension? (Answer: tr(H) ≤ 2Lit(H) and VC(H) ≤ min(Lit(H), tr(H)))

- **Concept: Fat-threshold dimension**
  - Why needed here: It extends the threshold dimension to real-valued games and characterizes the learnability of approximate equilibria.
  - Quick check question: What is the fat-threshold dimension of a game where each player has a finite action set? (Answer: Bounded by the number of actions)

## Architecture Onboarding

- **Component map:** ERM oracle -> Lazy Multiplicative Weights -> Action set expansion -> Dimension oracles
- **Critical path:** 1. Receive new example. 2. Query ERM oracle for consistent hypothesis if needed. 3. Update distribution over hypotheses (lazy). 4. Predict using the current distribution. 5. Repeat until regret bound is met.
- **Design tradeoffs:** Using ERM oracles trades off computational efficiency for potentially looser regret bounds compared to SOA. Lazy updates reduce computation but may slow convergence. Incremental action set expansion balances between computational cost and approximation quality.
- **Failure signatures:** Exponential growth in oracle calls indicates high complexity dimension. Sublinear regret not achieved suggests dimension bounds are too loose or implementation has bugs. Non-convergence in games indicates fat-threshold dimension may be too large or stopping condition is wrong.
- **First 3 experiments:** 1. Run on a simple concept class (e.g., thresholds) and verify finite mistake bound. 2. Test on a small game (e.g., matching pennies) and check convergence to approximate equilibrium. 3. Vary $\epsilon$ and observe the tradeoff between oracle calls and approximation quality.

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** Can the algorithms for online learning and game solving be extended to handle non-realizable settings with agnostic data?
- **Basis in paper:** The paper discusses online learning in both realizable and agnostic settings, and game solving in both binary-valued and real-valued games. However, the agnostic setting is only addressed for online learning, not for game solving.
- **Why unresolved:** The paper does not provide algorithms or theoretical results for solving games in the agnostic setting.
- **What evidence would resolve it:** Development of algorithms for solving games with agnostic data, along with theoretical guarantees on their performance.

### Open Question 2
- **Question:** Can the dimension bounds for the mixed-strategy game be further tightened, especially for the sequential fat-shattering dimension?
- **Basis in paper:** The paper provides bounds on the dimensions of the mixed-strategy game, but acknowledges that these bounds might not be tight.
- **Why unresolved:** The paper does not provide matching lower bounds for the dimensions of the mixed-strategy game.
- **What evidence would resolve it:** Development of matching lower bounds for the dimensions of the mixed-strategy game, or algorithms that achieve better performance than predicted by the current bounds.

### Open Question 3
- **Question:** Can the algorithms be extended to handle games with more than two players, or games with non-zero-sum payoffs?
- **Basis in paper:** The paper focuses on two-player zero-sum games and multi-player general-sum games. However, the algorithms and theoretical results are not directly applicable to games with more than two players or non-zero-sum payoffs.
- **Why unresolved:** The paper does not provide algorithms or theoretical results for solving games with more than two players or non-zero-sum payoffs.
- **What evidence would resolve it:** Development of algorithms for solving games with more than two players or non-zero-sum payoffs, along with theoretical guarantees on their performance.

## Limitations

- The algorithms may require exponentially many ERM oracle calls when the complexity dimensions are infinite or extremely large.
- The paper assumes access to exact ERM oracles, which may not be computationally feasible for complex hypothesis classes in practice.
- The extension from binary classification to multi-class or structured prediction settings remains unexplored.

## Confidence

**High Confidence:**
- The theoretical framework connecting ERM oracles to regret bounds via complexity dimensions is sound and well-supported by proofs.
- The reduction of game equilibrium computation to ERM oracle queries is valid under the fat-threshold dimension assumption.

**Medium Confidence:**
- The practical advantage of ERM oracles over SOA is justified theoretically, but real-world computational trade-offs are not empirically validated.
- The extension of results to agnostic settings relies on assumptions about the learnability of the hypothesis class that may not hold universally.

**Low Confidence:**
- The paper's claim that these results "provide justification for the wide use of double oracle and multiple oracle algorithms in practice" is more aspirational than empirically grounded, as no empirical validation is provided.

## Next Checks

1. **Empirical Scaling Test:** Implement the algorithms on concept classes with known (and varied) Littlestone dimensions, measuring actual oracle call counts versus theoretical bounds to validate the dimension-oracle relationship.

2. **Dimension Estimation Experiment:** For games with known equilibrium computation complexity, estimate the fat-threshold dimension and verify whether the predicted iteration count matches empirical convergence behavior.

3. **Oracle Efficiency Comparison:** Compare the computational cost of ERM oracle implementations versus SOA implementations on representative problems to quantify the practical trade-off between oracle efficiency and regret bounds.