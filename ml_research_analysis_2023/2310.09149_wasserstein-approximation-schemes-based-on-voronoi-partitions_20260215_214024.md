---
ver: rpa2
title: Wasserstein approximation schemes based on Voronoi partitions
arxiv_id: '2310.09149'
source_url: https://arxiv.org/abs/2310.09149
tags:
- measure
- measures
- lattice
- approximation
- approximations
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper considers structured approximation of measures in Wasserstein
  space using scaled lattice-based Voronoi partitions. The authors show that approximating
  a measure by sampling at lattice points or integrating over Voronoi cells achieves
  O(h) convergence in the Wasserstein distance, independent of dimension.
---

# Wasserstein approximation schemes based on Voronoi partitions

## Quick Facts
- arXiv ID: 2310.09149
- Source URL: https://arxiv.org/abs/2310.09149
- Reference count: 21
- Key outcome: Structured approximation of measures in Wasserstein space using scaled lattice-based Voronoi partitions achieves O(h) convergence independent of dimension, with N-term rates of O(N^{-1/d}) for compactly supported measures

## Executive Summary
This paper presents a novel framework for approximating probability measures in Wasserstein space using structured Voronoi partitions derived from scaled lattices. The authors prove that approximation based on these partitions achieves O(h) convergence in Wasserstein distance, independent of dimension. For compactly supported measures, this yields optimal N-term approximation rates of O(N^{-1/d}). The framework is extended to non-compactly supported measures with sufficient tail decay and to non-uniform Voronoi partitions, providing a flexible approach applicable to computer vision and machine learning tasks.

## Method Summary
The paper develops a two-stage approximation approach. First, it establishes that discretizing a measure using scaled lattice Voronoi partitions achieves O(h) error in Wasserstein distance. This is done by constructing a coupling between the original measure and its discrete approximation based on the geometric properties of Voronoi cells. Second, for compactly supported measures, it applies a covering number argument to derive N-term approximation rates, showing that setting h = (N/N(BR, V0))^{-1/d} yields O(N^{-1/d}) error. The framework is extended to non-compactly supported measures by truncating outside a ball and applying the same scheme to the truncated measure.

## Key Results
- O(h) convergence in Wasserstein distance for approximation using scaled lattice Voronoi partitions, independent of dimension
- O(N^{-1/d}) N-term approximation rate for compactly supported measures, matching optimal quantization and empirical measure rates
- Extension to non-compactly supported measures with sufficient tail decay through truncation
- Flexibility to handle non-uniform Voronoi partitions

## Why This Works (Mechanism)

### Mechanism 1
- Claim: O(h) convergence in Wasserstein distance for scaled lattice Voronoi partitions
- Mechanism: Voronoi cells form disjoint partition where distance to lattice point is bounded by cell radius, which scales linearly with h
- Core assumption: Voronoi cells are disjoint and radius scales linearly with h
- Evidence anchors: Abstract statement and Kantorovich formulation proof using cell radius bound
- Break condition: If cells aren't disjoint or radius doesn't scale with h, O(h) bound fails

### Mechanism 2
- Claim: O(N^{-1/d}) N-term approximation for compactly supported measures
- Mechanism: Covering argument bounds Voronoi cells needed to cover support; since N ~ h^{-d}, error O(h) = O(N^{-1/d})
- Core assumption: Measure has compact support with covering number scaling as h^{-d}
- Evidence anchors: Abstract statement and covering number bound N(BR, hV0) ≤ 3^d h^{-d} N(BR, V0)
- Break condition: If support not compact or covering number doesn't scale as h^{-d}, rate fails

### Mechanism 3
- Claim: Extension to non-compactly supported measures with sufficient tail decay
- Mechanism: Truncate measure outside ball BR, then apply lattice scheme to truncated measure
- Core assumption: Measure decays sufficiently fast outside BR
- Evidence anchors: Theorem 6.1 with conditions on Lebesgue decomposition and tail decay bounds
- Break condition: If measure doesn't decay sufficiently, truncation error dominates

## Foundational Learning

- Concept: Voronoi partitions and lattices
  - Why needed here: Framework relies on discretizing space using Voronoi cells of scaled lattice; understanding cell geometry is crucial for error analysis
  - Quick check question: If a lattice is scaled by h, how does the radius of its Voronoi cells scale?

- Concept: Wasserstein distance and optimal transport
  - Why needed here: Measures approximation quality using Wasserstein distance; understanding Kantorovich formulation and coupling construction is key to error analysis
  - Quick check question: How is Wasserstein distance defined in terms of couplings, and why is it a natural metric for probability measures?

- Concept: Covering numbers and approximation theory
  - Why needed here: N-term approximation rate relies on covering support with Voronoi cells; understanding covering number scaling with mesh size is essential
  - Quick check question: If a set in R^d can be covered by N balls of radius r, what is the relationship between N and r?

## Architecture Onboarding

- Component map: Measure µ -> Check support -> Compute covering number N(BR, V0) -> Scale lattice by h -> Form Voronoi partition -> Compute measure masses -> Output discrete/weighted measure

- Critical path: 1) Determine if measure is compactly supported 2) If compact, compute covering number N(BR, V0) 3) Set h = (N/N(BR, V0))^{-1/d} for N-term approximation 4) Scale lattice by h, form Voronoi cells 5) Compute measure masses on each cell 6) Output discrete/weighted measure

- Design tradeoffs: Lattice choice affects Voronoi cell geometry and error constants; smaller h gives better accuracy but more terms; Dirac trains have O(h) error vs O(h diam(V0)) for piecewise constant

- Failure signatures: O(h) bound fails if Voronoi cells not disjoint or radius doesn't scale with h; O(N^{-1/d}) bound fails if support not compact or covering number doesn't scale as h^{-d}; truncation bound fails if measure doesn't decay sufficiently fast

- First 3 experiments: 1) Verify O(h) error for Gaussian measure using Dirac train approximation on 2D lattice 2) Check N-term approximation rate for compactly supported measure on 3D lattice 3) Test truncation error for non-compactly supported measure with exponential decay

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the O(h) convergence rate for Voronoi-based approximations be improved beyond known bounds for optimal quantizers and empirical measures?
- Basis in paper: The paper shows O(h) convergence and derives optimal N-term rates but asks whether these can be further improved
- Why unresolved: The paper establishes matching known optimal bounds but doesn't explore whether tighter bounds are possible under additional assumptions
- What evidence would resolve it: Developing refined analysis techniques or identifying special measure classes where improved rates can be proven

### Open Question 2
- Question: How do approximation rates behave for measures with anisotropic or non-uniform Voronoi partitions compared to uniform lattice-based approach?
- Basis in paper: The paper generalizes to non-uniform Voronoi partitions but doesn't quantitatively compare with uniform partitions
- Why unresolved: While the framework extends to non-uniform partitions, it lacks analysis of how approximation quality compares in terms of convergence rates
- What evidence would resolve it: Numerical experiments or theoretical analysis comparing uniform vs non-uniform partitions under various measure structures

### Open Question 3
- Question: Can the approximation framework be extended to other optimal transport metrics beyond Wasserstein distance?
- Basis in paper: The paper focuses exclusively on Wasserstein distance without exploring alternative optimal transport metrics
- Why unresolved: The theoretical framework is built specifically for Wasserstein distance, requiring new mathematical tools for other metrics
- What evidence would resolve it: Developing analogous schemes for other optimal transport metrics and proving convergence rates

## Limitations

- The analysis assumes well-behaved Voronoi cells and may not hold for certain exotic lattices or in high dimensions
- Extension to non-compactly supported measures requires sufficient tail decay, but exact conditions needed are not precisely characterized
- Covering number argument assumes efficient covering by scaled Voronoi cells, which may not hold for all measure geometries

## Confidence

- **High Confidence**: O(h) approximation error bound for compactly supported measures using scaled lattice Voronoi partitions
- **Medium Confidence**: Extension to non-compactly supported measures with sufficient tail decay
- **Medium Confidence**: O(N^{-1/d}) N-term approximation rate

## Next Checks

1. **Numerical Verification of O(h) Bound**: Implement approximation scheme for Gaussian measure in 2D using square or hexagonal lattice. Compute Wasserstein error for different h values and verify linear scaling.

2. **N-term Rate for Compact Support**: Test N-term approximation rate for compactly supported measure (e.g., uniform on ball) in 3D. For different N values, compute optimal h and measure resulting error to check O(N^{-1/3}) scaling.

3. **Tail Decay for Non-compact Support**: Examine truncation error for measure with exponential decay (e.g., Gaussian) outside ball BR. For different R values, compute mass of truncated measure and verify rapid decay as R increases.