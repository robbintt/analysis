---
ver: rpa2
title: 'nSimplex Zen: A Novel Dimensionality Reduction for Euclidean and Hilbert Spaces'
arxiv_id: '2302.11508'
source_url: https://arxiv.org/abs/2302.11508
tags:
- space
- dimensions
- which
- data
- euclidean
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces nSimplex Zen, a novel dimensionality reduction
  technique that maps high-dimensional metric spaces to lower-dimensional Euclidean
  spaces. Unlike traditional linear methods (PCA, RP) or topological methods (MDS),
  nSimplex Zen leverages geometric properties of high-dimensional spaces, particularly
  the distribution of angles, to preserve distances more accurately.
---

# nSimplex Zen: A Novel Dimensionality Reduction for Euclidean and Hilbert Spaces

## Quick Facts
- arXiv ID: 2302.11508
- Source URL: https://arxiv.org/abs/2302.11508
- Reference count: 40
- Primary result: nSimplex Zen achieves Kruskal stress of 0.07 (100D→80D) vs 0.17 for PCA and 0.18 for MDS

## Executive Summary
This paper introduces nSimplex Zen, a novel dimensionality reduction technique that maps high-dimensional metric spaces to lower-dimensional Euclidean spaces with superior distance preservation. Unlike traditional linear methods (PCA, RP) or topological methods (MDS), nSimplex Zen leverages geometric properties of high-dimensional spaces, particularly the distribution of angles, to preserve distances more accurately. It is applicable to both Euclidean and Hilbert spaces, including those governed by Cosine, Jensen-Shannon, and Quadratic Form distances. Experimental results demonstrate that nSimplex Zen consistently outperforms other techniques in preserving distances, especially when reducing to very low dimensions.

## Method Summary
nSimplex Zen constructs a simplex in k-dimensional space using k reference points, then maps each data point as the apex of a simplex formed with these reference points. The transform relies only upon pairwise distances measured in the original space and uses the Zen function, which exploits the property that angles concentrate around π/2 in high-dimensional spaces, to provide the best distance estimate. The algorithm requires the original space to be isometrically embeddable in Hilbert space and selects reference points (typically randomly) to construct the base simplex. For each data point, distances to reference points are computed and used to determine its position in the reduced space through simplex construction and the Zen function.

## Key Results
- In 100-dimensional Euclidean space reduced to 80 dimensions, nSimplex Zen achieves a Kruskal stress of 0.07 compared to 0.17 for PCA and 0.18 for MDS
- The technique shows consistent superiority across multiple quality metrics including Sammon stress, quadratic loss, and kNN recall
- Particularly effective for reduction to very low dimensions where it captures non-linear manifold structure better than linear methods
- Applicable to various distance measures including Cosine, Jensen-Shannon, and Quadratic Form distances

## Why This Works (Mechanism)

### Mechanism 1
- Claim: nSimplex Zen leverages geometric properties of high-dimensional spaces, specifically the distribution of angles, to preserve distances more accurately during dimensionality reduction.
- Mechanism: In high-dimensional vector space it is generally known that two randomly selected vectors are very likely to be close to orthogonal. The nSimplex Zen function uses this property by setting the angle between simplices to π/2, which provides the best estimate of the true distance in the reduced space.
- Core assumption: The original space is uniformly distributed or lies on a complex manifold within the high-dimensional space.
- Evidence anchors: "In high-dimensional vector space it is generally known that two randomly selected vectors are very likely to be close to orthogonal"
- Break condition: If the original space is uniformly distributed, the geometric advantage diminishes and random projection may perform equally well.

### Mechanism 2
- Claim: nSimplex Zen preserves pairwise distances more accurately than linear methods (PCA, RP) or topological methods (MDS) by using a reference-based simplex construction.
- Mechanism: The transform constructs a simplex in k-dimensional space using k reference points, then maps each data point as the apex of a simplex formed with these reference points. The Zen function provides the best distance estimate within this structure.
- Core assumption: The original space is isometrically embeddable in Hilbert space (which includes Euclidean, Cosine, Jensen-Shannon, and Quadratic Form distances).
- Evidence anchors: "nSimplex Zen is applicable to any metric space which is isometrically embeddable in Hilbert space"
- Break condition: If the space cannot be isometrically embedded in Hilbert space, the transform cannot be applied.

### Mechanism 3
- Claim: nSimplex Zen outperforms other techniques when reducing to very low dimensions because it captures non-linear manifold structure with fewer reference points.
- Mechanism: Instead of using a large representative sample to construct a linear transform, nSimplex Zen uses only k reference points (where k is the reduction dimension) to capture the essential geometry of the data manifold.
- Core assumption: The data lies on a complex manifold within the high-dimensional space.
- Evidence anchors: "the use of a small number of sampled reference points... seems to give a better reference model for the transform"
- Break condition: If the data lies on a relatively uniform linear manifold, linear methods may perform equally well.

## Foundational Learning

- Concept: Hilbert spaces and isometric embedding
  - Why needed here: nSimplex Zen requires the original space to be isometrically embeddable in Hilbert space to guarantee the existence of the simplex construction
  - Quick check question: What property of Hilbert spaces allows any k+1 points to be embedded in k-dimensional Euclidean space?

- Concept: Simplex construction algorithm
  - Why needed here: The transform relies on constructing a simplex in k-dimensional space using only pairwise distances from the original space
  - Quick check question: How does the ApexAddition algorithm ensure that the new apex point maintains the correct distances to all base simplex vertices?

- Concept: Angle distribution in high-dimensional spaces
  - Why needed here: The Zen function exploits the property that angles concentrate around π/2 in high-dimensional spaces to provide the best distance estimate
  - Quick check question: Why does the probability of an angle being close to π/2 increase as the dimensionality of the space increases?

## Architecture Onboarding

- Component map: Distance calculation module -> Simplex construction module -> Zen function module -> Quality evaluation module

- Critical path:
  1. Select k reference points from the original space
  2. Compute all pairwise distances among reference points
  3. Construct the base simplex using the distance matrix
  4. For each data point, compute distances to reference points
  5. Add each data point as an apex to the base simplex
  6. Apply the Zen function to estimate distances in the reduced space

- Design tradeoffs:
  - Reference point selection: Random selection is simple but may not be optimal; more sophisticated selection could improve quality but increase complexity
  - Reduction dimension vs. quality: Lower dimensions provide more compression but may sacrifice distance preservation
  - Speed vs. accuracy: The current implementation is slower than matrix-based methods but provides better distance preservation

- Failure signatures:
  - Poor quality measures (high Kruskal stress, low recall) when reducing to very low dimensions in uniform spaces
  - Breakdown when the space cannot be isometrically embedded in Hilbert space
  - Suboptimal performance when data lies on a simple linear manifold

- First 3 experiments:
  1. Apply nSimplex Zen to a 100-dimensional uniformly generated Euclidean space, reducing to 2 dimensions, and compare Kruskal stress with PCA and RP
  2. Test nSimplex Zen on the Twitter GloVe dataset, reducing from 200 to 120 dimensions, and measure recall for kNN search
  3. Apply nSimplex Zen to the MirFlickr fc6 RELU data with Cosine distance, reducing from 4096 to 1111 dimensions, and compare with LMDS using Jensen-Shannon distance

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal strategy for selecting reference objects in the nSimplex Zen transform?
- Basis in paper: "We have spent some effort in seeking an optimal strategy, and have so far failed to improve, in general, on a random selection, other than when the projection is to very low dimensions."
- Why unresolved: The authors have not found a better strategy than random selection for most cases, but acknowledge that the choice of reference objects significantly affects the quality of the transform.
- What evidence would resolve it: Experiments comparing different reference object selection strategies (e.g., k-means clustering, farthest point sampling) against random selection across various datasets and dimensionality reduction scenarios.

### Open Question 2
- Question: Can the nSimplex Zen transform be optimized to achieve matrix multiplication-like performance for large-scale applications?
- Basis in paper: "It is possible that nSimplex Zen could be optimised to reach an equivalent performance, but whether this is the case or not, and indeed how to achieve it, are open questions."
- Why unresolved: The current implementation relies on distance calculations between each element and reference objects, which is slower than matrix multiplication used in other techniques.
- What evidence would resolve it: Development and testing of optimized nSimplex Zen implementations that achieve comparable performance to matrix-based methods on large datasets.

### Open Question 3
- Question: Why does nSimplex Zen perform poorly for kNN recall in some cases, particularly with low-dimensional reductions or data lying on uniform low-dimensional manifolds?
- Basis in paper: "The nSimplex Zen function has been seen in some spaces to be less good at preserving ordering over very small distances than other techniques, in particular when applied to relatively low-dimensional spaces, or spaces which lie within a relatively uniform low-dimensional manifold."
- Why unresolved: The authors understand the cause (absolute lower-bound on distances based on the last simplex component) but don't fully understand the probability or circumstances under which this occurs.
- What evidence would resolve it: Theoretical analysis of when and why this phenomenon occurs, combined with experiments on diverse datasets to identify patterns and potential mitigation strategies.

## Limitations
- Poor distance preservation at very small distances due to absolute lower bound from last simplex component
- Breakdown when the space cannot be isometrically embedded in Hilbert space
- Suboptimal performance when data lies on a simple linear manifold

## Confidence
- Confidence: Low on the claim that nSimplex Zen consistently outperforms other techniques in all scenarios
- Confidence: Medium on the technical implementation of the simplex construction and Zen function
- Confidence: Medium on the claimed advantages for very low-dimensional reduction

## Next Checks
1. **Distribution Sensitivity Test**: Apply nSimplex Zen to datasets with varying distributions (uniform, clustered, manifold-structured) and compare performance with PCA and MDS across all tested quality metrics
2. **Dimensionality Ratio Impact**: Systematically vary the reduction ratio (original_dimension/reduced_dimension) from 2:1 to 100:1 and measure how the performance gap between nSimplex Zen and other methods changes
3. **Distance Metric Generalization**: Test nSimplex Zen on additional distance metrics beyond those mentioned (Cosine, Jensen-Shannon, Quadratic Form) such as Mahalanobis distance, Canberra distance, and Earth Mover's distance to validate the claim of applicability to "any metric space which is isometrically embeddable in Hilbert space"