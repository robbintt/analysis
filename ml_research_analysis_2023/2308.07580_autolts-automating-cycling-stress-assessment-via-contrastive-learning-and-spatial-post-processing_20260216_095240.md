---
ver: rpa2
title: 'AutoLTS: Automating Cycling Stress Assessment via Contrastive Learning and
  Spatial Post-processing'
arxiv_id: '2308.07580'
source_url: https://arxiv.org/abs/2308.07580
tags:
- road
- cycling
- learning
- image
- stress
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: AutoLTS introduces a deep learning framework for assessing cycling
  stress from street-view images, addressing the challenge of slow, data-intensive
  traditional methods. The core method combines a two-step learning framework with
  contrastive learning that leverages the ordinal nature of stress labels, and a spatial
  post-processing technique that enforces smoothness in road feature predictions.
---

# AutoLTS: Automating Cycling Stress Assessment via Contrastive Learning and Spatial Post-processing

## Quick Facts
- **arXiv ID:** 2308.07580
- **Source URL:** https://arxiv.org/abs/2308.07580
- **Reference count:** 29
- **Primary result:** Deep learning framework that achieves 73.41% accuracy in predicting cycling stress levels from street-view images, improving to over 90% when combined with road features

## Executive Summary
AutoLTS introduces a deep learning framework for assessing cycling stress from street-view images, addressing the challenge of slow, data-intensive traditional methods. The core method combines a two-step learning framework with contrastive learning that leverages the ordinal nature of stress labels, and a spatial post-processing technique that enforces smoothness in road feature predictions. On a dataset of 39,153 road segments in Toronto, AutoLTS achieves 73.41% accuracy in predicting 4-level stress labels and 94.16% accuracy in distinguishing low-stress (LTS1/2) from high-stress (LTS3/4) roads using only images. When combined with road features like speed limits and lane counts, accuracy exceeds 90%. The framework demonstrates that street-view images provide valuable information for cycling stress assessment, with improvements of 0.43-32.39 percentage points in accuracy compared to using road features alone.

## Method Summary
AutoLTS automates cycling stress assessment through a two-step deep learning framework. First, it predicts LTS-related road features (road type, number of lanes, speed limit, cycling infrastructure, on-street parking) from street-view images using ResNet-50 encoders. Second, it combines these predicted features with image embeddings through a feedforward network to predict final LTS labels. The method employs contrastive learning with an ordinal-aware loss (OrdCon) that preserves the ordinal relationships between stress levels, and applies spatial post-processing to enforce smoothness in road feature predictions by leveraging the causal structure of the road network.

## Key Results
- Achieves 73.41% accuracy in predicting 4-level LTS labels from street-view images alone
- Distinguishes low-stress (LTS1/2) from high-stress (LTS3/4) roads with 94.16% accuracy using only images
- Improves accuracy by 0.43-32.39 percentage points when combining images with road features versus using road features alone
- Spatial post-processing reduces prediction errors by 20.75-30.23% on average for road features

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Contrastive learning with ordinal-aware loss improves LTS prediction by preserving the ordinal relationships between stress levels.
- **Mechanism:** The OrdCon loss extends standard supervised contrastive learning by aggregating labels at multiple granularities (e.g., grouping LTS1/2 as low-stress, LTS3/4 as high-stress), forcing the embedding space to reflect the ordinal structure of stress levels.
- **Core assumption:** Images with similar LTS labels share visual features that can be learned through contrastive sampling.
- **Evidence anchors:**
  - [abstract] "a contrastive learning approach that leverages the ordinal relationship among cycling stress labels"
  - [section 3.2] "We extend the supervised contrastive loss (Khosla et al. 2020) by augmenting it with terms that measure the similarity of images with 'neighboring' labels"
  - [corpus] "weak - no direct citation of ordinal contrastive learning in related works"
- **Break condition:** If the ordinal grouping is inappropriate (e.g., LTS2 grouped with LTS4), the model may learn incorrect similarity structures.

### Mechanism 2
- **Claim:** Spatial post-processing enforces smoothness in road feature predictions by leveraging the causal structure of the road network.
- **Mechanism:** Using a causal DAG where each road segment's features depend on its own image and adjacent segments' features, the algorithm iteratively updates predictions to maximize joint probability, reducing isolated prediction errors.
- **Core assumption:** Road features like traffic speed are spatially correlated and can be modeled as conditionally independent given adjacent segments.
- **Evidence anchors:**
  - [section 3.3] "We propose a principled way to address this problem" and describes the iterative update algorithm
  - [section 3.3] "Proposition 1 decomposes the conditional probability of target ai given all other targets and inputs"
  - [corpus] "no direct citation of spatial post-processing for road features in related works"
- **Break condition:** If the spatial correlation assumption is violated (e.g., at network boundaries or in heterogeneous areas), the post-processing may introduce errors.

### Mechanism 3
- **Claim:** The two-step learning framework improves LTS prediction by first predicting intermediate road features, then combining them with image embeddings.
- **Mechanism:** Step 1: Predict LTS-related road features from images using ResNet-50. Step 2: Combine predicted features with image embeddings through a feedforward network to predict final LTS labels, allowing the model to learn complex feature-label relationships.
- **Core assumption:** Road features have causal relationships with LTS labels and can be predicted from images.
- **Evidence anchors:**
  - [abstract] "a two-step learning framework with contrastive learning that leverages the ordinal nature of stress labels"
  - [section 3.2] "we formulate the LTS assessment as a two-step learning task" and describes the framework
  - [corpus] "no direct citation of two-step framework for cycling stress in related works"
- **Break condition:** If road features cannot be reliably predicted from images, the two-step approach may degrade performance.

## Foundational Learning

- **Concept: Contrastive Learning**
  - Why needed here: The dataset is relatively small for computer vision tasks, and contrastive learning can learn better representations with limited labels by pulling together similar samples.
  - Quick check question: What is the difference between supervised contrastive learning (SupCon) and self-supervised contrastive learning (MoCo)?

- **Concept: Ordinal Classification**
  - Why needed here: LTS labels have ordinal relationships (LTS1 < LTS2 < LTS3 < LTS4) that should be preserved in predictions, not treated as arbitrary classes.
  - Quick check question: Why is misclassifying LTS1 as LTS3 worse than misclassifying it as LTS2 in terms of practical impact?

- **Concept: Spatial Correlation**
  - Why needed here: Road features like traffic speed are spatially correlated, and leveraging this structure can improve prediction accuracy through post-processing.
  - Quick check question: How does the spatial post-processing algorithm use the causal DAG to enforce smoothness in predictions?

## Architecture Onboarding

- **Component map:** Image Encoder (ResNet-50) → Image Embedding; Road Feature Predictors (Multiple ResNet-50s) → Road Feature Embeddings; LTS Predictor (Feedforward Network) → LTS Label; Spatial Post-processing Module → Adjusted Road Feature Predictions

- **Critical path:** Image → Road Feature Predictions → LTS Prediction (with optional spatial post-processing on road features)

- **Design tradeoffs:**
  - Using road feature predictions as intermediate step adds complexity but improves accuracy when features are available
  - Spatial post-processing adds computational overhead but enforces realistic smoothness
  - Multiple ResNet-50s for different features increases model size but allows specialized feature learning

- **Failure signatures:**
  - Poor road feature prediction accuracy indicates issues with image encoder or feature extraction
  - LTS predictions that are spatially inconsistent suggest post-processing isn't working correctly
  - Low overall accuracy may indicate insufficient training data or inappropriate contrastive loss parameters

- **First 3 experiments:**
  1. Train image encoder with standard cross-entropy loss and evaluate baseline LTS prediction accuracy
  2. Add road feature prediction step and evaluate if combining features improves accuracy
  3. Implement spatial post-processing on road features and measure improvement in feature prediction accuracy and downstream LTS accuracy

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** How would domain adaptation methods impact AutoLTS performance in scenarios with significant domain shift between training and test data?
- **Basis in paper:** [explicit] The paper explicitly states that "Future research may apply domain adaptation methods to boost the performance of AutoLTS in such scenarios" where training and test data have very different label distributions.
- **Why unresolved:** The paper only observes performance degradation in spatial splits without implementing any domain adaptation techniques to mitigate this issue.
- **What evidence would resolve it:** Empirical results comparing AutoLTS performance with and without domain adaptation techniques (e.g., domain adversarial training, feature alignment) across different domain shift scenarios.

### Open Question 2
- **Question:** How could the loss function be modified to incorporate application-specific decision errors for different downstream applications like cycling route recommendation versus cycling network design?
- **Basis in paper:** [explicit] The paper discusses that "In cycling route recommendations, under-estimation of cycling stress may be more harmful than over-estimation because the former may lead to cycling routes that exceed cyclists' stress tolerance" and that "In cycling network design, cycling stress predictions might be more important on major roads than on side streets."
- **Why unresolved:** The current framework uses standard classification losses that treat all prediction errors equally, without considering the asymmetric costs of different types of errors for specific applications.
- **What evidence would resolve it:** Implementation and evaluation of modified loss functions that incorporate application-specific error costs, showing improved performance metrics relevant to each application (e.g., reduced false negative rates for route recommendation).

### Open Question 3
- **Question:** How does the generalizability of AutoLTS vary across different cities with varying urban characteristics, cycling infrastructure, and traffic patterns?
- **Basis in paper:** [explicit] The paper acknowledges that "all our experiments are based on a dataset collected in Toronto" and suggests that "Future research may collect a more comprehensive dataset to further assess the generalizability of our model."
- **Why unresolved:** The current evaluation is limited to a single city, and the paper explicitly calls for broader testing to assess generalizability.
- **What evidence would resolve it:** Cross-city evaluation of AutoLTS performance using datasets from multiple cities with diverse characteristics, showing how model performance varies with urban context and what factors influence generalizability.

## Limitations
- **Limited generalizability:** All experiments are based on Toronto data, limiting applicability to cities with different street layouts and cycling infrastructure patterns.
- **Spatial post-processing complexity:** The algorithm's effectiveness depends on accurate transition probability estimation between adjacent road segments, which is not thoroughly validated across different network topologies.
- **Hyperparameter sensitivity:** The OrdCon loss requires careful tuning of virtual label weights, and the sensitivity to these parameters is not explored.

## Confidence
- **High Confidence:** The core framework architecture and two-step learning approach are well-defined and technically sound.
- **Medium Confidence:** The contrastive learning improvements are demonstrated but could benefit from ablation studies comparing different loss variants.
- **Low Confidence:** The spatial post-processing benefits are claimed but not rigorously validated across diverse urban contexts.

## Next Checks
1. Conduct ablation studies on the OrdCon loss parameters (l and w values) to determine optimal settings for different city types.
2. Test the framework on at least two additional cities with distinct street network structures (e.g., grid vs. organic layouts) to assess generalizability.
3. Implement and validate the transition probability estimation method for spatial post-processing across varying road network densities.