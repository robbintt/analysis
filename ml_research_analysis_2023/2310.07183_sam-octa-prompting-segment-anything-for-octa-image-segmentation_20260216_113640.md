---
ver: rpa2
title: 'SAM-OCTA: Prompting Segment-Anything for OCTA Image Segmentation'
arxiv_id: '2310.07183'
source_url: https://arxiv.org/abs/2310.07183
tags:
- segmentation
- points
- prompt
- octa
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper proposes SAM-OCTA, a method for segmenting optical coherence
  tomography angiography (OCTA) images. SAM-OCTA fine-tunes a pre-trained Segment
  Anything Model (SAM) using low-rank adaptation (LoRA) and employs prompt points
  to guide local segmentation of retinal vessels, arteries, and veins.
---

# SAM-OCTA: Prompting Segment-Anything for OCTA Image Segmentation

## Quick Facts
- arXiv ID: 2310.07183
- Source URL: https://arxiv.org/abs/2310.07183
- Reference count: 22
- Primary result: State-of-the-art OCTA segmentation using fine-tuned SAM with LoRA and prompt points

## Executive Summary
SAM-OCTA presents a novel approach for segmenting optical coherence tomography angiography (OCTA) images by fine-tuning the Segment Anything Model (SAM) using low-rank adaptation (LoRA). The method employs prompt points to guide local segmentation of retinal vessels, arteries, and veins. Experiments demonstrate state-of-the-art performance on the OCTA-500 and ROSE datasets, particularly excelling in challenging tasks like artery-vein differentiation.

## Method Summary
SAM-OCTA fine-tunes a pre-trained Segment Anything Model using low-rank adaptation (LoRA) to adapt it to OCTA image characteristics. The method employs prompt points to guide local segmentation, particularly effective for distinguishing morphologically similar structures like arteries and veins. The approach uses different loss functions for various tasks - Dice loss for foveal avascular zone and capillary segmentation, and clDice loss for vessel structures to preserve topological integrity.

## Key Results
- Achieves state-of-the-art performance in OCTA segmentation tasks on OCTA-500 and ROSE datasets
- Accurate segmentation of arteries and veins, a challenging task in previous works
- Prompt points significantly enhance segmentation accuracy, especially for arteries and veins
- Demonstrates effectiveness in common OCTA segmentation tasks including retinal vessels and foveal avascular zone

## Why This Works (Mechanism)

### Mechanism 1
Fine-tuning SAM with LoRA enables adaptation to OCTA image characteristics without losing pre-trained zero-shot capabilities. LoRA introduces low-rank updates to the image encoder's attention blocks, allowing adaptation to OCTA-specific features while preserving generalization.

### Mechanism 2
Prompt points guide the model to localize and segment specific targets accurately, especially in complex cases like artery-vein segmentation. The prompt encoder integrates point information with image features to focus segmentation on specified regions.

### Mechanism 3
Using clDice loss for vessel segmentation preserves topological structure and centerline accuracy. clDice combines Dice loss with skeleton-based terms to maintain connectivity in tubular structures like vessels.

## Foundational Learning

- **Optical Coherence Tomography Angiography (OCTA)**: Understanding OCTA is crucial as it's the specific image type being segmented, with unique characteristics like 3D volume data and en-face projections.
  - Quick check: What are the main challenges in OCTA image segmentation compared to natural images?

- **Segment Anything Model (SAM)**: SAM is the foundation model being fine-tuned, and understanding its architecture (image encoder, prompt encoder, mask decoder) is essential for grasping the adaptation process.
  - Quick check: How does SAM's prompt mechanism differ from traditional segmentation models?

- **Low-Rank Adaptation (LoRA)**: LoRA is the fine-tuning technique used to adapt SAM to OCTA, and understanding its mechanism is key to grasping how the model is modified.
  - Quick check: Why is LoRA preferred over full fine-tuning in this context?

## Architecture Onboarding

- **Component map**: OCTA image → Image Encoder (ViT with MAE pre-training, adapted via LoRA) → Prompt Encoder → Mask Decoder → Segmentation Mask → Loss Calculation → Parameter Update

- **Critical path**: OCTA image → Image Encoder (LoRA) → Prompt Encoder → Mask Decoder → Segmentation Mask → Loss Calculation → Parameter Update

- **Design tradeoffs**:
  - LoRA vs. Full Fine-tuning: LoRA preserves pre-trained capabilities but may limit adaptation depth
  - Prompt Points vs. No Prompts: Prompts improve localization but require user input
  - clDice vs. Dice: clDice preserves topology but is more complex to compute

- **Failure signatures**:
  - Poor segmentation boundaries: May indicate ineffective prompt points or loss function issues
  - Disconnected vessel segments: Could suggest clDice loss not capturing topology correctly
  - Overfitting on small datasets: May occur if LoRA rank is too high or training epochs too many

- **First 3 experiments**:
  1. Test SAM without fine-tuning on OCTA to establish baseline performance
  2. Apply LoRA fine-tuning with varying ranks to find optimal adaptation
  3. Compare segmentation with and without prompt points for a specific task (e.g., FAZ) to quantify their impact

## Open Questions the Paper Calls Out

### Open Question 1
What is the optimal number of prompt points for different segmentation tasks (RV, FAZ, capillary, artery-vein) in global mode?
- Basis: The paper discusses the effect of different numbers of prompt points but does not provide a definitive optimal number for each task.
- Why unresolved: The paper only suggests a general approach based on connected components without specific optimal values.
- What evidence would resolve it: Experiments systematically varying the number of prompt points for each task and reporting performance metrics.

### Open Question 2
How does SAM-OCTA perform compared to state-of-the-art methods on artery-vein segmentation in OCTA images?
- Basis: The paper mentions SAM-OCTA performs accurate artery-vein segmentation but lacks detailed quantitative comparisons with other methods.
- Why unresolved: Specific quantitative comparisons for artery-vein segmentation are not provided.
- What evidence would resolve it: A table explicitly comparing SAM-OCTA's artery-vein segmentation metrics with those of other published methods.

### Open Question 3
What is the impact of different fine-tuning strategies (e.g., LoRA rank, learning rate schedules) on SAM-OCTA's performance?
- Basis: The paper mentions using LoRA and a warm-up strategy but does not explore different configurations or compare their effects.
- Why unresolved: The paper does not conduct experiments with varying LoRA ranks or alternative learning rate schedules.
- What evidence would resolve it: Experiments varying the LoRA rank and learning rate schedules, reporting how these changes affect segmentation metrics.

## Limitations
- Method's performance on other OCTA datasets beyond OCTA-500 and ROSE is unknown
- Reliance on prompt points raises concerns about zero-shot capability and usability in scenarios where prompt points are difficult to define
- Low-rank approximation used in LoRA may not fully capture the complexity of OCTA-specific features

## Confidence
- High Confidence: The overall approach of fine-tuning SAM with LoRA and using prompt points for OCTA segmentation
- Medium Confidence: The effectiveness of LoRA in adapting SAM to OCTA-specific features
- Medium Confidence: The impact of prompt points on segmentation accuracy, particularly for arteries and veins

## Next Checks
1. Test SAM-OCTA on additional OCTA datasets with varying acquisition protocols and pathologies to assess generalizability
2. Conduct a systematic study on the impact of different prompt point configurations on segmentation accuracy
3. Investigate the sensitivity of SAM-OCTA's performance to the rank of the LoRA approximation