---
ver: rpa2
title: Patient Clustering via Integrated Profiling of Clinical and Digital Data
arxiv_id: '2308.11748'
source_url: https://arxiv.org/abs/2308.11748
tags:
- data
- patient
- clustering
- clinical
- diagnosis
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces a novel patient clustering framework that
  integrates clinical data (ICD-10-CM diagnosis codes) and digital interaction data
  (browsing and search records) from a healthcare web portal. The core method uses
  constrained low-rank approximation with nonnegative matrix factorization to generate
  interpretable patient embedding vectors, effectively handling both fully observed
  and partially unobserved data.
---

# Patient Clustering via Integrated Profiling of Clinical and Digital Data

## Quick Facts
- arXiv ID: 2308.11748
- Source URL: https://arxiv.org/abs/2308.11748
- Authors: 
- Reference count: 40
- One-line primary result: Novel patient clustering framework integrates clinical and digital data, outperforming baselines with 80.92% ROC-AUC, 73.05% accuracy, and 72.30% F1-score in mental wellness app recommendations.

## Executive Summary
This paper introduces a patient clustering framework that combines clinical ICD-10-CM diagnosis codes with digital interaction data (browsing and search records) from a healthcare web portal. The method uses constrained low-rank approximation with nonnegative matrix factorization to generate interpretable patient embedding vectors, effectively handling both fully observed and partially unobserved data. Evaluated on real-world anonymized data from Kaiser Permanente's web portal, the approach significantly outperforms baselines including standalone text embedding methods and PCA-reduced embeddings.

## Method Summary
The method integrates clinical and digital data through text embeddings (BioSentVec for clinical codes, GPT-2 and SentenceBERT for general text) combined with TF-IDF features. Patient profiles are constructed by concatenating scaled sub-profiles (diagnosis, browsing, search) into profile matrices. Constrained nonnegative matrix factorization with block coordinate descent optimization decomposes these matrices into basis and embedding matrices under nonnegativity constraints, with masking applied to handle unobserved diagnosis entries. The resulting nonnegative embedding matrix serves as a low-dimensional representation for clustering and recommendation tasks.

## Key Results
- Achieved Davies-Bouldin index of 1.144 and Silhouette coefficient of 0.416, showing improved clustering coherence
- In mental wellness app recommendation tasks, attained 80.92% ROC-AUC, 73.05% accuracy, and 72.30% F1-score
- NMF consistently outperformed other methods across all data types, with performance improving as more digital data was added

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Integrating clinical and digital data improves clustering coherence and recommendation accuracy beyond using either modality alone.
- Mechanism: Clinical data provides authoritative medical diagnoses while digital data reveals patient intent and interests, combining to enrich patient profiles.
- Core assumption: Clinical data alone is sparse and incomplete, so digital data can fill gaps in patient representation.
- Evidence anchors: Combining clinical and digital data significantly enhances patient profiling; NMF performance improved with each addition of digital data.
- Break condition: If digital data does not correlate with clinical conditions, integration could add noise rather than signal.

### Mechanism 2
- Claim: NMF with constrained low-rank approximation yields interpretable, lower-dimensional patient embeddings that enable soft clustering.
- Mechanism: NMF decomposes concatenated profile matrices into basis and embedding matrices under nonnegativity constraints, enforcing parts-based representations.
- Core assumption: Patient profiles lie in a low-dimensional manifold that can be approximated by rank-k factorization.
- Evidence anchors: Nonnegative embedding vectors serve as low-dimensional representation; nonnegativity enhances interpretability aligning with soft clustering.
- Break condition: If true patient manifold requires higher rank than chosen k, approximation error increases and embeddings lose discriminative power.

### Mechanism 3
- Claim: Using different embedding methods for different data types captures complementary semantic and contextual information.
- Mechanism: BioSentVec captures medical semantics for clinical codes while GPT-2 and SentenceBERT capture general language context.
- Core assumption: Different embedding models encode complementary aspects of text meaning relevant to patient profiling.
- Evidence anchors: BioSentVec is crucial for understanding clinical context; NMF exhibited best clustering performance when applied to combined data.
- Break condition: If embeddings are highly correlated or redundant, concatenation adds dimensionality without new information.

## Foundational Learning

- Concept: Low-rank matrix factorization and nonnegative matrix factorization (NMF)
  - Why needed here: Core representation learning step relies on decomposing profile matrices into basis and embedding matrices under nonnegativity constraints.
  - Quick check question: In NMF, what property of the factors W and H ensures parts-based, interpretable representations?

- Concept: Text embedding methods and their domain specificity (BioSentVec vs general models)
  - Why needed here: Different embedding models are used for clinical codes (BioSentVec) and general text (GPT-2, SentenceBERT) to capture complementary semantic information.
  - Quick check question: Why is BioSentVec preferred over general embeddings like Word2Vec for clinical ICD-10-CM code descriptions?

- Concept: Handling missing data via masking matrices and closed-world vs open-world assumptions
  - Why needed here: Diagnosis data is sparse and partially unobserved; method must distinguish between unobserved due to absence vs unobserved due to unknown.
  - Quick check question: In the objective function, how does the masking matrix M modify the loss for unobserved diagnosis entries?

## Architecture Onboarding

- Component map: Data ingestion -> Text embeddings -> Profile matrices -> NMF factorization -> H embeddings -> Clustering/Recommendation
- Critical path: Data → Text embeddings → Profile matrices → NMF factorization → H embeddings → Clustering/Recommendation
- Design tradeoffs:
  - Using multiple embeddings increases profile dimensionality and richness but also computational cost and risk of redundancy
  - Open-world assumption for diagnoses preserves potential unknown conditions but increases uncertainty
  - NMF vs other dimensionality reduction (PCA): NMF yields nonnegative, interpretable factors but may require careful rank selection
- Failure signatures:
  - Poor clustering metrics may indicate embeddings are too noisy or rank is too low/high
  - Overfitting in recommendation may signal excessive profile dimensionality or insufficient regularization
  - NMF convergence failure may indicate ill-conditioned profile matrices or inappropriate balancing factors
- First 3 experiments:
  1. Run NMF with only diagnosis profiles (no digital data) and evaluate clustering vs standalone embeddings to confirm clinical-only baseline
  2. Add browsing data to diagnosis profiles, retrain NMF, and measure improvement in clustering coherence
  3. Add search data to the combined diagnosis+browsing profile, retrain, and compare recommendation accuracy on mental wellness app task

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed method's performance scale with increasing dimensionality of the embedding space?
- Basis in paper: The paper mentions using 128 dimensions for comparison but does not explore the impact of different dimensionalities on performance.
- Why unresolved: The paper does not investigate how clustering and recommendation performance changes with varying embedding dimensions.
- What evidence would resolve it: Conducting experiments with different embedding dimensions (e.g., 64, 128, 256, 512) and comparing performance metrics across these settings.

### Open Question 2
- Question: How does the proposed method perform on different types of clinical data beyond ICD-10-CM codes, such as clinical notes or lab results?
- Basis in paper: While our focus has been on diagnosis codes, integrating richer data like clinical notes could further enrich the profile.
- Why unresolved: Current evaluation only uses ICD-10-CM codes, and performance on other types of clinical data is not explored.
- What evidence would resolve it: Applying the method to datasets containing clinical notes, lab results, or other types of clinical data and comparing clustering and recommendation performance.

### Open Question 3
- Question: How does the proposed method handle missing or incomplete digital interaction data?
- Basis in paper: The paper mentions that data and features are not always fully observed but does not provide detailed experiments on this aspect.
- Why unresolved: While the paper mentions handling unobserved data, it does not explore the method's robustness to varying levels of missing digital interaction data.
- What evidence would resolve it: Conducting experiments with datasets containing different levels of missing digital interaction data and analyzing the method's performance under these conditions.

## Limitations
- Performance metrics are evaluated on a single anonymized dataset from Kaiser Permanente's web portal without external validation or cross-domain testing
- The paper does not specify exact values for balancing factors (α_b, α_s) in the NMF objective, which could significantly impact results
- Stopping criteria for the BCD optimization process are not detailed, making convergence thresholds difficult to determine

## Confidence
- **High confidence**: The mechanism that integrating clinical and digital data improves clustering and recommendation performance is well-supported by the reported metrics
- **Medium confidence**: The claim that NMF with nonnegativity constraints yields interpretable patient embeddings is supported by method description and clustering results
- **Low confidence**: The assumption that different embedding models capture truly complementary information is plausible but not empirically verified

## Next Checks
1. Perform ablation studies to test the impact of each embedding type (BioSentVec, GPT-2, SentenceBERT) on clustering performance, and measure redundancy between embeddings using correlation analysis
2. Conduct external validation by applying the method to a different healthcare dataset or domain to assess generalizability of the clustering and recommendation improvements
3. Implement sensitivity analysis for the balancing factors (α_b, α_s) and rank parameter k in NMF to determine their impact on performance and identify optimal configurations