---
ver: rpa2
title: 'SWoTTeD: An Extension of Tensor Decomposition to Temporal Phenotyping'
arxiv_id: '2310.01201'
source_url: https://arxiv.org/abs/2310.01201
tags:
- phenotypes
- swotted
- tensor
- temporal
- phenotype
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: SWoTTeD introduces a novel tensor decomposition approach to extract
  temporal phenotypes from electronic health records (EHR). Unlike previous methods
  that model phenotypes as daily combinations of features, SWoTTeD captures temporal
  arrangements of events over sliding windows, allowing overlapping occurrences to
  represent asynchronous treatment starts.
---

# SWoTTeD: An Extension of Tensor Decomposition to Temporal Phenotyping

## Quick Facts
- arXiv ID: 2310.01201
- Source URL: https://arxiv.org/abs/2310.01201
- Reference count: 40
- Primary result: Novel tensor decomposition approach extracts temporal phenotypes from EHR with equivalent reconstruction accuracy to state-of-the-art methods while providing richer temporal patterns

## Executive Summary
SWoTTeD introduces a novel tensor decomposition approach that extends traditional methods to capture temporal arrangements of healthcare events rather than just daily combinations. The method uses sliding windows and convolution-based reconstruction to naturally represent asynchronous treatment starts and overlapping occurrences in patient care pathways. By incorporating sparsity and non-succession regularization, SWoTTeD produces clinically interpretable temporal phenotypes that outperform state-of-the-art models in reconstruction accuracy and noise robustness. A case study on COVID-19 ICU patient data demonstrates the extraction of meaningful treatment protocols and disease background phenotypes.

## Method Summary
SWoTTeD models electronic health records as irregular third-order tensors and applies tensor decomposition with convolution-based reconstruction. The method extracts temporal phenotypes represented as matrices where each column captures events occurring within sliding windows of fixed size ω. A key innovation is the use of overlapping occurrences to represent asynchronous treatment starts, combined with sparsity regularization for feature selection and non-succession regularization to prevent repeated patterns. The model is optimized using alternating least squares and projected gradient descent, with evaluation on both synthetic and real-world datasets including MIMIC-IV ICU data.

## Key Results
- Achieves at least equivalent reconstruction accuracy to state-of-the-art tensor decomposition models
- Extracts clinically meaningful temporal phenotypes including treatment protocols and disease background patterns
- Demonstrates robustness to noise and stability across runs
- Case study on COVID-19 ICU data reveals typical treatment protocols and temporal disease progression patterns

## Why This Works (Mechanism)

### Mechanism 1
- Claim: SWoTTeD achieves at least equivalent reconstruction accuracy to state-of-the-art tensor decomposition models by capturing temporal arrangements of events rather than just daily combinations.
- Mechanism: By extending tensor decomposition to temporal phenotyping, SWoTTeD models care pathways as mixtures of treatments with overlapping occurrences, allowing asynchronous treatment starts to be represented naturally through convolution-based reconstruction.
- Core assumption: Temporal patterns in care pathways are meaningful and capture clinically relevant information that daily phenotypes miss.
- Evidence anchors:
  - [abstract]: "SWoTTeD achieves at least equivalent reconstruction accuracy to state-of-the-art tensor decomposition models, and extracts temporal phenotypes that are meaningful for clinicians."
  - [section]: "The results show that SWoTTeD outperforms the state-of-the-art tensor decomposition models in terms of reconstruction accuracy and noise robustness."
  - [corpus]: Weak - corpus contains related work on tensor decomposition but no direct comparison to SWoTTeD's reconstruction accuracy claims.
- Break condition: If temporal patterns don't capture meaningful clinical information or if overlapping occurrences introduce noise that degrades reconstruction.

### Mechanism 2
- Claim: SWoTTeD extracts clinically meaningful temporal phenotypes through regularization terms that enhance interpretability.
- Mechanism: The sparsity regularization promotes feature selection while the non-succession regularization prevents undesirable decompositions where the same phenotype occurs on successive days, instead encouraging phenotypes that capture actual temporal sequences.
- Core assumption: Temporal phenotypes should represent distinct temporal arrangements rather than repeated occurrences of the same pattern.
- Evidence anchors:
  - [section]: "SWoTTeD introduces a novel regularization term that enhances the quality of the extracted phenotypes."
  - [section]: "We validate our proposal using both synthetic and real-world datasets, and we present an original usecase using data from the Greater Paris University Hospital."
  - [corpus]: Weak - corpus mentions regularization in tensor decomposition but not the specific non-succession regularization proposed by SWoTTeD.
- Break condition: If the non-succession regularization is too restrictive and prevents capturing legitimate repeated treatments.

### Mechanism 3
- Claim: SWoTTeD demonstrates robustness to noise and stability across runs, making it reliable for real-world clinical data analysis.
- Mechanism: The model's optimization framework with alternating minimization and projected gradient descent handles the non-negativity and normalization constraints, while the reconstruction loss assumes Bernoulli distribution appropriate for binary EHR data.
- Core assumption: Real-world EHR data contains noise from missing events and data entry errors that need to be handled robustly.
- Evidence anchors:
  - [section]: "The results show that SWoTTeD achieves at least as accurate reconstruction as recent state-of-the-art tensor decomposition models, and extracts temporal phenotypes that are meaningful for clinicians."
  - [section]: "The model demonstrates robustness to noise and stability across runs."
  - [corpus]: Weak - corpus contains related work on tensor decomposition for EHR but no direct evidence about noise robustness.
- Break condition: If the model overfits to noise or if the Bernoulli assumption doesn't match the actual data distribution.

## Foundational Learning

- Concept: Tensor decomposition and CP factorization
  - Why needed here: SWoTTeD builds on tensor decomposition principles to extend them to temporal phenotyping, so understanding the basics of how tensors decompose into lower-order components is essential.
  - Quick check question: What is the fundamental principle behind CP factorization in tensor decomposition?

- Concept: Convolution-based reconstruction
  - Why needed here: SWoTTeD uses convolution to reconstruct input tensors from temporal phenotypes, so understanding how convolution works in this context is crucial for implementing and debugging the model.
  - Quick check question: How does the convolution operator in Equation 3 combine phenotype columns to reconstruct the input tensor?

- Concept: Regularization techniques (L1 sparsity and non-succession)
  - Why needed here: The model uses specific regularization terms to enhance phenotype interpretability, so understanding both sparsity and the novel non-succession regularization is important.
  - Quick check question: Why does the non-succession regularization penalize successive occurrences of the same phenotype within the same time window?

## Architecture Onboarding

- Component map:
  Input tensor (irregular third-order tensor) -> Temporal phenotypes tensor P (R×n×ω) -> Assignment matrices W -> Convolution operator f for reconstruction -> Reconstruction loss Lf -> Regularization terms (sparsity + non-succession) -> Optimization framework (alternating minimization + PGD)

- Critical path:
  1. Initialize P and W randomly
  2. Alternate optimization: update P given W, then update W given P
  3. Apply clipping for normalization constraints
  4. Compute reconstruction loss and regularization terms
  5. Use Adam optimizer for gradient updates
  6. Project test sets using learned phenotypes

- Design tradeoffs:
  - Temporal phenotype size ω vs reconstruction accuracy: larger ω captures more complex patterns but may overconstrain the model
  - Number of phenotypes R vs model complexity: more phenotypes allow better reconstruction but increase computational cost
  - Regularization weights α and β vs phenotype quality: need to balance sparsity and non-succession penalties

- Failure signatures:
  - Poor reconstruction accuracy despite optimization: check convolution implementation and regularization balance
  - Unstable phenotypes across runs: increase regularization or improve initialization
  - Phenotypes not clinically meaningful: adjust phenotype size ω or number of phenotypes R

- First 3 experiments:
  1. Test reconstruction accuracy on synthetic data with known phenotypes (R=4, ω=3)
  2. Compare F ITX values with baseline models (CNTF, PARAFAC2) on MIMIC-IV dataset
  3. Evaluate noise robustness by adding/removing events from synthetic training data

## Open Questions the Paper Calls Out
The paper doesn't explicitly call out open questions, but the discussion section suggests several directions for future research including extending the model to variable-length temporal windows and exploring applications beyond ICU settings.

## Limitations
- Model assumes binary EHR data following Bernoulli distribution, which may not capture full complexity of clinical measurements
- Temporal phenotype size ω is a hyperparameter requiring careful tuning
- Non-succession regularization may be overly restrictive for legitimately repeated treatments

## Confidence
- High confidence in reconstruction accuracy claims - validated against multiple state-of-the-art methods on both synthetic and real-world datasets
- Medium confidence in clinical interpretability - case study shows meaningful patterns but lacks external clinical validation
- Low confidence in generalizability - limited evaluation on diverse clinical conditions beyond ICU COVID-19 data

## Next Checks
1. Test SWoTTeD on a broader range of clinical conditions (e.g., chronic diseases, mental health) to assess generalizability
2. Conduct external validation with clinical experts to verify the meaningfulness of extracted temporal phenotypes
3. Evaluate the model's performance on EHR data with continuous measurements (not just binary events) to test distributional assumptions