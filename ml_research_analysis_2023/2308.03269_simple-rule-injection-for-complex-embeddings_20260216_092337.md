---
ver: rpa2
title: Simple Rule Injection for ComplEx Embeddings
arxiv_id: '2308.03269'
source_url: https://arxiv.org/abs/2308.03269
tags:
- rules
- knowledge
- injex
- rule
- relation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper proposes InjEx, a method to inject definite Horn rules
  into ComplEx knowledge graph embeddings without rule grounding. InjEx enforces non-negative
  bounded constraints on entity and relation embeddings and introduces a regularization
  term to encode rule satisfaction.
---

# Simple Rule Injection for ComplEx Embeddings

## Quick Facts
- arXiv ID: 2308.03269
- Source URL: https://arxiv.org/abs/2308.03269
- Reference count: 40
- The paper proposes InjEx, a method to inject definite Horn rules into ComplEx knowledge graph embeddings without rule grounding.

## Executive Summary
This paper introduces InjEx, a method for injecting definite Horn rules into ComplEx knowledge graph embeddings without requiring rule grounding. InjEx enforces non-negative bounded constraints on entity and relation embeddings and introduces a regularization term to encode rule satisfaction. The approach is theoretically proven to handle composition and hierarchy rules, and experimental results show state-of-the-art performance on knowledge graph completion benchmarks (FB15k-237, WN18RR, YAGO3-10) and competitive results on few-shot link prediction (NELL-One, FB15k-237-Zero).

## Method Summary
InjEx modifies ComplEx embeddings by imposing non-negative bounded constraints (0 ≤ Re(e), Im(e) ≤ 1 for entities, 0 ≤ Re(r), Im(r), 0 ≤ |r| ≤ R for relations) and adding a regularization term that penalizes violations of definite Horn rules. The method theoretically proves it can handle composition and hierarchy rules without rule grounding, using the bounded constraints to enable composition pattern inference and the regularization to enforce rule satisfaction through slack variables for approximate rule compliance.

## Key Results
- InjEx achieves state-of-the-art performance on knowledge graph completion benchmarks (FB15k-237, WN18RR, YAGO3-10)
- Competitive results on few-shot link prediction tasks (NELL-One, FB15k-237-Zero)
- Effectively demonstrates rule injection and improved embedding quality through theoretical proofs and empirical validation

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Non-negative bounded constraints on entity and relation embeddings ensure bounded scoring and enable composition pattern inference.
- **Mechanism:** The paper enforces $0 \leq \text{Re}(e), \text{Im}(e) \leq 1$ for entities and $0 \leq \text{Re}(r), \text{Im}(r), 0 \leq |r| \leq R$ for relations. This bounds the scoring function $\phi(e_i, r_k, e_j)$ and ensures that $\phi_l/(2R) \in [0,1]$ can be treated as a probability-like score for each dimension. This boundedness is crucial for Theorem 1, which shows that composition rules can be enforced via $\text{Re}(r_1 \times r_2)/R \leq \text{Re}(r_3)$.
- **Core assumption:** The non-negativity and boundedness constraints do not significantly harm the expressive power of ComplEx, and the model can still learn meaningful representations under these constraints.
- **Evidence anchors:**
  - [section] "As pointed out by [23], the positive elements of entities or relations usually contain enough information. Thus, intuitionally we don't expect these constraints to significantly effect the performance of ComplEx."
  - [abstract] "InjEx enforces non-negative bounded constraints on entity and relation embeddings and introduces a regularization term to encode rule satisfaction."
- **Break condition:** If the non-negative bounded constraints overly restrict the embedding space and prevent the model from learning useful representations, the approach would fail. This could happen if the KG has many relations or entities that require negative components to capture their semantics accurately.

### Mechanism 2
- **Claim:** The regularization term enforces Horn rules by penalizing violations of the rule constraints.
- **Mechanism:** The paper introduces a regularization term $\lambda(\text{Re}(r_1 \times ... \times r_k)/R^k - \text{Re}(r)/R) \leq \alpha$ for length-k Horn rules. This term penalizes the violation of the rule constraint, effectively encouraging the embeddings to satisfy the rule. The slack variables $\alpha$ and $\beta$ allow for approximate rule satisfaction.
- **Core assumption:** The regularization term is effective in guiding the embeddings to satisfy the Horn rules, and the penalty coefficient $\mu$ is appropriately tuned.
- **Evidence anchors:**
  - [section] "We further introduce the level of confidence and slackness in Equation 5 to model approximate composition rules, which yields $\lambda(\text{Re}(r_1 \times r_2)/R^2 - \text{Re}(r_3)/R) \leq \alpha$, $\lambda(\text{Im}(r_1 \times r_2)/R^2 - \text{Im}(r_3)/R)^2 \leq \beta$"
  - [abstract] "InjEx achieves state-of-the-art performance on knowledge graph completion benchmarks (FB15k-237, WN18RR, YAGO3-10) and competitive results on few-shot link prediction (NELL-One, FB15k-237-Zero), demonstrating effective rule injection and improved embedding quality."
- **Break condition:** If the regularization term is not strong enough to enforce the rules, or if it is too strong and prevents the model from learning useful embeddings, the approach would fail. This could happen if the penalty coefficient $\mu$ is not appropriately tuned.

### Mechanism 3
- **Claim:** The combination of non-negative bounded constraints and regularization enables InjEx to capture definite Horn rules of any body length without rule grounding.
- **Mechanism:** The paper proves that with the non-negative bounded constraints, ComplEx can handle composition patterns (Theorem 1). Then, it extends this to length-k Horn rules (Theorem 2) by enforcing the constraint $\text{Re}(r_1 \times ... \times r_k)/R^k \leq \text{Re}(r)$ and $\text{Im}(r_1 \times ... \times r_k)/R^k = \text{Im}(r)$. The regularization term penalizes violations of these constraints.
- **Core assumption:** The non-negative bounded constraints and regularization are sufficient to capture definite Horn rules of any body length, and the proofs in the appendix are correct.
- **Evidence anchors:**
  - [abstract] "The method is theoretically proven to handle composition and hierarchy rules."
  - [section] "With the non-negative bounded constraint in 4.1, a sufficient condition for Equation 7 to hold, is to further impose $\text{Re}(r_1 \times r_2 \times ... \times r_k)/R^k \leq \text{Re}(r)$, $\text{Im}(r_1 \times r_2 \times ... \times r_k)/R^k = \text{Im}(r)$"
- **Break condition:** If the proofs in the appendix are incorrect, or if the non-negative bounded constraints and regularization are not sufficient to capture definite Horn rules of any body length, the approach would fail. This could happen if the rules have complex structures that cannot be captured by the constraints.

## Foundational Learning

- **Concept: Knowledge Graph Embeddings**
  - **Why needed here:** InjEx is a method for injecting rules into knowledge graph embeddings. Understanding how knowledge graph embeddings work is essential for understanding how InjEx modifies the embedding space to satisfy the rules.
  - **Quick check question:** What is the scoring function used in ComplEx, and how does it compute the plausibility of a triple?

- **Concept: Definite Horn Rules**
  - **Why needed here:** InjEx is designed to inject definite Horn rules into knowledge graph embeddings. Understanding what definite Horn rules are and how they are represented is crucial for understanding how InjEx enforces these rules in the embedding space.
  - **Quick check question:** What is the difference between a hierarchy rule and a composition rule in the context of definite Horn rules?

- **Concept: Complex Embeddings**
  - **Why needed here:** InjEx is built on top of ComplEx, which uses complex-valued embeddings. Understanding how complex embeddings work and why they are useful for capturing certain types of relations is important for understanding how InjEx leverages this structure to inject rules.
  - **Quick check question:** How does ComplEx use the real and imaginary parts of complex embeddings to capture symmetric and antisymmetric relations?

## Architecture Onboarding

- **Component map:** ComplEx base model -> Non-negative bounded constraints -> Regularization term -> Objective function
- **Critical path:**
  1. Initialize entity and relation embeddings.
  2. Impose non-negative bounded constraints on embeddings.
  3. Extract Horn rules from the knowledge graph.
  4. Add regularization term to the objective function to penalize rule violations.
  5. Optimize the objective function using an optimizer like AdaGrad.
  6. Project embeddings into the valid range after each gradient step.

- **Design tradeoffs:**
  - **Rule injection vs. embedding quality:** InjEx trades off some flexibility in the embedding space for the ability to inject rules. The non-negative bounded constraints and regularization may restrict the model's ability to learn optimal embeddings for certain tasks.
  - **Rule complexity vs. computational efficiency:** InjEx can handle rules of any body length, but longer rules may require more complex regularization terms and increase computational cost.

- **Failure signatures:**
  - **Poor link prediction performance:** If InjEx fails to inject rules effectively, the link prediction performance may be worse than the base ComplEx model or other baselines.
  - **Overfitting:** If the regularization term is too strong, the model may overfit to the rules and fail to generalize well to unseen data.

- **First 3 experiments:**
  1. **Evaluate on a small dataset:** Start by evaluating InjEx on a small knowledge graph dataset to verify that it can inject rules effectively and improve link prediction performance.
  2. **Ablation study:** Remove the non-negative bounded constraints or regularization term to understand their individual contributions to the performance.
  3. **Rule length analysis:** Evaluate InjEx on rules of different lengths to understand how the body length affects the performance and computational cost.

## Open Questions the Paper Calls Out
The paper does not explicitly call out any open questions.

## Limitations
- The effectiveness of non-negative bounded constraints on the expressive power of ComplEx embeddings is not fully explored empirically
- The impact of regularization strength on rule injection effectiveness and sensitivity to hyperparameter tuning is not thoroughly investigated
- Computational cost implications of handling rules with longer bodies are not discussed in detail

## Confidence
- **High:** The theoretical proofs for handling composition and hierarchy rules
- **Medium:** The effectiveness of non-negative bounded constraints and regularization in guiding embeddings to satisfy Horn rules
- **Medium:** The overall claim of achieving state-of-the-art performance on knowledge graph completion benchmarks

## Next Checks
1. **Ablation Study on Constraints and Regularization:** Conduct a comprehensive ablation study to understand the individual and combined effects of the non-negative bounded constraints and the regularization term on the model's performance.
2. **Sensitivity Analysis of Regularization Strength:** Perform a sensitivity analysis to determine the optimal range for the regularization strength (μ) and its impact on rule injection effectiveness and overall model performance.
3. **Evaluation on Rules with Longer Bodies:** Evaluate InjEx on rules with longer bodies to assess its computational efficiency and effectiveness in handling more complex rules. Compare the results with the performance on shorter rules to understand the trade-offs involved.