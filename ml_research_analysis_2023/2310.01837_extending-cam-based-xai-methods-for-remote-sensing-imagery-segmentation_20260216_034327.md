---
ver: rpa2
title: Extending CAM-based XAI methods for Remote Sensing Imagery Segmentation
arxiv_id: '2310.01837'
source_url: https://arxiv.org/abs/2310.01837
tags:
- segmentation
- methods
- image
- class
- target
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper extends CAM-based XAI methods for semantic segmentation
  of remote sensing imagery, focusing on building segmentation from high-resolution
  satellite images. The authors adapt five recent CAM-based XAI methods (Grad-CAM,
  Grad-CAM++, XGrad-CAM, Score-CAM, Ablation-CAM, and Eigen-CAM) from classification
  to segmentation by modifying the gradient calculation to use segmentation scores
  instead of classification scores.
---

# Extending CAM-based XAI methods for Remote Sensing Imagery Segmentation

## Quick Facts
- arXiv ID: 2310.01837
- Source URL: https://arxiv.org/abs/2310.01837
- Reference count: 15
- Primary result: Adapted five CAM-based XAI methods for semantic segmentation, achieving best performance with gradient-free Seg-Score-CAM on WHU dataset.

## Executive Summary
This paper adapts five recent CAM-based XAI methods (Grad-CAM, Grad-CAM++, XGrad-CAM, Score-CAM, Ablation-CAM, and Eigen-CAM) from classification to semantic segmentation for remote sensing imagery, specifically building segmentation from high-resolution satellite images. The key innovation is modifying the gradient calculation to use segmentation scores instead of classification scores, enabling these methods to highlight relevant regions for segmentation tasks. The authors also introduce a novel entropy-based evaluation metric to measure model uncertainty when only the highlighted relevant pixels and target class pixels are input to the model. Experiments on the WHU dataset demonstrate that Seg-Score-CAM achieves the best performance in terms of both drop in segmentation score and increase in entropy.

## Method Summary
The paper extends CAM-based XAI methods for semantic segmentation by replacing classification scores with segmentation scores in the gradient calculation. For each method, the authors modify how feature map importance weights are computed: Grad-CAM uses gradients of the segmentation score, Score-CAM measures segmentation score changes when perturbing feature maps, and Eigen-CAM analyzes principal components of feature representations. They propose a new entropy-based evaluation metric that computes pixel-wise entropy of softmax outputs over target-class pixels in a reduced input containing only relevant pixels from the XAI method and target-class pixels. The evaluation uses two metrics: drop in segmentation score and increase in entropy when input is reduced.

## Key Results
- Gradient-free Seg-Score-CAM method achieves best performance in both drop of segmentation score and increase in entropy
- Adapted XAI methods successfully highlight relevant regions for building segmentation in high-resolution satellite imagery
- Proposed entropy-based evaluation metric effectively measures model uncertainty when relevant context is removed
- WHU dataset experiments validate the effectiveness of the adaptation and evaluation approach

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Replacing classification scores with segmentation scores in CAM gradient calculations enables CAM-based XAI methods to highlight relevant regions for semantic segmentation tasks.
- **Mechanism**: In semantic segmentation, the model outputs a per-pixel probability distribution across classes. By computing gradients of the segmentation score (sum over target-class pixels) with respect to feature maps, the method assigns importance weights that reflect each feature map's contribution to correctly segmenting the target class.
- **Core assumption**: The segmentation score (sum of target-class softmax outputs over relevant pixels) is differentiable and captures the model's decision boundary for the target class.
- **Evidence anchors**:
  - [abstract]: "adapting the recent XAI classification algorithms and making them usable for multi-class image segmentation"
  - [section]: "Seg-Grad-CAM [5] modifies Equation (1) to be able to use it for the downstream segmentation task as shown in Equation (3): αc k = 1/N ∑(u,v) ∂ ∑(i,j)∈M yc i,j /∂Ak u,v"
  - [corpus]: Weak - no corpus paper directly validates the gradient substitution approach; evidence comes from adaptation logic in the paper.
- **Break condition**: If segmentation score gradients are noisy or sparse (e.g., in highly imbalanced datasets), the importance weights may become unstable and the saliency maps unreliable.

### Mechanism 2
- **Claim**: Entropy of the softmax output over the target-class pixels serves as a reliable measure of model uncertainty when only highlighted regions and target-class pixels are input.
- **Mechanism**: By feeding the model a reduced input containing only relevant pixels (from the XAI method) and target-class pixels, and computing pixel-wise entropy of the softmax probabilities, the method captures how uncertain the model is about segmenting the target class. Higher entropy indicates higher uncertainty.
- **Core assumption**: The model's softmax outputs reflect genuine probabilistic uncertainty, and entropy is sensitive to changes in confidence when relevant context is removed.
- **Evidence anchors**:
  - [abstract]: "we introduce a new XAI evaluation methodology and metric based on 'Entropy' to measure the model uncertainty"
  - [section]: "The propposed entropy metric EXAI is calculated as shown in (10): EXAI = ∑i,j E(i,j)I" and "We note that EXAI measures the uncertainty of the model in segmenting the pixels of the target class."
  - [corpus]: Weak - corpus neighbors discuss uncertainty in segmentation but none explicitly validate entropy-based XAI evaluation for segmentation.
- **Break condition**: If the model's softmax outputs are poorly calibrated or over-confident, entropy may not reflect true uncertainty, leading to misleading XAI evaluation.

### Mechanism 3
- **Claim**: Gradient-free methods like Score-CAM and Eigen-CAM are less sensitive to gradient noise and better preserve segmentation performance when context is reduced.
- **Mechanism**: Instead of relying on gradients, these methods assess feature map importance by measuring the change in segmentation score when the feature map is used to perturb the input (Score-CAM) or by analyzing principal components of feature representations (Eigen-CAM). This avoids noisy gradient artifacts.
- **Core assumption**: Feature map perturbations or principal component directions capture meaningful spatial relevance without requiring backpropagation.
- **Evidence anchors**:
  - [section]: "Seg-Score-CAM: which adapts Score-CAM [9] from classification to segmentation. Gradients are noisy and may not be an optimal solution for highlighting important regions within the input image."
  - [section]: "Seg-Eigen-CAM: which finally adapts Eigen-CAM [11] to the task at hand. Work in [11] is based on the principal components of the learned representations from the convolutional layers without the need for backpropagation."
  - [corpus]: Weak - no corpus paper directly validates gradient-free methods for segmentation XAI; adaptation logic is paper-specific.
- **Break condition**: If the perturbation or PCA-based importance scores fail to align with true feature relevance, the method may highlight irrelevant regions and mislead interpretation.

## Foundational Learning

- **Concept**: Semantic segmentation output structure (per-pixel softmax distributions).
  - Why needed here: The adaptation from classification to segmentation requires understanding that instead of a single class probability, the model outputs a spatial map of class probabilities.
  - Quick check question: In a segmentation mask of size 256x256 with 3 classes, what is the shape of the model's output tensor?

- **Concept**: Gradient-based attribution (how ∂L/∂A_k is computed via backpropagation).
  - Why needed here: All CAM-based XAI methods rely on computing gradients of a score with respect to feature maps; adapting them requires replacing the classification score with a segmentation score while preserving differentiability.
  - Quick check question: If yc is the sum of softmax probabilities over target-class pixels, which layer's gradients are needed to compute αc_k?

- **Concept**: Entropy as uncertainty measure (Shannon entropy formula and interpretation).
  - Why needed here: The paper's novel evaluation metric uses entropy of softmax outputs to quantify how uncertain the model is about segmenting target-class pixels under reduced input.
  - Quick check question: If the softmax output for a pixel is [0.9, 0.05, 0.05], what is the pixel's entropy (normalized by log(L))?

## Architecture Onboarding

- **Component map**:
  Segmentation model -> CAM-based XAI module -> Entropy evaluation module -> Dataset loader

- **Critical path**:
  1. Forward pass full image → obtain segmentation score and entropy baseline
  2. Compute XAI saliency map (Grad-CAM, Score-CAM, etc.)
  3. Create reduced input: union of saliency-highlighted pixels and target-class pixels
  4. Forward pass reduced input → compute new segmentation score and entropy
  5. Evaluate: drop in segmentation score + increase in entropy

- **Design tradeoffs**:
  - Gradient-based methods: computationally efficient, but sensitive to gradient noise and may miss non-target-class context
  - Gradient-free methods: more robust to noise, but require multiple forward passes (Score-CAM) or PCA computation (Eigen-CAM), increasing latency
  - Entropy metric: interpretable uncertainty measure, but assumes well-calibrated softmax outputs

- **Failure signatures**:
  - Saliency maps that highlight only target-class pixels but ignore context → large segmentation score drop, high entropy
  - Entropy increase without segmentation drop → method highlights irrelevant but model-uncertain regions
  - Both metrics flat → saliency map ineffective or input too similar to original

- **First 3 experiments**:
  1. Run Grad-CAM adaptation on a simple binary segmentation model (e.g., buildings vs background) and visualize saliency maps
  2. Compare entropy before/after masking using Seg-Score-CAM vs Seg-Grad-CAM on a small validation set
  3. Test Score-CAM perturbation loop with varying perturbation strengths to observe impact on segmentation score and entropy

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can hybrid XAI methods be designed to combine the strengths of gradient-based and gradient-free approaches for semantic segmentation?
- Basis in paper: [explicit] Future perspective mentioned in the conclusion
- Why unresolved: The paper only adapts existing XAI methods and proposes a new evaluation metric, but does not explore the potential of combining different XAI approaches.
- What evidence would resolve it: Developing and testing hybrid XAI methods that integrate gradient-based and gradient-free techniques, and comparing their performance against individual methods on semantic segmentation tasks.

### Open Question 2
- Question: Can the proposed entropy-based evaluation methodology be extended to handle multi-class semantic segmentation tasks effectively?
- Basis in paper: [inferred] The current methodology focuses on single-class segmentation (buildings) and uses entropy to measure model uncertainty for the target class
- Why unresolved: The paper only demonstrates the entropy metric for a single-class segmentation problem, and it is unclear how well it would perform for multi-class scenarios where multiple target classes are present.
- What evidence would resolve it: Extending the entropy-based evaluation to multi-class segmentation tasks and comparing its performance against other evaluation metrics in terms of measuring model uncertainty and explanation quality.

### Open Question 3
- Question: What are the limitations of the current XAI methods when applied to other remote sensing image segmentation tasks beyond building segmentation?
- Basis in paper: [inferred] The paper focuses on building segmentation from high-resolution satellite images and does not explore the generalizability of the adapted XAI methods to other remote sensing segmentation tasks
- Why unresolved: The experiments are limited to a single dataset (WHU) and a specific segmentation task (building segmentation), so the performance and limitations of the XAI methods on other remote sensing applications are not known.
- What evidence would resolve it: Applying the adapted XAI methods to a diverse set of remote sensing image segmentation tasks (e.g., land cover classification, road extraction, crop type identification) and analyzing their strengths, weaknesses, and domain-specific challenges.

## Limitations
- Adaptation relies on assumption that segmentation score gradients capture meaningful model decisions, lacking ablation studies on gradient noise sensitivity
- Entropy metric effectiveness depends on well-calibrated softmax outputs, which are not validated
- Superiority of gradient-free methods is based on single dataset (WHU), raising generalization concerns to other remote sensing tasks

## Confidence

- **High confidence**: The mechanism of replacing classification scores with segmentation scores is logically sound and directly implementable, as the segmentation output structure is well-defined.
- **Medium confidence**: The entropy-based evaluation metric is theoretically valid, but its practical reliability depends on model calibration, which is not addressed.
- **Low confidence**: The superiority of gradient-free methods (Score-CAM, Eigen-CAM) over gradient-based ones for segmentation XAI is not robustly validated beyond the WHU dataset, and the break conditions for noisy gradients are not empirically tested.

## Next Checks

1. Test the adapted XAI methods on a second remote sensing dataset (e.g., Inria Aerial Image Labeling) to assess generalization.
2. Perform an ablation study on segmentation score gradient noise by adding synthetic noise to feature maps and measuring impact on saliency map quality.
3. Evaluate entropy metric sensitivity by comparing it against alternative uncertainty measures (e.g., Monte Carlo dropout variance) on the same reduced-input setup.