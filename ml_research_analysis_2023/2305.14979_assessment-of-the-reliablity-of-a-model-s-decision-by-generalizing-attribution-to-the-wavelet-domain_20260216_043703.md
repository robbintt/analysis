---
ver: rpa2
title: Assessment of the Reliablity of a Model's Decision by Generalizing Attribution
  to the Wavelet Domain
arxiv_id: '2305.14979'
source_url: https://arxiv.org/abs/2305.14979
tags:
- image
- wcam
- figure
- wavelet
- prediction
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces the Wavelet Scale Attribution Method (WCAM),
  which generalizes attribution from the pixel domain to the space-scale domain using
  wavelet transforms. WCAM reveals where and on what scales a model focuses its attention,
  enabling assessment of decision reliability.
---

# Assessment of the Reliablity of a Model's Decision by Generalizing Attribution to the Wavelet Domain

## Quick Facts
- arXiv ID: 2305.14979
- Source URL: https://arxiv.org/abs/2305.14979
- Reference count: 40
- One-line primary result: Wavelet Scale Attribution Method (WCAM) generalizes attribution to the space-scale domain, enabling assessment of model decision reliability and revealing why corruptions or zooming affect predictions.

## Executive Summary
This paper introduces the Wavelet Scale Attribution Method (WCAM), which generalizes attribution from the pixel domain to the space-scale domain using wavelet transforms. WCAM reveals where and on what scales a model focuses its attention, enabling assessment of decision reliability. The method perturbs wavelet coefficients and uses Sobol indices to quantify their importance. Experiments show that WCAM explains model failures under image corruptions by identifying disrupted scales while spatial localization remains stable. It also identifies sufficient information for prediction and explains why zooming-in improves accuracy (by reducing background noise rather than revealing new details). WCAM is validated across various model architectures and training methods, providing insights into model behavior that traditional attribution methods cannot capture.

## Method Summary
WCAM perturbs the wavelet transform of input images and uses Sobol indices to quantify the importance of wavelet coefficients in a model's decision. The method applies a discrete wavelet transform (DWT) to decompose images into scale and spatial components, generates perturbation masks via quasi-Monte Carlo sampling, applies these to wavelet coefficients, and computes Sobol total indices using Jansen's estimator. This enables attribution in the space-scale domain, revealing which scales and locations are most influential for the model's prediction. The method is evaluated on ImageNet and ImageNet-C datasets using various model architectures (ResNet-50, ViT-B16) and training methods (standard, robust, adversarial).

## Key Results
- WCAM explains model failures under image corruptions by identifying disrupted scales while spatial localization remains stable.
- WCAM identifies sufficient information for prediction and explains why zooming-in improves accuracy by reducing background noise rather than revealing new details.
- WCAM is validated across various model architectures and training methods, providing insights into model behavior that traditional attribution methods cannot capture.

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Wavelet decomposition isolates spatial regions with scale-specific importance, enabling attribution beyond pixel locality.
- **Mechanism:** The discrete wavelet transform (DWT) splits an image into multiple scale levels (e.g., 1-2, 2-4, 4-8 pixel scales) and directional components (horizontal, vertical, diagonal). Perturbing wavelet coefficients and measuring Sobol total indices quantifies how each scale-region pair influences the model's prediction. This captures scale-dependent focus that pixel-only attribution misses.
- **Core assumption:** The model's decision depends on features that are separable in scale and space, and that perturbations in the wavelet domain meaningfully affect predictions.
- **Evidence anchors:**
  - [abstract] "WCAM reveals where and on what scales a model focuses its attention"
  - [section] "Wavelets decompose images in terms of scales, which enables highlighting their structural properties"
- **Break condition:** If the model's decision is based on non-separable scale-space interactions, or if perturbations in the wavelet domain do not affect the output meaningfully, the method loses explanatory power.

### Mechanism 2
- **Claim:** Image corruptions disrupt important scales more than spatial locations, making wavelet-based attribution more informative for debugging.
- **Mechanism:** Corruptions like blur, compression, or noise alter the high-frequency (fine-scale) components more than coarse scales. WCAM identifies that the model's attention shifts to different scales under corruption while staying spatially consistent, revealing why predictions fail.
- **Core assumption:** Corruptions primarily degrade high-frequency content, and the model's spatial focus remains stable despite scale disruption.
- **Evidence anchors:**
  - [abstract] "Experiments show that WCAM explains model failures under image corruptions by identifying disrupted scales while spatial localization remains stable"
- **Break condition:** If corruptions affect spatial localization significantly or if the model's scale preference changes unpredictably, the diagnostic value diminishes.

### Mechanism 3
- **Claim:** Zooming improves accuracy by removing background noise rather than revealing new object details, as quantified by wavelet scale importance.
- **Mechanism:** Zooming removes background content, reducing reliance on low-importance (often background) coefficients. WCAM shows that the importance distribution across scales remains stable between zoomed and regular images, indicating no new scale information is used.
- **Core assumption:** Zooming preserves the object's scale content and the model's decision process relies on consistent scale patterns.
- **Evidence anchors:**
  - [abstract] "identifies sufficient information for prediction and explains why zooming-in improves accuracy (by reducing background noise rather than revealing new details)"
- **Break condition:** If zooming introduces new scale information or changes the model's scale preference, the explanation fails.

## Foundational Learning

- **Concept:** Discrete Wavelet Transform (DWT) and its role in separating image content by scale and orientation.
  - **Why needed here:** WCAM relies on wavelet decomposition to attribute importance to scale-space regions. Without understanding DWT, the engineer cannot implement or debug the method.
  - **Quick check question:** What are the three directional components produced by a 2D DWT at each scale level?

- **Concept:** Sobol sensitivity analysis and total Sobol indices.
  - **Why needed here:** WCAM uses Sobol indices to quantify the importance of wavelet coefficients. Understanding variance decomposition and index estimation is essential for interpreting results.
  - **Quick check question:** How does a total Sobol index differ from a first-order Sobol index in measuring feature importance?

- **Concept:** Quasi-Monte Carlo sampling and low-discrepancy sequences (e.g., Sobol sequence).
  - **Why needed here:** Efficient estimation of Sobol indices requires structured sampling to reduce variance. The engineer must choose and tune sampling strategies.
  - **Quick check question:** Why is a Sobol sequence preferred over random sampling for Sobol index estimation?

## Architecture Onboarding

- **Component map:** Input preprocessing -> Discrete Wavelet Transform (DWT) -> Perturbation masks (QMC) -> Model inference on perturbed images -> Sobol index estimation -> WCAM visualization
- **Critical path:** 1. Apply DWT to input image (channel-wise for RGB). 2. Generate N perturbation masks from a low-discrepancy sequence. 3. Apply masks to wavelet coefficients and invert to obtain perturbed images. 4. Run model inference on each perturbed image. 5. Compute Sobol total indices using Jansen's estimator. 6. Aggregate and visualize importance in scale-space.
- **Design tradeoffs:**
  - Grid size vs. resolution: Larger grids give finer attribution but increase computation.
  - Number of designs vs. accuracy: More designs improve Sobol index estimation but increase inference cost.
  - Perturbation type: Circular masks reduce reconstruction artifacts compared to square or grid masks.
- **Failure signatures:**
  - Inconsistent Sobol indices across runs -> Check sampling method and seed.
  - WCAM highlights background instead of object -> Verify mask application and DWT alignment.
  - High computation time -> Reduce grid size or number of designs; consider caching DWT transforms.
- **First 3 experiments:**
  1. **Sanity check:** Apply WCAM to a simple CNN on MNIST; verify that scale importance aligns with expected features (edges at fine scales, shapes at coarse scales).
  2. **Corruption test:** Compare WCAM on clean vs. blurred ImageNet images; confirm scale disruption while spatial focus remains stable.
  3. **Zoom consistency:** Apply WCAM to zoomed and regular images; verify that importance distribution across scales is stable.

## Open Questions the Paper Calls Out
The authors acknowledge that the main limitation of their approach is that it is computationally more expensive than existing black-box attribution methods and that it mainly focuses on a qualitative assessment of the model's prediction. They also mention exploring quantification with the reconstruction depth but still have to find a convincing metric.

## Limitations
- WCAM is computationally more expensive than existing black-box attribution methods due to multiple forward passes required for Sobol index estimation.
- The method primarily provides qualitative insights and lacks a comprehensive quantitative evaluation framework for assessing its effectiveness.
- WCAM's applicability to non-image modalities and other types of distribution shifts (beyond image corruptions) remains unexplored.

## Confidence
- **Mechanism validity:** Medium - Supported by experimental evidence on standard datasets and diverse model architectures, but under-supported for claims about zooming behavior.
- **General applicability:** Low - Limited testing on non-image modalities and other distribution shifts.
- **Computational feasibility:** Medium - Acknowledged as a limitation, but no concrete optimization strategies proposed.

## Next Checks
1. Apply WCAM to a non-image modality (e.g., spectrograms) to test cross-domain validity.
2. Benchmark WCAM against alternative frequency-based attribution methods (e.g., spectral attribution) under a broader set of image corruptions.
3. Perform an ablation study on grid size and number of perturbation designs to quantify the tradeoff between attribution resolution and computational cost.