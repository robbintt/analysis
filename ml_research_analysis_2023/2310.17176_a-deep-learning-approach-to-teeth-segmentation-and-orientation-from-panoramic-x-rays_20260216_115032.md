---
ver: rpa2
title: A Deep Learning Approach to Teeth Segmentation and Orientation from Panoramic
  X-rays
arxiv_id: '2310.17176'
source_url: https://arxiv.org/abs/2310.17176
tags:
- segmentation
- teeth
- tooth
- dental
- images
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a deep learning model for instance segmentation
  and orientation of teeth from panoramic X-ray images. The method builds on the FUSegNet
  architecture, incorporating grid-based attention gates and parallel spatial and
  channel squeeze-and-excitation modules.
---

# A Deep Learning Approach to Teeth Segmentation and Orientation from Panoramic X-rays

## Quick Facts
- arXiv ID: 2310.17176
- Source URL: https://arxiv.org/abs/2310.17176
- Reference count: 0
- This paper proposes a deep learning model for instance segmentation and orientation of teeth from panoramic X-ray images.

## Executive Summary
This paper presents a deep learning approach for instance segmentation and orientation estimation of teeth from panoramic X-ray images. The method builds on the FUSegNet architecture, incorporating grid-based attention gates and parallel spatial and channel squeeze-and-excitation modules. Oriented bounding boxes are generated using principal component analysis (PCA) for precise tooth orientation estimation. Evaluated on the DNS dataset of 543 images, the model achieves an Intersection-over-Union (IoU) score of 82.43% and a Dice Similarity Coefficient (DSC) of 90.37%, outperforming several state-of-the-art segmentation models. Rotated IoU (RIoU) for oriented bounding boxes is 82.82%.

## Method Summary
The proposed method uses a modified FUSegNet architecture with EfficientNet-B7 as the encoder backbone. Grid-based attention gates are incorporated into skip connections to suppress background regions and emphasize tooth-specific features. Parallel spatial and channel squeeze-and-excitation (P-scSE) modules are added to enhance feature representation. The model is trained on 324 panoramic X-ray images divided into 512x512 patches with 10-pixel overlap. Post-processing removes small unwanted regions and generates oriented bounding boxes using PCA for orientation estimation. The model is evaluated using IoU, DSC, and RIoU metrics on a test set of 111 images.

## Key Results
- Achieved IoU score of 82.43% and DSC of 90.37% on test set
- Outperformed U-Net, SegNet, and original FUSegNet models
- RIoU for oriented bounding boxes reached 82.82%

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Attention gates in skip connections suppress irrelevant background regions and emphasize tooth-specific features.
- Mechanism: The grid-based attention gate computes attention coefficients α from feature maps x and gating signal g. These coefficients are multiplied with the skip connection features, creating a spatially weighted feature map that suppresses non-tooth regions and focuses on tooth boundaries and internal structure.
- Core assumption: The gating signal g contains contextual information that can distinguish tooth-relevant features from background noise.
- Evidence anchors:
  - [abstract] "incorporating grid-based attention gates into the skip connections"
  - [section 3.2.4] "attention gate calculates the attention coefficient α, which is the result of additive attention computed from the input feature maps x and contextual information provided by the gating signal g"
  - [corpus] Weak evidence for this specific mechanism in dental domain; attention gates are more established in medical imaging like segmentation of organs.
- Break condition: If attention gates over-suppress features in cases of tooth overlap or foreign objects, leading to incomplete tooth boundaries.

### Mechanism 2
- Claim: PCA-based orientation estimation provides robust tooth angle calculation by capturing maximum variance along tooth axis.
- Mechanism: PCA computes principal components from binarized tooth pixels. The first principal component (PC1) defines the major axis of the tooth. The angle between PC1 and the horizontal axis is calculated and converted to a rotation angle θ for OBB generation.
- Core assumption: Tooth pixels form a coherent shape where maximum variance aligns with the tooth's long axis, even when rotated or slightly curved.
- Evidence anchors:
  - [abstract] "oriented bounding box (OBB) generation through principal component analysis (PCA)"
  - [section 3.4] "calculate the first two major principal components (PCs) and determine the angle between the first PC and the horizontal axis, which we refer to as PCAangle"
  - [corpus] PCA is well-established in computer vision for object orientation, but no direct evidence in corpus for dental panoramic X-ray application.
- Break condition: If tooth shape is irregular or overlapping with adjacent teeth, PCA may capture variance from multiple teeth instead of a single tooth axis.

### Mechanism 3
- Claim: Parallel spatial and channel squeeze-and-excitation (P-scSE) improves feature representation by aggregating both spatial and channel-wise information.
- Mechanism: The P-scSE module creates two parallel branches: one adds channel-wise and spatial-wise excitation, the other takes their maximum. This dual path allows the network to adaptively recalibrate features by emphasizing important spatial regions and informative channels simultaneously.
- Core assumption: Both spatial and channel-wise dependencies are important for distinguishing tooth features from background and from each other.
- Evidence anchors:
  - [abstract] "parallel spatial and channel squeeze-and-excitation (P-scSE) modules"
  - [section 3.2.3] "P-scSE [4] creates two parallel branches of the scSE module – one by adding cSE and sSE, and the other by taking the maximum of them"
  - [corpus] P-scSE was originally developed for wound segmentation; no direct evidence in corpus for dental application, though squeeze-and-excitation is established in medical imaging.
- Break condition: If the network over-emphasizes certain channels or spatial regions, leading to false positives in background regions or false negatives in tooth regions.

## Foundational Learning

- Concept: Intersection-over-Union (IoU) and Dice Similarity Coefficient (DSC)
  - Why needed here: These metrics evaluate segmentation quality by measuring overlap between predicted and ground truth regions, crucial for comparing dental segmentation models.
  - Quick check question: If a model predicts a tooth region with 80 pixels overlap out of 100 ground truth pixels and 120 predicted pixels, what are the IoU and DSC scores?

- Concept: Principal Component Analysis (PCA) for orientation
  - Why needed here: PCA extracts the dominant axis of tooth shape from pixel coordinates, enabling calculation of tooth rotation angle for oriented bounding box generation.
  - Quick check question: Given a set of 2D points representing a tooth, what mathematical operation yields the principal components that define the tooth's orientation?

- Concept: Encoder-decoder architecture with skip connections
  - Why needed here: This architecture allows the model to capture both high-level semantic information (encoder) and fine-grained spatial details (decoder with skip connections), essential for precise tooth boundary delineation.
  - Quick check question: In a U-Net-like architecture, what information flows through skip connections and why is this beneficial for segmentation tasks?

## Architecture Onboarding

- Component map: EfficientNet-B7 -> Grid-based attention gates -> P-scSE -> Convolution layers -> Output segmentation map -> Post-processing -> PCA for OBB
- Critical path: Input image -> EfficientNet-B7 -> Attention-gated skip connections -> P-scSE -> Convolution layers -> Segmentation output -> Post-processing -> Final tooth instances with OBB coordinates
- Design tradeoffs: Using EfficientNet-B7 provides strong feature extraction but increases computational cost compared to smaller backbones. Attention gates improve localization but add parameters. P-scSE enhances feature representation but requires careful tuning to avoid over-calibration.
- Failure signatures: Low IoU/DSC scores indicate poor boundary detection; high false positives suggest attention gates are not suppressing background sufficiently; inconsistent OBB angles indicate PCA is capturing wrong principal components.
- First 3 experiments:
  1. Train baseline FUSegNet without attention gates and P-scSE to establish performance floor
  2. Add grid-based attention gates to skip connections and measure improvement in tooth boundary precision
  3. Implement PCA-based OBB generation and evaluate RIoU compared to horizontal bounding boxes

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed method perform when applied to 3D volumetric dental X-ray data instead of 2D panoramic images?
- Basis in paper: [explicit] The paper explicitly mentions that future work includes extending the approach to 3D instance segmentation, which is crucial for applications like orthognathic surgery planning and dental implant placement.
- Why unresolved: The current model is specifically designed and evaluated on 2D panoramic X-ray images. There is no empirical evidence or theoretical analysis of how the model would generalize to 3D data.
- What evidence would resolve it: Testing the model on a 3D dental dataset and comparing its performance metrics (IoU, DSC, RIoU) with those achieved on 2D images would provide the necessary evidence.

### Open Question 2
- Question: What is the impact of varying the patch size and overlap on the model's performance?
- Basis in paper: [inferred] The paper mentions that images are divided into 512x512 patches with 10x10 overlap for GPU fitting, but does not explore how different patch sizes or overlaps affect performance.
- Why unresolved: The choice of patch size and overlap is presented as a practical decision without experimental validation of its optimality.
- What evidence would resolve it: Conducting experiments with different patch sizes and overlap values, and analyzing the resulting changes in performance metrics would clarify the impact.

### Open Question 3
- Question: How robust is the model to varying image qualities, such as low resolution or high noise levels?
- Basis in paper: [explicit] The paper discusses challenges with lower-resolution images and mentions poor annotations with sharp edges and cones as factors affecting performance.
- Why unresolved: While the paper acknowledges these issues, it does not provide a systematic evaluation of the model's robustness to different image quality factors.
- What evidence would resolve it: Testing the model on datasets with controlled variations in resolution, noise levels, and annotation quality, and measuring performance degradation, would demonstrate its robustness.

## Limitations

- Computational complexity due to EfficientNet-B7 backbone requiring substantial GPU resources
- Patch-based processing may introduce boundary artifacts between patches
- 32-label system assumes consistent tooth numbering across all patients, which may not hold for cases with missing teeth or developmental anomalies

## Confidence

- **High confidence**: The segmentation performance metrics (IoU 82.43%, DSC 90.37%) are well-supported by the test set evaluation and demonstrate clear improvement over baseline models.
- **Medium confidence**: The OBB generation through PCA is mathematically sound but relies on the assumption that tooth shapes are sufficiently regular for principal component analysis to capture the correct orientation axis.
- **Low confidence**: The attention gate implementation details and the specific post-processing parameters for removing small unwanted regions are not fully specified, making exact reproduction challenging.

## Next Checks

1. Cross-dataset validation: Test the trained model on an independent dental X-ray dataset to assess generalization beyond the DNS dataset, particularly for cases with varying image quality and patient demographics.

2. Boundary artifact analysis: Evaluate the impact of patch-based processing by comparing predictions on full images versus stitched patches, specifically checking for discontinuities at patch boundaries.

3. Robustness to anomalies: Create a test set with synthetic modifications including missing teeth, supernumerary teeth, and severe rotations to assess model performance under non-standard anatomical conditions.