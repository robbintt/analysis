---
ver: rpa2
title: Unsupervised anomaly localization in high-resolution breast scans using deep
  pluralistic image completion
arxiv_id: '2305.03098'
source_url: https://arxiv.org/abs/2305.03098
tags:
- image
- anomaly
- completion
- normal
- completions
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of localizing tumors in high-resolution
  Digital Breast Tomosynthesis (DBT) scans, where standard anomaly detection methods
  struggle due to natural tissue variability and similarity between normal and cancerous
  regions. The authors propose PICARD, a pluralistic image completion approach that
  uses spatial dropout to generate diverse inpainting samples of masked image patches.
---

# Unsupervised anomaly localization in high-resolution breast scans using deep pluralistic image completion

## Quick Facts
- **arXiv ID:** 2305.03098
- **Source URL:** https://arxiv.org/abs/2305.03098
- **Reference count:** 23
- **Key outcome:** PICARD achieves 0.875 pixel-level AUC for tumor localization in DBT scans, outperforming state-of-the-art by over 10%

## Executive Summary
This paper introduces PICARD, an unsupervised anomaly localization method for high-resolution breast scans that addresses the challenge of tumor detection in Digital Breast Tomosynthesis (DBT) where standard methods struggle due to natural tissue variability. The approach uses spatial dropout during inference to generate diverse image completions of masked regions, then applies a minimum completion distance (MCD) metric to detect anomalies without requiring anomalous training data. Evaluated on a large DBT dataset, PICARD demonstrates state-of-the-art performance for tumor localization while maintaining computational efficiency.

## Method Summary
PICARD employs a pluralistic image completion approach where spatial dropout is applied to a completion network during inference to generate multiple diverse completions of masked image patches. These completions are then compared to the original masked regions using the minimum completion distance (MCD) metric in feature space. The method operates on 256×256 patches extracted from DBT slices, using a GAN-based completion network trained on healthy tissue. For each patch, M completions are sampled using spatial dropout, and the minimum L2 distance between the original region and these completions serves as the anomaly score. Heatmaps are generated through bicubic interpolation of patch-level scores.

## Key Results
- Achieves pixel-level AUC of 0.875 for tumor localization on DBT dataset
- Outperforms state-of-the-art unsupervised methods by over 10%
- Demonstrates robustness to small tumors (under 10mm) and dense breast tissue
- Processes patches in approximately 6.2 seconds each on a single GPU

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Dropout layers during inference introduce variability in completions that enables sampling from a distribution of normal completions rather than a single deterministic output.
- **Mechanism:** Spatial dropout randomly zeros out entire channels of activation maps during each forward pass, causing the network to produce slightly different completions for the same masked input.
- **Core assumption:** The dropout-induced variability is sufficient to approximate the true distribution of normal completions for a given masked region.
- **Evidence anchors:** [abstract] mentions spatial dropout's effectiveness at generating diverse completions; [section] describes using spatial dropout within the completion network G.
- **Break condition:** If dropout does not introduce sufficient variability, or if the completion network is too rigid, pluralistic sampling will fail.

### Mechanism 2
- **Claim:** Minimum completion distance (MCD) is a more faithful measure of anomaly than using a single completion because it accounts for the multimodal nature of possible normal completions.
- **Mechanism:** By computing the minimum L2 distance between the ground truth and multiple sampled completions in feature space, MCD captures how likely the ground truth is to belong to the normal distribution.
- **Core assumption:** Anomalous regions are unlikely to be close to any normal completion, while normal regions will have at least one close normal completion in the sample.
- **Evidence anchors:** [abstract] introduces MCD as a new metric enabled by stochastic completions; [section] defines MCD using minimum distance over completion samples.
- **Break condition:** If the distribution of normal completions is not well-captured by the sampled completions, or if anomalies are too similar to normal completions, MCD will fail.

### Mechanism 3
- **Claim:** Comparing image features to features of completions conditioned on the same surroundings is more robust to high variability in medical data than comparing to a learned normal feature distribution.
- **Mechanism:** The completion network generates completions based on the surrounding context, so comparing the ground truth to these completions directly tests if the region is consistent with its context.
- **Core assumption:** The context is sufficient to constrain the possible completions, and anomalies will be inconsistent with their context.
- **Evidence anchors:** [abstract] notes the problem is alleviated by solving from image completion perspective; [section] explains using completions conditioned on surroundings.
- **Break condition:** If the context is ambiguous or if normal and anomalous regions can have similar completions given the same context, this mechanism will fail.

## Foundational Learning

- **Image completion networks and GANs:** Why needed here - The method relies on a completion network trained with a GAN-based architecture to generate realistic normal completions of masked regions. Quick check question: What is the role of the critic/encoder in the WGAN-based completion network?

- **Dropout and its application during inference:** Why needed here - Dropout is used during inference to introduce variability in the completions, enabling pluralistic sampling. Quick check question: How does spatial dropout differ from regular dropout, and why is it used here?

- **Anomaly detection metrics (AUC, pixel-level evaluation):** Why needed here - The performance of the method is evaluated using pixel-level AUC, which requires understanding how this metric works. Quick check question: How is pixel-level AUC calculated for anomaly localization, and what does it represent?

## Architecture Onboarding

- **Component map:** Input DBT slice → Patch extraction and masking → Completion network with spatial dropout → Encoder (critic) for feature extraction → MCD calculation → Heatmap generation
- **Critical path:** Input → Patch extraction → Completion (with dropout) → Feature extraction → MCD → Heatmap
- **Design tradeoffs:**
  - Using spatial dropout vs. training a dedicated pluralistic completion network: Simpler and faster, but potentially less optimal completions
  - Using MCD vs. mean/median distance: Theoretically better, but requires sufficient sample size
  - Using image space vs. feature space for MCD: Feature space may be more robust, but requires a good encoder
- **Failure signatures:**
  - Low AUC: Could indicate issues with the completion network, encoder, or MCD calculation
  - Slow inference: Could indicate issues with the parallelism or hardware utilization
  - False positives/negatives: Could indicate issues with the dropout probability or patch/mask size
- **First 3 experiments:**
  1. Test the completion network on a few masked DBT patches to verify it generates reasonable completions
  2. Test the MCD calculation on a few patches with known anomalies to verify it produces high scores for anomalies
  3. Test the heatmap generation on a small DBT slice to verify it produces a heatmap of the correct size and format

## Open Questions the Paper Calls Out
- How does the MCD metric perform with different types of generative models beyond GANs? The paper mentions that other generative models like normalizing flows, energy-based, or score-based methods could be tested in future work.
- What is the optimal dropout probability for the completion network to balance anatomical realism and completion diversity? The paper notes that choosing a dropout probability that maximizes anatomical realism would improve performance, but requires validation data with cancer images.
- How would the method perform on 3D DBT volumes instead of individual 2D slices? The current method operates on 2D slices of 3D DBT volumes, with the paper noting that extending to 3D is a potential future direction.

## Limitations
- The theoretical justification for why dropout produces meaningful pluralistic completions remains limited, relying primarily on empirical results
- The method's sensitivity to dropout probability and number of completion samples is not fully explored
- Performance on DBT data with varying tumor sizes and densities needs further validation

## Confidence
- High: The core PICARD pipeline and MCD metric are well-defined and the empirical results on the DBT dataset are compelling
- Medium: The claim that spatial dropout alone is sufficient for pluralistic sampling without additional training
- Medium: The superiority over feature-distribution-based anomaly detection methods for DBT data

## Next Checks
1. Perform ablation studies varying the dropout probability and number of completion samples to quantify the sensitivity of MCD to these hyperparameters
2. Test PICARD on DBT data with varying tumor sizes and densities to verify robustness claims beyond the reported results
3. Compare PICARD's completions and MCD scores against a baseline that uses deterministic completions (no dropout) to isolate the contribution of pluralistic sampling to the performance gain