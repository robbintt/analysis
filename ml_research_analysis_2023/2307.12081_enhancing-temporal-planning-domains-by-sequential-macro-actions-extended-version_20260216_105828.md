---
ver: rpa2
title: Enhancing Temporal Planning Domains by Sequential Macro-actions (Extended Version)
arxiv_id: '2307.12081'
source_url: https://arxiv.org/abs/2307.12081
tags:
- actions
- planning
- macro-actions
- macro-action
- effects
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes sequential temporal macro-actions to enhance
  temporal planning. The method constructs macro-actions by chaining sequences of
  durative actions, ensuring that the sequence remains executable while allowing concurrency
  with other actions.
---

# Enhancing Temporal Planning Domains by Sequential Macro-actions (Extended Version)

## Quick Facts
- arXiv ID: 2307.12081
- Source URL: https://arxiv.org/abs/2307.12081
- Reference count: 7
- Key outcome: Sequential temporal macro-actions improve coverage and sometimes plan quality in temporal planning domains

## Executive Summary
This paper proposes sequential temporal macro-actions to enhance temporal planning performance. The approach composes sequences of durative actions into macro-actions while preserving executability and allowing concurrency through mutex atoms. The method is evaluated on four domains including RoboCup Logistics League using three state-of-the-art planners. Results show significant coverage improvements, with Optic's coverage improving from 84% to 100% on RCLL, and YAHSP3 achieving 100% coverage with better plan quality. The approach yields more satisficing plans and sometimes better plan quality, particularly in logistics domains where action sequences are frequent.

## Method Summary
The method introduces sequential temporal macro-actions by chaining sequences of durative actions into single macro-actions. Preconditions, invariants, and effects are carefully composed to ensure the original sequence remains executable while allowing concurrency when safe. Mutex atoms are introduced to prevent interference between concurrent macro-actions on shared resources. The original planning task is transformed into an effect-safe task incorporating these mutex atoms. When solutions are found using macro-actions, they can be refined by unfolding macro-actions into their constituent actions while preserving temporal ordering and plan validity.

## Key Results
- Coverage improvements: Optic's coverage improved from 84% to 100% on RCLL domain
- YAHSP3 achieved 100% coverage on RCLL with better plan quality
- Relative makespan improved in 3 of 12 domain-planner combinations
- Overall yields more satisficing plans and sometimes better plan quality, especially in logistics domains

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Sequential temporal macro-actions guarantee plan applicability by preserving the exact ordering of internal events while suppressing unnecessary concurrency.
- Mechanism: Macro-actions encapsulate a sequence of durative actions into a single unit, with preconditions, invariants, and effects carefully composed to ensure the original sequence remains executable. Mutex atoms prevent interference between concurrent macro-actions on shared resources.
- Core assumption: The original sequence of actions is executable in the given domain; composing them into a macro-action doesn't introduce new conflicts.
- Evidence anchors:
  - [abstract] "guarantees the applicability of obtained plans, i.e., the sequence of original actions encapsulated by a macro-action is always executable."
  - [section 3] "the principal steps of our construction of macro-actions...where preconditions, invariants, and effects are assembled in a fine-grained way to enable concurrent execution when it does not compromise the macro-action applicability."
- Break condition: If the original sequence contains conflicting actions (e.g., mutual invariants that can't both be satisfied), the macro-action composition is undefined.

### Mechanism 2
- Claim: Mutex atoms enable safe concurrent execution of macro-actions without compromising the integrity of the plan.
- Mechanism: Mutex atoms are introduced for literals that would cause conflicts during the macro-action's execution. These atoms are added as preconditions to other macro-actions, ensuring that concurrent actions don't interfere with the macro-action's internal state changes.
- Core assumption: The mutex atoms accurately capture all potential conflicts between macro-actions.
- Evidence anchors:
  - [section 3] "the principal steps of our construction of macro-actions...where preconditions, invariants, and effects are assembled in a fine-grained way to enable concurrent execution when it does not compromise the macro-action applicability."
  - [section 3] "Definition 2 incorporates mutex atoms into the precondions and effects of effect-safe (macro-)actions ax."
- Break condition: If mutex atoms are not comprehensive enough to capture all conflicts, concurrent execution may lead to plan inconsistency.

### Mechanism 3
- Claim: Refinement of macro-actions into their constituent actions preserves plan validity.
- Mechanism: When a solution is found using macro-actions, it can be refined by unfolding the macro-actions into their original sequences of actions. The refinement process ensures that the temporal ordering of events is maintained, preserving the plan's validity.
- Core assumption: The solution found using macro-actions is valid for the original domain when the macro-actions are replaced by their constituent actions.
- Evidence anchors:
  - [section 3] "Definition 3 formalizes how a time-stamped macro-action (t, a) with a = a1 â—¦ a2 is unfolded into the sequence of (t1, a1) and (t2, a2) to obtain a refined plan."
  - [section 3] "Theorem 1, and Corollary 1 concludes that all possible orders of refinement steps lead to a similar solution in terms of ordinary (time-stamped) actions."
- Break condition: If the refinement process introduces new conflicts or violates temporal constraints, the refined plan may not be valid.

## Foundational Learning

- Concept: Temporal planning with durative actions and invariants
  - Why needed here: The paper builds upon the foundation of temporal planning, where actions have durations and invariants, and concurrency is a key aspect.
  - Quick check question: What are the three types of conditions that can be associated with a durative action in temporal planning?

- Concept: Classical planning macro-actions
  - Why needed here: The paper extends the concept of macro-actions from classical planning to the temporal planning setting, highlighting the additional challenges and considerations.
  - Quick check question: How do classical planning macro-actions differ from temporal planning macro-actions in terms of their impact on concurrency?

- Concept: Mutex locks and resource conflicts
  - Why needed here: The paper introduces mutex atoms to prevent resource conflicts between concurrent macro-actions, which is crucial for maintaining plan validity.
  - Quick check question: How do mutex atoms in this paper differ from traditional mutex locks in classical planning?

## Architecture Onboarding

- Component map: Macro-action composition -> Mutex atom generation -> Effect-safe task transformation -> Temporal planning solver -> Refinement

- Critical path:
  1. Compose sequences of durative actions into macro-actions
  2. Generate mutex atoms for potential conflicts
  3. Transform the original task into an effect-safe task
  4. Solve the effect-safe task using a temporal planner
  5. Refine the solution by unfolding macro-actions

- Design tradeoffs:
  - Tradeoff between plan quality and solving time: Macro-actions can improve solving time by reducing the search space, but may lead to longer plans if the original actions could have been executed in parallel
  - Tradeoff between generality and specificity: The macro-action composition is designed to be general, but may not capture all domain-specific optimizations

- Failure signatures:
  - If the macro-action composition is undefined, it indicates that the original sequence contains conflicting actions
  - If the refined plan is invalid, it suggests that the mutex atoms were not comprehensive enough to capture all conflicts

- First 3 experiments:
  1. Test the macro-action composition on a simple domain with known sequences of actions
  2. Evaluate the impact of mutex atoms on plan quality and solving time for a domain with resource conflicts
  3. Assess the effectiveness of the refinement process on a domain where the original actions could have been executed in parallel

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can macro-actions be automatically detected in a given temporal planning domain?
- Basis in paper: [explicit] The paper mentions this as a future work direction in the conclusion section.
- Why unresolved: The paper does not provide any methodology or algorithm for automatic detection of suitable macro-actions. It only evaluates manually constructed macro-actions.
- What evidence would resolve it: A method or algorithm that can analyze a PDDL domain and automatically identify frequent action sequences that could be encapsulated as macro-actions, along with experimental results showing improved planning performance.

### Open Question 2
- Question: Can the macro-action concept be extended to support parallel or overlapping macro-actions in temporal planning?
- Basis in paper: [explicit] The paper mentions this as a future direction in the conclusion section.
- Why unresolved: The paper only formalizes sequential macro-actions and does not explore more complex macro-action compositions involving parallelism or overlap.
- What evidence would resolve it: A formal definition of parallel and overlapping macro-actions in temporal planning, along with an evaluation showing their impact on planning performance compared to sequential macros.

### Open Question 3
- Question: How does the introduction of macro-actions affect the optimality of plans in temporal planning?
- Basis in paper: [explicit] The paper mentions that macro-actions aim to improve satisficing planning performance, but notes that optimality may be compromised.
- Why unresolved: The paper does not provide a formal analysis of the relationship between macro-actions and plan optimality. It only observes empirically that some optimal plans may be lost when using macros.
- What evidence would resolve it: A theoretical analysis or empirical study quantifying the trade-off between plan quality (optimality) and planning efficiency when using macro-actions, ideally identifying conditions under which optimality is preserved.

## Limitations
- The evaluation focuses primarily on coverage improvements rather than computational efficiency gains, which is a key motivation for macro-actions in planning
- The study uses only three planners and four domains, limiting generalizability to other temporal planning contexts
- The paper does not provide runtime statistics for the macro-action composition tool, making it unclear whether the preprocessing overhead is practical for larger domains

## Confidence
- High confidence in the technical mechanism: The composition of sequential macro-actions and the refinement process are formally defined and proven correct
- Medium confidence in empirical results: While the coverage improvements are statistically significant, the lack of runtime analysis and the limited domain coverage reduce confidence in practical applicability
- Low confidence in scalability claims: Without performance data on larger or more complex domains, the approach's scalability remains uncertain

## Next Checks
1. Measure and report the computational overhead of the macro-action composition tool on domains of increasing size to assess practical feasibility
2. Conduct runtime analysis comparing original vs. macro-enhanced planning, including preprocessing time, search time, and total solving time across all planners and domains
3. Test the approach on additional temporal planning domains with different characteristics (e.g., more concurrency opportunities, different action structures) to evaluate generalizability beyond the four domains used in the study