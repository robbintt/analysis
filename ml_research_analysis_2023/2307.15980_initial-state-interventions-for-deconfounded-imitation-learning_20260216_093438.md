---
ver: rpa2
title: Initial State Interventions for Deconfounded Imitation Learning
arxiv_id: '2307.15980'
source_url: https://arxiv.org/abs/2307.15980
tags:
- causal
- expert
- learning
- state
- algorithm
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work addresses the problem of causal confusion in imitation
  learning, where learned policies mistakenly attend to spuriously correlated features
  instead of causally relevant ones. The core method introduces a novel masking algorithm
  that leverages interventions on the initial system state to identify and eliminate
  causally confusing observations without requiring expert queries, reward functions,
  or causal graph specification.
---

# Initial State Interventions for Deconfounded Imitation Learning

## Quick Facts
- arXiv ID: 2307.15980
- Source URL: https://arxiv.org/abs/2307.15980
- Reference count: 40
- This work addresses causal confusion in imitation learning by introducing a masking algorithm that uses initial state interventions to identify and eliminate causally confusing observations without requiring expert queries or reward functions.

## Executive Summary
This paper tackles the problem of causal confusion in imitation learning, where learned policies attend to spuriously correlated features instead of causally relevant ones. The authors propose a novel masking algorithm that leverages interventions on the initial system state to identify and eliminate causally confusing observations. The method theoretically proves conservativeness guarantees and demonstrates effectiveness on CartPole and Reacher environments, achieving performance comparable to manually deconfounded baselines.

## Method Summary
The approach involves training a β-VAE on random-policy trajectories to obtain disentangled observations, then collecting expert trajectories from an intervened system with uniform S1 initialization. A masking algorithm using Hoeffding's D statistic identifies spurious confounders through independence tests, and a final behavior cloning policy is trained on masked observations. The method requires no expert queries, reward functions, or causal graph specification.

## Key Results
- The masking algorithm successfully eliminates nuisance features like colored squares and moving dots that correlate with previous actions but do not causally influence expert decisions
- Performance of the masked policy is comparable to manually deconfounded baselines on both CartPole and Reacher environments
- Theoretical proof shows the algorithm is conservative - it does not incorrectly mask observations that causally influence the expert actions

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Initial state interventions can break spurious statistical dependencies between observed confounders and expert actions by removing incoming edges from the unobserved random seed W.
- **Mechanism**: By intervening on S1 to assign a specific distribution, the algorithm eliminates the path W → S1 → O1 → A, breaking the confounding relationship that creates spurious correlations between observations and actions.
- **Core assumption**: The causal graph is time-invariant and the expert policy only attends to state-derived observational information.
- **Evidence anchors**:
  - [abstract]: "Our novel masking algorithm leverages the usual ability to intervene in the initial system state"
  - [section]: "This intervention yields a modified SCM fMs with a corresponding (not necessarily faithful) causal graph eGs, which removes the edge W → S1 in Gs"
  - [corpus]: Weak evidence - related papers focus on causal imitation learning but don't directly address initial state interventions for deconfounding
- **Break condition**: If the expert policy attends to features not derived from the state, or if the causal graph is not time-invariant, the mechanism fails.

### Mechanism 2
- **Claim**: Hoeffding's independence test can reliably detect whether state variables are statistically dependent on observations and actions within a reaction horizon.
- **Mechanism**: The algorithm uses Hoeffding's D statistic to test statistical dependence between state variables S1 and observation-action pairs, identifying potential causal relationships that can be verified through the masking process.
- **Core assumption**: The system SCM is interventionally absolutely continuous with bounded Radon-Nikodym derivatives.
- **Evidence anchors**:
  - [section]: "We rely on identifying whether two random variables are statistically dependent. While this is a challenging problem with a rich literature [23], in this paper, we only briefly introduce a well-known independence test for continuous distributions based on Hoeffding's D statistic"
  - [section]: "We define the boolean variable (t,t′)Do s,a to check these independencies"
  - [corpus]: Moderate evidence - several papers discuss statistical independence tests for causal inference, but none specifically validate Hoeffding's test for this application
- **Break condition**: If the independence test is inconsistent or if the assumptions about absolute continuity are violated, the mechanism breaks.

### Mechanism 3
- **Claim**: The masking algorithm is conservative - it will not mask observations that causally influence expert actions.
- **Mechanism**: Through theoretical analysis, the algorithm guarantees that if an observation causally affects expert actions, it will be preserved in the mask, ensuring no loss of causally relevant information.
- **Core assumption**: The system causal graph is faithful to the induced distribution.
- **Evidence anchors**:
  - [abstract]: "Under certain assumptions, we theoretically prove that this algorithm is conservative in the sense that it does not incorrectly mask observations that causally influence the expert"
  - [section]: "We prove that, under certain conditions, our procedure is conservative: if an observation causally affects the expert actions, it will not be masked"
  - [corpus]: Strong evidence - the paper "Causal Imitation Learning under Expert-Observable and Expert-Unobservable Confounding" directly addresses similar conservativeness guarantees
- **Break condition**: If the faithfulness assumption is violated or if the reaction horizon H is too small to capture true causal relationships, the conservativeness guarantee fails.

## Foundational Learning

- **Concept: Structural Causal Models (SCMs)**
  - Why needed here: The entire method relies on modeling the system as an SCM to reason about causal relationships between states, observations, and actions
  - Quick check question: In an SCM, what does the structural equation fV for a node V represent?

- **Concept: d-separation and conditional independence**
  - Why needed here: The algorithm uses independence tests to identify potential causal relationships, which requires understanding d-separation in causal graphs
  - Quick check question: If two nodes X and Y are d-separated by a set Z in a causal graph, what does this imply about their conditional independence in the induced distribution?

- **Concept: Intervention and do-calculus**
  - Why needed here: The method relies on intervening on the initial state to break spurious correlations, which requires understanding the mechanics of interventions in causal models
  - Quick check question: What is the difference between observing X = x and intervening with do(X = x) in terms of their effects on the causal graph?

## Architecture Onboarding

- **Component map**: β-VAE -> Masking algorithm -> Behavior cloning policy
- **Critical path**: β-VAE training → initial state intervention data collection → masking algorithm execution → behavior cloning with masked observations
- **Design tradeoffs**: Larger latent space dimensions in β-VAE improve disentanglement but increase computational cost; smaller reaction horizons H reduce computation but may miss longer-term causal effects
- **Failure signatures**: Poor β-VAE disentanglement leads to masking of causally relevant features; incorrect independence test results cause spurious masking or failure to mask confounders
- **First 3 experiments**:
  1. Verify β-VAE disentanglement by checking if nuisance features can be isolated in latent space
  2. Test masking algorithm on a simple system with known confounding to verify conservativeness
  3. Compare performance of masked vs. vanilla behavior cloning on CartPole environment

## Open Questions the Paper Calls Out

The paper does not explicitly call out open questions, but based on the discussion section, several limitations suggest open research directions:

- The method's effectiveness in environments with entangled confounders versus neatly disentangled ones
- The sensitivity of the masking algorithm to the choice of Hoeffding threshold hyperparameter γ
- How the method scales to high-dimensional observation spaces with many potential confounders

## Limitations

- The method's effectiveness depends critically on the faithfulness assumption of the causal graph and the assumption that expert policy only attends to state-derived observational information
- The conservativeness guarantee may fail if the reaction horizon H is insufficient to capture true causal relationships
- The β-VAE disentanglement quality directly impacts the masking algorithm's ability to correctly identify nuisance features

## Confidence

- **High confidence**: The theoretical conservativeness guarantee under stated assumptions, and the core mechanism of using initial state interventions to break spurious correlations
- **Medium confidence**: The practical effectiveness of Hoeffding's D statistic for independence testing in high-dimensional image observations, and the β-VAE's ability to consistently disentangle nuisance features from causally relevant ones
- **Low confidence**: The generalizability of the method to complex, real-world environments with richer causal structures and non-stationary dynamics

## Next Checks

1. **Conservativeness validation**: Run the masking algorithm on a synthetic environment where the ground truth causal relationships are known, and verify that no causally relevant observations are incorrectly masked while all confounders are successfully identified
2. **Independence test sensitivity**: Systematically vary the number of trajectories N and reaction horizon H, measuring how these parameters affect the masking algorithm's performance and the stability of Hoeffding test results
3. **β-VAE disentanglement quality**: Implement ablation studies removing the β-VAE component and using raw observations directly, comparing performance to quantify the impact of disentanglement quality on the overall method effectiveness