---
ver: rpa2
title: Online Joint Assortment-Inventory Optimization under MNL Choices
arxiv_id: '2304.02022'
source_url: https://arxiv.org/abs/2304.02022
tags:
- inventory
- algorithm
- optimization
- assortment
- regret
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses online joint assortment-inventory optimization
  under the Multinomial Logit (MNL) choice model with unknown attraction parameters.
  The retailer must learn these parameters while making periodic assortment and inventory
  decisions to maximize expected profit over a planning horizon.
---

# Online Joint Assortment-Inventory Optimization under MNL Choices

## Quick Facts
- arXiv ID: 2304.02022
- Source URL: https://arxiv.org/abs/2304.02022
- Reference count: 38
- Primary result: Novel algorithm achieves nearly optimal regret rate for online joint assortment-inventory optimization under MNL choices

## Executive Summary
This paper addresses the challenging problem of joint assortment and inventory optimization under the Multinomial Logit (MNL) choice model with unknown attraction parameters. The retailer must learn these parameters while making periodic decisions to maximize expected profit over a planning horizon. The authors propose a novel algorithm that balances exploration and exploitation through a new estimator for MNL attraction parameters and an innovative approach of adaptively tuning products' unit profits to incentivize exploration. The method establishes both upper and lower regret bounds, demonstrating near-optimal performance.

## Method Summary
The algorithm employs an epoch-based structure where inventory decisions are fixed within each epoch but updated between epochs. It uses a novel estimator based on no-purchase counts to estimate MNL attraction parameters, constructs confidence bounds around these estimates, and adaptively tunes unit profits to incentivize exploration of under-represented products. The approach relies on approximate static optimization oracles to handle practical implementation while maintaining theoretical guarantees. The method balances exploration-exploitation by forcing the algorithm to consider assortments containing less-explored products through profit manipulation.

## Key Results
- Establishes regret upper bound and matching lower bound, showing near-optimal regret rate
- Novel estimator for MNL parameters using no-purchase counts provides consistent estimates despite censored demand
- Adaptive profit tuning mechanism successfully incentivizes exploration without violating monotonicity
- Incorporates approximate static optimization oracles for practical implementation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Tuning unit profits (known parameters) is a valid exploration strategy.
- Mechanism: By increasing unit profits for under-explored products, the algorithm artificially inflates their perceived value, incentivizing the optimizer to select assortments containing them, thereby forcing exploration without needing to adjust unknown parameters.
- Core assumption: Expected profit is monotone in unit profits, so inflating them strictly increases optimistic profit estimates.
- Evidence anchors:
  - [abstract] "a novel approach to incentivize exploration by adaptively tuning certain known and unknown parameters"
  - [section 4.4] "Lemma 5 asserts that, although R(u;v,r) is not necessarily monotone in v with a fixed r, R(u; ˜v(α), ˜r(α)) is monotone in α as ˜v(α) and ˜r(α) simultaneously vary with α."

### Mechanism 2
- Claim: Summary statistics based on no-purchase counts provide consistent parameter estimates despite censored demand.
- Mechanism: Counting no-purchases before first purchase of each product creates summary statistics whose distributions depend only on product-specific attraction parameters, not on dynamic assortment changes caused by stockouts.
- Core assumption: No-purchase counts are independent of other products' stockout timing and follow a simple geometric distribution.
- Evidence anchors:
  - [section 4.2] "the summary statistic µi,ℓ for each product i follows a geometric distribution, and its expectation is given by the reciprocal of the corresponding attraction parameter vi"
  - [section 4.2] "the distribution of the summary statistic µi,ℓ remains fixed and simple even with a dynamically changing assortment set"

### Mechanism 3
- Claim: Epoch-based structure with fixed inventory decisions per epoch enables tractable exploration-exploitation balancing.
- Mechanism: By fixing inventory decisions within epochs and only updating between epochs, the algorithm creates stationary choice environments that simplify parameter estimation and profit optimization.
- Core assumption: Epoch length is sufficient to gather meaningful statistics while keeping computational complexity manageable.
- Evidence anchors:
  - [section 4.2] "we group the whole T inventory cycles into different epochs consisting of consecutive cycles"
  - [section 5.1] "Lemma 6 shows that the expected value of the epoch length |Cℓ| decreases with the expected number of single-cycle customer arrivalM but increases with the maximum assortment sizeK"

## Foundational Learning

- Concept: Multinomial Logit (MNL) choice model
  - Why needed here: The entire problem formulation and algorithm design depend on the specific substitution patterns implied by MNL
  - Quick check question: What is the key assumption about customer substitution behavior under MNL that distinguishes it from independent demand models?

- Concept: Upper Confidence Bound (UCB) algorithm framework
  - Why needed here: The proposed algorithm extends UCB principles to the joint assortment-inventory setting
  - Quick check question: How does the standard UCB principle of "optimism in the face of uncertainty" apply when profit functions are non-monotonic in parameters?

- Concept: Exploration-exploitation tradeoff in bandit problems
  - Why needed here: The core algorithmic challenge is balancing learning unknown parameters versus maximizing immediate profit
  - Quick check question: What distinguishes the exploration challenge in this problem from standard multi-armed bandits?

## Architecture Onboarding

- Component map: Parameter estimator -> Confidence bounds -> Profit tuner -> Static optimizer -> Inventory decision
- Critical path: Estimator → Confidence bounds → Profit tuner → Static optimizer → Inventory decision
- Design tradeoffs: Fixed epochs simplify estimation but may delay adaptation; profit tuning enables exploration but adds complexity; exact oracle assumption simplifies analysis but limits practicality
- Failure signatures: Linear regret growth indicates insufficient exploration; inconsistent parameter estimates suggest estimator breakdown; computational intractability indicates optimization oracle inadequacy
- First 3 experiments:
  1. Validate parameter estimator consistency on synthetic data with known parameters and varying stockout rates
  2. Test profit tuning mechanism's ability to force exploration of under-represented products
  3. Benchmark regret performance against greedy and vUCB-only approaches on small-scale problems

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the proposed exploration-exploitation algorithm be extended to handle inventory carryover?
- Basis in paper: [explicit] The paper mentions that incorporating inventory carryover is an interesting future research direction, as it would pose significant technical challenges to parameter estimation, exploration-exploitation trade-off, and the optimization of inventory decisions.
- Why unresolved: The current algorithm assumes that inventory leftovers are salvaged at the end of each cycle, which simplifies the problem. Handling inventory carryover would require a more complex dynamic programming approach and would impact the estimation and exploration-exploitation aspects of the algorithm.
- What evidence would resolve it: Developing and testing an extended algorithm that can handle inventory carryover, and comparing its performance to the current algorithm in terms of regret and computational complexity.

### Open Question 2
- Question: Can the proposed algorithm be adapted to handle a large number of products by leveraging product features to reduce dimensionality?
- Basis in paper: [explicit] The paper suggests that when there are a large number of products, learning the demand distribution for each product separately may be inefficient. It proposes that products could be effectively described by a small number of structured product features, and it would be interesting to study how to leverage such structure to efficiently learn demands and solve for optimal assortment-inventory decisions.
- Why unresolved: The current algorithm treats each product independently, which may not be scalable when the number of products is large. Leveraging product features could potentially reduce the dimensionality of the problem and improve learning efficiency.
- What evidence would resolve it: Developing and testing an algorithm that incorporates product features to reduce dimensionality, and comparing its performance to the current algorithm in terms of regret and computational efficiency.

### Open Question 3
- Question: Can the proposed algorithm be extended to handle more complex choice models beyond the MNL model?
- Basis in paper: [explicit] The paper focuses on the MNL choice model, but mentions that there are other choice models, such as the mixture-of-logits and nested logit models, that have been proposed in the literature. It would be interesting to study how the algorithm can be adapted to handle these more complex choice models.
- Why unresolved: The current algorithm is specifically designed for the MNL choice model, and extending it to handle more complex choice models would require addressing additional challenges in parameter estimation and exploration-exploitation.
- What evidence would resolve it: Developing and testing an algorithm that can handle a specific complex choice model, such as the mixture-of-logits or nested logit model, and comparing its performance to the current algorithm in terms of regret and computational complexity.

## Limitations
- Relies on assumption of an exact static optimization oracle which may not be practical
- Performance depends on specific properties of the MNL choice model that may not extend to other choice models
- Epoch-based structure may delay adaptation to changing market conditions

## Confidence
- Theoretical guarantees: Medium (depends on oracle assumption and technical conditions)
- Exploration mechanism: High (monotonicity proof appears sound)
- Estimator consistency: Medium (relies on specific properties of no-purchase counts)
- Practical implementation: Low-Medium (approximate oracles may degrade performance)

## Next Checks
1. Implement the algorithm with an approximate static optimization oracle and measure performance degradation compared to the theoretical bounds
2. Test the estimator's robustness to different stockout correlation patterns by simulating scenarios where popular products systematically stock out before less popular ones
3. Validate the profit tuning mechanism's effectiveness in forcing exploration by measuring the frequency of each product appearing in offered assortments across different tuning parameter settings