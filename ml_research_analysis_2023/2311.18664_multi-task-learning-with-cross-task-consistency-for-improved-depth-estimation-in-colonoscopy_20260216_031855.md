---
ver: rpa2
title: Multi-task learning with cross-task consistency for improved depth estimation
  in colonoscopy
arxiv_id: '2311.18664'
source_url: https://arxiv.org/abs/2311.18664
tags:
- depth
- normal
- surface
- estimation
- network
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The authors propose a multi-task learning approach for depth estimation
  in colonoscopy, addressing the challenge of limited ground truth data and complex
  colon topology. Their method, Col3D-MTL, utilizes a shared encoder and two decoders
  for depth and surface normal prediction, incorporating attention mechanisms and
  a cross-task consistency loss.
---

# Multi-task learning with cross-task consistency for improved depth estimation in colonoscopy

## Quick Facts
- arXiv ID: 2311.18664
- Source URL: https://arxiv.org/abs/2311.18664
- Reference count: 20
- Key outcome: 14.17% improvement in relative error and 10.4% improvement in δ1 accuracy compared to BTS baseline

## Executive Summary
This paper proposes Col3D-MTL, a multi-task learning framework for monocular depth estimation in colonoscopy. The method addresses challenges of limited ground truth data and complex colon topology by jointly training depth and surface normal prediction tasks with cross-task consistency. The approach achieves state-of-the-art results on the C3VD dataset, demonstrating that auxiliary tasks can improve feature extraction in low-texture regions of colon mucosa.

## Method Summary
The Col3D-MTL framework uses a shared ResNet-50 encoder with ASPP for feature extraction, paired with two specialized decoders for depth estimation (using LPG blocks with CBAM attention) and surface normal prediction (using UNC blocks). A D2SN module computes surface normals from depth predictions to enforce cross-task consistency through a dedicated loss term. The model is trained end-to-end using a weighted sum of depth, surface normal, and cross-task consistency losses on the C3VD dataset.

## Key Results
- 14.17% improvement in relative error compared to BTS baseline
- 10.4% improvement in δ1 accuracy (percentage of pixels with depth error within 1.25x ground truth)
- Significant improvements across all evaluation metrics (SILog, AbsRel, δ1-δ3)
- Enhanced performance particularly in low-texture regions of colon mucosa

## Why This Works (Mechanism)

### Mechanism 1
Multi-task learning with surface normal prediction improves geometric feature extraction for depth estimation in colonoscopy. The shared encoder extracts features beneficial to both tasks, and the auxiliary surface normal task acts as a regularizer that enhances the representation of scene geometry. Core assumption: Surface normal estimation and depth estimation are geometrically related tasks that share complementary information. Evidence: Low-texture regions benefit from auxiliary task features, and joint multi-task training is shown to improve performance in monocular depth estimation surveys.

### Mechanism 2
Cross-task consistency loss enforces geometric consistency between depth and surface normal predictions. A warping module computes surface normals from depth predictions, and the consistency loss minimizes the discrepancy between this warped surface normal and the directly predicted surface normal. Core assumption: Depth and surface normal are different representations of the same underlying 3D scene geometry, so they should be consistent. Evidence: The warping module introduces a consistency constraint by comparing depth-derived and directly predicted surface normals.

### Mechanism 3
Attention mechanisms improve global context awareness, leading to better depth estimation. CBAM modules are incorporated at skip connections and decoder stages to enhance feature representation by focusing on relevant features and suppressing irrelevant ones. Core assumption: Convolutional neural networks alone lack sufficient global context to properly relate local features for accurate depth estimation. Evidence: BTS-CBAM network yields relative improvement over BTS by 8.9% and 2.4% in terms of SILog and δ1, respectively.

## Foundational Learning

- Concept: Geometric relationship between depth and surface normal
  - Why needed here: Understanding this relationship is crucial for designing the multi-task learning framework and the cross-task consistency loss.
  - Quick check question: Why are depth and surface normal considered geometrically related tasks?

- Concept: Attention mechanisms (CBAM)
  - Why needed here: CBAM modules are incorporated to improve global context awareness and feature representation.
  - Quick check question: How do CBAM modules enhance feature representation in the context of depth estimation?

- Concept: Surface normal representation
  - Why needed here: Surface normal maps are used as an auxiliary task and for cross-task consistency.
  - Quick check question: How is a surface normal map represented as an RGB image, and what does each channel correspond to?

## Architecture Onboarding

- Component map: Shared encoder (ResNet-50 + ASPP) → Depth decoder (LPG + CBAM) → D2SN → Cross-task consistency loss; Shared encoder → Surface normal decoder (UNC)
- Critical path: Shared encoder → Depth decoder (with attention) → D2SN → Cross-task consistency loss
- Design tradeoffs: Shared encoder vs. separate encoders for each task; Choice of attention mechanism (CBAM vs. other options); L1 vs. L2 loss for surface normal optimization
- Failure signatures: Blurry depth maps (insufficient attention or geometric feature extraction); Inconsistent surface normal predictions (poor cross-task consistency); Inaccurate depth estimates in low-texture regions (insufficient feature extraction)
- First 3 experiments: 1) Validate the impact of CBAM modules on depth estimation performance. 2) Compare L1 vs. L2 loss for surface normal optimization. 3) Evaluate the effectiveness of the cross-task consistency loss.

## Open Questions the Paper Calls Out

The paper explicitly mentions future work focusing on improving robustness to translate from synthetic datasets to real-world clinical data, but does not call out specific open questions about the current method's limitations or extensions.

## Limitations

- Unknown implementation details of UNC blocks and D2SN module may hinder faithful reproduction
- Specific hyperparameters (learning rate, batch size, weight decay) not mentioned in the paper
- No ablation studies on individual component contributions to final performance

## Confidence

- High: Geometric relationship between depth and surface normal tasks, and effectiveness of multi-task learning in improving feature extraction
- Medium: Impact of attention mechanisms (CBAM) on depth estimation performance
- Low: Exact implementation details of UNC blocks and D2SN module, and individual contributions of each component

## Next Checks

1. Conduct ablation studies to assess the impact of CBAM modules, cross-task consistency loss, and other components on the final depth estimation performance.
2. Compare the performance of the Col3D-MTL framework with other state-of-the-art multi-task learning approaches for depth estimation in colonoscopy.
3. Investigate the generalization ability of the model by evaluating its performance on other colonoscopy datasets or in different clinical settings.