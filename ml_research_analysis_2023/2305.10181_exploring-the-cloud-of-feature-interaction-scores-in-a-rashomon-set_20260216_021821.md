---
ver: rpa2
title: Exploring the cloud of feature interaction scores in a Rashomon set
arxiv_id: '2305.10181'
source_url: https://arxiv.org/abs/2305.10181
tags:
- feature
- interaction
- interactions
- rashomon
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces a novel framework for analyzing feature interactions
  in machine learning models by exploring the "cloud" of interaction scores across
  a set of models with similar performance (the Rashomon set). The authors propose
  a greedy search algorithm to sample models from this set and calculate feature interaction
  scores (FIS), which measure how much the interaction between features contributes
  to model predictions.
---

# Exploring the cloud of feature interaction scores in a Rashomon set

## Quick Facts
- arXiv ID: 2305.10181
- Source URL: https://arxiv.org/abs/2305.10181
- Reference count: 40
- Primary result: A framework to analyze feature interactions across multiple well-performing models by exploring a "cloud" of interaction scores in the Rashomon set

## Executive Summary
This paper introduces a novel framework for analyzing feature interactions in machine learning models by exploring the "cloud" of interaction scores across a set of models with similar performance (the Rashomon set). The authors propose a greedy search algorithm to sample models from this set and calculate feature interaction scores (FIS), which measure how much the interaction between features contributes to model predictions. They introduce two visualization tools: Halo plots to show how joint effects vary within the Rashomon set, and swarm plots to display the distribution of FIS values across models. Experiments on synthetic data, recidivism prediction, and image classification demonstrate that feature interactions can vary dramatically across models with similar accuracy, highlighting the importance of considering multiple models when analyzing feature interactions.

## Method Summary
The paper proposes a framework to analyze feature interactions by exploring the Rashomon set - a collection of models with similar accuracy but potentially different interaction strengths. A greedy search algorithm iteratively modifies feature masks to find models within a specified loss tolerance of a reference model. For each sampled model, Feature Interaction Scores (FIS) are calculated as the difference between joint effects and individual effects. The method is applied to synthetic data, recidivism prediction using COMPAS dataset, and image classification with COCO dataset using a pre-trained ViT-B-16 model.

## Key Results
- Feature interactions vary significantly across models in the Rashomon set, even when models have similar accuracy
- Halo plots effectively visualize the variance in joint effects across the Rashomon set
- Swarm plots reveal that individual feature effects can be stable while interaction effects vary dramatically
- The greedy search algorithm successfully samples models with diverse FIS values within the Rashomon set

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Feature interactions extracted from a single model may not be trustworthy due to the existence of multiple well-performing models with different interaction strengths.
- Mechanism: The paper proposes exploring feature interactions within a set of approximately equally accurate models (the Rashomon set) rather than relying on a single model.
- Core assumption: The Rashomon set exists for any given task, containing multiple models with similar performance but potentially different feature interactions.
- Evidence anchors:
  - [abstract] "However, we argue that the feature interactions extracted from a single pre-specified model may not be trustworthy since: a well-trained predictive model may not preserve the true feature interactions and there exist multiple well-performing predictive models that differ in feature interaction strengths."
  - [section] "However, we argue that the high accuracy of a well-trained model can not guarantee the preservation of true feature interactions. As a simple example, we consider the two error-free models x = -b±√(b²-4ac)/2a for finding a root of the quadratic equation ax² + bx + c = 0; the input variables a, b, and c exhibit different feature interactions in these two models."
- Break condition: If the Rashomon set is empty or contains only one model, this mechanism fails.

### Mechanism 2
- Claim: The Feature Interaction Score (FIS) can quantify feature interaction strength in a model class by measuring the difference between joint effects and individual effects.
- Mechanism: FIS is calculated as the difference between the loss change of replacing multiple features simultaneously and the sum of loss changes of replacing them individually.
- Core assumption: Loss functions can be decomposed into main effects and interaction effects, allowing measurement of interaction strength.
- Evidence anchors:
  - [abstract] "We introduce the feature interaction score (FIS) in the context of a Rashomon set, representing a collection of models that achieve similar accuracy on a given task."
  - [section] "With this in mind, the FIS is defined as the difference between the loss change of replacing multiple features simultaneously and the sum of the loss change of replacing multiple features individually: FISI(f) = φI(f) - ∑i∈I φi(f)."
- Break condition: If the loss function cannot be decomposed as assumed, or if the interaction effects are negligible.

### Mechanism 3
- Claim: The greedy search algorithm can effectively explore the Rashomon set to find models with extreme FIS values.
- Mechanism: The algorithm searches for individual feature masks that maximize or minimize the loss within the Rashomon set, then calculates FIS for all feature combinations.
- Core assumption: The Rashomon set can be characterized by a mask-based approach, and exploring individual feature effects is sufficient to approximate the full range of FIS values.
- Evidence anchors:
  - [section] "To search all possible (mi)pi=1 for features' main effects within the Rashomon set, we propose a greedy search algorithm."
  - [section] "The searching process continues until the loss condition is not satisfied Mmi /∈ F."
- Break condition: If the mask-based characterization is insufficient, or if the greedy search gets stuck in local optima.

## Foundational Learning

- Concept: Rashomon set
  - Why needed here: Understanding the concept of multiple equally accurate models is fundamental to the paper's approach.
  - Quick check question: What is the Rashomon set, and why is it relevant to feature interaction analysis?

- Concept: Feature interaction
  - Why needed here: The paper builds on existing research about feature interactions, so understanding this concept is crucial.
  - Quick check question: How is feature interaction defined in the context of this paper, and how does it differ from individual feature effects?

- Concept: Model reliance and variable importance
  - Why needed here: The paper uses concepts from model reliance and variable importance to define FIS and explore the Rashomon set.
  - Quick check question: What is the relationship between model reliance, variable importance, and the proposed FIS?

## Architecture Onboarding

- Component map:
  - Reference model training -> Greedy search algorithm -> FIS calculation module -> Visualization tools (Halo plots and swarm plots)

- Critical path:
  1. Train a reference model
  2. Define the Rashomon set using a loss tolerance
  3. Apply the greedy search algorithm to explore the set
  4. Calculate FIS for all feature combinations
  5. Generate visualizations of FIS distribution

- Design tradeoffs:
  - Computational cost vs. comprehensiveness of Rashomon set exploration
  - Accuracy of FIS estimation vs. sampling resolution
  - Complexity of visualization vs. interpretability

- Failure signatures:
  - If the greedy search converges too quickly, it may not explore the full Rashomon set
  - If the loss tolerance is too tight, the Rashomon set may be empty or too small
  - If the mask-based approach is insufficient, it may miss important models

- First 3 experiments:
  1. Apply the framework to a synthetic dataset with known feature interactions
  2. Compare FIS results with existing interaction detection methods on benchmark datasets
  3. Explore feature interactions in a real-world dataset (e.g., recidivism prediction) and analyze the results using Halo and swarm plots

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal algorithm to efficiently characterize the Rashomon set boundary for feature interaction analysis?
- Basis in paper: [explicit] The paper proposes a greedy search algorithm but notes it is "difficult to get a closed-form expression of the exact hypothetical bounds in general"
- Why unresolved: The greedy search algorithm may not be optimal for large feature spaces or complex model classes, and finding exact boundaries remains computationally challenging
- What evidence would resolve it: Comparative analysis of alternative sampling methods (e.g., active learning, Bayesian optimization) against the greedy algorithm for Rashomon set characterization across diverse model classes and datasets

### Open Question 2
- Question: How do feature interactions identified in the Rashomon set relate to causal relationships in the underlying data generating process?
- Basis in paper: [inferred] The paper demonstrates that feature interactions vary across models with similar accuracy, but doesn't address whether these interactions reflect true causal mechanisms
- Why unresolved: The statistical definition of feature interactions doesn't necessarily imply causal relationships, and the paper doesn't explore this distinction
- What evidence would resolve it: Empirical studies comparing Rashomon-set feature interactions with causal effect estimates from randomized experiments or causal inference methods on datasets with known causal structures

### Open Question 3
- Question: What is the relationship between model class reliance (MCR) and feature interaction score cloud (FISC) in explaining model behavior?
- Basis in paper: [explicit] The paper compares its method with MCR in the recidivism prediction experiment but doesn't provide a theoretical framework for their relationship
- Why unresolved: While both methods explore model behavior across a Rashomon set, they measure different properties (variable importance vs. interaction strength) without a unifying theoretical connection
- What evidence would resolve it: A formal analysis establishing when MCR and FISC capture complementary vs. redundant information about model behavior, including conditions under which they would diverge or align

## Limitations

- The greedy search algorithm's effectiveness in exploring the Rashomon set is supported by synthetic data experiments, but real-world validation is limited
- The computational complexity of the algorithm may become prohibitive for high-dimensional feature spaces, potentially limiting its practical applicability
- The paper does not address potential biases in the FIS calculation method, particularly when dealing with correlated features or when the loss function is not well-behaved

## Confidence

- **High Confidence**: The theoretical framework connecting Rashomon sets to feature interaction analysis is well-established and logically sound
- **Medium Confidence**: The greedy search algorithm's effectiveness in exploring the Rashomon set is supported by synthetic data experiments, but real-world validation is limited
- **Medium Confidence**: The visualization tools (Halo and swarm plots) provide intuitive representations of FIS distributions, but their practical utility in guiding model selection is not thoroughly demonstrated

## Next Checks

1. **Scalability Assessment**: Evaluate the greedy search algorithm's performance on high-dimensional datasets (e.g., >100 features) to determine its practical limits and potential optimizations
2. **Bias Analysis**: Investigate how feature correlations and non-linear loss functions affect FIS calculations, potentially developing correction methods or alternative metrics
3. **Real-world Application**: Apply the framework to a diverse set of real-world datasets with known feature interactions (e.g., healthcare, finance) and compare the results with domain expertise and existing interaction detection methods