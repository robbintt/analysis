---
ver: rpa2
title: 'SamDSK: Combining Segment Anything Model with Domain-Specific Knowledge for
  Semi-Supervised Learning in Medical Image Segmentation'
arxiv_id: '2308.13759'
source_url: https://arxiv.org/abs/2308.13759
tags:
- segmentation
- image
- images
- medical
- unlabeled
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a novel semi-supervised learning method for
  medical image segmentation that leverages the Segment Anything Model (SAM) combined
  with domain-specific knowledge (DSK). The method iteratively trains a segmentation
  model and expands the labeled set by matching SAM-generated segmentation proposals
  with pixel-level and image-level DSK.
---

# SamDSK: Combining Segment Anything Model with Domain-Specific Knowledge for Semi-Supervised Learning in Medical Image Segmentation

## Quick Facts
- arXiv ID: 2308.13759
- Source URL: https://arxiv.org/abs/2308.13759
- Reference count: 33
- Primary result: SamDSK achieves Dice coefficients of 73.6% for breast cancer segmentation, 89.4% for polyp segmentation, and 89.9% for skin lesion segmentation

## Executive Summary
This paper presents SamDSK, a novel semi-supervised learning method for medical image segmentation that combines the Segment Anything Model (SAM) with domain-specific knowledge (DSK). The method iteratively trains a segmentation model while expanding the labeled set by matching SAM-generated segmentation proposals with pixel-level and image-level DSK. An optimal-matching-based approach constructs annotations for unlabeled images, constrained by image-level DSK such as the potential number of regions of interest. Experiments on three medical image segmentation tasks demonstrate the method's effectiveness, outperforming state-of-the-art semi-supervised learning approaches.

## Method Summary
SamDSK is an iterative semi-supervised learning method that combines SAM-generated segmentation proposals with domain-specific knowledge to generate annotations for unlabeled medical images. The method consists of two main stages: segmentation model training and expanding the labeled set. In each iteration, the trained segmentation model generates pixel-level DSK (probability maps) for unlabeled images. SAM then generates segmentation proposals for these images, which are optimally matched to the probability maps using a bipartite matching algorithm. Image-level DSK constraints (such as the expected number of regions of interest) guide the matching process. High-quality annotations are selected based on matching scores and added to the labeled set, which is then used to retrain the segmentation model. This process repeats until no more samples are added to the labeled set.

## Key Results
- SamDSK achieves Dice coefficients of 73.6% for breast cancer segmentation, 89.4% for polyp segmentation, and 89.9% for skin lesion segmentation
- The method outperforms state-of-the-art semi-supervised learning approaches across all three medical image segmentation tasks
- SamDSK demonstrates effectiveness in leveraging limited labeled data through iterative refinement and domain-specific knowledge integration

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Combining SAM with domain-specific knowledge improves segmentation quality by selecting and refining high-quality proposals from SAM's diverse output
- Mechanism: The method uses a trained segmentation model to generate pixel-level domain-specific knowledge (probability maps), then optimally matches SAM's segmentation proposals to these probability maps. This ensures that only proposals aligning well with the learned domain knowledge are selected and used for annotation construction
- Core assumption: SAM generates a sufficient number of segmentation proposals that include all potential regions of interest, even if some are over-segmented or noisy
- Evidence anchors:
  - [abstract] "A novel optimal-matching-based method is developed for combining the SAM-generated segmentation proposals and pixel-level and image-level DSK for constructing annotations of unlabeled images"
  - [section] "The optimization problem in Eq. (1) (with the constraints in Eq. (2)) is a maximum bipartite matching problem which can be efficiently solved in polynomial time"
  - [corpus] No direct evidence found in corpus papers about optimal matching mechanisms

### Mechanism 2
- Claim: Iterative refinement through multiple rounds of training and labeled set expansion gradually improves segmentation performance
- Mechanism: After initial training on limited labeled data, the model generates probability maps for unlabeled images. These are used with SAM to construct annotations for high-quality samples, which are then added to the labeled set. The model is retrained with this expanded set, improving its ability to identify high-quality regions in subsequent rounds
- Core assumption: The initial segmentation model, even when trained on limited data, can generate sufficiently accurate probability maps to guide the selection of good proposals from SAM
- Evidence anchors:
  - [abstract] "These two stages are repeated until no more samples are added to the labeled set"
  - [section] "There exist clearly two cases after the optimal matching process for constructing annotations of the unlabeled images"
  - [corpus] No direct evidence found in corpus papers about multi-round iterative refinement

### Mechanism 3
- Claim: Image-level domain-specific knowledge constrains the optimal matching process to improve annotation reliability
- Mechanism: By incorporating prior knowledge about the expected number of regions of interest per image (vlower and vupper constraints), the method prevents the selection of implausible combinations of segmentation proposals, ensuring more realistic annotations
- Core assumption: The domain has well-defined constraints on the number of objects that can appear in an image, which can be encoded as image-level knowledge
- Evidence anchors:
  - [abstract] "an image-level DSK (e.g., the potential number of regions of interest) during the selection process to constrain the optimization process"
  - [section] "Suppose the number of RoIs for an image of a given medical image segmentation task ranges from vlower c to vupper c for class c"
  - [corpus] No direct evidence found in corpus papers about using image-level constraints in optimal matching

## Foundational Learning

- Concept: Optimal matching algorithms (bipartite matching)
  - Why needed here: The method needs to match SAM's segmentation proposals to the probability maps generated by the segmentation model in a way that maximizes overall quality
  - Quick check question: Can you explain why a greedy matching approach might fail here, and how optimal matching solves this problem?

- Concept: Semi-supervised learning principles
  - Why needed here: The method extends limited labeled data by generating pseudo-labels for unlabeled data, requiring understanding of when and how this approach is effective
  - Quick check question: Under what conditions might pseudo-labels degrade model performance rather than improve it?

- Concept: Intersection over Union (IoU) metric
  - Why needed here: IoU is used both as the optimization objective for matching and as a quality threshold for selecting samples to add to the labeled set
  - Quick check question: How does IoU differ from Dice coefficient, and why might one be preferred over the other in this context?

## Architecture Onboarding

- Component map: SAM model -> Segmentation model -> Optimal matching algorithm -> Training loop
- Critical path: The critical path runs from applying SAM to unlabeled images → generating probability maps from the current segmentation model → optimal matching with constraints → annotation construction → model retraining
- Design tradeoffs: The method trades computational complexity (running SAM on all unlabeled images and performing optimal matching) for improved segmentation quality. The number of SAM proposals and the complexity of the matching constraints can be adjusted based on available computational resources
- Failure signatures: Poor performance may manifest as: (1) no samples being added in early rounds (indicating poor initial model or SAM proposals), (2) decreasing performance across rounds (indicating incorrect sample selection), or (3) extremely slow processing (indicating computational bottlenecks in the matching process)
- First 3 experiments:
  1. Verify SAM coverage: Apply SAM to a small subset of unlabeled images and manually verify that all regions of interest are present among the proposals
  2. Test optimal matching: Run the matching algorithm on a small set with known ground truth to verify it selects appropriate proposals
  3. Validate multi-round improvement: Run two rounds on a small dataset and verify that performance improves in the second round

## Open Questions the Paper Calls Out
- How can the proposed method be extended to handle medical image segmentation tasks where SAM fails to generate sufficiently good segmentation proposals?
- What is the optimal number of rounds for the iterative process in the proposed method, and how does it affect the final segmentation performance?
- How can the proposed method be adapted to handle multi-class segmentation tasks with multiple classes of foreground objects?

## Limitations
- The method's effectiveness is contingent on SAM's ability to generate comprehensive segmentation proposals that capture all regions of interest
- The assumed image-level domain-specific knowledge (constraints on region counts) may not hold for all medical images
- The iterative refinement process carries the risk of accumulating errors if poor-quality annotations are selected in early rounds

## Confidence
- High Confidence: The overall framework combining SAM with domain-specific knowledge is technically sound and well-motivated
- Medium Confidence: The specific implementation details of the optimal matching algorithm and the exact formulation of image-level constraints are not fully specified in the paper
- Low Confidence: The paper lacks detailed ablation studies on the impact of different DSK constraints and the number of SAM proposals

## Next Checks
1. Apply SAM to a small subset of unlabeled images from each dataset and manually verify that all regions of interest are present among the proposals
2. Implement the optimal matching algorithm and test it on a small dataset with known ground truth to ensure it correctly identifies high-quality correspondences
3. Run the complete pipeline on a small dataset for two rounds and verify that segmentation performance improves in the second round