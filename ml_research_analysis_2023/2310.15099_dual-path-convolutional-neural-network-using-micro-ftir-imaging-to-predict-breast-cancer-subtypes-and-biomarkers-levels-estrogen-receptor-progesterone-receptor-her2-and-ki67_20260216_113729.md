---
ver: rpa2
title: 'Dual-path convolutional neural network using micro-FTIR imaging to predict
  breast cancer subtypes and biomarkers levels: estrogen receptor, progesterone receptor,
  HER2 and Ki67'
arxiv_id: '2310.15099'
source_url: https://arxiv.org/abs/2310.15099
tags:
- cancer
- breast
- were
- https
- her2
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study addresses the classification of breast cancer molecular
  subtypes and prediction of biomarker levels using micro-FTIR imaging and deep learning.
  A novel 2D convolutional neural network (CaReNet-V2) was developed to classify breast
  cancer vs adjacent tissue and molecular subtypes, and to predict levels of estrogen
  receptor (ER), progesterone receptor (PR), HER2, and Ki67.
---

# Dual-path convolutional neural network using micro-FTIR imaging to predict breast cancer subtypes and biomarkers levels: estrogen receptor, progesterone receptor, HER2 and Ki67

## Quick Facts
- arXiv ID: 2310.15099
- Source URL: https://arxiv.org/abs/2310.15099
- Reference count: 40
- Achieved test accuracies above 0.84 for cancer vs adjacent tissue and subtype classification

## Executive Summary
This study presents CaReNet-V2, a dual-path convolutional neural network that uses micro-FTIR imaging to classify breast cancer molecular subtypes and predict biomarker levels (ER, PR, HER2, Ki67). The model processes hyperspectral FTIR images through spectral and spatial feature extraction channels, achieving test accuracies above 0.84 for cancer vs adjacent tissue and subtype classification. The approach enables prediction of ER, PR, and HER2 levels with reasonable accuracy for clear positive/negative cases, though borderline values show reduced performance (minimum accuracy of 0.54). Ki67 percentage regression demonstrated a mean error of 3.6%. The method shows potential as a screening technique for breast cancer biopsies evaluation.

## Method Summary
The CaReNet-V2 model processes 320x320 micro-FTIR images from breast cancer biopsies, divided into 32x32 patches for training. A two-stage K-means clustering removes non-tissue pixels before patch generation. The dual-path CNN architecture features parallel channels: a spectral path with 1x1 convolutions for individual pixel biochemistry analysis and a spatial path with 3x3 convolutions for local tissue architecture patterns. The model is trained using Adam optimizer with cosine decay schedule, class weights for imbalanced data, and data augmentation. Performance is evaluated through patch-level predictions and patient-level voting systems for both classification and regression tasks.

## Key Results
- Achieved test accuracies above 0.84 for breast cancer vs adjacent tissue classification
- Successfully classified molecular subtypes with high accuracy
- Predicted ER, PR, and HER2 levels with reasonable accuracy for clear positive/negative cases
- Ki67 percentage regression demonstrated a mean error of 3.6%

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The dual-path CNN effectively leverages both spectral and spatial information for breast cancer subtype classification.
- Mechanism: The CaReNet-V2 model processes hyperspectral FTIR images through two parallel channels - one for spectral feature extraction (1x1 convolutions) and another for spatial feature extraction (3x3 convolutions). The spectral path analyzes individual pixel biochemistry while the spatial path captures local tissue architecture patterns.
- Core assumption: Both spectral signatures and spatial tissue morphology contain complementary diagnostic information for cancer subtype classification.
- Evidence anchors:
  - [abstract] "A novel 2D deep learning approach" using micro-FTIR imaging
  - [section] "The model has two channels path: one to target spectral feature extraction; and another for spatial extraction"
  - [corpus] Weak evidence - no direct comparison to single-path models in related papers
- Break condition: If spectral and spatial information are highly correlated or if one channel dominates predictions, the dual-path architecture provides minimal benefit over single-path approaches.

### Mechanism 2
- Claim: Patch-based training with voting system enables robust classification despite limited patient samples.
- Mechanism: The 320x320 images are divided into 32x32 patches, creating ~6000 training samples from 30 patients. Final patient classification uses majority voting across patches, making predictions less sensitive to individual patch errors.
- Core assumption: Cancerous tissue patterns are locally consistent within a core, so patch-level predictions can be aggregated for reliable patient-level classification.
- Evidence anchors:
  - [section] "Patches were labeled by a binary encoding...and by an ordinal one-hot-like encoding"
  - [section] "Performance was evaluated by each patch prediction and by the sample prediction with a voting system"
  - [corpus] Weak evidence - no comparison to whole-image or different patch sizes in related papers
- Break condition: If tissue heterogeneity within a single core is too high, patch voting may produce unreliable patient-level predictions.

### Mechanism 3
- Claim: K-means clustering preprocessing removes non-tissue regions and improves model focus on relevant biochemical information.
- Mechanism: Two-stage K-means clustering identifies tissue vs. paraffin/slide regions. Spectra from non-tissue areas are zeroed out before patch generation, ensuring the model trains only on relevant tissue information.
- Core assumption: Paraffin and slide regions contain no diagnostically relevant information for cancer subtype classification.
- Evidence anchors:
  - [section] "Images were preprocessed individually. Tissue, paraffin and possible pure slide regions were selected using a two K-means clustering"
  - [section] "The clustering method enabled to remove non-tissue pixels"
  - [corpus] Weak evidence - no comparison to models trained without clustering preprocessing
- Break condition: If paraffin contamination affects tissue spectra or if tissue boundaries are unclear, K-means clustering may incorrectly remove diagnostically relevant regions.

## Foundational Learning

- Concept: Hyperspectral imaging fundamentals
  - Why needed here: Understanding how FTIR generates thousands of spectra per image and how spectral bands relate to biochemical information
  - Quick check question: What is the typical wavenumber range for biological tissue FTIR spectroscopy?

- Concept: Convolutional neural network architecture
  - Why needed here: Understanding how 1x1 vs 3x3 convolutions extract different feature types and how global average pooling works
  - Quick check question: What is the primary difference between 1x1 and 3x3 convolutional filters in terms of feature extraction?

- Concept: Imbalanced classification and class weighting
  - Why needed here: The dataset has highly imbalanced receptor expression levels, requiring weighted loss functions for effective training
  - Quick check question: How does class weighting in the loss function help when training on imbalanced datasets?

## Architecture Onboarding

- Component map: Input (32x32x467 patches) → Spectral Path (1x1 conv layers + GAP) + Spatial Path (3x3 conv layers + GAP) → Concatenation → Dense layers → Output (classification/regression)

- Critical path: Patch preprocessing → K-means clustering → Spectral and spatial feature extraction → Concatenation → Classification/regression head

- Design tradeoffs: 2D approach uses more GPU memory but processes 1024 spectra simultaneously vs. 1D approach; patch-based training increases dataset size but may lose global context; dual-path architecture captures complementary information but adds complexity

- Failure signatures: High patch accuracy but low patient accuracy suggests voting system issues; low accuracy on borderline receptor levels indicates insufficient training samples; poor generalization suggests overfitting to specific patient characteristics

- First 3 experiments:
  1. Train single-path version (only spectral or only spatial) to quantify dual-path benefit
  2. Test different patch sizes (16x16, 64x64) to optimize local vs. global context balance
  3. Implement data augmentation with synthetic tissue variations to improve borderline class performance

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does CaReNet-V2's performance change when trained and tested on a larger, more diverse dataset with samples across all Ki67 expression levels (0-100%) rather than the limited 5-30% range used in this study?
- Basis in paper: [explicit] The paper notes that Ki67 regression was tested on a limited dataset with only 5%, 10%, 20%, and 30% levels, and states "it is required a much larger dataset with several samples in this range to properly evaluate this process."
- Why unresolved: The current dataset lacks the full range of Ki67 expressions needed to properly assess the regression model's performance across all possible levels.
- What evidence would resolve it: Testing CaReNet-V2 on a dataset containing breast cancer samples with Ki67 expressions spanning the full 0-100% range, with sufficient representation at each level.

### Open Question 2
- Question: Can CaReNet-V2 accurately classify HER2 expression at all four levels (0, 1+, 2+, 3+) when provided with a larger dataset that includes sufficient samples of the currently underrepresented 1+ and 2+ categories?
- Basis in paper: [explicit] The paper mentions that preliminary tests with 1+ and 2+ samples were not successful due to insufficient data, and states "the model may learn the four levels classification if more samples examples is available."
- Why unresolved: The current dataset lacks adequate representation of the borderline HER2 expression levels (1+ and 2+), preventing proper evaluation of multi-class classification.
- What evidence would resolve it: Testing CaReNet-V2 on a dataset with balanced representation of all four HER2 expression levels, including sufficient 1+ and 2+ samples for training and evaluation.

### Open Question 3
- Question: How would CaReNet-V2's performance improve if trained on a balanced dataset rather than the imbalanced dataset used in this study, where loss punishment by class weights was necessary?
- Basis in paper: [explicit] The paper states "A larger and balanced dataset may considerably improve CaReNet-V2 performance" and notes that "Training deep neural networks on imbalanced data sets" typically presents challenges.
- Why unresolved: The current dataset has significant class imbalance, particularly for borderline receptor expression levels, which may be limiting the model's ability to learn these patterns.
- What evidence would resolve it: Training and testing CaReNet-V2 on a balanced dataset with equal representation of all classes, then comparing performance metrics to those obtained with the imbalanced dataset.

## Limitations

- Small sample size (60 images from 30 patients) limits generalizability of results
- Performance significantly degrades for borderline receptor expression levels where clinical decisions are most critical
- Clustering-based preprocessing may introduce bias by removing potentially diagnostically relevant regions
- No comparison to established histopathological assessment methods or clinical-grade molecular testing

## Confidence

**High Confidence**: Classification of breast cancer vs adjacent tissue (accuracy >0.84) and general molecular subtype classification

**Medium Confidence**: Prediction of biomarker levels for ER, PR, and HER2 for clear positive/negative cases

**Low Confidence**: Ki67 percentage regression with MAE of 3.6% and clinical utility uncertain

## Next Checks

1. **Clinical Validation**: Compare model predictions against clinical gold-standard molecular testing (IHC and FISH) on an independent patient cohort to assess real-world performance and potential clinical impact.

2. **Borderline Performance Analysis**: Specifically evaluate model performance on cases with borderline receptor expression (e.g., 1+ HER2, 10-20% Ki67) using receiver operating characteristic (ROC) analysis to determine clinical utility thresholds.

3. **Explainability Assessment**: Implement attention visualization or gradient-based feature importance methods to verify that the model focuses on biologically relevant spectral regions rather than artifacts or noise in the FTIR data.