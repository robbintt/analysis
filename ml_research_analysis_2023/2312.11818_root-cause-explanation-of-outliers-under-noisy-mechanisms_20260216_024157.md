---
ver: rpa2
title: Root Cause Explanation of Outliers under Noisy Mechanisms
arxiv_id: '2312.11818'
source_url: https://arxiv.org/abs/2312.11818
tags:
- node
- nodes
- causal
- noise
- edge
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of identifying root causes of
  outliers in causal processes, particularly focusing on anomalies that arise from
  both nodes and edges in the causal graph. The authors propose a noisy functional
  causal model to account for noise in both nodes and edges, and employ Bayesian learning
  and inference methods to infer the noise values.
---

# Root Cause Explanation of Outliers under Noisy Mechanisms

## Quick Facts
- **arXiv ID:** 2312.11818
- **Source URL:** https://arxiv.org/abs/2312.11818
- **Reference count:** 5
- **Primary result:** Introduces BIGEN, a gradient-based attribution method that outperforms baseline methods on simulated datasets with NDCG@1 scores of 0.898, 0.938, and 0.918 for nodes, edges, and both, respectively, on random graphs.

## Executive Summary
This paper addresses the challenge of identifying root causes of outliers in causal processes, particularly focusing on anomalies that arise from both nodes and edges in the causal graph. The authors propose a noisy functional causal model to account for noise in both nodes and edges, and employ Bayesian learning and inference methods to infer the noise values. They introduce a novel gradient-based attribution method, called BIGEN, to compute anomaly attribution scores that scale linearly with the number of nodes and edges. The proposed method outperforms baseline methods on simulated datasets and two real-world scenario datasets, demonstrating superior runtime efficiency compared to Shapley-based methods, especially for larger graphs with thousands of nodes.

## Method Summary
The method involves fitting noisy functional causal models using Bayesian linear regression on normal operation data to estimate the underlying causal mechanisms. When abnormal observations occur, the method estimates edge and node noises by comparing the observed values against the expected values based on the learned causal mechanisms. The BIGEN algorithm then computes anomaly attribution scores using integrated gradients, which provides an efficient, linear-time alternative to Shapley value methods for root cause attribution in causal graphs. The attribution scores are used to rank potential root causes, with higher scores indicating more likely root causes of the observed outliers.

## Key Results
- BIGEN outperforms baseline methods on simulated datasets with NDCG@1 scores of 0.898, 0.938, and 0.918 for nodes, edges, and both, respectively, on random graphs.
- The method demonstrates superior runtime efficiency compared to Shapley-based methods, especially for larger graphs with thousands of nodes.
- BIGEN is effective in real-world applications, as evidenced by its performance on two real-world scenario datasets.

## Why This Works (Mechanism)

### Mechanism 1
The Bayesian linear regression framework allows simultaneous modeling of both node and edge noise in causal mechanisms, enabling identification of anomalies at both levels. By representing edge weights as Gaussian-distributed random variables with unknown precision parameters, the model can infer deviations from normal operation in both the nodes (via node noise) and edges (via edge noise). The posterior distribution of edge weights is computed analytically, allowing efficient MAP estimation of edge noise as the difference between inferred and normal weights.

### Mechanism 2
The Integrated Gradient (IG) attribution method provides an efficient, linear-time alternative to Shapley value methods for root cause attribution in causal graphs. Instead of summing over all possible subsets of nodes/edges as in Shapley methods, IG computes the contribution of each noise term by integrating the gradient of the outlier score along a path from reference noise values to the observed noise values. This requires only one forward and one backward pass per noise term.

### Mechanism 3
The noisy mechanism framework generalizes existing causal root cause analysis by accounting for both node and edge anomalies through noise modeling. By reparameterizing the leaf node as a function of both node and edge noises, anomalies can be traced back to either source. Edge noise is estimated via MAP inference on Bayesian linear regression coefficients, while node noise is estimated from the residual after subtracting the expected value based on parent nodes and edge weights.

## Foundational Learning

- **Concept:** Bayesian inference and posterior estimation
  - **Why needed here:** The method relies on computing posterior distributions of edge weights to infer edge noise, which requires understanding Bayesian linear regression and MAP estimation.
  - **Quick check:** Given a Gaussian prior and likelihood, what is the form of the posterior distribution for the regression weights?

- **Concept:** Causal inference and structural causal models
  - **Why needed here:** The framework builds on functional causal models where each node is a function of its parents plus noise, requiring understanding of causal graphs and intervention analysis.
  - **Quick check:** How does a change in edge weights (edge noise) propagate through a causal graph to affect downstream nodes?

- **Concept:** Gradient-based attribution methods
  - **Why needed here:** The BIGEN method uses integrated gradients to attribute outlier scores to individual noise terms, requiring understanding of how gradients capture feature importance.
  - **Quick check:** What is the key difference between Shapley value attribution and integrated gradient attribution in terms of computational complexity?

## Architecture Onboarding

- **Component map:** Data preprocessing -> Noisy mechanism fitting -> Noise inference -> Attribution computation -> Evaluation
- **Critical path:** Data → Noisy mechanism fitting → Noise inference → Attribution computation → Root cause ranking
- **Design tradeoffs:**
  - Accuracy vs. efficiency: BIGEN trades some attribution accuracy for linear-time computation compared to Shapley methods
  - Gaussian assumption: Simplifies inference but may not capture all real-world noise distributions
  - Known graph requirement: Limits applicability to domains where causal structure is known
- **Failure signatures:**
  - Poor NDCG scores: Indicates the attribution method is not correctly identifying root causes
  - High variance in edge noise estimates: Suggests the Gaussian assumption may be violated
  - Runtime scaling worse than linear: Indicates implementation inefficiency or algorithmic issue
- **First 3 experiments:**
  1. Verify MAP estimation on synthetic data with known edge weights and Gaussian noise
  2. Compare BIGEN attribution scores against ground truth on small random graphs
  3. Measure runtime scaling on graphs of increasing size (10 → 100 → 1000 nodes)

## Open Questions the Paper Calls Out

### Open Question 1
- **Question:** How does the BIGEN method perform in identifying root causes when the causal graph is unknown or partially known?
- **Basis in paper:** The paper assumes a given causal graph, but does not explore scenarios where the causal graph is unknown or partially known.
- **Why unresolved:** The paper does not provide experimental results or theoretical analysis on the performance of BIGEN when the causal graph is not fully known.
- **What evidence would resolve it:** Experiments comparing BIGEN's performance with known vs. partially known vs. unknown causal graphs would provide evidence on its robustness and adaptability to different causal graph scenarios.

### Open Question 2
- **Question:** What is the impact of using different reference points in the BIGEN method on the attribution accuracy and computational efficiency?
- **Basis in paper:** The paper mentions that multiple reference points can be chosen to calculate multiple contribution scores, followed by averaging, to enhance the accuracy of the score.
- **Why unresolved:** The paper does not provide a detailed analysis of how the choice of reference points affects the attribution accuracy and computational efficiency of BIGEN.
- **What evidence would resolve it:** Comparative experiments using different reference point strategies (e.g., single reference, multiple references, learned references) would elucidate the trade-offs between attribution accuracy and computational efficiency.

### Open Question 3
- **Question:** How does the BIGEN method scale with the size and complexity of the causal graph in real-world applications?
- **Basis in paper:** The paper demonstrates that BIGEN scales linearly with the number of nodes and edges, making it suitable for large graphs with thousands of nodes.
- **Why unresolved:** While the paper shows scalability on simulated datasets, it does not provide extensive real-world case studies to validate the method's performance on large, complex causal graphs in practical applications.
- **What evidence would resolve it:** Real-world case studies involving large-scale causal graphs from various domains (e.g., manufacturing, healthcare, finance) would provide evidence on the method's scalability and effectiveness in practical settings.

## Limitations
- The method assumes known causal graph structure and Gaussian-distributed noises, which may not hold in many real-world scenarios.
- The linear approximation for causal mechanisms may fail for highly nonlinear relationships.
- The method requires separate normal operation data for training, which may not always be available.

## Confidence
- Mechanism 1 (Bayesian noise modeling): Medium confidence - well-established Bayesian inference theory but strong distributional assumptions
- Mechanism 2 (IG attribution): High confidence - proven theoretical foundation with clear computational advantages
- Mechanism 3 (noisy mechanism generalization): Medium confidence - novel extension but limited empirical validation on diverse real-world datasets

## Next Checks
1. Test method robustness on synthetic graphs with varying degrees of nonlinearity and non-Gaussian noise distributions
2. Validate performance on causal graphs with missing edges or incorrect structure to assess sensitivity to graph accuracy
3. Benchmark runtime and accuracy trade-offs on graphs with >10,000 nodes to verify linear scaling claims