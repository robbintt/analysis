---
ver: rpa2
title: Online Corrupted User Detection and Regret Minimization
arxiv_id: '2310.04768'
source_url: https://arxiv.org/abs/2310.04768
tags:
- users
- user
- corrupted
- rclub-wcu
- sxas
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of learning user preferences and
  detecting corrupted users in online systems with multiple users and adversarial
  corruptions. The proposed method, RCLUB-WCU, learns user clustering structures and
  preferences robustly using weighted ridge regression and a dynamic graph-based clustering
  approach.
---

# Online Corrupted User Detection and Regret Minimization

## Quick Facts
- **arXiv ID**: 2310.04768
- **Source URL**: https://arxiv.org/abs/2310.04768
- **Reference count**: 40
- **Key outcome**: Novel algorithm RCLUB-WCU achieves improved regret bounds while detecting corrupted users in multi-user bandit systems with adversarial corruptions

## Executive Summary
This paper addresses the problem of learning user preferences and detecting corrupted users in online recommendation systems with multiple users and adversarial corruptions. The proposed RCLUB-WCU algorithm combines weighted ridge regression with a dynamic graph-based clustering approach to robustly estimate user preferences while learning clustering structures. Based on RCLUB-WCU's inferred clustering, the OCCUD algorithm detects corrupted users online by comparing non-robust and robust preference estimations. The authors prove a regret upper bound for RCLUB-WCU that asymptotically matches the lower bound and state-of-the-art results in degenerate cases, while also providing theoretical guarantees for OCCUD's detection accuracy.

## Method Summary
The RCLUB-WCU algorithm uses weighted ridge regression where sample weights are inversely proportional to confidence radii, reducing the impact of corrupted samples on preference estimation. It maintains a dynamic graph over users where connected components represent inferred clusters, with edges deleted when user preference estimates diverge beyond a threshold. The OCCUD detection algorithm compares each user's non-robust preference estimate (from standard ridge regression) with the robust estimate of their inferred cluster (from weighted regression), flagging users as corrupted when the gap exceeds a threshold. The method is evaluated on synthetic and real-world datasets including Movielens, Amazon, and Yelp.

## Key Results
- RCLUB-WCU outperforms baseline algorithms (LinUCB, CLUB, CW-OFUL, etc.) in cumulative regret across different corruption levels and cluster numbers
- OCCUD achieves high detection accuracy (AUC scores) for identifying corrupted users online
- Theoretical regret bounds for RCLUB-WCU asymptotically match lower bounds and match state-of-the-art in degenerate cases
- Algorithm maintains effectiveness even with up to 10% corrupted users in the system

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Weighted ridge regression with inverse confidence radius weights reduces the impact of corrupted samples on preference estimation.
- Mechanism: The algorithm assigns weights to samples inversely proportional to the confidence radius (which reflects estimation uncertainty). Samples with large confidence radii (likely corrupted) get smaller weights.
- Core assumption: Corruption causes large estimation uncertainty, which can be measured via confidence radii.
- Evidence anchors:
  - "Specifically, we use the inverse of the confidence radius to weigh each sample. If the confidence radius associated with user it and arm at is large at t, the learner is quite uncertain about the estimation of it's preference on at, indicating the sample at t is likely to be corrupted."
  - "We use weighted ridge regressions for robust user preference estimations. Specifically, we use the inverse of the confidence radius to weigh each sample."
- Break condition: If corruptions are subtle and don't increase confidence radii significantly, this mechanism may not distinguish them from normal uncertainty.

### Mechanism 2
- Claim: Dynamic graph-based clustering allows efficient information sharing among similar users while isolating corrupted users.
- Mechanism: The algorithm maintains a dynamic graph where users with similar learned preferences are connected. Connected components represent inferred clusters. Edges are deleted when user preference estimates diverge beyond a threshold.
- Core assumption: Users in the same ground-truth cluster will have similar preference vectors, and corrupted users will show divergent behavior.
- Evidence anchors:
  - "RCLUB-WCU maintains a dynamic graph over users to represent the learned clustering structure, where users linked by edges are inferred to be in the same cluster."
  - "We design a robust edge deletion rule to divide the clusters by considering the potential effect of corruptions, which, together with (i), can ensure that after some interactions, users in the same connected component of the graph are in the same underlying cluster with high probability."
- Break condition: If corruptions are too subtle or if users in different clusters have similar preferences, the clustering may be inaccurate.

### Mechanism 3
- Claim: Comparing non-robust and robust preference estimates enables online detection of corrupted users.
- Mechanism: The OCCUD algorithm maintains both robust (weighted regression) and non-robust (standard regression) estimates for each user. It detects corruption by comparing a user's non-robust estimate with the robust estimate of their inferred cluster - large discrepancies indicate corruption.
- Core assumption: Normal users will have similar non-robust and robust estimates, while corrupted users will have divergent estimates.
- Evidence anchors:
  - "At each round, we compare each user's non-robustly estimated preference vector (by ridge regression) and the robust estimation (by weighted regression) of the user's inferred cluster. If the gap exceeds a carefully-designed threshold, we detect this user as corrupted."
  - "With misleading behaviors, the non-robust preference estimations of corrupted users would be far from ground truths."
- Break condition: If corruptions are sporadic and don't consistently bias non-robust estimates, detection accuracy may decrease.

## Foundational Learning

- Concept: Adversarial corruption in bandit algorithms
  - Why needed here: The paper builds on existing work on bandits with adversarial corruption but extends it to multiple users with clustering
  - Quick check question: What is the difference between stochastic and adversarial corruption in bandit problems?

- Concept: Clustering of bandits
  - Why needed here: The paper extends the clustering of bandits framework to handle corrupted users
  - Quick check question: How does clustering improve learning efficiency in multi-user bandit settings?

- Concept: Online learning and regret minimization
  - Why needed here: The core objective is to minimize cumulative regret while detecting corrupted users online
  - Quick check question: What is the difference between cumulative regret and simple regret in bandit algorithms?

## Architecture Onboarding

- Component map:
  - RCLUB-WCU (main learning algorithm)
    - Dynamic user graph
    - Weighted ridge regression engine
    - UCB recommendation engine
    - Edge deletion logic
  - OCCUD (detection algorithm)
    - Non-robust estimation module
    - Robust estimation module
    - Detection threshold calculator
  - Shared components
    - User preference storage
    - Cluster assignment logic
    - Reward feedback processor

- Critical path:
  1. User arrives → determine cluster via graph connectivity
  2. Estimate cluster preferences via weighted regression
  3. Recommend arm via UCB
  4. Receive reward → update weighted regression statistics
  5. Check edge deletion conditions
  6. Update non-robust and robust estimates
  7. Run detection algorithm

- Design tradeoffs:
  - Computational cost vs. detection accuracy (more frequent edge checks increase accuracy but cost more)
  - Robustness vs. responsiveness (stronger weighting reduces corruption impact but may slow adaptation)
  - Detection threshold sensitivity (higher thresholds reduce false positives but may miss subtle corruptions)

- Failure signatures:
  - Incorrect clustering (users with different preferences in same cluster)
  - False corruption detection (normal users flagged as corrupted)
  - Missed corruption detection (corrupted users not flagged)
  - Slow convergence (algorithm takes too long to identify clusters)

- First 3 experiments:
  1. Baseline comparison: Run RCLUB-WCU vs. LinUCB and CLUB on synthetic data with known corruption patterns to verify regret improvement.
  2. Detection accuracy test: Vary corruption levels and patterns to measure OCCUD's AUC and precision/recall.
  3. Cluster robustness test: Introduce subtle preference differences within clusters to test edge deletion sensitivity.

## Open Questions the Paper Calls Out

The paper doesn't explicitly call out open questions, but based on the analysis, several unresolved issues emerge:

- How does the algorithm perform when corrupted users can dynamically switch between clusters over time?
- Can the detection algorithm maintain high accuracy when corrupted users collaborate and share corrupted reward strategies?
- What is the impact of corrupted users having partial knowledge of other users' preferences on the algorithm's performance?

## Limitations

- The weighted regression mechanism depends on corruptions consistently inflating confidence radii, which may not hold for subtle corruptions
- Dynamic clustering assumes clear preference differences between clusters, but real-world datasets may have overlapping clusters
- Detection accuracy depends on maintaining clean cluster centers, which becomes challenging as corruption levels increase
- Theoretical guarantees assume static clustering structure, leaving open questions about dynamic cluster membership

## Confidence

- Regret bounds and theoretical guarantees: High confidence
- Weighted regression mechanism: Medium confidence
- Dynamic clustering approach: Medium confidence
- Online detection accuracy: Medium confidence

## Next Checks

1. Test RCLUB-WCU's performance when corruptions are subtle and don't significantly increase confidence radii - this would stress-test the core weighting mechanism
2. Evaluate clustering stability under varying levels of preference similarity within and between clusters to understand edge deletion sensitivity
3. Measure detection accuracy when corruption patterns are sporadic rather than consistent to assess robustness to different attack strategies