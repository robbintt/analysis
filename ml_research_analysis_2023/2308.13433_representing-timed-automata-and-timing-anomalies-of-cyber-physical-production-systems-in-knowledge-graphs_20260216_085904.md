---
ver: rpa2
title: Representing Timed Automata and Timing Anomalies of Cyber-Physical Production
  Systems in Knowledge Graphs
arxiv_id: '2308.13433'
source_url: https://arxiv.org/abs/2308.13433
tags:
- knowledge
- state
- timed
- timing
- system
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work proposes a method to improve the interpretability of
  model-based anomaly detection in Cyber-Physical Production Systems by integrating
  learned timed automata with prior engineering knowledge through a formal knowledge
  graph. The approach introduces an ontology that captures both the physical structure
  and behavioral models of the system, allowing operators to more easily understand
  both the automaton and the detected timing anomalies.
---

# Representing Timed Automata and Timing Anomalies of Cyber-Physical Production Systems in Knowledge Graphs

## Quick Facts
- arXiv ID: 2308.13433
- Source URL: https://arxiv.org/abs/2308.13433
- Reference count: 25
- Primary result: Improves interpretability of model-based anomaly detection in CPPS by integrating learned timed automata with engineering knowledge through a formal knowledge graph

## Executive Summary
This paper addresses the interpretability challenge in model-based anomaly detection for Cyber-Physical Production Systems (CPPS) by integrating learned timed automata with prior engineering knowledge through a formal knowledge graph. The approach combines behavioral models learned from runtime data with the physical structure of the CPPS, allowing operators to understand both the automaton and detected timing anomalies in context. Validation on a five-tank mixing system demonstrates that the method can formally describe both the automaton model and timing anomalies in the knowledge graph, enabling SPARQL-based queries for diagnostic purposes.

## Method Summary
The approach involves learning timed automata from CPPS runtime data using the OTALA algorithm, then representing both the physical system structure and the learned automaton in a unified knowledge graph using established ontologies (SSN/SOSA, ISA88, UML State Machine, and ISO17359). Anomalies are detected using the ANODA algorithm and represented in the knowledge graph with links to the physical components and timing constraints. The resulting representation allows operators to query the automaton states, transitions, and detected anomalies in the context of the actual system components, improving interpretability and assessment of anomaly severity and causes.

## Key Results
- Successfully learned a timed automaton from CPPS runtime data and represented it in a knowledge graph alongside physical system structure
- Detected timing anomalies using the learned automaton and represented them in the knowledge graph with appropriate context using ISO17359 ontology
- Demonstrated that SPARQL queries can retrieve both the automaton model and anomaly information in relation to physical system components
- Validated the approach on a five-tank mixing system, showing feasibility of the representation approach

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Representing learned timed automata and timing anomalies in a knowledge graph improves interpretability for operators.
- Mechanism: The approach formalizes both the physical structure of the CPPS and the behavioral model (timed automata) in a unified knowledge graph, enriched with engineering knowledge. This allows operators to query and visualize the automaton states, transitions, and detected anomalies in the context of the actual system components.
- Core assumption: The formal knowledge graph can accurately represent both the physical and behavioral aspects of the CPPS and the learned automaton, and operators can effectively query this graph to gain insights.
- Evidence anchors:
  - [abstract]: "This paper aims to improve model-based anomaly detection in CPPS by combining the learned timed automaton with a formal knowledge graph about the system."
  - [section III-A]: "An approach that fulfills these requirements is described in Section III and validated on an exemplary use case in Sections IV and V."
  - [corpus]: Weak evidence - related papers focus on anomaly detection but not specifically on interpretability via knowledge graphs.
- Break condition: If the knowledge graph schema cannot capture all necessary details of the automaton or system, or if queries are too complex for operators to use effectively.

### Mechanism 2
- Claim: Linking timing anomalies to the physical system components and reference values in the knowledge graph enables better assessment of severity and causes.
- Mechanism: By describing anomalies using the ISO17359 ontology, the approach represents anomalies as symptoms with associated reference values and compares them to observed values. This context allows operators to understand not just that an anomaly occurred, but where it occurred in the system and how severe it is relative to normal operation.
- Core assumption: The ISO17359 ontology can effectively capture the semantics of timing anomalies in the context of the CPPS.
- Evidence anchors:
  - [section III-D]: "These concepts are used to describe timing anomalies, in which a transition occurred, whose transition timing is outside the timing constraints Î´."
  - [section IV-E]: "Through linking the anomalies to the well-defined states and events of the state machine, interpretation of the anomaly and subsequent identification of appropriate countermeasures is made easier."
  - [corpus]: No direct evidence - related papers do not discuss linking anomalies to physical context for improved assessment.
- Break condition: If the ontology does not accurately capture the semantics of anomalies, or if operators cannot effectively interpret the linked information.

### Mechanism 3
- Claim: Using ontology design patterns based on industrial standards ensures the knowledge graph is semantically unambiguous and reusable.
- Mechanism: The approach leverages existing ontologies like SSN/SOSA, DINEN61360, and ISA88 to model the physical system, and UML state machine patterns for the behavioral model. This ensures the knowledge graph adheres to well-defined semantics and can be easily integrated with other systems or reused in similar domains.
- Core assumption: The selected ontology design patterns are comprehensive enough to cover all necessary aspects of the CPPS and the learned automaton.
- Evidence anchors:
  - [section III-A]: "In order to identify the necessary concepts of the ontology, Competency Questions (CQ) are created, that the ontology is supposed to answer."
  - [section IV-A]: "The knowledge graph was then populated with facts about the production system, which were available from engineering documents that describe the structure of the system."
  - [corpus]: No direct evidence - related papers do not discuss the use of ontology design patterns for knowledge graph construction.
- Break condition: If the selected ontologies are not comprehensive enough, or if integrating them leads to inconsistencies or redundancies.

## Foundational Learning

- Concept: Timed Automata
  - Why needed here: Timed automata are the behavioral model learned from the CPPS data, and they need to be represented in the knowledge graph for interpretability.
  - Quick check question: Can you explain the components of a timed automaton (states, events, transitions, timing constraints) and how they relate to the behavior of a CPPS?

- Concept: Knowledge Graphs and Ontologies
  - Why needed here: Knowledge graphs provide the structured representation of both the physical system and the learned automaton, while ontologies define the semantics of the entities and relationships.
  - Quick check question: Can you describe the difference between a knowledge graph and an ontology, and explain why both are needed in this approach?

- Concept: SPARQL Queries
  - Why needed here: SPARQL is the query language used to retrieve information from the knowledge graph, enabling operators to explore the automaton and anomalies.
  - Quick check question: Can you write a simple SPARQL query to retrieve all states of a given state machine from the knowledge graph?

## Architecture Onboarding

- Component map: Physical System (Sensors, Actuators, Modules) -> Timed Automaton (States, Events, Transitions, Timing Constraints) -> Knowledge Graph (RDF Triples, Ontology Classes, Relationships) -> SPARQL Query Interface
- Critical path:
  1. Learn timed automaton from CPPS data
  2. Represent physical system and automaton in knowledge graph
  3. Detect anomalies using the learned automaton
  4. Represent anomalies in knowledge graph with context
  5. Query knowledge graph to interpret automaton and anomalies
- Design tradeoffs:
  - Using existing ontologies vs. creating custom ones
  - Granularity of state representation in the automaton
  - Tradeoff between knowledge graph expressiveness and query performance
- Failure signatures:
  - Incomplete or inconsistent knowledge graph representation
  - Inability to link automaton states/transitions to physical components
  - Complex queries that are difficult for operators to understand or execute
- First 3 experiments:
  1. Create a simple knowledge graph for a small CPPS and verify it can be queried using SPARQL
  2. Learn a timed automaton from simulated CPPS data and represent it in the knowledge graph
  3. Introduce a known anomaly in the simulated data, detect it using the automaton, and represent it in the knowledge graph with context

## Open Questions the Paper Calls Out

The paper does not explicitly call out open questions, but several important questions remain unresolved:

### Open Question 1
- Question: How does the interpretability improvement scale with system complexity in terms of number of sensors, actuators, and production states?
- Basis in paper: [inferred] The paper mentions that the approach was validated on a small five-tank system and states "Since the representation approach is independent of the system size, it is expected to generalize well to larger systems" but does not provide empirical evidence for larger systems.
- Why unresolved: The paper only demonstrates the approach on a small-scale system (9 actuators, 6 states) without testing on more complex systems that would better represent real-world CPPS.
- What evidence would resolve it: Empirical validation on progressively larger CPPS systems (e.g., 50+ actuators, 20+ states) showing consistent interpretability improvements across different scales.

### Open Question 2
- Question: What is the computational overhead of maintaining the knowledge graph and performing SPARQL queries compared to traditional model-based anomaly detection approaches?
- Basis in paper: [inferred] While the paper describes the knowledge graph construction and querying capabilities, it does not provide performance metrics or comparison to baseline approaches.
- Why unresolved: The paper focuses on the conceptual approach and interpretability benefits but lacks quantitative analysis of runtime performance and resource requirements.
- What evidence would resolve it: Benchmarking studies comparing query response times, memory usage, and learning algorithm performance between the knowledge graph approach and traditional methods across different system sizes.

### Open Question 3
- Question: How robust is the approach to sensor failures or noisy sensor data during the learning phase?
- Basis in paper: [inferred] The paper does not address data quality issues or sensor reliability, which are critical in real-world CPPS environments where sensor failures and noise are common.
- Why unresolved: The learning algorithm assumes reliable sensor data, but CPPS often operate with degraded sensors or measurement noise that could affect the learned automaton's accuracy.
- What evidence would resolve it: Experiments showing the impact of various noise levels and sensor failure patterns on the learned automaton quality and anomaly detection accuracy, along with mitigation strategies.

## Limitations
- The approach has only been validated on a small five-tank mixing system, limiting confidence in scalability to complex industrial CPPS
- No quantitative validation of interpretability improvements - relies on qualitative descriptions of how operators could use SPARQL queries
- The effectiveness depends heavily on the comprehensiveness of the selected ontologies, which may have gaps for complex CPPS behaviors

## Confidence
- **High Confidence**: The technical feasibility of representing timed automata and physical system structure in a knowledge graph using established ontologies. The methodology for linking anomalies to physical components through ISO17359 is well-grounded in existing standards.
- **Medium Confidence**: The claim that this representation improves operator interpretability. While the mechanism is logical, there's no empirical evidence measuring actual interpretability gains or operator performance with the system.
- **Low Confidence**: The generalizability of the approach to complex industrial CPPS. The validation on a simple five-tank system doesn't demonstrate scalability to systems with hundreds of sensors and complex interdependencies.

## Next Checks
1. **Scalability Test**: Apply the approach to a larger CPPS with at least 50 sensors/actuators and evaluate whether the knowledge graph remains performant and the queries remain comprehensible to operators.

2. **Interpretability Benchmark**: Conduct a user study comparing operator performance in anomaly assessment using the knowledge graph approach versus traditional methods, measuring time to diagnosis and accuracy.

3. **Ontology Coverage Analysis**: Systematically test whether the combined SSN/SOSA, ISA88, UML State Machine, and ISO17359 ontologies can represent edge cases in CPPS behavior, such as non-linear dynamics or emergent phenomena.