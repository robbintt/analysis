---
ver: rpa2
title: Multi-task Learning for Optical Coherence Tomography Angiography (OCTA) Vessel
  Segmentation
arxiv_id: '2311.02266'
source_url: https://arxiv.org/abs/2311.02266
tags:
- segmentation
- loss
- octa
- task
- multi-task
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes OCTA-MTL, a multi-task learning method for
  OCTA segmentation that leverages an image-to-DT branch and an adaptive loss combination
  strategy. The method addresses the challenge of automated OCTA segmentation by jointly
  optimizing a segmentation head and an image-to-DT branch with an adaptive loss combination
  strategy.
---

# Multi-task Learning for Optical Coherence Tomography Angiography (OCTA) Vessel Segmentation

## Quick Facts
- arXiv ID: 2311.02266
- Source URL: https://arxiv.org/abs/2311.02266
- Reference count: 15
- Primary result: OCTA-MTL achieves 0.57 Dice and 0.35 IoU on ROSE-2 dataset, outperforming single-task Unet (0.54 Dice, 0.20 IoU)

## Executive Summary
This paper proposes OCTA-MTL, a multi-task learning framework for OCTA vessel segmentation that combines a segmentation head with an image-to-DT branch and an adaptive loss combination strategy. The method addresses the challenge of automated OCTA segmentation by jointly optimizing for vessel masks and distance transforms, with dynamically weighted losses. Evaluated on the ROSE-2 dataset, OCTA-MTL demonstrates improved segmentation accuracy compared to both single-task and multi-task baselines.

## Method Summary
OCTA-MTL is a multi-task learning framework that jointly optimizes a segmentation head and an image-to-DT branch for OCTA vessel segmentation. The method uses a shared encoder to extract features from input OCTA images, which are then processed by two separate heads: a segmentation decoder optimized with BCE loss and an image-to-DT branch optimized with MSE loss. The key innovation is an adaptive loss combination strategy that dynamically adjusts the weights of these losses based on their average values, preventing one task from dominating training. The image-to-DT branch predicts distance transforms from vessel voxels to vessel surfaces, providing shape prior and boundary information that improves segmentation quality.

## Key Results
- OCTA-MTL achieves 0.57 Dice coefficient on ROSE-2 dataset, compared to 0.54 for single-task Unet baseline
- OCTA-MTL achieves 0.35 IoU score, compared to 0.20 for multi-task method with fixed loss combination
- The adaptive loss combination strategy enables better balance between segmentation and distance transform tasks

## Why This Works (Mechanism)

### Mechanism 1
The image-to-DT branch provides shape prior and boundary information that improves segmentation quality by predicting the distance transform of vessels. This creates pixel-wise distance information relative to vessel boundaries, which the segmentation head leverages through shared encoder features. This mechanism assumes distance transform information is complementary to binary vessel masks and improves boundary delineation.

### Mechanism 2
The adaptive loss combination strategy balances task difficulty by inversely weighting losses based on their average values. The loss weight α is computed as the ratio of average BCE loss to average MSE loss, giving higher weight to the easier task and lower weight to the harder task. This mechanism assumes tasks have different inherent difficulties and loss scales that need dynamic balancing.

### Mechanism 3
Multi-task learning with shared encoder extracts common patterns that improve generalization across both segmentation and distance transform tasks. By jointly optimizing for both vessel segmentation and distance transform prediction, the shared encoder learns representations that capture both the presence of vessels and their geometric properties, leading to more robust feature extraction. This mechanism assumes vessel segmentation and distance transform prediction share underlying visual patterns that benefit from joint learning.

## Foundational Learning

- **Binary Cross-Entropy (BCE) Loss**: Used for the segmentation head to optimize pixel-wise binary classification of vessel vs. background. Quick check: How does BCE loss handle class imbalance in medical image segmentation?

- **Mean Squared Error (MSE) Loss**: Used for the image-to-DT branch to optimize pixel-wise regression of distance values. Quick check: Why is MSE appropriate for distance transform regression compared to other regression losses?

- **Distance Transform**: Provides geometric information about vessel boundaries that complements binary segmentation masks. Quick check: How is the distance transform computed from a binary vessel mask using Euclidean distance?

## Architecture Onboarding

- **Component map**: Input OCTA image → Shared encoder → Segmentation head (decoder with BCE loss) + Image-to-DT branch (regression network with MSE loss) → Combined loss with adaptive weighting
- **Critical path**: Input → Encoder → Both heads → Loss computation → Backpropagation through shared encoder
- **Design tradeoffs**: Added computational cost and complexity of multi-task training vs. improved segmentation accuracy and boundary information
- **Failure signatures**: One task consistently dominates (loss imbalance), poor distance transform prediction, segmentation quality degrades compared to single-task baseline
- **First 3 experiments**:
  1. Train single-task Unet baseline on OCTA segmentation only
  2. Train multi-task version with fixed loss combination (no adaptive weighting)
  3. Train full OCTA-MTL with adaptive loss combination and compare all three approaches using Dice and IoU metrics on ROSE-2 dataset

## Open Questions the Paper Calls Out

### Open Question 1
How does OCTA-MTL perform on other OCTA datasets beyond ROSE-2, particularly those with different vessel morphologies or image qualities? The current evaluation is limited to a single dataset, which may not capture the method's generalizability across diverse OCTA imaging conditions. Testing OCTA-MTL on multiple OCTA datasets with varying vessel structures, resolutions, and noise characteristics would resolve this.

### Open Question 2
How do transformer-based architectures compare to the current encoder-decoder approach in OCTA segmentation, and would they further improve OCTA-MTL's performance? While transformer models have shown promise in medical image analysis, their specific application and benefits for OCTA segmentation with multi-task learning remain unexplored. Implementing OCTA-MTL with transformer encoders and comparing performance would resolve this.

### Open Question 3
What alternative loss functions or adaptive weighting strategies could further improve the balance between segmentation and image-to-DT tasks in OCTA-MTL? The current strategy uses inverse average loss values, but other approaches (e.g., uncertainty-based weighting, gradient normalization) might yield better task balancing. Experimenting with different loss weighting schemes would resolve this.

## Limitations

- Evaluation is based on a single dataset (ROSE-2), limiting generalizability to other OCTA datasets or clinical settings
- The paper lacks detailed ablation studies on individual contributions of the image-to-DT branch versus adaptive loss strategy
- Computational overhead of the multi-task framework is not quantified, which is critical for clinical deployment considerations

## Confidence

- **High confidence**: The mechanism of distance transform providing boundary information is well-established in segmentation literature and logically sound
- **Medium confidence**: The adaptive loss combination strategy shows promise but lacks rigorous ablation studies to confirm its effectiveness independent of other factors
- **Low confidence**: The claim that multi-task learning inherently improves generalization is not sufficiently supported by comparative studies against single-task models with enhanced architectures

## Next Checks

1. **Ablation Study**: Conduct controlled experiments to isolate the effects of the image-to-DT branch and adaptive loss strategy on segmentation performance
2. **Dataset Generalization**: Test the OCTA-MTL model on multiple OCTA datasets to assess robustness and generalizability across different imaging conditions and populations
3. **Computational Efficiency**: Measure inference time and memory requirements compared to single-task baselines to evaluate clinical deployment feasibility