---
ver: rpa2
title: 'ShipGen: A Diffusion Model for Parametric Ship Hull Generation with Multiple
  Objectives and Constraints'
arxiv_id: '2311.06315'
source_url: https://arxiv.org/abs/2311.06315
tags:
- hull
- design
- hulls
- ship
- ddpm
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper demonstrates the use of a guided denoising diffusion
  probabilistic model (DDPM) to rapidly generate high-performing and feasible parametric
  ship hull designs. The DDPM is trained on a dataset of 30,000 parameterized ship
  hulls and their performance metrics.
---

# ShipGen: A Diffusion Model for Parametric Ship Hull Generation with Multiple Objectives and Constraints

## Quick Facts
- arXiv ID: 2311.06315
- Source URL: https://arxiv.org/abs/2311.06315
- Reference count: 40
- Primary result: Generated ship hulls achieve 99.5% feasibility rate and 91.4% reduction in wave drag coefficient

## Executive Summary
ShipGen is a guided denoising diffusion probabilistic model (DDPM) designed to rapidly generate high-performing and feasible parametric ship hull designs. The model is trained on a dataset of 30,000 parameterized ship hulls and their performance metrics, enabling it to capture the statistical relationships between design parameters that lead to feasible and efficient hulls. By leveraging classifier guidance and performance guidance, ShipGen produces hull designs that satisfy all constraints 99.5% of the time and achieve significant improvements in wave drag coefficient and displaced volume compared to the mean performance of hulls in the training dataset.

## Method Summary
ShipGen employs a tabular DDPM architecture trained on the Ship-D dataset of 30,000 feasible parametric ship hulls. The model denoises random noise into valid design vectors through iterative refinement, implicitly learning the joint distribution of design parameters. Classifier guidance is applied during sampling to steer the denoising process toward constraint-compliant regions, while performance guidance uses pre-trained neural networks to predict and optimize seven key performance metrics (wave drag, surface area, volume, MaxBox, Gaussian curvature). The generated design vectors are then converted to 3D meshes for performance evaluation.

## Key Results
- Generated hulls achieve 99.5% feasibility rate, a 149x improvement over random sampling
- Average 91.4% reduction in wave drag coefficient compared to training dataset mean
- Average 47.9x relative increase in total displaced volume

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Classifier guidance improves feasibility satisfaction by steering denoising steps toward constraint-compliant regions
- Mechanism: The classifier network outputs gradients that push the latent vector away from violating regions during each denoising step, effectively creating a "feasibility force field"
- Core assumption: The classifier accurately distinguishes feasible from infeasible design vectors and provides useful gradients for navigation
- Evidence anchors:
  - [abstract]: "By leveraging classifier guidance, the DDPM produced feasible parametric ship hulls that maintain the coverage of the initial training dataset of ship hulls with a 99.5% rate, a 149x improvement over random sampling"
  - [section]: "The classifier identifies hulls as satisfying all the constraints or violating at least one of the forty nine constraints... This gradient is multiplied by a hyperparameter, γ, and is added to the sample during Step 4 of the DDPM sampling algorithm"
  - [corpus]: Weak evidence - no related work explicitly discusses classifier-guided feasibility navigation in engineering design

### Mechanism 2
- Claim: Performance guidance generates high-performing designs by leveraging pre-trained regression networks
- Mechanism: Multiple regression networks predict performance metrics from design vectors, and their gradients are combined to steer the denoising process toward regions with desired performance characteristics
- Core assumption: The regression networks accurately predict performance metrics and their gradients meaningfully guide toward better designs
- Evidence anchors:
  - [abstract]: "Parametric ship hulls produced with performance guidance saw an average of 91.4% reduction in wave drag coefficients and an average of a 47.9x relative increase in the total displaced volume of the hulls"
  - [section]: "Seven residual neural networks were trained to predict the normalized performance of a hull given its parametric design vector... The gradients of the seven performance prediction networks are calculated for each sampling timestep"
  - [corpus]: Weak evidence - limited examples of performance-guided diffusion in engineering design applications

### Mechanism 3
- Claim: TabDDPM architecture enables efficient tabular data generation for parametric designs
- Mechanism: The model learns to denoise parametric design vectors through iterative refinement, implicitly capturing statistical relationships between parameters that lead to feasible designs
- Core assumption: The denoising process effectively learns the joint distribution of design parameters, including implicit feasibility constraints
- Evidence anchors:
  - [section]: "A tabular DDPM was built and trained on the ship hull parametric design information from the Ship-D dataset... The DDPM used to create ShipGen was inspired by the work of Kotelnikov et.al, called TabDDPM"
  - [section]: "The standard DDPM produces feasible hulls 51.1% of the time, as seen in Table 4... This is much better than the success rate seen by randomly sampling the design space"
  - [corpus]: Moderate evidence - TabDDPM is referenced as the architectural inspiration, but specific engineering design applications are limited

## Foundational Learning

- Concept: Denoising diffusion probabilistic models (DDPM)
  - Why needed here: Understanding the core denoising process is essential for grasping how ShipGen generates designs and how guidance is applied
  - Quick check question: How does a DDPM transform random noise into meaningful design vectors through the denoising process?

- Concept: Classifier and performance guidance mechanisms
  - Why needed here: These mechanisms are critical for improving feasibility and performance, and understanding their implementation is key to using or extending ShipGen
  - Quick check question: What role do the classifier and performance prediction networks play in the sampling process, and how are their gradients applied?

- Concept: Parametric hull design representation and constraints
  - Why needed here: Understanding the design space and feasibility criteria is essential for interpreting results and potentially modifying the model
  - Quick check question: What are the key design parameters and algebraic constraints used to define feasible hull geometries?

## Architecture Onboarding

- Component map: Ship-D dataset -> TabDDPM -> Classifier network -> Seven performance prediction networks -> Guidance integration module -> Mesh generation and performance evaluation pipeline
- Critical path: Ship-D → TabDDPM training → Classifier and performance network training → Guided sampling → Mesh generation → Performance evaluation
- Design tradeoffs:
  - Guidance strength (γ) vs. dataset coverage: Higher γ improves feasibility but reduces diversity
  - Performance weight distribution: Balancing multiple objectives affects which designs are generated
  - Model complexity vs. training efficiency: More performance objectives increase computational cost
- Failure signatures:
  - Low feasibility rates despite guidance (classifier issues)
  - Poor performance improvements (inaccurate regression networks)
  - Excessive clustering in design space (overly strong guidance)
  - Computational bottlenecks in mesh generation or performance evaluation
- First 3 experiments:
  1. Train the TabDDPM on Ship-D and evaluate baseline feasibility without guidance
  2. Implement classifier guidance with varying γ values and measure feasibility vs. coverage tradeoff
  3. Add performance guidance and compare generated hull performance against Ship-D baseline

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the λ weights for different performance metrics be optimally tuned to achieve balanced improvements across all objectives?
- Basis in paper: [explicit] The paper discusses that random λ weights were likely not scaled appropriately for the magnitude of the gradients of the different performance metrics, leading to disproportionate improvements in some metrics (wave drag and displaced volume) at the expense of others (surface area and Gaussian curvature)
- Why unresolved: The paper acknowledges that the λ weights were not optimally tuned and suggests that further hyperparameter tuning is needed to achieve balanced improvements across all performance objectives
- What evidence would resolve it: A study on hyperparameter tuning and guidance gradients that demonstrates improved performance across all objectives when using optimally tuned λ weights

### Open Question 2
- Question: How can the DDPM be adapted to generate ship hulls tailored to specific use cases with defined performance requirements?
- Basis in paper: [explicit] The paper mentions that future work will explore generating hulls with specific performance requirements to find explicit applicability of guided DDPMs to generate hulls tied to real cost savings in ship design
- Why unresolved: The paper only demonstrates the ability to generate high-performing hulls in general, without considering specific user-defined constraints or performance targets
- What evidence would resolve it: A study that demonstrates the successful generation of ship hulls with specific performance requirements, such as defined dimensions, volume, speed, or other user-defined constraints, while maintaining high performance

### Open Question 3
- Question: How can the DDPM be extended to generate other aspects of ship design beyond hull shapes, such as structural design, packing arrangements, machinery, and outfitting?
- Basis in paper: [explicit] The paper mentions that future work will explore the use of DDPMs to generate other aspects of ship design beyond hull shapes
- Why unresolved: The paper only focuses on the generation of ship hull designs and does not explore the application of DDPMs to other areas of ship design
- What evidence would resolve it: A study that demonstrates the successful application of DDPMs to generate other aspects of ship design, such as structural components, interior layouts, or machinery arrangements, while maintaining feasibility and performance requirements

## Limitations
- Exact architectures and hyperparameters of the DDPM, classifier, and performance networks are not fully specified, making direct replication challenging
- Performance improvements are demonstrated against the training dataset baseline, but comparison with other state-of-the-art hull design methods is lacking
- Computational cost of guidance mechanisms and their impact on generation speed is not discussed in detail

## Confidence
- **High confidence**: The TabDDPM architecture effectively learns the statistical relationships in the Ship-D dataset, as evidenced by the 51.1% feasibility rate without guidance
- **Medium confidence**: The classifier guidance mechanism reliably improves feasibility rates, though the exact mechanism of how gradients navigate the complex feasibility landscape is not fully explained
- **Medium confidence**: Performance guidance achieves significant improvements in targeted metrics, but the robustness of these improvements across different design scenarios is not demonstrated

## Next Checks
1. **Cross-validation on held-out designs**: Test ShipGen's performance on hull designs not present in the training dataset to verify generalization capabilities
2. **Comparison with baseline methods**: Evaluate generated hulls against designs produced by traditional parametric optimization methods to assess practical advantages
3. **Robustness analysis**: Vary the guidance strength parameters (γ and λ values) systematically to map the feasibility-coverage and performance-diversity tradeoffs