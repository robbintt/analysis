---
ver: rpa2
title: Accurate and interpretable drug-drug interaction prediction enabled by knowledge
  subgraph learning
arxiv_id: '2311.15056'
source_url: https://arxiv.org/abs/2311.15056
tags:
- knowddi
- subgraph
- drug
- knowledge
- which
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper presents KnowDDI, a graph neural network method for drug-drug
  interaction (DDI) prediction that leverages external biomedical knowledge graphs
  to compensate for limited DDI data. The method enhances drug representations by
  adaptively extracting and refining knowledge subgraphs for each drug-pair, selectively
  keeping important interactions and adding "resemble" edges between similar drugs.
---

# Accurate and interpretable drug-drug interaction prediction enabled by knowledge subgraph learning

## Quick Facts
- **arXiv ID:** 2311.15056
- **Source URL:** https://arxiv.org/abs/2311.15056
- **Reference count:** 40
- **Primary result:** State-of-the-art DDI prediction with macro F1 scores of 91.53% and 88.04% on DrugBank and TWOSIDES datasets

## Executive Summary
This paper introduces KnowDDI, a graph neural network method for predicting drug-drug interactions (DDIs) that leverages external biomedical knowledge graphs to address data scarcity. The approach enhances drug representations by adaptively extracting and refining knowledge subgraphs for each drug-pair, selectively keeping important interactions and adding "resemble" edges between similar drugs. KnowDDI achieves state-of-the-art performance on two established DDI datasets while providing interpretable explanations through learned knowledge subgraphs containing explaining paths.

## Method Summary
KnowDDI combines DDI fact triplets with an external biomedical knowledge graph (Hetionet) to learn generic drug embeddings via GraphSAGE. For each drug-pair, it extracts K-hop enclosing subgraphs and directionally prunes edges not pointing toward the target drug. The method then iteratively refines these drug-flow subgraphs by estimating connection strengths between nodes, adding "resemble" edges between highly similar drugs, and removing edges with low importance. DDI prediction is performed using a classifier on concatenated subgraph embeddings and drug embeddings. The approach works for both multiclass and multilabel DDI prediction settings.

## Key Results
- Achieves state-of-the-art macro F1 scores of 91.53% and 88.04% on DrugBank and TWOSIDES datasets respectively
- Demonstrates superior performance on rare DDI relations compared to baseline methods
- Shows better robustness to sparser knowledge graphs compared to existing approaches
- Provides interpretable explanations through learned knowledge subgraphs containing explaining paths

## Why This Works (Mechanism)

### Mechanism 1
- Claim: External biomedical knowledge graphs compensate for the scarcity of known DDI fact triplets
- Mechanism: Generic embeddings are learned on the combined network of DDI graph and external KG, encoding rich biomedical knowledge. These generic embeddings are then transformed on drug-pair-specific knowledge subgraphs to be more predictive of DDI types.
- Core assumption: External KG contains relevant and useful information for DDI prediction that can be transferred to the DDI task.
- Evidence anchors: [abstract] mentions enhancing drug representations by leveraging neighborhood information from large biomedical knowledge graphs; [section] describes learning generic embeddings on the combined network and transforming them on knowledge subgraphs.

### Mechanism 2
- Claim: Propagating drug similarities through learned "resemble" edges in knowledge subgraphs helps compensate for unknown DDIs
- Mechanism: KnowDDI estimates connection strengths between all node-pairs in drug-flow subgraphs. If two nodes are disconnected but have highly similar embeddings, a new "resemble" edge is added. This allows information to flow between similar drugs whose interactions are unknown.
- Core assumption: Drugs with similar representations are likely to have similar interaction patterns, even if their specific interaction is unknown.
- Evidence anchors: [abstract] states explaining paths consist of edges of important known DDIs or newly-added edges connecting highly similar drugs; [section] describes adding "resemble" edges between nodes with highly similar embeddings.

### Mechanism 3
- Claim: Removing irrelevant edges from drug-flow subgraphs and only keeping explaining paths improves DDI prediction performance
- Mechanism: KnowDDI iteratively refines the graph structure by estimating connection strengths and removing edges with low importance. The resulting knowledge subgraph only contains edges that are important for explaining the current prediction result.
- Core assumption: Many edges in the drug-flow subgraph are irrelevant to the specific DDI being predicted and their removal improves the signal-to-noise ratio.
- Evidence anchors: [abstract] mentions estimating connection strength for every drug-pair and dropping edges with low importance; [section] describes keeping only useful information flows between nodes during the refinement process.

## Foundational Learning

- Concept: Graph Neural Networks (GNNs) for learning node representations on graph-structured data
  - Why needed here: KnowDDI uses GNNs to learn generic embeddings on the combined network and to refine node embeddings on knowledge subgraphs. Understanding GNNs is fundamental to grasping how KnowDDI works.
  - Quick check question: How does a GNN aggregate information from a node's neighbors to update its representation?

- Concept: Link prediction on graphs using subgraph-based approaches
  - Why needed here: KnowDDI extracts subgraphs for each drug-pair and predicts DDIs based on these subgraphs. Understanding subgraph-based link prediction is key to understanding the overall approach.
  - Quick check question: What are the advantages of using subgraphs for link prediction compared to using the entire graph?

- Concept: Knowledge graph embeddings and their applications
  - Why needed here: KnowDDI leverages an external knowledge graph to enrich drug representations. Understanding knowledge graph embeddings helps in grasping how external knowledge is incorporated.
  - Quick check question: How can knowledge graph embeddings be used to transfer information from a large KG to a downstream task with limited data?

## Architecture Onboarding

- Component map: Generic embedding generation -> Drug-flow subgraph extraction -> Knowledge subgraph generation -> DDI prediction
- Critical path: Generic embedding generation → Drug-flow subgraph extraction → Knowledge subgraph generation → DDI prediction
- Design tradeoffs:
  - Tradeoff between subgraph size and computational efficiency (controlled by K and P)
  - Balance between keeping drug-flow subgraph information and updated subgraph information (controlled by α)
  - Tradeoff between keeping more edges for information flow and removing noisy edges (controlled by γ)
- Failure signatures:
  - Poor performance on relations with few known DDIs suggests external KG compensation is not working
  - Performance degradation when external KG is sparser suggests reliance on propagated similarities
  - Performance improvement when external KG is added suggests benefit of enriched representations
- First 3 experiments:
  1. Compare performance with and without external KG to validate the compensation mechanism
  2. Vary the hyperparameters K and P to find the optimal subgraph size
  3. Compare performance with and without the "resemble" edge mechanism to validate the similarity propagation

## Open Questions the Paper Calls Out
- How would KnowDDI's performance change if different biomedical knowledge graphs beyond Hetionet were used? The authors note that other biomedical KGs like ogbl-biokg, OpenBioLink, and PharmKG can also be used but only evaluate with Hetionet.
- How does KnowDDI's performance compare to other DDI prediction methods when molecular feature information is incorporated? The authors deliberately exclude molecular features to test the method's ability to learn from graph structure alone.
- How would KnowDDI perform on DDI prediction for newly discovered drugs with no known interactions in the training data? The paper doesn't test the zero-shot scenario for completely new drugs with zero known interactions.

## Limitations
- The core mechanism relies heavily on the quality and relevance of the external knowledge graph (Hetionet), which is not validated for DDI-specific information content.
- The "resemble" edge mechanism assumes drug similarity in embedding space correlates with DDI similarity, which may not hold for all drug classes.
- The knowledge subgraph refinement process lacks ablation studies showing the necessity of each component.

## Confidence
- Overall performance claims: High confidence (state-of-the-art results on two established datasets)
- External KG compensation mechanism: Medium confidence (mechanism described but not extensively validated)
- "Resemble" edge effectiveness: Low confidence (novel mechanism without external validation)
- Interpretability claims: Medium confidence (explaining paths identified but biological relevance not assessed)

## Next Checks
1. Conduct ablation study removing the external KG to quantify its specific contribution versus baseline GNN performance
2. Test the "resemble" edge mechanism on a dataset where drug similarities are known to be unreliable (e.g., structurally dissimilar drugs with similar mechanisms)
3. Evaluate whether explaining paths correspond to biologically plausible mechanisms by consulting domain experts or existing biomedical literature