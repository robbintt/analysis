---
ver: rpa2
title: An interpretable deep learning method for bearing fault diagnosis
arxiv_id: '2308.10292'
source_url: https://arxiv.org/abs/2308.10292
tags:
- samples
- sample
- training
- test
- fault
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents an interpretable deep learning method for bearing
  fault diagnosis that addresses the challenge of black-box DL models in safety-critical
  maintenance tasks. The core idea is to use a convolutional neural network (CNN)
  with Gradient-weighted Class Activation Mapping (Grad-CAM) to generate activation
  maps and create a health library containing training samples with annotated feature
  importance.
---

# An interpretable deep learning method for bearing fault diagnosis

## Quick Facts
- arXiv ID: 2308.10292
- Source URL: https://arxiv.org/abs/2308.10292
- Authors: 
- Reference count: 40
- Primary result: An interpretable deep learning method using CNN with Grad-CAM to generate prediction basis samples for bearing fault diagnosis

## Executive Summary
This paper presents an interpretable deep learning method for bearing fault diagnosis that addresses the challenge of black-box DL models in safety-critical maintenance tasks. The core idea is to use a convolutional neural network (CNN) with Gradient-weighted Class Activation Mapping (Grad-CAM) to generate activation maps and create a health library containing training samples with annotated feature importance. During model evaluation, the method retrieves prediction basis samples from the health library based on similarity of feature importance distributions. The proposed method can be applied to any CNN model without modifying its architecture. Experimental results on the Paderborn University bearing dataset show that the method can select prediction basis samples that are intuitively and physically meaningful, improving the model's trustworthiness for human users.

## Method Summary
The method involves training a 1D CNN on envelope order spectra of vibration signals from bearings, then using Grad-CAM to generate activation maps for training samples. These activation maps are stored in a health library with their corresponding class labels. During evaluation, the method computes activation vectors for test samples and compares them to the activation vectors in the health library using Euclidean distance in normalized vector space. The most similar samples are retrieved as prediction basis samples to justify model predictions. The method includes two variants: CAM-Full, which considers the entire frequency range, and CAM-Sub, which focuses on fault characteristic frequency sub-bands.

## Key Results
- CAM-Sub outperformed CAM-Full in identifying important training samples and produced more intuitive prediction basis samples
- The method's effectiveness was validated against random sample selection, demonstrating its potential for enhancing interpretability in bearing fault diagnosis
- Experimental results on the Paderborn University bearing dataset show the method can select prediction basis samples that are intuitively and physically meaningful

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The health library approach improves interpretability by retrieving training samples whose feature importance distributions closely match those of test samples
- Mechanism: During evaluation, the method computes Grad-CAM activation vectors for test samples and compares them to activation vectors of training samples in the health library using Euclidean distance in normalized vector space
- Core assumption: Similar feature importance distributions indicate relevant diagnostic information for justifying model predictions
- Break condition: If feature importance distributions are not discriminative enough to distinguish between different fault types, the retrieval mechanism fails to provide meaningful prediction basis samples

### Mechanism 2
- Claim: CAM-Sub outperforms CAM-Full by focusing feature importance analysis on fault characteristic frequency sub-bands rather than the entire frequency range
- Mechanism: CAM-Sub defines frequency sub-bands centered at bearing fault characteristic frequencies and their harmonics, then computes activation vectors only within these sub-bands
- Core assumption: Fault characteristic frequencies contain the most critical diagnostic information for bearing fault classification
- Break condition: If fault signatures extend significantly beyond the defined sub-bands or if multiple fault types share similar frequency characteristics, CAM-Sub may miss important diagnostic features

### Mechanism 3
- Claim: Removing high-importance training samples causes greater accuracy degradation than removing random samples, validating the importance ranking mechanism
- Mechanism: The method ranks training samples by their average Euclidean distance to test samples with the same label, then removes top-ranked samples to retrain models
- Core assumption: Training samples with smaller average distances to test samples are more important for maintaining model performance
- Break condition: If the dataset contains redundant information or if model performance is not sensitive to specific training samples, the importance ranking may not correlate with actual model behavior

## Foundational Learning

- Concept: Gradient-weighted Class Activation Mapping (Grad-CAM)
  - Why needed here: Grad-CAM provides visual explanations of CNN predictions by generating activation maps that highlight important regions in input data, essential for creating interpretable feature importance vectors
  - Quick check question: How does Grad-CAM compute the importance weight for each filter in the last convolutional layer?

- Concept: Bearing fault characteristic frequencies
  - Why needed here: Understanding how bearing geometry determines fault frequencies is crucial for defining relevant frequency sub-bands in CAM-Sub and interpreting activation maps
  - Quick check question: What bearing parameters are required to calculate outer race and inner race fault frequencies?

- Concept: Signal processing for vibration analysis
  - Why needed here: Envelope analysis and order normalization are required preprocessing steps to extract fault signatures from raw vibration data and prepare it for CNN analysis
  - Quick check question: Why is envelope analysis necessary for detecting bearing faults in vibration signals?

## Architecture Onboarding

- Component map: Signal preprocessing pipeline (time domain → order domain) -> 1D CNN classifier (feature extractor + global max pooling + softmax classifier) -> Grad-CAM visualization module -> Health library creation module -> Prediction basis retrieval module

- Critical path:
  1. Preprocess vibration data using envelope analysis and order normalization
  2. Train 1D CNN on preprocessed data
  3. Generate Grad-CAM activation maps for training samples
  4. Create health library with activation vectors and class labels
  5. For each test sample: compute activation vector, find similar training samples, retrieve prediction basis

- Design tradeoffs:
  - CAM-Full vs CAM-Sub: broader frequency coverage vs focused diagnostic relevance
  - Library size vs retrieval speed: larger libraries provide more options but slower similarity searches
  - Number of prediction basis samples vs interpretability: more samples provide better justification but may overwhelm users

- Failure signatures:
  - Prediction basis samples show different fault patterns than test samples
  - Similar activation vectors from different fault classes
  - Large variations in model performance across runs when removing important samples
  - Activation maps show high importance in frequency ranges unrelated to bearing faults

- First 3 experiments:
  1. Compare CAM-Full and CAM-Sub retrieval results on a single test sample with known ground truth
  2. Measure classification accuracy degradation when removing top 10%, 20%, 30% of training samples by importance
  3. Visualize activation maps for test samples and their top prediction basis samples to verify intuitive similarity

## Open Questions the Paper Calls Out

- Question: How does the CAM-Sub method's performance compare to CAM-Full when applied to bearings with different fault types (e.g., roller faults or combined faults)?
- Question: What is the optimal sub-band width parameter (ϵ) for CAM-Sub across different bearing types and operating conditions?
- Question: How does model uncertainty affect the selection of prediction basis samples, and can this uncertainty be quantified?
- Question: Can the CAM-Sub method be extended to predict bearing remaining useful life (RUL) rather than just fault classification?

## Limitations

- The method relies heavily on Grad-CAM's ability to accurately identify relevant features in bearing fault diagnosis, but Grad-CAM's reliability for 1D vibration signals remains underexplored
- The similarity metric (Euclidean distance in normalized activation space) may not capture all relevant aspects of feature importance relationships
- The effectiveness of frequency sub-band selection for CAM-Sub depends on accurate bearing geometry and operating conditions, which may vary in real-world applications

## Confidence

- **High Confidence**: The basic framework of using Grad-CAM with a health library for interpretability is sound and technically feasible
- **Medium Confidence**: The superiority of CAM-Sub over CAM-Full for fault characteristic frequency analysis is demonstrated but needs broader validation
- **Low Confidence**: The claim that removing important training samples causes greater accuracy degradation than random removal needs more rigorous statistical validation

## Next Checks

1. **Cross-dataset validation**: Apply the method to additional bearing datasets (e.g., Case Western Reserve University dataset) to verify generalizability beyond the Paderborn University dataset
2. **Ablation study on frequency sub-bands**: Systematically vary the width and position of fault frequency sub-bands to quantify the sensitivity of CAM-Sub performance to these parameters
3. **Human interpretability assessment**: Conduct user studies with domain experts to evaluate whether the prediction basis samples genuinely improve their trust and understanding of model decisions compared to standard Grad-CAM visualizations