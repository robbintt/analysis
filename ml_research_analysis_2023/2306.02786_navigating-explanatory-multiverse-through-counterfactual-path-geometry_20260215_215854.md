---
ver: rpa2
title: Navigating Explanatory Multiverse Through Counterfactual Path Geometry
arxiv_id: '2306.02786'
source_url: https://arxiv.org/abs/2306.02786
tags:
- counterfactual
- paths
- explanatory
- path
- data
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces the concept of explanatory multiverse to
  navigate the multiplicity of counterfactual paths in explainable AI. The key idea
  is to formalize and analyze the geometric properties of counterfactual trajectories
  - their affinity, branching, divergence, and convergence - using vector spaces and
  graphs.
---

# Navigating Explanatory Multiverse Through Counterfactual Path Geometry

## Quick Facts
- arXiv ID: 2306.02786
- Source URL: https://arxiv.org/abs/2306.02786
- Reference count: 11
- One-line primary result: Formalizes and analyzes geometric properties of counterfactual trajectories using vector spaces and graphs to enable spatial reasoning about agency, loss of opportunity, and choice complexity

## Executive Summary
This paper addresses the challenge of navigating multiplicity in counterfactual explanations by introducing the concept of explanatory multiverse. Rather than treating counterfactuals as isolated points, the authors formalize and analyze the geometric properties of counterfactual trajectories - including affinity, branching, divergence, and convergence - using vector spaces and graphs. This spatial approach enables reasoning about spatially-aware desiderata like agency, loss of opportunity, and choice complexity that traditional spatially-unaware metrics cannot capture.

The method allows users to explore counterfactuals based not just on their absolute differences but also on the characteristics of their connecting paths. A graph-based implementation is proposed and evaluated qualitatively and quantitatively on tabular and image datasets, demonstrating the approach's efficacy in capturing diverse path geometries and ranking counterfactuals based on their spatial properties.

## Method Summary
The paper introduces two complementary approaches for analyzing counterfactual path geometry: vector-based paths and graph-based pathfinding. The vector-based approach normalizes paths into equal-step vectors for comparison and affinity grouping, while the graph-based approach constructs directed graphs with edges weighted by distance metrics and penalties for feature removal. Both methods analyze spatial properties including branching delay, branching factor, path directionality, and affinity between journeys. The approach enables users to explore counterfactuals based on spatially-aware desiderata rather than absolute differences alone.

## Key Results
- Introduces three novel spatially-aware desiderata: agency (number of available choices), loss of opportunity (incompatibility between explanations), and choice complexity (influence of decisions on explanation availability)
- Demonstrates that delayed branching preserves user agency by keeping multiple recourse options available longer
- Shows that spatial path properties can be quantified and used to rank counterfactuals beyond traditional spatially-unaware metrics
- Validates approach qualitatively and quantitatively on tabular and image datasets including MNIST

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The method reduces counterfactual multiplicity by collapsing paths based on spatial affinity, thus lowering cognitive load for explainees.
- Mechanism: Paths are grouped by similarity using a distance metric (e.g., Frobenius norm) between normalized journey vectors. Paths with low pairwise distance are merged, reducing the total number of explanations shown.
- Core assumption: Spatially similar paths lead to similar decision outcomes and are interchangeable from the user's perspective.
- Evidence anchors:
  - [abstract] "Our conceptualisation accounts for technical, spatially-unaware, desiderata... and defines novel, spatially-aware properties such as branching delay, branching factor, (change in) path directionality and affinity between journeys."
  - [section] "Our conceptualisation of explanatory multiverse extends them with three novel, spatially-aware desiderata. Agency captures the number of choices – leading to diverse counterfactuals – available to explainees..."
- Break condition: If the similarity threshold is set too low, distinct counterfactuals may be incorrectly merged, losing meaningful alternatives. If too high, the benefit of multiplicity reduction disappears.

### Mechanism 2
- Claim: The method quantifies loss of opportunity by tracking how many counterfactuals become unreachable after each step along a path.
- Mechanism: After each step, the algorithm recomputes the branching factor for remaining reachable counterfactuals. A decrease in this factor indicates a loss of opportunity; the magnitude of decrease reflects the severity.
- Core assumption: Feature changes are often irreversible or directional, so taking one path can block access to alternative counterfactuals.
- Evidence anchors:
  - [abstract] "Loss of Opportunity encompasses the incompatibility of subsets of explanations that emerges as a consequence of enacting changes prescribed by steps along counterfactual paths."
  - [section] "For example, moving towards one explanation may require backtracking the steps taken thus far – which may be impossible due to the directionality of feature change – to arrive at a different, equally suitable, counterfactual."
- Break condition: If the model incorrectly assumes irreversibility for reversible features, it may overestimate loss of opportunity. If features are truly reversible, this metric becomes irrelevant.

### Mechanism 3
- Claim: Delayed branching reduces early commitment, increasing user agency by preserving multiple recourse options longer.
- Mechanism: Paths are scored by the distance (or number of steps) from the factual instance to the first branching point. Paths with later branching receive higher scores, incentivizing detours that keep more counterfactuals accessible.
- Core assumption: Users benefit from having more options available for longer before narrowing choices.
- Evidence anchors:
  - [abstract] "Choice Complexity encapsulates the influence of explainees’ decisions to follow specific counterfactual paths on the availability of diverse explanations."
  - [section] "For example, among otherwise equivalent paths, following those whose branching is delayed reduces early commitment to a particular set of explanations."
- Break condition: If delayed branching results in significantly longer paths, users may prefer shorter paths despite fewer options. Trade-off must be tuned to user preference.

## Foundational Learning

- Concept: Counterfactual explanations in ML
  - Why needed here: The entire paper builds on defining and manipulating counterfactuals; understanding their generation and constraints is prerequisite.
  - Quick check question: What is the minimal requirement for an instance to be considered a counterfactual explanation relative to a factual instance?

- Concept: Algorithmic recourse and path-based explanations
  - Why needed here: The paper extends methods that not only output counterfactuals but also construct feasible paths to reach them.
  - Quick check question: How does algorithmic recourse differ from simple counterfactual generation?

- Concept: Graph and vector space representations of paths
  - Why needed here: Two formal methods (graph-based and vector-based) are proposed; engineers must understand both to implement or extend the approach.
  - Quick check question: In the vector space approach, how are paths of different lengths compared?

## Architecture Onboarding

- Component map: Explainer interface (e.g., FACE, Algorithmic Recourse) -> Path generator -> Path normalizer (splits into equal-step vectors) -> Affinity comparator -> Graph builder (k-NN + Dijkstra) -> Branching factor calculator -> Ranking engine (agency, loss of opportunity, choice complexity) -> Explainer output
- Critical path: Factual instance -> Path generation -> Normalization -> Affinity grouping -> Branching analysis -> Scoring -> Ranked counterfactuals
- Design tradeoffs:
  - Number of vectors p in normalization vs. granularity of comparison
  - Branching threshold ϵ vs. sensitivity to divergence
  - Graph k-NN parameter vs. path connectivity
  - Weighting of spatial vs. non-spatial desiderata in final ranking
- Failure signatures:
  - All counterfactuals collapse into one group (affinity threshold too low)
  - Paths never branch (branching threshold too high)
  - Ranking ignores non-spatial constraints (imbalance in scoring)
  - Graph becomes disconnected (k too small or λ too penalizing)
- First 3 experiments:
  1. Generate counterfactual paths on a 2D synthetic dataset, visualize affinity-based grouping.
  2. Vary branching threshold ϵ and measure change in number of clusters.
  3. Implement graph-based approach on MNIST, test λ penalty for pixel removal, measure branching factor variation.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What specific domain-specific knowledge or user inputs could effectively guide the pruning of counterfactual explanations without overwhelming explainees?
- Basis in paper: [explicit] The paper mentions that pruning counterfactual explanations based on domain-specific knowledge or generic "goodness" heuristics remains an open challenge.
- Why unresolved: This is a fundamental challenge in counterfactual explainability, as the optimal way to incorporate domain knowledge or user preferences into explanation pruning is unclear and likely problem-specific.
- What evidence would resolve it: Case studies demonstrating effective methods for incorporating domain knowledge or user input into explanation pruning across different domains, with quantitative measures of explanation quality and user satisfaction.

### Open Question 2
- Question: How can we systematically identify and formalize additional spatially-aware desiderata beyond the three proposed (agency, loss of opportunity, and choice complexity) to further enhance the explanatory multiverse concept?
- Basis in paper: [explicit] The paper acknowledges that the proposed three desiderata are preliminary and non-exhaustive, and that identifying more properties is a key area for future exploration.
- Why unresolved: The paper suggests there may be other important spatial properties of counterfactual paths that haven't been considered, but doesn't provide a systematic method for discovering them.
- What evidence would resolve it: A comprehensive study identifying and formalizing new spatially-aware desiderata, with validation through experiments demonstrating their value in specific domains.

### Open Question 3
- Question: How does the trade-off between different desiderata (e.g., agency vs. loss of opportunity) vary across different data domains and modeling problems, and how should these trade-offs be optimized in practice?
- Basis in paper: [explicit] The paper mentions that different data domains and modeling problems are expected to prioritize distinct desiderata, but doesn't provide specific guidance on how to optimize these trade-offs.
- Why unresolved: The optimal balance between different desiderata is likely problem-specific and depends on the relative importance of each property in the context of the specific application.
- What evidence would resolve it: Empirical studies across multiple domains comparing the effectiveness of different weighting schemes for desiderata, with guidance on how to choose optimal weights based on domain characteristics.

## Limitations
- The method's computational complexity for large-scale datasets is not analyzed, raising scalability concerns
- The vector normalization step assumes equal feature importance across steps, which may not hold in practice
- The branching threshold parameter is crucial but its optimal setting is not discussed

## Confidence
- High confidence: The geometric formalization of counterfactual paths and the conceptual framework are mathematically sound
- Medium confidence: The implementation details and parameter choices are reasonable but not fully specified
- Low confidence: The practical impact on user decision-making and real-world applicability remains unproven

## Next Checks
1. Test the method on a high-stakes domain (e.g., credit scoring or medical diagnosis) with domain experts to validate the practical utility of spatially-aware metrics
2. Conduct ablation studies varying the normalization granularity parameter p to determine optimal settings for different data types
3. Implement cross-validation to assess sensitivity of branching threshold selection across different datasets and feature spaces