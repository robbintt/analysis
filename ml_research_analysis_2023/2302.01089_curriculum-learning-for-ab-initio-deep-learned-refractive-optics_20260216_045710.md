---
ver: rpa2
title: Curriculum Learning for ab initio Deep Learned Refractive Optics
arxiv_id: '2302.01089'
source_url: https://arxiv.org/abs/2302.01089
tags:
- lens
- image
- design
- imaging
- edof
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The authors propose an automatic refractive lens design framework
  based on curriculum learning and differentiable ray tracing. The method can automatically
  design a compound lens from randomly initialized lens geometries without human intervention,
  overcoming the need for a good initial design.
---

# Curriculum Learning for ab initio Deep Learned Refractive Optics

## Quick Facts
- arXiv ID: 2302.01089
- Source URL: https://arxiv.org/abs/2302.01089
- Reference count: 40
- Key outcome: Automatic refractive lens design framework using curriculum learning and differentiable ray tracing to overcome local minima without human intervention

## Executive Summary
This paper presents a novel framework for automatic refractive lens design using curriculum learning and differentiable ray tracing. The method can automatically design compound lenses from randomly initialized geometries without requiring good initial designs from optical engineers. By progressively increasing the difficulty of the optimization task, the approach overcomes local minima in the highly non-convex search space. The framework also includes strategies to control lens distortion and abnormal shapes while reducing memory consumption during differentiable ray tracing.

## Method Summary
The method employs differentiable ray tracing to simulate optical performance and enables gradient-based optimization of lens geometries. A curriculum learning strategy progressively increases aperture size and field of view during optimization, starting from simpler problems where aberrations are minimal. Dynamic weight masking focuses optimization on problem regions by calculating per-pixel spot RMS error. Angular regularization prevents degenerate lens geometries that cause numerical instability. The framework supports end-to-end optimization with image reconstruction networks for computational imaging tasks like extended depth of field.

## Key Results
- Successfully designed classical imaging lenses and large field-of-view extended depth-of-field computational lenses automatically
- Overcame local minima in highly non-convex search space through curriculum learning strategy
- Achieved cellphone-style form factor designs without human intervention or good initial designs
- Reduced memory consumption through adjoint rendering with patch segmentation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Progressive difficulty reduction prevents early local minima by optimizing simpler subproblems first
- Mechanism: The curriculum starts with small aperture and field of view, where aberrations are minimal, then gradually increases difficulty to target specifications
- Core assumption: Geometric optics aberrations scale with aperture size and field angle, making simpler cases more convex
- Evidence anchors:
  - [abstract] "curriculum learning strategy is introduced to progressively increase the difficulty of the optimization task, allowing the method to overcome local minima"
  - [section] "curriculum for lens design is based on two well-known observations: 1) geometric optics aberrations are minimized for small apertures, and 2) paraxial regions are less aberrated than large angles"
- Break condition: If initial small-aperture design fails to find feasible solution, the curriculum has no easier starting point

### Mechanism 2
- Claim: Dynamic weight masking enables escape from local minima by focusing optimization on problem regions
- Mechanism: Calculates per-pixel spot RMS error and applies activation function to create weight mask that prioritizes poorly performing image regions during each training epoch
- Core assumption: Local minima often trap optimization in configurations where most of image is sharp but small regions remain problematic
- Evidence anchors:
  - [section] "we introduce a dynamic weight mask that can automatically focus on improving problem regions" and "problem regions will have a higher weight in this training epoch"
- Break condition: If weight mask becomes uniform (all regions equally good/bad), this mechanism provides no additional benefit

### Mechanism 3
- Claim: Angular regularization prevents degenerate lens geometries that cause numerical instability
- Mechanism: Penalizes rays incident at oblique angles to lens surfaces by maximizing dot product of incident rays and surface normals
- Core assumption: Abnormal lens shapes like self-intersection occur when rays hit surfaces at extreme angles during early optimization stages
- Evidence anchors:
  - [section] "we propose an angular regularization term by penalizing the rays incident on the lens at oblique angles" and "abnormal geometries should be avoided, not only for the numerical stability of the optimization process, but also to improve the manufacturing tolerances"
- Break condition: If optimization converges to smooth, well-behaved surfaces, angular regularization becomes redundant

## Foundational Learning

- Differentiable ray tracing
  - Why needed here: Enables gradient-based optimization of optical designs by tracking derivatives through ray propagation
  - Quick check question: What is the key advantage of differentiable ray tracing over traditional merit function optimization in lens design?

- Curriculum learning strategy
  - Why needed here: Addresses highly non-convex search space by breaking complex optimization into progressively harder subproblems
  - Quick check question: Why does starting with smaller aperture and field of view make the initial optimization problem easier?

- End-to-end optimization with image reconstruction
  - Why needed here: Allows joint optimization of optical design and computational image recovery for tasks like extended depth of field
  - Quick check question: How does the differentiable ray tracer enable backpropagation of errors through the image reconstruction network?

## Architecture Onboarding

- Component map:
  - Differentiable ray tracing engine (dO framework) → Optical design parameters → Simulated sensor images
  - Image reconstruction network (NAFNet) ← Simulated sensor images ← Optical design parameters
  - Curriculum controller ← Performance metrics ← Optimization state
  - Loss functions ← Weighted error signals ← Curriculum controller

- Critical path:
  1. Ray tracing simulation produces sensor image
  2. Weight mask calculation identifies problem regions
  3. Loss computation combines image quality and regularization terms
  4. Gradients backpropagated through reconstruction network
  5. Gradients backpropagated through ray tracing engine
  6. Optical parameters updated via optimizer

- Design tradeoffs:
  - Memory vs. accuracy: Adjoint rendering with patch segmentation reduces memory at cost of additional computation
  - Distortion vs. aberration control: Distortion relaxation allows better control of local aberrations but requires post-processing
  - Surface complexity vs. manufacturability: Angular regularization promotes smooth surfaces but may limit achievable performance

- Failure signatures:
  - Stuck in local minima: No improvement in loss despite continued training, weight mask becomes ineffective
  - Numerical instability: NaNs in ray tracing derivatives, self-intersecting surfaces despite regularization
  - Memory exhaustion: Out of memory errors during backpropagation, especially with high-resolution sensors

- First 3 experiments:
  1. Single lens element optimization with curriculum (start F/8, 10° FOV, progress to F/2.8, 40° FOV) to verify basic curriculum framework
  2. Two-element lens with distortion relaxation enabled to test geometric compensation mechanism
  3. Extended depth of field design with odd-polynomial surface to validate end-to-end optimization with reconstruction network

## Open Questions the Paper Calls Out

The paper does not explicitly call out open questions in the text provided.

## Limitations

- The curriculum learning framework's effectiveness for more complex lens systems beyond two-element designs remains unproven
- Angular regularization may artificially constrain optical performance by preventing optimal configurations that require extreme ray angles
- The method's scalability to multi-element zoom lenses or freeform optics with hundreds of degrees of freedom is unclear

## Confidence

High confidence in the core differentiable ray tracing implementation and its integration with neural networks for image reconstruction. The physics of ray propagation and gradient computation through optical elements is well-established.

Medium confidence in the curriculum learning effectiveness. While the progressive difficulty approach is logically sound and shows empirical success on the tested cases, the paper lacks ablation studies comparing performance with and without curriculum strategies across different lens types.

Medium confidence in the memory optimization techniques. The adjoint rendering with patch segmentation is a reasonable approach for reducing memory consumption, but specific implementation details are not provided, making it difficult to assess the practical impact on different hardware configurations.

## Next Checks

1. **Ablation study on curriculum effectiveness**: Design identical lenses using the same random initialization but with curriculum learning disabled. Compare convergence speed, final image quality, and lens geometry to quantify the curriculum's contribution beyond random initialization benefits.

2. **Scalability test with increased complexity**: Apply the framework to a four-element zoom lens design task with varying focal lengths. Measure whether the curriculum strategy maintains effectiveness as the parameter space dimensionality increases and whether new failure modes emerge.

3. **Regularization impact analysis**: Design lenses with angular regularization disabled or with reduced weighting. Compare the resulting geometries and image quality to understand the true cost of the stability constraint on optical performance, particularly for wide-angle applications where extreme ray angles may be unavoidable.