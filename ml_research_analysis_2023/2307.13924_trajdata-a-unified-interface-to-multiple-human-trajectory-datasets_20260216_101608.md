---
ver: rpa2
title: 'trajdata: A Unified Interface to Multiple Human Trajectory Datasets'
arxiv_id: '2307.13924'
source_url: https://arxiv.org/abs/2307.13924
tags:
- datasets
- dataset
- data
- agent
- lyft
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: trajdata is a unified interface for multiple human trajectory datasets,
  addressing the challenge of different data formats and APIs. It provides a standardized
  data format and API for trajectory and map data, allowing researchers to easily
  train and evaluate methods across multiple datasets.
---

# trajdata: A Unified Interface to Multiple Human Trajectory Datasets

## Quick Facts
- arXiv ID: 2307.13924
- Source URL: https://arxiv.org/abs/2307.13924
- Reference count: 40
- trajdata is a unified interface for multiple human trajectory datasets, addressing the challenge of different data formats and APIs

## Executive Summary
trajdata provides a standardized data format and API for trajectory and map data across multiple human trajectory datasets. It addresses the fragmentation in the field where researchers must navigate different data formats, APIs, and evaluation metrics for each dataset. The framework supports 8 diverse datasets with over 3,216 hours of data and 200+ million unique agents, enabling efficient multi-dataset training and evaluation. trajdata's key innovations include a tabular data frame representation for efficient querying, a standardized vector map format for spatial operations, and a simulation interface for controlled experimentation.

## Method Summary
trajdata creates a unified interface for multiple human trajectory datasets by providing standardized data formats and APIs. It uses tabular data frames with Apache Arrow storage for efficient trajectory data representation, supports agent-centric and scene-centric batching, and includes a map API with spatial indexing capabilities. The framework provides PyTorch Dataset and DataLoader classes for seamless integration with machine learning pipelines. It handles 8 diverse datasets including ETH, UCY, SDD, nuScenes, INTERACTION, Lyft Level 5, Waymo Open Motion, and nuPlan, offering functionalities for multi-dataset training, evaluation, map queries, and simulation.

## Key Results
- Supports 8 diverse datasets comprising 3,216 hours of data, 200+ million unique agents, and 10+ locations across 7 countries
- Provides a standardized data format and API enabling efficient multi-dataset training and evaluation
- Empirical evaluation shows drone-based data collection methods yield more accurate bounding box annotations than even state-of-the-art AV perception stacks with LiDAR

## Why This Works (Mechanism)

### Mechanism 1
- Claim: trajdata's tabular data frame representation enables efficient multi-dataset querying and data grouping.
- Mechanism: By internally representing trajectory data as tabular data frames, trajdata leverages advanced indexing and data grouping capabilities. This allows for efficient querying of specific agent types, time ranges, or geographic locations across multiple datasets without loading entire datasets into memory.
- Core assumption: The tabular data structure can efficiently handle the large-scale trajectory data from multiple datasets while maintaining query performance.
- Evidence anchors:
  - [abstract] "trajdata provides a simple, uniform, and efficient representation and API for trajectory and map data"
  - [section] "trajdata internally represents and stores trajectory data as tabular data frames, allowing for advanced indexing and data grouping depending on user queries"
- Break condition: If the tabular data representation becomes too large to fit in memory or if query performance degrades significantly with very large datasets.

### Mechanism 2
- Claim: trajdata's standardized vector map format enables efficient spatial queries across datasets.
- Mechanism: By adopting a polyline representation for map data and supporting four core map elements (RoadLane, RoadArea, PedCrosswalk, PedWalkway), trajdata enables efficient spatial queries like finding the closest lane to a given position or calculating road boundary violations.
- Core assumption: The standardized vector map format captures sufficient information from HD dataset maps while remaining compatible with computational geometry packages like Shapely.
- Evidence anchors:
  - [section] "To retain the most information from high-definition (HD) dataset maps, trajdata adopts a polyline representation for map data"
  - [section] "Each map element is designed to be compatible with popular computational geometry packages, such as Shapely [37], enabling efficient set-theoretic queries"
- Break condition: If the standardized map format fails to capture important map elements from specific datasets or if spatial query performance degrades significantly.

### Mechanism 3
- Claim: trajdata's simulation interface enables controlled experimentation with real-world data.
- Mechanism: By providing a simulation interface that allows users to initialize a scene from real-world data and simulate agents from a specific timestep onwards, trajdata enables controlled experimentation and evaluation of prediction models.
- Core assumption: The simulation interface accurately captures the dynamics of agents from the real-world data and can be used to generate realistic simulated trajectories.
- Evidence anchors:
  - [section] "trajdata also provides a simulation interface that enables users to initialize a scene from real-world data and simulate agents from a specific timestep onwards"
  - [section] "This functionality was extensively used to benchmark learning-based traffic models in [32, 33]"
- Break condition: If the simulation interface fails to accurately capture agent dynamics or if the simulated trajectories deviate significantly from real-world behavior.

## Foundational Learning

- Concept: Tabular data structures and their advantages for efficient querying and data manipulation.
  - Why needed here: Understanding tabular data structures is crucial for comprehending how trajdata efficiently handles large-scale trajectory data from multiple datasets.
  - Quick check question: What are the key advantages of using tabular data structures for handling large-scale trajectory data compared to other data structures like arrays or lists?

- Concept: Spatial data structures and algorithms for efficient spatial queries.
  - Why needed here: Understanding spatial data structures and algorithms is important for comprehending how trajdata efficiently performs spatial queries on map data.
  - Quick check question: What are some common spatial data structures and algorithms used for efficient spatial queries, and how do they compare to trajdata's approach?

- Concept: Simulation and its role in controlled experimentation and evaluation.
  - Why needed here: Understanding simulation and its role in controlled experimentation is important for comprehending how trajdata's simulation interface enables controlled experimentation with real-world data.
  - Quick check question: What are the key benefits of using simulation for controlled experimentation and evaluation compared to real-world data alone?

## Architecture Onboarding

- Component map:
  - Data loader -> Tabular data representation -> Vector map format -> Simulation interface -> PyTorch integration

- Critical path:
  - Load trajectory and map data from various datasets using the data loader.
  - Preprocess and convert data into trajdata's standardized format.
  - Perform efficient queries and data manipulation using the tabular data representation and vector map format.
  - Optionally, use the simulation interface for controlled experimentation with real-world data.
  - Integrate with PyTorch-based machine learning pipelines using the provided Dataset and DataLoader classes.

- Design tradeoffs:
  - Tabular data representation vs. other data structures: Tabular data structures provide efficient querying and data manipulation capabilities but may have higher memory overhead compared to other data structures like arrays or lists.
  - Standardized vector map format vs. dataset-specific formats: Standardized vector map format enables efficient spatial queries across datasets but may not capture all details of dataset-specific map formats.
  - Simulation interface vs. real-world data alone: Simulation interface enables controlled experimentation but may not fully capture the complexity and unpredictability of real-world scenarios.

- Failure signatures:
  - Slow query performance: Indicates potential issues with the tabular data representation or spatial data structures.
  - Incorrect or incomplete data loading: Indicates potential issues with the data loader or preprocessing steps.
  - Simulation artifacts or unrealistic behavior: Indicates potential issues with the simulation interface or agent dynamics modeling.

- First 3 experiments:
  1. Load a small subset of trajectory data from a single dataset and perform basic queries (e.g., filter by agent type, time range) to verify the correctness of the data loading and querying functionality.
  2. Load map data from a single dataset and perform spatial queries (e.g., find the closest lane to a given position) to verify the correctness of the spatial data structures and algorithms.
  3. Use the simulation interface to initialize a scene from real-world data and simulate a few timesteps to verify the correctness of the simulation functionality and agent dynamics modeling.

## Open Questions the Paper Calls Out

- How do different map annotation qualities (e.g., full lane definitions vs. centerline only) impact the performance of trajectory forecasting models?
- What is the impact of agent density on the generalization capabilities of trajectory forecasting models?
- How do different data collection methodologies (fixed camera, drone, onboard sensors) impact the long-term validity of trajectory forecasting benchmarks?

## Limitations

- Limited performance benchmarking data for extremely large datasets and multi-dataset training scenarios
- Qualitative rather than quantitative comparison of annotation quality between drone-based and AV perception methods
- Incomplete information about how dataset-specific map elements beyond the four core types are handled in the standardization process

## Confidence

*Medium confidence* in the scalability claims due to limited information about performance with extremely large datasets.

*Medium confidence* in the annotation quality comparison between drone-based and AV perception methods.

*Low confidence* in the completeness of the map format standardization.

## Next Checks

1. Conduct systematic benchmarks comparing trajdata's performance against existing dataset-specific loaders for common operations like data loading, batching, and querying, using datasets of varying sizes.

2. Design a quantitative study comparing bounding box annotations from drone-based and AV perception methods using established metrics like IoU (Intersection over Union) and tracking accuracy scores.

3. Create a controlled experiment to measure information loss when converting dataset-specific map formats to trajdata's standardized format, focusing on scenarios where additional map elements are present.