---
ver: rpa2
title: Geometric Data Augmentations to Mitigate Distribution Shifts in Pollen Classification
  from Microscopic Images
arxiv_id: '2311.11029'
source_url: https://arxiv.org/abs/2311.11029
tags:
- data
- pollen
- augmentation
- distribution
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the distribution shift problem in pollen classification
  from microscopic images, where models trained on curated pollen grains perform poorly
  on field data due to differences in grain appearance and lighting conditions. The
  authors propose two geometric data augmentation techniques - Tenengrad and ImageToSketch
  filters - to improve model robustness by emphasizing shape and texture information
  important for pollen identification.
---

# Geometric Data Augmentations to Mitigate Distribution Shifts in Pollen Classification from Microscopic Images

## Quick Facts
- arXiv ID: 2311.11029
- Source URL: https://arxiv.org/abs/2311.11029
- Reference count: 8
- Primary result: Geometric augmentations improve test accuracy on field data by up to 14% compared to conventional methods

## Executive Summary
This paper addresses the distribution shift problem in pollen classification from microscopic images, where models trained on curated pollen grains perform poorly on field data due to differences in grain appearance and lighting conditions. The authors propose two geometric data augmentation techniques - Tenengrad and ImageToSketch filters - to improve model robustness by emphasizing shape and texture information important for pollen identification. Extensive experiments on six CNN architectures show that the proposed geometric augmentations consistently outperform conventional augmentations, improving test accuracy on field data by up to 14%. An ablation study using pollen hydration tests further validates the effectiveness of the geometric augmentations, showing increasing performance gains as pollen grains recover their shape through hydration.

## Method Summary
The paper proposes geometric data augmentations (Tenengrad and ImageToSketch filters) to improve pollen classification model robustness against distribution shifts between curated library and field data. The method involves fine-tuning pre-trained ImageNet models on the Graz pollen dataset with geometric augmentations applied during training. The augmentations emphasize gradient-based edge and shape information while suppressing texture-specific details. The training procedure includes 40 epochs of fine-tuning with various augmentation techniques, and model performance is evaluated on field data using test accuracy, affinity, and diversity metrics.

## Key Results
- Geometric augmentations improve field test accuracy by up to 14% compared to conventional methods
- The proposed augmentations achieve highest affinity and diversity scores according to adapted metrics
- Performance gains increase as pollen grains recover their shape through hydration

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Geometric augmentations improve robustness by shifting the model's feature extraction bias from texture to shape, which is more stable across distribution shifts.
- Mechanism: The Tenengrad and ImageToSketch filters explicitly enhance gradient-based edge and shape information while suppressing texture-specific details, thereby aligning the model's learned representations with domain-invariant geometric features of pollen grains.
- Core assumption: Pollen classification relies more heavily on shape and geometric cues than on texture, and these shape features are preserved across different imaging conditions (e.g., lighting, hydration levels).
- Evidence anchors:
  - [abstract] "we show that Tenengrad and ImageToSketch filters are highly effective to balance the shape and texture information while leaving out unimportant details that may confuse the model."
  - [section] "As highlighted in (Geirhos et al., 2019), the analysis of CNNs trained on large-scale datasets reveals a bias towards texture features, indicating a tendency to prioritize texture cues when making predictions."
  - [corpus] Weak evidence: Corpus neighbors focus on test-time adaptation but not specifically on geometric augmentation for shape bias.
- Break condition: If texture features become more discriminative than shape for certain pollen taxa, or if geometric features degrade across domain shifts (e.g., extreme occlusion).

### Mechanism 2
- Claim: Geometric augmentations increase model robustness by improving affinity and diversity metrics, balancing preservation of original data integrity with introduction of novel variations.
- Mechanism: By emphasizing edges and shapes, the augmentations generate samples that are similar enough to the original distribution (high affinity) but diverse enough to cover variations in pollen appearance (high diversity), preventing overfitting.
- Core assumption: The affinity and diversity framework (Lopes et al., 2021) is applicable to pollen classification, and improvements in these metrics correlate with improved generalization.
- Evidence anchors:
  - [abstract] "The proposed geometric augmentations also receive the highest scores according to the affinity and diversity measures from the literature."
  - [section] "We adapt the affinity and diversity measures (Lopes et al., 2021) to evaluate the effectiveness of the proposed geometric augmentation techniques."
  - [corpus] Weak evidence: Corpus focuses on test-time adaptation methods rather than geometric augmentation-based affinity/diversity improvement.
- Break condition: If affinity/diversity metrics do not correlate with actual model performance in other domains or datasets.

### Mechanism 3
- Claim: Geometric augmentations become increasingly effective as pollen grains recover their shape through hydration, validating that shape information is the key invariant feature.
- Mechanism: As hydration progresses, pollen geometry becomes more pronounced and stable; geometric augmentations, which emphasize shape, thus provide greater benefit when shape is the primary distinguishing feature.
- Core assumption: Pollen hydration reliably restores geometric features that are critical for classification, and the difference in classification performance across hydration levels is primarily due to shape recovery.
- Evidence anchors:
  - [abstract] "We conduct an ablation study to assess the model's ability to generalize to the correct pollen grain data by making use of the pollen hydration process, which is known to restore geometry and internal structures of dry pollen. We observe that geometric augmentations are consistently more useful as hydration advances."
  - [section] "Figure 5 shows the model test set accuracy on images featuring pollen in three hydration levels. We observe poor performance... A gradual improvement emerges when pollen is half-hydrated... When the grains are fully hydrated, the accuracy is strongly improved up to 87% for geometric augmentations."
  - [corpus] No direct evidence; hydration is specific to pollen domain.
- Break condition: If other factors (e.g., lighting, staining) vary systematically with hydration and drive performance changes.

## Foundational Learning

- Concept: Distribution shift in machine learning
  - Why needed here: The entire motivation is to improve model performance when training and test data come from different distributions (library vs. field pollen data).
  - Quick check question: What are the main causes of distribution shift in the pollen dataset described in Section 3?

- Concept: Texture vs. shape bias in CNNs
  - Why needed here: The proposed method explicitly targets shape features to counteract the default texture bias in CNNs, improving robustness.
  - Quick check question: According to the paper, why do standard CNNs struggle with pollen classification under distribution shifts?

- Concept: Data augmentation and its role in generalization
  - Why needed here: The proposed geometric augmentations are a form of data augmentation designed to improve generalization by emphasizing invariant features.
  - Quick check question: How do the proposed Tenengrad and ImageToSketch filters differ from conventional augmentations like rotation and color jitter?

## Architecture Onboarding

- Component map:
  - Pre-trained CNN backbone (e.g., ResNet-18, EfficientNet variants)
  - Geometric augmentation pipeline (Tenengrad, ImageToSketch, or both)
  - Training loop with cross-entropy loss and Adam optimizer
  - Evaluation on library (train) and field (test) datasets
  - Affinity and diversity computation module (optional)

- Critical path:
  1. Load pre-trained model
  2. Apply geometric augmentations during fine-tuning on library data
  3. Monitor validation accuracy and loss
  4. Evaluate final model on field data
  5. (Optional) Compute affinity/diversity metrics

- Design tradeoffs:
  - Tradeoff between augmentation strength and preservation of original pollen features
  - Model size vs. computational cost (larger models may benefit more but take longer to train)
  - Choice of geometric vs. conventional augmentations based on dataset characteristics

- Failure signatures:
  - No improvement in field accuracy despite gains on library data
  - Affinity/diversity metrics improve but accuracy does not
  - Geometric augmentations degrade performance on well-hydrated pollen (over-smoothing)

- First 3 experiments:
  1. Fine-tune ResNet-18 with Tenengrad augmentation on library data; evaluate on field data.
  2. Repeat with ImageToSketch augmentation; compare results.
  3. Combine both geometric augmentations; repeat evaluation and compute affinity/diversity.

## Open Questions the Paper Calls Out

- Question: How do the geometric augmentations perform on other types of microscopic imaging beyond pollen, such as histopathology or cell cultures?
  - Basis in paper: [inferred] The authors mention that geometric augmentations work well on low-contrast images and similar object data, suggesting potential applicability to other microscopic domains.
  - Why unresolved: The paper focuses specifically on pollen classification and does not explore the generalizability of the geometric augmentations to other microscopic image domains.
  - What evidence would resolve it: Experimental results showing the performance of geometric augmentations on histopathology, cell culture, or other microscopic image datasets compared to conventional augmentations.

- Question: What is the optimal combination of geometric augmentations (Tenengrad and ImageToSketch) and their probabilities for maximizing performance across different CNN architectures?
  - Basis in paper: [explicit] The authors combine Tenengrad and ImageToSketch with a probability of 0.5 each, but note that the probability p is set to 0.4 for most experiments.
  - Why unresolved: The paper does not explore the impact of varying the probabilities of individual geometric augmentations or their combinations on model performance.
  - What evidence would resolve it: A systematic study varying the probabilities of Tenengrad, ImageToSketch, and their combinations to find the optimal settings for each CNN architecture.

- Question: How do the geometric augmentations affect the internal representations learned by CNNs at different layers, and how does this relate to the improved robustness to distribution shifts?
  - Basis in paper: [inferred] The authors mention that CNNs are biased towards texture features and that geometric augmentations help balance shape and texture information. However, they do not investigate the impact on internal representations.
  - Why unresolved: The paper focuses on overall model performance and does not analyze the internal representations learned by CNNs when using geometric augmentations.
  - What evidence would resolve it: A study analyzing the feature maps or embeddings at different layers of CNNs trained with and without geometric augmentations to understand how the augmentations affect the learned representations and their relation to robustness.

## Limitations
- The specific implementation details of the Tenengrad and ImageToSketch filters are not fully specified, making exact replication difficult
- The assumption that shape features are universally more invariant than texture across all distribution shifts in the dataset may not hold
- The generalizability of geometric augmentations to other domains with distribution shifts is untested

## Confidence
- High Confidence: The experimental results showing improved field accuracy with geometric augmentations are well-supported by the data presented
- Medium Confidence: The mechanism linking geometric augmentations to improved robustness through shape emphasis is plausible but requires further validation
- Low Confidence: The assumption that shape features are universally more invariant than texture across all distribution shifts in the dataset

## Next Checks
1. Implement the Tenengrad and ImageToSketch filters using the provided implementation details and verify their output on sample pollen images
2. Conduct ablation studies varying the strength of geometric augmentations to identify optimal parameters and test the limits of their effectiveness
3. Test the proposed geometric augmentations on a different dataset with known distribution shifts to evaluate generalizability beyond pollen classification