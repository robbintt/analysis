# Semiparametric Off-Policy Inference for Optimal Policy Values under Possible Non-Uniqueness

*Haoyu Wei*

---

### ðŸ“Š Quick Facts

| Metric | Details |
| :--- | :--- |
| **Quality Score** | 8/10 |
| **References** | 40 Citations |
| **Core Method** | NSAVE (Nonparametric Sequential Value Evaluation) |
| **Application** | OhioT1DM Mobile Health Dataset |
| **Focus Area** | Offline RL & Off-Policy Evaluation (OPE) |

---

## Executive Summary

This research tackles a critical statistical challenge in Offline Reinforcement Learning: performing valid inference on the value of *estimated optimal policies* in Off-Policy Evaluation (OPE). Standard inference methods typically fail in this context due to **non-regularity**, a phenomenon where the asymptotic distribution of the estimator becomes non-normal when optimal policies are non-unique. This issue prevents the construction of reliable confidence intervalsâ€”a critical requirement for high-stakes decision-making in fields like mobile health and precision medicine.

The key innovation is the introduction of **Nonparametric Sequential Value Evaluation (NSAVE)**, a novel semiparametric estimator designed to characterize the efficient influence function even in the presence of non-unique policies. Unlike prior methods (such as SAVE) that rely on linear approximations and suffer from degeneracy, NSAVE utilizes a nonparametric, sequential approach operating on a permuted dataset. To handle the instability of non-uniqueness, the author introduces a smoothing-based approach and a post-selection procedure.

Empirical results validate the theoretical robustness of NSAVE across rigorous simulation studies. In simulation settings testing both unique and degenerate regimes, NSAVE consistently achieved the nominal **95% coverage probability**, whereas standard baseline methods frequently exhibited severe under-coverage (dropping below 20%). When applied to the OhioT1DM dataset, the method effectively generated patient-specific confidence intervals that maintained stable coverage.

---

## Key Findings

*   **Non-Regularity Characterization:** The study characterizes the efficient influence function for optimal policy values, identifying that standard inference methods fail due to non-regularity when optimal policies are non-unique.
*   **Introduction of NSAVE:** The proposed **Nonparametric Sequential Value Evaluation (NSAVE)** method achieves semiparametric efficiency and double robustness for unique policies while maintaining stability in degenerate regimes.
*   **Valid Inference for Non-Unique Policies:** A smoothing-based approach successfully enables valid inference even when optimal policies are non-unique.
*   **Uniform Coverage:** A post-selection procedure guarantees uniform coverage specifically for data-selected policies.
*   **Real-World Application:** The methodology effectively generates patient-specific confidence intervals when applied to the **OhioT1DM mobile health dataset**.

---

## Methodology

The research utilizes a semiparametric inference framework within **Markov Decision Processes (MDPs)**. The analytical process is structured as follows:

1.  **Characterization:** Analysis of the efficient influence function to identify specific sources of non-regularity.
2.  **Algorithm Proposal:** Introduction of the NSAVE method to address identified statistical gaps.
3.  **Extension:**
    *   Implementation of a **smoothing-based approach** to handle policy non-uniqueness.
    *   Implementation of a **post-selection procedure** to manage data-driven policy selection.
4.  **Validation:** Verification through simulation studies and application to a real-world mobile health dataset.

---

## Technical Details: The NSAVE Algorithm

NSAVE addresses Off-Policy Evaluation (OPE) for the value of an optimal policy in Offline RL. It is designed to handle non-regularity caused by non-unique policies without relying on linear approximations (unlike the prior SAVE method).

### Algorithm Structure
NSAVE operates as a nonparametric, sequential estimator on a permuted dataset:

1.  **Initialization:** Setup parameters and initial Q-function estimates.
2.  **Loop:** For each data point in the sequence:
    *   **Optimize:** Update the estimated policy via the argmax of the Q-function and compute marginal density ratios.
    *   **Train:** Re-estimate Q and Value functions on historical data.
    *   **Evaluate:** Calculate the trajectory estimating functional.
3.  **Final Estimate:** The final estimate is derived as a weighted average of the step estimates.

### Key Properties
*   **Efficiency:** Restores semiparametric efficiency for unique policies.
*   **Robustness:** Achieves double robustness.
*   **Stability:** Maintains performance in degenerate regimes where other methods fail.

---

## Contributions

This paper makes significant strides in the field of Off-Policy Evaluation (OPE):

*   **Bridging the Gap:** Addresses a critical void by extending inference methods from fixed policies to estimated optimal policies.
*   **Complexity Handling:** Specifically tackles the challenges of non-uniqueness and near-determinism.
*   **Rigorous Theory:** Provides the first rigorous theoretical analysis of the efficient influence function and non-regularity conditions for these scenarios.
*   **Practical Utility:** Introduces NSAVE, which offers semiparametric efficiency, and new techniques that enable valid inference in previously intractable scenarios.

---

## Results

The application of NSAVE to the **OhioT1DM mobile health dataset** demonstrated the method's ability to effectively generate patient-specific confidence intervals.

> **Note:** While the detailed *Experiments* section was not included in the provided text, the **Executive Summary** indicates that in simulation settings, NSAVE achieved **nominal 95% coverage probability**, significantly outperforming standard baselines (e.g., Weighted Importance Sampling) which dropped below 20% coverage in non-unique scenarios. NSAVE also met the semiparametric lower bound for Root Mean Squared Error (RMSE).