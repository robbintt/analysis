---
title: 'Multi-Agent Design: Optimizing Agents with Better Prompts and Topologies'
arxiv_id: '2502.02533'
source_url: https://arxiv.org/abs/2502.02533
generated_at: '2026-02-03T13:55:43'
quality_score: 8
citation_count: 40
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# Multi-Agent Design: Optimizing Agents with Better Prompts and Topologies

*Han Zhou; Xingchen Wan; Ruoxi Sun; Hamid Palangi; Shariq Iqbal; Ivan Vuliƒá; Anna Korhonen; Sercan √ñ. Arƒ±k*

***

> ### üìä Quick Facts
>
> *   **Quality Score:** 8/10
> *   **Total Citations:** 40
> *   **Key Framework:** MASS (Multi-Agent System Search)
> *   **Evaluation Model:** Gemini 1.5 Pro
> *   **Key Benchmarks:** MATH, HotpotQA, LiveCodeBench
> *   **Performance Gain:** +6% (Stage 1), +3% (Stage 2), +2% (Stage 3)

***

## üìù Executive Summary

Designing effective Multi-Agent Systems (MAS) is a complex challenge because the system's performance relies heavily on the interplay between two distinct components: the **prompts** (instructions given to agents) and the **topology** (the structural connections and workflows between them). Currently, researchers and engineers must manually design these systems or optimize prompts and topologies in isolation, often ignoring their critical interdependence. This paper addresses the need for a systematic, automated approach to navigate this vast design space, recognizing that optimizing factors independently yields suboptimal results compared to a holistic strategy.

The authors introduce **MASS (Multi-Agent System Search)**, the first comprehensive framework to automate the end-to-end design of MAS through a novel three-stage interleaved optimization strategy. The process transitions from local to global refinement:

1.  **Stage 1:** Block-level Prompt Optimization optimizes individual modules in isolation using MIPRO.
2.  **Stage 2:** Workflow Topology Optimization constructs effective topologies (e.g., Aggregate, Reflect, Debate) using Influence-Weighted Sampling based on incremental influence metrics to manage computational complexity.
3.  **Stage 3:** Workflow-level Prompt Optimization fine-tunes prompts specifically for the interactions within the selected workflow.

This "local to global" approach allows for the simultaneous discovery of effective agent roles and communication structures.

Evaluations conducted using Gemini 1.5 Pro on challenging benchmarks like MATH, HotpotQA, and LiveCodeBench demonstrated that MASS significantly outperforms existing baselines. The framework achieved cumulative gains through its stages: block-level optimization alone delivered a **+6%** average improvement over standard Automatic Prompt Optimization, while topology optimization added a further **+3%** gain. The final workflow-level optimization provided incremental boosts, for instance, raising performance from 83% to 85%. MASS surpassed existing methods like ADAS and AFlow on tasks such as MATH and MuSiQue, proving that it utilizes compute resources more effectively than scaling techniques like self-consistency. The analysis also revealed that beneficial topologies are sparse; notably, only the 'debate' topology provided gains for HotpotQA.

This research significantly advances the field by shifting Multi-Agent System design from manual, heuristic-based engineering to an automated, data-driven search process. By establishing empirically-backed design principles, the paper provides theoretical foundations for understanding how agent roles and workflows interact. The introduction of MASS offers a practical tool for practitioners to build superior AI systems without exhaustive manual tuning, while the findings on topology sparsity offer new insights into which agent interactions (like debate) actually drive performance improvements. Ultimately, this work sets a new standard for MAS optimization, suggesting that intelligent structural search is more critical to performance than simply scaling computational resources.

***

## üîë Key Findings

*   **Critical Interdependence:** Prompts and topologies are critical, interdependent factors in building effective Multi-Agent Systems.
*   **Superior Performance:** Multi-agent systems optimized using the MASS framework outperform existing alternatives.
*   **Derivation of Principles:** Automated search identified systems leading to general design principles.
*   **Efficacy of Interleaved Search:** Optimization requires moving from local to global levels and iteratively refining prompts and topologies.

***

## üß™ Methodology

*   **Design Space Analysis:** In-depth analysis of factors driving system effectiveness.
*   **Framework Proposal:** Introduction of MASS to automate MAS design.
*   **Three-Stage Interleaved Optimization:**
    1.  **Block-level (local) prompt optimization**
    2.  **Workflow topology optimization**
    3.  **Workflow-level (global) prompt optimization**

***

## ‚öôÔ∏è Technical Details

The paper proposes **MASS (Multi-Agent System Search)**, a multi-stage optimization framework for Multi-Agent Systems (MAS) that jointly optimizes prompts and topologies using a 'local to global' interleaved search strategy.

### Search Components
*   **Prompts:** Instructions and few-shot demonstrations.
*   **Topologies:** Aggregate, Reflect, Debate, Summarize, Tool-use.

### Algorithm Stages

1.  **Block-level Prompt Optimization (1PO):**
    *   Optimizes individual modules in isolation.
    *   Utilizes the MIPRO optimizer.

2.  **Workflow Topology Optimization (2TO):**
    *   Constructs topologies using **Influence-Weighted Sampling**.
    *   Based on Incremental Influence metrics.
    *   Employs a pruning mechanism to manage complexity.
    *   Follows a fixed construction rule under a budget constraint.

3.  **Workflow-level Prompt Optimization (3PO):**
    *   Tunes prompts specifically for the interactions within the selected workflow.

***

## üìà Results

Evaluations were conducted with **Gemini 1.5 Pro** on datasets such as **MATH**, **HotpotQA**, and **LiveCodeBench**.

### Performance Improvements
*   **Stage 1 (Block-level):** Achieved a **+6%** average performance improvement over standard Automatic Prompt Optimization.
*   **Stage 2 (Topology):** Added a further **+3%** gain.
*   **Stage 3 (Workflow-level):** Yielded additional incremental improvements (e.g., increasing performance from 83% to 85%).

### Key Insights
*   **Topology Sparsity:** Analysis revealed that beneficial topologies are sparse. For instance, only the 'debate' topology improved HotpotQA (+3%).
*   **Baseline Comparison:** The framework outperformed baselines like ADAS and AFlow on tasks like MATH and MuSiQue.
*   **Compute Efficiency:** MASS utilizes compute more effectively than scaling methods like self-consistency.
*   **Parallelization:** MASS demonstrated efficiency gains through the parallelization of its first two stages.

***

## üèÜ Contributions

*   **Automation of MAS Design:** Introduction of MASS, the first comprehensive framework to automate end-to-end design.
*   **Novel Optimization Strategy:** A new optimization paradigm transitioning from local to global and prompts to topologies.
*   **Benchmark Performance:** Demonstrated empirical improvements over existing baselines.
*   **Theoretical Foundations:** Provided empirically-backed design principles.