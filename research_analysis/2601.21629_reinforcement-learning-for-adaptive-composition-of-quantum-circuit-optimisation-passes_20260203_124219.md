---
title: Reinforcement Learning for Adaptive Composition of Quantum Circuit Optimisation
  Passes
arxiv_id: '2601.21629'
source_url: https://arxiv.org/abs/2601.21629
generated_at: '2026-02-03T12:42:19'
quality_score: 9
citation_count: 40
model_profiles_used:
- default
- fast
model_profiles:
  default:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
  fast:
    provider: cerebras
    name: zai-glm-4.7
    temperature: 0.9
    top_p: 0.95
    max_tokens: 150000
---

# Reinforcement Learning for Adaptive Composition of Quantum Circuit Optimisation Passes

*Daniel Mills; Ifan Williams; Jacob Swain; Gabriel Matos; Enrico Rinaldi; Alexander Koziell-Pipe*

---

> ### ðŸ“Š Quick Facts
> *   **Mean Gate Reduction:** 57.7% (RL) vs 41.8% (Default PyTKET)
> *   **Median Gate Reduction:** 56.7% (RL) vs 50.0% (Default PyTKET)
> *   **Performance Gain:** ~15.9% improvement in mean gate removal
> *   **Core Architecture:** Proximal Policy Optimization (PPO) with Graph Neural Networks (GNN)
> *   **Evaluation Metric:** Fraction of two-qubit gates removed
> *   **Quality Score:** 9/10

---

## Executive Summary

**Problem**
In the Noisy Intermediate-Scale Quantum (NISQ) era, quantum circuit optimization is a critical bottleneck. Algorithm fidelity depends heavily on reducing circuit depth, specifically the number of error-prone two-qubit gates. Current quantum compilers rely on static, general-purpose sequences (e.g., in PyTKET) that fail to adapt to unique circuit topologies. This "one-size-fits-all" approach wastes optimization potential, while manual tuning requires infeasible levels of domain expertise.

**Innovation**
This paper introduces a reinforcement learning (RL) framework to automate the composition of quantum circuit optimization passes, solving the Phase Ordering Problem. The authors utilize Proximal Policy Optimization (PPO) with an actor-critic architecture. The quantum circuit is represented as a graph (nodes: gates/inputs/outputs; edges: qubits), processed by a Graph Neural Network (GNN) with modified GINConv operators. The agent dynamically selects and orders seven distinct PyTKET passes based on a reward function defined by fractional two-qubit gate reduction.

**Results**
Evaluated on a diverse test set, the RL agent significantly outperformed the best default PyTKET sequence. The adaptive agent achieved a **mean reduction of 57.7%** and a **median reduction of 56.7%** in two-qubit gates, compared to the static default's 41.8% mean and 50.0% median. This represents an ~15.9% improvement in mean gate removal. Furthermore, the agent achieved gate counts comparable to expensive search-based approaches at a fraction of the computational cost.

**Impact**
This research bridges the expertise gap in quantum compilation, enabling high-performance optimization without manual expert intervention. By generating bespoke pass sequences tailored to specific circuit structures, this approach maximizes the executability of quantum algorithms on near-term hardware. The findings validate the potential of adaptive, RL-driven compilers to replace static heuristics, offering a scalable path toward more efficient quantum computing.

---

## Key Findings

*   **Significant Outperformance:** The reinforcement learning agent significantly outperformed standard optimization methods, removing a **mean of 57.7%** and a **median of 56.7%** of two-qubit gates.
*   **Benchmark Comparison:** In comparison, the best default pass sequence from PyTKET removed only a mean of 41.8% and a median of 50.0% of two-qubit gates.
*   **Specific vs. General:** General-purpose default pass sequences miss optimization opportunities that are specific to the structure of individual circuits.
*   **Expertise Independence:** The RL agent successfully learned to compose bespoke pass sequences without the need for expert human knowledge of quantum circuit design.
*   **Cost Efficiency:** The agent produces gate counts comparable to search-based approaches but at a notably lower computational cost.

---

## Methodology

The researchers trained a reinforcement learning agent to autonomously compose sequences of circuit optimization passes. The method was evaluated on a diverse test set of quantum circuits to measure the efficacy of the agent against general-purpose default sequences.

*   **Action Space:** Specifically defined using passes designed for two-qubit gate count reduction, sourced from the default PyTKET library.
*   **Objective:** To dynamically determine the optimal order and selection of optimization passes to maximize gate reduction.

---

## Technical Details

The approach leverages a deep reinforcement learning architecture tailored to graph-structured quantum data.

### Architecture & Training
*   **Algorithm:** Proximal Policy Optimization (PPO) with an actor-critic architecture.
*   **Optimizer:** Adam with Tree-structured Parzen Estimator (TPE) tuning.
*   **Hyperparameters:** Learning rate set to $3.36 \times 10^{-4}$; 4 GNN layers utilized.

### State Representation
*   **Graph Structure:** Nodes represent gates, inputs, and outputs; edges represent qubits.
*   **Features:** An 8-element feature vector is used for node representation.
*   **Processing:** Handled by a Graph Neural Network (GNN) with modified GINConv operators, skip connections, and mean pooling.

### Action & Reward
*   **Action Space:** Consists of 7 specific PyTKET passes, including `KAKDecomposition` and `CliffordResynthesis`.
*   **Reward Function:** $r_t = \frac{n_{t-1} - n_t}{n_0}$
    *   This represents the fraction of two-qubit gates removed.
    *   Includes a small penalty for non-termination actions to encourage efficiency.

---

## Contributions

*   **Automated Pass Composition:** Introduction of a machine learning framework to automatically determine the optimal order and selection of quantum circuit optimization passes, a task traditionally left to users or static defaults.
*   **Superior Optimization Metrics:** Demonstrated that adaptive, RL-generated sequences can achieve higher gate reduction rates (specifically two-qubit gates) than the best hard-coded general-purpose sequences.
*   **Bridging the Expertise Gap:** Provided a solution that generates high-performance, bespoke optimization strategies without requiring the user to possess exceptional knowledge of quantum circuit optimization techniques.

---

**References:** 40 citations